function lte(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function cte(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var u1={exports:{}},hp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qj;function ute(){if(qj)return hp;qj=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:n,type:r,key:a,ref:s!==void 0?s:null,props:i}}return hp.Fragment=e,hp.jsx=t,hp.jsxs=t,hp}var Wj;function dte(){return Wj||(Wj=1,u1.exports=ute()),u1.exports}var d=dte(),d1={exports:{}},fp={},h1={exports:{}},f1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kj;function hte(){return Kj||(Kj=1,function(n){function e(F,j){var q=F.length;F.push(j);e:for(;0<q;){var H=q-1>>>1,N=F[H];if(0<s(N,j))F[H]=j,F[q]=N,q=H;else break e}}function t(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var j=F[0],q=F.pop();if(q!==j){F[0]=q;e:for(var H=0,N=F.length,O=N>>>1;H<O;){var z=2*(H+1)-1,G=F[z],Y=z+1,Q=F[Y];if(0>s(G,q))Y<N&&0>s(Q,G)?(F[H]=Q,F[Y]=q,H=Y):(F[H]=G,F[z]=q,H=z);else if(Y<N&&0>s(Q,q))F[H]=Q,F[Y]=q,H=Y;else break e}}return j}function s(F,j){var q=F.sortIndex-j.sortIndex;return q!==0?q:F.id-j.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,m=3,g=!1,y=!1,b=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function R(F){for(var j=t(c);j!==null;){if(j.callback===null)r(c);else if(j.startTime<=F)r(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=t(c)}}function I(F){if(b=!1,R(F),!y)if(t(l)!==null)y=!0,C||(C=!0,$());else{var j=t(c);j!==null&&W(I,j.startTime-F)}}var C=!1,L=-1,k=5,M=-1;function D(){return x?!0:!(n.unstable_now()-M<k)}function U(){if(x=!1,C){var F=n.unstable_now();M=F;var j=!0;try{e:{y=!1,b&&(b=!1,T(L),L=-1),g=!0;var q=m;try{t:{for(R(F),f=t(l);f!==null&&!(f.expirationTime>F&&D());){var H=f.callback;if(typeof H=="function"){f.callback=null,m=f.priorityLevel;var N=H(f.expirationTime<=F);if(F=n.unstable_now(),typeof N=="function"){f.callback=N,R(F),j=!0;break t}f===t(l)&&r(l),R(F)}else r(l);f=t(l)}if(f!==null)j=!0;else{var O=t(c);O!==null&&W(I,O.startTime-F),j=!1}}break e}finally{f=null,m=q,g=!1}j=void 0}}finally{j?$():C=!1}}}var $;if(typeof _=="function")$=function(){_(U)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,B=V.port2;V.port1.onmessage=U,$=function(){B.postMessage(null)}}else $=function(){S(U,0)};function W(F,j){L=S(function(){F(n.unstable_now())},j)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(F){F.callback=null},n.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<F?Math.floor(1e3/F):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(F){switch(m){case 1:case 2:case 3:var j=3;break;default:j=m}var q=m;m=j;try{return F()}finally{m=q}},n.unstable_requestPaint=function(){x=!0},n.unstable_runWithPriority=function(F,j){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var q=m;m=F;try{return j()}finally{m=q}},n.unstable_scheduleCallback=function(F,j,q){var H=n.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?H+q:H):q=H,F){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=q+N,F={id:u++,callback:j,priorityLevel:F,startTime:q,expirationTime:N,sortIndex:-1},q>H?(F.sortIndex=q,e(c,F),t(l)===null&&F===t(c)&&(b?(T(L),L=-1):b=!0,W(I,q-H))):(F.sortIndex=N,e(l,F),y||g||(y=!0,C||(C=!0,$()))),F},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(F){var j=m;return function(){var q=m;m=j;try{return F.apply(this,arguments)}finally{m=q}}}}(f1)),f1}var Yj;function fte(){return Yj||(Yj=1,h1.exports=hte()),h1.exports}var m1={exports:{}},Wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xj;function mte(){if(Xj)return Wt;Xj=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;function m(N){return N===null||typeof N!="object"?null:(N=f&&N[f]||N["@@iterator"],typeof N=="function"?N:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(N,O,z){this.props=N,this.context=O,this.refs=b,this.updater=z||g}x.prototype.isReactComponent={},x.prototype.setState=function(N,O){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,O,"setState")},x.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function S(){}S.prototype=x.prototype;function T(N,O,z){this.props=N,this.context=O,this.refs=b,this.updater=z||g}var _=T.prototype=new S;_.constructor=T,y(_,x.prototype),_.isPureReactComponent=!0;var R=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function L(N,O,z,G,Y,Q){return z=Q.ref,{$$typeof:n,type:N,key:O,ref:z!==void 0?z:null,props:Q}}function k(N,O){return L(N.type,O,void 0,void 0,void 0,N.props)}function M(N){return typeof N=="object"&&N!==null&&N.$$typeof===n}function D(N){var O={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(z){return O[z]})}var U=/\/+/g;function $(N,O){return typeof N=="object"&&N!==null&&N.key!=null?D(""+N.key):O.toString(36)}function V(){}function B(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(V,V):(N.status="pending",N.then(function(O){N.status==="pending"&&(N.status="fulfilled",N.value=O)},function(O){N.status==="pending"&&(N.status="rejected",N.reason=O)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function W(N,O,z,G,Y){var Q=typeof N;(Q==="undefined"||Q==="boolean")&&(N=null);var J=!1;if(N===null)J=!0;else switch(Q){case"bigint":case"string":case"number":J=!0;break;case"object":switch(N.$$typeof){case n:case e:J=!0;break;case u:return J=N._init,W(J(N._payload),O,z,G,Y)}}if(J)return Y=Y(N),J=G===""?"."+$(N,0):G,R(Y)?(z="",J!=null&&(z=J.replace(U,"$&/")+"/"),W(Y,O,z,"",function(te){return te})):Y!=null&&(M(Y)&&(Y=k(Y,z+(Y.key==null||N&&N.key===Y.key?"":(""+Y.key).replace(U,"$&/")+"/")+J)),O.push(Y)),1;J=0;var ee=G===""?".":G+":";if(R(N))for(var oe=0;oe<N.length;oe++)G=N[oe],Q=ee+$(G,oe),J+=W(G,O,z,Q,Y);else if(oe=m(N),typeof oe=="function")for(N=oe.call(N),oe=0;!(G=N.next()).done;)G=G.value,Q=ee+$(G,oe++),J+=W(G,O,z,Q,Y);else if(Q==="object"){if(typeof N.then=="function")return W(B(N),O,z,G,Y);throw O=String(N),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return J}function F(N,O,z){if(N==null)return N;var G=[],Y=0;return W(N,G,"","",function(Q){return O.call(z,Q,Y++)}),G}function j(N){if(N._status===-1){var O=N._result;O=O(),O.then(function(z){(N._status===0||N._status===-1)&&(N._status=1,N._result=z)},function(z){(N._status===0||N._status===-1)&&(N._status=2,N._result=z)}),N._status===-1&&(N._status=0,N._result=O)}if(N._status===1)return N._result.default;throw N._result}var q=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function H(){}return Wt.Children={map:F,forEach:function(N,O,z){F(N,function(){O.apply(this,arguments)},z)},count:function(N){var O=0;return F(N,function(){O++}),O},toArray:function(N){return F(N,function(O){return O})||[]},only:function(N){if(!M(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Wt.Component=x,Wt.Fragment=t,Wt.Profiler=s,Wt.PureComponent=T,Wt.StrictMode=r,Wt.Suspense=l,Wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Wt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return I.H.useMemoCache(N)}},Wt.cache=function(N){return function(){return N.apply(null,arguments)}},Wt.cloneElement=function(N,O,z){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var G=y({},N.props),Y=N.key,Q=void 0;if(O!=null)for(J in O.ref!==void 0&&(Q=void 0),O.key!==void 0&&(Y=""+O.key),O)!C.call(O,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&O.ref===void 0||(G[J]=O[J]);var J=arguments.length-2;if(J===1)G.children=z;else if(1<J){for(var ee=Array(J),oe=0;oe<J;oe++)ee[oe]=arguments[oe+2];G.children=ee}return L(N.type,Y,void 0,void 0,Q,G)},Wt.createContext=function(N){return N={$$typeof:a,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:i,_context:N},N},Wt.createElement=function(N,O,z){var G,Y={},Q=null;if(O!=null)for(G in O.key!==void 0&&(Q=""+O.key),O)C.call(O,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(Y[G]=O[G]);var J=arguments.length-2;if(J===1)Y.children=z;else if(1<J){for(var ee=Array(J),oe=0;oe<J;oe++)ee[oe]=arguments[oe+2];Y.children=ee}if(N&&N.defaultProps)for(G in J=N.defaultProps,J)Y[G]===void 0&&(Y[G]=J[G]);return L(N,Q,void 0,void 0,null,Y)},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(N){return{$$typeof:o,render:N}},Wt.isValidElement=M,Wt.lazy=function(N){return{$$typeof:u,_payload:{_status:-1,_result:N},_init:j}},Wt.memo=function(N,O){return{$$typeof:c,type:N,compare:O===void 0?null:O}},Wt.startTransition=function(N){var O=I.T,z={};I.T=z;try{var G=N(),Y=I.S;Y!==null&&Y(z,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(H,q)}catch(Q){q(Q)}finally{I.T=O}},Wt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Wt.use=function(N){return I.H.use(N)},Wt.useActionState=function(N,O,z){return I.H.useActionState(N,O,z)},Wt.useCallback=function(N,O){return I.H.useCallback(N,O)},Wt.useContext=function(N){return I.H.useContext(N)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(N,O){return I.H.useDeferredValue(N,O)},Wt.useEffect=function(N,O,z){var G=I.H;if(typeof z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return G.useEffect(N,O)},Wt.useId=function(){return I.H.useId()},Wt.useImperativeHandle=function(N,O,z){return I.H.useImperativeHandle(N,O,z)},Wt.useInsertionEffect=function(N,O){return I.H.useInsertionEffect(N,O)},Wt.useLayoutEffect=function(N,O){return I.H.useLayoutEffect(N,O)},Wt.useMemo=function(N,O){return I.H.useMemo(N,O)},Wt.useOptimistic=function(N,O){return I.H.useOptimistic(N,O)},Wt.useReducer=function(N,O,z){return I.H.useReducer(N,O,z)},Wt.useRef=function(N){return I.H.useRef(N)},Wt.useState=function(N){return I.H.useState(N)},Wt.useSyncExternalStore=function(N,O,z){return I.H.useSyncExternalStore(N,O,z)},Wt.useTransition=function(){return I.H.useTransition()},Wt.version="19.1.1",Wt}var Qj;function BE(){return Qj||(Qj=1,m1.exports=mte()),m1.exports}var p1={exports:{}},ws={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zj;function pte(){if(Zj)return ws;Zj=1;var n=BE();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:f==null?null:""+f,children:l,containerInfo:c,implementation:u}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return ws.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ws.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return i(l,c,null,u)},ws.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},ws.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},ws.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},ws.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:g}):u==="script"&&r.d.X(l,{crossOrigin:f,integrity:m,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},ws.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},ws.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},ws.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},ws.requestFormReset=function(l){r.d.r(l)},ws.unstable_batchedUpdates=function(l,c){return l(c)},ws.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},ws.useFormStatus=function(){return a.H.useHostTransitionStatus()},ws.version="19.1.1",ws}var Jj;function w8(){if(Jj)return p1.exports;Jj=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),p1.exports=pte(),p1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eF;function gte(){if(eF)return fp;eF=1;var n=fte(),e=BE(),t=w8();function r(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function i(h){var p=h,v=h;if(h.alternate)for(;p.return;)p=p.return;else{h=p;do p=h,(p.flags&4098)!==0&&(v=p.return),h=p.return;while(h)}return p.tag===3?v:null}function a(h){if(h.tag===13){var p=h.memoizedState;if(p===null&&(h=h.alternate,h!==null&&(p=h.memoizedState)),p!==null)return p.dehydrated}return null}function o(h){if(i(h)!==h)throw Error(r(188))}function l(h){var p=h.alternate;if(!p){if(p=i(h),p===null)throw Error(r(188));return p!==h?null:h}for(var v=h,w=p;;){var A=v.return;if(A===null)break;var P=A.alternate;if(P===null){if(w=A.return,w!==null){v=w;continue}break}if(A.child===P.child){for(P=A.child;P;){if(P===v)return o(A),h;if(P===w)return o(A),p;P=P.sibling}throw Error(r(188))}if(v.return!==w.return)v=A,w=P;else{for(var X=!1,re=A.child;re;){if(re===v){X=!0,v=A,w=P;break}if(re===w){X=!0,w=A,v=P;break}re=re.sibling}if(!X){for(re=P.child;re;){if(re===v){X=!0,v=P,w=A;break}if(re===w){X=!0,w=P,v=A;break}re=re.sibling}if(!X)throw Error(r(189))}}if(v.alternate!==w)throw Error(r(190))}if(v.tag!==3)throw Error(r(188));return v.stateNode.current===v?h:p}function c(h){var p=h.tag;if(p===5||p===26||p===27||p===6)return h;for(h=h.child;h!==null;){if(p=c(h),p!==null)return p;h=h.sibling}return null}var u=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),T=Symbol.for("react.consumer"),_=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function $(h){return h===null||typeof h!="object"?null:(h=U&&h[U]||h["@@iterator"],typeof h=="function"?h:null)}var V=Symbol.for("react.client.reference");function B(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===V?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case y:return"Fragment";case x:return"Profiler";case b:return"StrictMode";case I:return"Suspense";case C:return"SuspenseList";case M:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case g:return"Portal";case _:return(h.displayName||"Context")+".Provider";case T:return(h._context.displayName||"Context")+".Consumer";case R:var p=h.render;return h=h.displayName,h||(h=p.displayName||p.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case L:return p=h.displayName||null,p!==null?p:B(h.type)||"Memo";case k:p=h._payload,h=h._init;try{return B(h(p))}catch{}}return null}var W=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},H=[],N=-1;function O(h){return{current:h}}function z(h){0>N||(h.current=H[N],H[N]=null,N--)}function G(h,p){N++,H[N]=h.current,h.current=p}var Y=O(null),Q=O(null),J=O(null),ee=O(null);function oe(h,p){switch(G(J,p),G(Q,h),G(Y,null),p.nodeType){case 9:case 11:h=(h=p.documentElement)&&(h=h.namespaceURI)?xj(h):0;break;default:if(h=p.tagName,p=p.namespaceURI)p=xj(p),h=wj(p,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}z(Y),G(Y,h)}function te(){z(Y),z(Q),z(J)}function se(h){h.memoizedState!==null&&G(ee,h);var p=Y.current,v=wj(p,h.type);p!==v&&(G(Q,h),G(Y,v))}function he(h){Q.current===h&&(z(Y),z(Q)),ee.current===h&&(z(ee),op._currentValue=q)}var Z=Object.prototype.hasOwnProperty,pe=n.unstable_scheduleCallback,ye=n.unstable_cancelCallback,ae=n.unstable_shouldYield,le=n.unstable_requestPaint,ie=n.unstable_now,fe=n.unstable_getCurrentPriorityLevel,Ie=n.unstable_ImmediatePriority,ne=n.unstable_UserBlockingPriority,ce=n.unstable_NormalPriority,Ce=n.unstable_LowPriority,Oe=n.unstable_IdlePriority,ze=n.log,We=n.unstable_setDisableYieldValue,tt=null,lt=null;function Ee(h){if(typeof ze=="function"&&We(h),lt&&typeof lt.setStrictMode=="function")try{lt.setStrictMode(tt,h)}catch{}}var be=Math.clz32?Math.clz32:Ue,Ae=Math.log,Me=Math.LN2;function Ue(h){return h>>>=0,h===0?32:31-(Ae(h)/Me|0)|0}var Ge=256,Ke=4194304;function Qe(h){var p=h&42;if(p!==0)return p;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function ht(h,p,v){var w=h.pendingLanes;if(w===0)return 0;var A=0,P=h.suspendedLanes,X=h.pingedLanes;h=h.warmLanes;var re=w&134217727;return re!==0?(w=re&~P,w!==0?A=Qe(w):(X&=re,X!==0?A=Qe(X):v||(v=re&~h,v!==0&&(A=Qe(v))))):(re=w&~P,re!==0?A=Qe(re):X!==0?A=Qe(X):v||(v=w&~h,v!==0&&(A=Qe(v)))),A===0?0:p!==0&&p!==A&&(p&P)===0&&(P=A&-A,v=p&-p,P>=v||P===32&&(v&4194048)!==0)?p:A}function Vt(h,p){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&p)===0}function mn(h,p){switch(h){case 1:case 2:case 4:case 8:case 64:return p+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xn(){var h=Ge;return Ge<<=1,(Ge&4194048)===0&&(Ge=256),h}function Bn(){var h=Ke;return Ke<<=1,(Ke&62914560)===0&&(Ke=4194304),h}function An(h){for(var p=[],v=0;31>v;v++)p.push(h);return p}function Lt(h,p){h.pendingLanes|=p,p!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function jt(h,p,v,w,A,P){var X=h.pendingLanes;h.pendingLanes=v,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=v,h.entangledLanes&=v,h.errorRecoveryDisabledLanes&=v,h.shellSuspendCounter=0;var re=h.entanglements,de=h.expirationTimes,Re=h.hiddenUpdates;for(v=X&~v;0<v;){var Fe=31-be(v),Ve=1<<Fe;re[Fe]=0,de[Fe]=-1;var ke=Re[Fe];if(ke!==null)for(Re[Fe]=null,Fe=0;Fe<ke.length;Fe++){var Le=ke[Fe];Le!==null&&(Le.lane&=-536870913)}v&=~Ve}w!==0&&Xt(h,w,0),P!==0&&A===0&&h.tag!==0&&(h.suspendedLanes|=P&~(X&~p))}function Xt(h,p,v){h.pendingLanes|=p,h.suspendedLanes&=~p;var w=31-be(p);h.entangledLanes|=p,h.entanglements[w]=h.entanglements[w]|1073741824|v&4194090}function nt(h,p){var v=h.entangledLanes|=p;for(h=h.entanglements;v;){var w=31-be(v),A=1<<w;A&p|h[w]&p&&(h[w]|=p),v&=~A}}function Je(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function ot(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function Dt(){var h=j.p;return h!==0?h:(h=window.event,h===void 0?32:$j(h.type))}function me(h,p){var v=j.p;try{return j.p=h,p()}finally{j.p=v}}var Ye=Math.random().toString(36).slice(2),Xe="__reactFiber$"+Ye,st="__reactProps$"+Ye,wt="__reactContainer$"+Ye,qt="__reactEvents$"+Ye,At="__reactListeners$"+Ye,Tt="__reactHandles$"+Ye,zt="__reactResources$"+Ye,Mn="__reactMarker$"+Ye;function jr(h){delete h[Xe],delete h[st],delete h[qt],delete h[At],delete h[Tt]}function bs(h){var p=h[Xe];if(p)return p;for(var v=h.parentNode;v;){if(p=v[wt]||v[Xe]){if(v=p.alternate,p.child!==null||v!==null&&v.child!==null)for(h=_j(h);h!==null;){if(v=h[Xe])return v;h=_j(h)}return p}h=v,v=h.parentNode}return null}function Ea(h){if(h=h[Xe]||h[wt]){var p=h.tag;if(p===5||p===6||p===13||p===26||p===27||p===3)return h}return null}function to(h){var p=h.tag;if(p===5||p===26||p===27||p===6)return h.stateNode;throw Error(r(33))}function Xo(h){var p=h[zt];return p||(p=h[zt]={hoistableStyles:new Map,hoistableScripts:new Map}),p}function Rr(h){h[Mn]=!0}var Sa=new Set,y0={};function Ta(h,p){Qo(h,p),Qo(h+"Capture",p)}function Qo(h,p){for(y0[h]=p,h=0;h<p.length;h++)Sa.add(p[h])}var eJ=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dM={},hM={};function tJ(h){return Z.call(hM,h)?!0:Z.call(dM,h)?!1:eJ.test(h)?hM[h]=!0:(dM[h]=!0,!1)}function b0(h,p,v){if(tJ(p))if(v===null)h.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":h.removeAttribute(p);return;case"boolean":var w=p.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){h.removeAttribute(p);return}}h.setAttribute(p,""+v)}}function x0(h,p,v){if(v===null)h.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(p);return}h.setAttribute(p,""+v)}}function Zo(h,p,v,w){if(w===null)h.removeAttribute(v);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(v);return}h.setAttributeNS(p,v,""+w)}}var sT,fM;function Pd(h){if(sT===void 0)try{throw Error()}catch(v){var p=v.stack.trim().match(/\n( *(at )?)/);sT=p&&p[1]||"",fM=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sT+h+fM}var iT=!1;function aT(h,p){if(!h||iT)return"";iT=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(p){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(Le){var ke=Le}Reflect.construct(h,[],Ve)}else{try{Ve.call()}catch(Le){ke=Le}h.call(Ve.prototype)}}else{try{throw Error()}catch(Le){ke=Le}(Ve=h())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(Le){if(Le&&ke&&typeof Le.stack=="string")return[Le.stack,ke.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=w.DetermineComponentFrameRoot(),X=P[0],re=P[1];if(X&&re){var de=X.split(`
`),Re=re.split(`
`);for(A=w=0;w<de.length&&!de[w].includes("DetermineComponentFrameRoot");)w++;for(;A<Re.length&&!Re[A].includes("DetermineComponentFrameRoot");)A++;if(w===de.length||A===Re.length)for(w=de.length-1,A=Re.length-1;1<=w&&0<=A&&de[w]!==Re[A];)A--;for(;1<=w&&0<=A;w--,A--)if(de[w]!==Re[A]){if(w!==1||A!==1)do if(w--,A--,0>A||de[w]!==Re[A]){var Fe=`
`+de[w].replace(" at new "," at ");return h.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",h.displayName)),Fe}while(1<=w&&0<=A);break}}}finally{iT=!1,Error.prepareStackTrace=v}return(v=h?h.displayName||h.name:"")?Pd(v):""}function nJ(h){switch(h.tag){case 26:case 27:case 5:return Pd(h.type);case 16:return Pd("Lazy");case 13:return Pd("Suspense");case 19:return Pd("SuspenseList");case 0:case 15:return aT(h.type,!1);case 11:return aT(h.type.render,!1);case 1:return aT(h.type,!0);case 31:return Pd("Activity");default:return""}}function mM(h){try{var p="";do p+=nJ(h),h=h.return;while(h);return p}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function Bi(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function pM(h){var p=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function rJ(h){var p=pM(h)?"checked":"value",v=Object.getOwnPropertyDescriptor(h.constructor.prototype,p),w=""+h[p];if(!h.hasOwnProperty(p)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var A=v.get,P=v.set;return Object.defineProperty(h,p,{configurable:!0,get:function(){return A.call(this)},set:function(X){w=""+X,P.call(this,X)}}),Object.defineProperty(h,p,{enumerable:v.enumerable}),{getValue:function(){return w},setValue:function(X){w=""+X},stopTracking:function(){h._valueTracker=null,delete h[p]}}}}function w0(h){h._valueTracker||(h._valueTracker=rJ(h))}function gM(h){if(!h)return!1;var p=h._valueTracker;if(!p)return!0;var v=p.getValue(),w="";return h&&(w=pM(h)?h.checked?"true":"false":h.value),h=w,h!==v?(p.setValue(h),!0):!1}function E0(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var sJ=/[\n"\\]/g;function Hi(h){return h.replace(sJ,function(p){return"\\"+p.charCodeAt(0).toString(16)+" "})}function oT(h,p,v,w,A,P,X,re){h.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?h.type=X:h.removeAttribute("type"),p!=null?X==="number"?(p===0&&h.value===""||h.value!=p)&&(h.value=""+Bi(p)):h.value!==""+Bi(p)&&(h.value=""+Bi(p)):X!=="submit"&&X!=="reset"||h.removeAttribute("value"),p!=null?lT(h,X,Bi(p)):v!=null?lT(h,X,Bi(v)):w!=null&&h.removeAttribute("value"),A==null&&P!=null&&(h.defaultChecked=!!P),A!=null&&(h.checked=A&&typeof A!="function"&&typeof A!="symbol"),re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?h.name=""+Bi(re):h.removeAttribute("name")}function vM(h,p,v,w,A,P,X,re){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(h.type=P),p!=null||v!=null){if(!(P!=="submit"&&P!=="reset"||p!=null))return;v=v!=null?""+Bi(v):"",p=p!=null?""+Bi(p):v,re||p===h.value||(h.value=p),h.defaultValue=p}w=w??A,w=typeof w!="function"&&typeof w!="symbol"&&!!w,h.checked=re?h.checked:!!w,h.defaultChecked=!!w,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(h.name=X)}function lT(h,p,v){p==="number"&&E0(h.ownerDocument)===h||h.defaultValue===""+v||(h.defaultValue=""+v)}function Md(h,p,v,w){if(h=h.options,p){p={};for(var A=0;A<v.length;A++)p["$"+v[A]]=!0;for(v=0;v<h.length;v++)A=p.hasOwnProperty("$"+h[v].value),h[v].selected!==A&&(h[v].selected=A),A&&w&&(h[v].defaultSelected=!0)}else{for(v=""+Bi(v),p=null,A=0;A<h.length;A++){if(h[A].value===v){h[A].selected=!0,w&&(h[A].defaultSelected=!0);return}p!==null||h[A].disabled||(p=h[A])}p!==null&&(p.selected=!0)}}function yM(h,p,v){if(p!=null&&(p=""+Bi(p),p!==h.value&&(h.value=p),v==null)){h.defaultValue!==p&&(h.defaultValue=p);return}h.defaultValue=v!=null?""+Bi(v):""}function bM(h,p,v,w){if(p==null){if(w!=null){if(v!=null)throw Error(r(92));if(W(w)){if(1<w.length)throw Error(r(93));w=w[0]}v=w}v==null&&(v=""),p=v}v=Bi(p),h.defaultValue=v,w=h.textContent,w===v&&w!==""&&w!==null&&(h.value=w)}function Od(h,p){if(p){var v=h.firstChild;if(v&&v===h.lastChild&&v.nodeType===3){v.nodeValue=p;return}}h.textContent=p}var iJ=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xM(h,p,v){var w=p.indexOf("--")===0;v==null||typeof v=="boolean"||v===""?w?h.setProperty(p,""):p==="float"?h.cssFloat="":h[p]="":w?h.setProperty(p,v):typeof v!="number"||v===0||iJ.has(p)?p==="float"?h.cssFloat=v:h[p]=(""+v).trim():h[p]=v+"px"}function wM(h,p,v){if(p!=null&&typeof p!="object")throw Error(r(62));if(h=h.style,v!=null){for(var w in v)!v.hasOwnProperty(w)||p!=null&&p.hasOwnProperty(w)||(w.indexOf("--")===0?h.setProperty(w,""):w==="float"?h.cssFloat="":h[w]="");for(var A in p)w=p[A],p.hasOwnProperty(A)&&v[A]!==w&&xM(h,A,w)}else for(var P in p)p.hasOwnProperty(P)&&xM(h,P,p[P])}function cT(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aJ=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),oJ=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function S0(h){return oJ.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}var uT=null;function dT(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var Nd=null,jd=null;function EM(h){var p=Ea(h);if(p&&(h=p.stateNode)){var v=h[st]||null;e:switch(h=p.stateNode,p.type){case"input":if(oT(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name),p=v.name,v.type==="radio"&&p!=null){for(v=h;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll('input[name="'+Hi(""+p)+'"][type="radio"]'),p=0;p<v.length;p++){var w=v[p];if(w!==h&&w.form===h.form){var A=w[st]||null;if(!A)throw Error(r(90));oT(w,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(p=0;p<v.length;p++)w=v[p],w.form===h.form&&gM(w)}break e;case"textarea":yM(h,v.value,v.defaultValue);break e;case"select":p=v.value,p!=null&&Md(h,!!v.multiple,p,!1)}}}var hT=!1;function SM(h,p,v){if(hT)return h(p,v);hT=!0;try{var w=h(p);return w}finally{if(hT=!1,(Nd!==null||jd!==null)&&(ly(),Nd&&(p=Nd,h=jd,jd=Nd=null,EM(p),h)))for(p=0;p<h.length;p++)EM(h[p])}}function xm(h,p){var v=h.stateNode;if(v===null)return null;var w=v[st]||null;if(w===null)return null;v=w[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(h=h.type,w=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!w;break e;default:h=!1}if(h)return null;if(v&&typeof v!="function")throw Error(r(231,p,typeof v));return v}var Jo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fT=!1;if(Jo)try{var wm={};Object.defineProperty(wm,"passive",{get:function(){fT=!0}}),window.addEventListener("test",wm,wm),window.removeEventListener("test",wm,wm)}catch{fT=!1}var ql=null,mT=null,T0=null;function TM(){if(T0)return T0;var h,p=mT,v=p.length,w,A="value"in ql?ql.value:ql.textContent,P=A.length;for(h=0;h<v&&p[h]===A[h];h++);var X=v-h;for(w=1;w<=X&&p[v-w]===A[P-w];w++);return T0=A.slice(h,1<w?1-w:void 0)}function _0(h){var p=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&p===13&&(h=13)):h=p,h===10&&(h=13),32<=h||h===13?h:0}function A0(){return!0}function _M(){return!1}function Ys(h){function p(v,w,A,P,X){this._reactName=v,this._targetInst=A,this.type=w,this.nativeEvent=P,this.target=X,this.currentTarget=null;for(var re in h)h.hasOwnProperty(re)&&(v=h[re],this[re]=v?v(P):P[re]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?A0:_M,this.isPropagationStopped=_M,this}return u(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=A0)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=A0)},persist:function(){},isPersistent:A0}),p}var yu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},R0=Ys(yu),Em=u({},yu,{view:0,detail:0}),lJ=Ys(Em),pT,gT,Sm,C0=u({},Em,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yT,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==Sm&&(Sm&&h.type==="mousemove"?(pT=h.screenX-Sm.screenX,gT=h.screenY-Sm.screenY):gT=pT=0,Sm=h),pT)},movementY:function(h){return"movementY"in h?h.movementY:gT}}),AM=Ys(C0),cJ=u({},C0,{dataTransfer:0}),uJ=Ys(cJ),dJ=u({},Em,{relatedTarget:0}),vT=Ys(dJ),hJ=u({},yu,{animationName:0,elapsedTime:0,pseudoElement:0}),fJ=Ys(hJ),mJ=u({},yu,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),pJ=Ys(mJ),gJ=u({},yu,{data:0}),RM=Ys(gJ),vJ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yJ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bJ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xJ(h){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(h):(h=bJ[h])?!!p[h]:!1}function yT(){return xJ}var wJ=u({},Em,{key:function(h){if(h.key){var p=vJ[h.key]||h.key;if(p!=="Unidentified")return p}return h.type==="keypress"?(h=_0(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?yJ[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yT,charCode:function(h){return h.type==="keypress"?_0(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?_0(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),EJ=Ys(wJ),SJ=u({},C0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),CM=Ys(SJ),TJ=u({},Em,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yT}),_J=Ys(TJ),AJ=u({},yu,{propertyName:0,elapsedTime:0,pseudoElement:0}),RJ=Ys(AJ),CJ=u({},C0,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),kJ=Ys(CJ),IJ=u({},yu,{newState:0,oldState:0}),LJ=Ys(IJ),DJ=[9,13,27,32],bT=Jo&&"CompositionEvent"in window,Tm=null;Jo&&"documentMode"in document&&(Tm=document.documentMode);var PJ=Jo&&"TextEvent"in window&&!Tm,kM=Jo&&(!bT||Tm&&8<Tm&&11>=Tm),IM=" ",LM=!1;function DM(h,p){switch(h){case"keyup":return DJ.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PM(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Fd=!1;function MJ(h,p){switch(h){case"compositionend":return PM(p);case"keypress":return p.which!==32?null:(LM=!0,IM);case"textInput":return h=p.data,h===IM&&LM?null:h;default:return null}}function OJ(h,p){if(Fd)return h==="compositionend"||!bT&&DM(h,p)?(h=TM(),T0=mT=ql=null,Fd=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return kM&&p.locale!=="ko"?null:p.data;default:return null}}var NJ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function MM(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p==="input"?!!NJ[h.type]:p==="textarea"}function OM(h,p,v,w){Nd?jd?jd.push(w):jd=[w]:Nd=w,p=my(p,"onChange"),0<p.length&&(v=new R0("onChange","change",null,v,w),h.push({event:v,listeners:p}))}var _m=null,Am=null;function jJ(h){pj(h,0)}function k0(h){var p=to(h);if(gM(p))return h}function NM(h,p){if(h==="change")return p}var jM=!1;if(Jo){var xT;if(Jo){var wT="oninput"in document;if(!wT){var FM=document.createElement("div");FM.setAttribute("oninput","return;"),wT=typeof FM.oninput=="function"}xT=wT}else xT=!1;jM=xT&&(!document.documentMode||9<document.documentMode)}function UM(){_m&&(_m.detachEvent("onpropertychange",$M),Am=_m=null)}function $M(h){if(h.propertyName==="value"&&k0(Am)){var p=[];OM(p,Am,h,dT(h)),SM(jJ,p)}}function FJ(h,p,v){h==="focusin"?(UM(),_m=p,Am=v,_m.attachEvent("onpropertychange",$M)):h==="focusout"&&UM()}function UJ(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return k0(Am)}function $J(h,p){if(h==="click")return k0(p)}function BJ(h,p){if(h==="input"||h==="change")return k0(p)}function HJ(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var xi=typeof Object.is=="function"?Object.is:HJ;function Rm(h,p){if(xi(h,p))return!0;if(typeof h!="object"||h===null||typeof p!="object"||p===null)return!1;var v=Object.keys(h),w=Object.keys(p);if(v.length!==w.length)return!1;for(w=0;w<v.length;w++){var A=v[w];if(!Z.call(p,A)||!xi(h[A],p[A]))return!1}return!0}function BM(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function HM(h,p){var v=BM(h);h=0;for(var w;v;){if(v.nodeType===3){if(w=h+v.textContent.length,h<=p&&w>=p)return{node:v,offset:p-h};h=w}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=BM(v)}}function VM(h,p){return h&&p?h===p?!0:h&&h.nodeType===3?!1:p&&p.nodeType===3?VM(h,p.parentNode):"contains"in h?h.contains(p):h.compareDocumentPosition?!!(h.compareDocumentPosition(p)&16):!1:!1}function zM(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var p=E0(h.document);p instanceof h.HTMLIFrameElement;){try{var v=typeof p.contentWindow.location.href=="string"}catch{v=!1}if(v)h=p.contentWindow;else break;p=E0(h.document)}return p}function ET(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p&&(p==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||p==="textarea"||h.contentEditable==="true")}var VJ=Jo&&"documentMode"in document&&11>=document.documentMode,Ud=null,ST=null,Cm=null,TT=!1;function GM(h,p,v){var w=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;TT||Ud==null||Ud!==E0(w)||(w=Ud,"selectionStart"in w&&ET(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Cm&&Rm(Cm,w)||(Cm=w,w=my(ST,"onSelect"),0<w.length&&(p=new R0("onSelect","select",null,p,v),h.push({event:p,listeners:w}),p.target=Ud)))}function bu(h,p){var v={};return v[h.toLowerCase()]=p.toLowerCase(),v["Webkit"+h]="webkit"+p,v["Moz"+h]="moz"+p,v}var $d={animationend:bu("Animation","AnimationEnd"),animationiteration:bu("Animation","AnimationIteration"),animationstart:bu("Animation","AnimationStart"),transitionrun:bu("Transition","TransitionRun"),transitionstart:bu("Transition","TransitionStart"),transitioncancel:bu("Transition","TransitionCancel"),transitionend:bu("Transition","TransitionEnd")},_T={},qM={};Jo&&(qM=document.createElement("div").style,"AnimationEvent"in window||(delete $d.animationend.animation,delete $d.animationiteration.animation,delete $d.animationstart.animation),"TransitionEvent"in window||delete $d.transitionend.transition);function xu(h){if(_T[h])return _T[h];if(!$d[h])return h;var p=$d[h],v;for(v in p)if(p.hasOwnProperty(v)&&v in qM)return _T[h]=p[v];return h}var WM=xu("animationend"),KM=xu("animationiteration"),YM=xu("animationstart"),zJ=xu("transitionrun"),GJ=xu("transitionstart"),qJ=xu("transitioncancel"),XM=xu("transitionend"),QM=new Map,AT="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");AT.push("scrollEnd");function _a(h,p){QM.set(h,p),Ta(p,[h])}var ZM=new WeakMap;function Vi(h,p){if(typeof h=="object"&&h!==null){var v=ZM.get(h);return v!==void 0?v:(p={value:h,source:p,stack:mM(p)},ZM.set(h,p),p)}return{value:h,source:p,stack:mM(p)}}var zi=[],Bd=0,RT=0;function I0(){for(var h=Bd,p=RT=Bd=0;p<h;){var v=zi[p];zi[p++]=null;var w=zi[p];zi[p++]=null;var A=zi[p];zi[p++]=null;var P=zi[p];if(zi[p++]=null,w!==null&&A!==null){var X=w.pending;X===null?A.next=A:(A.next=X.next,X.next=A),w.pending=A}P!==0&&JM(v,A,P)}}function L0(h,p,v,w){zi[Bd++]=h,zi[Bd++]=p,zi[Bd++]=v,zi[Bd++]=w,RT|=w,h.lanes|=w,h=h.alternate,h!==null&&(h.lanes|=w)}function CT(h,p,v,w){return L0(h,p,v,w),D0(h)}function Hd(h,p){return L0(h,null,null,p),D0(h)}function JM(h,p,v){h.lanes|=v;var w=h.alternate;w!==null&&(w.lanes|=v);for(var A=!1,P=h.return;P!==null;)P.childLanes|=v,w=P.alternate,w!==null&&(w.childLanes|=v),P.tag===22&&(h=P.stateNode,h===null||h._visibility&1||(A=!0)),h=P,P=P.return;return h.tag===3?(P=h.stateNode,A&&p!==null&&(A=31-be(v),h=P.hiddenUpdates,w=h[A],w===null?h[A]=[p]:w.push(p),p.lane=v|536870912),P):null}function D0(h){if(50<Jm)throw Jm=0,M_=null,Error(r(185));for(var p=h.return;p!==null;)h=p,p=h.return;return h.tag===3?h.stateNode:null}var Vd={};function WJ(h,p,v,w){this.tag=h,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(h,p,v,w){return new WJ(h,p,v,w)}function kT(h){return h=h.prototype,!(!h||!h.isReactComponent)}function el(h,p){var v=h.alternate;return v===null?(v=wi(h.tag,p,h.key,h.mode),v.elementType=h.elementType,v.type=h.type,v.stateNode=h.stateNode,v.alternate=h,h.alternate=v):(v.pendingProps=p,v.type=h.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=h.flags&65011712,v.childLanes=h.childLanes,v.lanes=h.lanes,v.child=h.child,v.memoizedProps=h.memoizedProps,v.memoizedState=h.memoizedState,v.updateQueue=h.updateQueue,p=h.dependencies,v.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},v.sibling=h.sibling,v.index=h.index,v.ref=h.ref,v.refCleanup=h.refCleanup,v}function eO(h,p){h.flags&=65011714;var v=h.alternate;return v===null?(h.childLanes=0,h.lanes=p,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=v.childLanes,h.lanes=v.lanes,h.child=v.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=v.memoizedProps,h.memoizedState=v.memoizedState,h.updateQueue=v.updateQueue,h.type=v.type,p=v.dependencies,h.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),h}function P0(h,p,v,w,A,P){var X=0;if(w=h,typeof h=="function")kT(h)&&(X=1);else if(typeof h=="string")X=Yee(h,v,Y.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case M:return h=wi(31,v,p,A),h.elementType=M,h.lanes=P,h;case y:return wu(v.children,A,P,p);case b:X=8,A|=24;break;case x:return h=wi(12,v,p,A|2),h.elementType=x,h.lanes=P,h;case I:return h=wi(13,v,p,A),h.elementType=I,h.lanes=P,h;case C:return h=wi(19,v,p,A),h.elementType=C,h.lanes=P,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case S:case _:X=10;break e;case T:X=9;break e;case R:X=11;break e;case L:X=14;break e;case k:X=16,w=null;break e}X=29,v=Error(r(130,h===null?"null":typeof h,"")),w=null}return p=wi(X,v,p,A),p.elementType=h,p.type=w,p.lanes=P,p}function wu(h,p,v,w){return h=wi(7,h,w,p),h.lanes=v,h}function IT(h,p,v){return h=wi(6,h,null,p),h.lanes=v,h}function LT(h,p,v){return p=wi(4,h.children!==null?h.children:[],h.key,p),p.lanes=v,p.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},p}var zd=[],Gd=0,M0=null,O0=0,Gi=[],qi=0,Eu=null,tl=1,nl="";function Su(h,p){zd[Gd++]=O0,zd[Gd++]=M0,M0=h,O0=p}function tO(h,p,v){Gi[qi++]=tl,Gi[qi++]=nl,Gi[qi++]=Eu,Eu=h;var w=tl;h=nl;var A=32-be(w)-1;w&=~(1<<A),v+=1;var P=32-be(p)+A;if(30<P){var X=A-A%5;P=(w&(1<<X)-1).toString(32),w>>=X,A-=X,tl=1<<32-be(p)+A|v<<A|w,nl=P+h}else tl=1<<P|v<<A|w,nl=h}function DT(h){h.return!==null&&(Su(h,1),tO(h,1,0))}function PT(h){for(;h===M0;)M0=zd[--Gd],zd[Gd]=null,O0=zd[--Gd],zd[Gd]=null;for(;h===Eu;)Eu=Gi[--qi],Gi[qi]=null,nl=Gi[--qi],Gi[qi]=null,tl=Gi[--qi],Gi[qi]=null}var Us=null,lr=null,yn=!1,Tu=null,no=!1,MT=Error(r(519));function _u(h){var p=Error(r(418,""));throw Lm(Vi(p,h)),MT}function nO(h){var p=h.stateNode,v=h.type,w=h.memoizedProps;switch(p[Xe]=h,p[st]=w,v){case"dialog":sn("cancel",p),sn("close",p);break;case"iframe":case"object":case"embed":sn("load",p);break;case"video":case"audio":for(v=0;v<tp.length;v++)sn(tp[v],p);break;case"source":sn("error",p);break;case"img":case"image":case"link":sn("error",p),sn("load",p);break;case"details":sn("toggle",p);break;case"input":sn("invalid",p),vM(p,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0),w0(p);break;case"select":sn("invalid",p);break;case"textarea":sn("invalid",p),bM(p,w.value,w.defaultValue,w.children),w0(p)}v=w.children,typeof v!="string"&&typeof v!="number"&&typeof v!="bigint"||p.textContent===""+v||w.suppressHydrationWarning===!0||bj(p.textContent,v)?(w.popover!=null&&(sn("beforetoggle",p),sn("toggle",p)),w.onScroll!=null&&sn("scroll",p),w.onScrollEnd!=null&&sn("scrollend",p),w.onClick!=null&&(p.onclick=py),p=!0):p=!1,p||_u(h)}function rO(h){for(Us=h.return;Us;)switch(Us.tag){case 5:case 13:no=!1;return;case 27:case 3:no=!0;return;default:Us=Us.return}}function km(h){if(h!==Us)return!1;if(!yn)return rO(h),yn=!0,!1;var p=h.tag,v;if((v=p!==3&&p!==27)&&((v=p===5)&&(v=h.type,v=!(v!=="form"&&v!=="button")||X_(h.type,h.memoizedProps)),v=!v),v&&lr&&_u(h),rO(h),p===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));e:{for(h=h.nextSibling,p=0;h;){if(h.nodeType===8)if(v=h.data,v==="/$"){if(p===0){lr=Ra(h.nextSibling);break e}p--}else v!=="$"&&v!=="$!"&&v!=="$?"||p++;h=h.nextSibling}lr=null}}else p===27?(p=lr,lc(h.type)?(h=e1,e1=null,lr=h):lr=p):lr=Us?Ra(h.stateNode.nextSibling):null;return!0}function Im(){lr=Us=null,yn=!1}function sO(){var h=Tu;return h!==null&&(Zs===null?Zs=h:Zs.push.apply(Zs,h),Tu=null),h}function Lm(h){Tu===null?Tu=[h]:Tu.push(h)}var OT=O(null),Au=null,rl=null;function Wl(h,p,v){G(OT,p._currentValue),p._currentValue=v}function sl(h){h._currentValue=OT.current,z(OT)}function NT(h,p,v){for(;h!==null;){var w=h.alternate;if((h.childLanes&p)!==p?(h.childLanes|=p,w!==null&&(w.childLanes|=p)):w!==null&&(w.childLanes&p)!==p&&(w.childLanes|=p),h===v)break;h=h.return}}function jT(h,p,v,w){var A=h.child;for(A!==null&&(A.return=h);A!==null;){var P=A.dependencies;if(P!==null){var X=A.child;P=P.firstContext;e:for(;P!==null;){var re=P;P=A;for(var de=0;de<p.length;de++)if(re.context===p[de]){P.lanes|=v,re=P.alternate,re!==null&&(re.lanes|=v),NT(P.return,v,h),w||(X=null);break e}P=re.next}}else if(A.tag===18){if(X=A.return,X===null)throw Error(r(341));X.lanes|=v,P=X.alternate,P!==null&&(P.lanes|=v),NT(X,v,h),X=null}else X=A.child;if(X!==null)X.return=A;else for(X=A;X!==null;){if(X===h){X=null;break}if(A=X.sibling,A!==null){A.return=X.return,X=A;break}X=X.return}A=X}}function Dm(h,p,v,w){h=null;for(var A=p,P=!1;A!==null;){if(!P){if((A.flags&524288)!==0)P=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var X=A.alternate;if(X===null)throw Error(r(387));if(X=X.memoizedProps,X!==null){var re=A.type;xi(A.pendingProps.value,X.value)||(h!==null?h.push(re):h=[re])}}else if(A===ee.current){if(X=A.alternate,X===null)throw Error(r(387));X.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(h!==null?h.push(op):h=[op])}A=A.return}h!==null&&jT(p,h,v,w),p.flags|=262144}function N0(h){for(h=h.firstContext;h!==null;){if(!xi(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function Ru(h){Au=h,rl=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function xs(h){return iO(Au,h)}function j0(h,p){return Au===null&&Ru(h),iO(h,p)}function iO(h,p){var v=p._currentValue;if(p={context:p,memoizedValue:v,next:null},rl===null){if(h===null)throw Error(r(308));rl=p,h.dependencies={lanes:0,firstContext:p},h.flags|=524288}else rl=rl.next=p;return v}var KJ=typeof AbortController<"u"?AbortController:function(){var h=[],p=this.signal={aborted:!1,addEventListener:function(v,w){h.push(w)}};this.abort=function(){p.aborted=!0,h.forEach(function(v){return v()})}},YJ=n.unstable_scheduleCallback,XJ=n.unstable_NormalPriority,Fr={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function FT(){return{controller:new KJ,data:new Map,refCount:0}}function Pm(h){h.refCount--,h.refCount===0&&YJ(XJ,function(){h.controller.abort()})}var Mm=null,UT=0,qd=0,Wd=null;function QJ(h,p){if(Mm===null){var v=Mm=[];UT=0,qd=B_(),Wd={status:"pending",value:void 0,then:function(w){v.push(w)}}}return UT++,p.then(aO,aO),p}function aO(){if(--UT===0&&Mm!==null){Wd!==null&&(Wd.status="fulfilled");var h=Mm;Mm=null,qd=0,Wd=null;for(var p=0;p<h.length;p++)(0,h[p])()}}function ZJ(h,p){var v=[],w={status:"pending",value:null,reason:null,then:function(A){v.push(A)}};return h.then(function(){w.status="fulfilled",w.value=p;for(var A=0;A<v.length;A++)(0,v[A])(p)},function(A){for(w.status="rejected",w.reason=A,A=0;A<v.length;A++)(0,v[A])(void 0)}),w}var oO=F.S;F.S=function(h,p){typeof p=="object"&&p!==null&&typeof p.then=="function"&&QJ(h,p),oO!==null&&oO(h,p)};var Cu=O(null);function $T(){var h=Cu.current;return h!==null?h:Fn.pooledCache}function F0(h,p){p===null?G(Cu,Cu.current):G(Cu,p.pool)}function lO(){var h=$T();return h===null?null:{parent:Fr._currentValue,pool:h}}var Om=Error(r(460)),cO=Error(r(474)),U0=Error(r(542)),BT={then:function(){}};function uO(h){return h=h.status,h==="fulfilled"||h==="rejected"}function $0(){}function dO(h,p,v){switch(v=h[v],v===void 0?h.push(p):v!==p&&(p.then($0,$0),p=v),p.status){case"fulfilled":return p.value;case"rejected":throw h=p.reason,fO(h),h;default:if(typeof p.status=="string")p.then($0,$0);else{if(h=Fn,h!==null&&100<h.shellSuspendCounter)throw Error(r(482));h=p,h.status="pending",h.then(function(w){if(p.status==="pending"){var A=p;A.status="fulfilled",A.value=w}},function(w){if(p.status==="pending"){var A=p;A.status="rejected",A.reason=w}})}switch(p.status){case"fulfilled":return p.value;case"rejected":throw h=p.reason,fO(h),h}throw Nm=p,Om}}var Nm=null;function hO(){if(Nm===null)throw Error(r(459));var h=Nm;return Nm=null,h}function fO(h){if(h===Om||h===U0)throw Error(r(483))}var Kl=!1;function HT(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function VT(h,p){h=h.updateQueue,p.updateQueue===h&&(p.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function Yl(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Xl(h,p,v){var w=h.updateQueue;if(w===null)return null;if(w=w.shared,(Sn&2)!==0){var A=w.pending;return A===null?p.next=p:(p.next=A.next,A.next=p),w.pending=p,p=D0(h),JM(h,null,v),p}return L0(h,w,p,v),D0(h)}function jm(h,p,v){if(p=p.updateQueue,p!==null&&(p=p.shared,(v&4194048)!==0)){var w=p.lanes;w&=h.pendingLanes,v|=w,p.lanes=v,nt(h,v)}}function zT(h,p){var v=h.updateQueue,w=h.alternate;if(w!==null&&(w=w.updateQueue,v===w)){var A=null,P=null;if(v=v.firstBaseUpdate,v!==null){do{var X={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};P===null?A=P=X:P=P.next=X,v=v.next}while(v!==null);P===null?A=P=p:P=P.next=p}else A=P=p;v={baseState:w.baseState,firstBaseUpdate:A,lastBaseUpdate:P,shared:w.shared,callbacks:w.callbacks},h.updateQueue=v;return}h=v.lastBaseUpdate,h===null?v.firstBaseUpdate=p:h.next=p,v.lastBaseUpdate=p}var GT=!1;function Fm(){if(GT){var h=Wd;if(h!==null)throw h}}function Um(h,p,v,w){GT=!1;var A=h.updateQueue;Kl=!1;var P=A.firstBaseUpdate,X=A.lastBaseUpdate,re=A.shared.pending;if(re!==null){A.shared.pending=null;var de=re,Re=de.next;de.next=null,X===null?P=Re:X.next=Re,X=de;var Fe=h.alternate;Fe!==null&&(Fe=Fe.updateQueue,re=Fe.lastBaseUpdate,re!==X&&(re===null?Fe.firstBaseUpdate=Re:re.next=Re,Fe.lastBaseUpdate=de))}if(P!==null){var Ve=A.baseState;X=0,Fe=Re=de=null,re=P;do{var ke=re.lane&-536870913,Le=ke!==re.lane;if(Le?(un&ke)===ke:(w&ke)===ke){ke!==0&&ke===qd&&(GT=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var Pt=h,Ct=re;ke=p;var kn=v;switch(Ct.tag){case 1:if(Pt=Ct.payload,typeof Pt=="function"){Ve=Pt.call(kn,Ve,ke);break e}Ve=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=Ct.payload,ke=typeof Pt=="function"?Pt.call(kn,Ve,ke):Pt,ke==null)break e;Ve=u({},Ve,ke);break e;case 2:Kl=!0}}ke=re.callback,ke!==null&&(h.flags|=64,Le&&(h.flags|=8192),Le=A.callbacks,Le===null?A.callbacks=[ke]:Le.push(ke))}else Le={lane:ke,tag:re.tag,payload:re.payload,callback:re.callback,next:null},Fe===null?(Re=Fe=Le,de=Ve):Fe=Fe.next=Le,X|=ke;if(re=re.next,re===null){if(re=A.shared.pending,re===null)break;Le=re,re=Le.next,Le.next=null,A.lastBaseUpdate=Le,A.shared.pending=null}}while(!0);Fe===null&&(de=Ve),A.baseState=de,A.firstBaseUpdate=Re,A.lastBaseUpdate=Fe,P===null&&(A.shared.lanes=0),sc|=X,h.lanes=X,h.memoizedState=Ve}}function mO(h,p){if(typeof h!="function")throw Error(r(191,h));h.call(p)}function pO(h,p){var v=h.callbacks;if(v!==null)for(h.callbacks=null,h=0;h<v.length;h++)mO(v[h],p)}var Kd=O(null),B0=O(0);function gO(h,p){h=dl,G(B0,h),G(Kd,p),dl=h|p.baseLanes}function qT(){G(B0,dl),G(Kd,Kd.current)}function WT(){dl=B0.current,z(Kd),z(B0)}var Ql=0,Zt=null,Rn=null,Cr=null,H0=!1,Yd=!1,ku=!1,V0=0,$m=0,Xd=null,JJ=0;function yr(){throw Error(r(321))}function KT(h,p){if(p===null)return!1;for(var v=0;v<p.length&&v<h.length;v++)if(!xi(h[v],p[v]))return!1;return!0}function YT(h,p,v,w,A,P){return Ql=P,Zt=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,F.H=h===null||h.memoizedState===null?JO:eN,ku=!1,P=v(w,A),ku=!1,Yd&&(P=yO(p,v,w,A)),vO(h),P}function vO(h){F.H=Y0;var p=Rn!==null&&Rn.next!==null;if(Ql=0,Cr=Rn=Zt=null,H0=!1,$m=0,Xd=null,p)throw Error(r(300));h===null||Gr||(h=h.dependencies,h!==null&&N0(h)&&(Gr=!0))}function yO(h,p,v,w){Zt=h;var A=0;do{if(Yd&&(Xd=null),$m=0,Yd=!1,25<=A)throw Error(r(301));if(A+=1,Cr=Rn=null,h.updateQueue!=null){var P=h.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}F.H=aee,P=p(v,w)}while(Yd);return P}function eee(){var h=F.H,p=h.useState()[0];return p=typeof p.then=="function"?Bm(p):p,h=h.useState()[0],(Rn!==null?Rn.memoizedState:null)!==h&&(Zt.flags|=1024),p}function XT(){var h=V0!==0;return V0=0,h}function QT(h,p,v){p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~v}function ZT(h){if(H0){for(h=h.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}H0=!1}Ql=0,Cr=Rn=Zt=null,Yd=!1,$m=V0=0,Xd=null}function Xs(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cr===null?Zt.memoizedState=Cr=h:Cr=Cr.next=h,Cr}function kr(){if(Rn===null){var h=Zt.alternate;h=h!==null?h.memoizedState:null}else h=Rn.next;var p=Cr===null?Zt.memoizedState:Cr.next;if(p!==null)Cr=p,Rn=h;else{if(h===null)throw Zt.alternate===null?Error(r(467)):Error(r(310));Rn=h,h={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},Cr===null?Zt.memoizedState=Cr=h:Cr=Cr.next=h}return Cr}function JT(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bm(h){var p=$m;return $m+=1,Xd===null&&(Xd=[]),h=dO(Xd,h,p),p=Zt,(Cr===null?p.memoizedState:Cr.next)===null&&(p=p.alternate,F.H=p===null||p.memoizedState===null?JO:eN),h}function z0(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Bm(h);if(h.$$typeof===_)return xs(h)}throw Error(r(438,String(h)))}function e_(h){var p=null,v=Zt.updateQueue;if(v!==null&&(p=v.memoCache),p==null){var w=Zt.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(p={data:w.data.map(function(A){return A.slice()}),index:0})))}if(p==null&&(p={data:[],index:0}),v===null&&(v=JT(),Zt.updateQueue=v),v.memoCache=p,v=p.data[p.index],v===void 0)for(v=p.data[p.index]=Array(h),w=0;w<h;w++)v[w]=D;return p.index++,v}function il(h,p){return typeof p=="function"?p(h):p}function G0(h){var p=kr();return t_(p,Rn,h)}function t_(h,p,v){var w=h.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=v;var A=h.baseQueue,P=w.pending;if(P!==null){if(A!==null){var X=A.next;A.next=P.next,P.next=X}p.baseQueue=A=P,w.pending=null}if(P=h.baseState,A===null)h.memoizedState=P;else{p=A.next;var re=X=null,de=null,Re=p,Fe=!1;do{var Ve=Re.lane&-536870913;if(Ve!==Re.lane?(un&Ve)===Ve:(Ql&Ve)===Ve){var ke=Re.revertLane;if(ke===0)de!==null&&(de=de.next={lane:0,revertLane:0,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null}),Ve===qd&&(Fe=!0);else if((Ql&ke)===ke){Re=Re.next,ke===qd&&(Fe=!0);continue}else Ve={lane:0,revertLane:Re.revertLane,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null},de===null?(re=de=Ve,X=P):de=de.next=Ve,Zt.lanes|=ke,sc|=ke;Ve=Re.action,ku&&v(P,Ve),P=Re.hasEagerState?Re.eagerState:v(P,Ve)}else ke={lane:Ve,revertLane:Re.revertLane,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null},de===null?(re=de=ke,X=P):de=de.next=ke,Zt.lanes|=Ve,sc|=Ve;Re=Re.next}while(Re!==null&&Re!==p);if(de===null?X=P:de.next=re,!xi(P,h.memoizedState)&&(Gr=!0,Fe&&(v=Wd,v!==null)))throw v;h.memoizedState=P,h.baseState=X,h.baseQueue=de,w.lastRenderedState=P}return A===null&&(w.lanes=0),[h.memoizedState,w.dispatch]}function n_(h){var p=kr(),v=p.queue;if(v===null)throw Error(r(311));v.lastRenderedReducer=h;var w=v.dispatch,A=v.pending,P=p.memoizedState;if(A!==null){v.pending=null;var X=A=A.next;do P=h(P,X.action),X=X.next;while(X!==A);xi(P,p.memoizedState)||(Gr=!0),p.memoizedState=P,p.baseQueue===null&&(p.baseState=P),v.lastRenderedState=P}return[P,w]}function bO(h,p,v){var w=Zt,A=kr(),P=yn;if(P){if(v===void 0)throw Error(r(407));v=v()}else v=p();var X=!xi((Rn||A).memoizedState,v);X&&(A.memoizedState=v,Gr=!0),A=A.queue;var re=EO.bind(null,w,A,h);if(Hm(2048,8,re,[h]),A.getSnapshot!==p||X||Cr!==null&&Cr.memoizedState.tag&1){if(w.flags|=2048,Qd(9,q0(),wO.bind(null,w,A,v,p),null),Fn===null)throw Error(r(349));P||(Ql&124)!==0||xO(w,p,v)}return v}function xO(h,p,v){h.flags|=16384,h={getSnapshot:p,value:v},p=Zt.updateQueue,p===null?(p=JT(),Zt.updateQueue=p,p.stores=[h]):(v=p.stores,v===null?p.stores=[h]:v.push(h))}function wO(h,p,v,w){p.value=v,p.getSnapshot=w,SO(p)&&TO(h)}function EO(h,p,v){return v(function(){SO(p)&&TO(h)})}function SO(h){var p=h.getSnapshot;h=h.value;try{var v=p();return!xi(h,v)}catch{return!0}}function TO(h){var p=Hd(h,2);p!==null&&Ai(p,h,2)}function r_(h){var p=Xs();if(typeof h=="function"){var v=h;if(h=v(),ku){Ee(!0);try{v()}finally{Ee(!1)}}}return p.memoizedState=p.baseState=h,p.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:h},p}function _O(h,p,v,w){return h.baseState=v,t_(h,Rn,typeof w=="function"?w:il)}function tee(h,p,v,w,A){if(K0(h))throw Error(r(485));if(h=p.action,h!==null){var P={payload:A,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){P.listeners.push(X)}};F.T!==null?v(!0):P.isTransition=!1,w(P),v=p.pending,v===null?(P.next=p.pending=P,AO(p,P)):(P.next=v.next,p.pending=v.next=P)}}function AO(h,p){var v=p.action,w=p.payload,A=h.state;if(p.isTransition){var P=F.T,X={};F.T=X;try{var re=v(A,w),de=F.S;de!==null&&de(X,re),RO(h,p,re)}catch(Re){s_(h,p,Re)}finally{F.T=P}}else try{P=v(A,w),RO(h,p,P)}catch(Re){s_(h,p,Re)}}function RO(h,p,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(w){CO(h,p,w)},function(w){return s_(h,p,w)}):CO(h,p,v)}function CO(h,p,v){p.status="fulfilled",p.value=v,kO(p),h.state=v,p=h.pending,p!==null&&(v=p.next,v===p?h.pending=null:(v=v.next,p.next=v,AO(h,v)))}function s_(h,p,v){var w=h.pending;if(h.pending=null,w!==null){w=w.next;do p.status="rejected",p.reason=v,kO(p),p=p.next;while(p!==w)}h.action=null}function kO(h){h=h.listeners;for(var p=0;p<h.length;p++)(0,h[p])()}function IO(h,p){return p}function LO(h,p){if(yn){var v=Fn.formState;if(v!==null){e:{var w=Zt;if(yn){if(lr){t:{for(var A=lr,P=no;A.nodeType!==8;){if(!P){A=null;break t}if(A=Ra(A.nextSibling),A===null){A=null;break t}}P=A.data,A=P==="F!"||P==="F"?A:null}if(A){lr=Ra(A.nextSibling),w=A.data==="F!";break e}}_u(w)}w=!1}w&&(p=v[0])}}return v=Xs(),v.memoizedState=v.baseState=p,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:IO,lastRenderedState:p},v.queue=w,v=XO.bind(null,Zt,w),w.dispatch=v,w=r_(!1),P=c_.bind(null,Zt,!1,w.queue),w=Xs(),A={state:p,dispatch:null,action:h,pending:null},w.queue=A,v=tee.bind(null,Zt,A,P,v),A.dispatch=v,w.memoizedState=h,[p,v,!1]}function DO(h){var p=kr();return PO(p,Rn,h)}function PO(h,p,v){if(p=t_(h,p,IO)[0],h=G0(il)[0],typeof p=="object"&&p!==null&&typeof p.then=="function")try{var w=Bm(p)}catch(X){throw X===Om?U0:X}else w=p;p=kr();var A=p.queue,P=A.dispatch;return v!==p.memoizedState&&(Zt.flags|=2048,Qd(9,q0(),nee.bind(null,A,v),null)),[w,P,h]}function nee(h,p){h.action=p}function MO(h){var p=kr(),v=Rn;if(v!==null)return PO(p,v,h);kr(),p=p.memoizedState,v=kr();var w=v.queue.dispatch;return v.memoizedState=h,[p,w,!1]}function Qd(h,p,v,w){return h={tag:h,create:v,deps:w,inst:p,next:null},p=Zt.updateQueue,p===null&&(p=JT(),Zt.updateQueue=p),v=p.lastEffect,v===null?p.lastEffect=h.next=h:(w=v.next,v.next=h,h.next=w,p.lastEffect=h),h}function q0(){return{destroy:void 0,resource:void 0}}function OO(){return kr().memoizedState}function W0(h,p,v,w){var A=Xs();w=w===void 0?null:w,Zt.flags|=h,A.memoizedState=Qd(1|p,q0(),v,w)}function Hm(h,p,v,w){var A=kr();w=w===void 0?null:w;var P=A.memoizedState.inst;Rn!==null&&w!==null&&KT(w,Rn.memoizedState.deps)?A.memoizedState=Qd(p,P,v,w):(Zt.flags|=h,A.memoizedState=Qd(1|p,P,v,w))}function NO(h,p){W0(8390656,8,h,p)}function jO(h,p){Hm(2048,8,h,p)}function FO(h,p){return Hm(4,2,h,p)}function UO(h,p){return Hm(4,4,h,p)}function $O(h,p){if(typeof p=="function"){h=h();var v=p(h);return function(){typeof v=="function"?v():p(null)}}if(p!=null)return h=h(),p.current=h,function(){p.current=null}}function BO(h,p,v){v=v!=null?v.concat([h]):null,Hm(4,4,$O.bind(null,p,h),v)}function i_(){}function HO(h,p){var v=kr();p=p===void 0?null:p;var w=v.memoizedState;return p!==null&&KT(p,w[1])?w[0]:(v.memoizedState=[h,p],h)}function VO(h,p){var v=kr();p=p===void 0?null:p;var w=v.memoizedState;if(p!==null&&KT(p,w[1]))return w[0];if(w=h(),ku){Ee(!0);try{h()}finally{Ee(!1)}}return v.memoizedState=[w,p],w}function a_(h,p,v){return v===void 0||(Ql&1073741824)!==0?h.memoizedState=p:(h.memoizedState=v,h=qN(),Zt.lanes|=h,sc|=h,v)}function zO(h,p,v,w){return xi(v,p)?v:Kd.current!==null?(h=a_(h,v,w),xi(h,p)||(Gr=!0),h):(Ql&42)===0?(Gr=!0,h.memoizedState=v):(h=qN(),Zt.lanes|=h,sc|=h,p)}function GO(h,p,v,w,A){var P=j.p;j.p=P!==0&&8>P?P:8;var X=F.T,re={};F.T=re,c_(h,!1,p,v);try{var de=A(),Re=F.S;if(Re!==null&&Re(re,de),de!==null&&typeof de=="object"&&typeof de.then=="function"){var Fe=ZJ(de,w);Vm(h,p,Fe,_i(h))}else Vm(h,p,w,_i(h))}catch(Ve){Vm(h,p,{then:function(){},status:"rejected",reason:Ve},_i())}finally{j.p=P,F.T=X}}function ree(){}function o_(h,p,v,w){if(h.tag!==5)throw Error(r(476));var A=qO(h).queue;GO(h,A,p,q,v===null?ree:function(){return WO(h),v(w)})}function qO(h){var p=h.memoizedState;if(p!==null)return p;p={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:q},next:null};var v={};return p.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:v},next:null},h.memoizedState=p,h=h.alternate,h!==null&&(h.memoizedState=p),p}function WO(h){var p=qO(h).next.queue;Vm(h,p,{},_i())}function l_(){return xs(op)}function KO(){return kr().memoizedState}function YO(){return kr().memoizedState}function see(h){for(var p=h.return;p!==null;){switch(p.tag){case 24:case 3:var v=_i();h=Yl(v);var w=Xl(p,h,v);w!==null&&(Ai(w,p,v),jm(w,p,v)),p={cache:FT()},h.payload=p;return}p=p.return}}function iee(h,p,v){var w=_i();v={lane:w,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},K0(h)?QO(p,v):(v=CT(h,p,v,w),v!==null&&(Ai(v,h,w),ZO(v,p,w)))}function XO(h,p,v){var w=_i();Vm(h,p,v,w)}function Vm(h,p,v,w){var A={lane:w,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(K0(h))QO(p,A);else{var P=h.alternate;if(h.lanes===0&&(P===null||P.lanes===0)&&(P=p.lastRenderedReducer,P!==null))try{var X=p.lastRenderedState,re=P(X,v);if(A.hasEagerState=!0,A.eagerState=re,xi(re,X))return L0(h,p,A,0),Fn===null&&I0(),!1}catch{}finally{}if(v=CT(h,p,A,w),v!==null)return Ai(v,h,w),ZO(v,p,w),!0}return!1}function c_(h,p,v,w){if(w={lane:2,revertLane:B_(),action:w,hasEagerState:!1,eagerState:null,next:null},K0(h)){if(p)throw Error(r(479))}else p=CT(h,v,w,2),p!==null&&Ai(p,h,2)}function K0(h){var p=h.alternate;return h===Zt||p!==null&&p===Zt}function QO(h,p){Yd=H0=!0;var v=h.pending;v===null?p.next=p:(p.next=v.next,v.next=p),h.pending=p}function ZO(h,p,v){if((v&4194048)!==0){var w=p.lanes;w&=h.pendingLanes,v|=w,p.lanes=v,nt(h,v)}}var Y0={readContext:xs,use:z0,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useLayoutEffect:yr,useInsertionEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useSyncExternalStore:yr,useId:yr,useHostTransitionStatus:yr,useFormState:yr,useActionState:yr,useOptimistic:yr,useMemoCache:yr,useCacheRefresh:yr},JO={readContext:xs,use:z0,useCallback:function(h,p){return Xs().memoizedState=[h,p===void 0?null:p],h},useContext:xs,useEffect:NO,useImperativeHandle:function(h,p,v){v=v!=null?v.concat([h]):null,W0(4194308,4,$O.bind(null,p,h),v)},useLayoutEffect:function(h,p){return W0(4194308,4,h,p)},useInsertionEffect:function(h,p){W0(4,2,h,p)},useMemo:function(h,p){var v=Xs();p=p===void 0?null:p;var w=h();if(ku){Ee(!0);try{h()}finally{Ee(!1)}}return v.memoizedState=[w,p],w},useReducer:function(h,p,v){var w=Xs();if(v!==void 0){var A=v(p);if(ku){Ee(!0);try{v(p)}finally{Ee(!1)}}}else A=p;return w.memoizedState=w.baseState=A,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:A},w.queue=h,h=h.dispatch=iee.bind(null,Zt,h),[w.memoizedState,h]},useRef:function(h){var p=Xs();return h={current:h},p.memoizedState=h},useState:function(h){h=r_(h);var p=h.queue,v=XO.bind(null,Zt,p);return p.dispatch=v,[h.memoizedState,v]},useDebugValue:i_,useDeferredValue:function(h,p){var v=Xs();return a_(v,h,p)},useTransition:function(){var h=r_(!1);return h=GO.bind(null,Zt,h.queue,!0,!1),Xs().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,p,v){var w=Zt,A=Xs();if(yn){if(v===void 0)throw Error(r(407));v=v()}else{if(v=p(),Fn===null)throw Error(r(349));(un&124)!==0||xO(w,p,v)}A.memoizedState=v;var P={value:v,getSnapshot:p};return A.queue=P,NO(EO.bind(null,w,P,h),[h]),w.flags|=2048,Qd(9,q0(),wO.bind(null,w,P,v,p),null),v},useId:function(){var h=Xs(),p=Fn.identifierPrefix;if(yn){var v=nl,w=tl;v=(w&~(1<<32-be(w)-1)).toString(32)+v,p=""+p+"R"+v,v=V0++,0<v&&(p+="H"+v.toString(32)),p+=""}else v=JJ++,p=""+p+"r"+v.toString(32)+"";return h.memoizedState=p},useHostTransitionStatus:l_,useFormState:LO,useActionState:LO,useOptimistic:function(h){var p=Xs();p.memoizedState=p.baseState=h;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return p.queue=v,p=c_.bind(null,Zt,!0,v),v.dispatch=p,[h,p]},useMemoCache:e_,useCacheRefresh:function(){return Xs().memoizedState=see.bind(null,Zt)}},eN={readContext:xs,use:z0,useCallback:HO,useContext:xs,useEffect:jO,useImperativeHandle:BO,useInsertionEffect:FO,useLayoutEffect:UO,useMemo:VO,useReducer:G0,useRef:OO,useState:function(){return G0(il)},useDebugValue:i_,useDeferredValue:function(h,p){var v=kr();return zO(v,Rn.memoizedState,h,p)},useTransition:function(){var h=G0(il)[0],p=kr().memoizedState;return[typeof h=="boolean"?h:Bm(h),p]},useSyncExternalStore:bO,useId:KO,useHostTransitionStatus:l_,useFormState:DO,useActionState:DO,useOptimistic:function(h,p){var v=kr();return _O(v,Rn,h,p)},useMemoCache:e_,useCacheRefresh:YO},aee={readContext:xs,use:z0,useCallback:HO,useContext:xs,useEffect:jO,useImperativeHandle:BO,useInsertionEffect:FO,useLayoutEffect:UO,useMemo:VO,useReducer:n_,useRef:OO,useState:function(){return n_(il)},useDebugValue:i_,useDeferredValue:function(h,p){var v=kr();return Rn===null?a_(v,h,p):zO(v,Rn.memoizedState,h,p)},useTransition:function(){var h=n_(il)[0],p=kr().memoizedState;return[typeof h=="boolean"?h:Bm(h),p]},useSyncExternalStore:bO,useId:KO,useHostTransitionStatus:l_,useFormState:MO,useActionState:MO,useOptimistic:function(h,p){var v=kr();return Rn!==null?_O(v,Rn,h,p):(v.baseState=h,[h,v.queue.dispatch])},useMemoCache:e_,useCacheRefresh:YO},Zd=null,zm=0;function X0(h){var p=zm;return zm+=1,Zd===null&&(Zd=[]),dO(Zd,h,p)}function Gm(h,p){p=p.props.ref,h.ref=p!==void 0?p:null}function Q0(h,p){throw p.$$typeof===f?Error(r(525)):(h=Object.prototype.toString.call(p),Error(r(31,h==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":h)))}function tN(h){var p=h._init;return p(h._payload)}function nN(h){function p(we,ge){if(h){var Te=we.deletions;Te===null?(we.deletions=[ge],we.flags|=16):Te.push(ge)}}function v(we,ge){if(!h)return null;for(;ge!==null;)p(we,ge),ge=ge.sibling;return null}function w(we){for(var ge=new Map;we!==null;)we.key!==null?ge.set(we.key,we):ge.set(we.index,we),we=we.sibling;return ge}function A(we,ge){return we=el(we,ge),we.index=0,we.sibling=null,we}function P(we,ge,Te){return we.index=Te,h?(Te=we.alternate,Te!==null?(Te=Te.index,Te<ge?(we.flags|=67108866,ge):Te):(we.flags|=67108866,ge)):(we.flags|=1048576,ge)}function X(we){return h&&we.alternate===null&&(we.flags|=67108866),we}function re(we,ge,Te,Be){return ge===null||ge.tag!==6?(ge=IT(Te,we.mode,Be),ge.return=we,ge):(ge=A(ge,Te),ge.return=we,ge)}function de(we,ge,Te,Be){var vt=Te.type;return vt===y?Fe(we,ge,Te.props.children,Be,Te.key):ge!==null&&(ge.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===k&&tN(vt)===ge.type)?(ge=A(ge,Te.props),Gm(ge,Te),ge.return=we,ge):(ge=P0(Te.type,Te.key,Te.props,null,we.mode,Be),Gm(ge,Te),ge.return=we,ge)}function Re(we,ge,Te,Be){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Te.containerInfo||ge.stateNode.implementation!==Te.implementation?(ge=LT(Te,we.mode,Be),ge.return=we,ge):(ge=A(ge,Te.children||[]),ge.return=we,ge)}function Fe(we,ge,Te,Be,vt){return ge===null||ge.tag!==7?(ge=wu(Te,we.mode,Be,vt),ge.return=we,ge):(ge=A(ge,Te),ge.return=we,ge)}function Ve(we,ge,Te){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ge=IT(""+ge,we.mode,Te),ge.return=we,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case m:return Te=P0(ge.type,ge.key,ge.props,null,we.mode,Te),Gm(Te,ge),Te.return=we,Te;case g:return ge=LT(ge,we.mode,Te),ge.return=we,ge;case k:var Be=ge._init;return ge=Be(ge._payload),Ve(we,ge,Te)}if(W(ge)||$(ge))return ge=wu(ge,we.mode,Te,null),ge.return=we,ge;if(typeof ge.then=="function")return Ve(we,X0(ge),Te);if(ge.$$typeof===_)return Ve(we,j0(we,ge),Te);Q0(we,ge)}return null}function ke(we,ge,Te,Be){var vt=ge!==null?ge.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return vt!==null?null:re(we,ge,""+Te,Be);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case m:return Te.key===vt?de(we,ge,Te,Be):null;case g:return Te.key===vt?Re(we,ge,Te,Be):null;case k:return vt=Te._init,Te=vt(Te._payload),ke(we,ge,Te,Be)}if(W(Te)||$(Te))return vt!==null?null:Fe(we,ge,Te,Be,null);if(typeof Te.then=="function")return ke(we,ge,X0(Te),Be);if(Te.$$typeof===_)return ke(we,ge,j0(we,Te),Be);Q0(we,Te)}return null}function Le(we,ge,Te,Be,vt){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return we=we.get(Te)||null,re(ge,we,""+Be,vt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case m:return we=we.get(Be.key===null?Te:Be.key)||null,de(ge,we,Be,vt);case g:return we=we.get(Be.key===null?Te:Be.key)||null,Re(ge,we,Be,vt);case k:var tn=Be._init;return Be=tn(Be._payload),Le(we,ge,Te,Be,vt)}if(W(Be)||$(Be))return we=we.get(Te)||null,Fe(ge,we,Be,vt,null);if(typeof Be.then=="function")return Le(we,ge,Te,X0(Be),vt);if(Be.$$typeof===_)return Le(we,ge,Te,j0(ge,Be),vt);Q0(ge,Be)}return null}function Pt(we,ge,Te,Be){for(var vt=null,tn=null,St=ge,It=ge=0,Wr=null;St!==null&&It<Te.length;It++){St.index>It?(Wr=St,St=null):Wr=St.sibling;var pn=ke(we,St,Te[It],Be);if(pn===null){St===null&&(St=Wr);break}h&&St&&pn.alternate===null&&p(we,St),ge=P(pn,ge,It),tn===null?vt=pn:tn.sibling=pn,tn=pn,St=Wr}if(It===Te.length)return v(we,St),yn&&Su(we,It),vt;if(St===null){for(;It<Te.length;It++)St=Ve(we,Te[It],Be),St!==null&&(ge=P(St,ge,It),tn===null?vt=St:tn.sibling=St,tn=St);return yn&&Su(we,It),vt}for(St=w(St);It<Te.length;It++)Wr=Le(St,we,It,Te[It],Be),Wr!==null&&(h&&Wr.alternate!==null&&St.delete(Wr.key===null?It:Wr.key),ge=P(Wr,ge,It),tn===null?vt=Wr:tn.sibling=Wr,tn=Wr);return h&&St.forEach(function(fc){return p(we,fc)}),yn&&Su(we,It),vt}function Ct(we,ge,Te,Be){if(Te==null)throw Error(r(151));for(var vt=null,tn=null,St=ge,It=ge=0,Wr=null,pn=Te.next();St!==null&&!pn.done;It++,pn=Te.next()){St.index>It?(Wr=St,St=null):Wr=St.sibling;var fc=ke(we,St,pn.value,Be);if(fc===null){St===null&&(St=Wr);break}h&&St&&fc.alternate===null&&p(we,St),ge=P(fc,ge,It),tn===null?vt=fc:tn.sibling=fc,tn=fc,St=Wr}if(pn.done)return v(we,St),yn&&Su(we,It),vt;if(St===null){for(;!pn.done;It++,pn=Te.next())pn=Ve(we,pn.value,Be),pn!==null&&(ge=P(pn,ge,It),tn===null?vt=pn:tn.sibling=pn,tn=pn);return yn&&Su(we,It),vt}for(St=w(St);!pn.done;It++,pn=Te.next())pn=Le(St,we,It,pn.value,Be),pn!==null&&(h&&pn.alternate!==null&&St.delete(pn.key===null?It:pn.key),ge=P(pn,ge,It),tn===null?vt=pn:tn.sibling=pn,tn=pn);return h&&St.forEach(function(ote){return p(we,ote)}),yn&&Su(we,It),vt}function kn(we,ge,Te,Be){if(typeof Te=="object"&&Te!==null&&Te.type===y&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case m:e:{for(var vt=Te.key;ge!==null;){if(ge.key===vt){if(vt=Te.type,vt===y){if(ge.tag===7){v(we,ge.sibling),Be=A(ge,Te.props.children),Be.return=we,we=Be;break e}}else if(ge.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===k&&tN(vt)===ge.type){v(we,ge.sibling),Be=A(ge,Te.props),Gm(Be,Te),Be.return=we,we=Be;break e}v(we,ge);break}else p(we,ge);ge=ge.sibling}Te.type===y?(Be=wu(Te.props.children,we.mode,Be,Te.key),Be.return=we,we=Be):(Be=P0(Te.type,Te.key,Te.props,null,we.mode,Be),Gm(Be,Te),Be.return=we,we=Be)}return X(we);case g:e:{for(vt=Te.key;ge!==null;){if(ge.key===vt)if(ge.tag===4&&ge.stateNode.containerInfo===Te.containerInfo&&ge.stateNode.implementation===Te.implementation){v(we,ge.sibling),Be=A(ge,Te.children||[]),Be.return=we,we=Be;break e}else{v(we,ge);break}else p(we,ge);ge=ge.sibling}Be=LT(Te,we.mode,Be),Be.return=we,we=Be}return X(we);case k:return vt=Te._init,Te=vt(Te._payload),kn(we,ge,Te,Be)}if(W(Te))return Pt(we,ge,Te,Be);if($(Te)){if(vt=$(Te),typeof vt!="function")throw Error(r(150));return Te=vt.call(Te),Ct(we,ge,Te,Be)}if(typeof Te.then=="function")return kn(we,ge,X0(Te),Be);if(Te.$$typeof===_)return kn(we,ge,j0(we,Te),Be);Q0(we,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint"?(Te=""+Te,ge!==null&&ge.tag===6?(v(we,ge.sibling),Be=A(ge,Te),Be.return=we,we=Be):(v(we,ge),Be=IT(Te,we.mode,Be),Be.return=we,we=Be),X(we)):v(we,ge)}return function(we,ge,Te,Be){try{zm=0;var vt=kn(we,ge,Te,Be);return Zd=null,vt}catch(St){if(St===Om||St===U0)throw St;var tn=wi(29,St,null,we.mode);return tn.lanes=Be,tn.return=we,tn}finally{}}}var Jd=nN(!0),rN=nN(!1),Wi=O(null),ro=null;function Zl(h){var p=h.alternate;G(Ur,Ur.current&1),G(Wi,h),ro===null&&(p===null||Kd.current!==null||p.memoizedState!==null)&&(ro=h)}function sN(h){if(h.tag===22){if(G(Ur,Ur.current),G(Wi,h),ro===null){var p=h.alternate;p!==null&&p.memoizedState!==null&&(ro=h)}}else Jl()}function Jl(){G(Ur,Ur.current),G(Wi,Wi.current)}function al(h){z(Wi),ro===h&&(ro=null),z(Ur)}var Ur=O(0);function Z0(h){for(var p=h;p!==null;){if(p.tag===13){var v=p.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||J_(v)))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}function u_(h,p,v,w){p=h.memoizedState,v=v(w,p),v=v==null?p:u({},p,v),h.memoizedState=v,h.lanes===0&&(h.updateQueue.baseState=v)}var d_={enqueueSetState:function(h,p,v){h=h._reactInternals;var w=_i(),A=Yl(w);A.payload=p,v!=null&&(A.callback=v),p=Xl(h,A,w),p!==null&&(Ai(p,h,w),jm(p,h,w))},enqueueReplaceState:function(h,p,v){h=h._reactInternals;var w=_i(),A=Yl(w);A.tag=1,A.payload=p,v!=null&&(A.callback=v),p=Xl(h,A,w),p!==null&&(Ai(p,h,w),jm(p,h,w))},enqueueForceUpdate:function(h,p){h=h._reactInternals;var v=_i(),w=Yl(v);w.tag=2,p!=null&&(w.callback=p),p=Xl(h,w,v),p!==null&&(Ai(p,h,v),jm(p,h,v))}};function iN(h,p,v,w,A,P,X){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(w,P,X):p.prototype&&p.prototype.isPureReactComponent?!Rm(v,w)||!Rm(A,P):!0}function aN(h,p,v,w){h=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(v,w),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(v,w),p.state!==h&&d_.enqueueReplaceState(p,p.state,null)}function Iu(h,p){var v=p;if("ref"in p){v={};for(var w in p)w!=="ref"&&(v[w]=p[w])}if(h=h.defaultProps){v===p&&(v=u({},v));for(var A in h)v[A]===void 0&&(v[A]=h[A])}return v}var J0=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var p=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(p))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)};function oN(h){J0(h)}function lN(h){console.error(h)}function cN(h){J0(h)}function ey(h,p){try{var v=h.onUncaughtError;v(p.value,{componentStack:p.stack})}catch(w){setTimeout(function(){throw w})}}function uN(h,p,v){try{var w=h.onCaughtError;w(v.value,{componentStack:v.stack,errorBoundary:p.tag===1?p.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function h_(h,p,v){return v=Yl(v),v.tag=3,v.payload={element:null},v.callback=function(){ey(h,p)},v}function dN(h){return h=Yl(h),h.tag=3,h}function hN(h,p,v,w){var A=v.type.getDerivedStateFromError;if(typeof A=="function"){var P=w.value;h.payload=function(){return A(P)},h.callback=function(){uN(p,v,w)}}var X=v.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(h.callback=function(){uN(p,v,w),typeof A!="function"&&(ic===null?ic=new Set([this]):ic.add(this));var re=w.stack;this.componentDidCatch(w.value,{componentStack:re!==null?re:""})})}function oee(h,p,v,w,A){if(v.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(p=v.alternate,p!==null&&Dm(p,v,A,!0),v=Wi.current,v!==null){switch(v.tag){case 13:return ro===null?N_():v.alternate===null&&cr===0&&(cr=3),v.flags&=-257,v.flags|=65536,v.lanes=A,w===BT?v.flags|=16384:(p=v.updateQueue,p===null?v.updateQueue=new Set([w]):p.add(w),F_(h,w,A)),!1;case 22:return v.flags|=65536,w===BT?v.flags|=16384:(p=v.updateQueue,p===null?(p={transitions:null,markerInstances:null,retryQueue:new Set([w])},v.updateQueue=p):(v=p.retryQueue,v===null?p.retryQueue=new Set([w]):v.add(w)),F_(h,w,A)),!1}throw Error(r(435,v.tag))}return F_(h,w,A),N_(),!1}if(yn)return p=Wi.current,p!==null?((p.flags&65536)===0&&(p.flags|=256),p.flags|=65536,p.lanes=A,w!==MT&&(h=Error(r(422),{cause:w}),Lm(Vi(h,v)))):(w!==MT&&(p=Error(r(423),{cause:w}),Lm(Vi(p,v))),h=h.current.alternate,h.flags|=65536,A&=-A,h.lanes|=A,w=Vi(w,v),A=h_(h.stateNode,w,A),zT(h,A),cr!==4&&(cr=2)),!1;var P=Error(r(520),{cause:w});if(P=Vi(P,v),Zm===null?Zm=[P]:Zm.push(P),cr!==4&&(cr=2),p===null)return!0;w=Vi(w,v),v=p;do{switch(v.tag){case 3:return v.flags|=65536,h=A&-A,v.lanes|=h,h=h_(v.stateNode,w,h),zT(v,h),!1;case 1:if(p=v.type,P=v.stateNode,(v.flags&128)===0&&(typeof p.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(ic===null||!ic.has(P))))return v.flags|=65536,A&=-A,v.lanes|=A,A=dN(A),hN(A,h,v,w),zT(v,A),!1}v=v.return}while(v!==null);return!1}var fN=Error(r(461)),Gr=!1;function ls(h,p,v,w){p.child=h===null?rN(p,null,v,w):Jd(p,h.child,v,w)}function mN(h,p,v,w,A){v=v.render;var P=p.ref;if("ref"in w){var X={};for(var re in w)re!=="ref"&&(X[re]=w[re])}else X=w;return Ru(p),w=YT(h,p,v,X,P,A),re=XT(),h!==null&&!Gr?(QT(h,p,A),ol(h,p,A)):(yn&&re&&DT(p),p.flags|=1,ls(h,p,w,A),p.child)}function pN(h,p,v,w,A){if(h===null){var P=v.type;return typeof P=="function"&&!kT(P)&&P.defaultProps===void 0&&v.compare===null?(p.tag=15,p.type=P,gN(h,p,P,w,A)):(h=P0(v.type,null,w,p,p.mode,A),h.ref=p.ref,h.return=p,p.child=h)}if(P=h.child,!x_(h,A)){var X=P.memoizedProps;if(v=v.compare,v=v!==null?v:Rm,v(X,w)&&h.ref===p.ref)return ol(h,p,A)}return p.flags|=1,h=el(P,w),h.ref=p.ref,h.return=p,p.child=h}function gN(h,p,v,w,A){if(h!==null){var P=h.memoizedProps;if(Rm(P,w)&&h.ref===p.ref)if(Gr=!1,p.pendingProps=w=P,x_(h,A))(h.flags&131072)!==0&&(Gr=!0);else return p.lanes=h.lanes,ol(h,p,A)}return f_(h,p,v,w,A)}function vN(h,p,v){var w=p.pendingProps,A=w.children,P=h!==null?h.memoizedState:null;if(w.mode==="hidden"){if((p.flags&128)!==0){if(w=P!==null?P.baseLanes|v:v,h!==null){for(A=p.child=h.child,P=0;A!==null;)P=P|A.lanes|A.childLanes,A=A.sibling;p.childLanes=P&~w}else p.childLanes=0,p.child=null;return yN(h,p,w,v)}if((v&536870912)!==0)p.memoizedState={baseLanes:0,cachePool:null},h!==null&&F0(p,P!==null?P.cachePool:null),P!==null?gO(p,P):qT(),sN(p);else return p.lanes=p.childLanes=536870912,yN(h,p,P!==null?P.baseLanes|v:v,v)}else P!==null?(F0(p,P.cachePool),gO(p,P),Jl(),p.memoizedState=null):(h!==null&&F0(p,null),qT(),Jl());return ls(h,p,A,v),p.child}function yN(h,p,v,w){var A=$T();return A=A===null?null:{parent:Fr._currentValue,pool:A},p.memoizedState={baseLanes:v,cachePool:A},h!==null&&F0(p,null),qT(),sN(p),h!==null&&Dm(h,p,w,!0),null}function ty(h,p){var v=p.ref;if(v===null)h!==null&&h.ref!==null&&(p.flags|=4194816);else{if(typeof v!="function"&&typeof v!="object")throw Error(r(284));(h===null||h.ref!==v)&&(p.flags|=4194816)}}function f_(h,p,v,w,A){return Ru(p),v=YT(h,p,v,w,void 0,A),w=XT(),h!==null&&!Gr?(QT(h,p,A),ol(h,p,A)):(yn&&w&&DT(p),p.flags|=1,ls(h,p,v,A),p.child)}function bN(h,p,v,w,A,P){return Ru(p),p.updateQueue=null,v=yO(p,w,v,A),vO(h),w=XT(),h!==null&&!Gr?(QT(h,p,P),ol(h,p,P)):(yn&&w&&DT(p),p.flags|=1,ls(h,p,v,P),p.child)}function xN(h,p,v,w,A){if(Ru(p),p.stateNode===null){var P=Vd,X=v.contextType;typeof X=="object"&&X!==null&&(P=xs(X)),P=new v(w,P),p.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=d_,p.stateNode=P,P._reactInternals=p,P=p.stateNode,P.props=w,P.state=p.memoizedState,P.refs={},HT(p),X=v.contextType,P.context=typeof X=="object"&&X!==null?xs(X):Vd,P.state=p.memoizedState,X=v.getDerivedStateFromProps,typeof X=="function"&&(u_(p,v,X,w),P.state=p.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(X=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),X!==P.state&&d_.enqueueReplaceState(P,P.state,null),Um(p,w,P,A),Fm(),P.state=p.memoizedState),typeof P.componentDidMount=="function"&&(p.flags|=4194308),w=!0}else if(h===null){P=p.stateNode;var re=p.memoizedProps,de=Iu(v,re);P.props=de;var Re=P.context,Fe=v.contextType;X=Vd,typeof Fe=="object"&&Fe!==null&&(X=xs(Fe));var Ve=v.getDerivedStateFromProps;Fe=typeof Ve=="function"||typeof P.getSnapshotBeforeUpdate=="function",re=p.pendingProps!==re,Fe||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(re||Re!==X)&&aN(p,P,w,X),Kl=!1;var ke=p.memoizedState;P.state=ke,Um(p,w,P,A),Fm(),Re=p.memoizedState,re||ke!==Re||Kl?(typeof Ve=="function"&&(u_(p,v,Ve,w),Re=p.memoizedState),(de=Kl||iN(p,v,de,w,ke,Re,X))?(Fe||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(p.flags|=4194308)):(typeof P.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=w,p.memoizedState=Re),P.props=w,P.state=Re,P.context=X,w=de):(typeof P.componentDidMount=="function"&&(p.flags|=4194308),w=!1)}else{P=p.stateNode,VT(h,p),X=p.memoizedProps,Fe=Iu(v,X),P.props=Fe,Ve=p.pendingProps,ke=P.context,Re=v.contextType,de=Vd,typeof Re=="object"&&Re!==null&&(de=xs(Re)),re=v.getDerivedStateFromProps,(Re=typeof re=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(X!==Ve||ke!==de)&&aN(p,P,w,de),Kl=!1,ke=p.memoizedState,P.state=ke,Um(p,w,P,A),Fm();var Le=p.memoizedState;X!==Ve||ke!==Le||Kl||h!==null&&h.dependencies!==null&&N0(h.dependencies)?(typeof re=="function"&&(u_(p,v,re,w),Le=p.memoizedState),(Fe=Kl||iN(p,v,Fe,w,ke,Le,de)||h!==null&&h.dependencies!==null&&N0(h.dependencies))?(Re||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(w,Le,de),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(w,Le,de)),typeof P.componentDidUpdate=="function"&&(p.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof P.componentDidUpdate!="function"||X===h.memoizedProps&&ke===h.memoizedState||(p.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||X===h.memoizedProps&&ke===h.memoizedState||(p.flags|=1024),p.memoizedProps=w,p.memoizedState=Le),P.props=w,P.state=Le,P.context=de,w=Fe):(typeof P.componentDidUpdate!="function"||X===h.memoizedProps&&ke===h.memoizedState||(p.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||X===h.memoizedProps&&ke===h.memoizedState||(p.flags|=1024),w=!1)}return P=w,ty(h,p),w=(p.flags&128)!==0,P||w?(P=p.stateNode,v=w&&typeof v.getDerivedStateFromError!="function"?null:P.render(),p.flags|=1,h!==null&&w?(p.child=Jd(p,h.child,null,A),p.child=Jd(p,null,v,A)):ls(h,p,v,A),p.memoizedState=P.state,h=p.child):h=ol(h,p,A),h}function wN(h,p,v,w){return Im(),p.flags|=256,ls(h,p,v,w),p.child}var m_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function p_(h){return{baseLanes:h,cachePool:lO()}}function g_(h,p,v){return h=h!==null?h.childLanes&~v:0,p&&(h|=Ki),h}function EN(h,p,v){var w=p.pendingProps,A=!1,P=(p.flags&128)!==0,X;if((X=P)||(X=h!==null&&h.memoizedState===null?!1:(Ur.current&2)!==0),X&&(A=!0,p.flags&=-129),X=(p.flags&32)!==0,p.flags&=-33,h===null){if(yn){if(A?Zl(p):Jl(),yn){var re=lr,de;if(de=re){e:{for(de=re,re=no;de.nodeType!==8;){if(!re){re=null;break e}if(de=Ra(de.nextSibling),de===null){re=null;break e}}re=de}re!==null?(p.memoizedState={dehydrated:re,treeContext:Eu!==null?{id:tl,overflow:nl}:null,retryLane:536870912,hydrationErrors:null},de=wi(18,null,null,0),de.stateNode=re,de.return=p,p.child=de,Us=p,lr=null,de=!0):de=!1}de||_u(p)}if(re=p.memoizedState,re!==null&&(re=re.dehydrated,re!==null))return J_(re)?p.lanes=32:p.lanes=536870912,null;al(p)}return re=w.children,w=w.fallback,A?(Jl(),A=p.mode,re=ny({mode:"hidden",children:re},A),w=wu(w,A,v,null),re.return=p,w.return=p,re.sibling=w,p.child=re,A=p.child,A.memoizedState=p_(v),A.childLanes=g_(h,X,v),p.memoizedState=m_,w):(Zl(p),v_(p,re))}if(de=h.memoizedState,de!==null&&(re=de.dehydrated,re!==null)){if(P)p.flags&256?(Zl(p),p.flags&=-257,p=y_(h,p,v)):p.memoizedState!==null?(Jl(),p.child=h.child,p.flags|=128,p=null):(Jl(),A=w.fallback,re=p.mode,w=ny({mode:"visible",children:w.children},re),A=wu(A,re,v,null),A.flags|=2,w.return=p,A.return=p,w.sibling=A,p.child=w,Jd(p,h.child,null,v),w=p.child,w.memoizedState=p_(v),w.childLanes=g_(h,X,v),p.memoizedState=m_,p=A);else if(Zl(p),J_(re)){if(X=re.nextSibling&&re.nextSibling.dataset,X)var Re=X.dgst;X=Re,w=Error(r(419)),w.stack="",w.digest=X,Lm({value:w,source:null,stack:null}),p=y_(h,p,v)}else if(Gr||Dm(h,p,v,!1),X=(v&h.childLanes)!==0,Gr||X){if(X=Fn,X!==null&&(w=v&-v,w=(w&42)!==0?1:Je(w),w=(w&(X.suspendedLanes|v))!==0?0:w,w!==0&&w!==de.retryLane))throw de.retryLane=w,Hd(h,w),Ai(X,h,w),fN;re.data==="$?"||N_(),p=y_(h,p,v)}else re.data==="$?"?(p.flags|=192,p.child=h.child,p=null):(h=de.treeContext,lr=Ra(re.nextSibling),Us=p,yn=!0,Tu=null,no=!1,h!==null&&(Gi[qi++]=tl,Gi[qi++]=nl,Gi[qi++]=Eu,tl=h.id,nl=h.overflow,Eu=p),p=v_(p,w.children),p.flags|=4096);return p}return A?(Jl(),A=w.fallback,re=p.mode,de=h.child,Re=de.sibling,w=el(de,{mode:"hidden",children:w.children}),w.subtreeFlags=de.subtreeFlags&65011712,Re!==null?A=el(Re,A):(A=wu(A,re,v,null),A.flags|=2),A.return=p,w.return=p,w.sibling=A,p.child=w,w=A,A=p.child,re=h.child.memoizedState,re===null?re=p_(v):(de=re.cachePool,de!==null?(Re=Fr._currentValue,de=de.parent!==Re?{parent:Re,pool:Re}:de):de=lO(),re={baseLanes:re.baseLanes|v,cachePool:de}),A.memoizedState=re,A.childLanes=g_(h,X,v),p.memoizedState=m_,w):(Zl(p),v=h.child,h=v.sibling,v=el(v,{mode:"visible",children:w.children}),v.return=p,v.sibling=null,h!==null&&(X=p.deletions,X===null?(p.deletions=[h],p.flags|=16):X.push(h)),p.child=v,p.memoizedState=null,v)}function v_(h,p){return p=ny({mode:"visible",children:p},h.mode),p.return=h,h.child=p}function ny(h,p){return h=wi(22,h,null,p),h.lanes=0,h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},h}function y_(h,p,v){return Jd(p,h.child,null,v),h=v_(p,p.pendingProps.children),h.flags|=2,p.memoizedState=null,h}function SN(h,p,v){h.lanes|=p;var w=h.alternate;w!==null&&(w.lanes|=p),NT(h.return,p,v)}function b_(h,p,v,w,A){var P=h.memoizedState;P===null?h.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:w,tail:v,tailMode:A}:(P.isBackwards=p,P.rendering=null,P.renderingStartTime=0,P.last=w,P.tail=v,P.tailMode=A)}function TN(h,p,v){var w=p.pendingProps,A=w.revealOrder,P=w.tail;if(ls(h,p,w.children,v),w=Ur.current,(w&2)!==0)w=w&1|2,p.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=p.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&SN(h,v,p);else if(h.tag===19)SN(h,v,p);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===p)break e;for(;h.sibling===null;){if(h.return===null||h.return===p)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}w&=1}switch(G(Ur,w),A){case"forwards":for(v=p.child,A=null;v!==null;)h=v.alternate,h!==null&&Z0(h)===null&&(A=v),v=v.sibling;v=A,v===null?(A=p.child,p.child=null):(A=v.sibling,v.sibling=null),b_(p,!1,A,v,P);break;case"backwards":for(v=null,A=p.child,p.child=null;A!==null;){if(h=A.alternate,h!==null&&Z0(h)===null){p.child=A;break}h=A.sibling,A.sibling=v,v=A,A=h}b_(p,!0,v,null,P);break;case"together":b_(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function ol(h,p,v){if(h!==null&&(p.dependencies=h.dependencies),sc|=p.lanes,(v&p.childLanes)===0)if(h!==null){if(Dm(h,p,v,!1),(v&p.childLanes)===0)return null}else return null;if(h!==null&&p.child!==h.child)throw Error(r(153));if(p.child!==null){for(h=p.child,v=el(h,h.pendingProps),p.child=v,v.return=p;h.sibling!==null;)h=h.sibling,v=v.sibling=el(h,h.pendingProps),v.return=p;v.sibling=null}return p.child}function x_(h,p){return(h.lanes&p)!==0?!0:(h=h.dependencies,!!(h!==null&&N0(h)))}function lee(h,p,v){switch(p.tag){case 3:oe(p,p.stateNode.containerInfo),Wl(p,Fr,h.memoizedState.cache),Im();break;case 27:case 5:se(p);break;case 4:oe(p,p.stateNode.containerInfo);break;case 10:Wl(p,p.type,p.memoizedProps.value);break;case 13:var w=p.memoizedState;if(w!==null)return w.dehydrated!==null?(Zl(p),p.flags|=128,null):(v&p.child.childLanes)!==0?EN(h,p,v):(Zl(p),h=ol(h,p,v),h!==null?h.sibling:null);Zl(p);break;case 19:var A=(h.flags&128)!==0;if(w=(v&p.childLanes)!==0,w||(Dm(h,p,v,!1),w=(v&p.childLanes)!==0),A){if(w)return TN(h,p,v);p.flags|=128}if(A=p.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),G(Ur,Ur.current),w)break;return null;case 22:case 23:return p.lanes=0,vN(h,p,v);case 24:Wl(p,Fr,h.memoizedState.cache)}return ol(h,p,v)}function _N(h,p,v){if(h!==null)if(h.memoizedProps!==p.pendingProps)Gr=!0;else{if(!x_(h,v)&&(p.flags&128)===0)return Gr=!1,lee(h,p,v);Gr=(h.flags&131072)!==0}else Gr=!1,yn&&(p.flags&1048576)!==0&&tO(p,O0,p.index);switch(p.lanes=0,p.tag){case 16:e:{h=p.pendingProps;var w=p.elementType,A=w._init;if(w=A(w._payload),p.type=w,typeof w=="function")kT(w)?(h=Iu(w,h),p.tag=1,p=xN(null,p,w,h,v)):(p.tag=0,p=f_(null,p,w,h,v));else{if(w!=null){if(A=w.$$typeof,A===R){p.tag=11,p=mN(null,p,w,h,v);break e}else if(A===L){p.tag=14,p=pN(null,p,w,h,v);break e}}throw p=B(w)||w,Error(r(306,p,""))}}return p;case 0:return f_(h,p,p.type,p.pendingProps,v);case 1:return w=p.type,A=Iu(w,p.pendingProps),xN(h,p,w,A,v);case 3:e:{if(oe(p,p.stateNode.containerInfo),h===null)throw Error(r(387));w=p.pendingProps;var P=p.memoizedState;A=P.element,VT(h,p),Um(p,w,null,v);var X=p.memoizedState;if(w=X.cache,Wl(p,Fr,w),w!==P.cache&&jT(p,[Fr],v,!0),Fm(),w=X.element,P.isDehydrated)if(P={element:w,isDehydrated:!1,cache:X.cache},p.updateQueue.baseState=P,p.memoizedState=P,p.flags&256){p=wN(h,p,w,v);break e}else if(w!==A){A=Vi(Error(r(424)),p),Lm(A),p=wN(h,p,w,v);break e}else{switch(h=p.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(lr=Ra(h.firstChild),Us=p,yn=!0,Tu=null,no=!0,v=rN(p,null,w,v),p.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling}else{if(Im(),w===A){p=ol(h,p,v);break e}ls(h,p,w,v)}p=p.child}return p;case 26:return ty(h,p),h===null?(v=kj(p.type,null,p.pendingProps,null))?p.memoizedState=v:yn||(v=p.type,h=p.pendingProps,w=gy(J.current).createElement(v),w[Xe]=p,w[st]=h,us(w,v,h),Rr(w),p.stateNode=w):p.memoizedState=kj(p.type,h.memoizedProps,p.pendingProps,h.memoizedState),null;case 27:return se(p),h===null&&yn&&(w=p.stateNode=Aj(p.type,p.pendingProps,J.current),Us=p,no=!0,A=lr,lc(p.type)?(e1=A,lr=Ra(w.firstChild)):lr=A),ls(h,p,p.pendingProps.children,v),ty(h,p),h===null&&(p.flags|=4194304),p.child;case 5:return h===null&&yn&&((A=w=lr)&&(w=Nee(w,p.type,p.pendingProps,no),w!==null?(p.stateNode=w,Us=p,lr=Ra(w.firstChild),no=!1,A=!0):A=!1),A||_u(p)),se(p),A=p.type,P=p.pendingProps,X=h!==null?h.memoizedProps:null,w=P.children,X_(A,P)?w=null:X!==null&&X_(A,X)&&(p.flags|=32),p.memoizedState!==null&&(A=YT(h,p,eee,null,null,v),op._currentValue=A),ty(h,p),ls(h,p,w,v),p.child;case 6:return h===null&&yn&&((h=v=lr)&&(v=jee(v,p.pendingProps,no),v!==null?(p.stateNode=v,Us=p,lr=null,h=!0):h=!1),h||_u(p)),null;case 13:return EN(h,p,v);case 4:return oe(p,p.stateNode.containerInfo),w=p.pendingProps,h===null?p.child=Jd(p,null,w,v):ls(h,p,w,v),p.child;case 11:return mN(h,p,p.type,p.pendingProps,v);case 7:return ls(h,p,p.pendingProps,v),p.child;case 8:return ls(h,p,p.pendingProps.children,v),p.child;case 12:return ls(h,p,p.pendingProps.children,v),p.child;case 10:return w=p.pendingProps,Wl(p,p.type,w.value),ls(h,p,w.children,v),p.child;case 9:return A=p.type._context,w=p.pendingProps.children,Ru(p),A=xs(A),w=w(A),p.flags|=1,ls(h,p,w,v),p.child;case 14:return pN(h,p,p.type,p.pendingProps,v);case 15:return gN(h,p,p.type,p.pendingProps,v);case 19:return TN(h,p,v);case 31:return w=p.pendingProps,v=p.mode,w={mode:w.mode,children:w.children},h===null?(v=ny(w,v),v.ref=p.ref,p.child=v,v.return=p,p=v):(v=el(h.child,w),v.ref=p.ref,p.child=v,v.return=p,p=v),p;case 22:return vN(h,p,v);case 24:return Ru(p),w=xs(Fr),h===null?(A=$T(),A===null&&(A=Fn,P=FT(),A.pooledCache=P,P.refCount++,P!==null&&(A.pooledCacheLanes|=v),A=P),p.memoizedState={parent:w,cache:A},HT(p),Wl(p,Fr,A)):((h.lanes&v)!==0&&(VT(h,p),Um(p,null,null,v),Fm()),A=h.memoizedState,P=p.memoizedState,A.parent!==w?(A={parent:w,cache:w},p.memoizedState=A,p.lanes===0&&(p.memoizedState=p.updateQueue.baseState=A),Wl(p,Fr,w)):(w=P.cache,Wl(p,Fr,w),w!==A.cache&&jT(p,[Fr],v,!0))),ls(h,p,p.pendingProps.children,v),p.child;case 29:throw p.pendingProps}throw Error(r(156,p.tag))}function ll(h){h.flags|=4}function AN(h,p){if(p.type!=="stylesheet"||(p.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!Mj(p)){if(p=Wi.current,p!==null&&((un&4194048)===un?ro!==null:(un&62914560)!==un&&(un&536870912)===0||p!==ro))throw Nm=BT,cO;h.flags|=8192}}function ry(h,p){p!==null&&(h.flags|=4),h.flags&16384&&(p=h.tag!==22?Bn():536870912,h.lanes|=p,rh|=p)}function qm(h,p){if(!yn)switch(h.tailMode){case"hidden":p=h.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?h.tail=null:v.sibling=null;break;case"collapsed":v=h.tail;for(var w=null;v!==null;)v.alternate!==null&&(w=v),v=v.sibling;w===null?p||h.tail===null?h.tail=null:h.tail.sibling=null:w.sibling=null}}function er(h){var p=h.alternate!==null&&h.alternate.child===h.child,v=0,w=0;if(p)for(var A=h.child;A!==null;)v|=A.lanes|A.childLanes,w|=A.subtreeFlags&65011712,w|=A.flags&65011712,A.return=h,A=A.sibling;else for(A=h.child;A!==null;)v|=A.lanes|A.childLanes,w|=A.subtreeFlags,w|=A.flags,A.return=h,A=A.sibling;return h.subtreeFlags|=w,h.childLanes=v,p}function cee(h,p,v){var w=p.pendingProps;switch(PT(p),p.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(p),null;case 1:return er(p),null;case 3:return v=p.stateNode,w=null,h!==null&&(w=h.memoizedState.cache),p.memoizedState.cache!==w&&(p.flags|=2048),sl(Fr),te(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(h===null||h.child===null)&&(km(p)?ll(p):h===null||h.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,sO())),er(p),null;case 26:return v=p.memoizedState,h===null?(ll(p),v!==null?(er(p),AN(p,v)):(er(p),p.flags&=-16777217)):v?v!==h.memoizedState?(ll(p),er(p),AN(p,v)):(er(p),p.flags&=-16777217):(h.memoizedProps!==w&&ll(p),er(p),p.flags&=-16777217),null;case 27:he(p),v=J.current;var A=p.type;if(h!==null&&p.stateNode!=null)h.memoizedProps!==w&&ll(p);else{if(!w){if(p.stateNode===null)throw Error(r(166));return er(p),null}h=Y.current,km(p)?nO(p):(h=Aj(A,w,v),p.stateNode=h,ll(p))}return er(p),null;case 5:if(he(p),v=p.type,h!==null&&p.stateNode!=null)h.memoizedProps!==w&&ll(p);else{if(!w){if(p.stateNode===null)throw Error(r(166));return er(p),null}if(h=Y.current,km(p))nO(p);else{switch(A=gy(J.current),h){case 1:h=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:h=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":h=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":h=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":h=A.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof w.is=="string"?A.createElement("select",{is:w.is}):A.createElement("select"),w.multiple?h.multiple=!0:w.size&&(h.size=w.size);break;default:h=typeof w.is=="string"?A.createElement(v,{is:w.is}):A.createElement(v)}}h[Xe]=p,h[st]=w;e:for(A=p.child;A!==null;){if(A.tag===5||A.tag===6)h.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===p)break e;for(;A.sibling===null;){if(A.return===null||A.return===p)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}p.stateNode=h;e:switch(us(h,v,w),v){case"button":case"input":case"select":case"textarea":h=!!w.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ll(p)}}return er(p),p.flags&=-16777217,null;case 6:if(h&&p.stateNode!=null)h.memoizedProps!==w&&ll(p);else{if(typeof w!="string"&&p.stateNode===null)throw Error(r(166));if(h=J.current,km(p)){if(h=p.stateNode,v=p.memoizedProps,w=null,A=Us,A!==null)switch(A.tag){case 27:case 5:w=A.memoizedProps}h[Xe]=p,h=!!(h.nodeValue===v||w!==null&&w.suppressHydrationWarning===!0||bj(h.nodeValue,v)),h||_u(p)}else h=gy(h).createTextNode(w),h[Xe]=p,p.stateNode=h}return er(p),null;case 13:if(w=p.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(A=km(p),w!==null&&w.dehydrated!==null){if(h===null){if(!A)throw Error(r(318));if(A=p.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));A[Xe]=p}else Im(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;er(p),A=!1}else A=sO(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=A),A=!0;if(!A)return p.flags&256?(al(p),p):(al(p),null)}if(al(p),(p.flags&128)!==0)return p.lanes=v,p;if(v=w!==null,h=h!==null&&h.memoizedState!==null,v){w=p.child,A=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(A=w.alternate.memoizedState.cachePool.pool);var P=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(P=w.memoizedState.cachePool.pool),P!==A&&(w.flags|=2048)}return v!==h&&v&&(p.child.flags|=8192),ry(p,p.updateQueue),er(p),null;case 4:return te(),h===null&&G_(p.stateNode.containerInfo),er(p),null;case 10:return sl(p.type),er(p),null;case 19:if(z(Ur),A=p.memoizedState,A===null)return er(p),null;if(w=(p.flags&128)!==0,P=A.rendering,P===null)if(w)qm(A,!1);else{if(cr!==0||h!==null&&(h.flags&128)!==0)for(h=p.child;h!==null;){if(P=Z0(h),P!==null){for(p.flags|=128,qm(A,!1),h=P.updateQueue,p.updateQueue=h,ry(p,h),p.subtreeFlags=0,h=v,v=p.child;v!==null;)eO(v,h),v=v.sibling;return G(Ur,Ur.current&1|2),p.child}h=h.sibling}A.tail!==null&&ie()>ay&&(p.flags|=128,w=!0,qm(A,!1),p.lanes=4194304)}else{if(!w)if(h=Z0(P),h!==null){if(p.flags|=128,w=!0,h=h.updateQueue,p.updateQueue=h,ry(p,h),qm(A,!0),A.tail===null&&A.tailMode==="hidden"&&!P.alternate&&!yn)return er(p),null}else 2*ie()-A.renderingStartTime>ay&&v!==536870912&&(p.flags|=128,w=!0,qm(A,!1),p.lanes=4194304);A.isBackwards?(P.sibling=p.child,p.child=P):(h=A.last,h!==null?h.sibling=P:p.child=P,A.last=P)}return A.tail!==null?(p=A.tail,A.rendering=p,A.tail=p.sibling,A.renderingStartTime=ie(),p.sibling=null,h=Ur.current,G(Ur,w?h&1|2:h&1),p):(er(p),null);case 22:case 23:return al(p),WT(),w=p.memoizedState!==null,h!==null?h.memoizedState!==null!==w&&(p.flags|=8192):w&&(p.flags|=8192),w?(v&536870912)!==0&&(p.flags&128)===0&&(er(p),p.subtreeFlags&6&&(p.flags|=8192)):er(p),v=p.updateQueue,v!==null&&ry(p,v.retryQueue),v=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),w=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==v&&(p.flags|=2048),h!==null&&z(Cu),null;case 24:return v=null,h!==null&&(v=h.memoizedState.cache),p.memoizedState.cache!==v&&(p.flags|=2048),sl(Fr),er(p),null;case 25:return null;case 30:return null}throw Error(r(156,p.tag))}function uee(h,p){switch(PT(p),p.tag){case 1:return h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 3:return sl(Fr),te(),h=p.flags,(h&65536)!==0&&(h&128)===0?(p.flags=h&-65537|128,p):null;case 26:case 27:case 5:return he(p),null;case 13:if(al(p),h=p.memoizedState,h!==null&&h.dehydrated!==null){if(p.alternate===null)throw Error(r(340));Im()}return h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 19:return z(Ur),null;case 4:return te(),null;case 10:return sl(p.type),null;case 22:case 23:return al(p),WT(),h!==null&&z(Cu),h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 24:return sl(Fr),null;case 25:return null;default:return null}}function RN(h,p){switch(PT(p),p.tag){case 3:sl(Fr),te();break;case 26:case 27:case 5:he(p);break;case 4:te();break;case 13:al(p);break;case 19:z(Ur);break;case 10:sl(p.type);break;case 22:case 23:al(p),WT(),h!==null&&z(Cu);break;case 24:sl(Fr)}}function Wm(h,p){try{var v=p.updateQueue,w=v!==null?v.lastEffect:null;if(w!==null){var A=w.next;v=A;do{if((v.tag&h)===h){w=void 0;var P=v.create,X=v.inst;w=P(),X.destroy=w}v=v.next}while(v!==A)}}catch(re){On(p,p.return,re)}}function ec(h,p,v){try{var w=p.updateQueue,A=w!==null?w.lastEffect:null;if(A!==null){var P=A.next;w=P;do{if((w.tag&h)===h){var X=w.inst,re=X.destroy;if(re!==void 0){X.destroy=void 0,A=p;var de=v,Re=re;try{Re()}catch(Fe){On(A,de,Fe)}}}w=w.next}while(w!==P)}}catch(Fe){On(p,p.return,Fe)}}function CN(h){var p=h.updateQueue;if(p!==null){var v=h.stateNode;try{pO(p,v)}catch(w){On(h,h.return,w)}}}function kN(h,p,v){v.props=Iu(h.type,h.memoizedProps),v.state=h.memoizedState;try{v.componentWillUnmount()}catch(w){On(h,p,w)}}function Km(h,p){try{var v=h.ref;if(v!==null){switch(h.tag){case 26:case 27:case 5:var w=h.stateNode;break;case 30:w=h.stateNode;break;default:w=h.stateNode}typeof v=="function"?h.refCleanup=v(w):v.current=w}}catch(A){On(h,p,A)}}function so(h,p){var v=h.ref,w=h.refCleanup;if(v!==null)if(typeof w=="function")try{w()}catch(A){On(h,p,A)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(A){On(h,p,A)}else v.current=null}function IN(h){var p=h.type,v=h.memoizedProps,w=h.stateNode;try{e:switch(p){case"button":case"input":case"select":case"textarea":v.autoFocus&&w.focus();break e;case"img":v.src?w.src=v.src:v.srcSet&&(w.srcset=v.srcSet)}}catch(A){On(h,h.return,A)}}function w_(h,p,v){try{var w=h.stateNode;Lee(w,h.type,v,p),w[st]=p}catch(A){On(h,h.return,A)}}function LN(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&lc(h.type)||h.tag===4}function E_(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||LN(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&lc(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function S_(h,p,v){var w=h.tag;if(w===5||w===6)h=h.stateNode,p?(v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v).insertBefore(h,p):(p=v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v,p.appendChild(h),v=v._reactRootContainer,v!=null||p.onclick!==null||(p.onclick=py));else if(w!==4&&(w===27&&lc(h.type)&&(v=h.stateNode,p=null),h=h.child,h!==null))for(S_(h,p,v),h=h.sibling;h!==null;)S_(h,p,v),h=h.sibling}function sy(h,p,v){var w=h.tag;if(w===5||w===6)h=h.stateNode,p?v.insertBefore(h,p):v.appendChild(h);else if(w!==4&&(w===27&&lc(h.type)&&(v=h.stateNode),h=h.child,h!==null))for(sy(h,p,v),h=h.sibling;h!==null;)sy(h,p,v),h=h.sibling}function DN(h){var p=h.stateNode,v=h.memoizedProps;try{for(var w=h.type,A=p.attributes;A.length;)p.removeAttributeNode(A[0]);us(p,w,v),p[Xe]=h,p[st]=v}catch(P){On(h,h.return,P)}}var cl=!1,br=!1,T_=!1,PN=typeof WeakSet=="function"?WeakSet:Set,qr=null;function dee(h,p){if(h=h.containerInfo,K_=Ey,h=zM(h),ET(h)){if("selectionStart"in h)var v={start:h.selectionStart,end:h.selectionEnd};else e:{v=(v=h.ownerDocument)&&v.defaultView||window;var w=v.getSelection&&v.getSelection();if(w&&w.rangeCount!==0){v=w.anchorNode;var A=w.anchorOffset,P=w.focusNode;w=w.focusOffset;try{v.nodeType,P.nodeType}catch{v=null;break e}var X=0,re=-1,de=-1,Re=0,Fe=0,Ve=h,ke=null;t:for(;;){for(var Le;Ve!==v||A!==0&&Ve.nodeType!==3||(re=X+A),Ve!==P||w!==0&&Ve.nodeType!==3||(de=X+w),Ve.nodeType===3&&(X+=Ve.nodeValue.length),(Le=Ve.firstChild)!==null;)ke=Ve,Ve=Le;for(;;){if(Ve===h)break t;if(ke===v&&++Re===A&&(re=X),ke===P&&++Fe===w&&(de=X),(Le=Ve.nextSibling)!==null)break;Ve=ke,ke=Ve.parentNode}Ve=Le}v=re===-1||de===-1?null:{start:re,end:de}}else v=null}v=v||{start:0,end:0}}else v=null;for(Y_={focusedElem:h,selectionRange:v},Ey=!1,qr=p;qr!==null;)if(p=qr,h=p.child,(p.subtreeFlags&1024)!==0&&h!==null)h.return=p,qr=h;else for(;qr!==null;){switch(p=qr,P=p.alternate,h=p.flags,p.tag){case 0:break;case 11:case 15:break;case 1:if((h&1024)!==0&&P!==null){h=void 0,v=p,A=P.memoizedProps,P=P.memoizedState,w=v.stateNode;try{var Pt=Iu(v.type,A,v.elementType===v.type);h=w.getSnapshotBeforeUpdate(Pt,P),w.__reactInternalSnapshotBeforeUpdate=h}catch(Ct){On(v,v.return,Ct)}}break;case 3:if((h&1024)!==0){if(h=p.stateNode.containerInfo,v=h.nodeType,v===9)Z_(h);else if(v===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":Z_(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(r(163))}if(h=p.sibling,h!==null){h.return=p.return,qr=h;break}qr=p.return}}function MN(h,p,v){var w=v.flags;switch(v.tag){case 0:case 11:case 15:tc(h,v),w&4&&Wm(5,v);break;case 1:if(tc(h,v),w&4)if(h=v.stateNode,p===null)try{h.componentDidMount()}catch(X){On(v,v.return,X)}else{var A=Iu(v.type,p.memoizedProps);p=p.memoizedState;try{h.componentDidUpdate(A,p,h.__reactInternalSnapshotBeforeUpdate)}catch(X){On(v,v.return,X)}}w&64&&CN(v),w&512&&Km(v,v.return);break;case 3:if(tc(h,v),w&64&&(h=v.updateQueue,h!==null)){if(p=null,v.child!==null)switch(v.child.tag){case 27:case 5:p=v.child.stateNode;break;case 1:p=v.child.stateNode}try{pO(h,p)}catch(X){On(v,v.return,X)}}break;case 27:p===null&&w&4&&DN(v);case 26:case 5:tc(h,v),p===null&&w&4&&IN(v),w&512&&Km(v,v.return);break;case 12:tc(h,v);break;case 13:tc(h,v),w&4&&jN(h,v),w&64&&(h=v.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(v=xee.bind(null,v),Fee(h,v))));break;case 22:if(w=v.memoizedState!==null||cl,!w){p=p!==null&&p.memoizedState!==null||br,A=cl;var P=br;cl=w,(br=p)&&!P?nc(h,v,(v.subtreeFlags&8772)!==0):tc(h,v),cl=A,br=P}break;case 30:break;default:tc(h,v)}}function ON(h){var p=h.alternate;p!==null&&(h.alternate=null,ON(p)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(p=h.stateNode,p!==null&&jr(p)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var Yn=null,Qs=!1;function ul(h,p,v){for(v=v.child;v!==null;)NN(h,p,v),v=v.sibling}function NN(h,p,v){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(tt,v)}catch{}switch(v.tag){case 26:br||so(v,p),ul(h,p,v),v.memoizedState?v.memoizedState.count--:v.stateNode&&(v=v.stateNode,v.parentNode.removeChild(v));break;case 27:br||so(v,p);var w=Yn,A=Qs;lc(v.type)&&(Yn=v.stateNode,Qs=!1),ul(h,p,v),rp(v.stateNode),Yn=w,Qs=A;break;case 5:br||so(v,p);case 6:if(w=Yn,A=Qs,Yn=null,ul(h,p,v),Yn=w,Qs=A,Yn!==null)if(Qs)try{(Yn.nodeType===9?Yn.body:Yn.nodeName==="HTML"?Yn.ownerDocument.body:Yn).removeChild(v.stateNode)}catch(P){On(v,p,P)}else try{Yn.removeChild(v.stateNode)}catch(P){On(v,p,P)}break;case 18:Yn!==null&&(Qs?(h=Yn,Tj(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,v.stateNode),dp(h)):Tj(Yn,v.stateNode));break;case 4:w=Yn,A=Qs,Yn=v.stateNode.containerInfo,Qs=!0,ul(h,p,v),Yn=w,Qs=A;break;case 0:case 11:case 14:case 15:br||ec(2,v,p),br||ec(4,v,p),ul(h,p,v);break;case 1:br||(so(v,p),w=v.stateNode,typeof w.componentWillUnmount=="function"&&kN(v,p,w)),ul(h,p,v);break;case 21:ul(h,p,v);break;case 22:br=(w=br)||v.memoizedState!==null,ul(h,p,v),br=w;break;default:ul(h,p,v)}}function jN(h,p){if(p.memoizedState===null&&(h=p.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{dp(h)}catch(v){On(p,p.return,v)}}function hee(h){switch(h.tag){case 13:case 19:var p=h.stateNode;return p===null&&(p=h.stateNode=new PN),p;case 22:return h=h.stateNode,p=h._retryCache,p===null&&(p=h._retryCache=new PN),p;default:throw Error(r(435,h.tag))}}function __(h,p){var v=hee(h);p.forEach(function(w){var A=wee.bind(null,h,w);v.has(w)||(v.add(w),w.then(A,A))})}function Ei(h,p){var v=p.deletions;if(v!==null)for(var w=0;w<v.length;w++){var A=v[w],P=h,X=p,re=X;e:for(;re!==null;){switch(re.tag){case 27:if(lc(re.type)){Yn=re.stateNode,Qs=!1;break e}break;case 5:Yn=re.stateNode,Qs=!1;break e;case 3:case 4:Yn=re.stateNode.containerInfo,Qs=!0;break e}re=re.return}if(Yn===null)throw Error(r(160));NN(P,X,A),Yn=null,Qs=!1,P=A.alternate,P!==null&&(P.return=null),A.return=null}if(p.subtreeFlags&13878)for(p=p.child;p!==null;)FN(p,h),p=p.sibling}var Aa=null;function FN(h,p){var v=h.alternate,w=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Ei(p,h),Si(h),w&4&&(ec(3,h,h.return),Wm(3,h),ec(5,h,h.return));break;case 1:Ei(p,h),Si(h),w&512&&(br||v===null||so(v,v.return)),w&64&&cl&&(h=h.updateQueue,h!==null&&(w=h.callbacks,w!==null&&(v=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=v===null?w:v.concat(w))));break;case 26:var A=Aa;if(Ei(p,h),Si(h),w&512&&(br||v===null||so(v,v.return)),w&4){var P=v!==null?v.memoizedState:null;if(w=h.memoizedState,v===null)if(w===null)if(h.stateNode===null){e:{w=h.type,v=h.memoizedProps,A=A.ownerDocument||A;t:switch(w){case"title":P=A.getElementsByTagName("title")[0],(!P||P[Mn]||P[Xe]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=A.createElement(w),A.head.insertBefore(P,A.querySelector("head > title"))),us(P,w,v),P[Xe]=h,Rr(P),w=P;break e;case"link":var X=Dj("link","href",A).get(w+(v.href||""));if(X){for(var re=0;re<X.length;re++)if(P=X[re],P.getAttribute("href")===(v.href==null||v.href===""?null:v.href)&&P.getAttribute("rel")===(v.rel==null?null:v.rel)&&P.getAttribute("title")===(v.title==null?null:v.title)&&P.getAttribute("crossorigin")===(v.crossOrigin==null?null:v.crossOrigin)){X.splice(re,1);break t}}P=A.createElement(w),us(P,w,v),A.head.appendChild(P);break;case"meta":if(X=Dj("meta","content",A).get(w+(v.content||""))){for(re=0;re<X.length;re++)if(P=X[re],P.getAttribute("content")===(v.content==null?null:""+v.content)&&P.getAttribute("name")===(v.name==null?null:v.name)&&P.getAttribute("property")===(v.property==null?null:v.property)&&P.getAttribute("http-equiv")===(v.httpEquiv==null?null:v.httpEquiv)&&P.getAttribute("charset")===(v.charSet==null?null:v.charSet)){X.splice(re,1);break t}}P=A.createElement(w),us(P,w,v),A.head.appendChild(P);break;default:throw Error(r(468,w))}P[Xe]=h,Rr(P),w=P}h.stateNode=w}else Pj(A,h.type,h.stateNode);else h.stateNode=Lj(A,w,h.memoizedProps);else P!==w?(P===null?v.stateNode!==null&&(v=v.stateNode,v.parentNode.removeChild(v)):P.count--,w===null?Pj(A,h.type,h.stateNode):Lj(A,w,h.memoizedProps)):w===null&&h.stateNode!==null&&w_(h,h.memoizedProps,v.memoizedProps)}break;case 27:Ei(p,h),Si(h),w&512&&(br||v===null||so(v,v.return)),v!==null&&w&4&&w_(h,h.memoizedProps,v.memoizedProps);break;case 5:if(Ei(p,h),Si(h),w&512&&(br||v===null||so(v,v.return)),h.flags&32){A=h.stateNode;try{Od(A,"")}catch(Le){On(h,h.return,Le)}}w&4&&h.stateNode!=null&&(A=h.memoizedProps,w_(h,A,v!==null?v.memoizedProps:A)),w&1024&&(T_=!0);break;case 6:if(Ei(p,h),Si(h),w&4){if(h.stateNode===null)throw Error(r(162));w=h.memoizedProps,v=h.stateNode;try{v.nodeValue=w}catch(Le){On(h,h.return,Le)}}break;case 3:if(by=null,A=Aa,Aa=vy(p.containerInfo),Ei(p,h),Aa=A,Si(h),w&4&&v!==null&&v.memoizedState.isDehydrated)try{dp(p.containerInfo)}catch(Le){On(h,h.return,Le)}T_&&(T_=!1,UN(h));break;case 4:w=Aa,Aa=vy(h.stateNode.containerInfo),Ei(p,h),Si(h),Aa=w;break;case 12:Ei(p,h),Si(h);break;case 13:Ei(p,h),Si(h),h.child.flags&8192&&h.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(L_=ie()),w&4&&(w=h.updateQueue,w!==null&&(h.updateQueue=null,__(h,w)));break;case 22:A=h.memoizedState!==null;var de=v!==null&&v.memoizedState!==null,Re=cl,Fe=br;if(cl=Re||A,br=Fe||de,Ei(p,h),br=Fe,cl=Re,Si(h),w&8192)e:for(p=h.stateNode,p._visibility=A?p._visibility&-2:p._visibility|1,A&&(v===null||de||cl||br||Lu(h)),v=null,p=h;;){if(p.tag===5||p.tag===26){if(v===null){de=v=p;try{if(P=de.stateNode,A)X=P.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none";else{re=de.stateNode;var Ve=de.memoizedProps.style,ke=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;re.style.display=ke==null||typeof ke=="boolean"?"":(""+ke).trim()}}catch(Le){On(de,de.return,Le)}}}else if(p.tag===6){if(v===null){de=p;try{de.stateNode.nodeValue=A?"":de.memoizedProps}catch(Le){On(de,de.return,Le)}}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===h)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===h)break e;for(;p.sibling===null;){if(p.return===null||p.return===h)break e;v===p&&(v=null),p=p.return}v===p&&(v=null),p.sibling.return=p.return,p=p.sibling}w&4&&(w=h.updateQueue,w!==null&&(v=w.retryQueue,v!==null&&(w.retryQueue=null,__(h,v))));break;case 19:Ei(p,h),Si(h),w&4&&(w=h.updateQueue,w!==null&&(h.updateQueue=null,__(h,w)));break;case 30:break;case 21:break;default:Ei(p,h),Si(h)}}function Si(h){var p=h.flags;if(p&2){try{for(var v,w=h.return;w!==null;){if(LN(w)){v=w;break}w=w.return}if(v==null)throw Error(r(160));switch(v.tag){case 27:var A=v.stateNode,P=E_(h);sy(h,P,A);break;case 5:var X=v.stateNode;v.flags&32&&(Od(X,""),v.flags&=-33);var re=E_(h);sy(h,re,X);break;case 3:case 4:var de=v.stateNode.containerInfo,Re=E_(h);S_(h,Re,de);break;default:throw Error(r(161))}}catch(Fe){On(h,h.return,Fe)}h.flags&=-3}p&4096&&(h.flags&=-4097)}function UN(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var p=h;UN(p),p.tag===5&&p.flags&1024&&p.stateNode.reset(),h=h.sibling}}function tc(h,p){if(p.subtreeFlags&8772)for(p=p.child;p!==null;)MN(h,p.alternate,p),p=p.sibling}function Lu(h){for(h=h.child;h!==null;){var p=h;switch(p.tag){case 0:case 11:case 14:case 15:ec(4,p,p.return),Lu(p);break;case 1:so(p,p.return);var v=p.stateNode;typeof v.componentWillUnmount=="function"&&kN(p,p.return,v),Lu(p);break;case 27:rp(p.stateNode);case 26:case 5:so(p,p.return),Lu(p);break;case 22:p.memoizedState===null&&Lu(p);break;case 30:Lu(p);break;default:Lu(p)}h=h.sibling}}function nc(h,p,v){for(v=v&&(p.subtreeFlags&8772)!==0,p=p.child;p!==null;){var w=p.alternate,A=h,P=p,X=P.flags;switch(P.tag){case 0:case 11:case 15:nc(A,P,v),Wm(4,P);break;case 1:if(nc(A,P,v),w=P,A=w.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Re){On(w,w.return,Re)}if(w=P,A=w.updateQueue,A!==null){var re=w.stateNode;try{var de=A.shared.hiddenCallbacks;if(de!==null)for(A.shared.hiddenCallbacks=null,A=0;A<de.length;A++)mO(de[A],re)}catch(Re){On(w,w.return,Re)}}v&&X&64&&CN(P),Km(P,P.return);break;case 27:DN(P);case 26:case 5:nc(A,P,v),v&&w===null&&X&4&&IN(P),Km(P,P.return);break;case 12:nc(A,P,v);break;case 13:nc(A,P,v),v&&X&4&&jN(A,P);break;case 22:P.memoizedState===null&&nc(A,P,v),Km(P,P.return);break;case 30:break;default:nc(A,P,v)}p=p.sibling}}function A_(h,p){var v=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),h=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(h=p.memoizedState.cachePool.pool),h!==v&&(h!=null&&h.refCount++,v!=null&&Pm(v))}function R_(h,p){h=null,p.alternate!==null&&(h=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==h&&(p.refCount++,h!=null&&Pm(h))}function io(h,p,v,w){if(p.subtreeFlags&10256)for(p=p.child;p!==null;)$N(h,p,v,w),p=p.sibling}function $N(h,p,v,w){var A=p.flags;switch(p.tag){case 0:case 11:case 15:io(h,p,v,w),A&2048&&Wm(9,p);break;case 1:io(h,p,v,w);break;case 3:io(h,p,v,w),A&2048&&(h=null,p.alternate!==null&&(h=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==h&&(p.refCount++,h!=null&&Pm(h)));break;case 12:if(A&2048){io(h,p,v,w),h=p.stateNode;try{var P=p.memoizedProps,X=P.id,re=P.onPostCommit;typeof re=="function"&&re(X,p.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(de){On(p,p.return,de)}}else io(h,p,v,w);break;case 13:io(h,p,v,w);break;case 23:break;case 22:P=p.stateNode,X=p.alternate,p.memoizedState!==null?P._visibility&2?io(h,p,v,w):Ym(h,p):P._visibility&2?io(h,p,v,w):(P._visibility|=2,eh(h,p,v,w,(p.subtreeFlags&10256)!==0)),A&2048&&A_(X,p);break;case 24:io(h,p,v,w),A&2048&&R_(p.alternate,p);break;default:io(h,p,v,w)}}function eh(h,p,v,w,A){for(A=A&&(p.subtreeFlags&10256)!==0,p=p.child;p!==null;){var P=h,X=p,re=v,de=w,Re=X.flags;switch(X.tag){case 0:case 11:case 15:eh(P,X,re,de,A),Wm(8,X);break;case 23:break;case 22:var Fe=X.stateNode;X.memoizedState!==null?Fe._visibility&2?eh(P,X,re,de,A):Ym(P,X):(Fe._visibility|=2,eh(P,X,re,de,A)),A&&Re&2048&&A_(X.alternate,X);break;case 24:eh(P,X,re,de,A),A&&Re&2048&&R_(X.alternate,X);break;default:eh(P,X,re,de,A)}p=p.sibling}}function Ym(h,p){if(p.subtreeFlags&10256)for(p=p.child;p!==null;){var v=h,w=p,A=w.flags;switch(w.tag){case 22:Ym(v,w),A&2048&&A_(w.alternate,w);break;case 24:Ym(v,w),A&2048&&R_(w.alternate,w);break;default:Ym(v,w)}p=p.sibling}}var Xm=8192;function th(h){if(h.subtreeFlags&Xm)for(h=h.child;h!==null;)BN(h),h=h.sibling}function BN(h){switch(h.tag){case 26:th(h),h.flags&Xm&&h.memoizedState!==null&&Qee(Aa,h.memoizedState,h.memoizedProps);break;case 5:th(h);break;case 3:case 4:var p=Aa;Aa=vy(h.stateNode.containerInfo),th(h),Aa=p;break;case 22:h.memoizedState===null&&(p=h.alternate,p!==null&&p.memoizedState!==null?(p=Xm,Xm=16777216,th(h),Xm=p):th(h));break;default:th(h)}}function HN(h){var p=h.alternate;if(p!==null&&(h=p.child,h!==null)){p.child=null;do p=h.sibling,h.sibling=null,h=p;while(h!==null)}}function Qm(h){var p=h.deletions;if((h.flags&16)!==0){if(p!==null)for(var v=0;v<p.length;v++){var w=p[v];qr=w,zN(w,h)}HN(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)VN(h),h=h.sibling}function VN(h){switch(h.tag){case 0:case 11:case 15:Qm(h),h.flags&2048&&ec(9,h,h.return);break;case 3:Qm(h);break;case 12:Qm(h);break;case 22:var p=h.stateNode;h.memoizedState!==null&&p._visibility&2&&(h.return===null||h.return.tag!==13)?(p._visibility&=-3,iy(h)):Qm(h);break;default:Qm(h)}}function iy(h){var p=h.deletions;if((h.flags&16)!==0){if(p!==null)for(var v=0;v<p.length;v++){var w=p[v];qr=w,zN(w,h)}HN(h)}for(h=h.child;h!==null;){switch(p=h,p.tag){case 0:case 11:case 15:ec(8,p,p.return),iy(p);break;case 22:v=p.stateNode,v._visibility&2&&(v._visibility&=-3,iy(p));break;default:iy(p)}h=h.sibling}}function zN(h,p){for(;qr!==null;){var v=qr;switch(v.tag){case 0:case 11:case 15:ec(8,v,p);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var w=v.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Pm(v.memoizedState.cache)}if(w=v.child,w!==null)w.return=v,qr=w;else e:for(v=h;qr!==null;){w=qr;var A=w.sibling,P=w.return;if(ON(w),w===v){qr=null;break e}if(A!==null){A.return=P,qr=A;break e}qr=P}}}var fee={getCacheForType:function(h){var p=xs(Fr),v=p.data.get(h);return v===void 0&&(v=h(),p.data.set(h,v)),v}},mee=typeof WeakMap=="function"?WeakMap:Map,Sn=0,Fn=null,rn=null,un=0,Tn=0,Ti=null,rc=!1,nh=!1,C_=!1,dl=0,cr=0,sc=0,Du=0,k_=0,Ki=0,rh=0,Zm=null,Zs=null,I_=!1,L_=0,ay=1/0,oy=null,ic=null,cs=0,ac=null,sh=null,ih=0,D_=0,P_=null,GN=null,Jm=0,M_=null;function _i(){if((Sn&2)!==0&&un!==0)return un&-un;if(F.T!==null){var h=qd;return h!==0?h:B_()}return Dt()}function qN(){Ki===0&&(Ki=(un&536870912)===0||yn?xn():536870912);var h=Wi.current;return h!==null&&(h.flags|=32),Ki}function Ai(h,p,v){(h===Fn&&(Tn===2||Tn===9)||h.cancelPendingCommit!==null)&&(ah(h,0),oc(h,un,Ki,!1)),Lt(h,v),((Sn&2)===0||h!==Fn)&&(h===Fn&&((Sn&2)===0&&(Du|=v),cr===4&&oc(h,un,Ki,!1)),ao(h))}function WN(h,p,v){if((Sn&6)!==0)throw Error(r(327));var w=!v&&(p&124)===0&&(p&h.expiredLanes)===0||Vt(h,p),A=w?vee(h,p):j_(h,p,!0),P=w;do{if(A===0){nh&&!w&&oc(h,p,0,!1);break}else{if(v=h.current.alternate,P&&!pee(v)){A=j_(h,p,!1),P=!1;continue}if(A===2){if(P=p,h.errorRecoveryDisabledLanes&P)var X=0;else X=h.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){p=X;e:{var re=h;A=Zm;var de=re.current.memoizedState.isDehydrated;if(de&&(ah(re,X).flags|=256),X=j_(re,X,!1),X!==2){if(C_&&!de){re.errorRecoveryDisabledLanes|=P,Du|=P,A=4;break e}P=Zs,Zs=A,P!==null&&(Zs===null?Zs=P:Zs.push.apply(Zs,P))}A=X}if(P=!1,A!==2)continue}}if(A===1){ah(h,0),oc(h,p,0,!0);break}e:{switch(w=h,P=A,P){case 0:case 1:throw Error(r(345));case 4:if((p&4194048)!==p)break;case 6:oc(w,p,Ki,!rc);break e;case 2:Zs=null;break;case 3:case 5:break;default:throw Error(r(329))}if((p&62914560)===p&&(A=L_+300-ie(),10<A)){if(oc(w,p,Ki,!rc),ht(w,0,!0)!==0)break e;w.timeoutHandle=Ej(KN.bind(null,w,v,Zs,oy,I_,p,Ki,Du,rh,rc,P,2,-0,0),A);break e}KN(w,v,Zs,oy,I_,p,Ki,Du,rh,rc,P,0,-0,0)}}break}while(!0);ao(h)}function KN(h,p,v,w,A,P,X,re,de,Re,Fe,Ve,ke,Le){if(h.timeoutHandle=-1,Ve=p.subtreeFlags,(Ve&8192||(Ve&16785408)===16785408)&&(ap={stylesheets:null,count:0,unsuspend:Xee},BN(p),Ve=Zee(),Ve!==null)){h.cancelPendingCommit=Ve(tj.bind(null,h,p,P,v,w,A,X,re,de,Fe,1,ke,Le)),oc(h,P,X,!Re);return}tj(h,p,P,v,w,A,X,re,de)}function pee(h){for(var p=h;;){var v=p.tag;if((v===0||v===11||v===15)&&p.flags&16384&&(v=p.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var w=0;w<v.length;w++){var A=v[w],P=A.getSnapshot;A=A.value;try{if(!xi(P(),A))return!1}catch{return!1}}if(v=p.child,p.subtreeFlags&16384&&v!==null)v.return=p,p=v;else{if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function oc(h,p,v,w){p&=~k_,p&=~Du,h.suspendedLanes|=p,h.pingedLanes&=~p,w&&(h.warmLanes|=p),w=h.expirationTimes;for(var A=p;0<A;){var P=31-be(A),X=1<<P;w[P]=-1,A&=~X}v!==0&&Xt(h,v,p)}function ly(){return(Sn&6)===0?(ep(0),!1):!0}function O_(){if(rn!==null){if(Tn===0)var h=rn.return;else h=rn,rl=Au=null,ZT(h),Zd=null,zm=0,h=rn;for(;h!==null;)RN(h.alternate,h),h=h.return;rn=null}}function ah(h,p){var v=h.timeoutHandle;v!==-1&&(h.timeoutHandle=-1,Pee(v)),v=h.cancelPendingCommit,v!==null&&(h.cancelPendingCommit=null,v()),O_(),Fn=h,rn=v=el(h.current,null),un=p,Tn=0,Ti=null,rc=!1,nh=Vt(h,p),C_=!1,rh=Ki=k_=Du=sc=cr=0,Zs=Zm=null,I_=!1,(p&8)!==0&&(p|=p&32);var w=h.entangledLanes;if(w!==0)for(h=h.entanglements,w&=p;0<w;){var A=31-be(w),P=1<<A;p|=h[A],w&=~P}return dl=p,I0(),v}function YN(h,p){Zt=null,F.H=Y0,p===Om||p===U0?(p=hO(),Tn=3):p===cO?(p=hO(),Tn=4):Tn=p===fN?8:p!==null&&typeof p=="object"&&typeof p.then=="function"?6:1,Ti=p,rn===null&&(cr=1,ey(h,Vi(p,h.current)))}function XN(){var h=F.H;return F.H=Y0,h===null?Y0:h}function QN(){var h=F.A;return F.A=fee,h}function N_(){cr=4,rc||(un&4194048)!==un&&Wi.current!==null||(nh=!0),(sc&134217727)===0&&(Du&134217727)===0||Fn===null||oc(Fn,un,Ki,!1)}function j_(h,p,v){var w=Sn;Sn|=2;var A=XN(),P=QN();(Fn!==h||un!==p)&&(oy=null,ah(h,p)),p=!1;var X=cr;e:do try{if(Tn!==0&&rn!==null){var re=rn,de=Ti;switch(Tn){case 8:O_(),X=6;break e;case 3:case 2:case 9:case 6:Wi.current===null&&(p=!0);var Re=Tn;if(Tn=0,Ti=null,oh(h,re,de,Re),v&&nh){X=0;break e}break;default:Re=Tn,Tn=0,Ti=null,oh(h,re,de,Re)}}gee(),X=cr;break}catch(Fe){YN(h,Fe)}while(!0);return p&&h.shellSuspendCounter++,rl=Au=null,Sn=w,F.H=A,F.A=P,rn===null&&(Fn=null,un=0,I0()),X}function gee(){for(;rn!==null;)ZN(rn)}function vee(h,p){var v=Sn;Sn|=2;var w=XN(),A=QN();Fn!==h||un!==p?(oy=null,ay=ie()+500,ah(h,p)):nh=Vt(h,p);e:do try{if(Tn!==0&&rn!==null){p=rn;var P=Ti;t:switch(Tn){case 1:Tn=0,Ti=null,oh(h,p,P,1);break;case 2:case 9:if(uO(P)){Tn=0,Ti=null,JN(p);break}p=function(){Tn!==2&&Tn!==9||Fn!==h||(Tn=7),ao(h)},P.then(p,p);break e;case 3:Tn=7;break e;case 4:Tn=5;break e;case 7:uO(P)?(Tn=0,Ti=null,JN(p)):(Tn=0,Ti=null,oh(h,p,P,7));break;case 5:var X=null;switch(rn.tag){case 26:X=rn.memoizedState;case 5:case 27:var re=rn;if(!X||Mj(X)){Tn=0,Ti=null;var de=re.sibling;if(de!==null)rn=de;else{var Re=re.return;Re!==null?(rn=Re,cy(Re)):rn=null}break t}}Tn=0,Ti=null,oh(h,p,P,5);break;case 6:Tn=0,Ti=null,oh(h,p,P,6);break;case 8:O_(),cr=6;break e;default:throw Error(r(462))}}yee();break}catch(Fe){YN(h,Fe)}while(!0);return rl=Au=null,F.H=w,F.A=A,Sn=v,rn!==null?0:(Fn=null,un=0,I0(),cr)}function yee(){for(;rn!==null&&!ae();)ZN(rn)}function ZN(h){var p=_N(h.alternate,h,dl);h.memoizedProps=h.pendingProps,p===null?cy(h):rn=p}function JN(h){var p=h,v=p.alternate;switch(p.tag){case 15:case 0:p=bN(v,p,p.pendingProps,p.type,void 0,un);break;case 11:p=bN(v,p,p.pendingProps,p.type.render,p.ref,un);break;case 5:ZT(p);default:RN(v,p),p=rn=eO(p,dl),p=_N(v,p,dl)}h.memoizedProps=h.pendingProps,p===null?cy(h):rn=p}function oh(h,p,v,w){rl=Au=null,ZT(p),Zd=null,zm=0;var A=p.return;try{if(oee(h,A,p,v,un)){cr=1,ey(h,Vi(v,h.current)),rn=null;return}}catch(P){if(A!==null)throw rn=A,P;cr=1,ey(h,Vi(v,h.current)),rn=null;return}p.flags&32768?(yn||w===1?h=!0:nh||(un&536870912)!==0?h=!1:(rc=h=!0,(w===2||w===9||w===3||w===6)&&(w=Wi.current,w!==null&&w.tag===13&&(w.flags|=16384))),ej(p,h)):cy(p)}function cy(h){var p=h;do{if((p.flags&32768)!==0){ej(p,rc);return}h=p.return;var v=cee(p.alternate,p,dl);if(v!==null){rn=v;return}if(p=p.sibling,p!==null){rn=p;return}rn=p=h}while(p!==null);cr===0&&(cr=5)}function ej(h,p){do{var v=uee(h.alternate,h);if(v!==null){v.flags&=32767,rn=v;return}if(v=h.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!p&&(h=h.sibling,h!==null)){rn=h;return}rn=h=v}while(h!==null);cr=6,rn=null}function tj(h,p,v,w,A,P,X,re,de){h.cancelPendingCommit=null;do uy();while(cs!==0);if((Sn&6)!==0)throw Error(r(327));if(p!==null){if(p===h.current)throw Error(r(177));if(P=p.lanes|p.childLanes,P|=RT,jt(h,v,P,X,re,de),h===Fn&&(rn=Fn=null,un=0),sh=p,ac=h,ih=v,D_=P,P_=A,GN=w,(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,Eee(ce,function(){return aj(),null})):(h.callbackNode=null,h.callbackPriority=0),w=(p.flags&13878)!==0,(p.subtreeFlags&13878)!==0||w){w=F.T,F.T=null,A=j.p,j.p=2,X=Sn,Sn|=4;try{dee(h,p,v)}finally{Sn=X,j.p=A,F.T=w}}cs=1,nj(),rj(),sj()}}function nj(){if(cs===1){cs=0;var h=ac,p=sh,v=(p.flags&13878)!==0;if((p.subtreeFlags&13878)!==0||v){v=F.T,F.T=null;var w=j.p;j.p=2;var A=Sn;Sn|=4;try{FN(p,h);var P=Y_,X=zM(h.containerInfo),re=P.focusedElem,de=P.selectionRange;if(X!==re&&re&&re.ownerDocument&&VM(re.ownerDocument.documentElement,re)){if(de!==null&&ET(re)){var Re=de.start,Fe=de.end;if(Fe===void 0&&(Fe=Re),"selectionStart"in re)re.selectionStart=Re,re.selectionEnd=Math.min(Fe,re.value.length);else{var Ve=re.ownerDocument||document,ke=Ve&&Ve.defaultView||window;if(ke.getSelection){var Le=ke.getSelection(),Pt=re.textContent.length,Ct=Math.min(de.start,Pt),kn=de.end===void 0?Ct:Math.min(de.end,Pt);!Le.extend&&Ct>kn&&(X=kn,kn=Ct,Ct=X);var we=HM(re,Ct),ge=HM(re,kn);if(we&&ge&&(Le.rangeCount!==1||Le.anchorNode!==we.node||Le.anchorOffset!==we.offset||Le.focusNode!==ge.node||Le.focusOffset!==ge.offset)){var Te=Ve.createRange();Te.setStart(we.node,we.offset),Le.removeAllRanges(),Ct>kn?(Le.addRange(Te),Le.extend(ge.node,ge.offset)):(Te.setEnd(ge.node,ge.offset),Le.addRange(Te))}}}}for(Ve=[],Le=re;Le=Le.parentNode;)Le.nodeType===1&&Ve.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<Ve.length;re++){var Be=Ve[re];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Ey=!!K_,Y_=K_=null}finally{Sn=A,j.p=w,F.T=v}}h.current=p,cs=2}}function rj(){if(cs===2){cs=0;var h=ac,p=sh,v=(p.flags&8772)!==0;if((p.subtreeFlags&8772)!==0||v){v=F.T,F.T=null;var w=j.p;j.p=2;var A=Sn;Sn|=4;try{MN(h,p.alternate,p)}finally{Sn=A,j.p=w,F.T=v}}cs=3}}function sj(){if(cs===4||cs===3){cs=0,le();var h=ac,p=sh,v=ih,w=GN;(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?cs=5:(cs=0,sh=ac=null,ij(h,h.pendingLanes));var A=h.pendingLanes;if(A===0&&(ic=null),ot(v),p=p.stateNode,lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(tt,p,void 0,(p.current.flags&128)===128)}catch{}if(w!==null){p=F.T,A=j.p,j.p=2,F.T=null;try{for(var P=h.onRecoverableError,X=0;X<w.length;X++){var re=w[X];P(re.value,{componentStack:re.stack})}}finally{F.T=p,j.p=A}}(ih&3)!==0&&uy(),ao(h),A=h.pendingLanes,(v&4194090)!==0&&(A&42)!==0?h===M_?Jm++:(Jm=0,M_=h):Jm=0,ep(0)}}function ij(h,p){(h.pooledCacheLanes&=p)===0&&(p=h.pooledCache,p!=null&&(h.pooledCache=null,Pm(p)))}function uy(h){return nj(),rj(),sj(),aj()}function aj(){if(cs!==5)return!1;var h=ac,p=D_;D_=0;var v=ot(ih),w=F.T,A=j.p;try{j.p=32>v?32:v,F.T=null,v=P_,P_=null;var P=ac,X=ih;if(cs=0,sh=ac=null,ih=0,(Sn&6)!==0)throw Error(r(331));var re=Sn;if(Sn|=4,VN(P.current),$N(P,P.current,X,v),Sn=re,ep(0,!1),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(tt,P)}catch{}return!0}finally{j.p=A,F.T=w,ij(h,p)}}function oj(h,p,v){p=Vi(v,p),p=h_(h.stateNode,p,2),h=Xl(h,p,2),h!==null&&(Lt(h,2),ao(h))}function On(h,p,v){if(h.tag===3)oj(h,h,v);else for(;p!==null;){if(p.tag===3){oj(p,h,v);break}else if(p.tag===1){var w=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(ic===null||!ic.has(w))){h=Vi(v,h),v=dN(2),w=Xl(p,v,2),w!==null&&(hN(v,w,p,h),Lt(w,2),ao(w));break}}p=p.return}}function F_(h,p,v){var w=h.pingCache;if(w===null){w=h.pingCache=new mee;var A=new Set;w.set(p,A)}else A=w.get(p),A===void 0&&(A=new Set,w.set(p,A));A.has(v)||(C_=!0,A.add(v),h=bee.bind(null,h,p,v),p.then(h,h))}function bee(h,p,v){var w=h.pingCache;w!==null&&w.delete(p),h.pingedLanes|=h.suspendedLanes&v,h.warmLanes&=~v,Fn===h&&(un&v)===v&&(cr===4||cr===3&&(un&62914560)===un&&300>ie()-L_?(Sn&2)===0&&ah(h,0):k_|=v,rh===un&&(rh=0)),ao(h)}function lj(h,p){p===0&&(p=Bn()),h=Hd(h,p),h!==null&&(Lt(h,p),ao(h))}function xee(h){var p=h.memoizedState,v=0;p!==null&&(v=p.retryLane),lj(h,v)}function wee(h,p){var v=0;switch(h.tag){case 13:var w=h.stateNode,A=h.memoizedState;A!==null&&(v=A.retryLane);break;case 19:w=h.stateNode;break;case 22:w=h.stateNode._retryCache;break;default:throw Error(r(314))}w!==null&&w.delete(p),lj(h,v)}function Eee(h,p){return pe(h,p)}var dy=null,lh=null,U_=!1,hy=!1,$_=!1,Pu=0;function ao(h){h!==lh&&h.next===null&&(lh===null?dy=lh=h:lh=lh.next=h),hy=!0,U_||(U_=!0,Tee())}function ep(h,p){if(!$_&&hy){$_=!0;do for(var v=!1,w=dy;w!==null;){if(h!==0){var A=w.pendingLanes;if(A===0)var P=0;else{var X=w.suspendedLanes,re=w.pingedLanes;P=(1<<31-be(42|h)+1)-1,P&=A&~(X&~re),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(v=!0,hj(w,P))}else P=un,P=ht(w,w===Fn?P:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(P&3)===0||Vt(w,P)||(v=!0,hj(w,P));w=w.next}while(v);$_=!1}}function See(){cj()}function cj(){hy=U_=!1;var h=0;Pu!==0&&(Dee()&&(h=Pu),Pu=0);for(var p=ie(),v=null,w=dy;w!==null;){var A=w.next,P=uj(w,p);P===0?(w.next=null,v===null?dy=A:v.next=A,A===null&&(lh=v)):(v=w,(h!==0||(P&3)!==0)&&(hy=!0)),w=A}ep(h)}function uj(h,p){for(var v=h.suspendedLanes,w=h.pingedLanes,A=h.expirationTimes,P=h.pendingLanes&-62914561;0<P;){var X=31-be(P),re=1<<X,de=A[X];de===-1?((re&v)===0||(re&w)!==0)&&(A[X]=mn(re,p)):de<=p&&(h.expiredLanes|=re),P&=~re}if(p=Fn,v=un,v=ht(h,h===p?v:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),w=h.callbackNode,v===0||h===p&&(Tn===2||Tn===9)||h.cancelPendingCommit!==null)return w!==null&&w!==null&&ye(w),h.callbackNode=null,h.callbackPriority=0;if((v&3)===0||Vt(h,v)){if(p=v&-v,p===h.callbackPriority)return p;switch(w!==null&&ye(w),ot(v)){case 2:case 8:v=ne;break;case 32:v=ce;break;case 268435456:v=Oe;break;default:v=ce}return w=dj.bind(null,h),v=pe(v,w),h.callbackPriority=p,h.callbackNode=v,p}return w!==null&&w!==null&&ye(w),h.callbackPriority=2,h.callbackNode=null,2}function dj(h,p){if(cs!==0&&cs!==5)return h.callbackNode=null,h.callbackPriority=0,null;var v=h.callbackNode;if(uy()&&h.callbackNode!==v)return null;var w=un;return w=ht(h,h===Fn?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),w===0?null:(WN(h,w,p),uj(h,ie()),h.callbackNode!=null&&h.callbackNode===v?dj.bind(null,h):null)}function hj(h,p){if(uy())return null;WN(h,p,!0)}function Tee(){Mee(function(){(Sn&6)!==0?pe(Ie,See):cj()})}function B_(){return Pu===0&&(Pu=xn()),Pu}function fj(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:S0(""+h)}function mj(h,p){var v=p.ownerDocument.createElement("input");return v.name=p.name,v.value=p.value,h.id&&v.setAttribute("form",h.id),p.parentNode.insertBefore(v,p),h=new FormData(h),v.parentNode.removeChild(v),h}function _ee(h,p,v,w,A){if(p==="submit"&&v&&v.stateNode===A){var P=fj((A[st]||null).action),X=w.submitter;X&&(p=(p=X[st]||null)?fj(p.formAction):X.getAttribute("formAction"),p!==null&&(P=p,X=null));var re=new R0("action","action",null,w,A);h.push({event:re,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(Pu!==0){var de=X?mj(A,X):new FormData(A);o_(v,{pending:!0,data:de,method:A.method,action:P},null,de)}}else typeof P=="function"&&(re.preventDefault(),de=X?mj(A,X):new FormData(A),o_(v,{pending:!0,data:de,method:A.method,action:P},P,de))},currentTarget:A}]})}}for(var H_=0;H_<AT.length;H_++){var V_=AT[H_],Aee=V_.toLowerCase(),Ree=V_[0].toUpperCase()+V_.slice(1);_a(Aee,"on"+Ree)}_a(WM,"onAnimationEnd"),_a(KM,"onAnimationIteration"),_a(YM,"onAnimationStart"),_a("dblclick","onDoubleClick"),_a("focusin","onFocus"),_a("focusout","onBlur"),_a(zJ,"onTransitionRun"),_a(GJ,"onTransitionStart"),_a(qJ,"onTransitionCancel"),_a(XM,"onTransitionEnd"),Qo("onMouseEnter",["mouseout","mouseover"]),Qo("onMouseLeave",["mouseout","mouseover"]),Qo("onPointerEnter",["pointerout","pointerover"]),Qo("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cee=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tp));function pj(h,p){p=(p&4)!==0;for(var v=0;v<h.length;v++){var w=h[v],A=w.event;w=w.listeners;e:{var P=void 0;if(p)for(var X=w.length-1;0<=X;X--){var re=w[X],de=re.instance,Re=re.currentTarget;if(re=re.listener,de!==P&&A.isPropagationStopped())break e;P=re,A.currentTarget=Re;try{P(A)}catch(Fe){J0(Fe)}A.currentTarget=null,P=de}else for(X=0;X<w.length;X++){if(re=w[X],de=re.instance,Re=re.currentTarget,re=re.listener,de!==P&&A.isPropagationStopped())break e;P=re,A.currentTarget=Re;try{P(A)}catch(Fe){J0(Fe)}A.currentTarget=null,P=de}}}}function sn(h,p){var v=p[qt];v===void 0&&(v=p[qt]=new Set);var w=h+"__bubble";v.has(w)||(gj(p,h,2,!1),v.add(w))}function z_(h,p,v){var w=0;p&&(w|=4),gj(v,h,w,p)}var fy="_reactListening"+Math.random().toString(36).slice(2);function G_(h){if(!h[fy]){h[fy]=!0,Sa.forEach(function(v){v!=="selectionchange"&&(Cee.has(v)||z_(v,!1,h),z_(v,!0,h))});var p=h.nodeType===9?h:h.ownerDocument;p===null||p[fy]||(p[fy]=!0,z_("selectionchange",!1,p))}}function gj(h,p,v,w){switch($j(p)){case 2:var A=tte;break;case 8:A=nte;break;default:A=i1}v=A.bind(null,p,v,h),A=void 0,!fT||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(A=!0),w?A!==void 0?h.addEventListener(p,v,{capture:!0,passive:A}):h.addEventListener(p,v,!0):A!==void 0?h.addEventListener(p,v,{passive:A}):h.addEventListener(p,v,!1)}function q_(h,p,v,w,A){var P=w;if((p&1)===0&&(p&2)===0&&w!==null)e:for(;;){if(w===null)return;var X=w.tag;if(X===3||X===4){var re=w.stateNode.containerInfo;if(re===A)break;if(X===4)for(X=w.return;X!==null;){var de=X.tag;if((de===3||de===4)&&X.stateNode.containerInfo===A)return;X=X.return}for(;re!==null;){if(X=bs(re),X===null)return;if(de=X.tag,de===5||de===6||de===26||de===27){w=P=X;continue e}re=re.parentNode}}w=w.return}SM(function(){var Re=P,Fe=dT(v),Ve=[];e:{var ke=QM.get(h);if(ke!==void 0){var Le=R0,Pt=h;switch(h){case"keypress":if(_0(v)===0)break e;case"keydown":case"keyup":Le=EJ;break;case"focusin":Pt="focus",Le=vT;break;case"focusout":Pt="blur",Le=vT;break;case"beforeblur":case"afterblur":Le=vT;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=AM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=uJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=_J;break;case WM:case KM:case YM:Le=fJ;break;case XM:Le=RJ;break;case"scroll":case"scrollend":Le=lJ;break;case"wheel":Le=kJ;break;case"copy":case"cut":case"paste":Le=pJ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=CM;break;case"toggle":case"beforetoggle":Le=LJ}var Ct=(p&4)!==0,kn=!Ct&&(h==="scroll"||h==="scrollend"),we=Ct?ke!==null?ke+"Capture":null:ke;Ct=[];for(var ge=Re,Te;ge!==null;){var Be=ge;if(Te=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||Te===null||we===null||(Be=xm(ge,we),Be!=null&&Ct.push(np(ge,Be,Te))),kn)break;ge=ge.return}0<Ct.length&&(ke=new Le(ke,Pt,null,v,Fe),Ve.push({event:ke,listeners:Ct}))}}if((p&7)===0){e:{if(ke=h==="mouseover"||h==="pointerover",Le=h==="mouseout"||h==="pointerout",ke&&v!==uT&&(Pt=v.relatedTarget||v.fromElement)&&(bs(Pt)||Pt[wt]))break e;if((Le||ke)&&(ke=Fe.window===Fe?Fe:(ke=Fe.ownerDocument)?ke.defaultView||ke.parentWindow:window,Le?(Pt=v.relatedTarget||v.toElement,Le=Re,Pt=Pt?bs(Pt):null,Pt!==null&&(kn=i(Pt),Ct=Pt.tag,Pt!==kn||Ct!==5&&Ct!==27&&Ct!==6)&&(Pt=null)):(Le=null,Pt=Re),Le!==Pt)){if(Ct=AM,Be="onMouseLeave",we="onMouseEnter",ge="mouse",(h==="pointerout"||h==="pointerover")&&(Ct=CM,Be="onPointerLeave",we="onPointerEnter",ge="pointer"),kn=Le==null?ke:to(Le),Te=Pt==null?ke:to(Pt),ke=new Ct(Be,ge+"leave",Le,v,Fe),ke.target=kn,ke.relatedTarget=Te,Be=null,bs(Fe)===Re&&(Ct=new Ct(we,ge+"enter",Pt,v,Fe),Ct.target=Te,Ct.relatedTarget=kn,Be=Ct),kn=Be,Le&&Pt)t:{for(Ct=Le,we=Pt,ge=0,Te=Ct;Te;Te=ch(Te))ge++;for(Te=0,Be=we;Be;Be=ch(Be))Te++;for(;0<ge-Te;)Ct=ch(Ct),ge--;for(;0<Te-ge;)we=ch(we),Te--;for(;ge--;){if(Ct===we||we!==null&&Ct===we.alternate)break t;Ct=ch(Ct),we=ch(we)}Ct=null}else Ct=null;Le!==null&&vj(Ve,ke,Le,Ct,!1),Pt!==null&&kn!==null&&vj(Ve,kn,Pt,Ct,!0)}}e:{if(ke=Re?to(Re):window,Le=ke.nodeName&&ke.nodeName.toLowerCase(),Le==="select"||Le==="input"&&ke.type==="file")var vt=NM;else if(MM(ke))if(jM)vt=BJ;else{vt=UJ;var tn=FJ}else Le=ke.nodeName,!Le||Le.toLowerCase()!=="input"||ke.type!=="checkbox"&&ke.type!=="radio"?Re&&cT(Re.elementType)&&(vt=NM):vt=$J;if(vt&&(vt=vt(h,Re))){OM(Ve,vt,v,Fe);break e}tn&&tn(h,ke,Re),h==="focusout"&&Re&&ke.type==="number"&&Re.memoizedProps.value!=null&&lT(ke,"number",ke.value)}switch(tn=Re?to(Re):window,h){case"focusin":(MM(tn)||tn.contentEditable==="true")&&(Ud=tn,ST=Re,Cm=null);break;case"focusout":Cm=ST=Ud=null;break;case"mousedown":TT=!0;break;case"contextmenu":case"mouseup":case"dragend":TT=!1,GM(Ve,v,Fe);break;case"selectionchange":if(VJ)break;case"keydown":case"keyup":GM(Ve,v,Fe)}var St;if(bT)e:{switch(h){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Fd?DM(h,v)&&(It="onCompositionEnd"):h==="keydown"&&v.keyCode===229&&(It="onCompositionStart");It&&(kM&&v.locale!=="ko"&&(Fd||It!=="onCompositionStart"?It==="onCompositionEnd"&&Fd&&(St=TM()):(ql=Fe,mT="value"in ql?ql.value:ql.textContent,Fd=!0)),tn=my(Re,It),0<tn.length&&(It=new RM(It,h,null,v,Fe),Ve.push({event:It,listeners:tn}),St?It.data=St:(St=PM(v),St!==null&&(It.data=St)))),(St=PJ?MJ(h,v):OJ(h,v))&&(It=my(Re,"onBeforeInput"),0<It.length&&(tn=new RM("onBeforeInput","beforeinput",null,v,Fe),Ve.push({event:tn,listeners:It}),tn.data=St)),_ee(Ve,h,Re,v,Fe)}pj(Ve,p)})}function np(h,p,v){return{instance:h,listener:p,currentTarget:v}}function my(h,p){for(var v=p+"Capture",w=[];h!==null;){var A=h,P=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||P===null||(A=xm(h,v),A!=null&&w.unshift(np(h,A,P)),A=xm(h,p),A!=null&&w.push(np(h,A,P))),h.tag===3)return w;h=h.return}return[]}function ch(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function vj(h,p,v,w,A){for(var P=p._reactName,X=[];v!==null&&v!==w;){var re=v,de=re.alternate,Re=re.stateNode;if(re=re.tag,de!==null&&de===w)break;re!==5&&re!==26&&re!==27||Re===null||(de=Re,A?(Re=xm(v,P),Re!=null&&X.unshift(np(v,Re,de))):A||(Re=xm(v,P),Re!=null&&X.push(np(v,Re,de)))),v=v.return}X.length!==0&&h.push({event:p,listeners:X})}var kee=/\r\n?/g,Iee=/\u0000|\uFFFD/g;function yj(h){return(typeof h=="string"?h:""+h).replace(kee,`
`).replace(Iee,"")}function bj(h,p){return p=yj(p),yj(h)===p}function py(){}function Cn(h,p,v,w,A,P){switch(v){case"children":typeof w=="string"?p==="body"||p==="textarea"&&w===""||Od(h,w):(typeof w=="number"||typeof w=="bigint")&&p!=="body"&&Od(h,""+w);break;case"className":x0(h,"class",w);break;case"tabIndex":x0(h,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":x0(h,v,w);break;case"style":wM(h,w,P);break;case"data":if(p!=="object"){x0(h,"data",w);break}case"src":case"href":if(w===""&&(p!=="a"||v!=="href")){h.removeAttribute(v);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){h.removeAttribute(v);break}w=S0(""+w),h.setAttribute(v,w);break;case"action":case"formAction":if(typeof w=="function"){h.setAttribute(v,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(v==="formAction"?(p!=="input"&&Cn(h,p,"name",A.name,A,null),Cn(h,p,"formEncType",A.formEncType,A,null),Cn(h,p,"formMethod",A.formMethod,A,null),Cn(h,p,"formTarget",A.formTarget,A,null)):(Cn(h,p,"encType",A.encType,A,null),Cn(h,p,"method",A.method,A,null),Cn(h,p,"target",A.target,A,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){h.removeAttribute(v);break}w=S0(""+w),h.setAttribute(v,w);break;case"onClick":w!=null&&(h.onclick=py);break;case"onScroll":w!=null&&sn("scroll",h);break;case"onScrollEnd":w!=null&&sn("scrollend",h);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(r(61));if(v=w.__html,v!=null){if(A.children!=null)throw Error(r(60));h.innerHTML=v}}break;case"multiple":h.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":h.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){h.removeAttribute("xlink:href");break}v=S0(""+w),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",v);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?h.setAttribute(v,""+w):h.removeAttribute(v);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?h.setAttribute(v,""):h.removeAttribute(v);break;case"capture":case"download":w===!0?h.setAttribute(v,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?h.setAttribute(v,w):h.removeAttribute(v);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?h.setAttribute(v,w):h.removeAttribute(v);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?h.removeAttribute(v):h.setAttribute(v,w);break;case"popover":sn("beforetoggle",h),sn("toggle",h),b0(h,"popover",w);break;case"xlinkActuate":Zo(h,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":Zo(h,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":Zo(h,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":Zo(h,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":Zo(h,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":Zo(h,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":Zo(h,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":Zo(h,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":Zo(h,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":b0(h,"is",w);break;case"innerText":case"textContent":break;default:(!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(v=aJ.get(v)||v,b0(h,v,w))}}function W_(h,p,v,w,A,P){switch(v){case"style":wM(h,w,P);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(r(61));if(v=w.__html,v!=null){if(A.children!=null)throw Error(r(60));h.innerHTML=v}}break;case"children":typeof w=="string"?Od(h,w):(typeof w=="number"||typeof w=="bigint")&&Od(h,""+w);break;case"onScroll":w!=null&&sn("scroll",h);break;case"onScrollEnd":w!=null&&sn("scrollend",h);break;case"onClick":w!=null&&(h.onclick=py);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!y0.hasOwnProperty(v))e:{if(v[0]==="o"&&v[1]==="n"&&(A=v.endsWith("Capture"),p=v.slice(2,A?v.length-7:void 0),P=h[st]||null,P=P!=null?P[v]:null,typeof P=="function"&&h.removeEventListener(p,P,A),typeof w=="function")){typeof P!="function"&&P!==null&&(v in h?h[v]=null:h.hasAttribute(v)&&h.removeAttribute(v)),h.addEventListener(p,w,A);break e}v in h?h[v]=w:w===!0?h.setAttribute(v,""):b0(h,v,w)}}}function us(h,p,v){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sn("error",h),sn("load",h);var w=!1,A=!1,P;for(P in v)if(v.hasOwnProperty(P)){var X=v[P];if(X!=null)switch(P){case"src":w=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,p));default:Cn(h,p,P,X,v,null)}}A&&Cn(h,p,"srcSet",v.srcSet,v,null),w&&Cn(h,p,"src",v.src,v,null);return;case"input":sn("invalid",h);var re=P=X=A=null,de=null,Re=null;for(w in v)if(v.hasOwnProperty(w)){var Fe=v[w];if(Fe!=null)switch(w){case"name":A=Fe;break;case"type":X=Fe;break;case"checked":de=Fe;break;case"defaultChecked":Re=Fe;break;case"value":P=Fe;break;case"defaultValue":re=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(r(137,p));break;default:Cn(h,p,w,Fe,v,null)}}vM(h,P,re,de,Re,X,A,!1),w0(h);return;case"select":sn("invalid",h),w=X=P=null;for(A in v)if(v.hasOwnProperty(A)&&(re=v[A],re!=null))switch(A){case"value":P=re;break;case"defaultValue":X=re;break;case"multiple":w=re;default:Cn(h,p,A,re,v,null)}p=P,v=X,h.multiple=!!w,p!=null?Md(h,!!w,p,!1):v!=null&&Md(h,!!w,v,!0);return;case"textarea":sn("invalid",h),P=A=w=null;for(X in v)if(v.hasOwnProperty(X)&&(re=v[X],re!=null))switch(X){case"value":w=re;break;case"defaultValue":A=re;break;case"children":P=re;break;case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(91));break;default:Cn(h,p,X,re,v,null)}bM(h,w,A,P),w0(h);return;case"option":for(de in v)if(v.hasOwnProperty(de)&&(w=v[de],w!=null))switch(de){case"selected":h.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:Cn(h,p,de,w,v,null)}return;case"dialog":sn("beforetoggle",h),sn("toggle",h),sn("cancel",h),sn("close",h);break;case"iframe":case"object":sn("load",h);break;case"video":case"audio":for(w=0;w<tp.length;w++)sn(tp[w],h);break;case"image":sn("error",h),sn("load",h);break;case"details":sn("toggle",h);break;case"embed":case"source":case"link":sn("error",h),sn("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Re in v)if(v.hasOwnProperty(Re)&&(w=v[Re],w!=null))switch(Re){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,p));default:Cn(h,p,Re,w,v,null)}return;default:if(cT(p)){for(Fe in v)v.hasOwnProperty(Fe)&&(w=v[Fe],w!==void 0&&W_(h,p,Fe,w,v,void 0));return}}for(re in v)v.hasOwnProperty(re)&&(w=v[re],w!=null&&Cn(h,p,re,w,v,null))}function Lee(h,p,v,w){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,P=null,X=null,re=null,de=null,Re=null,Fe=null;for(Le in v){var Ve=v[Le];if(v.hasOwnProperty(Le)&&Ve!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":de=Ve;default:w.hasOwnProperty(Le)||Cn(h,p,Le,null,w,Ve)}}for(var ke in w){var Le=w[ke];if(Ve=v[ke],w.hasOwnProperty(ke)&&(Le!=null||Ve!=null))switch(ke){case"type":P=Le;break;case"name":A=Le;break;case"checked":Re=Le;break;case"defaultChecked":Fe=Le;break;case"value":X=Le;break;case"defaultValue":re=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(r(137,p));break;default:Le!==Ve&&Cn(h,p,ke,Le,w,Ve)}}oT(h,X,re,de,Re,Fe,P,A);return;case"select":Le=X=re=ke=null;for(P in v)if(de=v[P],v.hasOwnProperty(P)&&de!=null)switch(P){case"value":break;case"multiple":Le=de;default:w.hasOwnProperty(P)||Cn(h,p,P,null,w,de)}for(A in w)if(P=w[A],de=v[A],w.hasOwnProperty(A)&&(P!=null||de!=null))switch(A){case"value":ke=P;break;case"defaultValue":re=P;break;case"multiple":X=P;default:P!==de&&Cn(h,p,A,P,w,de)}p=re,v=X,w=Le,ke!=null?Md(h,!!v,ke,!1):!!w!=!!v&&(p!=null?Md(h,!!v,p,!0):Md(h,!!v,v?[]:"",!1));return;case"textarea":Le=ke=null;for(re in v)if(A=v[re],v.hasOwnProperty(re)&&A!=null&&!w.hasOwnProperty(re))switch(re){case"value":break;case"children":break;default:Cn(h,p,re,null,w,A)}for(X in w)if(A=w[X],P=v[X],w.hasOwnProperty(X)&&(A!=null||P!=null))switch(X){case"value":ke=A;break;case"defaultValue":Le=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(r(91));break;default:A!==P&&Cn(h,p,X,A,w,P)}yM(h,ke,Le);return;case"option":for(var Pt in v)if(ke=v[Pt],v.hasOwnProperty(Pt)&&ke!=null&&!w.hasOwnProperty(Pt))switch(Pt){case"selected":h.selected=!1;break;default:Cn(h,p,Pt,null,w,ke)}for(de in w)if(ke=w[de],Le=v[de],w.hasOwnProperty(de)&&ke!==Le&&(ke!=null||Le!=null))switch(de){case"selected":h.selected=ke&&typeof ke!="function"&&typeof ke!="symbol";break;default:Cn(h,p,de,ke,w,Le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ct in v)ke=v[Ct],v.hasOwnProperty(Ct)&&ke!=null&&!w.hasOwnProperty(Ct)&&Cn(h,p,Ct,null,w,ke);for(Re in w)if(ke=w[Re],Le=v[Re],w.hasOwnProperty(Re)&&ke!==Le&&(ke!=null||Le!=null))switch(Re){case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(r(137,p));break;default:Cn(h,p,Re,ke,w,Le)}return;default:if(cT(p)){for(var kn in v)ke=v[kn],v.hasOwnProperty(kn)&&ke!==void 0&&!w.hasOwnProperty(kn)&&W_(h,p,kn,void 0,w,ke);for(Fe in w)ke=w[Fe],Le=v[Fe],!w.hasOwnProperty(Fe)||ke===Le||ke===void 0&&Le===void 0||W_(h,p,Fe,ke,w,Le);return}}for(var we in v)ke=v[we],v.hasOwnProperty(we)&&ke!=null&&!w.hasOwnProperty(we)&&Cn(h,p,we,null,w,ke);for(Ve in w)ke=w[Ve],Le=v[Ve],!w.hasOwnProperty(Ve)||ke===Le||ke==null&&Le==null||Cn(h,p,Ve,ke,w,Le)}var K_=null,Y_=null;function gy(h){return h.nodeType===9?h:h.ownerDocument}function xj(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wj(h,p){if(h===0)switch(p){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&p==="foreignObject"?0:h}function X_(h,p){return h==="textarea"||h==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.children=="bigint"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Q_=null;function Dee(){var h=window.event;return h&&h.type==="popstate"?h===Q_?!1:(Q_=h,!0):(Q_=null,!1)}var Ej=typeof setTimeout=="function"?setTimeout:void 0,Pee=typeof clearTimeout=="function"?clearTimeout:void 0,Sj=typeof Promise=="function"?Promise:void 0,Mee=typeof queueMicrotask=="function"?queueMicrotask:typeof Sj<"u"?function(h){return Sj.resolve(null).then(h).catch(Oee)}:Ej;function Oee(h){setTimeout(function(){throw h})}function lc(h){return h==="head"}function Tj(h,p){var v=p,w=0,A=0;do{var P=v.nextSibling;if(h.removeChild(v),P&&P.nodeType===8)if(v=P.data,v==="/$"){if(0<w&&8>w){v=w;var X=h.ownerDocument;if(v&1&&rp(X.documentElement),v&2&&rp(X.body),v&4)for(v=X.head,rp(v),X=v.firstChild;X;){var re=X.nextSibling,de=X.nodeName;X[Mn]||de==="SCRIPT"||de==="STYLE"||de==="LINK"&&X.rel.toLowerCase()==="stylesheet"||v.removeChild(X),X=re}}if(A===0){h.removeChild(P),dp(p);return}A--}else v==="$"||v==="$?"||v==="$!"?A++:w=v.charCodeAt(0)-48;else w=0;v=P}while(v);dp(p)}function Z_(h){var p=h.firstChild;for(p&&p.nodeType===10&&(p=p.nextSibling);p;){var v=p;switch(p=p.nextSibling,v.nodeName){case"HTML":case"HEAD":case"BODY":Z_(v),jr(v);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(v.rel.toLowerCase()==="stylesheet")continue}h.removeChild(v)}}function Nee(h,p,v,w){for(;h.nodeType===1;){var A=v;if(h.nodeName.toLowerCase()!==p.toLowerCase()){if(!w&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(w){if(!h[Mn])switch(p){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(P=h.getAttribute("rel"),P==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(P!==A.rel||h.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||h.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||h.getAttribute("title")!==(A.title==null?null:A.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(P=h.getAttribute("src"),(P!==(A.src==null?null:A.src)||h.getAttribute("type")!==(A.type==null?null:A.type)||h.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&P&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(p==="input"&&h.type==="hidden"){var P=A.name==null?null:""+A.name;if(A.type==="hidden"&&h.getAttribute("name")===P)return h}else return h;if(h=Ra(h.nextSibling),h===null)break}return null}function jee(h,p,v){if(p==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!v||(h=Ra(h.nextSibling),h===null))return null;return h}function J_(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState==="complete"}function Fee(h,p){var v=h.ownerDocument;if(h.data!=="$?"||v.readyState==="complete")p();else{var w=function(){p(),v.removeEventListener("DOMContentLoaded",w)};v.addEventListener("DOMContentLoaded",w),h._reactRetry=w}}function Ra(h){for(;h!=null;h=h.nextSibling){var p=h.nodeType;if(p===1||p===3)break;if(p===8){if(p=h.data,p==="$"||p==="$!"||p==="$?"||p==="F!"||p==="F")break;if(p==="/$")return null}}return h}var e1=null;function _j(h){h=h.previousSibling;for(var p=0;h;){if(h.nodeType===8){var v=h.data;if(v==="$"||v==="$!"||v==="$?"){if(p===0)return h;p--}else v==="/$"&&p++}h=h.previousSibling}return null}function Aj(h,p,v){switch(p=gy(v),h){case"html":if(h=p.documentElement,!h)throw Error(r(452));return h;case"head":if(h=p.head,!h)throw Error(r(453));return h;case"body":if(h=p.body,!h)throw Error(r(454));return h;default:throw Error(r(451))}}function rp(h){for(var p=h.attributes;p.length;)h.removeAttributeNode(p[0]);jr(h)}var Yi=new Map,Rj=new Set;function vy(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var hl=j.d;j.d={f:Uee,r:$ee,D:Bee,C:Hee,L:Vee,m:zee,X:qee,S:Gee,M:Wee};function Uee(){var h=hl.f(),p=ly();return h||p}function $ee(h){var p=Ea(h);p!==null&&p.tag===5&&p.type==="form"?WO(p):hl.r(h)}var uh=typeof document>"u"?null:document;function Cj(h,p,v){var w=uh;if(w&&typeof p=="string"&&p){var A=Hi(p);A='link[rel="'+h+'"][href="'+A+'"]',typeof v=="string"&&(A+='[crossorigin="'+v+'"]'),Rj.has(A)||(Rj.add(A),h={rel:h,crossOrigin:v,href:p},w.querySelector(A)===null&&(p=w.createElement("link"),us(p,"link",h),Rr(p),w.head.appendChild(p)))}}function Bee(h){hl.D(h),Cj("dns-prefetch",h,null)}function Hee(h,p){hl.C(h,p),Cj("preconnect",h,p)}function Vee(h,p,v){hl.L(h,p,v);var w=uh;if(w&&h&&p){var A='link[rel="preload"][as="'+Hi(p)+'"]';p==="image"&&v&&v.imageSrcSet?(A+='[imagesrcset="'+Hi(v.imageSrcSet)+'"]',typeof v.imageSizes=="string"&&(A+='[imagesizes="'+Hi(v.imageSizes)+'"]')):A+='[href="'+Hi(h)+'"]';var P=A;switch(p){case"style":P=dh(h);break;case"script":P=hh(h)}Yi.has(P)||(h=u({rel:"preload",href:p==="image"&&v&&v.imageSrcSet?void 0:h,as:p},v),Yi.set(P,h),w.querySelector(A)!==null||p==="style"&&w.querySelector(sp(P))||p==="script"&&w.querySelector(ip(P))||(p=w.createElement("link"),us(p,"link",h),Rr(p),w.head.appendChild(p)))}}function zee(h,p){hl.m(h,p);var v=uh;if(v&&h){var w=p&&typeof p.as=="string"?p.as:"script",A='link[rel="modulepreload"][as="'+Hi(w)+'"][href="'+Hi(h)+'"]',P=A;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=hh(h)}if(!Yi.has(P)&&(h=u({rel:"modulepreload",href:h},p),Yi.set(P,h),v.querySelector(A)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(v.querySelector(ip(P)))return}w=v.createElement("link"),us(w,"link",h),Rr(w),v.head.appendChild(w)}}}function Gee(h,p,v){hl.S(h,p,v);var w=uh;if(w&&h){var A=Xo(w).hoistableStyles,P=dh(h);p=p||"default";var X=A.get(P);if(!X){var re={loading:0,preload:null};if(X=w.querySelector(sp(P)))re.loading=5;else{h=u({rel:"stylesheet",href:h,"data-precedence":p},v),(v=Yi.get(P))&&t1(h,v);var de=X=w.createElement("link");Rr(de),us(de,"link",h),de._p=new Promise(function(Re,Fe){de.onload=Re,de.onerror=Fe}),de.addEventListener("load",function(){re.loading|=1}),de.addEventListener("error",function(){re.loading|=2}),re.loading|=4,yy(X,p,w)}X={type:"stylesheet",instance:X,count:1,state:re},A.set(P,X)}}}function qee(h,p){hl.X(h,p);var v=uh;if(v&&h){var w=Xo(v).hoistableScripts,A=hh(h),P=w.get(A);P||(P=v.querySelector(ip(A)),P||(h=u({src:h,async:!0},p),(p=Yi.get(A))&&n1(h,p),P=v.createElement("script"),Rr(P),us(P,"link",h),v.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},w.set(A,P))}}function Wee(h,p){hl.M(h,p);var v=uh;if(v&&h){var w=Xo(v).hoistableScripts,A=hh(h),P=w.get(A);P||(P=v.querySelector(ip(A)),P||(h=u({src:h,async:!0,type:"module"},p),(p=Yi.get(A))&&n1(h,p),P=v.createElement("script"),Rr(P),us(P,"link",h),v.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},w.set(A,P))}}function kj(h,p,v,w){var A=(A=J.current)?vy(A):null;if(!A)throw Error(r(446));switch(h){case"meta":case"title":return null;case"style":return typeof v.precedence=="string"&&typeof v.href=="string"?(p=dh(v.href),v=Xo(A).hoistableStyles,w=v.get(p),w||(w={type:"style",instance:null,count:0,state:null},v.set(p,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(v.rel==="stylesheet"&&typeof v.href=="string"&&typeof v.precedence=="string"){h=dh(v.href);var P=Xo(A).hoistableStyles,X=P.get(h);if(X||(A=A.ownerDocument||A,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(h,X),(P=A.querySelector(sp(h)))&&!P._p&&(X.instance=P,X.state.loading=5),Yi.has(h)||(v={rel:"preload",as:"style",href:v.href,crossOrigin:v.crossOrigin,integrity:v.integrity,media:v.media,hrefLang:v.hrefLang,referrerPolicy:v.referrerPolicy},Yi.set(h,v),P||Kee(A,h,v,X.state))),p&&w===null)throw Error(r(528,""));return X}if(p&&w!==null)throw Error(r(529,""));return null;case"script":return p=v.async,v=v.src,typeof v=="string"&&p&&typeof p!="function"&&typeof p!="symbol"?(p=hh(v),v=Xo(A).hoistableScripts,w=v.get(p),w||(w={type:"script",instance:null,count:0,state:null},v.set(p,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,h))}}function dh(h){return'href="'+Hi(h)+'"'}function sp(h){return'link[rel="stylesheet"]['+h+"]"}function Ij(h){return u({},h,{"data-precedence":h.precedence,precedence:null})}function Kee(h,p,v,w){h.querySelector('link[rel="preload"][as="style"]['+p+"]")?w.loading=1:(p=h.createElement("link"),w.preload=p,p.addEventListener("load",function(){return w.loading|=1}),p.addEventListener("error",function(){return w.loading|=2}),us(p,"link",v),Rr(p),h.head.appendChild(p))}function hh(h){return'[src="'+Hi(h)+'"]'}function ip(h){return"script[async]"+h}function Lj(h,p,v){if(p.count++,p.instance===null)switch(p.type){case"style":var w=h.querySelector('style[data-href~="'+Hi(v.href)+'"]');if(w)return p.instance=w,Rr(w),w;var A=u({},v,{"data-href":v.href,"data-precedence":v.precedence,href:null,precedence:null});return w=(h.ownerDocument||h).createElement("style"),Rr(w),us(w,"style",A),yy(w,v.precedence,h),p.instance=w;case"stylesheet":A=dh(v.href);var P=h.querySelector(sp(A));if(P)return p.state.loading|=4,p.instance=P,Rr(P),P;w=Ij(v),(A=Yi.get(A))&&t1(w,A),P=(h.ownerDocument||h).createElement("link"),Rr(P);var X=P;return X._p=new Promise(function(re,de){X.onload=re,X.onerror=de}),us(P,"link",w),p.state.loading|=4,yy(P,v.precedence,h),p.instance=P;case"script":return P=hh(v.src),(A=h.querySelector(ip(P)))?(p.instance=A,Rr(A),A):(w=v,(A=Yi.get(P))&&(w=u({},v),n1(w,A)),h=h.ownerDocument||h,A=h.createElement("script"),Rr(A),us(A,"link",w),h.head.appendChild(A),p.instance=A);case"void":return null;default:throw Error(r(443,p.type))}else p.type==="stylesheet"&&(p.state.loading&4)===0&&(w=p.instance,p.state.loading|=4,yy(w,v.precedence,h));return p.instance}function yy(h,p,v){for(var w=v.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=w.length?w[w.length-1]:null,P=A,X=0;X<w.length;X++){var re=w[X];if(re.dataset.precedence===p)P=re;else if(P!==A)break}P?P.parentNode.insertBefore(h,P.nextSibling):(p=v.nodeType===9?v.head:v,p.insertBefore(h,p.firstChild))}function t1(h,p){h.crossOrigin==null&&(h.crossOrigin=p.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=p.referrerPolicy),h.title==null&&(h.title=p.title)}function n1(h,p){h.crossOrigin==null&&(h.crossOrigin=p.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=p.referrerPolicy),h.integrity==null&&(h.integrity=p.integrity)}var by=null;function Dj(h,p,v){if(by===null){var w=new Map,A=by=new Map;A.set(v,w)}else A=by,w=A.get(v),w||(w=new Map,A.set(v,w));if(w.has(h))return w;for(w.set(h,null),v=v.getElementsByTagName(h),A=0;A<v.length;A++){var P=v[A];if(!(P[Mn]||P[Xe]||h==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var X=P.getAttribute(p)||"";X=h+X;var re=w.get(X);re?re.push(P):w.set(X,[P])}}return w}function Pj(h,p,v){h=h.ownerDocument||h,h.head.insertBefore(v,p==="title"?h.querySelector("head > title"):null)}function Yee(h,p,v){if(v===1||p.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof p.precedence!="string"||typeof p.href!="string"||p.href==="")break;return!0;case"link":if(typeof p.rel!="string"||typeof p.href!="string"||p.href===""||p.onLoad||p.onError)break;switch(p.rel){case"stylesheet":return h=p.disabled,typeof p.precedence=="string"&&h==null;default:return!0}case"script":if(p.async&&typeof p.async!="function"&&typeof p.async!="symbol"&&!p.onLoad&&!p.onError&&p.src&&typeof p.src=="string")return!0}return!1}function Mj(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}var ap=null;function Xee(){}function Qee(h,p,v){if(ap===null)throw Error(r(475));var w=ap;if(p.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var A=dh(v.href),P=h.querySelector(sp(A));if(P){h=P._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(w.count++,w=xy.bind(w),h.then(w,w)),p.state.loading|=4,p.instance=P,Rr(P);return}P=h.ownerDocument||h,v=Ij(v),(A=Yi.get(A))&&t1(v,A),P=P.createElement("link"),Rr(P);var X=P;X._p=new Promise(function(re,de){X.onload=re,X.onerror=de}),us(P,"link",v),p.instance=P}w.stylesheets===null&&(w.stylesheets=new Map),w.stylesheets.set(p,h),(h=p.state.preload)&&(p.state.loading&3)===0&&(w.count++,p=xy.bind(w),h.addEventListener("load",p),h.addEventListener("error",p))}}function Zee(){if(ap===null)throw Error(r(475));var h=ap;return h.stylesheets&&h.count===0&&r1(h,h.stylesheets),0<h.count?function(p){var v=setTimeout(function(){if(h.stylesheets&&r1(h,h.stylesheets),h.unsuspend){var w=h.unsuspend;h.unsuspend=null,w()}},6e4);return h.unsuspend=p,function(){h.unsuspend=null,clearTimeout(v)}}:null}function xy(){if(this.count--,this.count===0){if(this.stylesheets)r1(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var wy=null;function r1(h,p){h.stylesheets=null,h.unsuspend!==null&&(h.count++,wy=new Map,p.forEach(Jee,h),wy=null,xy.call(h))}function Jee(h,p){if(!(p.state.loading&4)){var v=wy.get(h);if(v)var w=v.get(null);else{v=new Map,wy.set(h,v);for(var A=h.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<A.length;P++){var X=A[P];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(v.set(X.dataset.precedence,X),w=X)}w&&v.set(null,w)}A=p.instance,X=A.getAttribute("data-precedence"),P=v.get(X)||w,P===w&&v.set(null,A),v.set(X,A),this.count++,w=xy.bind(this),A.addEventListener("load",w),A.addEventListener("error",w),P?P.parentNode.insertBefore(A,P.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(A,h.firstChild)),p.state.loading|=4}}var op={$$typeof:_,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function ete(h,p,v,w,A,P,X,re){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=An(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=An(0),this.hiddenUpdates=An(null),this.identifierPrefix=w,this.onUncaughtError=A,this.onCaughtError=P,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function Oj(h,p,v,w,A,P,X,re,de,Re,Fe,Ve){return h=new ete(h,p,v,X,re,de,Re,Ve),p=1,P===!0&&(p|=24),P=wi(3,null,null,p),h.current=P,P.stateNode=h,p=FT(),p.refCount++,h.pooledCache=p,p.refCount++,P.memoizedState={element:w,isDehydrated:v,cache:p},HT(P),h}function Nj(h){return h?(h=Vd,h):Vd}function jj(h,p,v,w,A,P){A=Nj(A),w.context===null?w.context=A:w.pendingContext=A,w=Yl(p),w.payload={element:v},P=P===void 0?null:P,P!==null&&(w.callback=P),v=Xl(h,w,p),v!==null&&(Ai(v,h,p),jm(v,h,p))}function Fj(h,p){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var v=h.retryLane;h.retryLane=v!==0&&v<p?v:p}}function s1(h,p){Fj(h,p),(h=h.alternate)&&Fj(h,p)}function Uj(h){if(h.tag===13){var p=Hd(h,67108864);p!==null&&Ai(p,h,67108864),s1(h,67108864)}}var Ey=!0;function tte(h,p,v,w){var A=F.T;F.T=null;var P=j.p;try{j.p=2,i1(h,p,v,w)}finally{j.p=P,F.T=A}}function nte(h,p,v,w){var A=F.T;F.T=null;var P=j.p;try{j.p=8,i1(h,p,v,w)}finally{j.p=P,F.T=A}}function i1(h,p,v,w){if(Ey){var A=a1(w);if(A===null)q_(h,p,w,Sy,v),Bj(h,w);else if(ste(A,h,p,v,w))w.stopPropagation();else if(Bj(h,w),p&4&&-1<rte.indexOf(h)){for(;A!==null;){var P=Ea(A);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var X=Qe(P.pendingLanes);if(X!==0){var re=P;for(re.pendingLanes|=2,re.entangledLanes|=2;X;){var de=1<<31-be(X);re.entanglements[1]|=de,X&=~de}ao(P),(Sn&6)===0&&(ay=ie()+500,ep(0))}}break;case 13:re=Hd(P,2),re!==null&&Ai(re,P,2),ly(),s1(P,2)}if(P=a1(w),P===null&&q_(h,p,w,Sy,v),P===A)break;A=P}A!==null&&w.stopPropagation()}else q_(h,p,w,null,v)}}function a1(h){return h=dT(h),o1(h)}var Sy=null;function o1(h){if(Sy=null,h=bs(h),h!==null){var p=i(h);if(p===null)h=null;else{var v=p.tag;if(v===13){if(h=a(p),h!==null)return h;h=null}else if(v===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;h=null}else p!==h&&(h=null)}}return Sy=h,null}function $j(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fe()){case Ie:return 2;case ne:return 8;case ce:case Ce:return 32;case Oe:return 268435456;default:return 32}default:return 32}}var l1=!1,cc=null,uc=null,dc=null,lp=new Map,cp=new Map,hc=[],rte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bj(h,p){switch(h){case"focusin":case"focusout":cc=null;break;case"dragenter":case"dragleave":uc=null;break;case"mouseover":case"mouseout":dc=null;break;case"pointerover":case"pointerout":lp.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":cp.delete(p.pointerId)}}function up(h,p,v,w,A,P){return h===null||h.nativeEvent!==P?(h={blockedOn:p,domEventName:v,eventSystemFlags:w,nativeEvent:P,targetContainers:[A]},p!==null&&(p=Ea(p),p!==null&&Uj(p)),h):(h.eventSystemFlags|=w,p=h.targetContainers,A!==null&&p.indexOf(A)===-1&&p.push(A),h)}function ste(h,p,v,w,A){switch(p){case"focusin":return cc=up(cc,h,p,v,w,A),!0;case"dragenter":return uc=up(uc,h,p,v,w,A),!0;case"mouseover":return dc=up(dc,h,p,v,w,A),!0;case"pointerover":var P=A.pointerId;return lp.set(P,up(lp.get(P)||null,h,p,v,w,A)),!0;case"gotpointercapture":return P=A.pointerId,cp.set(P,up(cp.get(P)||null,h,p,v,w,A)),!0}return!1}function Hj(h){var p=bs(h.target);if(p!==null){var v=i(p);if(v!==null){if(p=v.tag,p===13){if(p=a(v),p!==null){h.blockedOn=p,me(h.priority,function(){if(v.tag===13){var w=_i();w=Je(w);var A=Hd(v,w);A!==null&&Ai(A,v,w),s1(v,w)}});return}}else if(p===3&&v.stateNode.current.memoizedState.isDehydrated){h.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Ty(h){if(h.blockedOn!==null)return!1;for(var p=h.targetContainers;0<p.length;){var v=a1(h.nativeEvent);if(v===null){v=h.nativeEvent;var w=new v.constructor(v.type,v);uT=w,v.target.dispatchEvent(w),uT=null}else return p=Ea(v),p!==null&&Uj(p),h.blockedOn=v,!1;p.shift()}return!0}function Vj(h,p,v){Ty(h)&&v.delete(p)}function ite(){l1=!1,cc!==null&&Ty(cc)&&(cc=null),uc!==null&&Ty(uc)&&(uc=null),dc!==null&&Ty(dc)&&(dc=null),lp.forEach(Vj),cp.forEach(Vj)}function _y(h,p){h.blockedOn===p&&(h.blockedOn=null,l1||(l1=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ite)))}var Ay=null;function zj(h){Ay!==h&&(Ay=h,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ay===h&&(Ay=null);for(var p=0;p<h.length;p+=3){var v=h[p],w=h[p+1],A=h[p+2];if(typeof w!="function"){if(o1(w||v)===null)continue;break}var P=Ea(v);P!==null&&(h.splice(p,3),p-=3,o_(P,{pending:!0,data:A,method:v.method,action:w},w,A))}}))}function dp(h){function p(de){return _y(de,h)}cc!==null&&_y(cc,h),uc!==null&&_y(uc,h),dc!==null&&_y(dc,h),lp.forEach(p),cp.forEach(p);for(var v=0;v<hc.length;v++){var w=hc[v];w.blockedOn===h&&(w.blockedOn=null)}for(;0<hc.length&&(v=hc[0],v.blockedOn===null);)Hj(v),v.blockedOn===null&&hc.shift();if(v=(h.ownerDocument||h).$$reactFormReplay,v!=null)for(w=0;w<v.length;w+=3){var A=v[w],P=v[w+1],X=A[st]||null;if(typeof P=="function")X||zj(v);else if(X){var re=null;if(P&&P.hasAttribute("formAction")){if(A=P,X=P[st]||null)re=X.formAction;else if(o1(A)!==null)continue}else re=X.action;typeof re=="function"?v[w+1]=re:(v.splice(w,3),w-=3),zj(v)}}}function c1(h){this._internalRoot=h}Ry.prototype.render=c1.prototype.render=function(h){var p=this._internalRoot;if(p===null)throw Error(r(409));var v=p.current,w=_i();jj(v,w,h,p,null,null)},Ry.prototype.unmount=c1.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var p=h.containerInfo;jj(h.current,2,null,h,null,null),ly(),p[wt]=null}};function Ry(h){this._internalRoot=h}Ry.prototype.unstable_scheduleHydration=function(h){if(h){var p=Dt();h={blockedOn:null,target:h,priority:p};for(var v=0;v<hc.length&&p!==0&&p<hc[v].priority;v++);hc.splice(v,0,h),v===0&&Hj(h)}};var Gj=e.version;if(Gj!=="19.1.1")throw Error(r(527,Gj,"19.1.1"));j.findDOMNode=function(h){var p=h._reactInternals;if(p===void 0)throw typeof h.render=="function"?Error(r(188)):(h=Object.keys(h).join(","),Error(r(268,h)));return h=l(p),h=h!==null?c(h):null,h=h===null?null:h.stateNode,h};var ate={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cy.isDisabled&&Cy.supportsFiber)try{tt=Cy.inject(ate),lt=Cy}catch{}}return fp.createRoot=function(h,p){if(!s(h))throw Error(r(299));var v=!1,w="",A=oN,P=lN,X=cN,re=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onUncaughtError!==void 0&&(A=p.onUncaughtError),p.onCaughtError!==void 0&&(P=p.onCaughtError),p.onRecoverableError!==void 0&&(X=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(re=p.unstable_transitionCallbacks)),p=Oj(h,1,!1,null,null,v,w,A,P,X,re,null),h[wt]=p.current,G_(h),new c1(p)},fp.hydrateRoot=function(h,p,v){if(!s(h))throw Error(r(299));var w=!1,A="",P=oN,X=lN,re=cN,de=null,Re=null;return v!=null&&(v.unstable_strictMode===!0&&(w=!0),v.identifierPrefix!==void 0&&(A=v.identifierPrefix),v.onUncaughtError!==void 0&&(P=v.onUncaughtError),v.onCaughtError!==void 0&&(X=v.onCaughtError),v.onRecoverableError!==void 0&&(re=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(de=v.unstable_transitionCallbacks),v.formState!==void 0&&(Re=v.formState)),p=Oj(h,1,!0,p,v??null,w,A,P,X,re,de,Re),p.context=Nj(null),v=p.current,w=_i(),w=Je(w),A=Yl(w),A.callback=null,Xl(v,A,w),v=w,p.current.lanes=v,Lt(p,v),ao(p),h[wt]=p.current,G_(h),new Ry(p)},fp.version="19.1.1",fp}var tF;function vte(){if(tF)return d1.exports;tF=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),d1.exports=gte(),d1.exports}var yte=vte(),E=BE();const ve=Rd(E),E8=lte({__proto__:null,default:ve},[E]);var g1,nF;function bte(){if(nF)return g1;nF=1;var n=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",r=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s(i,a){if(i===a)return!0;if(i&&a&&typeof i=="object"&&typeof a=="object"){if(i.constructor!==a.constructor)return!1;var o,l,c;if(Array.isArray(i)){if(o=i.length,o!=a.length)return!1;for(l=o;l--!==0;)if(!s(i[l],a[l]))return!1;return!0}var u;if(e&&i instanceof Map&&a instanceof Map){if(i.size!==a.size)return!1;for(u=i.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;for(u=i.entries();!(l=u.next()).done;)if(!s(l.value[1],a.get(l.value[0])))return!1;return!0}if(t&&i instanceof Set&&a instanceof Set){if(i.size!==a.size)return!1;for(u=i.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(i)&&ArrayBuffer.isView(a)){if(o=i.length,o!=a.length)return!1;for(l=o;l--!==0;)if(i[l]!==a[l])return!1;return!0}if(i.constructor===RegExp)return i.source===a.source&&i.flags===a.flags;if(i.valueOf!==Object.prototype.valueOf&&typeof i.valueOf=="function"&&typeof a.valueOf=="function")return i.valueOf()===a.valueOf();if(i.toString!==Object.prototype.toString&&typeof i.toString=="function"&&typeof a.toString=="function")return i.toString()===a.toString();if(c=Object.keys(i),o=c.length,o!==Object.keys(a).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(a,c[l]))return!1;if(n&&i instanceof Element)return!1;for(l=o;l--!==0;)if(!((c[l]==="_owner"||c[l]==="__v"||c[l]==="__o")&&i.$$typeof)&&!s(i[c[l]],a[c[l]]))return!1;return!0}return i!==i&&a!==a}return g1=function(a,o){try{return s(a,o)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},g1}var xte=bte();const wte=Rd(xte);var v1,rF;function Ete(){if(rF)return v1;rF=1;var n=function(e,t,r,s,i,a,o,l){if(!e){var c;if(t===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,s,i,a,o,l],f=0;c=new Error(t.replace(/%s/g,function(){return u[f++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}};return v1=n,v1}var Ste=Ete();const sF=Rd(Ste);var y1,iF;function Tte(){return iF||(iF=1,y1=function(e,t,r,s){var i=r?r.call(s,e,t):void 0;if(i!==void 0)return!!i;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),c=0;c<a.length;c++){var u=a[c];if(!l(u))return!1;var f=e[u],m=t[u];if(i=r?r.call(s,f,m,u):void 0,i===!1||i===void 0&&f!==m)return!1}return!0}),y1}var _te=Tte();const Ate=Rd(_te);var S8=(n=>(n.BASE="base",n.BODY="body",n.HEAD="head",n.HTML="html",n.LINK="link",n.META="meta",n.NOSCRIPT="noscript",n.SCRIPT="script",n.STYLE="style",n.TITLE="title",n.FRAGMENT="Symbol(react.fragment)",n))(S8||{}),b1={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},aF=Object.values(S8),yL={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Rte=Object.entries(yL).reduce((n,[e,t])=>(n[t]=e,n),{}),Ba="data-rh",xf={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},wf=(n,e)=>{for(let t=n.length-1;t>=0;t-=1){const r=n[t];if(Object.prototype.hasOwnProperty.call(r,e))return r[e]}return null},Cte=n=>{let e=wf(n,"title");const t=wf(n,xf.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),t&&e)return t.replace(/%s/g,()=>e);const r=wf(n,xf.DEFAULT_TITLE);return e||r||void 0},kte=n=>wf(n,xf.ON_CHANGE_CLIENT_STATE)||(()=>{}),x1=(n,e)=>e.filter(t=>typeof t[n]<"u").map(t=>t[n]).reduce((t,r)=>({...t,...r}),{}),Ite=(n,e)=>e.filter(t=>typeof t.base<"u").map(t=>t.base).reverse().reduce((t,r)=>{if(!t.length){const s=Object.keys(r);for(let i=0;i<s.length;i+=1){const o=s[i].toLowerCase();if(n.indexOf(o)!==-1&&r[o])return t.concat(r)}}return t},[]),Lte=n=>console&&typeof console.warn=="function"&&console.warn(n),mp=(n,e,t)=>{const r={};return t.filter(s=>Array.isArray(s[n])?!0:(typeof s[n]<"u"&&Lte(`Helmet: ${n} should be of type "Array". Instead found type "${typeof s[n]}"`),!1)).map(s=>s[n]).reverse().reduce((s,i)=>{const a={};i.filter(l=>{let c;const u=Object.keys(l);for(let m=0;m<u.length;m+=1){const g=u[m],y=g.toLowerCase();e.indexOf(y)!==-1&&!(c==="rel"&&l[c].toLowerCase()==="canonical")&&!(y==="rel"&&l[y].toLowerCase()==="stylesheet")&&(c=y),e.indexOf(g)!==-1&&(g==="innerHTML"||g==="cssText"||g==="itemprop")&&(c=g)}if(!c||!l[c])return!1;const f=l[c].toLowerCase();return r[c]||(r[c]={}),a[c]||(a[c]={}),r[c][f]?!1:(a[c][f]=!0,!0)}).reverse().forEach(l=>s.push(l));const o=Object.keys(a);for(let l=0;l<o.length;l+=1){const c=o[l],u={...r[c],...a[c]};r[c]=u}return s},[]).reverse()},Dte=(n,e)=>{if(Array.isArray(n)&&n.length){for(let t=0;t<n.length;t+=1)if(n[t][e])return!0}return!1},Pte=n=>({baseTag:Ite(["href"],n),bodyAttributes:x1("bodyAttributes",n),defer:wf(n,xf.DEFER),encode:wf(n,xf.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:x1("htmlAttributes",n),linkTags:mp("link",["rel","href"],n),metaTags:mp("meta",["name","charset","http-equiv","property","itemprop"],n),noscriptTags:mp("noscript",["innerHTML"],n),onChangeClientState:kte(n),scriptTags:mp("script",["src","innerHTML"],n),styleTags:mp("style",["cssText"],n),title:Cte(n),titleAttributes:x1("titleAttributes",n),prioritizeSeoTags:Dte(n,xf.PRIORITIZE_SEO_TAGS)}),T8=n=>Array.isArray(n)?n.join(""):n,Mte=(n,e)=>{const t=Object.keys(n);for(let r=0;r<t.length;r+=1)if(e[t[r]]&&e[t[r]].includes(n[t[r]]))return!0;return!1},w1=(n,e)=>Array.isArray(n)?n.reduce((t,r)=>(Mte(r,e)?t.priority.push(r):t.default.push(r),t),{priority:[],default:[]}):{default:n,priority:[]},oF=(n,e)=>({...n,[e]:void 0}),Ote=["noscript","script","style"],DR=(n,e=!0)=>e===!1?String(n):String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),_8=n=>Object.keys(n).reduce((e,t)=>{const r=typeof n[t]<"u"?`${t}="${n[t]}"`:`${t}`;return e?`${e} ${r}`:r},""),Nte=(n,e,t,r)=>{const s=_8(t),i=T8(e);return s?`<${n} ${Ba}="true" ${s}>${DR(i,r)}</${n}>`:`<${n} ${Ba}="true">${DR(i,r)}</${n}>`},jte=(n,e,t=!0)=>e.reduce((r,s)=>{const i=s,a=Object.keys(i).filter(c=>!(c==="innerHTML"||c==="cssText")).reduce((c,u)=>{const f=typeof i[u]>"u"?u:`${u}="${DR(i[u],t)}"`;return c?`${c} ${f}`:f},""),o=i.innerHTML||i.cssText||"",l=Ote.indexOf(n)===-1;return`${r}<${n} ${Ba}="true" ${a}${l?"/>":`>${o}</${n}>`}`},""),A8=(n,e={})=>Object.keys(n).reduce((t,r)=>{const s=yL[r];return t[s||r]=n[r],t},e),Fte=(n,e,t)=>{const r={key:e,[Ba]:!0},s=A8(t,r);return[ve.createElement("title",s,e)]},Bb=(n,e)=>e.map((t,r)=>{const s={key:r,[Ba]:!0};return Object.keys(t).forEach(i=>{const o=yL[i]||i;if(o==="innerHTML"||o==="cssText"){const l=t.innerHTML||t.cssText;s.dangerouslySetInnerHTML={__html:l}}else s[o]=t[i]}),ve.createElement(n,s)}),ra=(n,e,t=!0)=>{switch(n){case"title":return{toComponent:()=>Fte(n,e.title,e.titleAttributes),toString:()=>Nte(n,e.title,e.titleAttributes,t)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>A8(e),toString:()=>_8(e)};default:return{toComponent:()=>Bb(n,e),toString:()=>jte(n,e,t)}}},Ute=({metaTags:n,linkTags:e,scriptTags:t,encode:r})=>{const s=w1(n,b1.meta),i=w1(e,b1.link),a=w1(t,b1.script);return{priorityMethods:{toComponent:()=>[...Bb("meta",s.priority),...Bb("link",i.priority),...Bb("script",a.priority)],toString:()=>`${ra("meta",s.priority,r)} ${ra("link",i.priority,r)} ${ra("script",a.priority,r)}`},metaTags:s.default,linkTags:i.default,scriptTags:a.default}},$te=n=>{const{baseTag:e,bodyAttributes:t,encode:r=!0,htmlAttributes:s,noscriptTags:i,styleTags:a,title:o="",titleAttributes:l,prioritizeSeoTags:c}=n;let{linkTags:u,metaTags:f,scriptTags:m}=n,g={toComponent:()=>{},toString:()=>""};return c&&({priorityMethods:g,linkTags:u,metaTags:f,scriptTags:m}=Ute(n)),{priority:g,base:ra("base",e,r),bodyAttributes:ra("bodyAttributes",t,r),htmlAttributes:ra("htmlAttributes",s,r),link:ra("link",u,r),meta:ra("meta",f,r),noscript:ra("noscript",i,r),script:ra("script",m,r),style:ra("style",a,r),title:ra("title",{title:o,titleAttributes:l},r)}},PR=$te,ky=[],R8=!!(typeof window<"u"&&window.document&&window.document.createElement),MR=class{instances=[];canUseDOM=R8;context;value={setHelmet:n=>{this.context.helmet=n},helmetInstances:{get:()=>this.canUseDOM?ky:this.instances,add:n=>{(this.canUseDOM?ky:this.instances).push(n)},remove:n=>{const e=(this.canUseDOM?ky:this.instances).indexOf(n);(this.canUseDOM?ky:this.instances).splice(e,1)}}};constructor(n,e){this.context=n,this.canUseDOM=e||!1,e||(n.helmet=PR({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Bte={},C8=ve.createContext(Bte),k8=class I8 extends E.Component{static canUseDOM=R8;helmetData;constructor(e){super(e),this.helmetData=new MR(this.props.context||{},I8.canUseDOM)}render(){return ve.createElement(C8.Provider,{value:this.helmetData.value},this.props.children)}},fh=(n,e)=>{const t=document.head||document.querySelector("head"),r=t.querySelectorAll(`${n}[${Ba}]`),s=[].slice.call(r),i=[];let a;return e&&e.length&&e.forEach(o=>{const l=document.createElement(n);for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c))if(c==="innerHTML")l.innerHTML=o.innerHTML;else if(c==="cssText")l.styleSheet?l.styleSheet.cssText=o.cssText:l.appendChild(document.createTextNode(o.cssText));else{const u=c,f=typeof o[u]>"u"?"":o[u];l.setAttribute(c,f)}l.setAttribute(Ba,"true"),s.some((c,u)=>(a=u,l.isEqualNode(c)))?s.splice(a,1):i.push(l)}),s.forEach(o=>o.parentNode?.removeChild(o)),i.forEach(o=>t.appendChild(o)),{oldTags:s,newTags:i}},OR=(n,e)=>{const t=document.getElementsByTagName(n)[0];if(!t)return;const r=t.getAttribute(Ba),s=r?r.split(","):[],i=[...s],a=Object.keys(e);for(const o of a){const l=e[o]||"";t.getAttribute(o)!==l&&t.setAttribute(o,l),s.indexOf(o)===-1&&s.push(o);const c=i.indexOf(o);c!==-1&&i.splice(c,1)}for(let o=i.length-1;o>=0;o-=1)t.removeAttribute(i[o]);s.length===i.length?t.removeAttribute(Ba):t.getAttribute(Ba)!==a.join(",")&&t.setAttribute(Ba,a.join(","))},Hte=(n,e)=>{typeof n<"u"&&document.title!==n&&(document.title=T8(n)),OR("title",e)},lF=(n,e)=>{const{baseTag:t,bodyAttributes:r,htmlAttributes:s,linkTags:i,metaTags:a,noscriptTags:o,onChangeClientState:l,scriptTags:c,styleTags:u,title:f,titleAttributes:m}=n;OR("body",r),OR("html",s),Hte(f,m);const g={baseTag:fh("base",t),linkTags:fh("link",i),metaTags:fh("meta",a),noscriptTags:fh("noscript",o),scriptTags:fh("script",c),styleTags:fh("style",u)},y={},b={};Object.keys(g).forEach(x=>{const{newTags:S,oldTags:T}=g[x];S.length&&(y[x]=S),T.length&&(b[x]=g[x].oldTags)}),e&&e(),l(n,y,b)},pp=null,Vte=n=>{pp&&cancelAnimationFrame(pp),n.defer?pp=requestAnimationFrame(()=>{lF(n,()=>{pp=null})}):(lF(n),pp=null)},zte=Vte,cF=class extends E.Component{rendered=!1;shouldComponentUpdate(n){return!Ate(n,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:n}=this.props.context;n.remove(this),this.emitChange()}emitChange(){const{helmetInstances:n,setHelmet:e}=this.props.context;let t=null;const r=Pte(n.get().map(s=>{const i={...s.props};return delete i.context,i}));k8.canUseDOM?zte(r):PR&&(t=PR(r)),e(t)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:n}=this.props.context;n.add(this),this.emitChange()}render(){return this.init(),null}},Gte=class extends E.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(n){return!wte(oF(this.props,"helmetData"),oF(n,"helmetData"))}mapNestedChildrenToProps(n,e){if(!e)return null;switch(n.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${n.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(n,e,t,r){return{...e,[n.type]:[...e[n.type]||[],{...t,...this.mapNestedChildrenToProps(n,r)}]}}mapObjectTypeChildren(n,e,t,r){switch(n.type){case"title":return{...e,[n.type]:r,titleAttributes:{...t}};case"body":return{...e,bodyAttributes:{...t}};case"html":return{...e,htmlAttributes:{...t}};default:return{...e,[n.type]:{...t}}}}mapArrayTypeChildrenToProps(n,e){let t={...e};return Object.keys(n).forEach(r=>{t={...t,[r]:n[r]}}),t}warnOnInvalidChildren(n,e){return sF(aF.some(t=>n.type===t),typeof n.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${aF.join(", ")} are allowed. Helmet does not support rendering <${n.type}> elements. Refer to our API for more information.`),sF(!e||typeof e=="string"||Array.isArray(e)&&!e.some(t=>typeof t!="string"),`Helmet expects a string as a child of <${n.type}>. Did you forget to wrap your children in braces? ( <${n.type}>{\`\`}</${n.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(n,e){let t={};return ve.Children.forEach(n,r=>{if(!r||!r.props)return;const{children:s,...i}=r.props,a=Object.keys(i).reduce((l,c)=>(l[Rte[c]||c]=i[c],l),{});let{type:o}=r;switch(typeof o=="symbol"?o=o.toString():this.warnOnInvalidChildren(r,s),o){case"Symbol(react.fragment)":e=this.mapChildrenToProps(s,e);break;case"link":case"meta":case"noscript":case"script":case"style":t=this.flattenArrayTypeChildren(r,t,a,s);break;default:e=this.mapObjectTypeChildren(r,e,a,s);break}}),this.mapArrayTypeChildrenToProps(t,e)}render(){const{children:n,...e}=this.props;let t={...e},{helmetData:r}=e;if(n&&(t=this.mapChildrenToProps(n,t)),r&&!(r instanceof MR)){const s=r;r=new MR(s.context,!0),delete t.helmetData}return r?ve.createElement(cF,{...t,context:r.value}):ve.createElement(C8.Consumer,null,s=>ve.createElement(cF,{...t,context:s}))}};/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var uF="popstate";function qte(n={}){function e(r,s){let{pathname:i,search:a,hash:o}=r.location;return NR("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Bg(s)}return Kte(e,t,null,n)}function Qn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ba(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Wte(){return Math.random().toString(36).substring(2,10)}function dF(n,e){return{usr:n.state,key:n.key,idx:e}}function NR(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?nm(e):e,state:t,key:e&&e.key||r||Wte()}}function Bg({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function nm(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function Kte(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,o="POP",l=null,c=u();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function u(){return(a.state||{idx:null}).idx}function f(){o="POP";let x=u(),S=x==null?null:x-c;c=x,l&&l({action:o,location:b.location,delta:S})}function m(x,S){o="PUSH";let T=NR(b.location,x,S);c=u()+1;let _=dF(T,c),R=b.createHref(T);try{a.pushState(_,"",R)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(R)}i&&l&&l({action:o,location:b.location,delta:1})}function g(x,S){o="REPLACE";let T=NR(b.location,x,S);c=u();let _=dF(T,c),R=b.createHref(T);a.replaceState(_,"",R),i&&l&&l({action:o,location:b.location,delta:0})}function y(x){return Yte(x)}let b={get action(){return o},get location(){return n(s,a)},listen(x){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(uF,f),l=x,()=>{s.removeEventListener(uF,f),l=null}},createHref(x){return e(s,x)},createURL:y,encodeLocation(x){let S=y(x);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(x){return a.go(x)}};return b}function Yte(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Qn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Bg(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function L8(n,e,t="/"){return Xte(n,e,t,!1)}function Xte(n,e,t,r){let s=typeof e=="string"?nm(e):e,i=jl(s.pathname||"/",t);if(i==null)return null;let a=D8(n);Qte(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=lne(i);o=ane(a[l],c,r)}return o}function D8(n,e=[],t=[],r=""){let s=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(Qn(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=Nl([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(Qn(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),D8(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:sne(c,i.index),routesMeta:u})};return n.forEach((i,a)=>{if(i.path===""||!i.path?.includes("?"))s(i,a);else for(let o of P8(i.path))s(i,a,o)}),e}function P8(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=P8(r.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),s&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function Qte(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:ine(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var Zte=/^:[\w-]+$/,Jte=3,ene=2,tne=1,nne=10,rne=-2,hF=n=>n==="*";function sne(n,e){let t=n.split("/"),r=t.length;return t.some(hF)&&(r+=rne),e&&(r+=ene),t.filter(s=>!hF(s)).reduce((s,i)=>s+(Zte.test(i)?Jte:i===""?tne:nne),r)}function ine(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function ane(n,e,t=!1){let{routesMeta:r}=n,s={},i="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],c=o===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",f=Bx({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!f&&c&&t&&!r[r.length-1].route.index&&(f=Bx({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(s,f.params),a.push({params:s,pathname:Nl([i,f.pathname]),pathnameBase:hne(Nl([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=Nl([i,f.pathnameBase]))}return a}function Bx(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=one(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:f},m)=>{if(u==="*"){let y=o[m]||"";a=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[m];return f&&!g?c[u]=void 0:c[u]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:n}}function one(n,e=!1,t=!0){ba(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function lne(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ba(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function jl(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function cne(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?nm(n):n;return{pathname:t?t.startsWith("/")?t:une(t,e):e,search:fne(r),hash:mne(s)}}function une(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function E1(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dne(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bL(n){let e=dne(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function xL(n,e,t,r=!1){let s;typeof n=="string"?s=nm(n):(s={...n},Qn(!s.pathname||!s.pathname.includes("?"),E1("?","pathname","search",s)),Qn(!s.pathname||!s.pathname.includes("#"),E1("#","pathname","hash",s)),Qn(!s.search||!s.search.includes("#"),E1("#","search","hash",s)));let i=n===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=t;else{let f=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}o=f>=0?e[f]:"/"}let l=cne(s,o),c=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Nl=n=>n.join("/").replace(/\/\/+/g,"/"),hne=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fne=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,mne=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function pne(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var M8=["POST","PUT","PATCH","DELETE"];new Set(M8);var gne=["GET",...M8];new Set(gne);var rm=E.createContext(null);rm.displayName="DataRouter";var HE=E.createContext(null);HE.displayName="DataRouterState";E.createContext(!1);var O8=E.createContext({isTransitioning:!1});O8.displayName="ViewTransition";var vne=E.createContext(new Map);vne.displayName="Fetchers";var yne=E.createContext(null);yne.displayName="Await";var Ya=E.createContext(null);Ya.displayName="Navigation";var $v=E.createContext(null);$v.displayName="Location";var Xa=E.createContext({outlet:null,matches:[],isDataRoute:!1});Xa.displayName="Route";var wL=E.createContext(null);wL.displayName="RouteError";function bne(n,{relative:e}={}){Qn(sm(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=E.useContext(Ya),{hash:s,pathname:i,search:a}=Bv(n,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:Nl([t,i])),r.createHref({pathname:o,search:a,hash:s})}function sm(){return E.useContext($v)!=null}function Os(){return Qn(sm(),"useLocation() may be used only in the context of a <Router> component."),E.useContext($v).location}var N8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function j8(n){E.useContext(Ya).static||E.useLayoutEffect(n)}function Jn(){let{isDataRoute:n}=E.useContext(Xa);return n?Dne():xne()}function xne(){Qn(sm(),"useNavigate() may be used only in the context of a <Router> component.");let n=E.useContext(rm),{basename:e,navigator:t}=E.useContext(Ya),{matches:r}=E.useContext(Xa),{pathname:s}=Os(),i=JSON.stringify(bL(r)),a=E.useRef(!1);return j8(()=>{a.current=!0}),E.useCallback((l,c={})=>{if(ba(a.current,N8),!a.current)return;if(typeof l=="number"){t.go(l);return}let u=xL(l,JSON.parse(i),s,c.relative==="path");n==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Nl([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,i,s,n])}E.createContext(null);function F8(){let{matches:n}=E.useContext(Xa),e=n[n.length-1];return e?e.params:{}}function Bv(n,{relative:e}={}){let{matches:t}=E.useContext(Xa),{pathname:r}=Os(),s=JSON.stringify(bL(t));return E.useMemo(()=>xL(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function wne(n,e){return U8(n,e)}function U8(n,e,t,r){Qn(sm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=E.useContext(Ya),{matches:i}=E.useContext(Xa),a=i[i.length-1],o=a?a.params:{},l=a?a.pathname:"/",c=a?a.pathnameBase:"/",u=a&&a.route;{let S=u&&u.path||"";$8(l,!u||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let f=Os(),m;if(e){let S=typeof e=="string"?nm(e):e;Qn(c==="/"||S.pathname?.startsWith(c),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${S.pathname}" was given in the \`location\` prop.`),m=S}else m=f;let g=m.pathname||"/",y=g;if(c!=="/"){let S=c.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(S.length).join("/")}let b=L8(n,{pathname:y});ba(u||b!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),ba(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=Ane(b&&b.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:Nl([c,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?c:Nl([c,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,t,r);return e&&x?E.createElement($v.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},x):x}function Ene(){let n=Lne(),e=pne(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:i},"ErrorBoundary")," or"," ",E.createElement("code",{style:i},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:s},t):null,a)}var Sne=E.createElement(Ene,null),Tne=class extends E.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?E.createElement(Xa.Provider,{value:this.props.routeContext},E.createElement(wL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _ne({routeContext:n,match:e,children:t}){let r=E.useContext(rm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(Xa.Provider,{value:n},t)}function Ane(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,i=t?.errors;if(i!=null){let l=s.findIndex(c=>c.route.id&&i?.[c.route.id]!==void 0);Qn(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let a=!1,o=-1;if(t)for(let l=0;l<s.length;l++){let c=s[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:u,errors:f}=t,m=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||m){a=!0,o>=0?s=s.slice(0,o+1):s=[s[0]];break}}}return s.reduceRight((l,c,u)=>{let f,m=!1,g=null,y=null;t&&(f=i&&c.route.id?i[c.route.id]:void 0,g=c.route.errorElement||Sne,a&&(o<0&&u===0?($8("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,y=null):o===u&&(m=!0,y=c.route.hydrateFallbackElement||null)));let b=e.concat(s.slice(0,u+1)),x=()=>{let S;return f?S=g:m?S=y:c.route.Component?S=E.createElement(c.route.Component,null):c.route.element?S=c.route.element:S=l,E.createElement(_ne,{match:c,routeContext:{outlet:l,matches:b,isDataRoute:t!=null},children:S})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?E.createElement(Tne,{location:t.location,revalidation:t.revalidation,component:g,error:f,children:x(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):x()},null)}function EL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rne(n){let e=E.useContext(rm);return Qn(e,EL(n)),e}function Cne(n){let e=E.useContext(HE);return Qn(e,EL(n)),e}function kne(n){let e=E.useContext(Xa);return Qn(e,EL(n)),e}function SL(n){let e=kne(n),t=e.matches[e.matches.length-1];return Qn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Ine(){return SL("useRouteId")}function Lne(){let n=E.useContext(wL),e=Cne("useRouteError"),t=SL("useRouteError");return n!==void 0?n:e.errors?.[t]}function Dne(){let{router:n}=Rne("useNavigate"),e=SL("useNavigate"),t=E.useRef(!1);return j8(()=>{t.current=!0}),E.useCallback(async(s,i={})=>{ba(t.current,N8),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...i}))},[n,e])}var fF={};function $8(n,e,t){!e&&!fF[n]&&(fF[n]=!0,ba(!1,t))}E.memo(Pne);function Pne({routes:n,future:e,state:t}){return U8(n,void 0,t,e)}function Mne({to:n,replace:e,state:t,relative:r}){Qn(sm(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=E.useContext(Ya);ba(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=E.useContext(Xa),{pathname:a}=Os(),o=Jn(),l=xL(n,bL(i),a,r==="path"),c=JSON.stringify(l);return E.useEffect(()=>{o(JSON.parse(c),{replace:e,state:t,relative:r})},[o,c,r,e,t]),null}function ti(n){Qn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function One({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:i=!1}){Qn(!sm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),o=E.useMemo(()=>({basename:a,navigator:s,static:i,future:{}}),[a,s,i]);typeof t=="string"&&(t=nm(t));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:m="default"}=t,g=E.useMemo(()=>{let y=jl(l,a);return y==null?null:{location:{pathname:y,search:c,hash:u,state:f,key:m},navigationType:r}},[a,l,c,u,f,m,r]);return ba(g!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:E.createElement(Ya.Provider,{value:o},E.createElement($v.Provider,{children:e,value:g}))}function Nne({children:n,location:e}){return wne(jR(n),e)}function jR(n,e=[]){let t=[];return E.Children.forEach(n,(r,s)=>{if(!E.isValidElement(r))return;let i=[...e,s];if(r.type===E.Fragment){t.push.apply(t,jR(r.props.children,i));return}Qn(r.type===ti,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=jR(r.props.children,i)),t.push(a)}),t}var Hb="get",Vb="application/x-www-form-urlencoded";function VE(n){return n!=null&&typeof n.tagName=="string"}function jne(n){return VE(n)&&n.tagName.toLowerCase()==="button"}function Fne(n){return VE(n)&&n.tagName.toLowerCase()==="form"}function Une(n){return VE(n)&&n.tagName.toLowerCase()==="input"}function $ne(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Bne(n,e){return n.button===0&&(!e||e==="_self")&&!$ne(n)}function FR(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function Hne(n,e){let t=FR(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(i=>{t.append(s,i)})}),t}var Iy=null;function Vne(){if(Iy===null)try{new FormData(document.createElement("form"),0),Iy=!1}catch{Iy=!0}return Iy}var zne=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function S1(n){return n!=null&&!zne.has(n)?(ba(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vb}"`),null):n}function Gne(n,e){let t,r,s,i,a;if(Fne(n)){let o=n.getAttribute("action");r=o?jl(o,e):null,t=n.getAttribute("method")||Hb,s=S1(n.getAttribute("enctype"))||Vb,i=new FormData(n)}else if(jne(n)||Une(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(r=l?jl(l,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||Hb,s=S1(n.getAttribute("formenctype"))||S1(o.getAttribute("enctype"))||Vb,i=new FormData(o,n),!Vne()){let{name:c,type:u,value:f}=n;if(u==="image"){let m=c?`${c}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else c&&i.append(c,f)}}else{if(VE(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Hb,r=null,s=Vb,a=n}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function TL(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qne(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&jl(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function Wne(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Kne(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Yne(n,e,t){let r=await Promise.all(n.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await Wne(i,t);return a.links?a.links():[]}return[]}));return Jne(r.flat(1).filter(Kne).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function mF(n,e,t,r,s,i){let a=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>t[c].pathname!==l.pathname||t[c].route.path?.endsWith("*")&&t[c].params["*"]!==l.params["*"];return i==="assets"?e.filter((l,c)=>a(l,c)||o(l,c)):i==="data"?e.filter((l,c)=>{let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let f=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Xne(n,e,{includeHydrateFallback:t}={}){return Qne(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function Qne(n){return[...new Set(n)]}function Zne(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Jne(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let i=JSON.stringify(Zne(s));return t.has(i)||(t.add(i),r.push({key:i,link:s})),r},[])}function B8(){let n=E.useContext(rm);return TL(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function ere(){let n=E.useContext(HE);return TL(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var _L=E.createContext(void 0);_L.displayName="FrameworkContext";function H8(){let n=E.useContext(_L);return TL(n,"You must render this element inside a <HydratedRouter> element"),n}function tre(n,e){let t=E.useContext(_L),[r,s]=E.useState(!1),[i,a]=E.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=e,m=E.useRef(null);E.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let b=S=>{S.forEach(T=>{a(T.isIntersecting)})},x=new IntersectionObserver(b,{threshold:.5});return m.current&&x.observe(m.current),()=>{x.disconnect()}}},[n]),E.useEffect(()=>{if(r){let b=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(b)}}},[r]);let g=()=>{s(!0)},y=()=>{s(!1),a(!1)};return t?n!=="intent"?[i,m,{}]:[i,m,{onFocus:gp(o,g),onBlur:gp(l,y),onMouseEnter:gp(c,g),onMouseLeave:gp(u,y),onTouchStart:gp(f,g)}]:[!1,m,{}]}function gp(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function nre({page:n,...e}){let{router:t}=B8(),r=E.useMemo(()=>L8(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?E.createElement(sre,{page:n,matches:r,...e}):null}function rre(n){let{manifest:e,routeModules:t}=H8(),[r,s]=E.useState([]);return E.useEffect(()=>{let i=!1;return Yne(n,e,t).then(a=>{i||s(a)}),()=>{i=!0}},[n,e,t]),r}function sre({page:n,matches:e,...t}){let r=Os(),{manifest:s,routeModules:i}=H8(),{basename:a}=B8(),{loaderData:o,matches:l}=ere(),c=E.useMemo(()=>mF(n,e,l,s,r,"data"),[n,e,l,s,r]),u=E.useMemo(()=>mF(n,e,l,s,r,"assets"),[n,e,l,s,r]),f=E.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,b=!1;if(e.forEach(S=>{let T=s.routes[S.route.id];!T||!T.hasLoader||(!c.some(_=>_.route.id===S.route.id)&&S.route.id in o&&i[S.route.id]?.shouldRevalidate||T.hasClientLoader?b=!0:y.add(S.route.id))}),y.size===0)return[];let x=qne(n,a,"data");return b&&y.size>0&&x.searchParams.set("_routes",e.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[x.pathname+x.search]},[a,o,r,s,c,e,n,i]),m=E.useMemo(()=>Xne(u,s),[u,s]),g=rre(u);return E.createElement(E.Fragment,null,f.map(y=>E.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),m.map(y=>E.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),g.map(({key:y,link:b})=>E.createElement("link",{key:y,...b})))}function ire(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var V8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{V8&&(window.__reactRouterVersion="7.7.1")}catch{}function are({basename:n,children:e,window:t}){let r=E.useRef();r.current==null&&(r.current=qte({window:t,v5Compat:!0}));let s=r.current,[i,a]=E.useState({action:s.action,location:s.location}),o=E.useCallback(l=>{E.startTransition(()=>a(l))},[a]);return E.useLayoutEffect(()=>s.listen(o),[s,o]),E.createElement(One,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:s})}var z8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gs=E.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f,...m},g){let{basename:y}=E.useContext(Ya),b=typeof c=="string"&&z8.test(c),x,S=!1;if(typeof c=="string"&&b&&(x=c,V8))try{let M=new URL(window.location.href),D=c.startsWith("//")?new URL(M.protocol+c):new URL(c),U=jl(D.pathname,y);D.origin===M.origin&&U!=null?c=U+D.search+D.hash:S=!0}catch{ba(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=bne(c,{relative:s}),[_,R,I]=tre(r,m),C=ure(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:f});function L(M){e&&e(M),M.defaultPrevented||C(M)}let k=E.createElement("a",{...m,...I,href:x||T,onClick:S||i?e:L,ref:ire(g,R),target:l,"data-discover":!b&&t==="render"?"true":void 0});return _&&!b?E.createElement(E.Fragment,null,k,E.createElement(nre,{page:T})):k});gs.displayName="Link";var ore=E.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:o,children:l,...c},u){let f=Bv(a,{relative:c.relative}),m=Os(),g=E.useContext(HE),{navigator:y,basename:b}=E.useContext(Ya),x=g!=null&&pre(f)&&o===!0,S=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,T=m.pathname,_=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(T=T.toLowerCase(),_=_?_.toLowerCase():null,S=S.toLowerCase()),_&&b&&(_=jl(_,b)||_);const R=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let I=T===S||!s&&T.startsWith(S)&&T.charAt(R)==="/",C=_!=null&&(_===S||!s&&_.startsWith(S)&&_.charAt(S.length)==="/"),L={isActive:I,isPending:C,isTransitioning:x},k=I?e:void 0,M;typeof r=="function"?M=r(L):M=[r,I?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof i=="function"?i(L):i;return E.createElement(gs,{...c,"aria-current":k,className:M,ref:u,style:D,to:a,viewTransition:o},typeof l=="function"?l(L):l)});ore.displayName="NavLink";var lre=E.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:i,method:a=Hb,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...m},g)=>{let y=fre(),b=mre(o,{relative:c}),x=a.toLowerCase()==="get"?"get":"post",S=typeof o=="string"&&z8.test(o),T=_=>{if(l&&l(_),_.defaultPrevented)return;_.preventDefault();let R=_.nativeEvent.submitter,I=R?.getAttribute("formmethod")||a;y(R||_.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:s,state:i,relative:c,preventScrollReset:u,viewTransition:f})};return E.createElement("form",{ref:g,method:x,action:b,onSubmit:r?l:T,...m,"data-discover":!S&&n==="render"?"true":void 0})});lre.displayName="Form";function cre(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function G8(n){let e=E.useContext(rm);return Qn(e,cre(n)),e}function ure(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:i,viewTransition:a}={}){let o=Jn(),l=Os(),c=Bv(n,{relative:i});return E.useCallback(u=>{if(Bne(u,e)){u.preventDefault();let f=t!==void 0?t:Bg(l)===Bg(c);o(n,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:a})}},[l,o,c,t,r,e,n,s,i,a])}function Cd(n){ba(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=E.useRef(FR(n)),t=E.useRef(!1),r=Os(),s=E.useMemo(()=>Hne(r.search,t.current?null:e.current),[r.search]),i=Jn(),a=E.useCallback((o,l)=>{const c=FR(typeof o=="function"?o(new URLSearchParams(s)):o);t.current=!0,i("?"+c,l)},[i,s]);return[s,a]}var dre=0,hre=()=>`__${String(++dre)}__`;function fre(){let{router:n}=G8("useSubmit"),{basename:e}=E.useContext(Ya),t=Ine();return E.useCallback(async(r,s={})=>{let{action:i,method:a,encType:o,formData:l,body:c}=Gne(r,e);if(s.navigate===!1){let u=s.fetcherKey||hre();await n.fetch(u,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,flushSync:s.flushSync})}else await n.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function mre(n,{relative:e}={}){let{basename:t}=E.useContext(Ya),r=E.useContext(Xa);Qn(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Bv(n||".",{relative:e})},a=Os();if(n==null){i.search=a.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();i.search=u?`?${u}`:""}}return(!n||n===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Nl([t,i.pathname])),Bg(i)}function pre(n,{relative:e}={}){let t=E.useContext(O8);Qn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=G8("useViewTransitionState"),s=Bv(n,{relative:e});if(!t.isTransitioning)return!1;let i=jl(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=jl(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Bx(s.pathname,a)!=null||Bx(s.pathname,i)!=null}var vp={},pF;function gre(){if(pF)return vp;pF=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.parse=a,vp.serialize=c;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function a(m,g){const y=new i,b=m.length;if(b<2)return y;const x=g?.decode||u;let S=0;do{const T=m.indexOf("=",S);if(T===-1)break;const _=m.indexOf(";",S),R=_===-1?b:_;if(T>R){S=m.lastIndexOf(";",T-1)+1;continue}const I=o(m,S,T),C=l(m,T,I),L=m.slice(I,C);if(y[L]===void 0){let k=o(m,T+1,R),M=l(m,R,k);const D=x(m.slice(k,M));y[L]=D}S=R+1}while(S<b);return y}function o(m,g,y){do{const b=m.charCodeAt(g);if(b!==32&&b!==9)return g}while(++g<y);return y}function l(m,g,y){for(;g>y;){const b=m.charCodeAt(--g);if(b!==32&&b!==9)return g+1}return y}function c(m,g,y){const b=y?.encode||encodeURIComponent;if(!n.test(m))throw new TypeError(`argument name is invalid: ${m}`);const x=b(g);if(!e.test(x))throw new TypeError(`argument val is invalid: ${g}`);let S=m+"="+x;if(!y)return S;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);S+="; Max-Age="+y.maxAge}if(y.domain){if(!t.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);S+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);S+="; Path="+y.path}if(y.expires){if(!f(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);S+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(S+="; HttpOnly"),y.secure&&(S+="; Secure"),y.partitioned&&(S+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return S}function u(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function f(m){return s.call(m)==="[object Date]"}return vp}var gF=gre(),Hs=w8();const q8=Rd(Hs);var Hv=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},md=typeof window>"u"||"Deno"in globalThis;function ai(){}function vre(n,e){return typeof n=="function"?n(e):n}function UR(n){return typeof n=="number"&&n>=0&&n!==1/0}function W8(n,e){return Math.max(n+(e||0)-Date.now(),0)}function Gc(n,e){return typeof n=="function"?n(e):n}function ia(n,e){return typeof n=="function"?n(e):n}function vF(n,e){const{type:t="all",exact:r,fetchStatus:s,predicate:i,queryKey:a,stale:o}=n;if(a){if(r){if(e.queryHash!==AL(a,e.options))return!1}else if(!Vg(e.queryKey,a))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||s&&s!==e.state.fetchStatus||i&&!i(e))}function yF(n,e){const{exact:t,status:r,predicate:s,mutationKey:i}=n;if(i){if(!e.options.mutationKey)return!1;if(t){if(Hg(e.options.mutationKey)!==Hg(i))return!1}else if(!Vg(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function AL(n,e){return(e?.queryKeyHashFn||Hg)(n)}function Hg(n){return JSON.stringify(n,(e,t)=>BR(t)?Object.keys(t).sort().reduce((r,s)=>(r[s]=t[s],r),{}):t)}function Vg(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>Vg(n[t],e[t])):!1}function K8(n,e){if(n===e)return n;const t=bF(n)&&bF(e);if(t||BR(n)&&BR(e)){const r=t?n:Object.keys(n),s=r.length,i=t?e:Object.keys(e),a=i.length,o=t?[]:{},l=new Set(r);let c=0;for(let u=0;u<a;u++){const f=t?u:i[u];(!t&&l.has(f)||t)&&n[f]===void 0&&e[f]===void 0?(o[f]=void 0,c++):(o[f]=K8(n[f],e[f]),o[f]===n[f]&&n[f]!==void 0&&c++)}return s===a&&c===s?n:o}return e}function $R(n,e){if(!e||Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}function bF(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function BR(n){if(!xF(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!xF(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function xF(n){return Object.prototype.toString.call(n)==="[object Object]"}function yre(n){return new Promise(e=>{setTimeout(e,n)})}function HR(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?K8(n,e):e}function bre(n,e,t=0){const r=[...n,e];return t&&r.length>t?r.slice(1):r}function xre(n,e,t=0){const r=[e,...n];return t&&r.length>t?r.slice(0,-1):r}var RL=Symbol();function Y8(n,e){return!n.queryFn&&e?.initialPromise?()=>e.initialPromise:!n.queryFn||n.queryFn===RL?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function wre(n,e){return typeof n=="function"?n(...e):!!n}var Ere=class extends Hv{#e;#t;#n;constructor(){super(),this.#n=n=>{if(!md&&window.addEventListener){const e=()=>n();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(n){this.#e!==n&&(this.#e=n,this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(e=>{e(n)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},CL=new Ere,Sre=class extends Hv{#e=!0;#t;#n;constructor(){super(),this.#n=n=>{if(!md&&window.addEventListener){const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(this.setOnline.bind(this))}setOnline(n){this.#e!==n&&(this.#e=n,this.listeners.forEach(t=>{t(n)}))}isOnline(){return this.#e}},Hx=new Sre;function VR(){let n,e;const t=new Promise((s,i)=>{n=s,e=i});t.status="pending",t.catch(()=>{});function r(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{r({status:"fulfilled",value:s}),n(s)},t.reject=s=>{r({status:"rejected",reason:s}),e(s)},t}function Tre(n){return Math.min(1e3*2**n,3e4)}function X8(n){return(n??"online")==="online"?Hx.isOnline():!0}var Q8=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function T1(n){return n instanceof Q8}function Z8(n){let e=!1,t=0,r=!1,s;const i=VR(),a=b=>{r||(m(new Q8(b)),n.abort?.())},o=()=>{e=!0},l=()=>{e=!1},c=()=>CL.isFocused()&&(n.networkMode==="always"||Hx.isOnline())&&n.canRun(),u=()=>X8(n.networkMode)&&n.canRun(),f=b=>{r||(r=!0,n.onSuccess?.(b),s?.(),i.resolve(b))},m=b=>{r||(r=!0,n.onError?.(b),s?.(),i.reject(b))},g=()=>new Promise(b=>{s=x=>{(r||c())&&b(x)},n.onPause?.()}).then(()=>{s=void 0,r||n.onContinue?.()}),y=()=>{if(r)return;let b;const x=t===0?n.initialPromise:void 0;try{b=x??n.fn()}catch(S){b=Promise.reject(S)}Promise.resolve(b).then(f).catch(S=>{if(r)return;const T=n.retry??(md?0:3),_=n.retryDelay??Tre,R=typeof _=="function"?_(t,S):_,I=T===!0||typeof T=="number"&&t<T||typeof T=="function"&&T(t,S);if(e||!I){m(S);return}t++,n.onFail?.(t,S),yre(R).then(()=>c()?void 0:g()).then(()=>{e?m(S):y()})})};return{promise:i,cancel:a,continue:()=>(s?.(),i),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?y():g().then(y),i)}}var _re=n=>setTimeout(n,0);function Are(){let n=[],e=0,t=o=>{o()},r=o=>{o()},s=_re;const i=o=>{e?n.push(o):s(()=>{t(o)})},a=()=>{const o=n;n=[],o.length&&s(()=>{r(()=>{o.forEach(l=>{t(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{i(()=>{o(...l)})},schedule:i,setNotifyFunction:o=>{t=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{s=o}}}var ps=Are(),J8=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),UR(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(md?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},Rre=class extends J8{#e;#t;#n;#r;#s;#o;#i;constructor(n){super(),this.#i=!1,this.#o=n.defaultOptions,this.setOptions(n.options),this.observers=[],this.#r=n.client,this.#n=this.#r.getQueryCache(),this.queryKey=n.queryKey,this.queryHash=n.queryHash,this.#e=Cre(this.options),this.state=n.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(n){this.options={...this.#o,...n},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(n,e){const t=HR(this.state.data,n,this.options);return this.#a({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(n,e){this.#a({type:"setState",state:n,setStateOptions:e})}cancel(n){const e=this.#s?.promise;return this.#s?.cancel(n),e?e.then(ai).catch(ai):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(n=>ia(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===RL||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>Gc(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!W8(this.state.dataUpdatedAt,n)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(e=>e!==n),this.observers.length||(this.#s&&(this.#i?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}fetch(n,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(n&&this.setOptions(n),!this.options.queryFn){const l=this.observers.find(c=>c.options.queryFn);l&&this.setOptions(l.options)}const t=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#i=!0,t.signal)})},s=()=>{const l=Y8(this.options,e),u=(()=>{const f={client:this.#r,queryKey:this.queryKey,meta:this.meta};return r(f),f})();return this.#i=!1,this.options.persister?this.options.persister(l,u,this):l(u)},a=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:s};return r(l),l})();this.options.behavior?.onFetch(a,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==a.fetchOptions?.meta)&&this.#a({type:"fetch",meta:a.fetchOptions?.meta});const o=l=>{T1(l)&&l.silent||this.#a({type:"error",error:l}),T1(l)||(this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this)),this.scheduleGc()};return this.#s=Z8({initialPromise:e?.initialPromise,fn:a.fetchFn,abort:t.abort.bind(t),onSuccess:l=>{if(l===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(l)}catch(c){o(c);return}this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),this.scheduleGc()},onError:o,onFail:(l,c)=>{this.#a({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}),this.#s.start()}#a(n){const e=t=>{switch(n.type){case"failed":return{...t,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...eH(t.data,this.options),fetchMeta:n.meta??null};case"success":return this.#t=void 0,{...t,data:n.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=n.error;return T1(r)&&r.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...t,error:r,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...n.state}}};this.state=e(this.state),ps.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:n})})}};function eH(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:X8(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function Cre(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,r=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var kre=class extends Hv{constructor(n={}){super(),this.config=n,this.#e=new Map}#e;build(n,e,t){const r=e.queryKey,s=e.queryHash??AL(r,e);let i=this.get(s);return i||(i=new Rre({client:n,queryKey:r,queryHash:s,options:n.defaultQueryOptions(e),state:t,defaultOptions:n.getQueryDefaults(r)}),this.add(i)),i}add(n){this.#e.has(n.queryHash)||(this.#e.set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const e=this.#e.get(n.queryHash);e&&(n.destroy(),e===n&&this.#e.delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){ps.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return this.#e.get(n)}getAll(){return[...this.#e.values()]}find(n){const e={exact:!0,...n};return this.getAll().find(t=>vF(e,t))}findAll(n={}){const e=this.getAll();return Object.keys(n).length>0?e.filter(t=>vF(n,t)):e}notify(n){ps.batch(()=>{this.listeners.forEach(e=>{e(n)})})}onFocus(){ps.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){ps.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},Ire=class extends J8{#e;#t;#n;constructor(n){super(),this.mutationId=n.mutationId,this.#t=n.mutationCache,this.#e=[],this.state=n.state||Lre(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){this.#e.includes(n)||(this.#e.push(n),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){this.#e=this.#e.filter(e=>e!==n),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(n){const e=()=>{this.#r({type:"continue"})};this.#n=Z8({fn:()=>this.options.mutationFn?this.options.mutationFn(n):Promise.reject(new Error("No mutationFn found")),onFail:(s,i)=>{this.#r({type:"failed",failureCount:s,error:i})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const t=this.state.status==="pending",r=!this.#n.canStart();try{if(t)e();else{this.#r({type:"pending",variables:n,isPaused:r}),await this.#t.config.onMutate?.(n,this);const i=await this.options.onMutate?.(n);i!==this.state.context&&this.#r({type:"pending",context:i,variables:n,isPaused:r})}const s=await this.#n.start();return await this.#t.config.onSuccess?.(s,n,this.state.context,this),await this.options.onSuccess?.(s,n,this.state.context),await this.#t.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,n,this.state.context),this.#r({type:"success",data:s}),s}catch(s){try{throw await this.#t.config.onError?.(s,n,this.state.context,this),await this.options.onError?.(s,n,this.state.context),await this.#t.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,s,n,this.state.context),s}finally{this.#r({type:"error",error:s})}}finally{this.#t.runNext(this)}}#r(n){const e=t=>{switch(n.type){case"failed":return{...t,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...t,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:n.error,failureCount:t.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=e(this.state),ps.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(n)}),this.#t.notify({mutation:this,type:"updated",action:n})})}};function Lre(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Dre=class extends Hv{constructor(n={}){super(),this.config=n,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(n,e,t){const r=new Ire({mutationCache:this,mutationId:++this.#n,options:n.defaultMutationOptions(e),state:t});return this.add(r),r}add(n){this.#e.add(n);const e=Ly(n);if(typeof e=="string"){const t=this.#t.get(e);t?t.push(n):this.#t.set(e,[n])}this.notify({type:"added",mutation:n})}remove(n){if(this.#e.delete(n)){const e=Ly(n);if(typeof e=="string"){const t=this.#t.get(e);if(t)if(t.length>1){const r=t.indexOf(n);r!==-1&&t.splice(r,1)}else t[0]===n&&this.#t.delete(e)}}this.notify({type:"removed",mutation:n})}canRun(n){const e=Ly(n);if(typeof e=="string"){const r=this.#t.get(e)?.find(s=>s.state.status==="pending");return!r||r===n}else return!0}runNext(n){const e=Ly(n);return typeof e=="string"?this.#t.get(e)?.find(r=>r!==n&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){ps.batch(()=>{this.#e.forEach(n=>{this.notify({type:"removed",mutation:n})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(n){const e={exact:!0,...n};return this.getAll().find(t=>yF(e,t))}findAll(n={}){return this.getAll().filter(e=>yF(n,e))}notify(n){ps.batch(()=>{this.listeners.forEach(e=>{e(n)})})}resumePausedMutations(){const n=this.getAll().filter(e=>e.state.isPaused);return ps.batch(()=>Promise.all(n.map(e=>e.continue().catch(ai))))}};function Ly(n){return n.options.scope?.id}function wF(n){return{onFetch:(e,t)=>{const r=e.options,s=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let u=!1;const f=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(e.signal.aborted?u=!0:e.signal.addEventListener("abort",()=>{u=!0}),e.signal)})},m=Y8(e.options,e.fetchOptions),g=async(y,b,x)=>{if(u)return Promise.reject();if(b==null&&y.pages.length)return Promise.resolve(y);const T=(()=>{const C={client:e.client,queryKey:e.queryKey,pageParam:b,direction:x?"backward":"forward",meta:e.options.meta};return f(C),C})(),_=await m(T),{maxPages:R}=e.options,I=x?xre:bre;return{pages:I(y.pages,_,R),pageParams:I(y.pageParams,b,R)}};if(s&&i.length){const y=s==="backward",b=y?Pre:EF,x={pages:i,pageParams:a},S=b(r,x);o=await g(x,S,y)}else{const y=n??i.length;do{const b=l===0?a[0]??r.initialPageParam:EF(r,o);if(l>0&&b==null)break;o=await g(o,b),l++}while(l<y)}return o};e.options.persister?e.fetchFn=()=>e.options.persister?.(c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=c}}}function EF(n,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?n.getNextPageParam(e[r],e,t[r],t):void 0}function Pre(n,{pages:e,pageParams:t}){return e.length>0?n.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var Mre=class{#e;#t;#n;#r;#s;#o;#i;#a;constructor(n={}){this.#e=n.queryCache||new kre,this.#t=n.mutationCache||new Dre,this.#n=n.defaultOptions||{},this.#r=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#i=CL.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=Hx.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#i?.(),this.#i=void 0,this.#a?.(),this.#a=void 0)}isFetching(n){return this.#e.findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return this.#t.findAll({...n,status:"pending"}).length}getQueryData(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=this.#e.build(this,e),r=t.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(Gc(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(n){return this.#e.findAll(n).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(n,e,t){const r=this.defaultQueryOptions({queryKey:n}),i=this.#e.get(r.queryHash)?.state.data,a=vre(e,i);if(a!==void 0)return this.#e.build(this,r).setData(a,{...t,manual:!0})}setQueriesData(n,e,t){return ps.batch(()=>this.#e.findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state}removeQueries(n){const e=this.#e;ps.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=this.#e;return ps.batch(()=>(t.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},r=ps.batch(()=>this.#e.findAll(n).map(s=>s.cancel(t)));return Promise.all(r).then(ai).catch(ai)}invalidateQueries(n,e={}){return ps.batch(()=>(this.#e.findAll(n).forEach(t=>{t.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},r=ps.batch(()=>this.#e.findAll(n).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,t);return t.throwOnError||(i=i.catch(ai)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(ai)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(Gc(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(ai).catch(ai)}fetchInfiniteQuery(n){return n.behavior=wF(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(ai).catch(ai)}ensureInfiniteQueryData(n){return n.behavior=wF(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Hx.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(n){this.#n=n}setQueryDefaults(n,e){this.#r.set(Hg(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...this.#r.values()],t={};return e.forEach(r=>{Vg(n,r.queryKey)&&Object.assign(t,r.defaultOptions)}),t}setMutationDefaults(n,e){this.#s.set(Hg(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...this.#s.values()],t={};return e.forEach(r=>{Vg(n,r.mutationKey)&&Object.assign(t,r.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...this.#n.queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=AL(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===RL&&(e.enabled=!1),e}defaultMutationOptions(n){return n?._defaulted?n:{...this.#n.mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Ore=class extends Hv{constructor(n,e){super(),this.options=e,this.#e=n,this.#a=null,this.#i=VR(),this.options.experimental_prefetchInRender||this.#i.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#r=void 0;#s;#o;#i;#a;#h;#l;#u;#c;#f;#d;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),SF(this.#t,this.options)?this.#m():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return zR(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return zR(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#w(),this.#t.removeObserver(this)}setOptions(n){const e=this.options,t=this.#t;if(this.options=this.#e.defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ia(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!$R(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&TF(this.#t,t,this.options,e)&&this.#m(),this.updateResult(),r&&(this.#t!==t||ia(this.options.enabled,this.#t)!==ia(e.enabled,this.#t)||Gc(this.options.staleTime,this.#t)!==Gc(e.staleTime,this.#t))&&this.#g();const s=this.#v();r&&(this.#t!==t||ia(this.options.enabled,this.#t)!==ia(e.enabled,this.#t)||s!==this.#d)&&this.#y(s)}getOptimisticResult(n){const e=this.#e.getQueryCache().build(this.#e,n),t=this.createResult(e,n);return jre(this,t)&&(this.#r=t,this.#o=this.options,this.#s=this.#t.state),t}getCurrentResult(){return this.#r}trackResult(n,e){return new Proxy(n,{get:(t,r)=>(this.trackProp(r),e?.(r),Reflect.get(t,r))})}trackProp(n){this.#p.add(n)}getCurrentQuery(){return this.#t}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const e=this.#e.defaultQueryOptions(n),t=this.#e.getQueryCache().build(this.#e,e);return t.fetch().then(()=>this.createResult(t,e))}fetch(n){return this.#m({...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#m(n){this.#E();let e=this.#t.fetch(this.options,n);return n?.throwOnError||(e=e.catch(ai)),e}#g(){this.#x();const n=Gc(this.options.staleTime,this.#t);if(md||this.#r.isStale||!UR(n))return;const t=W8(this.#r.dataUpdatedAt,n)+1;this.#c=setTimeout(()=>{this.#r.isStale||this.updateResult()},t)}#v(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(n){this.#w(),this.#d=n,!(md||ia(this.options.enabled,this.#t)===!1||!UR(this.#d)||this.#d===0)&&(this.#f=setInterval(()=>{(this.options.refetchIntervalInBackground||CL.isFocused())&&this.#m()},this.#d))}#b(){this.#g(),this.#y(this.#v())}#x(){this.#c&&(clearTimeout(this.#c),this.#c=void 0)}#w(){this.#f&&(clearInterval(this.#f),this.#f=void 0)}createResult(n,e){const t=this.#t,r=this.options,s=this.#r,i=this.#s,a=this.#o,l=n!==t?n.state:this.#n,{state:c}=n;let u={...c},f=!1,m;if(e._optimisticResults){const k=this.hasListeners(),M=!k&&SF(n,e),D=k&&TF(n,t,e,r);(M||D)&&(u={...u,...eH(c.data,n.options)}),e._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:b}=u;m=u.data;let x=!1;if(e.placeholderData!==void 0&&m===void 0&&b==="pending"){let k;s?.isPlaceholderData&&e.placeholderData===a?.placeholderData?(k=s.data,x=!0):k=typeof e.placeholderData=="function"?e.placeholderData(this.#u?.state.data,this.#u):e.placeholderData,k!==void 0&&(b="success",m=HR(s?.data,k,e),f=!0)}if(e.select&&m!==void 0&&!x)if(s&&m===i?.data&&e.select===this.#h)m=this.#l;else try{this.#h=e.select,m=e.select(m),m=HR(s?.data,m,e),this.#l=m,this.#a=null}catch(k){this.#a=k}this.#a&&(g=this.#a,m=this.#l,y=Date.now(),b="error");const S=u.fetchStatus==="fetching",T=b==="pending",_=b==="error",R=T&&S,I=m!==void 0,L={status:b,fetchStatus:u.fetchStatus,isPending:T,isSuccess:b==="success",isError:_,isInitialLoading:R,isLoading:R,data:m,dataUpdatedAt:u.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>l.dataUpdateCount||u.errorUpdateCount>l.errorUpdateCount,isFetching:S,isRefetching:S&&!T,isLoadingError:_&&!I,isPaused:u.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&I,isStale:kL(n,e),refetch:this.refetch,promise:this.#i,isEnabled:ia(e.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const k=U=>{L.status==="error"?U.reject(L.error):L.data!==void 0&&U.resolve(L.data)},M=()=>{const U=this.#i=L.promise=VR();k(U)},D=this.#i;switch(D.status){case"pending":n.queryHash===t.queryHash&&k(D);break;case"fulfilled":(L.status==="error"||L.data!==D.value)&&M();break;case"rejected":(L.status!=="error"||L.error!==D.reason)&&M();break}}return L}updateResult(){const n=this.#r,e=this.createResult(this.#t,this.options);if(this.#s=this.#t.state,this.#o=this.options,this.#s.data!==void 0&&(this.#u=this.#t),$R(e,n))return;this.#r=e;const t=()=>{if(!n)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!this.#p.size)return!0;const i=new Set(s??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#r).some(a=>{const o=a;return this.#r[o]!==n[o]&&i.has(o)})};this.#S({listeners:t()})}#E(){const n=this.#e.getQueryCache().build(this.#e,this.options);if(n===this.#t)return;const e=this.#t;this.#t=n,this.#n=n.state,this.hasListeners()&&(e?.removeObserver(this),n.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#S(n){ps.batch(()=>{n.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Nre(n,e){return ia(e.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&e.retryOnMount===!1)}function SF(n,e){return Nre(n,e)||n.state.data!==void 0&&zR(n,e,e.refetchOnMount)}function zR(n,e,t){if(ia(e.enabled,n)!==!1&&Gc(e.staleTime,n)!=="static"){const r=typeof t=="function"?t(n):t;return r==="always"||r!==!1&&kL(n,e)}return!1}function TF(n,e,t,r){return(n!==e||ia(r.enabled,n)===!1)&&(!t.suspense||n.state.status!=="error")&&kL(n,t)}function kL(n,e){return ia(e.enabled,n)!==!1&&n.isStaleByTime(Gc(e.staleTime,n))}function jre(n,e){return!$R(n.getCurrentResult(),e)}var tH=E.createContext(void 0),nH=n=>{const e=E.useContext(tH);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Fre=({client:n,children:e})=>(E.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),d.jsx(tH.Provider,{value:n,children:e})),rH=E.createContext(!1),Ure=()=>E.useContext(rH);rH.Provider;function $re(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var Bre=E.createContext($re()),Hre=()=>E.useContext(Bre),Vre=(n,e)=>{(n.suspense||n.throwOnError||n.experimental_prefetchInRender)&&(e.isReset()||(n.retryOnMount=!1))},zre=n=>{E.useEffect(()=>{n.clearReset()},[n])},Gre=({result:n,errorResetBoundary:e,throwOnError:t,query:r,suspense:s})=>n.isError&&!e.isReset()&&!n.isFetching&&r&&(s&&n.data===void 0||wre(t,[n.error,r])),qre=n=>{if(n.suspense){const e=r=>r==="static"?r:Math.max(r??1e3,1e3),t=n.staleTime;n.staleTime=typeof t=="function"?(...r)=>e(t(...r)):e(t),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},Wre=(n,e)=>n.isLoading&&n.isFetching&&!e,Kre=(n,e)=>n?.suspense&&e.isPending,_F=(n,e,t)=>e.fetchOptimistic(n).catch(()=>{t.clearReset()});function Yre(n,e,t){const r=Ure(),s=Hre(),i=nH(),a=i.defaultQueryOptions(n);i.getDefaultOptions().queries?._experimental_beforeQuery?.(a),a._optimisticResults=r?"isRestoring":"optimistic",qre(a),Vre(a,s),zre(s);const o=!i.getQueryCache().get(a.queryHash),[l]=E.useState(()=>new e(i,a)),c=l.getOptimisticResult(a),u=!r&&n.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(f=>{const m=u?l.subscribe(ps.batchCalls(f)):ai;return l.updateResult(),m},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),E.useEffect(()=>{l.setOptions(a)},[a,l]),Kre(a,c))throw _F(a,l,s);if(Gre({result:c,errorResetBoundary:s,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw c.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(a,c),a.experimental_prefetchInRender&&!md&&Wre(c,r)&&(o?_F(a,l,s):i.getQueryCache().get(a.queryHash)?.promise)?.catch(ai).finally(()=>{l.updateResult()}),a.notifyOnChangeProps?c:l.trackResult(c)}function Xre(n,e){return Yre(n,Ore)}var Qre=n=>{switch(n){case"success":return ese;case"info":return nse;case"warning":return tse;case"error":return rse;default:return null}},Zre=Array(12).fill(0),Jre=({visible:n,className:e})=>ve.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":n},ve.createElement("div",{className:"sonner-spinner"},Zre.map((t,r)=>ve.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),ese=ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),tse=ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ve.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),nse=ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),rse=ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),sse=ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ve.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ve.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ise=()=>{let[n,e]=ve.useState(document.hidden);return ve.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n},GR=1,ase=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,i=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:GR++,a=this.toasts.find(l=>l.id===i),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0,a,o=s.then(async c=>{if(a=["resolve",c],ve.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(lse(c)&&!c.ok){i=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:u,description:f})}else if(t.success!==void 0){i=!1;let u=typeof t.success=="function"?await t.success(c):t.success,f=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"success",message:u,description:f})}}).catch(async c=>{if(a=["reject",c],t.error!==void 0){i=!1;let u=typeof t.error=="function"?await t.error(c):t.error,f=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"error",message:u,description:f})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=t?.id||GR++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ri=new ase,ose=(n,e)=>{let t=e?.id||GR++;return ri.addToast({title:n,...e,id:t}),t},lse=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",cse=ose,use=()=>ri.toasts,dse=()=>ri.getActiveToasts(),et=Object.assign(cse,{success:ri.success,info:ri.info,warning:ri.warning,error:ri.error,custom:ri.custom,message:ri.message,promise:ri.promise,dismiss:ri.dismiss,loading:ri.loading},{getHistory:use,getToasts:dse});function hse(n,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}hse(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Dy(n){return n.label!==void 0}var fse=3,mse="32px",pse="16px",AF=4e3,gse=356,vse=14,yse=20,bse=200;function Ca(...n){return n.filter(Boolean).join(" ")}function xse(n){let[e,t]=n.split("-"),r=[];return e&&r.push(e),t&&r.push(t),r}var wse=n=>{var e,t,r,s,i,a,o,l,c,u,f;let{invert:m,toast:g,unstyled:y,interacting:b,setHeights:x,visibleToasts:S,heights:T,index:_,toasts:R,expanded:I,removeToast:C,defaultRichColors:L,closeButton:k,style:M,cancelButtonStyle:D,actionButtonStyle:U,className:$="",descriptionClassName:V="",duration:B,position:W,gap:F,loadingIcon:j,expandByDefault:q,classNames:H,icons:N,closeButtonAriaLabel:O="Close toast",pauseWhenPageIsHidden:z}=n,[G,Y]=ve.useState(null),[Q,J]=ve.useState(null),[ee,oe]=ve.useState(!1),[te,se]=ve.useState(!1),[he,Z]=ve.useState(!1),[pe,ye]=ve.useState(!1),[ae,le]=ve.useState(!1),[ie,fe]=ve.useState(0),[Ie,ne]=ve.useState(0),ce=ve.useRef(g.duration||B||AF),Ce=ve.useRef(null),Oe=ve.useRef(null),ze=_===0,We=_+1<=S,tt=g.type,lt=g.dismissible!==!1,Ee=g.className||"",be=g.descriptionClassName||"",Ae=ve.useMemo(()=>T.findIndex(nt=>nt.toastId===g.id)||0,[T,g.id]),Me=ve.useMemo(()=>{var nt;return(nt=g.closeButton)!=null?nt:k},[g.closeButton,k]),Ue=ve.useMemo(()=>g.duration||B||AF,[g.duration,B]),Ge=ve.useRef(0),Ke=ve.useRef(0),Qe=ve.useRef(0),ht=ve.useRef(null),[Vt,mn]=W.split("-"),xn=ve.useMemo(()=>T.reduce((nt,Je,ot)=>ot>=Ae?nt:nt+Je.height,0),[T,Ae]),Bn=ise(),An=g.invert||m,Lt=tt==="loading";Ke.current=ve.useMemo(()=>Ae*F+xn,[Ae,xn]),ve.useEffect(()=>{ce.current=Ue},[Ue]),ve.useEffect(()=>{oe(!0)},[]),ve.useEffect(()=>{let nt=Oe.current;if(nt){let Je=nt.getBoundingClientRect().height;return ne(Je),x(ot=>[{toastId:g.id,height:Je,position:g.position},...ot]),()=>x(ot=>ot.filter(Dt=>Dt.toastId!==g.id))}},[x,g.id]),ve.useLayoutEffect(()=>{if(!ee)return;let nt=Oe.current,Je=nt.style.height;nt.style.height="auto";let ot=nt.getBoundingClientRect().height;nt.style.height=Je,ne(ot),x(Dt=>Dt.find(me=>me.toastId===g.id)?Dt.map(me=>me.toastId===g.id?{...me,height:ot}:me):[{toastId:g.id,height:ot,position:g.position},...Dt])},[ee,g.title,g.description,x,g.id]);let jt=ve.useCallback(()=>{se(!0),fe(Ke.current),x(nt=>nt.filter(Je=>Je.toastId!==g.id)),setTimeout(()=>{C(g)},bse)},[g,C,x,Ke]);ve.useEffect(()=>{if(g.promise&&tt==="loading"||g.duration===1/0||g.type==="loading")return;let nt;return I||b||z&&Bn?(()=>{if(Qe.current<Ge.current){let Je=new Date().getTime()-Ge.current;ce.current=ce.current-Je}Qe.current=new Date().getTime()})():ce.current!==1/0&&(Ge.current=new Date().getTime(),nt=setTimeout(()=>{var Je;(Je=g.onAutoClose)==null||Je.call(g,g),jt()},ce.current)),()=>clearTimeout(nt)},[I,b,g,tt,z,Bn,jt]),ve.useEffect(()=>{g.delete&&jt()},[jt,g.delete]);function Xt(){var nt,Je,ot;return N!=null&&N.loading?ve.createElement("div",{className:Ca(H?.loader,(nt=g?.classNames)==null?void 0:nt.loader,"sonner-loader"),"data-visible":tt==="loading"},N.loading):j?ve.createElement("div",{className:Ca(H?.loader,(Je=g?.classNames)==null?void 0:Je.loader,"sonner-loader"),"data-visible":tt==="loading"},j):ve.createElement(Jre,{className:Ca(H?.loader,(ot=g?.classNames)==null?void 0:ot.loader),visible:tt==="loading"})}return ve.createElement("li",{tabIndex:0,ref:Oe,className:Ca($,Ee,H?.toast,(e=g?.classNames)==null?void 0:e.toast,H?.default,H?.[tt],(t=g?.classNames)==null?void 0:t[tt]),"data-sonner-toast":"","data-rich-colors":(r=g.richColors)!=null?r:L,"data-styled":!(g.jsx||g.unstyled||y),"data-mounted":ee,"data-promise":!!g.promise,"data-swiped":ae,"data-removed":te,"data-visible":We,"data-y-position":Vt,"data-x-position":mn,"data-index":_,"data-front":ze,"data-swiping":he,"data-dismissible":lt,"data-type":tt,"data-invert":An,"data-swipe-out":pe,"data-swipe-direction":Q,"data-expanded":!!(I||q&&ee),style:{"--index":_,"--toasts-before":_,"--z-index":R.length-_,"--offset":`${te?ie:Ke.current}px`,"--initial-height":q?"auto":`${Ie}px`,...M,...g.style},onDragEnd:()=>{Z(!1),Y(null),ht.current=null},onPointerDown:nt=>{Lt||!lt||(Ce.current=new Date,fe(Ke.current),nt.target.setPointerCapture(nt.pointerId),nt.target.tagName!=="BUTTON"&&(Z(!0),ht.current={x:nt.clientX,y:nt.clientY}))},onPointerUp:()=>{var nt,Je,ot,Dt;if(pe||!lt)return;ht.current=null;let me=Number(((nt=Oe.current)==null?void 0:nt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ye=Number(((Je=Oe.current)==null?void 0:Je.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Xe=new Date().getTime()-((ot=Ce.current)==null?void 0:ot.getTime()),st=G==="x"?me:Ye,wt=Math.abs(st)/Xe;if(Math.abs(st)>=yse||wt>.11){fe(Ke.current),(Dt=g.onDismiss)==null||Dt.call(g,g),J(G==="x"?me>0?"right":"left":Ye>0?"down":"up"),jt(),ye(!0),le(!1);return}Z(!1),Y(null)},onPointerMove:nt=>{var Je,ot,Dt,me;if(!ht.current||!lt||((Je=window.getSelection())==null?void 0:Je.toString().length)>0)return;let Ye=nt.clientY-ht.current.y,Xe=nt.clientX-ht.current.x,st=(ot=n.swipeDirections)!=null?ot:xse(W);!G&&(Math.abs(Xe)>1||Math.abs(Ye)>1)&&Y(Math.abs(Xe)>Math.abs(Ye)?"x":"y");let wt={x:0,y:0};G==="y"?(st.includes("top")||st.includes("bottom"))&&(st.includes("top")&&Ye<0||st.includes("bottom")&&Ye>0)&&(wt.y=Ye):G==="x"&&(st.includes("left")||st.includes("right"))&&(st.includes("left")&&Xe<0||st.includes("right")&&Xe>0)&&(wt.x=Xe),(Math.abs(wt.x)>0||Math.abs(wt.y)>0)&&le(!0),(Dt=Oe.current)==null||Dt.style.setProperty("--swipe-amount-x",`${wt.x}px`),(me=Oe.current)==null||me.style.setProperty("--swipe-amount-y",`${wt.y}px`)}},Me&&!g.jsx?ve.createElement("button",{"aria-label":O,"data-disabled":Lt,"data-close-button":!0,onClick:Lt||!lt?()=>{}:()=>{var nt;jt(),(nt=g.onDismiss)==null||nt.call(g,g)},className:Ca(H?.closeButton,(s=g?.classNames)==null?void 0:s.closeButton)},(i=N?.close)!=null?i:sse):null,g.jsx||E.isValidElement(g.title)?g.jsx?g.jsx:typeof g.title=="function"?g.title():g.title:ve.createElement(ve.Fragment,null,tt||g.icon||g.promise?ve.createElement("div",{"data-icon":"",className:Ca(H?.icon,(a=g?.classNames)==null?void 0:a.icon)},g.promise||g.type==="loading"&&!g.icon?g.icon||Xt():null,g.type!=="loading"?g.icon||N?.[tt]||Qre(tt):null):null,ve.createElement("div",{"data-content":"",className:Ca(H?.content,(o=g?.classNames)==null?void 0:o.content)},ve.createElement("div",{"data-title":"",className:Ca(H?.title,(l=g?.classNames)==null?void 0:l.title)},typeof g.title=="function"?g.title():g.title),g.description?ve.createElement("div",{"data-description":"",className:Ca(V,be,H?.description,(c=g?.classNames)==null?void 0:c.description)},typeof g.description=="function"?g.description():g.description):null),E.isValidElement(g.cancel)?g.cancel:g.cancel&&Dy(g.cancel)?ve.createElement("button",{"data-button":!0,"data-cancel":!0,style:g.cancelButtonStyle||D,onClick:nt=>{var Je,ot;Dy(g.cancel)&&lt&&((ot=(Je=g.cancel).onClick)==null||ot.call(Je,nt),jt())},className:Ca(H?.cancelButton,(u=g?.classNames)==null?void 0:u.cancelButton)},g.cancel.label):null,E.isValidElement(g.action)?g.action:g.action&&Dy(g.action)?ve.createElement("button",{"data-button":!0,"data-action":!0,style:g.actionButtonStyle||U,onClick:nt=>{var Je,ot;Dy(g.action)&&((ot=(Je=g.action).onClick)==null||ot.call(Je,nt),!nt.defaultPrevented&&jt())},className:Ca(H?.actionButton,(f=g?.classNames)==null?void 0:f.actionButton)},g.action.label):null))};function RF(){if(typeof window>"u"||typeof document>"u")return"ltr";let n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function Ese(n,e){let t={};return[n,e].forEach((r,s)=>{let i=s===1,a=i?"--mobile-offset":"--offset",o=i?pse:mse;function l(c){["top","right","bottom","left"].forEach(u=>{t[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?t[`${a}-${c}`]=o:t[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),t}var Sse=E.forwardRef(function(n,e){let{invert:t,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:a,className:o,offset:l,mobileOffset:c,theme:u="light",richColors:f,duration:m,style:g,visibleToasts:y=fse,toastOptions:b,dir:x=RF(),gap:S=vse,loadingIcon:T,icons:_,containerAriaLabel:R="Notifications",pauseWhenPageIsHidden:I}=n,[C,L]=ve.useState([]),k=ve.useMemo(()=>Array.from(new Set([r].concat(C.filter(z=>z.position).map(z=>z.position)))),[C,r]),[M,D]=ve.useState([]),[U,$]=ve.useState(!1),[V,B]=ve.useState(!1),[W,F]=ve.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),j=ve.useRef(null),q=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),H=ve.useRef(null),N=ve.useRef(!1),O=ve.useCallback(z=>{L(G=>{var Y;return(Y=G.find(Q=>Q.id===z.id))!=null&&Y.delete||ri.dismiss(z.id),G.filter(({id:Q})=>Q!==z.id)})},[]);return ve.useEffect(()=>ri.subscribe(z=>{if(z.dismiss){L(G=>G.map(Y=>Y.id===z.id?{...Y,delete:!0}:Y));return}setTimeout(()=>{q8.flushSync(()=>{L(G=>{let Y=G.findIndex(Q=>Q.id===z.id);return Y!==-1?[...G.slice(0,Y),{...G[Y],...z},...G.slice(Y+1)]:[z,...G]})})})}),[]),ve.useEffect(()=>{if(u!=="system"){F(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?F("dark"):F("light")),typeof window>"u")return;let z=window.matchMedia("(prefers-color-scheme: dark)");try{z.addEventListener("change",({matches:G})=>{F(G?"dark":"light")})}catch{z.addListener(({matches:Y})=>{try{F(Y?"dark":"light")}catch(Q){console.error(Q)}})}},[u]),ve.useEffect(()=>{C.length<=1&&$(!1)},[C]),ve.useEffect(()=>{let z=G=>{var Y,Q;s.every(J=>G[J]||G.code===J)&&($(!0),(Y=j.current)==null||Y.focus()),G.code==="Escape"&&(document.activeElement===j.current||(Q=j.current)!=null&&Q.contains(document.activeElement))&&$(!1)};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[s]),ve.useEffect(()=>{if(j.current)return()=>{H.current&&(H.current.focus({preventScroll:!0}),H.current=null,N.current=!1)}},[j.current]),ve.createElement("section",{ref:e,"aria-label":`${R} ${q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},k.map((z,G)=>{var Y;let[Q,J]=z.split("-");return C.length?ve.createElement("ol",{key:z,dir:x==="auto"?RF():x,tabIndex:-1,ref:j,className:o,"data-sonner-toaster":!0,"data-theme":W,"data-y-position":Q,"data-lifted":U&&C.length>1&&!i,"data-x-position":J,style:{"--front-toast-height":`${((Y=M[0])==null?void 0:Y.height)||0}px`,"--width":`${gse}px`,"--gap":`${S}px`,...g,...Ese(l,c)},onBlur:ee=>{N.current&&!ee.currentTarget.contains(ee.relatedTarget)&&(N.current=!1,H.current&&(H.current.focus({preventScroll:!0}),H.current=null))},onFocus:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||N.current||(N.current=!0,H.current=ee.relatedTarget)},onMouseEnter:()=>$(!0),onMouseMove:()=>$(!0),onMouseLeave:()=>{V||$(!1)},onDragEnd:()=>$(!1),onPointerDown:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},C.filter(ee=>!ee.position&&G===0||ee.position===z).map((ee,oe)=>{var te,se;return ve.createElement(wse,{key:ee.id,icons:_,index:oe,toast:ee,defaultRichColors:f,duration:(te=b?.duration)!=null?te:m,className:b?.className,descriptionClassName:b?.descriptionClassName,invert:t,visibleToasts:y,closeButton:(se=b?.closeButton)!=null?se:a,interacting:V,position:z,style:b?.style,unstyled:b?.unstyled,classNames:b?.classNames,cancelButtonStyle:b?.cancelButtonStyle,actionButtonStyle:b?.actionButtonStyle,removeToast:O,toasts:C.filter(he=>he.position==ee.position),heights:M.filter(he=>he.position==ee.position),setHeights:D,expandByDefault:i,gap:S,loadingIcon:T,expanded:U,pauseWhenPageIsHidden:I,swipeDirections:n.swipeDirections})})):null}))});const sH=ve.createContext({}),iH=!0;function Tse({baseColor:n,highlightColor:e,width:t,height:r,borderRadius:s,circle:i,direction:a,duration:o,enableAnimation:l=iH,customHighlightBackground:c}){const u={};return a==="rtl"&&(u["--animation-direction"]="reverse"),typeof o=="number"&&(u["--animation-duration"]=`${o}s`),l||(u["--pseudo-element-display"]="none"),(typeof t=="string"||typeof t=="number")&&(u.width=t),(typeof r=="string"||typeof r=="number")&&(u.height=r),(typeof s=="string"||typeof s=="number")&&(u.borderRadius=s),i&&(u.borderRadius="50%"),typeof n<"u"&&(u["--base-color"]=n),typeof e<"u"&&(u["--highlight-color"]=e),typeof c=="string"&&(u["--custom-highlight-background"]=c),u}function Lo({count:n=1,wrapper:e,className:t,containerClassName:r,containerTestId:s,circle:i=!1,style:a,...o}){var l,c,u;const f=ve.useContext(sH),m={...o};for(const[_,R]of Object.entries(o))typeof R>"u"&&delete m[_];const g={...f,...m,circle:i},y={...a,...Tse(g)};let b="react-loading-skeleton";t&&(b+=` ${t}`);const x=(l=g.inline)!==null&&l!==void 0?l:!1,S=[],T=Math.ceil(n);for(let _=0;_<T;_++){let R=y;if(T>n&&_===T-1){const C=(c=R.width)!==null&&c!==void 0?c:"100%",L=n%1,k=typeof C=="number"?C*L:`calc(${C} * ${L})`;R={...R,width:k}}const I=ve.createElement("span",{className:b,style:R,key:_},"");x?S.push(I):S.push(ve.createElement(ve.Fragment,{key:_},I,ve.createElement("br",null)))}return ve.createElement("span",{className:r,"data-testid":s,"aria-live":"polite","aria-busy":(u=g.enableAnimation)!==null&&u!==void 0?u:iH},e?S.map((_,R)=>ve.createElement(e,{key:R},_)):S)}function _se({children:n,...e}){return ve.createElement(sH.Provider,{value:e},n)}const Ase="modulepreload",Rse=function(n){return"/"+n},CF={},Ze=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");s=l(t.map(c=>{if(c=Rse(c),c in CF)return;CF[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Ase,u||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),u)return new Promise((g,y)=>{m.addEventListener("load",g),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},kF=n=>{let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const m=e;e=u??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(g=>g(e,m))}},s=()=>e,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(r,s,o);return o},Cse=n=>n?kF(n):kF,kse=n=>n;function Ise(n,e=kse){const t=ve.useSyncExternalStore(n.subscribe,()=>e(n.getState()),()=>e(n.getInitialState()));return ve.useDebugValue(t),t}const Lse=n=>{const e=Cse(n),t=r=>Ise(e,r);return Object.assign(t,e),t},Ws=n=>Lse,Dse=n=>(e,t,r)=>{const s=r.subscribe;return r.subscribe=(a,o,l)=>{let c=a;if(o){const u=l?.equalityFn||Object.is;let f=a(r.getState());c=m=>{const g=a(m);if(!u(f,g)){const y=f;o(f=g,y)}},l?.fireImmediately&&o(f,f)}return s(c)},n(e,t,r)},Ui=Dse;var aH=Symbol.for("immer-nothing"),IF=Symbol.for("immer-draftable"),wn=Symbol.for("immer-state");function ca(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Of=Object.getPrototypeOf;function Nf(n){return!!n&&!!n[wn]}function Fl(n){return n?oH(n)||Array.isArray(n)||!!n[IF]||!!n.constructor?.[IF]||GE(n)||qE(n):!1}var Pse=Object.prototype.constructor.toString();function oH(n){if(!n||typeof n!="object")return!1;const e=Of(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Pse}function zg(n,e){zE(n)===0?Reflect.ownKeys(n).forEach(t=>{e(t,n[t],n)}):n.forEach((t,r)=>e(r,t,n))}function zE(n){const e=n[wn];return e?e.type_:Array.isArray(n)?1:GE(n)?2:qE(n)?3:0}function qR(n,e){return zE(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function lH(n,e,t){const r=zE(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Mse(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function GE(n){return n instanceof Map}function qE(n){return n instanceof Set}function ts(n){return n.copy_||n.base_}function WR(n,e){if(GE(n))return new Map(n);if(qE(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=oH(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[wn];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Of(n),r)}else{const r=Of(n);if(r!==null&&t)return{...n};const s=Object.create(r);return Object.assign(s,n)}}function IL(n,e=!1){return WE(n)||Nf(n)||!Fl(n)||(zE(n)>1&&(n.set=n.add=n.clear=n.delete=Ose),Object.freeze(n),e&&Object.entries(n).forEach(([t,r])=>IL(r,!0))),n}function Ose(){ca(2)}function WE(n){return Object.isFrozen(n)}var KR={};function pd(n){const e=KR[n];return e||ca(0,n),e}function Nse(n,e){KR[n]||(KR[n]=e)}var Gg;function Vx(){return Gg}function jse(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function LF(n,e){e&&(pd("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function YR(n){XR(n),n.drafts_.forEach(Fse),n.drafts_=null}function XR(n){n===Gg&&(Gg=n.parent_)}function DF(n){return Gg=jse(Gg,n)}function Fse(n){const e=n[wn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function PF(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[wn].modified_&&(YR(e),ca(4)),Fl(n)&&(n=zx(e,n),e.parent_||Gx(e,n)),e.patches_&&pd("Patches").generateReplacementPatches_(t[wn].base_,n,e.patches_,e.inversePatches_)):n=zx(e,t,[]),YR(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==aH?n:void 0}function zx(n,e,t){if(WE(e))return e;const r=e[wn];if(!r)return zg(e,(s,i)=>MF(n,r,e,s,i,t)),e;if(r.scope_!==n)return e;if(!r.modified_)return Gx(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),zg(i,(o,l)=>MF(n,r,s,o,l,t,a)),Gx(n,s,!1),t&&n.patches_&&pd("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function MF(n,e,t,r,s,i,a){if(Nf(s)){const o=i&&e&&e.type_!==3&&!qR(e.assigned_,r)?i.concat(r):void 0,l=zx(n,s,o);if(lH(t,r,l),Nf(l))n.canAutoFreeze_=!1;else return}else a&&t.add(s);if(Fl(s)&&!WE(s)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;zx(n,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,r)&&Gx(n,s)}}function Gx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&IL(e,t)}function Use(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:Vx(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=LL;t&&(s=[r],i=qg);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var LL={get(n,e){if(e===wn)return n;const t=ts(n);if(!qR(t,e))return $se(n,t,e);const r=t[e];return n.finalized_||!Fl(r)?r:r===_1(n.base_,e)?(A1(n),n.copy_[e]=Wg(r,n)):r},has(n,e){return e in ts(n)},ownKeys(n){return Reflect.ownKeys(ts(n))},set(n,e,t){const r=cH(ts(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const s=_1(ts(n),e),i=s?.[wn];if(i&&i.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Mse(t,s)&&(t!==void 0||qR(n.base_,e)))return!0;A1(n),Dl(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return _1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,A1(n),Dl(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=ts(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){ca(11)},getPrototypeOf(n){return Of(n.base_)},setPrototypeOf(){ca(12)}},qg={};zg(LL,(n,e)=>{qg[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});qg.deleteProperty=function(n,e){return qg.set.call(this,n,e,void 0)};qg.set=function(n,e,t){return LL.set.call(this,n[0],e,t,n[0])};function _1(n,e){const t=n[wn];return(t?ts(t):n)[e]}function $se(n,e,t){const r=cH(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function cH(n,e){if(!(e in n))return;let t=Of(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Of(t)}}function Dl(n){n.modified_||(n.modified_=!0,n.parent_&&Dl(n.parent_))}function A1(n){n.copy_||(n.copy_=WR(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Bse=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const a=this;return function(l=i,...c){return a.produce(l,u=>t.call(this,u,...c))}}typeof t!="function"&&ca(6),r!==void 0&&typeof r!="function"&&ca(7);let s;if(Fl(e)){const i=DF(this),a=Wg(e,void 0);let o=!0;try{s=t(a),o=!1}finally{o?YR(i):XR(i)}return LF(i,r),PF(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===aH&&(s=void 0),this.autoFreeze_&&IL(s,!0),r){const i=[],a=[];pd("Patches").generateReplacementPatches_(e,s,i,a),r(i,a)}return s}else ca(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,s;return[this.produce(e,t,(a,o)=>{r=a,s=o}),r,s]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){Fl(n)||ca(8),Nf(n)&&(n=Hse(n));const e=DF(this),t=Wg(n,void 0);return t[wn].isManual_=!0,XR(e),t}finishDraft(n,e){const t=n&&n[wn];(!t||!t.isManual_)&&ca(9);const{scope_:r}=t;return LF(r,e),PF(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}t>-1&&(e=e.slice(t+1));const r=pd("Patches").applyPatches_;return Nf(n)?r(n,e):this.produce(n,s=>r(s,e))}};function Wg(n,e){const t=GE(n)?pd("MapSet").proxyMap_(n,e):qE(n)?pd("MapSet").proxySet_(n,e):Use(n,e);return(e?e.scope_:Vx()).drafts_.push(t),t}function Hse(n){return Nf(n)||ca(10,n),uH(n)}function uH(n){if(!Fl(n)||WE(n))return n;const e=n[wn];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=WR(n,e.scope_.immer_.useStrictShallowCopy_)}else t=WR(n,!0);return zg(t,(r,s)=>{lH(t,r,uH(s))}),e&&(e.finalized_=!1),t}function Vse(){class n extends Map{constructor(l,c){super(),this[wn]={type_:2,parent_:c,scope_:c?c.scope_:Vx(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return ts(this[wn]).size}has(l){return ts(this[wn]).has(l)}set(l,c){const u=this[wn];return a(u),(!ts(u).has(l)||ts(u).get(l)!==c)&&(t(u),Dl(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[wn];return a(c),t(c),Dl(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[wn];a(l),ts(l).size&&(t(l),Dl(l),l.assigned_=new Map,zg(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[wn];ts(u).forEach((f,m,g)=>{l.call(c,this.get(m),m,this)})}get(l){const c=this[wn];a(c);const u=ts(c).get(l);if(c.finalized_||!Fl(u)||u!==c.base_.get(l))return u;const f=Wg(u,c);return t(c),c.copy_.set(l,f),f}keys(){return ts(this[wn]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function e(o,l){return new n(o,l)}function t(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[wn]={type_:3,parent_:c,scope_:c?c.scope_:Vx(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return ts(this[wn]).size}has(l){const c=this[wn];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[wn];return a(c),this.has(l)||(i(c),Dl(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[wn];return a(c),i(c),Dl(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[wn];a(l),ts(l).size&&(i(l),Dl(l),l.copy_.clear())}values(){const l=this[wn];return a(l),i(l),l.copy_.values()}entries(){const l=this[wn];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let f=u.next();for(;!f.done;)l.call(c,f.value,f.value,this),f=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Fl(l)){const c=Wg(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&ca(3,JSON.stringify(ts(o)))}Nse("MapSet",{proxyMap_:e,proxySet_:s})}var Fi=new Bse,zse=Fi.produce;Fi.produceWithPatches.bind(Fi);Fi.setAutoFreeze.bind(Fi);Fi.setUseStrictShallowCopy.bind(Fi);Fi.applyPatches.bind(Fi);Fi.createDraft.bind(Fi);Fi.finishDraft.bind(Fi);const Gse=n=>(e,t,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?zse(s):s;return e(o,i,...a)},n(r.setState,t,r)),bi=Gse,qse=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>im);return{default:r}},[]).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class DL extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Wse extends DL{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class OF extends DL{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class NF extends DL{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var QR;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(QR||(QR={}));var Kse=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Yse{constructor(e,{headers:t={},customFetch:r,region:s=QR.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=qse(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Kse(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const f=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:u}).catch(b=>{throw new Wse(b)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new OF(f);if(!f.ok)throw new NF(f);let g=((r=f.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield f.json():g==="application/octet-stream"?y=yield f.blob():g==="text/event-stream"?y=f:g==="multipart/form-data"?y=yield f.formData():y=yield f.text(),{data:y,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof NF||s instanceof OF?s.context:void 0}}})}}var Kr={},mh={},ph={},gh={},vh={},yh={},Xse=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},jf=Xse();const Qse=jf.fetch,dH=jf.fetch.bind(jf),hH=jf.Headers,Zse=jf.Request,Jse=jf.Response,im=Object.freeze(Object.defineProperty({__proto__:null,Headers:hH,Request:Zse,Response:Jse,default:dH,fetch:Qse},Symbol.toStringTag,{value:"Module"})),eie=cte(im);var Py={},jF;function fH(){if(jF)return Py;jF=1,Object.defineProperty(Py,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Py.default=n,Py}var FF;function mH(){if(FF)return yh;FF=1;var n=yh&&yh.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(yh,"__esModule",{value:!0});const e=n(eie),t=n(fH());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,f,m;let g=null,y=null,b=null,x=c.status,S=c.statusText;if(c.ok){if(this.method!=="HEAD"){const I=await c.text();I===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=I:y=JSON.parse(I))}const _=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),R=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");_&&R&&R.length>1&&(b=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(g={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,b=null,x=406,S="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const _=await c.text();try{g=JSON.parse(_),Array.isArray(g)&&c.status===404&&(y=[],g=null,x=200,S="OK")}catch{c.status===404&&_===""?(x=204,S="No Content"):g={message:_}}if(g&&this.isMaybeSingle&&(!((m=g?.details)===null||m===void 0)&&m.includes("0 rows"))&&(g=null,x=200,S="OK"),g&&this.shouldThrowOnError)throw new t.default(g)}return{error:g,data:y,count:b,status:x,statusText:S}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,f,m;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(f=c?.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(m=c?.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}returns(){return this}overrideTypes(){return this}}return yh.default=r,yh}var UF;function pH(){if(UF)return vh;UF=1;var n=vh&&vh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vh,"__esModule",{value:!0});const e=n(mH());class t extends e.default{select(s){let i=!1;const a=(s??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const f=[s?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),m=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${m}"; options=${f};`,c==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return vh.default=t,vh}var $F;function PL(){if($F)return gh;$F=1;var n=gh&&gh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(gh,"__esModule",{value:!0});const e=n(pH());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`in.(${a})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(s,i,a){return this.url.searchParams.append(s,`not.${i}.${a}`),this}or(s,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${s})`),this}filter(s,i,a){return this.url.searchParams.append(s,`${i}.${a}`),this}}return gh.default=t,gh}var BF;function gH(){if(BF)return ph;BF=1;var n=ph&&ph.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ph,"__esModule",{value:!0});const e=n(PL());class t{constructor(s,{headers:i={},schema:a,fetch:o}){this.url=s,this.headers=i,this.schema=a,this.fetch=o}select(s,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const c=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const c=s.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(s)){const f=s.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(f.length>0){const m=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",a=[];return s&&a.push(`count=${s}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ph.default=t,ph}var yp={},bp={},HF;function tie(){return HF||(HF=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.version=void 0,bp.version="0.0.0-automated"),bp}var VF;function nie(){if(VF)return yp;VF=1,Object.defineProperty(yp,"__esModule",{value:!0}),yp.DEFAULT_HEADERS=void 0;const n=tie();return yp.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},yp}var zF;function rie(){if(zF)return mh;zF=1;var n=mh&&mh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(mh,"__esModule",{value:!0});const e=n(gH()),t=n(PL()),r=nie();class s{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:u}={}){let f;const m=new URL(`${this.url}/rpc/${a}`);let g;l||c?(f=l?"HEAD":"GET",Object.entries(o).filter(([b,x])=>x!==void 0).map(([b,x])=>[b,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([b,x])=>{m.searchParams.append(b,x)})):(f="POST",g=o);const y=Object.assign({},this.headers);return u&&(y.Prefer=`count=${u}`),new t.default({method:f,url:m,headers:y,schema:this.schemaName,body:g,fetch:this.fetch,allowEmpty:!1})}}return mh.default=s,mh}var GF;function sie(){if(GF)return Kr;GF=1;var n=Kr&&Kr.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.PostgrestError=Kr.PostgrestBuilder=Kr.PostgrestTransformBuilder=Kr.PostgrestFilterBuilder=Kr.PostgrestQueryBuilder=Kr.PostgrestClient=void 0;const e=n(rie());Kr.PostgrestClient=e.default;const t=n(gH());Kr.PostgrestQueryBuilder=t.default;const r=n(PL());Kr.PostgrestFilterBuilder=r.default;const s=n(pH());Kr.PostgrestTransformBuilder=s.default;const i=n(mH());Kr.PostgrestBuilder=i.default;const a=n(fH());return Kr.PostgrestError=a.default,Kr.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:a.default},Kr}var iie=sie();const aie=Rd(iie),{PostgrestClient:oie,PostgrestQueryBuilder:aje,PostgrestFilterBuilder:oje,PostgrestTransformBuilder:lje,PostgrestBuilder:cje,PostgrestError:uje}=aie;function lie(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const cie=lie(),uie="2.11.15",die=`realtime-js/${uie}`,hie="1.0.0",vH=1e4,fie=1e3;var cg;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(cg||(cg={}));var Ts;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ts||(Ts={}));var Ua;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Ua||(Ua={}));var ZR;(function(n){n.websocket="websocket"})(ZR||(ZR={}));var Zu;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Zu||(Zu={}));class mie{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const l=r.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class yH{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Un;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Un||(Un={}));const qF=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=pie(a,n,e,s),i),{})},pie=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s?.type,a=t[n];return i&&!r.includes(i)?bH(i,a):JR(a)},bH=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return bie(e,t)}switch(n){case Un.bool:return gie(e);case Un.float4:case Un.float8:case Un.int2:case Un.int4:case Un.int8:case Un.numeric:case Un.oid:return vie(e);case Un.json:case Un.jsonb:return yie(e);case Un.timestamp:return xie(e);case Un.abstime:case Un.date:case Un.daterange:case Un.int4range:case Un.int8range:case Un.money:case Un.reltime:case Un.text:case Un.time:case Un.timestamptz:case Un.timetz:case Un.tsrange:case Un.tstzrange:return JR(e);default:return JR(e)}},JR=n=>n,gie=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},vie=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},yie=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return`${e}`,n}return n},bie=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>bH(e,o))}return n},xie=n=>typeof n=="string"?n.replace(" ","T"):n,xH=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class R1{constructor(e,t,r={},s=vH){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var WF;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(WF||(WF={}));class ug{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ug.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=ug.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ug.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=i[c];if(f){const m=u.map(x=>x.presence_ref),g=f.map(x=>x.presence_ref),y=u.filter(x=>g.indexOf(x.presence_ref)<0),b=f.filter(x=>m.indexOf(x.presence_ref)<0);y.length>0&&(o[c]=y),b.length>0&&(l[c]=b)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const f=e[o].map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0);e[o].unshift(...m)}r(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),e[o]=c,s(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var KF;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(KF||(KF={}));var YF;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(YF||(YF={}));var _l;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(_l||(_l={}));class ML{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ts.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new R1(this,Ua.join,this.params,this.timeout),this.rejoinTimer=new yH(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ts.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ts.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ts.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ts.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ua.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new ug(this),this.broadcastEndpointURL=xH(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Ts.closed){const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(u=>e?.(_l.CHANNEL_ERROR,u)),this._onClose(()=>e?.(_l.CLOSED));const l={},c={broadcast:i,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){e?.(_l.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(f=m?.length)!==null&&f!==void 0?f:0,y=[];for(let b=0;b<g;b++){const x=m[b],{filter:{event:S,schema:T,table:_,filter:R}}=x,I=u&&u[b];if(I&&I.event===S&&I.schema===T&&I.table===_&&I.filter===R)y.push(Object.assign(Object.assign({},x),{id:I.id}));else{this.unsubscribe(),this.state=Ts.errored,e?.(_l.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(_l.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ts.errored,e?.(_l.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e?.(_l.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ts.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ua.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new R1(this,Ua.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new R1(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ua;if(r&&[o,l,c,u].indexOf(a)>=0&&r!==this._joinRef())return;let m=this._onMessage(a,t,r);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var y,b,x;return((y=g.filter)===null||y===void 0?void 0:y.event)==="*"||((x=(b=g.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(g=>g.callback(m,r)):(i=this.bindings[a])===null||i===void 0||i.filter(g=>{var y,b,x,S,T,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const R=g.id,I=(y=g.filter)===null||y===void 0?void 0:y.event;return R&&((b=t.ids)===null||b===void 0?void 0:b.includes(R))&&(I==="*"||I?.toLocaleLowerCase()===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const R=(T=(S=g?.filter)===null||S===void 0?void 0:S.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return R==="*"||R===((_=t?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:b,table:x,commit_timestamp:S,type:T,errors:_}=y;m=Object.assign(Object.assign({},{schema:b,table:x,commit_timestamp:S,eventType:T,new:{},old:{},errors:_}),this._getPayloadRecords(y))}g.callback(m,r)})}_isClosed(){return this.state===Ts.closed}_isJoined(){return this.state===Ts.joined}_isJoining(){return this.state===Ts.joining}_isLeaving(){return this.state===Ts.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ML.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ua.close,{},e)}_onError(e){this._on(Ua.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ts.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=qF(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=qF(e.columns,e.old_record)),t}}const XF=()=>{},wie=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Eie{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vH,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=XF,this.ref=0,this.logger=XF,this.conn=null,this.sendBuffer=[],this.serializer=new mie,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Ze(async()=>{const{default:l}=await Promise.resolve().then(()=>im);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${ZR.websocket}`,this.httpEndpoint=xH(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t?.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t?.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new yH(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=cie),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:hie}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case cg.connecting:return Zu.Connecting;case cg.open:return Zu.Open;case cg.closing:return Zu.Closing;default:return Zu.Closed}}isConnected(){return this.connectionState()===Zu.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new ML(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:die};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Ua.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(fie,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:a}=t;r==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(r)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ua.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([wie],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class OL extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Jr(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Sie extends OL{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class eC extends OL{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Tie=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const wH=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>im);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},_ie=()=>Tie(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ze(()=>Promise.resolve().then(()=>im),void 0)).Response:Response}),tC=n=>{if(Array.isArray(n))return n.map(t=>tC(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=tC(r)}),e},Aie=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var kd=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const C1=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Rie=(n,e,t)=>kd(void 0,void 0,void 0,function*(){const r=yield _ie();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const i=n.status||500,a=s?.statusCode||i+"";e(new Sie(C1(s),i,a))}).catch(s=>{e(new eC(C1(s),s))}):e(new eC(C1(n),n))}),Cie=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(Aie(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t))};function Vv(n,e,t,r,s,i){return kd(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Cie(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Rie(l,o,r))})})}function qx(n,e,t,r){return kd(this,void 0,void 0,function*(){return Vv(n,"GET",e,t,r)})}function Al(n,e,t,r,s){return kd(this,void 0,void 0,function*(){return Vv(n,"POST",e,r,s,t)})}function nC(n,e,t,r,s){return kd(this,void 0,void 0,function*(){return Vv(n,"PUT",e,r,s,t)})}function kie(n,e,t,r){return kd(this,void 0,void 0,function*(){return Vv(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function EH(n,e,t,r,s){return kd(this,void 0,void 0,function*(){return Vv(n,"DELETE",e,r,s,t)})}var Js=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Iie={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},QF={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Lie{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=wH(s)}uploadOrUpdate(e,t,r,s){return Js(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},QF),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),f=yield(e=="PUT"?nC:Al)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:o},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(Jr(i))return{data:null,error:i};throw i}})}upload(e,t,r){return Js(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return Js(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:QF.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield nC(this.fetch,o.toString(),l,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(Jr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Js(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const i=yield Al(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new OL("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}update(e,t,r){return Js(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Js(this,void 0,void 0,function*(){try{return{data:yield Al(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}copy(e,t,r){return Js(this,void 0,void 0,function*(){try{return{data:{path:(yield Al(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return Js(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Al(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return Js(this,void 0,void 0,function*(){try{const s=yield Al(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}download(e,t){return Js(this,void 0,void 0,function*(){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield qx(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}info(e){return Js(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield qx(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:tC(r),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}exists(e){return Js(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield kie(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Jr(r)&&r instanceof eC){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${c}`)}}}remove(e){return Js(this,void 0,void 0,function*(){try{return{data:yield EH(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Jr(t))return{data:null,error:t};throw t}})}list(e,t,r){return Js(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Iie),t),{prefix:e||""});return{data:yield Al(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(Jr(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Die="2.10.4",Pie={"X-Client-Info":`storage-js/${Die}`};var bh=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Mie{constructor(e,t={},r,s){const i=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Pie),t),this.fetch=wH(r)}listBuckets(){return bh(this,void 0,void 0,function*(){try{return{data:yield qx(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Jr(e))return{data:null,error:e};throw e}})}getBucket(e){return bh(this,void 0,void 0,function*(){try{return{data:yield qx(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Jr(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return bh(this,void 0,void 0,function*(){try{return{data:yield Al(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return bh(this,void 0,void 0,function*(){try{return{data:yield nC(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Jr(r))return{data:null,error:r};throw r}})}emptyBucket(e){return bh(this,void 0,void 0,function*(){try{return{data:yield Al(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Jr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bh(this,void 0,void 0,function*(){try{return{data:yield EH(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Jr(t))return{data:null,error:t};throw t}})}}class Oie extends Mie{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Lie(this.url,this.headers,e,this.fetch)}}const Nie="2.53.0";let Fp="";typeof Deno<"u"?Fp="deno":typeof document<"u"?Fp="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fp="react-native":Fp="node";const jie={"X-Client-Info":`supabase-js-${Fp}/${Nie}`},Fie={headers:jie},Uie={schema:"public"},$ie={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Bie={};var Hie=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};const Vie=n=>{let e;return n?e=n:typeof fetch>"u"?e=dH:e=fetch,(...t)=>e(...t)},zie=()=>typeof Headers>"u"?hH:Headers,Gie=(n,e,t)=>{const r=Vie(t),s=zie();return(i,a)=>Hie(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new s(a?.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},a),{headers:c}))})};var qie=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};function Wie(n){return n.endsWith("/")?n:n+"/"}function Kie(n,e){var t,r;const{db:s,auth:i,realtime:a,global:o}=n,{db:l,auth:c,realtime:u,global:f}=e,m={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f?.headers)!==null&&t!==void 0?t:{}),(r=o?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>qie(this,void 0,void 0,function*(){return""})};return n.accessToken?m.accessToken=n.accessToken:delete m.accessToken,m}const SH="2.71.1",Hh=30*1e3,rC=3,k1=rC*Hh,Yie="http://localhost:9999",Xie="supabase.auth.token",Qie={"X-Client-Info":`gotrue-js/${SH}`},sC="X-Supabase-Api-Version",TH={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zie=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jie=600*1e3;class NL extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Gt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class eae extends NL{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function tae(n){return Gt(n)&&n.name==="AuthApiError"}class _H extends NL{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class cu extends NL{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Ac extends cu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nae(n){return Gt(n)&&n.name==="AuthSessionMissingError"}class My extends cu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Oy extends cu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ny extends cu{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function rae(n){return Gt(n)&&n.name==="AuthImplicitGrantRedirectError"}class ZF extends cu{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class iC extends cu{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function I1(n){return Gt(n)&&n.name==="AuthRetryableFetchError"}class JF extends cu{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class aC extends cu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eU=` 	
\r=`.split(""),sae=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<eU.length;e+=1)n[eU[e].charCodeAt(0)]=-2;for(let e=0;e<Wx.length;e+=1)n[Wx[e].charCodeAt(0)]=e;return n})();function tU(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Wx[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Wx[r]),e.queuedBits-=6}}function AH(n,e,t){const r=sae[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function nU(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{oae(a,r,t)};for(let a=0;a<n.length;a+=1)AH(n.charCodeAt(a),s,i);return e.join("")}function iae(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function aae(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}iae(r,e)}}function oae(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lae(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)AH(n.charCodeAt(s),t,r);return new Uint8Array(e)}function cae(n){const e=[];return aae(n,t=>e.push(t)),new Uint8Array(e)}function uae(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>tU(s,t,r)),tU(null,t,r),e.join("")}function dae(n){return Math.round(Date.now()/1e3)+n}function hae(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ia=()=>typeof window<"u"&&typeof document<"u",Mu={tested:!1,writable:!1},RH=()=>{if(!Ia())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mu.tested)return Mu.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Mu.tested=!0,Mu.writable=!0}catch{Mu.tested=!0,Mu.writable=!1}return Mu.writable};function fae(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const CH=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>im);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},mae=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Vh=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ou=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},mc=async(n,e)=>{await n.removeItem(e)};class KE{constructor(){this.promise=new KE.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}KE.promiseConstructor=Promise;function L1(n){const e=n.split(".");if(e.length!==3)throw new aC("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Zie.test(e[r]))throw new aC("JWT not in base64url format");return{header:JSON.parse(nU(e[0])),payload:JSON.parse(nU(e[1])),signature:lae(e[2]),raw:{header:e[0],payload:e[1]}}}async function pae(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function gae(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function vae(n){return("0"+n.toString(16)).substr(-2)}function yae(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,vae).join("")}async function bae(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function xae(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await bae(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xh(n,e,t=!1){const r=yae();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Vh(n,`${e}-code-verifier`,s);const i=await xae(r);return[i,r===i?"plain":"s256"]}const wae=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Eae(n){const e=n.headers.get(sC);if(!e||!e.match(wae))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Sae(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Tae(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const _ae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wh(n){if(!_ae.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function D1(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function rU(n){return JSON.parse(JSON.stringify(n))}var Aae=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const zu=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Rae=[502,503,504];async function sU(n){var e;if(!mae(n))throw new iC(zu(n),0);if(Rae.includes(n.status))throw new iC(zu(n),n.status);let t;try{t=await n.json()}catch(i){throw new _H(zu(i),i)}let r;const s=Eae(n);if(s&&s.getTime()>=TH["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new JF(zu(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ac}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new JF(zu(t),n.status,t.weak_password.reasons);throw new eae(zu(t),n.status||500,r)}const Cae=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function an(n,e,t,r){var s;const i=Object.assign({},r?.headers);i[sC]||(i[sC]=TH["2024-01-01"].name),r?.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await kae(n,e,t+o,{headers:i,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}}async function kae(n,e,t,r,s,i){const a=Cae(e,r,s,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new iC(zu(l),0)}if(o.ok||await sU(o),r?.noResolveJson)return o;try{return await o.json()}catch(l){await sU(l)}}function El(n){var e;let t=null;Pae(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=dae(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function iU(n){const e=El(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Uc(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Iae(n){return{data:n,error:null}}function Lae(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=Aae(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Dae(n){return n}function Pae(n){return n.access_token&&n.refresh_token&&n.expires_in}const P1=["global","local","others"];var Mae=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Oae{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=CH(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=P1[0]){if(P1.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${P1.join(", ")}`);try{return await an(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await an(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Uc})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Mae(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await an(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Lae,redirectTo:t?.redirectTo})}catch(t){if(Gt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await an(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Uc})}catch(t){if(Gt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await an(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Dae});if(u.error)throw u.error;const f=await u.json(),m=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return g.length>0&&(g.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);c[`${x}Page`]=b}),c.total=parseInt(m)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Gt(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){wh(e);try{return await an(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Uc})}catch(t){if(Gt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){wh(e);try{return await an(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Uc})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){wh(e);try{return await an(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Uc})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){wh(e.userId);try{const{data:t,error:r}=await an(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(Gt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){wh(e.userId),wh(e.id);try{return{data:await an(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Gt(t))return{data:null,error:t};throw t}}}function aU(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Nae(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Eh={debug:!!(globalThis&&RH()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class kH extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class jae extends kH{}async function Fae(n,e,t){Eh.debug;const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Eh.debug},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Eh.debug&&s.name;try{return await t()}finally{Eh.debug&&s.name}}else{if(e===0)throw Eh.debug,new jae(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Eh.debug)try{const i=await globalThis.navigator.locks.query();JSON.stringify(i,null,"  ")}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Nae();const Uae={url:Yie,storageKey:Xie,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qie,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function oU(n,e,t){return await t()}const Sh={};class Kg{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kg.nextInstanceID,Kg.nextInstanceID+=1,this.instanceID>0&&Ia()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Uae),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Oae({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=CH(s.fetch),this.lock=s.lock||oU,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Ia()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Fae:this.lock=oU,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:RH()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=aU(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=aU(this.memoryStorage)),Ia()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Sh[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Sh[this.storageKey]=Object.assign(Object.assign({},Sh[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Sh[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Sh[this.storageKey]=Object.assign(Object.assign({},Sh[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${SH}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=fae(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Ia()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),rae(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Gt(t)?{error:t}:{error:new _H("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:El}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Gt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:u,password:f,options:m}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await xh(this.storage,this.storageKey)),i=await an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:u,password:f,data:(t=m?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:g,code_challenge_method:y},xform:El})}else if("phone"in e){const{phone:u,password:f,options:m}=e;i=await an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(r=m?.data)!==null&&r!==void 0?r:{},channel:(s=m?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:El})}else throw new Oy("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Gt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await an(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:iU})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await an(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:iU})}else throw new Oy("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new My}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(Gt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,s,i,a,o,l,c,u,f,m,g;let y,b;if("message"in e)y=e.message,b=e.signature;else{const{chain:x,wallet:S,statement:T,options:_}=e;let R;if(Ia())if(typeof S=="object")R=S;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))R=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=S}const I=new URL((t=_?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in R&&R.signIn){const C=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),T?{statement:T}:null));let L;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")L=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)L=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)y=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),b=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${I.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(s=(r=_?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(u=_?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const C=await R.signMessage(new TextEncoder().encode(y),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=C}}try{const{data:x,error:S}=await an(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:uae(b)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:El});if(S)throw S;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new My}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:S})}catch(x){if(Gt(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const t=await Ou(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:a}=await an(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:El});if(await mc(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new My}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Gt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await an(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:El}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new My}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(Gt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await xh(this.storage,this.storageKey));const{error:f}=await an(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(r=l?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await an(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Oy("You must provide either an email or phone number.")}catch(o){if(Gt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await an(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:El});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Gt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await xh(this.storage,this.storageKey)),await an(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Iae})}catch(i){if(Gt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Ac;const{error:s}=await an(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Gt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await an(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await an(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new Oy("You must provide either an email or phone number and a type")}catch(t){if(Gt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ou(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<k1:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await Ou(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=D1()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await an(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Uc}):await this._useSession(async t=>{var r,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ac}:await an(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Uc})})}catch(t){if(Gt(t))return nae(t)&&(await this._removeSession(),await mc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Ac;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await xh(this.storage,this.storageKey));const{data:c,error:u}=await an(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Uc});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ac;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:a}=L1(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Gt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Ac;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Gt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ia())throw new Ny("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ny(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ZF("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ny("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ZF("No code detected.");const{data:T,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new Ny("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let m=u+f;l&&(m=parseInt(l));const g=m-u;g*1e3<=Hh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${f}s`);const y=m-f;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,u);const{data:b,error:x}=await this._getUser(i);if(x)throw x;const S={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:m,refresh_token:a,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(r){if(Gt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ou(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(tae(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await mc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=hae(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await xh(this.storage,this.storageKey,!0));try{return await an(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Gt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Gt(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,l,c,u;const{data:f,error:m}=i;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await an(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Ia()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(Gt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)throw a;return await an(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(Gt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await gae(async s=>(s>0&&await pae(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await an(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:El})),(s,i)=>{const a=200*Math.pow(2,s);return i&&I1(i)&&Date.now()+a-r<Hh})}catch(r){if(this._debug(t,"error",r),Gt(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Ia()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Ou(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Ou(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await Vh(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a?.user)!==null&&e!==void 0?e:D1()}else if(s&&!s.user&&!s.user){const a=await Ou(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,await mc(this.storage,this.storageKey+"-user"),await Vh(this.storage,this.storageKey,s)):s.user=D1()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<k1;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${k1}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),I1(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&a?.user?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Ac;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new KE;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Ac;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Gt(i)){const a={session:null,error:i};return I1(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Vh(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=rU(s);await Vh(this.storage,this.storageKey,i)}else{const s=rU(t);await Vh(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await mc(this.storage,this.storageKey),await mc(this.storage,this.storageKey+"-code-verifier"),await mc(this.storage,this.storageKey+"-user"),this.userStorage&&await mc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ia()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Hh);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Hh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Hh}ms, refresh threshold is ${rC} ticks`),s<=rC&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof kH)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ia()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await xh(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(r?.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await an(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Gt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await an(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l?.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Gt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await an(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(Gt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await an(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Gt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=L1(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+Jie>s)return r;const{data:i,error:a}=await an(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(o=>o.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:g,error:y}=await this.getSession();if(y||!g.session)return{data:null,error:y};r=g.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=L1(r);t?.allowExpired||Sae(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!c){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:i,header:s,signature:a},error:null}}const u=Tae(s.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,cae(`${o}.${l}`)))throw new aC("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}}Kg.nextInstanceID=0;const $ae=Kg;class Bae extends $ae{constructor(e){super(e)}}var Hae=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})};class Vae{constructor(e,t,r){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Wie(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Uie,realtime:Bie,auth:Object.assign(Object.assign({},$ie),{storageKey:c}),global:Fie},f=Kie(r??{},u);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=Gie(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new oie(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Oie(this.storageUrl.href,this.headers,this.fetch,r?.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Yse(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Hae(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bae({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Eie(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zae=(n,e,t)=>new Vae(n,e,t);function Gae(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const n=process.version.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}Gae()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const qae="0.6.1";function dg(){return typeof window<"u"&&typeof window.document<"u"}const jy={path:"/",sameSite:"lax",httpOnly:!1,maxAge:400*24*60*60},Wae=3180,Kae=/^(.*)[.](0|[1-9][0-9]*)$/;function lU(n,e){if(n===e)return!0;const t=n.match(Kae);return!!(t&&t[1]===e)}function Yae(n,e,t){const r=Wae;let s=encodeURIComponent(e);if(s.length<=r)return[{name:n,value:e}];const i=[];for(;s.length>0;){let a=s.slice(0,r);const o=a.lastIndexOf("%");o>r-3&&(a=a.slice(0,o));let l="";for(;a.length>0;)try{l=decodeURIComponent(a);break}catch(c){if(c instanceof URIError&&a.at(-3)==="%"&&a.length>3)a=a.slice(0,a.length-3);else throw c}i.push(l),s=s.slice(a.length)}return i.map((a,o)=>({name:`${n}.${o}`,value:a}))}async function Xae(n,e){const t=await e(n);if(t)return t;let r=[];for(let s=0;;s++){const i=`${n}.${s}`,a=await e(i);if(!a)break;r.push(a)}return r.length>0?r.join(""):null}const Kx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cU=` 	
\r=`.split(""),Qae=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<cU.length;e+=1)n[cU[e].charCodeAt(0)]=-2;for(let e=0;e<Kx.length;e+=1)n[Kx[e].charCodeAt(0)]=e;return n})();function Zae(n){const e=[];let t=0,r=0;if(toe(n,i=>{for(t=t<<8|i,r+=8;r>=6;){const a=t>>r-6&63;e.push(Kx[a]),r-=6}}),r>0)for(t=t<<6-r,r=6;r>=6;){const i=t>>r-6&63;e.push(Kx[i]),r-=6}return e.join("")}function Jae(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0};let s=0,i=0;for(let a=0;a<n.length;a+=1){const o=n.charCodeAt(a),l=Qae[o];if(l>-1)for(s=s<<6|l,i+=6;i>=8;)noe(s>>i-8&255,r,t),i-=8;else{if(l===-2)continue;throw new Error(`Invalid Base64-URL character "${n.at(a)}" at position ${a}`)}}return e.join("")}function eoe(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function toe(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}eoe(r,e)}}function noe(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}const M1="base64-";function roe(n,e){const t=n.cookies??null,r=n.cookieEncoding,s={},i={};let a,o;if(t)if("get"in t){const l=async c=>{const u=c.flatMap(m=>[m,...Array.from({length:5}).map((g,y)=>`${m}.${y}`)]),f=[];for(let m=0;m<u.length;m+=1){const g=await t.get(u[m]);!g&&typeof g!="string"||f.push({name:u[m],value:g})}return f};if(a=async c=>await l(c),"set"in t&&"remove"in t)o=async c=>{for(let u=0;u<c.length;u+=1){const{name:f,value:m,options:g}=c[u];m?await t.set(f,m,g):await t.remove(f,g)}};else throw new Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in t)if(a=async()=>await t.getAll(),"setAll"in t)o=t.setAll;else throw new Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw new Error(`@supabase/ssr: createBrowserClient requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${dg()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(dg()){const l=()=>{const c=gF.parse(document.cookie);return Object.keys(c).map(u=>({name:u,value:c[u]??""}))};a=()=>l(),o=c=>{c.forEach(({name:u,value:f,options:m})=>{document.cookie=gF.serialize(u,f,m)})}}else a=()=>[],o=()=>{throw new Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};return{getAll:a,setAll:o,setItems:s,removedItems:i,storage:{isServer:!1,getItem:async l=>{const c=await a([l]),u=await Xae(l,async m=>{const g=c?.find(({name:y})=>y===m)||null;return g?g.value:null});if(!u)return null;let f=u;return u.startsWith(M1)&&(f=Jae(u.substring(M1.length))),f},setItem:async(l,c)=>{const f=(await a([l]))?.map(({name:T})=>T)||[],m=new Set(f.filter(T=>lU(T,l)));let g=c;r==="base64url"&&(g=M1+Zae(c));const y=Yae(l,g);y.forEach(({name:T})=>{m.delete(T)});const b={...jy,...n?.cookieOptions,maxAge:0},x={...jy,...n?.cookieOptions,maxAge:jy.maxAge};delete b.name,delete x.name;const S=[...[...m].map(T=>({name:T,value:"",options:b})),...y.map(({name:T,value:_})=>({name:T,value:_,options:x}))];S.length>0&&await o(S)},removeItem:async l=>{const f=((await a([l]))?.map(({name:g})=>g)||[]).filter(g=>lU(g,l)),m={...jy,...n?.cookieOptions,maxAge:0};delete m.name,f.length>0&&await o(f.map(g=>({name:g,value:"",options:m})))}}}}let O1;function soe(n,e,t){const r=t?.isSingleton===!0||(!t||!("isSingleton"in t))&&dg();if(r&&O1)return O1;const{storage:s}=roe({...t,cookieEncoding:t?.cookieEncoding??"base64url"}),i=zae(n,e,{...t,global:{...t?.global,headers:{...t?.global?.headers,"X-Client-Info":`supabase-ssr/${qae} createBrowserClient`}},auth:{...t?.auth,...t?.cookieOptions?.name?{storageKey:t.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:dg(),detectSessionInUrl:dg(),persistSession:!0,storage:s}});return r&&(O1=i),i}function ioe(){const e=".flask.do";return soe("https://wfolvflsphwdqhbnlysw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indmb2x2ZmxzcGh3ZHFoYm5seXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ2MjQxOTgsImV4cCI6MjA2MDIwMDE5OH0.BpFNSXauqJBFJfyPR-Uv0-J6TDLrJWwvAwEsdvRjUSA",{cookies:{get(t){const s=document.cookie.split(";").find(i=>i.trim().startsWith(`${t}=`));if(s)return decodeURIComponent(s.split("=")[1])},set(t,r,s){let i=`${t}=${encodeURIComponent(r)}`;s?.maxAge&&(i+=`; Max-Age=${s.maxAge}`),s?.expires&&(i+=`; Expires=${s.expires.toUTCString()}`),s?.path&&(i+=`; Path=${s.path}`),s?.domain?i+=`; Domain=${s.domain}`:i+=`; Domain=${e}`,s?.secure,i+="; Secure",s?.sameSite?i+=`; SameSite=${s.sameSite}`:i+="; SameSite=Lax",document.cookie=i},remove(t,r){let s=`${t}=; Max-Age=0`;r?.path&&(s+=`; Path=${r.path}`),r?.domain?s+=`; Domain=${r.domain}`:s+=`; Domain=${e}`,document.cookie=s}},cookieOptions:{domain:e,path:"/",sameSite:"lax",secure:!0,maxAge:3600*24*180},auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1,flowType:"pkce"}})}let N1=null;function IH(){return N1||(N1=ioe()),N1}const ua=()=>IH(),Lr=IH(),hg=Object.freeze(Object.defineProperty({__proto__:null,createClient:ua,supabase:Lr},Symbol.toStringTag,{value:"Module"})),LH="https://api.flask.do",jL=n=>{const e=n.startsWith("/")?n:`/${n}`;return`${LH}${e}`},Ht=(n,e={})=>{const t=jL(n),r={...e.headers};return!(e.body instanceof FormData)&&!e.headers?.["Content-Type"]&&(r["Content-Type"]="application/json"),fetch(t,{...e,credentials:"include",headers:r})},DH=(n,e={})=>{const t=jL(n),r={...e.headers};return!(e.body instanceof FormData)&&!e.headers?.["Content-Type"]&&(r["Content-Type"]="application/json"),fetch(t,{...e,credentials:"omit",headers:r})},Th=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:LH,apiUrl:jL,fetchPublic:DH,fetchWithCredentials:Ht},Symbol.toStringTag,{value:"Module"})),aoe=async(n,e,t,r,s,i,a)=>{try{const o=await Ht("/api/flasks",{method:"POST",body:JSON.stringify({user_id:n,youtube_url:e||null,name:t||null,thumbnail:r||null,asset_id:s||null,asset_ids:a||null,mux_asset_info:i||null})});if(!o.ok){const c=await o.json();if(c.code==="FLASK_LIMIT_REACHED"){const u=new Error(c.error);throw u.code=c.code,u}throw console.error("Failed to create flask:",c),new Error(c.error||"Failed to create flask")}return await o.json()}catch(o){throw console.error("Error creating flask:",o),o}},ooe=async n=>{try{return(await Ht(`/api/flasks/${n}`,{method:"DELETE"})).ok?!0:(console.error("Failed to delete flask"),!1)}catch(e){return console.error("Error deleting flask:",e),!1}},FL=async(n,e)=>{try{const t=await Ht(`/api/flasks/${n}`,{method:"PUT",body:JSON.stringify(e)});return t.ok?await t.json():(console.error("Failed to update flask"),null)}catch(t){return console.error("Error updating flask:",t),null}},loe=async(n,e)=>{const t=await Ht("/api/flask-tags",{method:"POST",body:JSON.stringify({name:n,team_id:e})});if(!t.ok)throw new Error("Failed to create tag");return t.json()},coe=async n=>{if(!(await Ht(`/api/flask-tags/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete tag")},uoe=async(n,e)=>{const t=await Ht(`/api/flask-tags/${n}`,{method:"PATCH",body:JSON.stringify({name:e})});if(!t.ok)throw new Error("Failed to edit tag");return t.json()},uU=async(n,e)=>{const t=await Ht(`/api/flasks/${n}/tag`,{method:"POST",body:JSON.stringify({tagId:e})});if(!t.ok)throw new Error("Failed to update flask tag");return t.json()},doe=async n=>{const e=n?`/api/flask-tags?teamId=${n}`:"/api/flask-tags",t=await Ht(e,{method:"GET"});if(!t.ok)throw new Error("Failed to fetch tags");return t.json()};var hoe=(n,e,t,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(g){(Array.isArray(n)?n:[n]).forEach(y=>{let b=y==="class",x=b&&i?s.map(S=>i[S]||S):s;b?(l.classList.remove(...x),l.classList.add(i&&i[g]?i[g]:g)):l.setAttribute(y,g)}),f(g)}function f(g){o&&c.includes(g)&&(l.style.colorScheme=g)}function m(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let g=localStorage.getItem(e)||t,y=a&&g==="system"?m():g;u(y)}catch{}};E.createContext(void 0);E.memo(({forcedTheme:n,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([t,e,i,n,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${hoe.toString()})(${u})`}})});const Fy=Object.freeze(Object.defineProperty({__proto__:null,toast:et},Symbol.toStringTag,{value:"Module"})),PH=async n=>{if(!n.length)return{};try{const e=await Ht("/api/users/profiles",{method:"POST",body:JSON.stringify({userIds:n})});return e.ok?await e.json():(console.error("Failed to fetch user profiles:",e.status,e.statusText),{})}catch(e){return console.error("Error fetching user profiles:",e),{}}},dU=["accent-purple","accent-blue","accent-teal","accent-green","accent-lime","accent-orange","accent-red"],hU={currentTeam:null,userTeams:[],isLoadingTeams:!1,teamsError:null,flasks:[],isLoadingFlasks:!1,flasksError:null,selectedFlaskIds:[],flaskFilter:{tagId:null,userId:null,searchTerm:""},tags:[],isLoadingTags:!1,tagsError:null,userProfiles:{},isInitialized:!1,pendingOperations:new Set,skeleton:{showFlaskGrid:!1,showSidebar:!1,isTransitioning:!1},flasksSubscription:null,tagsSubscription:null,teamsSubscription:null},Ft=Ws()(Ui(bi((n,e)=>({...hU,getFilteredFlasks:()=>{const t=e();let r=t.flasks;if(t.flaskFilter.tagId&&(r=r.filter(s=>s.flask_tag?.id===t.flaskFilter.tagId)),t.flaskFilter.userId&&(r=r.filter(s=>s.user_id===t.flaskFilter.userId)),t.flaskFilter.searchTerm){const s=t.flaskFilter.searchTerm.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(s))}return[...r].sort((s,i)=>{const a=new Date(s.updated_at||s.created_at||0).getTime();return new Date(i.updated_at||i.created_at||0).getTime()-a})},getNextTagColor:()=>{const t=e().tags.length;return dU[t%dU.length]},isProTeam:()=>e().currentTeam?.team_type==="pro_team",isFreeTeam:()=>e().currentTeam?.team_type==="free_team",hasActiveSubscription:()=>{const t=e().currentTeam;return t?.team_type==="pro_team"&&t?.subscription_status==="active"},isTeamAdmin:t=>{const r=e().currentTeam;return r?r.members.find(i=>i.user_id===t)?.role==="admin":!1},shouldShowSkeleton:()=>{const t=e();return t.skeleton.showFlaskGrid||t.skeleton.showSidebar||t.skeleton.isTransitioning},initialize:async t=>{if(!(!t||e().isInitialized))try{e().showAllSkeletons(),await Promise.all([e().fetchUserTeams(t),e().fetchCurrentTeam(t)]);const r=e().currentTeam;r&&await Promise.all([e().fetchFlasks(r.id),e().fetchTags(r.id)]),e().subscribeToChanges(),n(s=>{s.isInitialized=!0}),e().hideAllSkeletons()}catch(r){console.error("Failed to initialize dashboard:",r),e().hideAllSkeletons()}},reset:()=>{e().unsubscribeAll(),n(()=>({...hU,pendingOperations:new Set}))},fetchUserTeams:async t=>{if(t){n(r=>{r.isLoadingTeams=!0,r.teamsError=null});try{const r=ua();let s=0;const i=3;let a=null,o=null;for(;s<i;){const c=await r.from("user_teams").select("*, teams(*)").eq("user_id",t).order("joined_at",{ascending:!1});if(a=c.data,o=c.error,o)throw o;if(a&&a.length>0)break;s++,s<i&&(`${s}${i}`,await new Promise(u=>setTimeout(u,1e3)))}const l=a?.map(c=>c.teams).filter(Boolean);n(c=>{c.userTeams=l||[],c.isLoadingTeams=!1})}catch(r){console.error("Error fetching user teams:",r),n(s=>{s.teamsError=r instanceof Error?r.message:"Failed to fetch teams",s.isLoadingTeams=!1})}}},fetchCurrentTeam:async t=>{if(t){n(r=>{r.isLoadingTeams=!0,r.teamsError=null});try{const r=ua();let s=0;const i=3;let a=null,o=null;for(;s<i;){const f=await r.from("user_teams").select("*, teams(*)").eq("user_id",t).eq("active",!0).single();if(a=f.data,o=f.error,a?.teams)break;if(o){const{data:m}=await r.from("user_teams").select("*, teams(*)").eq("user_id",t).order("joined_at",{ascending:!1}).limit(1).single();if(m?.teams){await r.from("user_teams").update({active:!0}).eq("user_id",t).eq("team_id",m.teams.id),a=m,o=null;break}}s++,s<i&&(`${s}${i}`,await new Promise(m=>setTimeout(m,1e3)))}if(!a?.teams){n(f=>{f.currentTeam=null,f.isLoadingTeams=!1});return}const l=a.teams,c=await Ht(`/api/teams/${l.id}`);if(!c.ok)throw new Error("Failed to fetch team details");const u=await c.json();n(f=>{f.currentTeam=u.team,f.isLoadingTeams=!1})}catch(r){console.error("Error fetching current team:",r),n(s=>{s.teamsError=r instanceof Error?r.message:"Failed to fetch team",s.isLoadingTeams=!1})}}},switchTeam:async t=>{const r=ua(),s=`switch-team-${t}`,i=e().currentTeam,a=e().userTeams.find(o=>o.id===t);if(a){n(o=>{o.skeleton.isTransitioning=!0,o.skeleton.showFlaskGrid=!0,o.skeleton.showSidebar=!0,o.currentTeam={...a,members:[],member_count:0},o.pendingOperations.add(s),o.flasks=[],o.tags=[],o.flaskFilter.tagId=null});try{const{data:o}=await r.auth.getUser();if(!o?.user)throw new Error("Not authenticated");await r.from("user_teams").update({active:!1}).eq("user_id",o.user.id);const{error:l}=await r.from("user_teams").update({active:!0}).eq("user_id",o.user.id).eq("team_id",t);if(l)throw l;const c=await Ht(`/api/teams/${t}`);if(!c.ok)throw new Error("Failed to fetch team details");const u=await c.json();await Promise.all([e().fetchFlasks(t),e().fetchTags(t)]),n(f=>{f.currentTeam=u.team,f.pendingOperations.delete(s),f.skeleton.isTransitioning=!1,f.skeleton.showFlaskGrid=!1,f.skeleton.showSidebar=!1}),et.success("Team switched successfully")}catch(o){console.error("Error switching team:",o),n(l=>{l.currentTeam=i,l.pendingOperations.delete(s),l.skeleton.isTransitioning=!1,l.skeleton.showFlaskGrid=!1,l.skeleton.showSidebar=!1}),et.error("Failed to switch team")}}},updateTeamName:async(t,r)=>{const s=`update-team-${t}`,i=e().currentTeam;n(a=>{a.currentTeam&&a.currentTeam.id===t&&(a.currentTeam.name=r);const o=a.userTeams.findIndex(l=>l.id===t);o!==-1&&(a.userTeams[o].name=r),a.pendingOperations.add(s)});try{if(!(await Ht(`/api/teams/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r})})).ok)throw new Error("Failed to update team name");n(o=>{o.pendingOperations.delete(s)}),et.success("Team name updated")}catch(a){console.error("Error updating team name:",a),n(o=>{i&&o.currentTeam?.id===t&&(o.currentTeam.name=i.name),o.pendingOperations.delete(s)}),et.error("Failed to update team name")}},updateInviteEnabled:async(t,r)=>{const s=`update-invite-${t}`,i=e().currentTeam?.invite_enabled;n(a=>{a.currentTeam&&a.currentTeam.id===t&&(a.currentTeam.invite_enabled=r),a.pendingOperations.add(s)});try{if(!(await Ht(`/api/teams/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({invite_enabled:r})})).ok)throw new Error("Failed to update invite settings");n(o=>{o.pendingOperations.delete(s)}),et.success(r?"Invites enabled":"Invites disabled")}catch(a){console.error("Error updating invite settings:",a),n(o=>{o.currentTeam&&o.currentTeam.id===t&&(o.currentTeam.invite_enabled=i||!1),o.pendingOperations.delete(s)}),et.error("Failed to update invite settings")}},removeMember:async(t,r)=>{const s=`remove-member-${r}`;try{n(a=>{a.pendingOperations.add(s)});const i=await Ht(`/api/teams/${t}/members/${r}`,{method:"DELETE"});if(!i.ok){const a=await i.json();throw new Error(a.error||"Failed to remove member")}await e().refreshCurrentTeam(),n(a=>{a.pendingOperations.delete(s)}),et.success("Member removed")}catch(i){console.error("Error removing member:",i),n(a=>{a.pendingOperations.delete(s)}),et.error(i instanceof Error?i.message:"Failed to remove member")}},refreshCurrentTeam:async()=>{const t=e().currentTeam;if(t)try{const r=await Ht(`/api/teams/${t.id}`);if(!r.ok)throw new Error("Failed to refresh team");const s=await r.json();n(i=>{i.currentTeam=s.team})}catch(r){console.error("Error refreshing team:",r)}},setFlasks:t=>{n(r=>{r.flasks=t})},fetchFlasks:async t=>{const r=t||e().currentTeam?.id;if(r){n(s=>{s.isLoadingFlasks=!0,s.flasksError=null,s.isInitialized||(s.skeleton.showFlaskGrid=!0)});try{const s=await Ht(`/api/flasks?teamId=${r}`);if(!s.ok)throw new Error("Failed to fetch flasks");const i=await s.json(),a=Array.from(new Set(i.map(l=>l.user_id).filter(Boolean)));let o={};if(a.length>0)try{o=await PH(a)}catch(l){console.error("Error fetching user profiles:",l)}n(l=>{l.flasks=i||[],l.userProfiles={...l.userProfiles,...o},l.isLoadingFlasks=!1,l.skeleton.showFlaskGrid=!1})}catch(s){console.error("Error fetching flasks:",s),n(i=>{i.flasksError=s instanceof Error?s.message:"Failed to fetch flasks",i.isLoadingFlasks=!1,i.skeleton.showFlaskGrid=!1})}}},createNewFlask:async t=>{try{const r=await aoe(t.userId,t.youtubeUrl,t.name,t.thumbnail,t.assetId,t.muxAssetInfo,t.assetIds);return r&&(n(s=>{s.flasks.unshift(r)}),et.success("Flask created successfully")),r}catch(r){return console.error("Error creating flask:",r),et.error("Failed to create flask"),null}},updateFlaskOptimistic:async(t,r)=>{const s=`update-flask-${t}`,i=e().flasks.find(a=>a.id===t);if(i){n(a=>{const o=a.flasks.findIndex(l=>l.id===t);o!==-1&&Object.assign(a.flasks[o],r),a.pendingOperations.add(s)});try{const a=await FL(t,r);a&&n(o=>{const l=o.flasks.findIndex(c=>c.id===t);l!==-1&&(o.flasks[l]={...a,flask_tag:i.flask_tag}),o.pendingOperations.delete(s)})}catch(a){console.error("Error updating flask:",a),n(o=>{const l=o.flasks.findIndex(c=>c.id===t);l!==-1&&(o.flasks[l]=i),o.pendingOperations.delete(s)}),et.error("Failed to update flask")}}},deleteFlaskOptimistic:async t=>{const r=`delete-flask-${t}`,s=e().flasks;if(s.find(a=>a.id===t)){n(a=>{a.flasks=a.flasks.filter(o=>o.id!==t),a.selectedFlaskIds=a.selectedFlaskIds.filter(o=>o!==t),a.pendingOperations.add(r)});try{if(!await ooe(t))throw new Error("Failed to delete flask");n(o=>{o.pendingOperations.delete(r)}),et.success("Flask deleted successfully")}catch(a){console.error("Error deleting flask:",a),n(o=>{o.flasks=s,o.pendingOperations.delete(r)}),et.error("Failed to delete flask")}}},selectFlask:(t,r=!1)=>{n(s=>{if(r){const i=s.selectedFlaskIds.indexOf(t);i===-1?s.selectedFlaskIds.push(t):s.selectedFlaskIds.splice(i,1)}else s.selectedFlaskIds=[t]})},clearFlaskSelection:()=>{n(t=>{t.selectedFlaskIds=[]})},setFlaskTagFilter:t=>{n(r=>{r.flaskFilter.tagId=t})},setFlaskUserFilter:t=>{n(r=>{r.flaskFilter.userId=t})},setFlaskSearchFilter:t=>{n(r=>{r.flaskFilter.searchTerm=t})},updateFlaskTagOptimistic:async(t,r)=>{const s=`update-flask-tag-${t}`,i=e().flasks.find(o=>o.id===t);if(!i)return;const a=r?e().tags.find(o=>o.id===r):null;n(o=>{const l=o.flasks.findIndex(c=>c.id===t);l!==-1&&(o.flasks[l].flask_tag=a||null),o.pendingOperations.add(s)});try{await uU(t,r),n(o=>{o.pendingOperations.delete(s)})}catch(o){console.error("Error updating flask tag:",o),n(l=>{const c=l.flasks.findIndex(u=>u.id===t);c!==-1&&(l.flasks[c]=i),l.pendingOperations.delete(s)}),et.error("Failed to update tag")}},fetchTags:async t=>{const r=t||e().currentTeam?.id;if(r){n(s=>{s.isLoadingTags=!0,s.tagsError=null,s.isInitialized||(s.skeleton.showSidebar=!0)});try{const s=await doe(r);n(i=>{i.tags=s||[],i.isLoadingTags=!1,i.skeleton.showSidebar=!1})}catch(s){console.error("Error fetching tags:",s),n(i=>{i.tagsError=s instanceof Error?s.message:"Failed to fetch tags",i.isLoadingTags=!1,i.skeleton.showSidebar=!1})}}},createTagOptimistic:async(t,r)=>{const s=`create-tag-${Date.now()}`,i=e().currentTeam?.id;if(!i)return null;const a={id:`temp-${Date.now()}`,name:t,color:e().getNextTagColor(),user_id:"",team_id:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};n(o=>{if(o.tags.push(a),r){const l=o.flasks.findIndex(c=>c.id===r);l!==-1&&(o.flasks[l].flask_tag=a)}o.pendingOperations.add(s)});try{const o=await loe(t,i);if(!o)throw new Error("Failed to create tag");return n(l=>{const c=l.tags.findIndex(u=>u.id===a.id);if(c!==-1&&(l.tags[c]=o),r){const u=l.flasks.findIndex(f=>f.id===r);u!==-1&&(l.flasks[u].flask_tag=o,uU(r,o.id).catch(console.error))}l.pendingOperations.delete(s)}),o}catch(o){return console.error("Error creating tag:",o),n(l=>{if(l.tags=l.tags.filter(c=>c.id!==a.id),r){const c=l.flasks.findIndex(u=>u.id===r);c!==-1&&(l.flasks[c].flask_tag=null)}l.pendingOperations.delete(s)}),et.error("Failed to create tag"),null}},deleteTagOptimistic:async t=>{const r=`delete-tag-${t}`,s=e().tags,i=e().flasks;n(a=>{a.tags=a.tags.filter(o=>o.id!==t),a.flasks.forEach(o=>{o.flask_tag?.id===t&&(o.flask_tag=null)}),a.flaskFilter.tagId===t&&(a.flaskFilter.tagId=null),a.pendingOperations.add(r)});try{await coe(t),n(a=>{a.pendingOperations.delete(r)}),et.success("Tag deleted successfully")}catch(a){console.error("Error deleting tag:",a),n(o=>{o.tags=s,o.flasks=i,o.pendingOperations.delete(r)}),et.error("Failed to delete tag")}},editTagOptimistic:async(t,r)=>{const s=`edit-tag-${t}`,i=e().tags.find(a=>a.id===t);if(i){n(a=>{const o=a.tags.findIndex(l=>l.id===t);o!==-1&&(a.tags[o].name=r),a.flasks.forEach(l=>{l.flask_tag?.id===t&&(l.flask_tag.name=r)}),a.pendingOperations.add(s)});try{const a=await uoe(t,r);a&&n(o=>{const l=o.tags.findIndex(c=>c.id===t);l!==-1&&(o.tags[l]=a),o.flasks.forEach(c=>{c.flask_tag?.id===t&&(c.flask_tag=a)}),o.pendingOperations.delete(s)})}catch(a){console.error("Error editing tag:",a),n(o=>{const l=o.tags.findIndex(c=>c.id===t);l!==-1&&(o.tags[l]=i),o.flasks.forEach(c=>{c.flask_tag?.id===t&&(c.flask_tag=i)}),o.pendingOperations.delete(s)}),et.error("Failed to edit tag")}}},subscribeToChanges:()=>{const t=ua(),r=t.channel("dashboard-flasks").on("postgres_changes",{event:"*",schema:"public",table:"flasks"},a=>{const o=e().currentTeam;o&&e().fetchFlasks(o.id)}).subscribe(),s=t.channel("dashboard-tags").on("postgres_changes",{event:"*",schema:"public",table:"flask_tags"},a=>{const o=e().currentTeam;o&&e().fetchTags(o.id)}).subscribe(),i=t.channel("dashboard-teams").on("postgres_changes",{event:"*",schema:"public",table:"teams"},a=>{const o=e().currentTeam;o&&a.new&&a.new.id===o.id&&e().refreshCurrentTeam()}).subscribe();n(a=>{a.flasksSubscription=r,a.tagsSubscription=s,a.teamsSubscription=i})},unsubscribeAll:()=>{const t=ua(),r=e();r.flasksSubscription&&t.removeChannel(r.flasksSubscription),r.tagsSubscription&&t.removeChannel(r.tagsSubscription),r.teamsSubscription&&t.removeChannel(r.teamsSubscription),n(s=>{s.flasksSubscription=null,s.tagsSubscription=null,s.teamsSubscription=null})},markOperationPending:t=>{n(r=>{r.pendingOperations.add(t)})},markOperationComplete:t=>{n(r=>{r.pendingOperations.delete(t)})},isOperationPending:t=>e().pendingOperations.has(t),updateSkeletonState:t=>{const r=e().skeleton;Object.keys(t).some(i=>r[i]!==t[i])&&n(i=>{Object.assign(i.skeleton,t)})},showAllSkeletons:()=>{const t=e().skeleton;(!t.showFlaskGrid||!t.showSidebar)&&n(r=>{r.skeleton.showFlaskGrid=!0,r.skeleton.showSidebar=!0,r.skeleton.isTransitioning=!1})},hideAllSkeletons:()=>{const t=e().skeleton;(t.showFlaskGrid||t.showSidebar||t.isTransitioning)&&n(s=>{s.skeleton.showFlaskGrid=!1,s.skeleton.showSidebar=!1,s.skeleton.isTransitioning=!1})}})))),zv=n=>{const e=Ft(r=>r.initialize),t=Ft(r=>r.reset);Ft(r=>r.isInitialized),ve.useEffect(()=>{n?e(n):t()},[n,e,t])},fU=15,mU=.1,pU=55,foe=20,zb=70,MH=[{minDuration:0,maxDuration:600,width:3e3},{minDuration:600,maxDuration:900,width:5500},{minDuration:900,maxDuration:1200,width:7e3},{minDuration:1200,maxDuration:1800,width:9e3},{minDuration:1800,maxDuration:1/0,width:11e3}],gU=MH[0].width,OH=8,Pr=280,vU=64,moe=32,poe=48,goe=.25,j1=100,NH=[{label:"Pricing",href:"/#pricing",isExternal:!1},{label:"FAQ",href:"/#faq",isExternal:!1},{label:"Talk to Humans",href:"/#talk-to-us",isExternal:!1}];var Pe=typeof window<"u"?window:void 0,fi=typeof globalThis<"u"?globalThis:Pe,jH=Array.prototype,yU=jH.forEach,bU=jH.indexOf,Mi=fi?.navigator,ft=fi?.document,li=fi?.location,oC=fi?.fetch,lC=fi!=null&&fi.XMLHttpRequest&&"withCredentials"in new fi.XMLHttpRequest?fi.XMLHttpRequest:void 0,xU=fi?.AbortController,si=Mi?.userAgent,Ut=Pe??{},Pl={DEBUG:!1,LIB_VERSION:"1.258.2"},F1="$copy_autocapture",voe=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],Ol=function(n){return n.GZipJS="gzip-js",n.Base64="base64",n}({}),yoe=["fatal","error","warning","log","info","debug"];function on(n,e){return n.indexOf(e)!==-1}var YE=function(n){return n.trim()},cC=function(n){return n.replace(/^\$/,"")},boe=Array.isArray,FH=Object.prototype,UH=FH.hasOwnProperty,XE=FH.toString,zn=boe||function(n){return XE.call(n)==="[object Array]"},ma=n=>typeof n=="function",hr=n=>n===Object(n)&&!zn(n),of=n=>{if(hr(n)){for(var e in n)if(UH.call(n,e))return!1;return!0}return!1},it=n=>n===void 0,fr=n=>XE.call(n)=="[object String]",uC=n=>fr(n)&&n.trim().length===0,uu=n=>n===null,bn=n=>it(n)||uu(n),Is=n=>XE.call(n)=="[object Number]",Do=n=>XE.call(n)==="[object Boolean]",xoe=n=>n instanceof FormData,woe=n=>on(voe,n),$H=n=>{var e={t:function(t){if(Pe&&(Pl.DEBUG||Ut.POSTHOG_DEBUG)&&!it(Pe.console)&&Pe.console){for(var r=("__rrweb_original__"in Pe.console[t])?Pe.console[t].__rrweb_original__:Pe.console[t],s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];r(n,...i)}},info:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e.t("log",...r)},warn:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e.t("warn",...r)},error:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e.t("error",...r)},critical:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];console.error(n,...r)},uninitializedWarning:t=>{e.error("You must initialize PostHog before calling "+t)},createLogger:t=>$H(n+" "+t)};return e},pt=$H("[PostHog.js]"),os=pt.createLogger,Eoe=os("[ExternalScriptsLoader]"),wU=(n,e,t)=>{if(n.config.disable_external_dependency_loading)return Eoe.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var r=ft?.querySelectorAll("script");if(r){for(var s=0;s<r.length;s++)if(r[s].src===e)return t()}var i=()=>{if(!ft)return t("document not found");var a=ft.createElement("script");if(a.type="text/javascript",a.crossOrigin="anonymous",a.src=e,a.onload=c=>t(void 0,c),a.onerror=c=>t(c),n.config.prepare_external_dependency_script&&(a=n.config.prepare_external_dependency_script(a)),!a)return t("prepare_external_dependency_script returned null");var o,l=ft.querySelectorAll("body > script");l.length>0?(o=l[0].parentNode)==null||o.insertBefore(a,l[0]):ft.body.appendChild(a)};ft!=null&&ft.body?i():ft?.addEventListener("DOMContentLoaded",i)};function ut(){return ut=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ut.apply(null,arguments)}function BH(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}Ut.__PosthogExtensions__=Ut.__PosthogExtensions__||{},Ut.__PosthogExtensions__.loadExternalDependency=(n,e,t)=>{var r="/static/"+e+".js?v="+n.version;if(e==="remote-config"&&(r="/array/"+n.config.token+"/config.js"),e==="toolbar"){var s=3e5;r=r+"&t="+Math.floor(Date.now()/s)*s}var i=n.requestRouter.endpointFor("assets",r);wU(n,i,t)},Ut.__PosthogExtensions__.loadSiteApp=(n,e,t)=>{var r=n.requestRouter.endpointFor("api",e);wU(n,r,t)};var Yx={};function qc(n,e,t){if(zn(n)){if(yU&&n.forEach===yU)n.forEach(e,t);else if("length"in n&&n.length===+n.length){for(var r=0,s=n.length;r<s;r++)if(r in n&&e.call(t,n[r],r)===Yx)return}}}function Dn(n,e,t){if(!bn(n)){if(zn(n))return qc(n,e,t);if(xoe(n)){for(var r of n.entries())if(e.call(t,r[1],r[0])===Yx)return}else for(var s in n)if(UH.call(n,s)&&e.call(t,n[s],s)===Yx)return}}var wr=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return qc(t,function(s){for(var i in s)s[i]!==void 0&&(n[i]=s[i])}),n},QE=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return qc(t,function(s){qc(s,function(i){n.push(i)})}),n};function Gb(n){for(var e=Object.keys(n),t=e.length,r=new Array(t);t--;)r[t]=[e[t],n[e[t]]];return r}var EU=function(n){try{return n()}catch{return}},Soe=function(n){return function(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(this,t)}catch(s){pt.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),pt.critical(s)}}},UL=function(n){var e={};return Dn(n,function(t,r){(fr(t)&&t.length>0||Is(t))&&(e[r]=t)}),e};function Toe(n,e){return t=n,r=i=>fr(i)&&!uu(e)?i.slice(0,e):i,s=new Set,function i(a,o){return a!==Object(a)?r?r(a,o):a:s.has(a)?void 0:(s.add(a),zn(a)?(l=[],qc(a,c=>{l.push(i(c))})):(l={},Dn(a,(c,u)=>{s.has(c)||(l[u]=i(c,u))})),l);var l}(t);var t,r,s}var _oe=["herokuapp.com","vercel.app","netlify.app"];function Aoe(n){var e=n?.hostname;if(!fr(e))return!1;var t=e.split(".").slice(-2).join(".");for(var r of _oe)if(t===r)return!1;return!0}function HH(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return n[t]}function rr(n,e,t,r){var{capture:s=!1,passive:i=!0}=r??{};n?.addEventListener(e,t,{capture:s,passive:i})}var VH="$people_distinct_id",Up="__alias",$p="__timers",SU="$autocapture_disabled_server_side",dC="$heatmaps_enabled_server_side",TU="$exception_capture_enabled_server_side",hC="$error_tracking_suppression_rules",_U="$error_tracking_capture_extension_exceptions",AU="$web_vitals_enabled_server_side",zH="$dead_clicks_enabled_server_side",RU="$web_vitals_allowed_metrics",fC="$session_recording_enabled_server_side",CU="$console_log_recording_enabled_server_side",kU="$session_recording_network_payload_capture",IU="$session_recording_masking",LU="$session_recording_canvas_recording",DU="$replay_sample_rate",PU="$replay_minimum_duration",MU="$replay_script_config",Xx="$sesid",Bp="$session_is_sampled",mC="$session_recording_url_trigger_activated_session",pC="$session_recording_event_trigger_activated_session",lf="$enabled_feature_flags",qb="$early_access_features",gC="$feature_flag_details",Hp="$stored_person_properties",Gu="$stored_group_properties",vC="$surveys",Uy="$surveys_activated",Qx="$flag_call_reported",Rl="$user_state",yC="$client_session_props",bC="$capture_rate_limit",xC="$initial_campaign_params",wC="$initial_referrer_info",Zx="$initial_person_info",Jx="$epp",GH="__POSTHOG_TOOLBAR__",$y="$posthog_cookieless",Roe=[VH,Up,"__cmpns",$p,fC,dC,Xx,lf,hC,Rl,qb,gC,Gu,Hp,vC,Qx,yC,bC,xC,wC,Jx,Zx];function OU(n){return n instanceof Element&&(n.id===GH||!(n.closest==null||!n.closest(".toolbar-global-fade-container")))}function ZE(n){return!!n&&n.nodeType===1}function Wc(n,e){return!!n&&!!n.tagName&&n.tagName.toLowerCase()===e.toLowerCase()}function qH(n){return!!n&&n.nodeType===3}function WH(n){return!!n&&n.nodeType===11}function $L(n){return n?YE(n).split(/\s+/):[]}function NU(n){var e=Pe?.location.href;return!!(e&&n&&n.some(t=>e.match(t)))}function ew(n){var e="";switch(typeof n.className){case"string":e=n.className;break;case"object":e=(n.className&&"baseVal"in n.className?n.className.baseVal:null)||n.getAttribute("class")||"";break;default:e=""}return $L(e)}function KH(n){return bn(n)?null:YE(n).split(/(\s+)/).filter(e=>Ff(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function JE(n){var e="";return SC(n)&&!QH(n)&&n.childNodes&&n.childNodes.length&&Dn(n.childNodes,function(t){var r;qH(t)&&t.textContent&&(e+=(r=KH(t.textContent))!==null&&r!==void 0?r:"")}),YE(e)}function YH(n){return it(n.target)?n.srcElement||null:(e=n.target)!=null&&e.shadowRoot?n.composedPath()[0]||null:n.target||null;var e}var EC=["a","button","form","input","select","textarea","label"];function XH(n){var e=n.parentNode;return!(!e||!ZE(e))&&e}function Coe(n,e,t,r,s){var i,a,o;if(t===void 0&&(t=void 0),!Pe||!n||Wc(n,"html")||!ZE(n)||(i=t)!=null&&i.url_allowlist&&!NU(t.url_allowlist)||(a=t)!=null&&a.url_ignorelist&&NU(t.url_ignorelist))return!1;if((o=t)!=null&&o.dom_event_allowlist){var l=t.dom_event_allowlist;if(l&&!l.some(x=>e.type===x))return!1}for(var c=!1,u=[n],f=!0,m=n;m.parentNode&&!Wc(m,"body");)if(WH(m.parentNode))u.push(m.parentNode.host),m=m.parentNode.host;else{if(!(f=XH(m)))break;if(r||EC.indexOf(f.tagName.toLowerCase())>-1)c=!0;else{var g=Pe.getComputedStyle(f);g&&g.getPropertyValue("cursor")==="pointer"&&(c=!0)}u.push(f),m=f}if(!function(x,S){var T=S?.element_allowlist;if(it(T))return!0;var _,R=function(C){if(T.some(L=>C.tagName.toLowerCase()===L))return{v:!0}};for(var I of x)if(_=R(I))return _.v;return!1}(u,t)||!function(x,S){var T=S?.css_selector_allowlist;if(it(T))return!0;var _,R=function(C){if(T.some(L=>C.matches(L)))return{v:!0}};for(var I of x)if(_=R(I))return _.v;return!1}(u,t))return!1;var y=Pe.getComputedStyle(n);if(y&&y.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var b=n.tagName.toLowerCase();switch(b){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return c?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(EC.indexOf(b)>-1||n.getAttribute("contenteditable")==="true")}}function SC(n){for(var e=n;e.parentNode&&!Wc(e,"body");e=e.parentNode){var t=ew(e);if(on(t,"ph-sensitive")||on(t,"ph-no-capture"))return!1}if(on(ew(n),"ph-include"))return!0;var r=n.type||"";if(fr(r))switch(r.toLowerCase()){case"hidden":case"password":return!1}var s=n.name||n.id||"";return!(fr(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function QH(n){return!!(Wc(n,"input")&&!["button","checkbox","submit","reset"].includes(n.type)||Wc(n,"select")||Wc(n,"textarea")||n.getAttribute("contenteditable")==="true")}var ZH="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",koe=new RegExp("^(?:"+ZH+")$"),Ioe=new RegExp(ZH),JH="\\d{3}-?\\d{2}-?\\d{4}",Loe=new RegExp("^("+JH+")$"),Doe=new RegExp("("+JH+")");function Ff(n,e){return e===void 0&&(e=!0),!(bn(n)||fr(n)&&(n=YE(n),(e?koe:Ioe).test((n||"").replace(/[- ]/g,""))||(e?Loe:Doe).test(n)))}function eV(n){var e=JE(n);return Ff(e=(e+" "+tV(n)).trim())?e:""}function tV(n){var e="";return n&&n.childNodes&&n.childNodes.length&&Dn(n.childNodes,function(t){var r;if(t&&((r=t.tagName)==null?void 0:r.toLowerCase())==="span")try{var s=JE(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+tV(t)).trim())}catch(i){pt.error("[AutoCapture]",i)}}),e}function Poe(n){return function(e){var t=e.map(r=>{var s,i,a="";if(r.tag_name&&(a+=r.tag_name),r.attr_class)for(var o of(r.attr_class.sort(),r.attr_class))a+="."+o.replace(/"/g,"");var l=ut({},r.text?{text:r.text}:{},{"nth-child":(s=r.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=r.nth_of_type)!==null&&i!==void 0?i:0},r.href?{href:r.href}:{},r.attr_id?{attr_id:r.attr_id}:{},r.attributes),c={};return Gb(l).sort((u,f)=>{var[m]=u,[g]=f;return m.localeCompare(g)}).forEach(u=>{var[f,m]=u;return c[jU(f.toString())]=jU(m.toString())}),a+=":",a+=Gb(c).map(u=>{var[f,m]=u;return f+'="'+m+'"'}).join("")});return t.join(";")}(function(e){return e.map(t=>{var r,s,i={text:(r=t.$el_text)==null?void 0:r.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:Moe(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Gb(t).filter(a=>{var[o]=a;return o.indexOf("attr__")===0}).forEach(a=>{var[o,l]=a;return i.attributes[o]=l}),i})}(n))}function jU(n){return n.replace(/"|\\"/g,'\\"')}function Moe(n){var e=n.attr__class;return e?zn(e)?e:$L(e):void 0}class nV{constructor(){this.clicks=[]}isRageClick(e,t,r){var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<30&&r-s.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:r}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:r}];return!1}}var Ooe=["localhost","127.0.0.1"],Uf=n=>{var e=ft?.createElement("a");return it(e)?null:(e.href=n,e)},Noe=function(n,e){var t,r;e===void 0&&(e="&");var s=[];return Dn(n,function(i,a){it(i)||it(a)||a==="undefined"||(t=encodeURIComponent((o=>o instanceof File)(i)?i.name:i.toString()),r=encodeURIComponent(a),s[s.length]=r+"="+t)}),s.join(e)},tw=function(n,e){for(var t,r=((n.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<r.length;s++){var i=r[s].split("=");if(i[0]===e){t=i;break}}if(!zn(t)||t.length<2)return"";var a=t[1];try{a=decodeURIComponent(a)}catch{pt.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")},BL=function(n,e,t){if(!n||!e||!e.length)return n;for(var r=n.split("#"),s=r[0]||"",i=r[1],a=s.split("?"),o=a[1],l=a[0],c=(o||"").split("&"),u=[],f=0;f<c.length;f++){var m=c[f].split("=");zn(m)&&(e.includes(m[0])?u.push(m[0]+"="+t):u.push(c[f]))}var g=l;return o!=null&&(g+="?"+u.join("&")),i!=null&&(g+="#"+i),g},nw=function(n,e){var t=n.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},FU=os("[AutoCapture]");function U1(n,e){return e.length>n?e.slice(0,n)+"...":e}function joe(n){if(n.previousElementSibling)return n.previousElementSibling;var e=n;do e=e.previousSibling;while(e&&!ZE(e));return e}function Foe(n,e,t,r){var s=n.tagName.toLowerCase(),i={tag_name:s};EC.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=U1(1024,eV(n)):i.$el_text=U1(1024,JE(n)));var a=ew(n);a.length>0&&(i.classes=a.filter(function(u){return u!==""})),Dn(n.attributes,function(u){var f;if((!QH(n)||["name","id","class","aria-label"].indexOf(u.name)!==-1)&&(r==null||!r.includes(u.name))&&!e&&Ff(u.value)&&(f=u.name,!fr(f)||f.substring(0,10)!=="_ngcontent"&&f.substring(0,7)!=="_nghost")){var m=u.value;u.name==="class"&&(m=$L(m).join(" ")),i["attr__"+u.name]=U1(1024,m)}});for(var o=1,l=1,c=n;c=joe(c);)o++,c.tagName===n.tagName&&l++;return i.nth_child=o,i.nth_of_type=l,i}function Uoe(n,e){for(var t,r,{e:s,maskAllElementAttributes:i,maskAllText:a,elementAttributeIgnoreList:o,elementsChainAsString:l}=e,c=[n],u=n;u.parentNode&&!Wc(u,"body");)WH(u.parentNode)?(c.push(u.parentNode.host),u=u.parentNode.host):(c.push(u.parentNode),u=u.parentNode);var f,m=[],g={},y=!1,b=!1;if(Dn(c,R=>{var I=SC(R);R.tagName.toLowerCase()==="a"&&(y=R.getAttribute("href"),y=I&&y&&Ff(y)&&y),on(ew(R),"ph-no-capture")&&(b=!0),m.push(Foe(R,i,a,o));var C=function(L){if(!SC(L))return{};var k={};return Dn(L.attributes,function(M){if(M.name&&M.name.indexOf("data-ph-capture-attribute")===0){var D=M.name.replace("data-ph-capture-attribute-",""),U=M.value;D&&U&&Ff(U)&&(k[D]=U)}}),k}(R);wr(g,C)}),b)return{props:{},explicitNoCapture:b};if(a||(n.tagName.toLowerCase()==="a"||n.tagName.toLowerCase()==="button"?m[0].$el_text=eV(n):m[0].$el_text=JE(n)),y){var x,S;m[0].attr__href=y;var T=(x=Uf(y))==null?void 0:x.host,_=Pe==null||(S=Pe.location)==null?void 0:S.host;T&&_&&T!==_&&(f=y)}return{props:wr({$event_type:s.type,$ce_version:1},l?{}:{$elements:m},{$elements_chain:Poe(m)},(t=m[0])!=null&&t.$el_text?{$el_text:(r=m[0])==null?void 0:r.$el_text}:{},f&&s.type==="click"?{$external_click_url:f}:{},g)}}class $oe{constructor(e){this.i=!1,this.o=null,this.rageclicks=new nV,this.h=!1,this.instance=e,this.m=null}get S(){var e,t,r=hr(this.instance.config.autocapture)?this.instance.config.autocapture:{};return r.url_allowlist=(e=r.url_allowlist)==null?void 0:e.map(s=>new RegExp(s)),r.url_ignorelist=(t=r.url_ignorelist)==null?void 0:t.map(s=>new RegExp(s)),r}$(){if(this.isBrowserSupported()){if(Pe&&ft){var e=r=>{r=r||Pe?.event;try{this.k(r)}catch(s){FU.error("Failed to capture event",s)}};if(rr(ft,"submit",e,{capture:!0}),rr(ft,"change",e,{capture:!0}),rr(ft,"click",e,{capture:!0}),this.S.capture_copied_text){var t=r=>{r=r||Pe?.event,this.k(r,F1)};rr(ft,"copy",t,{capture:!0}),rr(ft,"cut",t,{capture:!0})}}}else FU.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.i&&(this.$(),this.i=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.h=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[SU]:!!e.autocapture_opt_out}),this.o=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.m=e}getElementSelectors(e){var t,r=[];return(t=this.m)==null||t.forEach(s=>{var i=ft?.querySelectorAll(s);i?.forEach(a=>{e===a&&r.push(s)})}),r}get isEnabled(){var e,t,r=(e=this.instance.persistence)==null?void 0:e.props[SU],s=this.o;if(uu(s)&&!Do(r)&&!this.instance.I())return!1;var i=(t=this.o)!==null&&t!==void 0?t:!!r;return!!this.instance.config.autocapture&&!i}k(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var r,s=YH(e);qH(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(r=this.rageclicks)!=null&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.k(e,"$rageclick");var i=t===F1;if(s&&Coe(s,e,this.S,i,i?["copy","cut"]:void 0)){var{props:a,explicitNoCapture:o}=Uoe(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.S.element_attribute_ignorelist,elementsChainAsString:this.h});if(o)return!1;var l=this.getElementSelectors(s);if(l&&l.length>0&&(a.$element_selectors=l),t===F1){var c,u=KH(Pe==null||(c=Pe.getSelection())==null?void 0:c.toString()),f=e.type||"clipboard";if(!u)return!1;a.$selected_content=u,a.$copy_type=f}return this.instance.capture(t,a),!0}}}isBrowserSupported(){return ma(ft?.querySelectorAll)}}Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)}),Number.isInteger||(Number.isInteger=function(n){return Is(n)&&isFinite(n)&&Math.floor(n)===n});var UU="0123456789abcdef";class rw{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,r,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(s)||e<0||t<0||r<0||s<0||e>0xffffffffffff||t>4095||r>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|r>>>24,i[9]=r>>>16,i[10]=r>>>8,i[11]=r,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new rw(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+UU.charAt(this.bytes[t]>>>4)+UU.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new rw(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var r=this.bytes[t]-e.bytes[t];if(r!==0)return Math.sign(r)}return 0}}class Boe{constructor(){this.P=0,this.R=0,this.T=new Hoe}generate(){var e=this.generateOrAbort();if(it(e)){this.P=0;var t=this.generateOrAbort();if(it(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.P)this.P=e,this.M();else{if(!(e+1e4>this.P))return;this.R++,this.R>4398046511103&&(this.P++,this.M())}return rw.fromFieldsV7(this.P,Math.trunc(this.R/Math.pow(2,30)),this.R&Math.pow(2,30)-1,this.T.nextUint32())}M(){this.R=1024*this.T.nextUint32()+(1023&this.T.nextUint32())}}var $U,rV=n=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<n.length;e++)n[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return n};Pe&&!it(Pe.crypto)&&crypto.getRandomValues&&(rV=n=>crypto.getRandomValues(n));class Hoe{constructor(){this.C=new Uint32Array(8),this.F=1/0}nextUint32(){return this.F>=this.C.length&&(rV(this.C),this.F=0),this.C[this.F++]}}var zc=()=>Voe().toString(),Voe=()=>($U||($U=new Boe)).generate(),xp="",zoe=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Goe(n,e){if(e){var t=function(s,i){if(i===void 0&&(i=ft),xp)return xp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var a=s.split("."),o=Math.min(a.length,8),l="dmn_chk_"+zc();!xp&&o--;){var c=a.slice(o).join("."),u=l+"=1;domain=."+c+";path=/";i.cookie=u+";max-age=3",i.cookie.includes(l)&&(i.cookie=u+";max-age=0",xp=c)}return xp}(n);if(!t){var r=(s=>{var i=s.match(zoe);return i?i[0]:""})(n);r!==t&&pt.info("Warning: cookie subdomain discovery mismatch",r,t),t=r}return t?"; domain=."+t:""}return""}var Fo={O:()=>!!ft,A:function(n){pt.error("cookieStore error: "+n)},D:function(n){if(ft){try{for(var e=n+"=",t=ft.cookie.split(";").filter(i=>i.length),r=0;r<t.length;r++){for(var s=t[r];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},L:function(n){var e;try{e=JSON.parse(Fo.D(n))||{}}catch{}return e},j:function(n,e,t,r,s){if(ft)try{var i="",a="",o=Goe(ft.location.hostname,r);if(t){var l=new Date;l.setTime(l.getTime()+24*t*60*60*1e3),i="; expires="+l.toUTCString()}s&&(a="; secure");var c=n+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+o+a;return c.length>3686.4&&pt.warn("cookieStore warning: large cookie, len="+c.length),ft.cookie=c,c}catch{return}},N:function(n,e){try{Fo.j(n,"",-1,e)}catch{return}}},$1=null,Hr={O:function(){if(!uu($1))return $1;var n=!0;if(it(Pe))n=!1;else try{var e="__mplssupport__";Hr.j(e,"xyz"),Hr.D(e)!=='"xyz"'&&(n=!1),Hr.N(e)}catch{n=!1}return n||pt.error("localStorage unsupported; falling back to cookie store"),$1=n,n},A:function(n){pt.error("localStorage error: "+n)},D:function(n){try{return Pe?.localStorage.getItem(n)}catch(e){Hr.A(e)}return null},L:function(n){try{return JSON.parse(Hr.D(n))||{}}catch{}return null},j:function(n,e){try{Pe?.localStorage.setItem(n,JSON.stringify(e))}catch(t){Hr.A(t)}},N:function(n){try{Pe?.localStorage.removeItem(n)}catch(e){Hr.A(e)}}},qoe=["distinct_id",Xx,Bp,Jx,Zx],By=ut({},Hr,{L:function(n){try{var e={};try{e=Fo.L(n)||{}}catch{}var t=wr(e,JSON.parse(Hr.D(n)||"{}"));return Hr.j(n,t),t}catch{}return null},j:function(n,e,t,r,s,i){try{Hr.j(n,e,void 0,void 0,i);var a={};qoe.forEach(o=>{e[o]&&(a[o]=e[o])}),Object.keys(a).length&&Fo.j(n,a,t,r,s,i)}catch(o){Hr.A(o)}},N:function(n,e){try{Pe?.localStorage.removeItem(n),Fo.N(n,e)}catch(t){Hr.A(t)}}}),Hy={},Woe={O:function(){return!0},A:function(n){pt.error("memoryStorage error: "+n)},D:function(n){return Hy[n]||null},L:function(n){return Hy[n]||null},j:function(n,e){Hy[n]=e},N:function(n){delete Hy[n]}},Nu=null,ms={O:function(){if(!uu(Nu))return Nu;if(Nu=!0,it(Pe))Nu=!1;else try{var n="__support__";ms.j(n,"xyz"),ms.D(n)!=='"xyz"'&&(Nu=!1),ms.N(n)}catch{Nu=!1}return Nu},A:function(n){pt.error("sessionStorage error: ",n)},D:function(n){try{return Pe?.sessionStorage.getItem(n)}catch(e){ms.A(e)}return null},L:function(n){try{return JSON.parse(ms.D(n))||null}catch{}return null},j:function(n,e){try{Pe?.sessionStorage.setItem(n,JSON.stringify(e))}catch(t){ms.A(t)}},N:function(n){try{Pe?.sessionStorage.removeItem(n)}catch(e){ms.A(e)}}},_h=function(n){return n[n.PENDING=-1]="PENDING",n[n.DENIED=0]="DENIED",n[n.GRANTED=1]="GRANTED",n}({});class Koe{constructor(e){this._instance=e}get S(){return this._instance.config}get consent(){return this.U()?_h.DENIED:this.q}isOptedOut(){return this.consent===_h.DENIED||this.consent===_h.PENDING&&this.S.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.B.j(this.H,e?1:0,this.S.cookie_expiration,this.S.cross_subdomain_cookie,this.S.secure_cookie)}reset(){this.B.N(this.H,this.S.cross_subdomain_cookie)}get H(){var{token:e,opt_out_capturing_cookie_prefix:t}=this._instance.config;return(t||"__ph_opt_in_out_")+e}get q(){var e=this.B.D(this.H);return e==="1"?_h.GRANTED:e==="0"?_h.DENIED:_h.PENDING}get B(){if(!this.W){var e=this.S.opt_out_capturing_persistence_type;this.W=e==="localStorage"?Hr:Fo;var t=e==="localStorage"?Fo:Hr;t.D(this.H)&&(this.W.D(this.H)||this.optInOut(t.D(this.H)==="1"),t.N(this.H,this.S.cross_subdomain_cookie))}return this.W}U(){return!!this.S.respect_dnt&&!!HH([Mi?.doNotTrack,Mi?.msDoNotTrack,Ut.doNotTrack],e=>on([!0,1,"1","yes"],e))}}var Vy=os("[Dead Clicks]"),Yoe=()=>!0,Xoe=n=>{var e,t=!((e=n.instance.persistence)==null||!e.get_property(zH)),r=n.instance.config.capture_dead_clicks;return Do(r)?r:t};class sV{get lazyLoadedDeadClicksAutocapture(){return this.G}constructor(e,t,r){this.instance=e,this.isEnabled=t,this.onCapture=r,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[zH]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.J(()=>{this.V()})}J(e){var t,r;(t=Ut.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this.instance,"dead-clicks-autocapture",s=>{s?Vy.error("failed to load script",s):e()})}V(){var e;if(ft){if(!this.G&&(e=Ut.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=hr(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.G=Ut.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.G.start(ft),Vy.info("starting...")}}else Vy.error("`document` not found. Cannot start.")}stop(){this.G&&(this.G.stop(),this.G=void 0,Vy.info("stopping..."))}}function Oi(n,e,t,r,s){return e>t&&(pt.warn("min cannot be greater than max."),e=t),Is(n)?n>t?(r&&pt.warn(r+" cannot be  greater than max: "+t+". Using max value instead."),t):n<e?(r&&pt.warn(r+" cannot be less than min: "+e+". Using min value instead."),e):n:(r&&pt.warn(r+" must be a number. using max or fallback. max: "+t+", fallback: "+s),Oi(s||t,e,t,r))}class iV{constructor(e){this.K={},this.Y=()=>{Object.keys(this.K).forEach(t=>{var r=this.X(t)+this.Z;r>=this.tt?delete this.K[t]:this.it(t,r)})},this.X=t=>this.K[String(t)],this.it=(t,r)=>{this.K[String(t)]=r},this.consumeRateLimit=t=>{var r,s=(r=this.X(t))!==null&&r!==void 0?r:this.tt;if((s=Math.max(s-1,0))===0)return!0;this.it(t,s);var i,a=s===0;return a&&((i=this.et)==null||i.call(this,t)),a},this.rt=e,this.et=this.rt.et,this.tt=Oi(this.rt.bucketSize,0,100,"rate limiter bucket size"),this.Z=Oi(this.rt.refillRate,0,this.tt,"rate limiter refill rate"),this.st=Oi(this.rt.refillInterval,0,864e5,"rate limiter refill interval"),setInterval(()=>{this.Y()},this.st)}}var zy=os("[ExceptionAutocapture]");class Qoe{constructor(e){var t,r,s;this.nt=()=>{var i;if(Pe&&this.isEnabled&&(i=Ut.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var a=Ut.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,o=Ut.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,l=Ut.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.ot&&this.S.capture_unhandled_errors&&(this.ot=a(this.captureException.bind(this))),!this.lt&&this.S.capture_unhandled_rejections&&(this.lt=o(this.captureException.bind(this))),!this.ut&&this.S.capture_console_errors&&(this.ut=l(this.captureException.bind(this)))}catch(c){zy.error("failed to start",c),this.ht()}}},this._instance=e,this.dt=!((t=this._instance.persistence)==null||!t.props[TU]),this.S=this.vt(),this.ct=new iV({refillRate:(r=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&r!==void 0?r:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4}),this.startIfEnabled()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return hr(e)?t=ut({},t,e):(it(e)?this.dt:e)&&(t=ut({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.S.capture_console_errors||this.S.capture_unhandled_errors||this.S.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(zy.info("enabled"),this.J(this.nt))}J(e){var t,r;(t=Ut.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"exception-autocapture",s=>{if(s)return zy.error("failed to load script",s);e()})}ht(){var e,t,r;(e=this.ot)==null||e.call(this),this.ot=void 0,(t=this.lt)==null||t.call(this),this.lt=void 0,(r=this.ut)==null||r.call(this),this.ut=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.dt=!!t||!1,this.S=this.vt(),this._instance.persistence&&this._instance.persistence.register({[TU]:this.dt}),this.startIfEnabled()}captureException(e){var t,r=this._instance.requestRouter.endpointFor("ui");e.$exception_personURL=r+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id();var s=(t=e.$exception_list[0].type)!==null&&t!==void 0?t:"Exception";this.ct.consumeRateLimit(s)?zy.info("Skipping exception capture because of client rate limiting.",{exception:e.$exception_list[0].type}):this._instance.exceptions.sendExceptionEvent(e)}}function aV(n){return!it(Event)&&oV(n,Event)}function oV(n,e){try{return n instanceof e}catch{return!1}}function lV(n){switch(Object.prototype.toString.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return oV(n,Error)}}function Wb(n,e){return Object.prototype.toString.call(n)==="[object "+e+"]"}function B1(n){return Wb(n,"DOMError")}var BU=/\(error: (.*)\)/,HU=50,cf="?";function H1(n,e,t,r){var s={platform:"web:javascript",filename:n,function:e==="<anonymous>"?cf:e,in_app:!0};return it(t)||(s.lineno=t),it(r)||(s.colno=r),s}var Zoe=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Joe=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ele=/\((\S*)(?::(\d+))(?::(\d+))\)/,tle=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,nle=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,rle=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=e.sort((s,i)=>s[0]-i[0]).map(s=>s[1]);return function(s,i){i===void 0&&(i=0);for(var a=[],o=s.split(`
`),l=i;l<o.length;l++){var c=o[l];if(!(c.length>1024)){var u=BU.test(c)?c.replace(BU,"$1"):c;if(!u.match(/\S*Error: /)){for(var f of r){var m=f(u);if(m){a.push(m);break}}if(a.length>=HU)break}}}return function(g){if(!g.length)return[];var y=Array.from(g);return y.reverse(),y.slice(0,HU).map(b=>ut({},b,{filename:b.filename||sle(y).filename,function:b.function||cf}))}(a)}}([30,n=>{var e=Zoe.exec(n);if(e){var[,t,r,s]=e;return H1(t,cf,+r,+s)}var i=Joe.exec(n);if(i){if(i[2]&&i[2].indexOf("eval")===0){var a=ele.exec(i[2]);a&&(i[2]=a[1],i[3]=a[2],i[4]=a[3])}var[o,l]=zU(i[1]||cf,i[2]);return H1(l,o,i[3]?+i[3]:void 0,i[4]?+i[4]:void 0)}}],[50,n=>{var e=tle.exec(n);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var t=nle.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}var r=e[3],s=e[1]||cf;return[s,r]=zU(s,r),H1(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]);function sle(n){return n[n.length-1]||{}}var Gy,VU,V1,zU=(n,e)=>{var t=n.indexOf("safari-extension")!==-1,r=n.indexOf("safari-web-extension")!==-1;return t||r?[n.indexOf("@")!==-1?n.split("@")[0]:cf,t?"safari-extension:"+e:"safari-web-extension:"+e]:[n,e]},ile=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function HL(n,e){e===void 0&&(e=0);var t=n.stacktrace||n.stack||"",r=function(a){return a&&ale.test(a.message)?1:0}(n);try{var s=rle,i=function(a,o){var l=function(c){var u=globalThis._posthogChunkIds;if(!u)return{};var f=Object.keys(u);return V1&&f.length===VU||(VU=f.length,V1=f.reduce((m,g)=>{Gy||(Gy={});var y=Gy[g];if(y)m[y[0]]=y[1];else for(var b=c(g),x=b.length-1;x>=0;x--){var S=b[x],T=S?.filename,_=u[g];if(T&&_){m[T]=_,Gy[g]=[T,_];break}}return m},{})),V1}(o);return a.forEach(c=>{c.filename&&(c.chunk_id=l[c.filename])}),a}(s(t,r),s);return i.slice(0,i.length-e)}catch{}return[]}var ale=/Minified React error #\d+;/i;function ole(n,e){var t,r,s=HL(n),i=(t=e?.handled)===null||t===void 0||t,a=(r=e?.synthetic)!==null&&r!==void 0&&r;return{type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:n.name,value:function(o){var l=o.message;return l.error&&typeof l.error.message=="string"?String(l.error.message):String(l)}(n),stacktrace:{frames:s,type:"raw"},mechanism:{handled:i,synthetic:a}}}function cV(n,e){var t=ole(n,e);return n.cause&&lV(n.cause)&&n.cause!==n?[t,...cV(n.cause,{handled:e?.handled,synthetic:e?.synthetic})]:[t]}function z1(n,e){return{$exception_list:cV(n,e),$exception_level:"error"}}function G1(n,e){var t,r,s,i=(t=e?.handled)===null||t===void 0||t,a=(r=e?.synthetic)===null||r===void 0||r,o={type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:(s=e?.defaultExceptionType)!==null&&s!==void 0?s:"Error",value:n||e?.defaultExceptionMessage,mechanism:{handled:i,synthetic:a}};if(e!=null&&e.syntheticException){var l=HL(e.syntheticException,1);l.length&&(o.stacktrace={frames:l,type:"raw"})}return{$exception_list:[o],$exception_level:"error"}}function lle(n){return fr(n)&&!uC(n)&&yoe.indexOf(n)>=0}function cle(n,e){var t,r,s=(t=e?.handled)===null||t===void 0||t,i=(r=e?.synthetic)===null||r===void 0||r,a=e!=null&&e.overrideExceptionType?e.overrideExceptionType:aV(n)?n.constructor.name:"Error",o="Non-Error 'exception' captured with keys: "+function(u,f){f===void 0&&(f=40);var m=Object.keys(u);if(m.sort(),!m.length)return"[object has no keys]";for(var g=m.length;g>0;g--){var y=m.slice(0,g).join(", ");if(!(y.length>f))return g===m.length||y.length<=f?y:y.slice(0,f)+"..."}return""}(n),l={type:a,value:o,mechanism:{handled:s,synthetic:i}};if(e!=null&&e.syntheticException){var c=HL(e?.syntheticException,1);c.length&&(l.stacktrace={frames:c,type:"raw"})}return{$exception_list:[l],$exception_level:lle(n.level)?n.level:"error"}}function ule(n,e){var{error:t,event:r}=n,s={$exception_list:[]},i=t||r;if(B1(i)||function(m){return Wb(m,"DOMException")}(i)){var a=i;if(function(m){return"stack"in m}(i))s=z1(i,e);else{var o=a.name||(B1(a)?"DOMError":"DOMException"),l=a.message?o+": "+a.message:o;s=G1(l,ut({},e,{overrideExceptionType:B1(a)?"DOMError":"DOMException",defaultExceptionMessage:l}))}return"code"in a&&(s.$exception_DOMException_code=""+a.code),s}if(function(m){return Wb(m,"ErrorEvent")}(i)&&i.error)return z1(i.error,e);if(lV(i))return z1(i,e);if(function(m){return Wb(m,"Object")}(i)||aV(i))return cle(i,e);if(it(t)&&fr(r)){var c="Error",u=r,f=r.match(ile);return f&&(c=f[1],u=f[2]),G1(u,ut({},e,{overrideExceptionType:c,defaultExceptionMessage:u}))}return G1(i,e)}function GU(n,e,t){try{if(!(e in n))return()=>{};var r=n[e],s=t(r);return ma(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),n[e]=s,()=>{n[e]=r}}catch{return()=>{}}}class dle{constructor(e){var t;this._instance=e,this.ft=(Pe==null||(t=Pe.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(pt.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this._t&&this._t(),this._t=void 0,pt.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(Pe&&Pe.history){var r=this;(e=Pe.history.pushState)!=null&&e.__posthog_wrapped__||GU(Pe.history,"pushState",s=>function(i,a,o){s.call(this,i,a,o),r.gt("pushState")}),(t=Pe.history.replaceState)!=null&&t.__posthog_wrapped__||GU(Pe.history,"replaceState",s=>function(i,a,o){s.call(this,i,a,o),r.gt("replaceState")}),this.bt()}}gt(e){try{var t,r=Pe==null||(t=Pe.location)==null?void 0:t.pathname;if(!r)return;r!==this.ft&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ft=r}catch(s){pt.error("Error capturing "+e+" pageview",s)}}bt(){if(!this._t){var e=()=>{this.gt("popstate")};rr(Pe,"popstate",e),this._t=()=>{Pe&&Pe.removeEventListener("popstate",e)}}}}function sw(n){var e,t;return((e=JSON.stringify(n,(t=[],function(r,s){if(hr(s)){for(;t.length>0&&t[t.length-1]!==this;)t.pop();return t.includes(s)?"[Circular]":(t.push(s),s)}return s})))==null?void 0:e.length)||0}function TC(n,e){if(e===void 0&&(e=66060288e-1),n.size>=e&&n.data.length>1){var t=Math.floor(n.data.length/2),r=n.data.slice(0,t),s=n.data.slice(t);return[TC({size:sw(r),data:r,sessionId:n.sessionId,windowId:n.windowId}),TC({size:sw(s),data:s,sessionId:n.sessionId,windowId:n.windowId})].flatMap(i=>i)}return[n]}var Cl=(n=>(n[n.DomContentLoaded=0]="DomContentLoaded",n[n.Load=1]="Load",n[n.FullSnapshot=2]="FullSnapshot",n[n.IncrementalSnapshot=3]="IncrementalSnapshot",n[n.Meta=4]="Meta",n[n.Custom=5]="Custom",n[n.Plugin=6]="Plugin",n))(Cl||{}),Na=(n=>(n[n.Mutation=0]="Mutation",n[n.MouseMove=1]="MouseMove",n[n.MouseInteraction=2]="MouseInteraction",n[n.Scroll=3]="Scroll",n[n.ViewportResize=4]="ViewportResize",n[n.Input=5]="Input",n[n.TouchMove=6]="TouchMove",n[n.MediaInteraction=7]="MediaInteraction",n[n.StyleSheetRule=8]="StyleSheetRule",n[n.CanvasMutation=9]="CanvasMutation",n[n.Font=10]="Font",n[n.Log=11]="Log",n[n.Drag=12]="Drag",n[n.StyleDeclaration=13]="StyleDeclaration",n[n.Selection=14]="Selection",n[n.AdoptedStyleSheet=15]="AdoptedStyleSheet",n[n.CustomElement=16]="CustomElement",n))(Na||{}),_C="[SessionRecording]",AC="redacted",qy={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:n=>n,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},hle=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],fle=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],mle=["/s/","/e/","/i/"];function qU(n,e,t,r){if(bn(n))return n;var s=e?.["content-length"]||function(i){return new Blob([i]).size}(n);return fr(s)&&(s=parseInt(s)),s>t?_C+" "+r+" body too large to record ("+s+" bytes)":n}function WU(n,e){if(bn(n))return n;var t=n;return Ff(t,!1)||(t=_C+" "+e+" body "+AC),Dn(fle,r=>{var s,i;(s=t)!=null&&s.length&&((i=t)==null?void 0:i.indexOf(r))!==-1&&(t=_C+" "+e+" body "+AC+" as might contain: "+r)}),t}var ple=(n,e)=>{var t,r,s,i={payloadSizeLimitBytes:qy.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...qy.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...qy.payloadHostDenyList]},a=n.session_recording.recordHeaders!==!1&&e.recordHeaders,o=n.session_recording.recordBody!==!1&&e.recordBody,l=n.capture_performance!==!1&&e.recordPerformance,c=(t=i,s=Math.min(1e6,(r=t.payloadSizeLimitBytes)!==null&&r!==void 0?r:1e6),m=>(m!=null&&m.requestBody&&(m.requestBody=qU(m.requestBody,m.requestHeaders,s,"Request")),m!=null&&m.responseBody&&(m.responseBody=qU(m.responseBody,m.responseHeaders,s,"Response")),m)),u=m=>{return c(((b,x)=>{var S,T=Uf(b.name),_=x.indexOf("http")===0?(S=Uf(x))==null?void 0:S.pathname:x;_==="/"&&(_="");var R=T?.pathname.replace(_||"","");if(!(T&&R&&mle.some(I=>R.indexOf(I)===0)))return b})((y=(g=m).requestHeaders,bn(y)||Dn(Object.keys(y??{}),b=>{hle.includes(b.toLowerCase())&&(y[b]=AC)}),g),n.api_host));var g,y},f=ma(n.session_recording.maskNetworkRequestFn);return f&&ma(n.session_recording.maskCapturedNetworkRequestFn)&&pt.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),f&&(n.session_recording.maskCapturedNetworkRequestFn=m=>{var g=n.session_recording.maskNetworkRequestFn({url:m.name});return ut({},m,{name:g?.url})}),i.maskRequestFn=ma(n.session_recording.maskCapturedNetworkRequestFn)?m=>{var g,y=u(m);return y&&(g=n.session_recording.maskCapturedNetworkRequestFn==null?void 0:n.session_recording.maskCapturedNetworkRequestFn(y))!==null&&g!==void 0?g:void 0}:m=>function(g){if(!it(g))return g.requestBody=WU(g.requestBody,"Request"),g.responseBody=WU(g.responseBody,"Response"),g}(u(m)),ut({},qy,i,{recordHeaders:a,recordBody:o,recordPerformance:l,recordInitialRequests:l})};let gle=class{constructor(e,t){var r,s;t===void 0&&(t={}),this.yt={},this.wt=i=>{if(!this.yt[i]){var a,o;this.yt[i]=!0;var l=this.St(i);(a=(o=this.rt).onBlockedNode)==null||a.call(o,i,l)}},this.$t=i=>{var a=this.St(i);if(a?.nodeName!=="svg"&&a instanceof Element){var o=a.closest("svg");if(o)return[this._rrweb.mirror.getId(o),o]}return[i,a]},this.St=i=>this._rrweb.mirror.getNode(i),this.xt=i=>{var a,o,l,c,u,f,m,g;return((a=(o=i.removes)==null?void 0:o.length)!==null&&a!==void 0?a:0)+((l=(c=i.attributes)==null?void 0:c.length)!==null&&l!==void 0?l:0)+((u=(f=i.texts)==null?void 0:f.length)!==null&&u!==void 0?u:0)+((m=(g=i.adds)==null?void 0:g.length)!==null&&m!==void 0?m:0)},this.throttleMutations=i=>{if(i.type!==3||i.data.source!==0)return i;var a=i.data,o=this.xt(a);a.attributes&&(a.attributes=a.attributes.filter(c=>{var[u]=this.$t(c.id);return!this.ct.consumeRateLimit(u)&&c}));var l=this.xt(a);return l!==0||o===l?i:void 0},this._rrweb=e,this.rt=t,this.ct=new iV({bucketSize:(r=this.rt.bucketSize)!==null&&r!==void 0?r:100,refillRate:(s=this.rt.refillRate)!==null&&s!==void 0?s:10,refillInterval:1e3,et:this.wt})}};var pa=Uint8Array,mi=Uint16Array,$f=Uint32Array,VL=new pa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zL=new pa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KU=new pa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),uV=function(n,e){for(var t=new mi(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];var s=new $f(t[30]);for(r=1;r<30;++r)for(var i=t[r];i<t[r+1];++i)s[i]=i-t[r]<<5|r;return[t,s]},dV=uV(VL,2),vle=dV[0],RC=dV[1];vle[28]=258,RC[258]=28;for(var YU=uV(zL,0)[1],hV=new mi(32768),Gn=0;Gn<32768;++Gn){var ju=(43690&Gn)>>>1|(21845&Gn)<<1;ju=(61680&(ju=(52428&ju)>>>2|(13107&ju)<<2))>>>4|(3855&ju)<<4,hV[Gn]=((65280&ju)>>>8|(255&ju)<<8)>>>1}var fg=function(n,e,t){for(var r=n.length,s=0,i=new mi(e);s<r;++s)++i[n[s]-1];var a,o=new mi(e);for(s=0;s<e;++s)o[s]=o[s-1]+i[s-1]<<1;for(a=new mi(r),s=0;s<r;++s)a[s]=hV[o[n[s]-1]++]>>>15-n[s];return a},gd=new pa(288);for(Gn=0;Gn<144;++Gn)gd[Gn]=8;for(Gn=144;Gn<256;++Gn)gd[Gn]=9;for(Gn=256;Gn<280;++Gn)gd[Gn]=7;for(Gn=280;Gn<288;++Gn)gd[Gn]=8;var iw=new pa(32);for(Gn=0;Gn<32;++Gn)iw[Gn]=5;var yle=fg(gd,9),ble=fg(iw,5),fV=function(n){return(n/8>>0)+(7&n&&1)},mV=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof mi?mi:n instanceof $f?$f:pa)(t-e);return r.set(n.subarray(e,t)),r},fl=function(n,e,t){t<<=7&e;var r=e/8>>0;n[r]|=t,n[r+1]|=t>>>8},wp=function(n,e,t){t<<=7&e;var r=e/8>>0;n[r]|=t,n[r+1]|=t>>>8,n[r+2]|=t>>>16},q1=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var s=t.length,i=t.slice();if(!s)return[new pa(0),0];if(s==1){var a=new pa(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(I,C){return I.f-C.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,u=1,f=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=s-1;)o=t[t[c].f<t[f].f?c++:f++],l=t[c!=u&&t[c].f<t[f].f?c++:f++],t[u++]={s:-1,f:o.f+l.f,l:o,r:l};var m=i[0].s;for(r=1;r<s;++r)i[r].s>m&&(m=i[r].s);var g=new mi(m+1),y=CC(t[u-1],g,0);if(y>e){r=0;var b=0,x=y-e,S=1<<x;for(i.sort(function(I,C){return g[C.s]-g[I.s]||I.f-C.f});r<s;++r){var T=i[r].s;if(!(g[T]>e))break;b+=S-(1<<y-g[T]),g[T]=e}for(b>>>=x;b>0;){var _=i[r].s;g[_]<e?b-=1<<e-g[_]++-1:++r}for(;r>=0&&b;--r){var R=i[r].s;g[R]==e&&(--g[R],++b)}y=e}return[new pa(g),y]},CC=function(n,e,t){return n.s==-1?Math.max(CC(n.l,e,t+1),CC(n.r,e,t+1)):e[n.s]=t},XU=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new mi(++e),r=0,s=n[0],i=1,a=function(l){t[r++]=l},o=1;o<=e;++o)if(n[o]==s&&o!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=n[o]}return[t.subarray(0,r),e]},Ep=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},kC=function(n,e,t){var r=t.length,s=fV(e+2);n[s]=255&r,n[s+1]=r>>>8,n[s+2]=255^n[s],n[s+3]=255^n[s+1];for(var i=0;i<r;++i)n[s+i+4]=t[i];return 8*(s+4+r)},QU=function(n,e,t,r,s,i,a,o,l,c,u){fl(e,u++,t),++s[256];for(var f=q1(s,15),m=f[0],g=f[1],y=q1(i,15),b=y[0],x=y[1],S=XU(m),T=S[0],_=S[1],R=XU(b),I=R[0],C=R[1],L=new mi(19),k=0;k<T.length;++k)L[31&T[k]]++;for(k=0;k<I.length;++k)L[31&I[k]]++;for(var M=q1(L,7),D=M[0],U=M[1],$=19;$>4&&!D[KU[$-1]];--$);var V,B,W,F,j=c+5<<3,q=Ep(s,gd)+Ep(i,iw)+a,H=Ep(s,m)+Ep(i,b)+a+14+3*$+Ep(L,D)+(2*L[16]+3*L[17]+7*L[18]);if(j<=q&&j<=H)return kC(e,u,n.subarray(l,l+c));if(fl(e,u,1+(H<q)),u+=2,H<q){V=fg(m,g),B=m,W=fg(b,x),F=b;var N=fg(D,U);for(fl(e,u,_-257),fl(e,u+5,C-1),fl(e,u+10,$-4),u+=14,k=0;k<$;++k)fl(e,u+3*k,D[KU[k]]);u+=3*$;for(var O=[T,I],z=0;z<2;++z){var G=O[z];for(k=0;k<G.length;++k){var Y=31&G[k];fl(e,u,N[Y]),u+=D[Y],Y>15&&(fl(e,u,G[k]>>>5&127),u+=G[k]>>>12)}}}else V=yle,B=gd,W=ble,F=iw;for(k=0;k<o;++k)if(r[k]>255){Y=r[k]>>>18&31,wp(e,u,V[Y+257]),u+=B[Y+257],Y>7&&(fl(e,u,r[k]>>>23&31),u+=VL[Y]);var Q=31&r[k];wp(e,u,W[Q]),u+=F[Q],Q>3&&(wp(e,u,r[k]>>>5&8191),u+=zL[Q])}else wp(e,u,V[r[k]]),u+=B[r[k]];return wp(e,u,V[256]),u+B[256]},xle=new $f([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wle=function(){for(var n=new $f(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(1&t&&3988292384)^t>>>1;n[e]=t}return n}(),Ele=function(){var n=4294967295;return{p:function(e){for(var t=n,r=0;r<e.length;++r)t=wle[255&t^e[r]]^t>>>8;n=t},d:function(){return 4294967295^n}}},Sle=function(n,e,t,r,s){return function(i,a,o,l,c,u){var f=i.length,m=new pa(l+f+5*(1+Math.floor(f/7e3))+c),g=m.subarray(l,m.length-c),y=0;if(!a||f<8)for(var b=0;b<=f;b+=65535){var x=b+65535;x<f?y=kC(g,y,i.subarray(b,x)):(g[b]=u,y=kC(g,y,i.subarray(b,f)))}else{for(var S=xle[a-1],T=S>>>13,_=8191&S,R=(1<<o)-1,I=new mi(32768),C=new mi(R+1),L=Math.ceil(o/3),k=2*L,M=function(ie){return(i[ie]^i[ie+1]<<L^i[ie+2]<<k)&R},D=new $f(25e3),U=new mi(288),$=new mi(32),V=0,B=0,W=(b=0,0),F=0,j=0;b<f;++b){var q=M(b),H=32767&b,N=C[q];if(I[H]=N,C[q]=H,F<=b){var O=f-b;if((V>7e3||W>24576)&&O>423){y=QU(i,g,0,D,U,$,B,W,j,b-j,y),W=V=B=0,j=b;for(var z=0;z<286;++z)U[z]=0;for(z=0;z<30;++z)$[z]=0}var G=2,Y=0,Q=_,J=H-N&32767;if(O>2&&q==M(b-J))for(var ee=Math.min(T,O)-1,oe=Math.min(32767,b),te=Math.min(258,O);J<=oe&&--Q&&H!=N;){if(i[b+G]==i[b+G-J]){for(var se=0;se<te&&i[b+se]==i[b+se-J];++se);if(se>G){if(G=se,Y=J,se>ee)break;var he=Math.min(J,se-2),Z=0;for(z=0;z<he;++z){var pe=b-J+z+32768&32767,ye=pe-I[pe]+32768&32767;ye>Z&&(Z=ye,N=pe)}}}J+=(H=N)-(N=I[H])+32768&32767}if(Y){D[W++]=268435456|RC[G]<<18|YU[Y];var ae=31&RC[G],le=31&YU[Y];B+=VL[ae]+zL[le],++U[257+ae],++$[le],F=b+G,++V}else D[W++]=i[b],++U[i[b]]}}y=QU(i,g,u,D,U,$,B,W,j,b-j,y)}return mV(m,0,l+fV(y)+c)}(n,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):12+e.mem,t,r,!0)},IC=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},Tle=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:e.level==9?2:0,n[9]=3,e.mtime!=0&&IC(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var r=0;r<=t.length;++r)n[r+10]=t.charCodeAt(r)}},_le=function(n){return 10+(n.filename&&n.filename.length+1||0)};function pV(n,e){e===void 0&&(e={});var t=Ele(),r=n.length;t.p(n);var s=Sle(n,e,_le(e),8),i=s.length;return Tle(s,e),IC(s,i-8,t.d()),IC(s,i-4,r),s}function gV(n,e){var t=n.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(n);for(var r=new pa(n.length+(n.length>>>1)),s=0,i=function(c){r[s++]=c},a=0;a<t;++a){if(s+5>r.length){var o=new pa(s+8+(t-a<<1));o.set(r),r=o}var l=n.charCodeAt(a);l<128||e?i(l):l<2048?(i(192|l>>>6),i(128|63&l)):l>55295&&l<57344?(i(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++a))>>>18),i(128|l>>>12&63),i(128|l>>>6&63),i(128|63&l)):(i(224|l>>>12),i(128|l>>>6&63),i(128|63&l))}return mV(r,0,s)}function Ale(n,e){return function(t){for(var r=0,s=0;s<t.length;s++)r=(r<<5)-r+t.charCodeAt(s),r|=0;return Math.abs(r)}(n)%100<Oi(100*e,0,100)}var Zc="disabled",GL="sampled",aw="active",vd="buffering",qL="paused",WL="trigger",Uo=WL+"_activated",Ps=WL+"_pending",qo=WL+"_"+Zc;function ZU(n,e){return e.some(t=>t.matching==="regex"&&new RegExp(t.url).test(n))}class vV{constructor(e){this.kt=e}triggerStatus(e){var t=this.kt.map(r=>r.triggerStatus(e));return t.includes(Uo)?Uo:t.includes(Ps)?Ps:qo}stop(){this.kt.forEach(e=>e.stop())}}class yV{constructor(e){this.kt=e}triggerStatus(e){var t=new Set;for(var r of this.kt)t.add(r.triggerStatus(e));switch(t.delete(qo),t.size){case 0:return qo;case 1:return Array.from(t)[0];default:return Ps}}stop(){this.kt.forEach(e=>e.stop())}}class Rle{triggerStatus(){return Ps}stop(){}}class Cle{constructor(e){this.Et=[],this.It=[],this.urlBlocked=!1,this._instance=e}onRemoteConfig(e){var t,r;this.Et=((t=e.sessionRecording)==null?void 0:t.urlTriggers)||[],this.It=((r=e.sessionRecording)==null?void 0:r.urlBlocklist)||[]}Pt(e){var t;return this.Et.length===0?qo:((t=this._instance)==null?void 0:t.get_property(mC))===e?Uo:Ps}triggerStatus(e){var t=this.Pt(e),r=t===Uo?Uo:t===Ps?Ps:qo;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:r}),r}checkUrlTriggerConditions(e,t,r){if(Pe!==void 0&&Pe.location.href){var s=Pe.location.href,i=this.urlBlocked,a=ZU(s,this.It);i&&a||(a&&!i?e():!a&&i&&t(),ZU(s,this.Et)&&r("url"))}}stop(){}}let kle=class{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this.Rt=()=>{},this._instance=e}triggerStatus(){var e=Ps;return bn(this.linkedFlag)&&(e=qo),this.linkedFlagSeen&&(e=Uo),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onRemoteConfig(e,t){var r;if(this.linkedFlag=((r=e.sessionRecording)==null?void 0:r.linkedFlag)||null,!bn(this.linkedFlag)&&!this.linkedFlagSeen){var s=fr(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,i=fr(this.linkedFlag)?null:this.linkedFlag.variant;this.Rt=this._instance.onFeatureFlags((a,o)=>{var l=!1;if(hr(o)&&s in o){var c=o[s];l=Do(c)?c===!0:i?c===i:!!c}this.linkedFlagSeen=l,l&&t(s,i)})}}stop(){this.Rt()}};class Ile{constructor(e){this.Tt=[],this._instance=e}onRemoteConfig(e){var t;this.Tt=((t=e.sessionRecording)==null?void 0:t.eventTriggers)||[]}Mt(e){var t;return this.Tt.length===0?qo:((t=this._instance)==null?void 0:t.get_property(pC))===e?Uo:Ps}triggerStatus(e){var t=this.Mt(e),r=t===Uo?Uo:t===Ps?Ps:qo;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:r}),r}stop(){}}function Lle(n){return n.isRecordingEnabled?vd:Zc}function Dle(n){if(!n.receivedFlags)return vd;if(!n.isRecordingEnabled)return Zc;if(n.urlTriggerMatching.urlBlocked)return qL;var e=n.isSampled===!0,t=new vV([n.eventTriggerMatching,n.urlTriggerMatching,n.linkedFlagMatching]).triggerStatus(n.sessionId);return e?GL:t===Uo?aw:t===Ps?vd:n.isSampled===!1?Zc:aw}function Ple(n){if(!n.receivedFlags)return vd;if(!n.isRecordingEnabled)return Zc;if(n.urlTriggerMatching.urlBlocked)return qL;var e=new yV([n.eventTriggerMatching,n.urlTriggerMatching,n.linkedFlagMatching]).triggerStatus(n.sessionId),t=e!==qo,r=Do(n.isSampled);return t&&e===Ps?vd:t&&e===qo||r&&!n.isSampled?Zc:n.isSampled===!0?GL:aw}var Vp="[SessionRecording]",Es=os(Vp);function Wy(){var n;return Ut==null||(n=Ut.__PosthogExtensions__)==null||(n=n.rrweb)==null?void 0:n.record}var Mle=3e5,Ole=[Na.MouseMove,Na.MouseInteraction,Na.Scroll,Na.ViewportResize,Na.Input,Na.TouchMove,Na.MediaInteraction,Na.Drag],JU=n=>({rrwebMethod:n,enqueuedAt:Date.now(),attempt:1});function Fu(n){return function(e,t){for(var r="",s=0;s<e.length;){var i=e[s++];r+=String.fromCharCode(i)}return r}(pV(gV(JSON.stringify(n))))}function e3(n){return n.type===Cl.Custom&&n.data.tag==="sessionIdle"}class Nle{get sessionId(){return this.Ct}get Ft(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Ot}get At(){if(!this._instance.sessionManager)throw new Error(Vp+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Dt(){var e,t;return this.Lt.triggerStatus(this.sessionId)===Ps?6e4:(e=(t=this._instance.config.session_recording)==null?void 0:t.full_snapshot_interval_millis)!==null&&e!==void 0?e:Mle}get jt(){var e=this._instance.get_property(Bp);return Do(e)?e:null}get Nt(){var e,t,r=(e=this.C)==null?void 0:e.data[((t=this.C)==null?void 0:t.data.length)-1],{sessionStartTimestamp:s}=this.At.checkAndGetSessionAndWindowId(!0);return r?r.timestamp-s:null}get zt(){var e=!!this._instance.get_property(fC),t=!this._instance.config.disable_session_recording;return Pe&&e&&t}get Ut(){var e=!!this._instance.get_property(CU),t=this._instance.config.enable_recording_console_log;return t??e}get qt(){var e,t,r,s,i,a,o=this._instance.config.session_recording.captureCanvas,l=this._instance.get_property(LU),c=(e=(t=o?.recordCanvas)!==null&&t!==void 0?t:l?.enabled)!==null&&e!==void 0&&e,u=(r=(s=o?.canvasFps)!==null&&s!==void 0?s:l?.fps)!==null&&r!==void 0?r:4,f=(i=(a=o?.canvasQuality)!==null&&a!==void 0?a:l?.quality)!==null&&i!==void 0?i:.4;if(typeof f=="string"){var m=parseFloat(f);f=isNaN(m)?.4:m}return{enabled:c,fps:Oi(u,0,12,"canvas recording fps",4),quality:Oi(f,0,1,"canvas recording quality",.4)}}get Bt(){var e,t,r=this._instance.get_property(kU),s={recordHeaders:(e=this._instance.config.session_recording)==null?void 0:e.recordHeaders,recordBody:(t=this._instance.config.session_recording)==null?void 0:t.recordBody},i=s?.recordHeaders||r?.recordHeaders,a=s?.recordBody||r?.recordBody,o=hr(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,l=!!(Do(o)?o:r?.capturePerformance);return i||a||l?{recordHeaders:i,recordBody:a,recordPerformance:l}:void 0}get Ht(){var e,t,r,s,i,a,o=this._instance.get_property(IU),l={maskAllInputs:(e=this._instance.config.session_recording)==null?void 0:e.maskAllInputs,maskTextSelector:(t=this._instance.config.session_recording)==null?void 0:t.maskTextSelector,blockSelector:(r=this._instance.config.session_recording)==null?void 0:r.blockSelector},c=(s=l?.maskAllInputs)!==null&&s!==void 0?s:o?.maskAllInputs,u=(i=l?.maskTextSelector)!==null&&i!==void 0?i:o?.maskTextSelector,f=(a=l?.blockSelector)!==null&&a!==void 0?a:o?.blockSelector;return it(c)&&it(u)&&it(f)?void 0:{maskAllInputs:c==null||c,maskTextSelector:u,blockSelector:f}}get Wt(){var e=this._instance.get_property(DU);return Is(e)?e:null}get Gt(){var e=this._instance.get_property(PU);return Is(e)?e:null}get status(){return this.Jt?this.Vt({receivedFlags:this.Jt,isRecordingEnabled:this.zt,isSampled:this.jt,urlTriggerMatching:this.Kt,eventTriggerMatching:this.Yt,linkedFlagMatching:this.Xt,sessionId:this.sessionId}):vd}constructor(e){if(this.Vt=Lle,this.Jt=!1,this.Qt=[],this.Zt="unknown",this.ti=Date.now(),this.Lt=new Rle,this.ii=void 0,this.ei=void 0,this.ri=void 0,this.si=void 0,this.ni=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.oi=()=>{this.ai()},this.li=()=>{this.ui("browser offline",{})},this.hi=()=>{this.ui("browser online",{})},this.di=()=>{if(ft!=null&&ft.visibilityState){var s="window "+ft.visibilityState;this.ui(s,{})}},this._instance=e,this.Ot=!1,this.vi="/s/",this.ci=void 0,this.Jt=!1,!this._instance.sessionManager)throw Es.error("started without valid sessionManager"),new Error(Vp+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw new Error(Vp+" cannot be used with __preview_experimental_cookieless_mode.");this.Xt=new kle(this._instance),this.Kt=new Cle(this._instance),this.Yt=new Ile(this._instance);var{sessionId:t,windowId:r}=this.At.checkAndGetSessionAndWindowId();this.Ct=t,this.fi=r,this.C=this.pi(),this.Ft>=this.At.sessionTimeoutMs&&Es.warn("session_idle_threshold_ms ("+this.Ft+") is greater than the session timeout ("+this.At.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this.zt?(this.gi(e),rr(Pe,"beforeunload",this.oi),rr(Pe,"offline",this.li),rr(Pe,"online",this.hi),rr(Pe,"visibilitychange",this.di),this.mi(),this.bi(),bn(this.ii)&&(this.ii=this._instance.on("eventCaptured",t=>{try{if(t.event==="$pageview"){var r=t!=null&&t.properties.$current_url?this.yi(t?.properties.$current_url):"";if(!r)return;this.ui("$pageview",{href:r})}}catch(s){Es.error("Could not add $pageview to rrweb session",s)}})),this.ei||(this.ei=this.At.onSessionId((t,r,s)=>{var i,a;s&&(this.ui("$session_id_change",{sessionId:t,windowId:r,changeReason:s}),(i=this._instance)==null||(i=i.persistence)==null||i.unregister(pC),(a=this._instance)==null||(a=a.persistence)==null||a.unregister(mC))}))):this.stopRecording()}stopRecording(){var e,t,r,s;this.Ot&&this.ci&&(this.ci(),this.ci=void 0,this.Ot=!1,Pe?.removeEventListener("beforeunload",this.oi),Pe?.removeEventListener("offline",this.li),Pe?.removeEventListener("online",this.hi),Pe?.removeEventListener("visibilitychange",this.di),this.pi(),clearInterval(this.wi),(e=this.ii)==null||e.call(this),this.ii=void 0,(t=this.ni)==null||t.call(this),this.ni=void 0,(r=this.ei)==null||r.call(this),this.ei=void 0,(s=this.si)==null||s.call(this),this.si=void 0,this.Yt.stop(),this.Kt.stop(),this.Xt.stop(),Es.info("stopped"))}Si(){var e;(e=this._instance.persistence)==null||e.unregister(Bp)}$i(e){var t,r=this.Ct!==e,s=this.Wt;if(Is(s)){var i=this.jt,a=r||!Do(i),o=a?Ale(e,s):i;a&&(o?this.xi(GL):Es.warn("Sample rate ("+s+") has determined that this sessionId ("+e+") will not be sent to the server."),this.ui("samplingDecisionMade",{sampleRate:s,isSampled:o})),(t=this._instance.persistence)==null||t.register({[Bp]:o})}else this.Si()}onRemoteConfig(e){var t,r,s,i;this.ui("$remote_config_received",e),this.ki(e),(t=e.sessionRecording)!=null&&t.endpoint&&(this.vi=(i=e.sessionRecording)==null?void 0:i.endpoint),this.mi(),((r=e.sessionRecording)==null?void 0:r.triggerMatchType)==="any"?(this.Vt=Dle,this.Lt=new vV([this.Yt,this.Kt])):(this.Vt=Ple,this.Lt=new yV([this.Yt,this.Kt])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:(s=e.sessionRecording)==null?void 0:s.triggerMatchType}),this.Kt.onRemoteConfig(e),this.Yt.onRemoteConfig(e),this.Xt.onRemoteConfig(e,(a,o)=>{this.xi("linked_flag_matched",{flag:a,variant:o})}),this.Jt=!0,this.startIfEnabledOrStop()}mi(){Is(this.Wt)&&bn(this.si)&&(this.si=this.At.onSessionId(e=>{this.$i(e)}))}ki(e){if(this._instance.persistence){var t,r=this._instance.persistence,s=()=>{var i,a,o,l,c,u,f,m,g,y=(i=e.sessionRecording)==null?void 0:i.sampleRate,b=bn(y)?null:parseFloat(y);bn(b)&&this.Si();var x=(a=e.sessionRecording)==null?void 0:a.minimumDurationMilliseconds;r.register({[fC]:!!e.sessionRecording,[CU]:(o=e.sessionRecording)==null?void 0:o.consoleLogRecordingEnabled,[kU]:ut({capturePerformance:e.capturePerformance},(l=e.sessionRecording)==null?void 0:l.networkPayloadCapture),[IU]:(c=e.sessionRecording)==null?void 0:c.masking,[LU]:{enabled:(u=e.sessionRecording)==null?void 0:u.recordCanvas,fps:(f=e.sessionRecording)==null?void 0:f.canvasFps,quality:(m=e.sessionRecording)==null?void 0:m.canvasQuality},[DU]:b,[PU]:it(x)?null:x,[MU]:(g=e.sessionRecording)==null?void 0:g.scriptConfig})};s(),(t=this.ri)==null||t.call(this),this.ri=this.At.onSessionId(s)}}log(e,t){var r;t===void 0&&(t="log"),(r=this._instance.sessionRecording)==null||r.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:t,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}gi(e){if(!it(Object.assign)&&!it(Array.from)&&!(this.Ot||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var t;this.Ot=!0,this.At.checkAndGetSessionAndWindowId(),Wy()?this.Ei():(t=Ut.__PosthogExtensions__)==null||t.loadExternalDependency==null||t.loadExternalDependency(this._instance,this.Ii,r=>{if(r)return Es.error("could not load recorder",r);this.Ei()}),Es.info("starting"),this.status===aw&&this.xi(e||"recording_initialized")}}get Ii(){var e;return((e=this._instance)==null||(e=e.persistence)==null||(e=e.get_property(MU))==null?void 0:e.script)||"recorder"}Pi(e){var t;return e.type===3&&Ole.indexOf((t=e.data)==null?void 0:t.source)!==-1}Ri(e){var t=this.Pi(e);t||this.Zt||e.timestamp-this.ti>this.Ft&&(this.Zt=!0,clearInterval(this.wi),this.ui("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this.ti,threshold:this.Ft,bufferLength:this.C.data.length,bufferSize:this.C.size}),this.ai());var r=!1;if(t&&(this.ti=e.timestamp,this.Zt)){var s=this.Zt==="unknown";this.Zt=!1,s||(this.ui("sessionNoLongerIdle",{reason:"user activity",type:e.type}),r=!0)}if(!this.Zt){var{windowId:i,sessionId:a}=this.At.checkAndGetSessionAndWindowId(!t,e.timestamp),o=this.Ct!==a,l=this.fi!==i;this.fi=i,this.Ct=a,o||l?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):r&&this.Ti()}}Mi(e){try{return e.rrwebMethod(),!0}catch(t){return this.Qt.length<10?this.Qt.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):Es.warn("could not emit queued rrweb event.",t,e),!1}}ui(e,t){return this.Mi(JU(()=>Wy().addCustomEvent(e,t)))}Ci(){return this.Mi(JU(()=>Wy().takeFullSnapshot()))}Ei(){var e,t,r,s,i={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},a=this._instance.config.session_recording;for(var[o,l]of Object.entries(a||{}))o in i&&(o==="maskInputOptions"?i.maskInputOptions=ut({password:!0},l):i[o]=l);this.qt&&this.qt.enabled&&(i.recordCanvas=!0,i.sampling={canvas:this.qt.fps},i.dataURLOptions={type:"image/webp",quality:this.qt.quality}),this.Ht&&(i.maskAllInputs=(t=this.Ht.maskAllInputs)===null||t===void 0||t,i.maskTextSelector=(r=this.Ht.maskTextSelector)!==null&&r!==void 0?r:void 0,i.blockSelector=(s=this.Ht.blockSelector)!==null&&s!==void 0?s:void 0);var c=Wy();if(c){this.Fi=(e=this.Fi)!==null&&e!==void 0?e:new gle(c,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(f,m)=>{var g="Too many mutations on node '"+f+"'. Rate limiting. This could be due to SVG animations or something similar";Es.info(g,{node:m}),this.log(Vp+" "+g,"warn")}});var u=this.Oi();this.ci=c(ut({emit:f=>{this.onRRwebEmit(f)},plugins:u},i)),this.ti=Date.now(),this.Zt=Do(this.Zt)?this.Zt:"unknown",this.ui("$session_options",{sessionRecordingOptions:i,activePlugins:u.map(f=>f?.name)}),this.ui("$posthog_config",{config:this._instance.config})}else Es.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Ti(){if(this.wi&&clearInterval(this.wi),this.Zt!==!0){var e=this.Dt;e&&(this.wi=setInterval(()=>{this.Ci()},e))}}Oi(){var e,t,r=[],s=(e=Ut.__PosthogExtensions__)==null||(e=e.rrwebPlugins)==null?void 0:e.getRecordConsolePlugin;s&&this.Ut&&r.push(s());var i=(t=Ut.__PosthogExtensions__)==null||(t=t.rrwebPlugins)==null?void 0:t.getRecordNetworkPlugin;return this.Bt&&ma(i)&&(!Ooe.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?r.push(i(ple(this._instance.config,this.Bt))):Es.info("NetworkCapture not started because we are on localhost.")),r}onRRwebEmit(e){var t;if(this.Ai(),e&&hr(e)){if(e.type===Cl.Meta){var r=this.yi(e.data.href);if(this.Di=r,!r)return;e.data.href=r}else this.Li();if(this.Kt.checkUrlTriggerConditions(()=>this.ji(),()=>this.Ni(),m=>this.zi(m)),!this.Kt.urlBlocked||(s=e).type===Cl.Custom&&s.data.tag==="recording paused"){var s;e.type===Cl.FullSnapshot&&this.Ti(),e.type===Cl.FullSnapshot&&this.Jt&&this.Lt.triggerStatus(this.sessionId)===Ps&&this.pi();var i=this.Fi?this.Fi.throttleMutations(e):e;if(i){var a=function(m){var g=m;if(g&&hr(g)&&g.type===6&&hr(g.data)&&g.data.plugin==="rrweb/console@1"){g.data.payload.payload.length>10&&(g.data.payload.payload=g.data.payload.payload.slice(0,10),g.data.payload.payload.push("...[truncated]"));for(var y=[],b=0;b<g.data.payload.payload.length;b++)g.data.payload.payload[b]&&g.data.payload.payload[b].length>2e3?y.push(g.data.payload.payload[b].slice(0,2e3)+"...[truncated]"):y.push(g.data.payload.payload[b]);return g.data.payload.payload=y,m}return m}(i);if(this.Ri(a),this.Zt!==!0||e3(a)){if(e3(a)){var o=a.data.payload;if(o){var l=o.lastActivityTimestamp,c=o.threshold;a.timestamp=l+c}}var u=(t=this._instance.config.session_recording.compress_events)===null||t===void 0||t?function(m){if(sw(m)<1024)return m;try{if(m.type===Cl.FullSnapshot)return ut({},m,{data:Fu(m.data),cv:"2024-10"});if(m.type===Cl.IncrementalSnapshot&&m.data.source===Na.Mutation)return ut({},m,{cv:"2024-10",data:ut({},m.data,{texts:Fu(m.data.texts),attributes:Fu(m.data.attributes),removes:Fu(m.data.removes),adds:Fu(m.data.adds)})});if(m.type===Cl.IncrementalSnapshot&&m.data.source===Na.StyleSheetRule)return ut({},m,{cv:"2024-10",data:ut({},m.data,{adds:m.data.adds?Fu(m.data.adds):void 0,removes:m.data.removes?Fu(m.data.removes):void 0})})}catch(g){Es.error("could not compress event - will use uncompressed event",g)}return m}(a):a,f={$snapshot_bytes:sw(u),$snapshot_data:u,$session_id:this.Ct,$window_id:this.fi};this.status!==Zc?this.Ui(f):this.pi()}}}}}Li(){if(!this._instance.config.capture_pageview&&Pe){var e=this.yi(Pe.location.href);this.Di!==e&&(this.ui("$url_changed",{href:e}),this.Di=e)}}Ai(){if(this.Qt.length){var e=[...this.Qt];this.Qt=[],e.forEach(t=>{Date.now()-t.enqueuedAt<=2e3&&this.Mi(t)})}}yi(e){var t=this._instance.config.session_recording;if(t.maskNetworkRequestFn){var r,s={url:e};return(r=s=t.maskNetworkRequestFn(s))==null?void 0:r.url}return e}pi(){return this.C={size:0,data:[],sessionId:this.Ct,windowId:this.fi},this.C}ai(){this.qi&&(clearTimeout(this.qi),this.qi=void 0);var e=this.Gt,t=this.Nt,r=Is(t)&&t>=0,s=Is(e)&&r&&t<e;return this.status===vd||this.status===qL||this.status===Zc||s?(this.qi=setTimeout(()=>{this.ai()},2e3),this.C):(this.C.data.length>0&&TC(this.C).forEach(i=>{this.Bi({$snapshot_bytes:i.size,$snapshot_data:i.data,$session_id:i.sessionId,$window_id:i.windowId,$lib:"web",$lib_version:Pl.LIB_VERSION})}),this.pi())}Ui(e){var t,r=2+(((t=this.C)==null?void 0:t.data.length)||0);!this.Zt&&(this.C.size+e.$snapshot_bytes+r>943718.4||this.C.sessionId!==this.Ct)&&(this.C=this.ai()),this.C.size+=e.$snapshot_bytes,this.C.data.push(e.$snapshot_data),this.qi||this.Zt||(this.qi=setTimeout(()=>{this.ai()},2e3))}Bi(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this.vi),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}zi(e){var t;this.Lt.triggerStatus(this.sessionId)===Ps&&((t=this._instance)==null||(t=t.persistence)==null||t.register({[e==="url"?mC:pC]:this.Ct}),this.ai(),this.xi(e+"_trigger_matched"))}ji(){this.Kt.urlBlocked||(this.Kt.urlBlocked=!0,clearInterval(this.wi),Es.info("recording paused due to URL blocker"),this.ui("recording paused",{reason:"url blocker"}))}Ni(){this.Kt.urlBlocked&&(this.Kt.urlBlocked=!1,this.Ci(),this.Ti(),this.ui("recording resumed",{reason:"left blocked url"}),Es.info("recording resumed"))}bi(){this.Yt.Tt.length!==0&&bn(this.ni)&&(this.ni=this._instance.on("eventCaptured",e=>{try{this.Yt.Tt.includes(e.event)&&this.zi("event")}catch(t){Es.error("Could not activate event trigger",t)}}))}overrideLinkedFlag(){this.Xt.linkedFlagSeen=!0,this.Ci(),this.xi("linked_flag_overridden")}overrideSampling(){var e;(e=this._instance.persistence)==null||e.register({[Bp]:!0}),this.Ci(),this.xi("sampling_overridden")}overrideTrigger(e){this.zi(e)}xi(e,t){this._instance.register_for_session({$session_recording_start_reason:e}),Es.info(e.replace("_"," "),t),on(["recording_initialized","session_id_changed"],e)||this.ui(e,t)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this.At.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.C.data.length,$sdk_debug_replay_internal_buffer_size:this.C.size,$sdk_debug_current_session_duration:this.Nt,$sdk_debug_session_start:e}}}var W1=os("[SegmentIntegration]");function jle(n,e){var t=n.config.segment;if(!t)return e();(function(r,s){var i=r.config.segment;if(!i)return s();var a=l=>{var c=()=>l.anonymousId()||zc();r.config.get_device_id=c,l.id()&&(r.register({distinct_id:l.id(),$device_id:c()}),r.persistence.set_property(Rl,"identified")),s()},o=i.user();"then"in o&&ma(o.then)?o.then(l=>a(l)):a(o)})(n,()=>{t.register((r=>{Promise&&Promise.resolve||W1.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,a)=>{if(!a)return i;i.event.userId||i.event.anonymousId===r.get_distinct_id()||(W1.info("No userId set, resetting PostHog"),r.reset()),i.event.userId&&i.event.userId!==r.get_distinct_id()&&(W1.info("UserId set, identifying with PostHog"),r.identify(i.event.userId));var o=r.calculateEventProperties(a,i.event.properties);return i.event.properties=Object.assign({},o,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(n)).then(()=>{e()})})}var bV="posthog-js";function xV(n,e){var{organization:t,projectId:r,prefix:s,severityAllowList:i=["error"]}=e===void 0?{}:e;return a=>{var o,l,c,u,f;if(!(i==="*"||i.includes(a.level))||!n.__loaded)return a;a.tags||(a.tags={});var m=n.requestRouter.endpointFor("ui","/project/"+n.config.token+"/person/"+n.get_distinct_id());a.tags["PostHog Person URL"]=m,n.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=n.get_session_replay_url({withTimestamp:!0}));var g=((o=a.exception)==null?void 0:o.values)||[],y=g.map(x=>ut({},x,{stacktrace:x.stacktrace?ut({},x.stacktrace,{type:"raw",frames:(x.stacktrace.frames||[]).map(S=>ut({},S,{platform:"web:javascript"}))}):void 0})),b={$exception_message:((l=g[0])==null?void 0:l.value)||a.message,$exception_type:(c=g[0])==null?void 0:c.type,$exception_personURL:m,$exception_level:a.level,$exception_list:y,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:((u=g[0])==null?void 0:u.value)||a.message,$sentry_exception_type:(f=g[0])==null?void 0:f.type,$sentry_tags:a.tags};return t&&r&&(b.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+r+"&query="+a.event_id),n.exceptions.sendExceptionEvent(b),a}}class Fle{constructor(e,t,r,s,i){this.name=bV,this.setupOnce=function(a){a(xV(e,{organization:t,projectId:r,prefix:s,severityAllowList:i}))}}}var Ule=Pe!=null&&Pe.location?nw(Pe.location.hash,"__posthog")||nw(location.hash,"state"):null,t3="_postHogToolbarParams",n3=os("[Toolbar]"),Rc=function(n){return n[n.UNINITIALIZED=0]="UNINITIALIZED",n[n.LOADING=1]="LOADING",n[n.LOADED=2]="LOADED",n}(Rc||{});class $le{constructor(e){this.instance=e}Hi(e){Ut.ph_toolbar_state=e}Wi(){var e;return(e=Ut.ph_toolbar_state)!==null&&e!==void 0?e:Rc.UNINITIALIZED}maybeLoadToolbar(e,t,r){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),r===void 0&&(r=void 0),!Pe||!ft)return!1;e=e??Pe.location,r=r??Pe.history;try{if(!t){try{Pe.localStorage.setItem("test","test"),Pe.localStorage.removeItem("test")}catch{return!1}t=Pe?.localStorage}var s,i=Ule||nw(e.hash,"__posthog")||nw(e.hash,"state"),a=i?EU(()=>JSON.parse(atob(decodeURIComponent(i))))||EU(()=>JSON.parse(decodeURIComponent(i))):null;return a&&a.action==="ph_authorize"?((s=a).source="url",s&&Object.keys(s).length>0&&(a.desiredHash?e.hash=a.desiredHash:r?r.replaceState(r.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(t3)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}Gi(e){var t=Ut.ph_load_toolbar||Ut.ph_load_editor;!bn(t)&&ma(t)?t(e,this.instance):n3.warn("No toolbar load function found")}loadToolbar(e){var t=!(ft==null||!ft.getElementById(GH));if(!Pe||t)return!1;var r=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=ut({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(Pe.localStorage.setItem(t3,JSON.stringify(ut({},s,{source:void 0}))),this.Wi()===Rc.LOADED)this.Gi(s);else if(this.Wi()===Rc.UNINITIALIZED){var i;this.Hi(Rc.LOADING),(i=Ut.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",a=>{if(a)return n3.error("[Toolbar] Failed to load",a),void this.Hi(Rc.UNINITIALIZED);this.Hi(Rc.LOADED),this.Gi(s)}),rr(Pe,"turbolinks:load",()=>{this.Hi(Rc.UNINITIALIZED),this.loadToolbar(s)})}return!0}Ji(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,r){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),r===void 0&&(r=void 0),this.maybeLoadToolbar(e,t,r)}}var Ble=os("[TracingHeaders]");class Hle{constructor(e){this.Vi=void 0,this.Ki=void 0,this.nt=()=>{var t,r;it(this.Vi)&&((t=Ut.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),it(this.Ki)&&((r=Ut.__PosthogExtensions__)==null||(r=r.tracingHeadersPatchFns)==null||r._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}J(e){var t,r;(t=Ut.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"tracing-headers",s=>{if(s)return Ble.error("failed to load script",s);e()})}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.J(this.nt):((e=this.Vi)==null||e.call(this),(t=this.Ki)==null||t.call(this),this.Vi=void 0,this.Ki=void 0)}}var pc=os("[Web Vitals]"),r3=9e5;class Vle{constructor(e){var t;this.Yi=!1,this.i=!1,this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Xi=()=>{clearTimeout(this.Qi),this.C.metrics.length!==0&&(this._instance.capture("$web_vitals",this.C.metrics.reduce((r,s)=>ut({},r,{["$web_vitals_"+s.name+"_event"]:ut({},s),["$web_vitals_"+s.name+"_value"]:s.value}),{})),this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Zi=r=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(it(i))pc.error("Could not read session ID. Dropping metrics!");else{this.C=this.C||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var a=this.te();it(a)||(bn(r?.name)||bn(r?.value)?pc.error("Invalid metric received",r):this.ie&&r.value>=this.ie?pc.error("Ignoring metric with value >= "+this.ie,r):(this.C.url!==a&&(this.Xi(),this.Qi=setTimeout(this.Xi,this.flushToCaptureTimeoutMs)),it(this.C.url)&&(this.C.url=a),this.C.firstMetricTimestamp=it(this.C.firstMetricTimestamp)?Date.now():this.C.firstMetricTimestamp,r.attribution&&r.attribution.interactionTargetElement&&(r.attribution.interactionTargetElement=void 0),this.C.metrics.push(ut({},r,{$current_url:a,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.C.metrics.length===this.allowedMetrics.length&&this.Xi()))}},this.nt=()=>{var r,s,i,a,o=Ut.__PosthogExtensions__;it(o)||it(o.postHogWebVitalsCallbacks)||({onLCP:r,onCLS:s,onFCP:i,onINP:a}=o.postHogWebVitalsCallbacks),r&&s&&i&&a?(this.allowedMetrics.indexOf("LCP")>-1&&r(this.Zi.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.Zi.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.Zi.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&a(this.Zi.bind(this)),this.i=!0):pc.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.Yi=!((t=this._instance.persistence)==null||!t.props[AU]),this.startIfEnabled()}get allowedMetrics(){var e,t,r=hr(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return it(r)?((t=this._instance.persistence)==null?void 0:t.props[RU])||["CLS","FCP","INP","LCP"]:r}get flushToCaptureTimeoutMs(){return(hr(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get ie(){var e=hr(this._instance.config.capture_performance)&&Is(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:r3;return 0<e&&e<=6e4?r3:e}get isEnabled(){var e=li?.protocol;if(e!=="http:"&&e!=="https:")return pc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=hr(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Do(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Do(t)?t:this.Yi}startIfEnabled(){this.isEnabled&&!this.i&&(pc.info("enabled, starting..."),this.J(this.nt))}onRemoteConfig(e){var t=hr(e.capturePerformance)&&!!e.capturePerformance.web_vitals,r=hr(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[AU]:t}),this._instance.persistence.register({[RU]:r})),this.Yi=t,this.startIfEnabled()}J(e){var t,r;(t=Ut.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks&&e(),(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"web-vitals",s=>{s?pc.error("failed to load script",s):e()})}te(){var e=Pe?Pe.location.href:void 0;return e||pc.error("Could not determine current URL"),e}}var zle=os("[Heatmaps]");function s3(n){return hr(n)&&"clientX"in n&&"clientY"in n&&Is(n.clientX)&&Is(n.clientY)}class Gle{constructor(e){var t;this.rageclicks=new nV,this.Yi=!1,this.i=!1,this.ee=null,this.instance=e,this.Yi=!((t=this.instance.persistence)==null||!t.props[dC])}get flushIntervalMilliseconds(){var e=5e3;return hr(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return it(this.instance.config.capture_heatmaps)?it(this.instance.config.enable_heatmaps)?this.Yi:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.i)return;zle.info("starting..."),this.re(),this.ee=setInterval(this.se.bind(this),this.flushIntervalMilliseconds)}else{var e,t;clearInterval((e=this.ee)!==null&&e!==void 0?e:void 0),(t=this.ne)==null||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[dC]:t}),this.Yi=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.C;return this.C=void 0,e}oe(e){this.ae(e.originalEvent,"deadclick")}re(){Pe&&ft&&(rr(Pe,"beforeunload",this.se.bind(this)),rr(ft,"click",e=>this.ae(e||Pe?.event),{capture:!0}),rr(ft,"mousemove",e=>this.le(e||Pe?.event),{capture:!0}),this.ne=new sV(this.instance,Yoe,this.oe.bind(this)),this.ne.startIfEnabled(),this.i=!0)}ue(e,t){var r=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),a=function(o,l,c){for(var u=o;u&&ZE(u)&&!Wc(u,"body");){if(u===c)return!1;if(on(l,Pe?.getComputedStyle(u).position))return!0;u=XH(u)}return!1}(YH(e),["fixed","sticky"],i);return{x:e.clientX+(a?0:s),y:e.clientY+(a?0:r),target_fixed:a,type:t}}ae(e,t){var r;if(t===void 0&&(t="click"),!OU(e.target)&&s3(e)){var s=this.ue(e,t);(r=this.rageclicks)!=null&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.he(ut({},s,{type:"rageclick"})),this.he(s)}}le(e){!OU(e.target)&&s3(e)&&(clearTimeout(this.de),this.de=setTimeout(()=>{this.he(this.ue(e,"mousemove"))},500))}he(e){if(Pe){var t=Pe.location.href;this.C=this.C||{},this.C[t]||(this.C[t]=[]),this.C[t].push(e)}}se(){this.C&&!of(this.C)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class qle{constructor(e){this._instance=e}doPageView(e,t){var r,s=this.ve(e,t);return this.ce={pathname:(r=Pe?.location.pathname)!==null&&r!==void 0?r:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.ve(e,(t=this.ce)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.ce)==null?void 0:e.pageViewId}}ve(e,t){var r=this.ce;if(!r)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:r.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:a,lastScrollY:o,maxScrollY:l,maxContentHeight:c,lastContentY:u,maxContentY:f}=i;if(!(it(a)||it(o)||it(l)||it(c)||it(u)||it(f))){a=Math.ceil(a),o=Math.ceil(o),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u),f=Math.ceil(f);var m=a<=1?1:Oi(o/a,0,1),g=a<=1?1:Oi(l/a,0,1),y=c<=1?1:Oi(u/c,0,1),b=c<=1?1:Oi(f/c,0,1);s=wr(s,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:m,$prev_pageview_max_scroll:l,$prev_pageview_max_scroll_percentage:g,$prev_pageview_last_content:u,$prev_pageview_last_content_percentage:y,$prev_pageview_max_content:f,$prev_pageview_max_content_percentage:b})}}return r.pathname&&(s.$prev_pageview_pathname=r.pathname),r.timestamp&&(s.$prev_pageview_duration=(e.getTime()-r.timestamp.getTime())/1e3),s}}var Wle=function(n){var e,t,r,s,i="";for(e=t=0,r=(n=(n+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<r;s++){var a=n.charCodeAt(s),o=null;a<128?t++:o=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),uu(o)||(t>e&&(i+=n.substring(e,t)),i+=o,e=t=s+1)}return t>e&&(i+=n.substring(e,n.length)),i},Kle=!!lC||!!oC,i3="text/plain",ow=(n,e)=>{var[t,r]=n.split("?"),s=ut({},e);r?.split("&").forEach(a=>{var[o]=a.split("=");delete s[o]});var i=Noe(s);return t+"?"+(i=i?(r?r+"&":"")+i:r)},zp=(n,e)=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString():r,e),K1=n=>{var{data:e,compression:t}=n;if(e){if(t===Ol.GZipJS){var r=pV(gV(zp(e)),{mtime:0}),s=new Blob([r],{type:i3});return{contentType:i3,body:s,estimatedSize:s.size}}if(t===Ol.Base64){var i=function(l){var c,u,f,m,g,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=0,x=0,S="",T=[];if(!l)return l;l=Wle(l);do c=(g=l.charCodeAt(b++)<<16|l.charCodeAt(b++)<<8|l.charCodeAt(b++))>>18&63,u=g>>12&63,f=g>>6&63,m=63&g,T[x++]=y.charAt(c)+y.charAt(u)+y.charAt(f)+y.charAt(m);while(b<l.length);switch(S=T.join(""),l.length%3){case 1:S=S.slice(0,-2)+"==";break;case 2:S=S.slice(0,-1)+"="}return S}(zp(e)),a=(l=>"data="+encodeURIComponent(typeof l=="string"?l:zp(l)))(i);return{contentType:"application/x-www-form-urlencoded",body:a,estimatedSize:new Blob([a]).size}}var o=zp(e);return{contentType:"application/json",body:o,estimatedSize:new Blob([o]).size}}},mg=[];oC&&mg.push({transport:"fetch",method:n=>{var e,t,{contentType:r,body:s,estimatedSize:i}=(e=K1(n))!==null&&e!==void 0?e:{},a=new Headers;Dn(n.headers,function(u,f){a.append(f,u)}),r&&a.append("Content-Type",r);var o=n.url,l=null;if(xU){var c=new xU;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),n.timeout)}}oC(o,ut({method:n?.method||"GET",headers:a,keepalive:n.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=l)==null?void 0:t.signal},n.fetchOptions)).then(u=>u.text().then(f=>{var m={statusCode:u.status,text:f};if(u.status===200)try{m.json=JSON.parse(f)}catch(g){pt.error(g)}n.callback==null||n.callback(m)})).catch(u=>{pt.error(u),n.callback==null||n.callback({statusCode:0,text:u})}).finally(()=>l?clearTimeout(l.timeout):null)}}),lC&&mg.push({transport:"XHR",method:n=>{var e,t=new lC;t.open(n.method||"GET",n.url,!0);var{contentType:r,body:s}=(e=K1(n))!==null&&e!==void 0?e:{};Dn(n.headers,function(i,a){t.setRequestHeader(a,i)}),r&&t.setRequestHeader("Content-Type",r),n.timeout&&(t.timeout=n.timeout),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}n.callback==null||n.callback(i)}},t.send(s)}}),Mi!=null&&Mi.sendBeacon&&mg.push({transport:"sendBeacon",method:n=>{var e=ow(n.url,{beacon:"1"});try{var t,{contentType:r,body:s}=(t=K1(n))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:r}):s;Mi.sendBeacon(e,i)}catch{}}});var Bf=function(n,e){if(!function(t){try{new RegExp(t)}catch{return!1}return!0}(e))return!1;try{return new RegExp(e).test(n)}catch{return!1}};function a3(n,e,t){return zp({distinct_id:n,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var Yle={exact:(n,e)=>e.some(t=>n.some(r=>t===r)),is_not:(n,e)=>e.every(t=>n.every(r=>t!==r)),regex:(n,e)=>e.some(t=>n.some(r=>Bf(t,r))),not_regex:(n,e)=>e.every(t=>n.every(r=>!Bf(t,r))),icontains:(n,e)=>e.map(Ky).some(t=>n.map(Ky).some(r=>t.includes(r))),not_icontains:(n,e)=>e.map(Ky).every(t=>n.map(Ky).every(r=>!t.includes(r)))},Ky=n=>n.toLowerCase(),o3=os("[Error tracking]");class Xle{constructor(e){var t,r;this.fe=[],this._instance=e,this.fe=(t=(r=this._instance.persistence)==null?void 0:r.get_property(hC))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,r,s,i=(t=(r=e.errorTracking)==null?void 0:r.suppressionRules)!==null&&t!==void 0?t:[],a=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.fe=i,this._instance.persistence&&this._instance.persistence.register({[hC]:this.fe,[_U]:a})}get pe(){var e,t=!!this._instance.get_property(_U),r=this._instance.config.error_tracking.captureExtensionExceptions;return(e=r??t)!==null&&e!==void 0&&e}sendExceptionEvent(e){if(this._e(e))o3.info("Skipping exception capture because a suppression rule matched");else{if(this.pe||!this.ge(e))return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"});o3.info("Skipping exception capture because it was thrown by an extension")}}_e(e){var t=e.$exception_list;if(!t||!zn(t)||t.length===0)return!1;var r=t.reduce((s,i)=>{var{type:a,value:o}=i;return fr(a)&&a.length>0&&s.$exception_types.push(a),fr(o)&&o.length>0&&s.$exception_values.push(o),s},{$exception_types:[],$exception_values:[]});return this.fe.some(s=>{var i=s.values.map(a=>{var o,l=Yle[a.operator],c=zn(a.value)?a.value:[a.value],u=(o=r[a.key])!==null&&o!==void 0?o:[];return c.length>0&&l(c,u)});return s.type==="OR"?i.some(Boolean):i.every(Boolean)})}ge(e){var t=e.$exception_list;return!(!t||!zn(t))&&t.flatMap(r=>{var s,i;return(s=(i=r.stacktrace)==null?void 0:i.frames)!==null&&s!==void 0?s:[]}).some(r=>r.filename&&r.filename.startsWith("chrome-extension://"))}}var ga="Mobile",lw="iOS",Po="Android",Yg="Tablet",wV=Po+" "+Yg,EV="iPad",SV="Apple",TV=SV+" Watch",Xg="Safari",Hf="BlackBerry",_V="Samsung",AV=_V+"Browser",RV=_V+" Internet",yd="Chrome",Qle=yd+" OS",CV=yd+" "+lw,KL="Internet Explorer",kV=KL+" "+ga,YL="Opera",Zle=YL+" Mini",XL="Edge",IV="Microsoft "+XL,Ef="Firefox",LV=Ef+" "+lw,Qg="Nintendo",Zg="PlayStation",Sf="Xbox",DV=Po+" "+ga,PV=ga+" "+Xg,Gp="Windows",LC=Gp+" Phone",l3="Nokia",DC="Ouya",MV="Generic",Jle=MV+" "+ga.toLowerCase(),OV=MV+" "+Yg.toLowerCase(),PC="Konqueror",$s="(\\d+(\\.\\d+)?)",Y1=new RegExp("Version/"+$s),ece=new RegExp(Sf,"i"),tce=new RegExp(Zg+" \\w+","i"),nce=new RegExp(Qg+" \\w+","i"),QL=new RegExp(Hf+"|PlayBook|BB10","i"),rce={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},sce=(n,e)=>e&&on(e,SV)||function(t){return on(t,Xg)&&!on(t,yd)&&!on(t,Po)}(n),NV=function(n,e){return e=e||"",on(n," OPR/")&&on(n,"Mini")?Zle:on(n," OPR/")?YL:QL.test(n)?Hf:on(n,"IE"+ga)||on(n,"WPDesktop")?kV:on(n,AV)?RV:on(n,XL)||on(n,"Edg/")?IV:on(n,"FBIOS")?"Facebook "+ga:on(n,"UCWEB")||on(n,"UCBrowser")?"UC Browser":on(n,"CriOS")?CV:on(n,"CrMo")||on(n,yd)?yd:on(n,Po)&&on(n,Xg)?DV:on(n,"FxiOS")?LV:on(n.toLowerCase(),PC.toLowerCase())?PC:sce(n,e)?on(n,ga)?PV:Xg:on(n,Ef)?Ef:on(n,"MSIE")||on(n,"Trident/")?KL:on(n,"Gecko")?Ef:""},ice={[kV]:[new RegExp("rv:"+$s)],[IV]:[new RegExp(XL+"?\\/"+$s)],[yd]:[new RegExp("("+yd+"|CrMo)\\/"+$s)],[CV]:[new RegExp("CriOS\\/"+$s)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+$s)],[Xg]:[Y1],[PV]:[Y1],[YL]:[new RegExp("(Opera|OPR)\\/"+$s)],[Ef]:[new RegExp(Ef+"\\/"+$s)],[LV]:[new RegExp("FxiOS\\/"+$s)],[PC]:[new RegExp("Konqueror[:/]?"+$s,"i")],[Hf]:[new RegExp(Hf+" "+$s),Y1],[DV]:[new RegExp("android\\s"+$s,"i")],[RV]:[new RegExp(AV+"\\/"+$s)],[KL]:[new RegExp("(rv:|MSIE )"+$s)],Mozilla:[new RegExp("rv:"+$s)]},ace=function(n,e){var t=NV(n,e),r=ice[t];if(it(r))return null;for(var s=0;s<r.length;s++){var i=r[s],a=n.match(i);if(a)return parseFloat(a[a.length-2])}return null},c3=[[new RegExp(Sf+"; "+Sf+" (.*?)[);]","i"),n=>[Sf,n&&n[1]||""]],[new RegExp(Qg,"i"),[Qg,""]],[new RegExp(Zg,"i"),[Zg,""]],[QL,[Hf,""]],[new RegExp(Gp,"i"),(n,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[LC,""];if(new RegExp(ga).test(e)&&!/IEMobile\b/.test(e))return[Gp+" "+ga,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var r=t[1],s=rce[r]||"";return/arm/i.test(e)&&(s="RT"),[Gp,s]}return[Gp,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,n=>{if(n&&n[3]){var e=[n[3],n[4],n[5]||"0"];return[lw,e.join(".")]}return[lw,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,n=>{var e="";return n&&n.length>=3&&(e=it(n[2])?n[3]:n[2]),["watchOS",e]}],[new RegExp("("+Po+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Po+")","i"),n=>{if(n&&n[2]){var e=[n[2],n[3],n[4]||"0"];return[Po,e.join(".")]}return[Po,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,n=>{var e=["Mac OS X",""];if(n&&n[1]){var t=[n[1],n[2],n[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Qle,""]],[/Linux|debian/i,["Linux",""]]],u3=function(n){return nce.test(n)?Qg:tce.test(n)?Zg:ece.test(n)?Sf:new RegExp(DC,"i").test(n)?DC:new RegExp("("+LC+"|WPDesktop)","i").test(n)?LC:/iPad/.test(n)?EV:/iPod/.test(n)?"iPod Touch":/iPhone/.test(n)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(n)?TV:QL.test(n)?Hf:/(kobo)\s(ereader|touch)/i.test(n)?"Kobo":new RegExp(l3,"i").test(n)?l3:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(n)||/(kf[a-z]+)( bui|\)).+silk\//i.test(n)?"Kindle Fire":/(Android|ZTE)/i.test(n)?!new RegExp(ga).test(n)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(n)?/pixel[\daxl ]{1,6}/i.test(n)&&!/pixel c/i.test(n)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(n)||/lmy47v/i.test(n)&&!/QTAQZ3/i.test(n)?Po:wV:Po:new RegExp("(pda|"+ga+")","i").test(n)?Jle:new RegExp(Yg,"i").test(n)&&!new RegExp(Yg+" pc","i").test(n)?OV:""},Yy="https?://(.*)",eS=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],oce=QE(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],eS),ZL="<masked>",lce=["li_fat_id"];function jV(n,e,t){if(!ft)return{};var r,s=e?QE([],eS,t||[]):[],i=FV(BL(ft.URL,s,ZL),n),a=(r={},Dn(lce,function(o){var l=Fo.D(o);r[o]=l||null}),r);return wr(a,i)}function FV(n,e){var t=oce.concat(e||[]),r={};return Dn(t,function(s){var i=tw(n,s);r[s]=i||null}),r}function UV(n){var e=function(i){return i?i.search(Yy+"google.([^/?]*)")===0?"google":i.search(Yy+"bing.com")===0?"bing":i.search(Yy+"yahoo.com")===0?"yahoo":i.search(Yy+"duckduckgo.com")===0?"duckduckgo":null:null}(n),t=e!="yahoo"?"q":"p",r={};if(!uu(e)){r.$search_engine=e;var s=ft?tw(ft.referrer,t):"";s.length&&(r.ph_keyword=s)}return r}function d3(){return navigator.language||navigator.userLanguage}function $V(){return ft?.referrer||"$direct"}function BV(n,e){var t=n?QE([],eS,e||[]):[],r=li?.href.substring(0,1e3);return{r:$V().substring(0,1e3),u:r?BL(r,t,ZL):void 0}}function HV(n){var e,{r:t,u:r}=n,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=Uf(t))==null?void 0:e.host};if(r){s.$current_url=r;var i=Uf(r);s.$host=i?.host,s.$pathname=i?.pathname;var a=FV(r);wr(s,a)}if(t){var o=UV(t);wr(s,o)}return s}function VV(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function cce(){try{return new Date().getTimezoneOffset()}catch{return}}function uce(n,e){if(!si)return{};var t,r,s,i=n?QE([],eS,e||[]):[],[a,o]=function(l){for(var c=0;c<c3.length;c++){var[u,f]=c3[c],m=u.exec(l),g=m&&(ma(f)?f(m,l):f);if(g)return g}return["",""]}(si);return wr(UL({$os:a,$os_version:o,$browser:NV(si,navigator.vendor),$device:u3(si),$device_type:(r=si,s=u3(r),s===EV||s===wV||s==="Kobo"||s==="Kindle Fire"||s===OV?Yg:s===Qg||s===Sf||s===Zg||s===DC?"Console":s===TV?"Wearable":s?ga:"Desktop"),$timezone:VV(),$timezone_offset:cce()}),{$current_url:BL(li?.href,i,ZL),$host:li?.host,$pathname:li?.pathname,$raw_user_agent:si.length>1e3?si.substring(0,997)+"...":si,$browser_version:ace(si,navigator.vendor),$browser_language:d3(),$browser_language_prefix:(t=d3(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:Pe?.screen.height,$screen_width:Pe?.screen.width,$viewport_height:Pe?.innerHeight,$viewport_width:Pe?.innerWidth,$lib:"web",$lib_version:Pl.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var ho=os("[FeatureFlags]"),X1="$active_feature_flags",Ah="$override_feature_flags",h3="$feature_flag_payloads",Sp="$override_feature_flag_payloads",f3="$feature_flag_request_id",m3=n=>{var e={};for(var[t,r]of Gb(n||{}))r&&(e[t]=r);return e},dce=n=>{var e=n.flags;return e?(n.featureFlags=Object.fromEntries(Object.keys(e).map(t=>{var r;return[t,(r=e[t].variant)!==null&&r!==void 0?r:e[t].enabled]})),n.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter(t=>e[t].enabled).filter(t=>{var r;return(r=e[t].metadata)==null?void 0:r.payload}).map(t=>{var r;return[t,(r=e[t].metadata)==null?void 0:r.payload]}))):ho.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),n},hce=function(n){return n.FeatureFlags="feature_flags",n.Recordings="recordings",n}({});class fce{constructor(e){this.me=!1,this.be=!1,this.ye=!1,this.we=!1,this.Se=!1,this.$e=!1,this.xe=!1,this._instance=e,this.featureFlagEventHandlers=[]}flags(){if(this._instance.config.__preview_remote_config)this.$e=!0;else{var e=!this.ke&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.Ee({disableFlags:e})}}get hasLoadedFlags(){return this.be}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(gC),t=this._instance.get_property(Ah),r=this._instance.get_property(Sp);if(!r&&!t)return e||{};var s=wr({},e||{}),i=[...new Set([...Object.keys(r||{}),...Object.keys(t||{})])];for(var a of i){var o,l,c=s[a],u=t?.[a],f=it(u)?(o=c?.enabled)!==null&&o!==void 0&&o:!!u,m=it(u)?c.variant:typeof u=="string"?u:void 0,g=r?.[a],y=ut({},c,{enabled:f,variant:f?m??c?.variant:void 0});f!==c?.enabled&&(y.original_enabled=c?.enabled),m!==c?.variant&&(y.original_variant=c?.variant),g&&(y.metadata=ut({},c?.metadata,{payload:g,original_payload:c==null||(l=c.metadata)==null?void 0:l.payload})),s[a]=y}return this.me||(ho.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:r,finalDetails:s}),this.me=!0),s}getFlagVariants(){var e=this._instance.get_property(lf),t=this._instance.get_property(Ah);if(!t)return e||{};for(var r=wr({},e),s=Object.keys(t),i=0;i<s.length;i++)r[s[i]]=t[s[i]];return this.me||(ho.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:r}),this.me=!0),r}getFlagPayloads(){var e=this._instance.get_property(h3),t=this._instance.get_property(Sp);if(!t)return e||{};for(var r=wr({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)r[s[i]]=t[s[i]];return this.me||(ho.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:r}),this.me=!0),r}reloadFeatureFlags(){this.we||this._instance.config.advanced_disable_feature_flags||this.ke||(this.ke=setTimeout(()=>{this.Ee()},5))}Ie(){clearTimeout(this.ke),this.ke=void 0}ensureFlagsLoaded(){this.be||this.ye||this.ke||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.we=e}Ee(e){var t;if(this.Ie(),!this._instance.I())if(this.ye)this.Se=!0;else{var r={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:ut({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(Hp)||{}),group_properties:this._instance.get_property(Gu)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(r.disable_flags=!0);var s=this._instance.config.__preview_remote_config,i=s?"/flags/?v=2":"/flags/?v=2&config=true",a=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",o=this._instance.requestRouter.endpointFor("api",i+a);s&&(r.timezone=VV()),this.ye=!0,this._instance.Pe({method:"POST",url:o,data:r,compression:this._instance.config.disable_compression?void 0:Ol.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,u,f=!0;if(l.statusCode===200&&(this.Se||(this.$anon_distinct_id=void 0),f=!1),this.ye=!1,this.$e||(this.$e=!0,this._instance.Re((u=l.json)!==null&&u!==void 0?u:{})),!r.disable_flags||this.Se)if(this.xe=!f,l.json&&(c=l.json.quotaLimited)!=null&&c.includes(hce.FeatureFlags))ho.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var m;r.disable_flags||this.receivedFeatureFlags((m=l.json)!==null&&m!==void 0?m:{},f),this.Se&&(this.Se=!1,this.Ee())}}})}}getFeatureFlag(e,t){if(t===void 0&&(t={}),this.be||this.getFlags()&&this.getFlags().length>0){var r=this.getFlagVariants()[e],s=""+r,i=this._instance.get_property(f3)||void 0,a=this._instance.get_property(Qx)||{};if((t.send_event||!("send_event"in t))&&(!(e in a)||!a[e].includes(s))){var o,l,c,u,f,m,g,y,b;zn(a[e])?a[e].push(s):a[e]=[s],(o=this._instance.persistence)==null||o.register({[Qx]:a});var x=this.getFeatureFlagDetails(e),S={$feature_flag:e,$feature_flag_response:r,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:i,$feature_flag_bootstrapped_response:((l=this._instance.config.bootstrap)==null||(l=l.featureFlags)==null?void 0:l[e])||null,$feature_flag_bootstrapped_payload:((c=this._instance.config.bootstrap)==null||(c=c.featureFlagPayloads)==null?void 0:c[e])||null,$used_bootstrap_value:!this.xe};it(x==null||(u=x.metadata)==null?void 0:u.version)||(S.$feature_flag_version=x.metadata.version);var T,_=(f=x==null||(m=x.reason)==null?void 0:m.description)!==null&&f!==void 0?f:x==null||(g=x.reason)==null?void 0:g.code;_&&(S.$feature_flag_reason=_),x!=null&&(y=x.metadata)!=null&&y.id&&(S.$feature_flag_id=x.metadata.id),it(x?.original_variant)&&it(x?.original_enabled)||(S.$feature_flag_original_response=it(x.original_variant)?x.original_enabled:x.original_variant),x!=null&&(b=x.metadata)!=null&&b.original_payload&&(S.$feature_flag_original_payload=x==null||(T=x.metadata)==null?void 0:T.original_payload),this._instance.capture("$feature_flag_called",S)}return r}ho.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var r=this._instance.config.token;this._instance.Pe({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:{distinct_id:this._instance.get_distinct_id(),token:r},compression:this._instance.config.disable_compression?void 0:Ol.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:s=>{var i,a=(i=s.json)==null?void 0:i.featureFlagPayloads;t(a?.[e]||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.be||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);ho.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this._instance.persistence){this.be=!0;var r=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(a,o,l,c,u){l===void 0&&(l={}),c===void 0&&(c={}),u===void 0&&(u={});var f=dce(a),m=f.flags,g=f.featureFlags,y=f.featureFlagPayloads;if(g){var b=a.requestId;if(zn(g)){ho.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var x={};if(g)for(var S=0;S<g.length;S++)x[g[S]]=!0;o&&o.register({[X1]:g,[lf]:x})}else{var T=g,_=y,R=m;a.errorsWhileComputingFlags&&(T=ut({},l,T),_=ut({},c,_),R=ut({},u,R)),o&&o.register(ut({[X1]:Object.keys(m3(T)),[lf]:T||{},[h3]:_||{},[gC]:R||{}},b?{[f3]:b}:{}))}}})(e,this._instance.persistence,r,s,i),this.Te(t)}}override(e,t){t===void 0&&(t=!1),ho.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return ho.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Ah),this._instance.persistence.unregister(Sp),void this.Te();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,r=e;if(this.me=!!((t=r.suppressWarning)!==null&&t!==void 0&&t),"flags"in r){if(r.flags===!1)this._instance.persistence.unregister(Ah);else if(r.flags)if(zn(r.flags)){for(var s={},i=0;i<r.flags.length;i++)s[r.flags[i]]=!0;this._instance.persistence.register({[Ah]:s})}else this._instance.persistence.register({[Ah]:r.flags})}return"payloads"in r&&(r.payloads===!1?this._instance.persistence.unregister(Sp):r.payloads&&this._instance.persistence.register({[Sp]:r.payloads})),void this.Te()}this.Te()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.be){var{flags:t,flagVariants:r}=this.Me();e(t,r)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,r){var s,i=(this._instance.get_property(qb)||[]).find(c=>c.flagKey===e),a={["$feature_enrollment/"+e]:t},o={$feature_flag:e,$feature_enrollment:t,$set:a};i&&(o.$early_access_feature_name=i.name),r&&(o.$feature_enrollment_stage=r),this._instance.capture("$feature_enrollment_update",o),this.setPersonPropertiesForFlags(a,!1);var l=ut({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[X1]:Object.keys(m3(l)),[lf]:l}),this.Te()}getEarlyAccessFeatures(e,t,r){t===void 0&&(t=!1);var s=this._instance.get_property(qb),i=r?"&"+r.map(a=>"stage="+a).join("&"):"";if(s&&!t)return e(s);this._instance.Pe({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:a=>{var o;if(a.json){var l=a.json.earlyAccessFeatures;return(o=this._instance.persistence)==null||o.register({[qb]:l}),e(l)}}})}Me(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(r=>t[r]),flagVariants:Object.keys(t).filter(r=>t[r]).reduce((r,s)=>(r[s]=t[s],r),{})}}Te(e){var{flags:t,flagVariants:r}=this.Me();this.featureFlagEventHandlers.forEach(s=>s(t,r,{errorsLoading:e}))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var r=this._instance.get_property(Hp)||{};this._instance.register({[Hp]:ut({},r,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(Hp)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var r=this._instance.get_property(Gu)||{};Object.keys(r).length!==0&&Object.keys(r).forEach(s=>{r[s]=ut({},r[s],e[s]),delete e[s]}),this._instance.register({[Gu]:ut({},r,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(Gu)||{};this._instance.register({[Gu]:ut({},t,{[e]:{}})})}else this._instance.unregister(Gu)}reset(){this.be=!1,this.ye=!1,this.we=!1,this.Se=!1,this.$e=!1,this.xe=!1,this.$anon_distinct_id=void 0,this.Ie(),this.me=!1}}var mce=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Q1{constructor(e,t){this.S=e,this.props={},this.Ce=!1,this.Fe=(r=>{var s="";return r.token&&(s=r.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),r.persistence_name?"ph_"+r.persistence_name:"ph_"+s+"_posthog"})(e),this.B=this.Oe(e),this.load(),e.debug&&pt.info("Persistence loaded",e.persistence,ut({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Ae}Oe(e){mce.indexOf(e.persistence.toLowerCase())===-1&&(pt.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&Hr.O()?Hr:t==="localstorage+cookie"&&By.O()?By:t==="sessionstorage"&&ms.O()?ms:t==="memory"?Woe:t==="cookie"?Fo:By.O()?By:Fo}properties(){var e={};return Dn(this.props,function(t,r){if(r===lf&&hr(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else o=r,l=!1,(uu(a=Roe)?l:bU&&a.indexOf===bU?a.indexOf(o)!=-1:(Dn(a,function(c){if(l||(l=c===o))return Yx}),l))||(e[r]=t);var a,o,l}),e}load(){if(!this.Ae){var e=this.B.L(this.Fe);e&&(this.props=wr({},e))}}save(){this.Ae||this.B.j(this.Fe,this.props,this.De,this.Le,this.je,this.S.debug)}remove(){this.B.N(this.Fe,!1),this.B.N(this.Fe,!0)}clear(){this.remove(),this.props={}}register_once(e,t,r){if(hr(e)){it(t)&&(t="None"),this.De=it(r)?this.Ne:r;var s=!1;if(Dn(e,(i,a)=>{this.props.hasOwnProperty(a)&&this.props[a]!==t||(this.props[a]=i,s=!0)}),s)return this.save(),!0}return!1}register(e,t){if(hr(e)){this.De=it(t)?this.Ne:t;var r=!1;if(Dn(e,(s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,r=!0)}),r)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.Ce){var e=jV(this.S.custom_campaign_params,this.S.mask_personal_data_properties,this.S.custom_personal_data_properties);of(UL(e))||this.register(e),this.Ce=!0}}update_search_keyword(){var e;this.register((e=ft?.referrer)?UV(e):{})}update_referrer_info(){var e;this.register_once({$referrer:$V(),$referring_domain:ft!=null&&ft.referrer&&((e=Uf(ft.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[xC]||this.props[wC]||this.register_once({[Zx]:BV(this.S.mask_personal_data_properties,this.S.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Dn([wC,xC],a=>{var o=this.props[a];o&&Dn(o,function(l,c){e["$initial_"+cC(c)]=l})});var t,r,s=this.props[Zx];if(s){var i=(t=HV(s),r={},Dn(t,function(a,o){r["$initial_"+cC(o)]=a}),r);wr(e,i)}return e}safe_merge(e){return Dn(this.props,function(t,r){r in e||(e[r]=t)}),e}update_config(e,t,r){if(this.Ne=this.De=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!r),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var s=this.Oe(e),i=this.props;this.clear(),this.B=s,this.props=i,this.save()}}set_disabled(e){this.Ae=e,this.Ae?this.remove():this.save()}set_cross_subdomain(e){e!==this.Le&&(this.Le=e,this.remove(),this.save())}set_secure(e){e!==this.je&&(this.je=e,this.remove(),this.save())}set_event_timer(e,t){var r=this.props[$p]||{};r[e]=t,this.props[$p]=r,this.save()}remove_event_timer(e){var t=(this.props[$p]||{})[e];return it(t)||(delete this.props[$p][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}(function(n){return n.Button="button",n.Tab="tab",n.Selector="selector",n})({});(function(n){return n.TopLeft="top_left",n.TopRight="top_right",n.TopCenter="top_center",n.MiddleLeft="middle_left",n.MiddleRight="middle_right",n.MiddleCenter="middle_center",n.Left="left",n.Center="center",n.Right="right",n.NextToTrigger="next_to_trigger",n})({});var Kb=function(n){return n.Popover="popover",n.API="api",n.Widget="widget",n.ExternalSurvey="external_survey",n}({});(function(n){return n.Open="open",n.MultipleChoice="multiple_choice",n.SingleChoice="single_choice",n.Rating="rating",n.Link="link",n})({});(function(n){return n.NextQuestion="next_question",n.End="end",n.ResponseBased="response_based",n.SpecificQuestion="specific_question",n})({});(function(n){return n.Once="once",n.Recurring="recurring",n.Always="always",n})({});var Z1=function(n){return n.SHOWN="survey shown",n.DISMISSED="survey dismissed",n.SENT="survey sent",n}({}),p3=function(n){return n.SURVEY_ID="$survey_id",n.SURVEY_NAME="$survey_name",n.SURVEY_RESPONSE="$survey_response",n.SURVEY_ITERATION="$survey_iteration",n.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",n.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",n.SURVEY_SUBMISSION_ID="$survey_submission_id",n.SURVEY_QUESTIONS="$survey_questions",n.SURVEY_COMPLETED="$survey_completed",n}({});class zV{constructor(){this.ze={},this.ze={}}on(e,t){return this.ze[e]||(this.ze[e]=[]),this.ze[e].push(t),()=>{this.ze[e]=this.ze[e].filter(r=>r!==t)}}emit(e,t){for(var r of this.ze[e]||[])r(t);for(var s of this.ze["*"]||[])s(e,t)}}class Ju{constructor(e){this.Ue=new zV,this.qe=(t,r)=>this.Be(t,r)&&this.He(t,r)&&this.We(t,r),this.Be=(t,r)=>r==null||!r.event||t?.event===r?.event,this._instance=e,this.Ge=new Set,this.Je=new Set}init(){var e;if(!it((e=this._instance)==null?void 0:e.Ve)){var t;(t=this._instance)==null||t.Ve((r,s)=>{this.on(r,s)})}}register(e){var t,r;if(!it((t=this._instance)==null?void 0:t.Ve)&&(e.forEach(a=>{var o,l;(o=this.Je)==null||o.add(a),(l=a.steps)==null||l.forEach(c=>{var u;(u=this.Ge)==null||u.add(c?.event||"")})}),(r=this._instance)!=null&&r.autocapture)){var s,i=new Set;e.forEach(a=>{var o;(o=a.steps)==null||o.forEach(l=>{l!=null&&l.selector&&i.add(l?.selector)})}),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var r;t!=null&&e.length!=0&&(this.Ge.has(e)||this.Ge.has(t?.event))&&this.Je&&((r=this.Je)==null?void 0:r.size)>0&&this.Je.forEach(s=>{this.Ke(t,s)&&this.Ue.emit("actionCaptured",s.name)})}Ye(e){this.onAction("actionCaptured",t=>e(t))}Ke(e,t){if(t?.steps==null)return!1;for(var r of t.steps)if(this.qe(e,r))return!0;return!1}onAction(e,t){return this.Ue.on(e,t)}He(e,t){if(t!=null&&t.url){var r,s=e==null||(r=e.properties)==null?void 0:r.$current_url;if(!s||typeof s!="string"||!Ju.Xe(s,t?.url,t?.url_matching||"contains"))return!1}return!0}static Xe(e,t,r){switch(r){case"regex":return!!Pe&&Bf(e,t);case"exact":return t===e;case"contains":var s=Ju.Qe(t).replace(/_/g,".").replace(/%/g,".*");return Bf(e,s);default:return!1}}static Qe(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}We(e,t){if((t!=null&&t.href||t!=null&&t.tag_name||t!=null&&t.text)&&!this.Ze(e).some(i=>!(t!=null&&t.href&&!Ju.Xe(i.href||"",t?.href,t?.href_matching||"exact"))&&(t==null||!t.tag_name||i.tag_name===t?.tag_name)&&!(t!=null&&t.text&&!Ju.Xe(i.text||"",t?.text,t?.text_matching||"exact")&&!Ju.Xe(i.$el_text||"",t?.text,t?.text_matching||"exact"))))return!1;if(t!=null&&t.selector){var r,s=e==null||(r=e.properties)==null?void 0:r.$element_selectors;if(!s||!s.includes(t?.selector))return!1}return!0}Ze(e){return e?.properties.$elements==null?[]:e?.properties.$elements}}var $r=os("[Surveys]"),MC="seenSurvey_",pce=(n,e)=>{var t="$survey_"+e+"/"+n.id;return n.current_iteration&&n.current_iteration>0&&(t="$survey_"+e+"/"+n.id+"/"+n.current_iteration),t},gce=[Kb.Popover,Kb.Widget,Kb.API];class vce{constructor(e){this._instance=e,this.tr=new Map,this.ir=new Map}register(e){var t;it((t=this._instance)==null?void 0:t.Ve)||(this.er(e),this.rr(e))}rr(e){var t=e.filter(r=>{var s,i;return((s=r.conditions)==null?void 0:s.actions)&&((i=r.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0});t.length!==0&&(this.sr==null&&(this.sr=new Ju(this._instance),this.sr.init(),this.sr.Ye(r=>{this.onAction(r)})),t.forEach(r=>{var s,i,a,o,l;r.conditions&&(s=r.conditions)!=null&&s.actions&&(i=r.conditions)!=null&&(i=i.actions)!=null&&i.values&&((a=r.conditions)==null||(a=a.actions)==null||(a=a.values)==null?void 0:a.length)>0&&((o=this.sr)==null||o.register(r.conditions.actions.values),(l=r.conditions)==null||(l=l.actions)==null||(l=l.values)==null||l.forEach(c=>{if(c&&c.name){var u=this.ir.get(c.name);u&&u.push(r.id),this.ir.set(c.name,u||[r.id])}}))}))}er(e){var t;e.filter(r=>{var s,i;return((s=r.conditions)==null?void 0:s.events)&&((i=r.conditions)==null||(i=i.events)==null||(i=i.values)==null?void 0:i.length)>0}).length!==0&&((t=this._instance)==null||t.Ve((r,s)=>{this.onEvent(r,s)}),e.forEach(r=>{var s;(s=r.conditions)==null||(s=s.events)==null||(s=s.values)==null||s.forEach(i=>{if(i&&i.name){var a=this.tr.get(i.name);a&&a.push(r.id),this.tr.set(i.name,a||[r.id])}})}))}onEvent(e,t){var r,s=((r=this._instance)==null||(r=r.persistence)==null?void 0:r.props[Uy])||[];if(e==="survey shown"&&t&&s.length>0){var i;$r.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:s});var a=t==null||(i=t.properties)==null?void 0:i.$survey_id;if(a){var o=s.indexOf(a);o>=0&&(s.splice(o,1),this.nr(s))}}else this.tr.has(e)&&($r.info("survey event matched, updating activated surveys",{event:e,surveys:this.tr.get(e)}),this.nr(s.concat(this.tr.get(e)||[])))}onAction(e){var t,r=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[Uy])||[];this.ir.has(e)&&this.nr(r.concat(this.ir.get(e)||[]))}nr(e){var t;(t=this._instance)==null||(t=t.persistence)==null||t.register({[Uy]:[...new Set(e)]})}getSurveys(){var e,t=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[Uy];return t||[]}getEventToSurveys(){return this.tr}ar(){return this.sr}}class yce{constructor(e){this.lr=void 0,this.ur=null,this.hr=!1,this.dr=!1,this.vr=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){var t=e.surveys;if(bn(t))return $r.warn("Flags not loaded yet. Not loading surveys.");var r=zn(t);this.lr=r?t.length>0:t,$r.info("flags response received, isSurveysEnabled: "+this.lr),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var r=localStorage.key(t);(r!=null&&r.startsWith(MC)||r!=null&&r.startsWith("inProgressSurvey_"))&&e.push(r)}e.forEach(s=>localStorage.removeItem(s))}loadIfEnabled(){if(!this.ur)if(this.dr)$r.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)$r.info("Disabled. Not loading surveys.");else{var e=Ut?.__PosthogExtensions__;if(e){var t=this.lr;if(!it(t)){this.dr=!0;try{var r=e.generateSurveys;if(r)return void this.cr(r,t);var s=e.loadExternalDependency;if(!s)return void this.pr("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",i=>{i||!e.generateSurveys?this.pr("Could not load surveys script",i):this.cr(e.generateSurveys,t)})}catch(i){throw this.pr("Error initializing surveys",i),i}finally{this.dr=!1}}}else $r.error("PostHog Extensions not found.")}}cr(e,t){this.ur=e(this._instance,t),this._surveyEventReceiver=new vce(this._instance),$r.info("Surveys loaded successfully"),this._r({isLoaded:!0})}pr(e,t){$r.error(e,t),this._r({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.vr.push(e),this.ur&&this._r({isLoaded:!0}),()=>{this.vr=this.vr.filter(t=>t!==e)}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return $r.info("Disabled. Not loading surveys."),e([]);var r=this._instance.get_property(vC);if(r&&!t)return e(r,{isLoaded:!0});if(this.hr)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.hr=!0,this._instance.Pe({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:s=>{var i;this.hr=!1;var a=s.statusCode;if(a!==200||!s.json){var o="Surveys API could not be loaded, status: "+a;return $r.error(o),e([],{isLoaded:!1,error:o})}var l,c=s.json.surveys||[],u=c.filter(f=>function(m){return!(!m.start_date||m.end_date)}(f)&&(function(m){var g;return!((g=m.conditions)==null||(g=g.events)==null||(g=g.values)==null||!g.length)}(f)||function(m){var g;return!((g=m.conditions)==null||(g=g.actions)==null||(g=g.values)==null||!g.length)}(f)));return u.length>0&&((l=this._surveyEventReceiver)==null||l.register(u)),(i=this._instance.persistence)==null||i.register({[vC]:c}),e(c,{isLoaded:!0})}})}catch(s){throw this.hr=!1,s}}_r(e){for(var t of this.vr)try{e.isLoaded?this.getSurveys(t):t([],e)}catch(r){$r.error("Error in survey callback",r)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!bn(this.ur))return this.ur.getActiveMatchingSurveys(e,t);$r.warn("init was not called")}gr(e){var t=null;return this.getSurveys(r=>{var s;t=(s=r.find(i=>i.id===e))!==null&&s!==void 0?s:null}),t}mr(e){if(bn(this.ur))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.gr(e):e;return t?this.ur.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(bn(this.ur))return $r.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.mr(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return bn(this.ur)?($r.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(r=>{this.getSurveys(s=>{var i,a=(i=s.find(l=>l.id===e))!==null&&i!==void 0?i:null;if(a){var o=this.mr(a);r({visible:o.eligible,disabledReason:o.reason})}else r({visible:!1,disabledReason:"Survey not found"})},t)})}br(e,t,r){if(bn(this.ur))$r.warn("init was not called");else{var s=this.gr(e);if(s)if(r.includes(s.type)){var i=ft?.querySelector(t);i?this.ur.renderSurvey(s,i):$r.warn("Survey element not found")}else $r.warn("Surveys of type "+s.type+" are cannot be rendered in the app");else $r.warn("Survey not found")}}renderSurvey(e,t){this.br(e,t,gce)}_renderExternalSurvey(e,t){this.br(e,t,[Kb.ExternalSurvey])}}var g3=os("[RateLimiter]");class bce{constructor(e){var t,r;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=s=>{var i=s.text;if(i&&i.length)try{(JSON.parse(i).quota_limited||[]).forEach(a=>{g3.info((a||"events")+" is quota limited."),this.serverLimits[a]=new Date().getTime()+6e4})}catch(a){return void g3.warn('could not rate limit - continuing. Error: "'+a?.message+'"',{text:i})}},this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)==null?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((r=e.config.rate_limiting)==null?void 0:r.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,r,s;e===void 0&&(e=!1);var i=new Date().getTime(),a=(t=(r=this.instance.persistence)==null?void 0:r.get_property(bC))!==null&&t!==void 0?t:{tokens:this.captureEventsBurstLimit,last:i};a.tokens+=(i-a.last)/1e3*this.captureEventsPerSecond,a.last=i,a.tokens>this.captureEventsBurstLimit&&(a.tokens=this.captureEventsBurstLimit);var o=a.tokens<1;return o||e||(a.tokens=Math.max(0,a.tokens-1)),!o||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,(s=this.instance.persistence)==null||s.set_property(bC,a),{isRateLimited:o,remainingTokens:a.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Uu=os("[RemoteConfig]");class xce{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=Ut._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}yr(e){var t,r;(t=Ut.__PosthogExtensions__)!=null&&t.loadExternalDependency?(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(Uu.error("PostHog Extensions not found. Cannot load remote config."),e())}wr(e){this._instance.Pe({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Uu.info("Using preloaded remote config",this.remoteConfig),void this.Re(this.remoteConfig);if(this._instance.I())return void Uu.warn("Remote config is disabled. Falling back to local config.");this.yr(e=>{if(!e)return Uu.info("No config found after loading remote JS config. Falling back to JSON."),void this.wr(t=>{this.Re(t)});this.Re(e)})}catch(e){Uu.error("Error loading remote config",e)}}Re(e){e?this._instance.config.__preview_remote_config?(this._instance.Re(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Uu.info("__preview_remote_config is disabled. Logging config instead",e):Uu.error("Failed to fetch remote config from PostHog.")}}var OC=3e3;class wce{constructor(e,t){this.Sr=!0,this.$r=[],this.kr=Oi(t?.flush_interval_ms||OC,250,5e3,"flush interval",OC),this.Er=e}enqueue(e){this.$r.push(e),this.Ir||this.Pr()}unload(){this.Rr();var e=this.$r.length>0?this.Tr():{},t=Object.values(e);[...t.filter(r=>r.url.indexOf("/e")===0),...t.filter(r=>r.url.indexOf("/e")!==0)].map(r=>{this.Er(ut({},r,{transport:"sendBeacon"}))})}enable(){this.Sr=!1,this.Pr()}Pr(){var e=this;this.Sr||(this.Ir=setTimeout(()=>{if(this.Rr(),this.$r.length>0){var t=this.Tr(),r=function(){var i=t[s],a=new Date().getTime();i.data&&zn(i.data)&&Dn(i.data,o=>{o.offset=Math.abs(o.timestamp-a),delete o.timestamp}),e.Er(i)};for(var s in t)r()}},this.kr))}Rr(){clearTimeout(this.Ir),this.Ir=void 0}Tr(){var e={};return Dn(this.$r,t=>{var r,s=t,i=(s?s.batchKey:null)||s.url;it(e[i])&&(e[i]=ut({},s,{data:[]})),(r=e[i].data)==null||r.push(s.data)}),this.$r=[],e}}var Ece=["retriesPerformedSoFar"];class Sce{constructor(e){this.Mr=!1,this.Cr=3e3,this.$r=[],this._instance=e,this.$r=[],this.Fr=!0,!it(Pe)&&"onLine"in Pe.navigator&&(this.Fr=Pe.navigator.onLine,rr(Pe,"online",()=>{this.Fr=!0,this.se()}),rr(Pe,"offline",()=>{this.Fr=!1}))}get length(){return this.$r.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,r=BH(e,Ece);Is(t)&&t>0&&(r.url=ow(r.url,{retry_count:t})),this._instance.Pe(ut({},r,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.Or(ut({retriesPerformedSoFar:t},r)):r.callback==null||r.callback(s)}}))}Or(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var r=function(a){var o=3e3*Math.pow(2,a),l=o/2,c=Math.min(18e5,o),u=(Math.random()-.5)*(c-l);return Math.ceil(c+u)}(t),s=Date.now()+r;this.$r.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+r;navigator.onLine||(i+=" (Browser is offline)"),pt.warn(i),this.Mr||(this.Mr=!0,this.Ar())}Ar(){this.Dr&&clearTimeout(this.Dr),this.Dr=setTimeout(()=>{this.Fr&&this.$r.length>0&&this.se(),this.Ar()},this.Cr)}se(){var e=Date.now(),t=[],r=this.$r.filter(i=>i.retryAt<e||(t.push(i),!1));if(this.$r=t,r.length>0)for(var{requestOptions:s}of r)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Dr&&(clearTimeout(this.Dr),this.Dr=void 0),this.$r))try{this._instance.Pe(ut({},e,{transport:"sendBeacon"}))}catch(t){pt.error(t)}this.$r=[]}}class Tce{constructor(e){this.Lr=()=>{var t,r,s,i;this.jr||(this.jr={});var a=this.scrollElement(),o=this.scrollY(),l=a?Math.max(0,a.scrollHeight-a.clientHeight):0,c=o+(a?.clientHeight||0),u=a?.scrollHeight||0;this.jr.lastScrollY=Math.ceil(o),this.jr.maxScrollY=Math.max(o,(t=this.jr.maxScrollY)!==null&&t!==void 0?t:0),this.jr.maxScrollHeight=Math.max(l,(r=this.jr.maxScrollHeight)!==null&&r!==void 0?r:0),this.jr.lastContentY=c,this.jr.maxContentY=Math.max(c,(s=this.jr.maxContentY)!==null&&s!==void 0?s:0),this.jr.maxContentHeight=Math.max(u,(i=this.jr.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.jr}resetContext(){var e=this.jr;return setTimeout(this.Lr,0),e}startMeasuringScrollPosition(){rr(Pe,"scroll",this.Lr,{capture:!0}),rr(Pe,"scrollend",this.Lr,{capture:!0}),rr(Pe,"resize",this.Lr)}scrollElement(){if(!this._instance.config.scroll_root_selector)return Pe?.document.documentElement;var e=zn(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var r=Pe?.document.querySelector(t);if(r)return r}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return Pe&&(Pe.scrollY||Pe.pageYOffset||Pe.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return Pe&&(Pe.scrollX||Pe.pageXOffset||Pe.document.documentElement.scrollLeft)||0}}var _ce=n=>BV(n?.config.mask_personal_data_properties,n?.config.custom_personal_data_properties);class Ace{constructor(e,t,r,s){this.Nr=i=>{var a=this.zr();if(!a||a.sessionId!==i){var o={sessionId:i,props:this.Ur(this._instance)};this.qr.register({[yC]:o})}},this._instance=e,this.Br=t,this.qr=r,this.Ur=s||_ce,this.Br.onSessionId(this.Nr)}zr(){return this.qr.props[yC]}getSetOnceProps(){var e,t=(e=this.zr())==null?void 0:e.props;return t?"r"in t?HV(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return Dn(UL(this.getSetOnceProps()),(t,r)=>{r==="$current_url"&&(r="url"),e["$session_entry_"+cC(r)]=t}),e}}var v3=os("[SessionId]");class Rce{constructor(e,t,r){var s;if(this.Hr=[],this.Wr=(u,f)=>Math.abs(u-f)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.S=e.config,this.qr=e.persistence,this.fi=void 0,this.Ct=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Gr=t||zc,this.Jr=r||zc;var i=this.S.persistence_name||this.S.token,a=this.S.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*Oi(a,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Vr(),this.Kr="ph_"+i+"_window_id",this.Yr="ph_"+i+"_primary_window_exists",this.Xr()){var o=ms.L(this.Kr),l=ms.L(this.Yr);o&&!l?this.fi=o:ms.N(this.Kr),ms.j(this.Yr,!0)}if((s=this.S.bootstrap)!=null&&s.sessionID)try{var c=(u=>{var f=u.replace(/-/g,"");if(f.length!==32)throw new Error("Not a valid UUID");if(f[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(f.substring(0,12),16)})(this.S.bootstrap.sessionID);this.Qr(this.S.bootstrap.sessionID,new Date().getTime(),c)}catch(u){v3.error("Invalid sessionID in bootstrap",u)}this.Zr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return it(this.Hr)&&(this.Hr=[]),this.Hr.push(e),this.Ct&&e(this.Ct,this.fi),()=>{this.Hr=this.Hr.filter(t=>t!==e)}}Xr(){return this.S.persistence!=="memory"&&!this.qr.Ae&&ms.O()}ts(e){e!==this.fi&&(this.fi=e,this.Xr()&&ms.j(this.Kr,e))}es(){return this.fi?this.fi:this.Xr()?ms.L(this.Kr):null}Qr(e,t,r){e===this.Ct&&t===this._sessionActivityTimestamp&&r===this._sessionStartTimestamp||(this._sessionStartTimestamp=r,this._sessionActivityTimestamp=t,this.Ct=e,this.qr.register({[Xx]:[t,e,r]}))}rs(){if(this.Ct&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Ct,this._sessionStartTimestamp];var e=this.qr.props[Xx];return zn(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Qr(null,null,null)}Zr(){rr(Pe,"beforeunload",()=>{this.Xr()&&ms.N(this.Yr)},{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.S.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var r=t||new Date().getTime(),[s,i,a]=this.rs(),o=this.es(),l=Is(a)&&a>0&&Math.abs(r-a)>864e5,c=!1,u=!i,f=!e&&this.Wr(r,s);u||f||l?(i=this.Gr(),o=this.Jr(),v3.info("new session ID generated",{sessionId:i,windowId:o,changeReason:{noSessionId:u,activityTimeout:f,sessionPastMaximumLength:l}}),a=r,c=!0):o||(o=this.Jr(),c=!0);var m=s===0||!e||l?r:s,g=a===0?new Date().getTime():a;return this.ts(o),this.Qr(i,m,g),e||this.Vr(),c&&this.Hr.forEach(y=>y(i,o,c?{noSessionId:u,activityTimeout:f,sessionPastMaximumLength:l}:void 0)),{sessionId:i,windowId:o,sessionStartTimestamp:g,changeReason:c?{noSessionId:u,activityTimeout:f,sessionPastMaximumLength:l}:void 0,lastActivityTimestamp:s}}Vr(){clearTimeout(this.ss),this.ss=setTimeout(()=>{var[e]=this.rs();this.Wr(new Date().getTime(),e)&&this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var Cce=["$set_once","$set"],gc=os("[SiteApps]");class kce{constructor(e){this._instance=e,this.ns=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}os(e,t){if(t){var r=this.globalsForEvent(t);this.ns.push(r),this.ns.length>1e3&&(this.ns=this.ns.slice(10))}}get siteAppLoaders(){var e;return(e=Ut._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ve(this.os.bind(this));this.ls=()=>{e(),this.ns=[],this.ls=void 0}}}globalsForEvent(e){var t,r,s,i,a,o,l;if(!e)throw new Error("Event payload is required");var c={},u=this._instance.get_property("$groups")||[],f=this._instance.get_property("$stored_group_properties")||{};for(var[m,g]of Object.entries(f))c[m]={id:u[m],type:m,properties:g};var{$set_once:y,$set:b}=e;return{event:ut({},BH(e,Cce),{properties:ut({},e.properties,b?{$set:ut({},(t=(r=e.properties)==null?void 0:r.$set)!==null&&t!==void 0?t:{},b)}:{},y?{$set_once:ut({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},y)}:{}),elements_chain:(a=(o=e.properties)==null?void 0:o.$elements_chain)!==null&&a!==void 0?a:"",distinct_id:(l=e.properties)==null?void 0:l.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:c}}setupSiteApp(e){var t=this.apps[e.id],r=()=>{var o;!t.errored&&this.ns.length&&(gc.info("Processing "+this.ns.length+" events for site app with id "+e.id),this.ns.forEach(l=>t.processEvent==null?void 0:t.processEvent(l)),t.processedBuffer=!0),Object.values(this.apps).every(l=>l.processedBuffer||l.errored)&&((o=this.ls)==null||o.call(this))},s=!1,i=o=>{t.errored=!o,t.loaded=!0,gc.info("Site app with id "+e.id+" "+(o?"loaded":"errored")),s&&r()};try{var{processEvent:a}=e.init({posthog:this._instance,callback:o=>{i(o)}});a&&(t.processEvent=a),s=!0}catch(o){gc.error("Error while initializing PostHog app with config id "+e.id,o),i(!1)}if(s&&t.loaded)try{r()}catch(o){gc.error("Error while processing buffered events PostHog app with config id "+e.id,o),t.errored=!0}}us(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var r of e)this.setupSiteApp(r)}hs(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var r of Object.values(this.apps))try{r.processEvent==null||r.processEvent(t)}catch(s){gc.error("Error while processing event "+e.event+" for site app "+r.id,s)}}}onRemoteConfig(e){var t,r,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.us(),void this._instance.on("eventCaptured",c=>this.hs(c))):void gc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((r=this.ls)==null||r.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var a=function(c){var u;Ut["__$$ph_site_app_"+c]=i._instance,(u=Ut.__PosthogExtensions__)==null||u.loadSiteApp==null||u.loadSiteApp(i._instance,l,f=>{if(f)return gc.error("Error while initializing PostHog app with config id "+c,f)})};for(var{id:o,url:l}of e.siteApps)a(o)}else gc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var Ice=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],y3=function(n,e){if(!n)return!1;var t=n.toLowerCase();return Ice.concat(e||[]).some(r=>{var s=r.toLowerCase();return t.indexOf(s)!==-1})},GV=function(n,e){if(!n)return!1;var t=n.userAgent;if(t&&y3(t,e))return!0;try{var r=n?.userAgentData;if(r!=null&&r.brands&&r.brands.some(s=>y3(s?.brand,e)))return!0}catch{}return!!n.webdriver},qp=function(n){return n.US="us",n.EU="eu",n.CUSTOM="custom",n}({}),b3="i.posthog.com";let Lce=class{constructor(e){this.ds={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+b3,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.ds[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.ds[this.apiHost]=qp.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.ds[this.apiHost]=qp.EU:this.ds[this.apiHost]=qp.CUSTOM),this.ds[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(this.region===qp.CUSTOM)return this.apiHost+t;var r=b3+t;switch(e){case"assets":return"https://"+this.region+"-assets."+r;case"api":return"https://"+this.region+"."+r}}};var Dce={icontains:(n,e)=>!!Pe&&e.href.toLowerCase().indexOf(n.toLowerCase())>-1,not_icontains:(n,e)=>!!Pe&&e.href.toLowerCase().indexOf(n.toLowerCase())===-1,regex:(n,e)=>!!Pe&&Bf(e.href,n),not_regex:(n,e)=>!!Pe&&!Bf(e.href,n),exact:(n,e)=>e.href===n,is_not:(n,e)=>e.href!==n};class _s{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(r){r===void 0&&(r=!1),t.getWebExperiments(s=>{_s.vs("retrieved web experiments from the server"),t.cs=new Map,s.forEach(i=>{if(i.feature_flag_key){var a;t.cs&&(_s.vs("setting flag key ",i.feature_flag_key," to web experiment ",i),(a=t.cs)==null||a.set(i.feature_flag_key,i));var o=t._instance.getFeatureFlag(i.feature_flag_key);fr(o)&&i.variants[o]&&t.fs(i.name,o,i.variants[o].transforms)}else if(i.variants)for(var l in i.variants){var c=i.variants[l];_s.ps(c)&&t.fs(i.name,l,c.transforms)}})},r)},this._instance=e,this._instance.onFeatureFlags(r=>{this.onFeatureFlags(r)})}onFeatureFlags(e){if(this._is_bot())_s.vs("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(bn(this.cs))return this.cs=new Map,this.loadIfEnabled(),void this.previewWebExperiment();_s.vs("applying feature flags",e),e.forEach(t=>{var r;if(this.cs&&(r=this.cs)!=null&&r.has(t)){var s,i=this._instance.getFeatureFlag(t),a=(s=this.cs)==null?void 0:s.get(t);i&&a!=null&&a.variants[i]&&this.fs(a.name,i,a.variants[i].transforms)}})}}previewWebExperiment(){var e=_s.getWindowLocation();if(e!=null&&e.search){var t=tw(e?.search,"__experiment_id"),r=tw(e?.search,"__experiment_variant");t&&r&&(_s.vs("previewing web experiments "+t+" && "+r),this.getWebExperiments(s=>{this._s(parseInt(t),r,s)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,r){if(this._instance.config.disable_web_experiments&&!r)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance.Pe({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var a=i.json.experiments||[];return e(a)}})}_s(e,t,r){var s=r.filter(i=>i.id===e);s&&s.length>0&&(_s.vs("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.fs(s[0].name,t,s[0].variants[t].transforms))}static ps(e){return!bn(e.conditions)&&_s.gs(e)&&_s.bs(e)}static gs(e){var t;if(bn(e.conditions)||bn((t=e.conditions)==null?void 0:t.url))return!0;var r,s,i,a=_s.getWindowLocation();return!!a&&((r=e.conditions)==null||!r.url||Dce[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,a))}static getWindowLocation(){return Pe?.location}static bs(e){var t;if(bn(e.conditions)||bn((t=e.conditions)==null?void 0:t.utm))return!0;var r=jV();if(r.utm_source){var s,i,a,o,l,c,u,f,m=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==r.utm_campaign,g=(a=e.conditions)==null||(a=a.utm)==null||!a.utm_source||((o=e.conditions)==null||(o=o.utm)==null?void 0:o.utm_source)==r.utm_source,y=(l=e.conditions)==null||(l=l.utm)==null||!l.utm_medium||((c=e.conditions)==null||(c=c.utm)==null?void 0:c.utm_medium)==r.utm_medium,b=(u=e.conditions)==null||(u=u.utm)==null||!u.utm_term||((f=e.conditions)==null||(f=f.utm)==null?void 0:f.utm_term)==r.utm_term;return m&&y&&b&&g}return!1}static vs(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];pt.info("[WebExperiments] "+e,r)}fs(e,t,r){this._is_bot()?_s.vs("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?r.forEach(s=>{if(s.selector){var i;_s.vs("applying transform of variant "+t+" for experiment "+e+" ",s);var a=(i=document)==null?void 0:i.querySelectorAll(s.selector);a?.forEach(o=>{var l=o;s.html&&(l.innerHTML=s.html),s.css&&l.setAttribute("style",s.css)})}}):_s.vs("Control variants leave the page unmodified.")}_is_bot(){return Mi&&this._instance?GV(Mi,this._instance.config.custom_blocked_useragents):void 0}}var Pce=os("[PostHog ExternalIntegrations]"),Mce={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class Oce{constructor(e){this._instance=e}J(e,t){var r;(r=Ut.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,e,s=>{if(s)return Pce.error("failed to load script",s);t()})}startIfEnabledOrStop(){var e=this,t=function(a){var o,l,c;!s||(o=Ut.__PosthogExtensions__)!=null&&(o=o.integrations)!=null&&o[a]||e.J(Mce[a],()=>{var u;(u=Ut.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[a])==null||u.start(e._instance)}),!s&&(l=Ut.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[a]&&((c=Ut.__PosthogExtensions__)==null||(c=c.integrations)==null||(c=c[a])==null||c.stop())};for(var[r,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(r)}}}var pg={},NC=()=>{},zh="posthog",qV=!Kle&&si?.indexOf("MSIE")===-1&&si?.indexOf("Mozilla")===-1,x3=n=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:Aoe(ft?.location),persistence:"localStorage+cookie",persistence_name:"",loaded:NC,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:n!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:n??"unset",debug:li&&fr(li?.search)&&li.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(Pe==null||(e=Pe.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var r="Bad HTTP status: "+t.statusCode+" "+t.text;pt.error(r)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:OC},error_tracking:{},_onCapture:NC}},w3=n=>{var e={};it(n.process_person)||(e.person_profiles=n.process_person),it(n.xhr_headers)||(e.request_headers=n.xhr_headers),it(n.cookie_name)||(e.persistence_name=n.cookie_name),it(n.disable_cookie)||(e.disable_persistence=n.disable_cookie),it(n.store_google)||(e.save_campaign_params=n.store_google),it(n.verbose)||(e.debug=n.verbose);var t=wr({},e,n);return zn(n.property_blacklist)&&(it(n.property_denylist)?t.property_denylist=n.property_blacklist:zn(n.property_denylist)?t.property_denylist=[...n.property_blacklist,...n.property_denylist]:pt.error("Invalid value for property_denylist config: "+n.property_denylist)),t};class Nce{constructor(){this.__forceAllowLocalhost=!1}get ys(){return this.__forceAllowLocalhost}set ys(e){pt.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class tS{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new Nce,this.ws=!1,this.version=Pl.LIB_VERSION,this.Ss=new zV,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=x3(),this.SentryIntegration=Fle,this.sentryIntegration=e=>function(t,r){var s=xV(t,r);return{name:bV,processEvent:i=>s(i)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.$s=!1,this.xs=null,this.ks=null,this.Es=null,this.featureFlags=new fce(this),this.toolbar=new $le(this),this.scrollManager=new Tce(this),this.pageViewManager=new qle(this),this.surveys=new yce(this),this.experiments=new _s(this),this.exceptions=new Xle(this),this.rateLimiter=new bce(this),this.requestRouter=new Lce(this),this.consent=new Koe(this),this.externalIntegrations=new Oce(this),this.people={set:(e,t,r)=>{var s=fr(e)?{[e]:t}:e;this.setPersonProperties(s),r?.({})},set_once:(e,t,r)=>{var s=fr(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),r?.({})}},this.on("eventCaptured",e=>pt.info('send "'+e?.event+'"',e))}init(e,t,r){if(r&&r!==zh){var s,i=(s=pg[r])!==null&&s!==void 0?s:new tS;return i._init(e,t,r),pg[r]=i,pg[zh][r]=i,i}return this._init(e,t,r)}_init(e,t,r){var s,i;if(t===void 0&&(t={}),it(e)||uC(e))return pt.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return pt.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.Is=t,this.Ps=[],t.person_profiles&&(this.ks=t.person_profiles),this.set_config(wr({},x3(t.defaults),w3(t),{name:r,token:e})),this.config.on_xhr_error&&pt.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Ol.GZipJS;var a=this.Rs();this.persistence=new Q1(this.config,a),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Q1(ut({},this.config,{persistence:"sessionStorage"}),a);var o=ut({},this.persistence.props),l=ut({},this.sessionPersistence.props);if(this.register({$initialization_time:new Date().toISOString()}),this.Ts=new wce(T=>this.Ms(T),this.config.request_queue_config),this.Cs=new Sce(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new Rce(this),this.sessionPropsManager=new Ace(this,this.sessionManager,this.persistence)),new Hle(this).startIfEnabledOrStop(),this.siteApps=new kce(this),(s=this.siteApps)==null||s.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new Nle(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new $oe(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Gle(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new Vle(this),this.exceptionObserver=new Qoe(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new sV(this,Xoe),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new dle(this),this.historyAutocapture.startIfEnabled(),Pl.DEBUG=Pl.DEBUG||this.config.debug,Pl.DEBUG&&pt.info("Starting in debug mode",{this:this,config:t,thisC:ut({},this.config),p:o,s:l}),((i=t.bootstrap)==null?void 0:i.distinctID)!==void 0){var c,u,f=this.config.get_device_id(zc()),m=(c=t.bootstrap)!=null&&c.isIdentifiedID?f:t.bootstrap.distinctID;this.persistence.set_property(Rl,(u=t.bootstrap)!=null&&u.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:m})}if(this.Fs()){var g,y,b=Object.keys(((g=t.bootstrap)==null?void 0:g.featureFlags)||{}).filter(T=>{var _;return!((_=t.bootstrap)==null||(_=_.featureFlags)==null||!_[T])}).reduce((T,_)=>{var R;return T[_]=((R=t.bootstrap)==null||(R=R.featureFlags)==null?void 0:R[_])||!1,T},{}),x=Object.keys(((y=t.bootstrap)==null?void 0:y.featureFlagPayloads)||{}).filter(T=>b[T]).reduce((T,_)=>{var R,I;return(R=t.bootstrap)!=null&&(R=R.featureFlagPayloads)!=null&&R[_]&&(T[_]=(I=t.bootstrap)==null||(I=I.featureFlagPayloads)==null?void 0:I[_]),T},{});this.featureFlags.receivedFeatureFlags({featureFlags:b,featureFlagPayloads:x})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:$y,$device_id:null},"");else if(!this.get_distinct_id()){var S=this.config.get_device_id(zc());this.register_once({distinct_id:S,$device_id:S},""),this.persistence.set_property(Rl,"anonymous")}return rr(Pe,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?jle(this,()=>this.Os()):this.Os(),ma(this.config._onCapture)&&this.config._onCapture!==NC&&(pt.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",T=>this.config._onCapture(T.event,T))),this.config.ip&&pt.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}Re(e){var t,r,s,i,a,o,l,c;if(!ft||!ft.body)return pt.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.Re(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=on(e.supportedCompression,Ol.GZipJS)?Ol.GZipJS:on(e.supportedCompression,Ol.Base64)?Ol.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.ks?this.ks:"identified_only"}),(r=this.siteApps)==null||r.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(a=this.heatmaps)==null||a.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(o=this.webVitalsAutocapture)==null||o.onRemoteConfig(e),(l=this.exceptionObserver)==null||l.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(c=this.deadClicksAutocapture)==null||c.onRemoteConfig(e)}Os(){try{this.config.loaded(this)}catch(e){pt.critical("`loaded` function failed",e)}this.As(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this.Ds()},1),new xce(this).load(),this.featureFlags.flags()}As(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this.Ts)==null||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||qc(this.__request_queue,e=>this.Ms(e)),this.__request_queue=[],this.As()}_handle_unload(){var e,t;this.config.request_batching?(this.Ls()&&this.capture("$pageleave"),(e=this.Ts)==null||e.unload(),(t=this.Cs)==null||t.unload()):this.Ls()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}Pe(e){this.__loaded&&(qV?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=ow(e.url,{ip:this.config.ip?1:0}),e.headers=ut({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var r,s,i,a=ut({},t);a.timeout=a.timeout||6e4,a.url=ow(a.url,{_:new Date().getTime().toString(),ver:Pl.LIB_VERSION,compression:a.compression});var o=(r=a.transport)!==null&&r!==void 0?r:"fetch",l=(s=(i=HH(mg,c=>c.transport===o))==null?void 0:i.method)!==null&&s!==void 0?s:mg[0].method;if(!l)throw new Error("No available transport method");l(a)})(ut({},e,{callback:t=>{var r,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((r=(s=this.config).on_request_error)==null||r.call(s,t)),e.callback==null||e.callback(t)}}))))}Ms(e){this.Cs?this.Cs.retriableRequest(e):this.Pe(e)}_execute_array(e){var t,r=[],s=[],i=[];qc(e,o=>{o&&(t=o[0],zn(t)?i.push(o):ma(o)?o.call(this):zn(o)&&t==="alias"?r.push(o):zn(o)&&t.indexOf("capture")!==-1&&ma(this[t])?i.push(o):s.push(o))});var a=function(o,l){qc(o,function(c){if(zn(c[0])){var u=l;Dn(c,function(f){u=u[f[0]].apply(u,f.slice(1))})}else this[c[0]].apply(this,c.slice(1))},l)};a(r,this),a(s,this),a(i,this)}Fs(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,r){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Ts){if(!this.consent.isOptedOut())if(!it(e)&&fr(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var i=r!=null&&r.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(i==null||!i.isRateLimited){t!=null&&t.$current_url&&!fr(t?.$current_url)&&(pt.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var a=new Date,o=r?.timestamp||a,l=zc(),c={uuid:l,event:e,properties:this.calculateEventProperties(e,t||{},o,l)};i&&(c.properties.$lib_rate_limit_remaining_tokens=i.remainingTokens),r?.$set&&(c.$set=r?.$set);var u,f,m=this.js(r?.$set_once);if(m&&(c.$set_once=m),(c=Toe(c,r!=null&&r._noTruncate?null:this.config.properties_string_max_length)).timestamp=o,it(r?.timestamp)||(c.properties.$event_time_override_provided=!0,c.properties.$event_time_override_system_time=a),e===Z1.DISMISSED||e===Z1.SENT){var g=t?.[p3.SURVEY_ID],y=t?.[p3.SURVEY_ITERATION];localStorage.setItem((f=""+MC+(u={id:g,current_iteration:y}).id,u.current_iteration&&u.current_iteration>0&&(f=""+MC+u.id+"_"+u.current_iteration),f),"true"),c.$set=ut({},c.$set,{[pce({id:g,current_iteration:y},e===Z1.SENT?"responded":"dismissed")]:!0})}var b=ut({},c.properties.$set,c.$set);if(of(b)||this.setPersonPropertiesForFlags(b),!bn(this.config.before_send)){var x=this.Ns(c);if(!x)return;c=x}this.Ss.emit("eventCaptured",c);var S={method:"POST",url:(s=r?._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:c,compression:"best-available",batchKey:r?._batchKey};return!this.config.request_batching||r&&(r==null||!r._batchKey)||r!=null&&r.send_instantly?this.Ms(S):this.Ts.enqueue(S),c}pt.critical("This capture call is ignored due to client rate limiting.")}}else pt.error("No event name provided to posthog.capture")}else pt.uninitializedWarning("posthog.capture")}Ve(e){return this.on("eventCaptured",t=>e(t.event,t))}calculateEventProperties(e,t,r,s,i){if(r=r||new Date,!this.persistence||!this.sessionPersistence)return t;var a=i?void 0:this.persistence.remove_event_timer(e),o=ut({},t);if(o.token=this.config.token,o.$config_defaults=this.config.defaults,this.config.__preview_experimental_cookieless_mode&&(o.$cookieless_mode=!0),e==="$snapshot"){var l=ut({},this.persistence.properties(),this.sessionPersistence.properties());return o.distinct_id=l.distinct_id,(!fr(o.distinct_id)&&!Is(o.distinct_id)||uC(o.distinct_id))&&pt.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),o}var c,u=uce(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:f,windowId:m}=this.sessionManager.checkAndGetSessionAndWindowId(i,r.getTime());o.$session_id=f,o.$window_id=m}this.sessionPropsManager&&wr(o,this.sessionPropsManager.getSessionProps());try{var g;this.sessionRecording&&wr(o,this.sessionRecording.sdkDebugProperties),o.$sdk_debug_retry_queue_size=(g=this.Cs)==null?void 0:g.length}catch(S){o.$sdk_debug_error_capturing_properties=String(S)}if(this.requestRouter.region===qp.CUSTOM&&(o.$lib_custom_api_host=this.config.api_host),c=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(r):this.pageViewManager.doPageView(r,s),o=wr(o,c),e==="$pageview"&&ft&&(o.title=ft.title),!it(a)){var y=r.getTime()-a;o.$duration=parseFloat((y/1e3).toFixed(3))}si&&this.config.opt_out_useragent_filter&&(o.$browser_type=this._is_bot()?"bot":"browser"),(o=wr({},u,this.persistence.properties(),this.sessionPersistence.properties(),o)).$is_identified=this._isIdentified(),zn(this.config.property_denylist)?Dn(this.config.property_denylist,function(S){delete o[S]}):pt.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var b=this.config.sanitize_properties;b&&(pt.error("sanitize_properties is deprecated. Use before_send instead"),o=b(o,e));var x=this.zs();return o.$process_person_profile=x,x&&!i&&this.Us("_calculate_event_properties"),o}js(e){var t;if(!this.persistence||!this.zs()||this.ws)return e;var r=this.persistence.get_initial_props(),s=(t=this.sessionPropsManager)==null?void 0:t.getSetOnceProps(),i=wr({},r,s||{},e||{}),a=this.config.sanitize_properties;return a&&(pt.error("sanitize_properties is deprecated. Use before_send instead"),i=a(i,"$set_once")),this.ws=!0,of(i)?void 0:i}register(e,t){var r;(r=this.persistence)==null||r.register(e,t)}register_once(e,t,r){var s;(s=this.persistence)==null||s.register_once(e,t,r)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}qs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t,r){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,r)}getEarlyAccessFeatures(e,t,r){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,r)}on(e,t){return this.Ss.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,r;return(t=(r=this.sessionManager)==null?void 0:r.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,r){if(!this.__loaded||!this.persistence)return pt.uninitializedWarning("posthog.identify");if(Is(e)&&(e=e.toString(),pt.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))pt.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==$y){if(this.Us("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(Up)&&(this.unregister(Up),this.register({distinct_id:e}));var a=(this.persistence.get_property(Rl)||"anonymous")==="anonymous";e!==s&&a?(this.persistence.set_property(Rl,"identified"),this.setPersonPropertiesForFlags(ut({},r||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:r||{}}),this.Es=a3(e,t,r),this.featureFlags.setAnonymousDistinctId(s)):(t||r)&&this.setPersonProperties(t,r),e!==s&&(this.reloadFeatureFlags(),this.unregister(Qx))}}else pt.critical('The string "'+$y+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else pt.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Us("posthog.setPersonProperties")){var r=a3(this.get_distinct_id(),e,t);this.Es!==r?(this.setPersonPropertiesForFlags(ut({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Es=r):pt.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,r){if(e&&t){if(this.Us("posthog.group")){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:ut({},s,{[e]:t})}),r&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:r}),this.setGroupPropertiesForFlags({[e]:r})),s[e]===t||r||this.reloadFeatureFlags()}}else pt.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.Us("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,r,s,i;if(pt.info("reset"),!this.__loaded)return pt.uninitializedWarning("posthog.reset");var a=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(r=this.sessionPersistence)==null||r.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(Rl,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Es=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:$y,$device_id:null},"");else{var o=this.config.get_device_id(zc());this.register_once({distinct_id:o,$device_id:e?o:a},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:r}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&r){var i,a=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!r)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-r)/1e3)-a,0)}return s}alias(e,t){return e===this.get_property(VH)?(pt.critical("Attempting to create alias for existing People user - aborting."),-2):this.Us("posthog.alias")?(it(t)&&(t=this.get_distinct_id()),e!==t?(this.qs(Up,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(pt.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=ut({},this.config);if(hr(e)){var r,s,i,a,o;wr(this.config,w3(e));var l=this.Rs();(r=this.persistence)==null||r.update_config(this.config,t,l),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Q1(ut({},this.config,{persistence:"sessionStorage"}),l),Hr.O()&&Hr.D("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Pl.DEBUG=!0,pt.info("set_config",{config:e,oldConfig:t,newConfig:ut({},this.config)})),(s=this.sessionRecording)==null||s.startIfEnabledOrStop(),(i=this.autocapture)==null||i.startIfEnabled(),(a=this.heatmaps)==null||a.startIfEnabled(),this.surveys.loadIfEnabled(),this.Bs(),(o=this.externalIntegrations)==null||o.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,r={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(r).some(Boolean)){var s,i,a,o,l;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),r.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),r.linked_flag&&((a=this.sessionRecording)==null||a.overrideLinkedFlag()),r.url_trigger&&((o=this.sessionRecording)==null||o.overrideTrigger("url")),r.event_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var r=new Error("PostHog syntheticException");return this.exceptions.sendExceptionEvent(ut({},ule((s=>s instanceof Error)(e)?{error:e,event:e.message}:{event:e},{syntheticException:r}),t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:zh;return t!==zh&&(t=zh+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(Rl))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(Rl))==="identified"}zs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&of(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[Up])&&((t=this.persistence)==null||(t=t.props)==null||!t[Jx]))}Ls(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.zs()||this.Us("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Us(e){return this.config.person_profiles==="never"?(pt.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.qs(Jx,!0),!0)}Rs(){var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default;return this.config.disable_persistence||e&&!!t}Bs(){var e,t,r,s,i=this.Rs();return((e=this.persistence)==null?void 0:e.Ae)!==i&&((r=this.persistence)==null||r.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Ae)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;this.consent.optInOut(!0),this.Bs(),(it(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((t=e?.captureEventName)!==null&&t!==void 0?t:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Ds()}opt_out_capturing(){this.consent.optInOut(!1),this.Bs()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this.Bs()}_is_bot(){return Mi?GV(Mi,this.config.custom_blocked_useragents):void 0}Ds(){ft&&(ft.visibilityState==="visible"?this.$s||(this.$s=!0,this.capture("$pageview",{title:ft.title},{send_instantly:!0}),this.xs&&(ft.removeEventListener("visibilitychange",this.xs),this.xs=null)):this.xs||(this.xs=this.Ds.bind(this),rr(ft,"visibilitychange",this.xs)))}debug(e){e===!1?(Pe?.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(Pe?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}I(){var e,t,r,s,i,a,o,l=this.Is||{};return"advanced_disable_flags"in l?!!l.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(pt.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(r="advanced_disable_decide",s=!1,i=pt,a=(t="advanced_disable_flags")in(e=l)&&!it(e[t]),o=r in e&&!it(e[r]),a?e[t]:o?(i&&i.warn("Config field '"+r+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[r]):s)}Ns(e){if(bn(this.config.before_send))return e;var t=zn(this.config.before_send)?this.config.before_send:[this.config.before_send],r=e;for(var s of t){if(r=s(r),bn(r)){var i="Event '"+e.event+"' was rejected in beforeSend function";return woe(e.event)?pt.warn(i+". This can cause unexpected behavior."):pt.info(i),null}r.properties&&!of(r.properties)||pt.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return r}getPageViewId(){var e;return(e=this.pageViewManager.ce)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,r){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(r)})}}(function(n,e){for(var t=0;t<e.length;t++)n.prototype[e[t]]=Soe(n.prototype[e[t]])})(tS,["identify"]);var E3,$c=(E3=pg[zh]=new tS,function(){function n(){n.done||(n.done=!0,qV=!1,Dn(pg,function(e){e._dom_loaded()}))}ft!=null&&ft.addEventListener?ft.readyState==="complete"?n():rr(ft,"DOMContentLoaded",n,{capture:!1}):Pe&&pt.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),E3);typeof window<"u"&&$c.init("phc_h90tBZBiBJHr8fRNcGKpBmr4zz0iuBxfh7H0EXqP8wq",{api_host:"https://us.i.posthog.com",person_profiles:"identified_only",capture_pageview:!0,capture_pageleave:!0,autocapture:!0,disable_session_recording:!0,loaded:n=>{},on_request_error:n=>{}});class jce{identifyUser(e){if(this.isAvailable()){if(!e?.email){console.warn("[PostHog] Cannot identify user without email");return}try{$c.identify(e.email,{email:e.email,user_id:e.id,...e.user_metadata?.full_name&&{name:e.user_metadata.full_name},...e.user_metadata?.avatar_url&&{avatar:e.user_metadata.avatar_url}}),e.email}catch(t){console.error("[PostHog] Error identifying user:",t)}}}resetUser(){if(this.isAvailable())try{$c.reset()}catch(e){console.error("[PostHog] Error resetting user:",e)}}capture(e,t){if(this.isAvailable())try{$c.capture(e,t)}catch(r){console.error("[PostHog] Error capturing event:",r)}}setPersonProperties(e){if(this.isAvailable())try{$c.setPersonProperties(e)}catch(t){console.error("[PostHog] Error setting person properties:",t)}}isAvailable(){return typeof window<"u"&&!!$c}}const Yt=new jce,cn=Ws()(Ui(bi((n,e)=>({user:null,profile:null,session:null,isLoading:!1,isInitialized:!1,isInitializing:!1,userProfiles:{},setUser:t=>n(r=>{r.user=t}),setProfile:t=>n(r=>{r.profile=t}),setSession:t=>n(r=>{r.session=t}),setIsLoading:t=>n(r=>{r.isLoading=t}),setIsInitialized:t=>n(r=>{r.isInitialized=t}),setIsInitializing:t=>n(r=>{r.isInitializing=t}),signInWithGoogle:async t=>{try{Yt.isAvailable()&&Yt.capture("auth_signin_attempted",{provider:"google",redirect_path:t});const r=await Ht("/api/auth/signin",{method:"POST",body:JSON.stringify({redirectPath:t})});if(!r.ok)throw new Error("Failed to sign in");const{url:s}=await r.json();s&&(window.location.href=s)}catch(r){throw Yt.isAvailable()&&Yt.capture("auth_signin_error",{provider:"google",error:r instanceof Error?r.message:"Unknown error"}),console.error("Error signing in with Google:",r),r}},signOut:async()=>{try{if(Yt.isAvailable()&&Yt.capture("auth_signout_attempted"),!(await Ht("/api/auth/signout",{method:"POST"})).ok)throw new Error("Failed to sign out");Yt.isAvailable()&&Yt.capture("auth_signout_success"),Yt.isAvailable()&&Yt.resetUser(),await ua().auth.signOut(),e().reset()}catch(t){throw Yt.isAvailable()&&Yt.capture("auth_signout_error",{error:t instanceof Error?t.message:"Unknown error"}),console.error("Error signing out:",t),t}},fetchProfile:async t=>{const r=e();if(r.profile&&r.profile.user_id===t)return r.profile;const s=`profile_fetch_${t}`;return window[s]||(window[s]=(async()=>{try{const i=await Ht("/api/auth/me",{method:"GET"});if(!i.ok)return i.status===401?n(o=>{o.profile=null,o.user=null,o.session=null}):i.status>=500&&console.error("[AuthStore] Server error fetching profile:",i.status),null;const a=await i.json();return a.profile?(n(o=>{o.profile=a.profile}),Yt.isAvailable()&&a.profile&&Yt.setPersonProperties({full_name:a.profile.full_name,subscription_status:a.profile.subscription_status,subscription_type:a.profile.subscription_type,created_at:a.profile.created_at}),a.profile):null}catch(i){return i instanceof Error&&i.message.includes("ERR_TOO_MANY_REDIRECTS")?(console.error("[AuthStore] Redirect loop detected, skipping profile fetch"),null):(console.error("[AuthStore] Error fetching profile:",i),null)}finally{delete window[s]}})()),window[s]},createProfile:async t=>{const r=e();return r.profile?.user_id===t.id?r.profile:await e().fetchProfile(t.id)},updateProfile:async t=>{const{profile:r}=e();if(!r)return null;try{const s=ua(),{id:i,...a}=t,{data:o,error:l}=await s.from("profiles").update(a).eq("user_id",r.user_id).select().single();if(l)throw l;const c=o;return n(u=>{u.profile=c}),c}catch(s){return console.error("Error updating profile:",s),null}},fetchUserProfiles:async t=>{if(t.length)try{const r=await PH(t);n(s=>({userProfiles:{...s.userProfiles,...r}}))}catch(r){console.error("Error fetching user profiles:",r)}},addUserProfile:(t,r)=>n(s=>{s.userProfiles[t]=r}),getUserProfiles:()=>e().userProfiles,initialize:async()=>{const t=e();if(!(t.isInitialized||t.isInitializing))try{n(u=>{u.isLoading=!0,u.isInitializing=!0});const r=ua(),s=new URLSearchParams(window.location.search),i=s.has("code")||s.has("access_token")||s.has("session"),a=i?1e4:5e3;let o=null;try{const u=r.auth.getSession(),f=new Promise((g,y)=>setTimeout(()=>y(new Error("Session check timeout")),a));o=(await Promise.race([u,f])).data?.session}catch(u){o=null}if(o){n(u=>{u.session=o,u.user=o.user}),Yt.isAvailable()&&o.user&&Yt.identifyUser(o.user);try{const u=await Ht("/api/auth/me",{method:"GET",cache:"no-cache"});if(u.ok){const f=await u.json();f.profile&&n(m=>{m.profile=f.profile})}else u.status===401?(await r.auth.signOut(),n(f=>{f.session=null,f.user=null,f.profile=null})):u.status}catch(u){}}const l=window.__authSubscription;l&&(l.unsubscribe(),delete window.__authSubscription);const{data:{subscription:c}}=r.auth.onAuthStateChange(async(u,f)=>{if(f){if(n(m=>{m.session=f,m.user=f.user}),Yt.isAvailable()&&f.user&&(Yt.identifyUser(f.user),u==="SIGNED_IN"&&Yt.capture("auth_signin_success",{provider:"google",user_id:f.user.id})),u==="SIGNED_IN"){const m=e().profile;(!m||m.user_id!==f.user.id)&&e().fetchProfile(f.user.id).catch(g=>{console.warn("[AuthStore] Profile fetch failed:",g)})}}else Yt.isAvailable()&&Yt.resetUser(),n(m=>{m.session=null,m.user=null,m.profile=null})});window.__authSubscription=c}catch(r){console.error("[AuthStore] Error initializing auth:",r)}finally{n(r=>{r.isLoading=!1,r.isInitialized=!0,r.isInitializing=!1})}},reset:()=>{const t=window.__authSubscription;t&&(t.unsubscribe(),delete window.__authSubscription),Yt.isAvailable()&&Yt.resetUser(),n(r=>{r.user=null,r.profile=null,r.session=null,r.userProfiles={},r.isInitialized=!1,r.isInitializing=!1,r.isLoading=!1})}})))),Ar=()=>{const n=cn(o=>o.user),e=cn(o=>o.profile),t=cn(o=>o.session),r=cn(o=>o.isLoading),s=cn(o=>o.isInitialized),i=cn(o=>o.signInWithGoogle),a=cn(o=>o.signOut);return{user:n,profile:e,session:t,isLoading:r,isInitialized:s,signInWithGoogle:i,signOut:a}},WV=()=>cn(n=>n.user),KV=()=>cn(n=>n.profile),Fce=()=>cn(n=>n.isLoading),YV=()=>cn(n=>n.signInWithGoogle),Uce=()=>cn(n=>n.signOut),Jg=({className:n="",size:e="large",isOpen:t=!1})=>e==="small"?d.jsxs("div",{className:`flex items-center  group ${n}`,children:[d.jsx("img",{src:"/images/flasklogo.png",alt:"Flask Logo",className:`h-10 object-contain absolute left-0.5 mb-1 opacity-80 transition-all duration-200 cursor-pointer ${t?"rotate-6 opacity-100 scale-105":"group-hover:rotate-6 group-hover:opacity-100 group-hover:scale-105"}`}),d.jsx("p",{className:`text-text-primary/85 text-2xl text-bold tracking-[-0.075em] font-bold transition-all duration-200 ${t?"text-text-primary":"group-hover:text-text-primary"}`,children:"Flask"})]}):d.jsxs("div",{className:`flex h-full items-center mb-1 group ${n}`,children:[d.jsx("p",{className:`text-text-primary/85 text-bold tracking-[-0.075em] text-[32px] font-bold transition-all duration-200 cursor-pointer ${t?"text-text-primary":"group-hover:text-text-primary"}`,children:"Flask"}),d.jsx("img",{src:"/images/flasklogo.png",alt:"Flask Logo",className:`h-[78px] object-contain absolute left-10 mb-0 opacity-80 transition-all duration-200 cursor-pointer ${t?"rotate-6 opacity-100 scale-105":"group-hover:rotate-6 group-hover:opacity-100 group-hover:scale-105"}`})]});/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ce=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XV=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hce=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...Bce,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:XV("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=(n,e)=>{const t=E.forwardRef(({className:r,...s},i)=>E.createElement(Hce,{ref:i,iconNode:e,className:XV(`lucide-${$ce(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vce=bt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zce=bt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=bt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=bt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QV=bt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=bt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=bt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gce=bt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=bt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZV=bt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=bt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=bt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=bt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ev=bt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JV=bt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qce=bt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wce=bt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=bt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=bt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=bt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=bt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kce=bt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yce=bt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=bt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xce=bt("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qce=bt("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=bt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=bt("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=bt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zce=bt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jce=bt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=bt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eue=bt("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tue=bt("MessageCircleQuestion",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nue=bt("MessageSquareQuote",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 12a2 2 0 0 0 2-2V8H8",key:"1jfesj"}],["path",{d:"M14 12a2 2 0 0 0 2-2V8h-2",key:"1dq9mh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rue=bt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sue=bt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iue=bt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aue=bt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=bt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=bt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tv=bt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nv=bt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=bt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oue=bt("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lue=bt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cue=bt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=bt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uue=bt("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=bt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const due=bt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=bt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=bt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hue=bt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fue=bt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mue=bt("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=bt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pue=bt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=bt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=bt("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=bt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gue=bt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function vue(n,e){const t=E.createContext(e),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return d.jsx(t.Provider,{value:l,children:a})};r.displayName=n+"Provider";function s(i){const a=E.useContext(t);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${n}\``)}return[r,s]}function Ns(n,e=[]){let t=[];function r(i,a){const o=E.createContext(a),l=t.length;t=[...t,a];const c=f=>{const{scope:m,children:g,...y}=f,b=m?.[n]?.[l]||o,x=E.useMemo(()=>y,Object.values(y));return d.jsx(b.Provider,{value:x,children:g})};c.displayName=i+"Provider";function u(f,m){const g=m?.[n]?.[l]||o,y=E.useContext(g);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=t.map(a=>E.createContext(a));return function(o){const l=o?.[n]||i;return E.useMemo(()=>({[`__scope${n}`]:{...o,[n]:l}}),[o,l])}};return s.scopeName=n,[r,yue(s,...e)]}function yue(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const f=l(i)[`__scope${c}`];return{...o,...f}},{});return E.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function xa(n){const e=E.useRef(n);return E.useEffect(()=>{e.current=n}),E.useMemo(()=>(...t)=>e.current?.(...t),[])}var vr=globalThis?.document?E.useLayoutEffect:()=>{};function R3(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function rS(...n){return e=>{let t=!1;const r=n.map(s=>{const i=R3(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():R3(n[s],null)}}}}function $t(...n){return E.useCallback(rS(...n),n)}function eu(n){const e=xue(n),t=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(wue);if(l){const c=l.props.children,u=o.map(f=>f===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:f);return d.jsx(e,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return d.jsx(e,{...a,ref:s,children:i})});return t.displayName=`${n}.Slot`,t}var bue=eu("Slot");function xue(n){const e=E.forwardRef((t,r)=>{const{children:s,...i}=t;if(E.isValidElement(s)){const a=Sue(s),o=Eue(i,s.props);return s.type!==E.Fragment&&(o.ref=r?rS(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var oz=Symbol("radix.slottable");function lz(n){const e=({children:t})=>d.jsx(d.Fragment,{children:t});return e.displayName=`${n}.Slottable`,e.__radixId=oz,e}function wue(n){return E.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===oz}function Eue(n,e){const t={...e};for(const r in e){const s=n[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?t[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(t[r]=s):r==="style"?t[r]={...s,...i}:r==="className"&&(t[r]=[s,i].filter(Boolean).join(" "))}return{...n,...t}}function Sue(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var Tue=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_t=Tue.reduce((n,e)=>{const t=eu(`Primitive.${e}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function cz(n,e){n&&Hs.flushSync(()=>n.dispatchEvent(e))}var J1={exports:{}},eA={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C3;function _ue(){if(C3)return eA;C3=1;var n=BE();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,a=n.useDebugValue;function o(f,m){var g=m(),y=r({inst:{value:g,getSnapshot:m}}),b=y[0].inst,x=y[1];return i(function(){b.value=g,b.getSnapshot=m,l(b)&&x({inst:b})},[f,g,m]),s(function(){return l(b)&&x({inst:b}),f(function(){l(b)&&x({inst:b})})},[f]),a(g),g}function l(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!t(f,g)}catch{return!0}}function c(f,m){return m()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return eA.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,eA}var k3;function Aue(){return k3||(k3=1,J1.exports=_ue()),J1.exports}var Rue=Aue();function Cue(){return Rue.useSyncExternalStore(kue,()=>!0,()=>!1)}function kue(){return()=>{}}var nD="Avatar",[Iue,mje]=Ns(nD),[Lue,uz]=Iue(nD),dz=E.forwardRef((n,e)=>{const{__scopeAvatar:t,...r}=n,[s,i]=E.useState("idle");return d.jsx(Lue,{scope:t,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:d.jsx(_t.span,{...r,ref:e})})});dz.displayName=nD;var hz="AvatarImage",fz=E.forwardRef((n,e)=>{const{__scopeAvatar:t,src:r,onLoadingStatusChange:s=()=>{},...i}=n,a=uz(hz,t),o=Due(r,i),l=xa(c=>{s(c),a.onImageLoadingStatusChange(c)});return vr(()=>{o!=="idle"&&l(o)},[o,l]),o==="loaded"?d.jsx(_t.img,{...i,ref:e,src:r}):null});fz.displayName=hz;var mz="AvatarFallback",pz=E.forwardRef((n,e)=>{const{__scopeAvatar:t,delayMs:r,...s}=n,i=uz(mz,t),[a,o]=E.useState(r===void 0);return E.useEffect(()=>{if(r!==void 0){const l=window.setTimeout(()=>o(!0),r);return()=>window.clearTimeout(l)}},[r]),a&&i.imageLoadingStatus!=="loaded"?d.jsx(_t.span,{...s,ref:e}):null});pz.displayName=mz;function I3(n,e){return n?e?(n.src!==e&&(n.src=e),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Due(n,{referrerPolicy:e,crossOrigin:t}){const r=Cue(),s=E.useRef(null),i=r?(s.current||(s.current=new window.Image),s.current):null,[a,o]=E.useState(()=>I3(i,n));return vr(()=>{o(I3(i,n))},[i,n]),vr(()=>{const l=f=>()=>{o(f)};if(!i)return;const c=l("loaded"),u=l("error");return i.addEventListener("load",c),i.addEventListener("error",u),e&&(i.referrerPolicy=e),typeof t=="string"&&(i.crossOrigin=t),()=>{i.removeEventListener("load",c),i.removeEventListener("error",u)}},[i,t,e]),a}var gz=dz,vz=fz,yz=pz;function bz(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=bz(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function xz(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=bz(n))&&(r&&(r+=" "),r+=e);return r}const rD="-",Pue=n=>{const e=Oue(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:a=>{const o=a.split(rD);return o[0]===""&&o.length!==1&&o.shift(),wz(o,e)||Mue(a)},getConflictingClassGroupIds:(a,o)=>{const l=t[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},wz=(n,e)=>{if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?wz(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=n.join(rD);return e.validators.find(({validator:a})=>a(i))?.classGroupId},L3=/^\[(.+)\]$/,Mue=n=>{if(L3.test(n)){const e=L3.exec(n)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Oue=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return jue(Object.entries(n.classGroups),t).forEach(([i,a])=>{HC(a,r,i,e)}),r},HC=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const i=s===""?e:D3(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(Nue(s)){HC(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,a])=>{HC(a,D3(e,i),t,r)})})},D3=(n,e)=>{let t=n;return e.split(rD).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},Nue=n=>n.isThemeGetter,jue=(n,e)=>e?n.map(([t,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,o])=>[e+a,o])):i);return[t,s]}):n,Fue=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(i,a)=>{t.set(i,a),e++,e>n&&(e=0,r=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){t.has(i)?t.set(i,a):s(i,a)}}},Ez="!",Uue=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,s=e[0],i=e.length,a=o=>{const l=[];let c=0,u=0,f;for(let x=0;x<o.length;x++){let S=o[x];if(c===0){if(S===s&&(r||o.slice(x,x+i)===e)){l.push(o.slice(u,x)),u=x+i;continue}if(S==="/"){f=x;continue}}S==="["?c++:S==="]"&&c--}const m=l.length===0?o:o.substring(u),g=m.startsWith(Ez),y=g?m.substring(1):m,b=f&&f>u?f-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:b}};return t?o=>t({className:o,parseClassName:a}):a},$ue=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},Bue=n=>({cache:Fue(n.cacheSize),parseClassName:Uue(n),...Pue(n)}),Hue=/\s+/,Vue=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],a=n.trim().split(Hue);let o="";for(let l=a.length-1;l>=0;l-=1){const c=a[l],{modifiers:u,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:g}=t(c);let y=!!g,b=r(y?m.substring(0,g):m);if(!b){if(!y){o=c+(o.length>0?" "+o:o);continue}if(b=r(m),!b){o=c+(o.length>0?" "+o:o);continue}y=!1}const x=$ue(u).join(":"),S=f?x+Ez:x,T=S+b;if(i.includes(T))continue;i.push(T);const _=s(b,y);for(let R=0;R<_.length;++R){const I=_[R];i.push(S+I)}o=c+(o.length>0?" "+o:o)}return o};function zue(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=Sz(e))&&(r&&(r+=" "),r+=t);return r}const Sz=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=Sz(n[r]))&&(t&&(t+=" "),t+=e);return t};function Gue(n,...e){let t,r,s,i=a;function a(l){const c=e.reduce((u,f)=>f(u),n());return t=Bue(c),r=t.cache.get,s=t.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Vue(l,t);return s(l,u),u}return function(){return i(zue.apply(null,arguments))}}const Hn=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},Tz=/^\[(?:([a-z-]+):)?(.+)\]$/i,que=/^\d+\/\d+$/,Wue=new Set(["px","full","screen"]),Kue=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yue=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xue=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Que=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Zue=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ml=n=>Tf(n)||Wue.has(n)||que.test(n),vc=n=>am(n,"length",ade),Tf=n=>!!n&&!Number.isNaN(Number(n)),tA=n=>am(n,"number",Tf),_p=n=>!!n&&Number.isInteger(Number(n)),Jue=n=>n.endsWith("%")&&Tf(n.slice(0,-1)),Kt=n=>Tz.test(n),yc=n=>Kue.test(n),ede=new Set(["length","size","percentage"]),tde=n=>am(n,ede,_z),nde=n=>am(n,"position",_z),rde=new Set(["image","url"]),sde=n=>am(n,rde,lde),ide=n=>am(n,"",ode),Ap=()=>!0,am=(n,e,t)=>{const r=Tz.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},ade=n=>Yue.test(n)&&!Xue.test(n),_z=()=>!1,ode=n=>Que.test(n),lde=n=>Zue.test(n),cde=()=>{const n=Hn("colors"),e=Hn("spacing"),t=Hn("blur"),r=Hn("brightness"),s=Hn("borderColor"),i=Hn("borderRadius"),a=Hn("borderSpacing"),o=Hn("borderWidth"),l=Hn("contrast"),c=Hn("grayscale"),u=Hn("hueRotate"),f=Hn("invert"),m=Hn("gap"),g=Hn("gradientColorStops"),y=Hn("gradientColorStopPositions"),b=Hn("inset"),x=Hn("margin"),S=Hn("opacity"),T=Hn("padding"),_=Hn("saturate"),R=Hn("scale"),I=Hn("sepia"),C=Hn("skew"),L=Hn("space"),k=Hn("translate"),M=()=>["auto","contain","none"],D=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",Kt,e],$=()=>[Kt,e],V=()=>["",ml,vc],B=()=>["auto",Tf,Kt],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],j=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],H=()=>["","0",Kt],N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[Tf,Kt];return{cacheSize:500,separator:":",theme:{colors:[Ap],spacing:[ml,vc],blur:["none","",yc,Kt],brightness:O(),borderColor:[n],borderRadius:["none","","full",yc,Kt],borderSpacing:$(),borderWidth:V(),contrast:O(),grayscale:H(),hueRotate:O(),invert:H(),gap:$(),gradientColorStops:[n],gradientColorStopPositions:[Jue,vc],inset:U(),margin:U(),opacity:O(),padding:$(),saturate:O(),scale:O(),sepia:H(),skew:O(),space:$(),translate:$()},classGroups:{aspect:[{aspect:["auto","square","video",Kt]}],container:["container"],columns:[{columns:[yc]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),Kt]}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",_p,Kt]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Kt]}],grow:[{grow:H()}],shrink:[{shrink:H()}],order:[{order:["first","last","none",_p,Kt]}],"grid-cols":[{"grid-cols":[Ap]}],"col-start-end":[{col:["auto",{span:["full",_p,Kt]},Kt]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[Ap]}],"row-start-end":[{row:["auto",{span:[_p,Kt]},Kt]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Kt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Kt]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[L]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[L]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Kt,e]}],"min-w":[{"min-w":[Kt,e,"min","max","fit"]}],"max-w":[{"max-w":[Kt,e,"none","full","min","max","fit","prose",{screen:[yc]},yc]}],h:[{h:[Kt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Kt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Kt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Kt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",yc,vc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tA]}],"font-family":[{font:[Ap]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Kt]}],"line-clamp":[{"line-clamp":["none",Tf,tA]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ml,Kt]}],"list-image":[{"list-image":["none",Kt]}],"list-style-type":[{list:["none","disc","decimal",Kt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ml,vc]}],"underline-offset":[{"underline-offset":["auto",ml,Kt]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),nde]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",tde]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},sde]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:F()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[ml,Kt]}],"outline-w":[{outline:[ml,vc]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[ml,vc]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",yc,ide]}],"shadow-color":[{shadow:[Ap]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...j(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":j()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",yc,Kt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[_]}],sepia:[{sepia:[I]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[I]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Kt]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",Kt]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",Kt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[R]}],"scale-x":[{"scale-x":[R]}],"scale-y":[{"scale-y":[R]}],rotate:[{rotate:[_p,Kt]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Kt]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Kt]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Kt]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[ml,vc,tA]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ude=Gue(cde);console.log=()=>{},console.warn=()=>{},console.error=()=>{};function je(...n){return ude(xz(n))}const sD=E.forwardRef(({className:n,...e},t)=>d.jsx(gz,{ref:t,className:je("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...e}));sD.displayName=gz.displayName;const iD=E.forwardRef(({className:n,...e},t)=>d.jsx(vz,{ref:t,className:je("aspect-square h-full w-full",n),...e}));iD.displayName=vz.displayName;const aD=E.forwardRef(({className:n,...e},t)=>d.jsx(yz,{ref:t,className:je("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...e}));aD.displayName=yz.displayName;const dde={xs:"h-4 w-4",sm:"h-5 w-5",md:"h-8 w-8",lg:"h-10 w-10",xl:"h-12 w-12",full:"!h-full !w-auto aspect-square"},sv=({src:n,userId:e,user:t,name:r,size:s="md",className:i,alt:a="Profile picture"})=>{const o=cn(S=>S.userProfiles)||{},[l,c]=E.useState(!1),u=()=>{let S=null,T=null;if(n)S=n,T=r||null;else if(t)S=t.avatar_url||null,T=t.full_name||t.email||t.id;else if(e&&o[e]){const _=o[e];S=_.avatar_url||null,T=_.full_name||_.email||e}else r&&(T=r);return{avatarUrl:S,displayName:T}},{avatarUrl:f,displayName:m}=u();E.useEffect(()=>{c(!1)},[f]);const g=[{bg:"bg-accent-purple",text:"text-white"},{bg:"bg-accent-blue",text:"text-white"},{bg:"bg-accent-teal",text:"text-white"},{bg:"bg-accent-green",text:"text-black"},{bg:"bg-accent-lime",text:"text-black"},{bg:"bg-accent-orange",text:"text-black"},{bg:"bg-accent-red",text:"text-white"}],y=S=>{if(!S)return g[0];let T=0;for(let R=0;R<S.length;R++){const I=S.charCodeAt(R);T=(T<<5)-T+I,T=T&T}const _=Math.abs(T)%g.length;return g[_]},b=S=>S.split(" ").map(T=>T.charAt(0)).join("").toUpperCase().slice(0,2),x=y(t?.id||e||m||"");return d.jsxs(sD,{className:je(dde[s],i),children:[f&&!l&&d.jsx(iD,{src:f,alt:a,onError:()=>c(!0)}),d.jsx(aD,{className:je(x.bg,"font-bold text-xs text-card-background/50"),children:m?b(m):d.jsx(BC,{className:"h-4 w-4"})})]})},hde=()=>{Ft(c=>c.currentTeam);const{user:n,profile:e,isInitialized:t}=Ar(),r=Uce(),s=Os(),i=Jn(),a=s.pathname==="/",o=n&&e?{id:n.id,full_name:e.full_name,avatar_url:e.avatar_url,email:n.email}:null,l=()=>{i("/"),window.scrollTo({top:0,behavior:"smooth"})};return d.jsx("div",{className:"shared-nav md:fixed top-0 left-0 w-full z-20  transition-colors overflow-visible duration-200 pointer-events-none",children:d.jsx("div",{className:"max-w-screen-2xl mx-auto px-4 md:px-16 ",children:d.jsx("div",{className:"py-2 mt-4",children:d.jsxs("div",{className:"relative overflow-visible pointer-events-auto w-full flex items-center justify-between gap-4",children:[d.jsx("div",{className:"h-[52px] rounded-full md:bg-element-background/90 md:backdrop-blur-md md:border-t md:border-text-primary/30 md:shadow-2xl flex items-center md:p-3",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{onClick:l,className:"cursor-pointer",children:d.jsx(Jg,{className:"mr-6 z-10 ml-6"})}),d.jsx("div",{className:"hidden md:flex items-center gap-3 ",children:NH.map(c=>c.isExternal?d.jsx("a",{href:c.href,className:"text-text-primary text-sm hover:opacity-80 rounded-full px-3 py-1 transition-all duration-200",target:"_blank",rel:"noopener noreferrer",children:c.label},c.label):d.jsx(gs,{to:c.href,className:"text-text-primary text-sm hover:opacity-80 rounded-full px-3 py-1 transition-all duration-200",children:c.label},c.label))})]})}),d.jsx("div",{className:"flex h-[48px] items-center gap-4",children:t?d.jsxs(d.Fragment,{children:[n&&a&&o&&d.jsx("button",{onClick:async()=>{await r(),i("/")},className:"text-text-primary text-sm  hover:opacity-80 transition-all duration-200",children:"Logout"}),d.jsx(gs,{to:n&&a?"/dash":"/login",className:"h-full",children:d.jsx("div",{className:"button-secondary h-full flex items-center gap-2 px-4 cursor-pointer",children:n&&a&&o?d.jsxs(d.Fragment,{children:[d.jsx(sv,{user:o,src:o.avatar_url,size:"sm"}),d.jsx("span",{className:"text-sm font-medium",children:"Dashboard"})]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-sm !font-normal !text-text-primary ",children:"Get Started"}),d.jsx(nS,{className:"w-5 h-5 !text-text-primary "})]})})})]}):d.jsx("div",{className:"h-full",children:d.jsx("div",{className:"button-secondary h-full flex items-center gap-2 px-4",children:d.jsx("div",{className:"w-20 h-4 bg-text-primary/20 rounded animate-pulse"})})})})]})})})})},oD=({className:n=""})=>d.jsxs("div",{className:`flex items-center relative ${n}`,children:[d.jsx("img",{src:"/images/flasklogo.png",alt:"Flask Logo",className:"h-[78px] object-contain absolute left-6 opacity-80"}),d.jsx("p",{className:"text-text-primary/85 tracking-[-0.075em] text-[46px] font-bold ",children:"Flask"})]}),Az=()=>d.jsx("footer",{className:"bg-card-background border-t border-border mt-8 md:mt-16 relative w-full",children:d.jsxs("div",{className:"w-full px-6 md:max-w-screen-2xl md:mx-auto md:px-12 py-8 md:py-12",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between gap-8",children:[d.jsxs("div",{className:"flex-shrink-0",children:[d.jsx("div",{className:"flex items-center mb-4",children:d.jsx(gs,{to:"/",children:d.jsx(oD,{})})}),d.jsxs("p",{className:"text-text-secondary text-sm",children:[" ",new Date().getFullYear()," Flask. All rights reserved."]})]}),d.jsxs("div",{className:"flex flex-col gap-4 md:items-end",children:[NH.map(n=>n.isExternal?d.jsx("a",{href:n.href,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-text-primary hover:text-text-primary/80 transition-colors",children:n.label},n.label):d.jsx(gs,{to:n.href,className:"text-sm text-text-primary hover:text-text-primary/80 transition-colors",children:n.label},n.label)),d.jsx(gs,{to:"/manifesto",className:"text-sm text-text-primary hover:text-text-primary/80 transition-colors",children:"Manifesto"}),d.jsx(gs,{to:"/privacy-policy",className:"text-sm text-text-secondary hover:text-text-primary transition-colors",children:"Privacy Policy"}),d.jsx(gs,{to:"/terms-of-service",className:"text-sm text-text-secondary hover:text-text-primary transition-colors",children:"Terms of Service"})]})]}),d.jsx("div",{className:"mt-8 md:mt-12",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("div",{className:"text-xs text-text-secondary/60",children:"Built with blood, sweat and redbulls."}),d.jsx("a",{href:"https://www.youtube.com/watch?v=c-wT7sijLIs",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-text-secondary/20 hover:text-text-secondary transition-colors",children:"I have a bad feeling about this"})]})})]})}),P3=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,M3=xz,lD=(n,e)=>t=>{var r;if(e?.variants==null)return M3(n,t?.class,t?.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(c=>{const u=t?.[c],f=i?.[c];if(u===null)return null;const m=P3(u)||P3(f);return s[c][m]}),o=t&&Object.entries(t).reduce((c,u)=>{let[f,m]=u;return m===void 0||(c[f]=m),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:f,className:m,...g}=u;return Object.entries(g).every(y=>{let[b,x]=y;return Array.isArray(x)?x.includes({...i,...o}[b]):{...i,...o}[b]===x})?[...c,f,m]:c},[]);return M3(n,a,l,t?.class,t?.className)},cD=lD("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),dt=E.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...s},i)=>{const a=r?bue:"button";return d.jsx(a,{className:je(cD({variant:e,size:t,className:n})),ref:i,...s})});dt.displayName="Button";const fde=1,mde=1e6;let nA=0;function pde(){return nA=(nA+1)%Number.MAX_SAFE_INTEGER,nA.toString()}const rA=new Map,O3=n=>{if(rA.has(n))return;const e=setTimeout(()=>{rA.delete(n),gg({type:"REMOVE_TOAST",toastId:n})},mde);rA.set(n,e)},gde=(n,e)=>{switch(e.type){case"ADD_TOAST":return{...n,toasts:[e.toast,...n.toasts].slice(0,fde)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?O3(t):n.toasts.forEach(r=>{O3(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(t=>t.id!==e.toastId)}}},Yb=[];let Xb={toasts:[]};function gg(n){Xb=gde(Xb,n),Yb.forEach(e=>{e(Xb)})}function Mr({...n}){const e=pde(),t=s=>gg({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>gg({type:"DISMISS_TOAST",toastId:e});return gg({type:"ADD_TOAST",toast:{...n,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:t}}function vde(){const[n,e]=E.useState(Xb);return E.useEffect(()=>(Yb.push(e),()=>{const t=Yb.indexOf(e);t>-1&&Yb.splice(t,1)}),[n]),{...n,toast:Mr,dismiss:t=>gg({type:"DISMISS_TOAST",toastId:t})}}const yde=()=>{const[n,e]=E.useState(!1),{user:t}=Ar(),{toast:r}=vde(),s=Jn(),i=async()=>{if(!t){const o=encodeURIComponent("/#pricing");s(`/login?redirect=${o}`);return}e(!0);try{const o=await Ht("/api/teams/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({billing_period:"yearly",success_url:`${window.location.origin}/?settings=team&from_checkout=true`,cancel_url:`${window.location.origin}/#pricing`,team_name:"New Team"})});if(!o.ok)throw new Error("Failed to create checkout session");const{url:l}=await o.json();window.location.href=l}catch(o){console.error("Error starting checkout:",o),r({title:"Error",description:"Failed to start checkout. Please try again.",variant:"destructive"}),e(!1)}};return d.jsx("div",{className:"w-full max-w-6xl mx-auto relative z-10",children:d.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-start gap-12 md:gap-6 relative",children:[d.jsx("div",{className:"flex-1 flex flex-col max-w-xs mx-auto md:mx-0",children:d.jsxs("div",{className:"bg-card-background border border-border rounded-3xl  p-6 flex flex-col flex-1",children:[d.jsx("div",{className:"mb-1",children:d.jsx("h3",{className:"text-2xl font-bold text-white",children:"Free"})}),d.jsx("div",{className:"h-10",children:d.jsx("p",{className:"text-text-secondary text-sm md:text-xs",children:"Free, unlimited video collaboration"})}),d.jsx("div",{className:"mb-4 h-14 flex flex-col justify-center",children:d.jsx("div",{className:"flex items-baseline gap-2",children:d.jsx("span",{className:"text-3xl font-mono text-text-primary/90",children:"$0"})})}),d.jsx("div",{className:"mb-3",children:d.jsx("p",{className:"text-text-secondary text-xs uppercase tracking-wider",children:"Includes"})}),d.jsxs("ul",{className:"space-y-2 flex-grow mb-6",children:[d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Unlimited, free video collaboration"})]}),d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Unlimited comments, recordings, AI insights"})]}),d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Use YouTube as storage (Unlisted or Public videos)"})]})]}),d.jsx("div",{children:d.jsx(dt,{className:"w-full rounded-full h-12 button-secondary shadow-lg mt-2",onClick:()=>s("/dash"),children:"Get Started"})})]})}),d.jsxs("div",{className:"flex-1 flex flex-col max-w-xs mx-auto md:mx-0 relative",children:[d.jsx("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 z-10 ",children:d.jsx("div",{className:"bg-green-500/50 backdrop-blur-md border border-green-200 rounded-full px-3 py-1",children:d.jsx("span",{className:"text-green-200 text-xs whitespace-nowrap",children:"For Creative Teams"})})}),d.jsxs("div",{className:"bg-element-background border-t border-text-primary/30 rounded-3xl shadow-3xl p-6 flex flex-col flex-1 relative",children:[d.jsx("img",{src:"/images/thumbsup.png",alt:"",className:"absolute -top-10 -right-8 w-24 h-24 pointer-events-none"}),d.jsx("div",{className:"mb-1",children:d.jsx("h3",{className:"text-2xl font-bold text-white",children:"Pro"})}),d.jsx("div",{className:"h-10",children:d.jsx("p",{className:"text-text-secondary text-sm md:text-xs",children:"Creative collaboration for teams"})}),d.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[d.jsxs("span",{className:"text-3xl font-mono text-text-primary ",children:["$",13]}),d.jsxs("span",{className:"text-text-secondary pl-2 text-xs",children:["per member / month ",d.jsx("br",{})," (billed annually)"]})]}),d.jsx("div",{className:"mb-3",children:d.jsx("p",{className:"text-text-secondary text-xs uppercase tracking-wider mt-5",children:"Everything in Free, plus"})}),d.jsxs("ul",{className:"space-y-2 flex-grow mb-6",children:[d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Upload videos from device"})]}),d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Shared workspace with team members"})]}),d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Multiple assets/versions per Flask"})]}),d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(is,{className:"w-3.5 h-3.5 text-text-primary mt-0.5 flex-shrink-0"}),d.jsx("span",{className:"text-text-primary text-xs",children:"Remove Flask branding"})]})]}),d.jsx("div",{children:d.jsx(dt,{className:"w-full button-primary font-bold rounded-full h-12 shadow-lg",onClick:i,disabled:n,children:n?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Get Started"})}),d.jsx("div",{className:"text-center mt-2",children:d.jsx("span",{className:"text-text-secondary text-xs",children:"30-day guarantee"})})]})]}),d.jsx("div",{className:"hidden md:flex flex-1 flex-col max-w-xs mx-auto md:mx-0",children:d.jsxs("div",{className:"bg-card-background border border-border rounded-3xl shadow-3xl p-6 flex flex-col flex-1",children:[d.jsx("div",{className:"mb-1",children:d.jsx("h3",{className:"text-2xl font-bold text-text-secondary",children:"Top 1%"})}),d.jsx("div",{className:"h-10 flex items-center",children:d.jsxs("p",{className:"text-text-secondary text-xs",children:["The top 1% most active teams get Flask Pro for free"," ",d.jsx("a",{href:"#faq-1-6",className:"text-text-secondary underline ml-1",onClick:o=>{o.preventDefault();const l=document.getElementById("faq-1-6");l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),window.location.hash="faq-1-6")},children:"Learn more"})]})}),d.jsx("div",{className:"mb-4 h-14 flex flex-col justify-center",children:d.jsx("div",{className:"flex items-baseline gap-2",children:d.jsx("span",{className:"text-3xl font-mono text-text-primary",children:"$0"})})}),d.jsx("div",{className:"mb-3",children:d.jsx("p",{className:"text-text-secondary text-xs uppercase h-36 tracking-wider opacity-0",children:"Placeholder"})}),d.jsx("div",{className:"flex-grow"}),d.jsx("div",{children:d.jsx(dt,{className:"w-full rounded-full h-12 bg-transparent border border-border text-text-secondary",disabled:!0,children:"Keep using Flask!"})})]})})]})})},bde=80,xde=()=>{const n=Os(),e=E.useRef("");return E.useEffect(()=>{n.hash&&(e.current=n.hash.slice(1)),e.current&&document.getElementById(e.current)&&setTimeout(()=>{const t=document.getElementById(e.current);if(t){const r=t.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:r-bde,behavior:"smooth"}),e.current=""}},100)},[n]),null},wde=()=>({"@context":"https://schema.org","@type":"Organization",name:"Flask",url:"https://flask.do",logo:"https://flask.do/images/flasklogo.png",sameAs:["https://twitter.com/flaskapp"],description:"Next-gen video collaboration tool for creative teams. Record in-depth feedback, add any reference on your screen, and let AI extract what matters.",foundingDate:"2024",founders:[{"@type":"Person",name:"Enrico",jobTitle:"Founder"}],contactPoint:{"@type":"ContactPoint",contactType:"customer service",url:"https://flask.do#talk-to-us"}}),Ede=()=>({"@context":"https://schema.org","@type":"SoftwareApplication",name:"Flask",description:"Next-gen video collaboration tool for creative teams. Record in-depth feedback, add any reference on your screen, and let AI extract what matters. Tag, filter, and organize comments on a visual canvas.",url:"https://flask.do",applicationCategory:"BusinessApplication",operatingSystem:"Web Browser",featureList:["Screen recording with AI feedback extraction","Visual canvas for comment organization","Custom tagging and filtering","Team collaboration workspaces","YouTube integration","Video annotation tools"],screenshot:"https://flask.do/images/screen-preview.png"}),Sde=()=>({"@context":"https://schema.org","@type":"WebSite",name:"Flask",url:"https://flask.do",description:"Video collaboration platform built for how creatives actually work. Annotate videos visually, record in-depth feedback, add any reference on your screen.",potentialAction:{"@type":"SearchAction",target:"https://flask.do/search?q={search_term_string}","query-input":"required name=search_term_string"},publisher:{"@type":"Organization",name:"Flask",logo:"https://flask.do/images/flasklogo.png"}}),Tde=()=>({"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"Is Flask really free?",acceptedAnswer:{"@type":"Answer",text:"Yes! Flask is free for unlimited videos and feedback when you upload to YouTube. For creative teams who want shared workspaces and direct uploads, Flask Pro is available."}},{"@type":"Question",name:"How does Flask work with YouTube?",acceptedAnswer:{"@type":"Answer",text:"Upload your video to YouTube as Public or Unlisted, then paste the link into Flask. You can use all Flask features for free with YouTube videos."}},{"@type":"Question",name:"What makes Flask different from other video collaboration tools?",acceptedAnswer:{"@type":"Answer",text:"Flask focuses on visual feedback for creatives. Record complex feedback with screen sharing, let AI extract key points, and organize comments on a visual canvas with custom tagging."}}]}),_de=()=>({"@context":"https://schema.org","@type":"SiteNavigationElement",name:"Flask Navigation",url:"https://flask.do",hasPart:[{"@type":"WebPageElement",name:"Features",url:"https://flask.do/#features",description:"Learn about Flask's video collaboration features including screen recording, AI feedback extraction, and visual canvas organization."},{"@type":"WebPageElement",name:"Pricing",url:"https://flask.do/#pricing",description:"View Flask's pricing plans - free unlimited collaboration with YouTube integration and Pro plans for creative teams."},{"@type":"WebPageElement",name:"FAQ",url:"https://flask.do/#faq",description:"Frequently asked questions about Flask video collaboration platform and how it works."},{"@type":"WebPageElement",name:"Contact",url:"https://flask.do/#talk-to-us",description:"Get in touch with the Flask team for support or questions about video collaboration."}]}),To={siteName:"Flask",domain:"https://flask.do",twitterHandle:"@flaskapp",author:"Flask Team",themeColor:"#09090B",locale:"en_US"},Rh={title:"Flask - Video Collaboration for Creative Teams",description:"The best video collaboration tool you've ever used. Type and record creative feedback. Show any reference on your screen. All in a visual canvas linked to your video.",keywords:"flask do, flask . do, flask video, flask enrico, video collaboration, creative feedback, video review, team collaboration, creative tools, video annotation, screen recording, AI feedback, visual feedback, creative workflow, design feedback, video comments, creative teams, frame, frame io, frame video tool, visual canvas, tagging system",ogImage:"/images/OpenGraphImage.png",ogType:"website",twitterCard:"summary_large_image"},Ade=(n,e)=>({title:`${n} - Flask`,description:`Collaborate on ${n} with Flask. Add feedback, record comments, and organize thoughts on a visual canvas.`,canonical:`/flask/${e}`,ogImage:"/images/OpenGraphImage.png",noindex:!1}),Rde=n=>n.includes("Flask")?n:`${n} | Flask`,Cde=n=>n?`${To.domain}${n}`:To.domain,kde=n=>n.startsWith("http")?n:`${To.domain}${n}`,Rz=({title:n=Rh.title,description:e=Rh.description,canonical:t,ogImage:r=Rh.ogImage,ogType:s=Rh.ogType,twitterCard:i=Rh.twitterCard,keywords:a=Rh.keywords,author:o=To.author,structuredData:l,noindex:c=!1})=>{const u=Rde(n),f=Cde(t),m=kde(r);return d.jsxs(Gte,{children:[d.jsx("title",{children:u}),d.jsx("meta",{name:"description",content:e}),d.jsx("meta",{name:"keywords",content:a}),d.jsx("meta",{name:"author",content:o}),d.jsx("link",{rel:"canonical",href:f}),c&&d.jsx("meta",{name:"robots",content:"noindex, nofollow"}),d.jsx("meta",{property:"og:title",content:u}),d.jsx("meta",{property:"og:description",content:e}),d.jsx("meta",{property:"og:image",content:m}),d.jsx("meta",{property:"og:url",content:f}),d.jsx("meta",{property:"og:type",content:s}),d.jsx("meta",{property:"og:site_name",content:To.siteName}),d.jsx("meta",{property:"og:locale",content:To.locale}),d.jsx("meta",{name:"twitter:card",content:i}),d.jsx("meta",{name:"twitter:title",content:u}),d.jsx("meta",{name:"twitter:description",content:e}),d.jsx("meta",{name:"twitter:image",content:m}),d.jsx("meta",{name:"twitter:site",content:To.twitterHandle}),d.jsx("meta",{name:"twitter:creator",content:To.twitterHandle}),d.jsx("meta",{name:"theme-color",content:To.themeColor}),d.jsx("meta",{name:"msapplication-TileColor",content:To.themeColor}),l&&d.jsx("script",{type:"application/ld+json",children:JSON.stringify(l)})]})};function Gv(n){const e=n+"CollectionProvider",[t,r]=Ns(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:x,children:S}=b,T=ve.useRef(null),_=ve.useRef(new Map).current;return d.jsx(s,{scope:x,itemMap:_,collectionRef:T,children:S})};a.displayName=e;const o=n+"CollectionSlot",l=eu(o),c=ve.forwardRef((b,x)=>{const{scope:S,children:T}=b,_=i(o,S),R=$t(x,_.collectionRef);return d.jsx(l,{ref:R,children:T})});c.displayName=o;const u=n+"CollectionItemSlot",f="data-radix-collection-item",m=eu(u),g=ve.forwardRef((b,x)=>{const{scope:S,children:T,..._}=b,R=ve.useRef(null),I=$t(x,R),C=i(u,S);return ve.useEffect(()=>(C.itemMap.set(R,{ref:R,..._}),()=>void C.itemMap.delete(R))),d.jsx(m,{[f]:"",ref:I,children:T})});g.displayName=u;function y(b){const x=i(n+"CollectionConsumer",b);return ve.useCallback(()=>{const T=x.collectionRef.current;if(!T)return[];const _=Array.from(T.querySelectorAll(`[${f}]`));return Array.from(x.itemMap.values()).sort((C,L)=>_.indexOf(C.ref.current)-_.indexOf(L.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:a,Slot:c,ItemSlot:g},y,r]}function rt(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}var Ide=E8[" useInsertionEffect ".trim().toString()]||vr;function vi({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[s,i,a]=Lde({defaultProp:e,onChange:t}),o=n!==void 0,l=o?n:s;{const u=E.useRef(n!==void 0);E.useEffect(()=>{const f=u.current;f!==o&&console.warn(`${r} is changing from ${f?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{if(o){const f=Dde(u)?u(n):u;f!==n&&a.current?.(f)}else i(u)},[o,n,i,a]);return[l,c]}function Lde({defaultProp:n,onChange:e}){const[t,r]=E.useState(n),s=E.useRef(t),i=E.useRef(e);return Ide(()=>{i.current=e},[e]),E.useEffect(()=>{s.current!==t&&(i.current?.(t),s.current=t)},[t,s]),[t,r,i]}function Dde(n){return typeof n=="function"}function Pde(n,e){return E.useReducer((t,r)=>e[t][r]??t,n)}var $i=n=>{const{present:e,children:t}=n,r=Mde(e),s=typeof t=="function"?t({present:r.isPresent}):E.Children.only(t),i=$t(r.ref,Ode(s));return typeof t=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};$i.displayName="Presence";function Mde(n){const[e,t]=E.useState(),r=E.useRef(null),s=E.useRef(n),i=E.useRef("none"),a=n?"mounted":"unmounted",[o,l]=Pde(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=Xy(r.current);i.current=o==="mounted"?c:"none"},[o]),vr(()=>{const c=r.current,u=s.current;if(u!==n){const m=i.current,g=Xy(c);n?l("MOUNT"):g==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&m!==g?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),vr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,f=g=>{const b=Xy(r.current).includes(g.animationName);if(g.target===e&&b&&(l("ANIMATION_END"),!s.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},m=g=>{g.target===e&&(i.current=Xy(r.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,t(c)},[])}}function Xy(n){return n?.animationName||"none"}function Ode(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var Nde=E8[" useId ".trim().toString()]||(()=>{}),jde=0;function zs(n){const[e,t]=E.useState(Nde());return vr(()=>{t(r=>r??String(jde++))},[n]),e?`radix-${e}`:""}var sS="Collapsible",[Fde,Cz]=Ns(sS),[Ude,uD]=Fde(sS),kz=E.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:r,defaultOpen:s,disabled:i,onOpenChange:a,...o}=n,[l,c]=vi({prop:r,defaultProp:s??!1,onChange:a,caller:sS});return d.jsx(Ude,{scope:t,disabled:i,contentId:zs(),open:l,onOpenToggle:E.useCallback(()=>c(u=>!u),[c]),children:d.jsx(_t.div,{"data-state":hD(l),"data-disabled":i?"":void 0,...o,ref:e})})});kz.displayName=sS;var Iz="CollapsibleTrigger",Lz=E.forwardRef((n,e)=>{const{__scopeCollapsible:t,...r}=n,s=uD(Iz,t);return d.jsx(_t.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":hD(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:e,onClick:rt(n.onClick,s.onOpenToggle)})});Lz.displayName=Iz;var dD="CollapsibleContent",Dz=E.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=uD(dD,n.__scopeCollapsible);return d.jsx($i,{present:t||s.open,children:({present:i})=>d.jsx($de,{...r,ref:e,present:i})})});Dz.displayName=dD;var $de=E.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:r,children:s,...i}=n,a=uD(dD,t),[o,l]=E.useState(r),c=E.useRef(null),u=$t(e,c),f=E.useRef(0),m=f.current,g=E.useRef(0),y=g.current,b=a.open||o,x=E.useRef(b),S=E.useRef(void 0);return E.useEffect(()=>{const T=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(T)},[]),vr(()=>{const T=c.current;if(T){S.current=S.current||{transitionDuration:T.style.transitionDuration,animationName:T.style.animationName},T.style.transitionDuration="0s",T.style.animationName="none";const _=T.getBoundingClientRect();f.current=_.height,g.current=_.width,x.current||(T.style.transitionDuration=S.current.transitionDuration,T.style.animationName=S.current.animationName),l(r)}},[a.open,r]),d.jsx(_t.div,{"data-state":hD(a.open),"data-disabled":a.disabled?"":void 0,id:a.contentId,hidden:!b,...i,ref:u,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...n.style},children:b&&s})});function hD(n){return n?"open":"closed"}var Bde=kz,Hde=Lz,Vde=Dz,zde=E.createContext(void 0);function qv(n){const e=E.useContext(zde);return n||e||"ltr"}var Qa="Accordion",Gde=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[fD,qde,Wde]=Gv(Qa),[iS,pje]=Ns(Qa,[Wde,Cz]),mD=Cz(),Pz=ve.forwardRef((n,e)=>{const{type:t,...r}=n,s=r,i=r;return d.jsx(fD.Provider,{scope:n.__scopeAccordion,children:t==="multiple"?d.jsx(Qde,{...i,ref:e}):d.jsx(Xde,{...s,ref:e})})});Pz.displayName=Qa;var[Mz,Kde]=iS(Qa),[Oz,Yde]=iS(Qa,{collapsible:!1}),Xde=ve.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...a}=n,[o,l]=vi({prop:t,defaultProp:r??"",onChange:s,caller:Qa});return d.jsx(Mz,{scope:n.__scopeAccordion,value:ve.useMemo(()=>o?[o]:[],[o]),onItemOpen:l,onItemClose:ve.useCallback(()=>i&&l(""),[i,l]),children:d.jsx(Oz,{scope:n.__scopeAccordion,collapsible:i,children:d.jsx(Nz,{...a,ref:e})})})}),Qde=ve.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:s=()=>{},...i}=n,[a,o]=vi({prop:t,defaultProp:r??[],onChange:s,caller:Qa}),l=ve.useCallback(u=>o((f=[])=>[...f,u]),[o]),c=ve.useCallback(u=>o((f=[])=>f.filter(m=>m!==u)),[o]);return d.jsx(Mz,{scope:n.__scopeAccordion,value:a,onItemOpen:l,onItemClose:c,children:d.jsx(Oz,{scope:n.__scopeAccordion,collapsible:!0,children:d.jsx(Nz,{...i,ref:e})})})}),[Zde,aS]=iS(Qa),Nz=ve.forwardRef((n,e)=>{const{__scopeAccordion:t,disabled:r,dir:s,orientation:i="vertical",...a}=n,o=ve.useRef(null),l=$t(o,e),c=qde(t),f=qv(s)==="ltr",m=rt(n.onKeyDown,g=>{if(!Gde.includes(g.key))return;const y=g.target,b=c().filter(k=>!k.ref.current?.disabled),x=b.findIndex(k=>k.ref.current===y),S=b.length;if(x===-1)return;g.preventDefault();let T=x;const _=0,R=S-1,I=()=>{T=x+1,T>R&&(T=_)},C=()=>{T=x-1,T<_&&(T=R)};switch(g.key){case"Home":T=_;break;case"End":T=R;break;case"ArrowRight":i==="horizontal"&&(f?I():C());break;case"ArrowDown":i==="vertical"&&I();break;case"ArrowLeft":i==="horizontal"&&(f?C():I());break;case"ArrowUp":i==="vertical"&&C();break}const L=T%S;b[L].ref.current?.focus()});return d.jsx(Zde,{scope:t,disabled:r,direction:s,orientation:i,children:d.jsx(fD.Slot,{scope:t,children:d.jsx(_t.div,{...a,"data-orientation":i,ref:l,onKeyDown:r?void 0:m})})})}),uw="AccordionItem",[Jde,pD]=iS(uw),jz=ve.forwardRef((n,e)=>{const{__scopeAccordion:t,value:r,...s}=n,i=aS(uw,t),a=Kde(uw,t),o=mD(t),l=zs(),c=r&&a.value.includes(r)||!1,u=i.disabled||n.disabled;return d.jsx(Jde,{scope:t,open:c,disabled:u,triggerId:l,children:d.jsx(Bde,{"data-orientation":i.orientation,"data-state":Vz(c),...o,...s,ref:e,disabled:u,open:c,onOpenChange:f=>{f?a.onItemOpen(r):a.onItemClose(r)}})})});jz.displayName=uw;var Fz="AccordionHeader",Uz=ve.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=aS(Qa,t),i=pD(Fz,t);return d.jsx(_t.h3,{"data-orientation":s.orientation,"data-state":Vz(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:e})});Uz.displayName=Fz;var VC="AccordionTrigger",$z=ve.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=aS(Qa,t),i=pD(VC,t),a=Yde(VC,t),o=mD(t);return d.jsx(fD.ItemSlot,{scope:t,children:d.jsx(Hde,{"aria-disabled":i.open&&!a.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...o,...r,ref:e})})});$z.displayName=VC;var Bz="AccordionContent",Hz=ve.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=aS(Qa,t),i=pD(Bz,t),a=mD(t);return d.jsx(Vde,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...a,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});Hz.displayName=Bz;function Vz(n){return n?"open":"closed"}var ehe=Pz,the=jz,nhe=Uz,zz=$z,Gz=Hz;const rhe=ehe,qz=E.forwardRef(({className:n,...e},t)=>d.jsx(the,{ref:t,className:je("border-b border-border",n),...e}));qz.displayName="AccordionItem";const Wz=E.forwardRef(({className:n,children:e,...t},r)=>d.jsx(nhe,{className:"flex",children:d.jsxs(zz,{ref:r,className:je("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",n),...t,children:[e,d.jsx(Id,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Wz.displayName=zz.displayName;const Kz=E.forwardRef(({className:n,children:e,...t},r)=>d.jsx(Gz,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:d.jsx("div",{className:je("pb-4 pt-0",n),children:e})}));Kz.displayName=Gz.displayName;const she={Product:[{question:"Is the free plan truly unlimited?",answer:"Yes, on the free plan you can use Flask, including all the recording features, tagging and AI summarization. Just upload your videos to YouTube either as public or unlisted and drop the link in Flask."},{question:"How does the YouTube video support work?",answer:"Flask supports both YouTube videos (both with visibility 'Public' and 'Unlisted') and uploading videos from your device (for Pro users). The product and all the commenting features work in the exact same way for both. You can not only annotate public videos (e.g. for breakdowns or references), but also private ones, without any limitations on storage space."},{question:"Can anyone add comments and recordings in a Flask?",answer:"Yes. When you create a Flask, if it's set to 'Anyone with link can edit' (default option) anyone can just quickly sign in with Google and add comments and recordings to the Flask. No subscription required and no limit on number of people collaborating."},{question:"Can I have a shared space with my team where we share and organize Flasks?",answer:"Yes. When you activate a Pro subscription a Pro team is created. You can invite others in that team with an invite link: you will then have a shared space with all your team's Flasks in one place and every user will be able to upload videos from device as well as from YouTube."},{question:"Is Flask's AI processing my video?",answer:"No. Only recordings (Thoughts recordings or Screen recordings) on the canvas are analyzed by AI to extract insights."}],"Billing & Pricing":[{question:"Is there a monthly payment option?",answer:"No. We offer a yearly plan with a 30 day satisfaction guarantee, meaning you get a full refund if you are not happy with the product for any reason."},{question:"How does per-seat pricing work?",answer:"When you create a Pro team, you get added to that team (1 seat). Once team members join the team via invite link, a seat is added to your subscription. We prorate the charge for these seats for the remainder of your billing period."},{question:"Can I change my billing period?",answer:"Yes! You can switch between monthly and yearly billing anytime. When switching to yearly, you'll be charged the prorated amount immediately. When switching to monthly, the change takes effect at the end of your current period."},{question:"What happens if I remove team members?",answer:"When you remove team members, you'll receive a prorated credit on your next invoice for the unused time."},{question:"Can I cancel anytime?",answer:"Yes, you can cancel your Flask Pro subscription at any time. Just click on 'Manage Subscription' in your Pro team settings. Your team will continue to have Pro features until the end of your current billing period."},{question:"If I am not happy, can I ask for a refund on my Pro subscription?",answer:"Yes. If you are not happy for any reason with Flask Pro you can ask for a refund within 30 days of purchase. You will be refunded the full amount paid and Pro team will be deleted."},{question:"How does the Top 1% deal work?",answer:"The Top 1% of teams whose Flasks have been viewed by the most unique people (legitimately), at the end of the year will get their next year on Flask Pro completely for free"}],Team:[{question:"How do team invites work?",answer:"As a team owner, you can invite unlimited members to your Pro team. Each member will have their own account and can create and share flasks within the team workspace. You can also remove team members at any time."}]},ihe=()=>{const[n,e]=E.useState(void 0);return E.useEffect(()=>{const t=()=>{const r=window.location.hash.slice(1);r.startsWith("faq-")&&(e(r),setTimeout(()=>{const s=document.getElementById(r);s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100))};return t(),window.addEventListener("hashchange",t),()=>window.removeEventListener("hashchange",t)},[]),d.jsxs("div",{className:"w-full",children:[d.jsx("h2",{className:"text-3xl font-semibold text-white text-center pb-12 tracking-tight",children:"FAQ"}),d.jsx(rhe,{type:"single",collapsible:!0,className:"w-full",value:n,onValueChange:e,children:Object.entries(she).map(([t,r],s)=>d.jsxs(ve.Fragment,{children:[d.jsx("div",{className:"mb-4 mt-8 first:mt-0",children:d.jsx("p",{className:"text-text-secondary text-xs uppercase tracking-wider",children:t})}),r.map((i,a)=>d.jsxs(qz,{value:`faq-${s}-${a}`,id:`faq-${s}-${a}`,className:"border-border/50",children:[d.jsx(Wz,{className:"text-white hover:text-white/90 text-left",children:i.question}),d.jsx(Kz,{className:"text-text-secondary",children:i.answer})]},`${s}-${a}`))]},t))})]})},ahe=()=>d.jsxs("div",{id:"contact",className:"w-full  py-12 pt-24",children:[d.jsx("h2",{className:"text-3xl font-semibold text-white text-center pb-16 tracking-tight",children:"Talk to Humans"}),d.jsxs("div",{className:"flex flex-col items-center gap-4",children:[d.jsxs("p",{className:"text-sm text-text-primary mb-8 text-center px-4",children:["For questions, bugs, support or feedback"," ",d.jsx("span",{className:"text-text-secondary",children:"(or to send us memes)"}),", get in touch with us:"]}),d.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-4 md:gap-6 w-full md:w-auto px-4 md:px-0",children:[d.jsx(dt,{size:"lg",className:"button-secondary rounded-full flex items-center justify-center gap-3 px-6 md:px-8 py-3 md:py-4 h-auto w-full md:w-auto",asChild:!0,children:d.jsxs("a",{href:"mailto:hello@flask.to",children:[d.jsx(nz,{className:"w-5 h-5"}),"hello@flask.to"]})}),d.jsx(dt,{size:"lg",className:"flex items-center button-secondary rounded-full justify-center gap-3 px-6 md:px-8 py-3 md:py-4 h-auto w-full md:w-auto",asChild:!0,children:d.jsxs("a",{href:"https://discord.gg/Qpq3ySHkKQ",target:"_blank",rel:"noopener noreferrer",children:[d.jsx("img",{src:"/svgs/discord.svg",alt:"Discord",className:"w-5 h-5 opacity-70"}),"Community"]})}),d.jsx(dt,{size:"lg",className:"flex items-center button-secondary rounded-full justify-center gap-3 px-6 md:px-8 py-3 md:py-4 h-auto w-full md:w-auto",asChild:!0,children:d.jsxs("a",{href:"https://enritarta.notion.site/286abb4f34b78017ade3caa106f9ca9f?pvs=105",target:"_blank",rel:"noopener noreferrer",children:[d.jsx(rue,{className:"w-5 h-5"}),"Support"]})})]})]})]}),Ch=[{id:"tommy",quote:"It's Notion meets Loom, but for video collaboration",name:"Tommy Geoco",title:"Product Designer, Content Creator",personalUrl:"https://www.youtube.com/@designertom",image:"/images/testimonials/tommy.jpg",imageAlt:"Tommy Geoco"},{id:"fabrizio",quote:"We work on dozens of complex creative projects with all sorts of clients, Flask has been a lifesaver",name:"Fabrizio San Biagio",title:"CEO",company:"Seequence Studio",companyUrl:"https://www.seequencestudio.com/",image:"/images/testimonials/seequence.png",imageAlt:"Fabrizio San Biagio"},{id:"simone",quote:"We used Frame.io with my team, now I cannot even fathom going back. Flask is crazy.",name:"@sferro21",title:"Content Creator, 570k followers",personalUrl:"https://instagram.com/simone.ferretti",image:"/images/testimonials/simo.jpg",imageAlt:"Simone Ferretti"},{id:"eric",quote:"Flask completely changes how I collaborate with our team. It adds a new layer to creative communication I didn't know existed",name:"Eric Villa",title:"Producer",company:"MKBHD & The Studio",companyUrl:"https://www.youtube.com/@mkbhd",image:"/images/testimonials/mkbhd.png",imageAlt:"Eric Villa"},{id:"pedro",quote:"Flask is modernising video collaboration and I'm here for it!",name:"Pedro Duarte",title:"Head of Hype",company:"Raycast",companyUrl:"https://raycast.com",image:"/images/testimonials/raycast.png",imageAlt:"Pedro Duarte"}],Rp=({testimonial:n,className:e="",isCompact:t=!1})=>{const r=n.personalUrl||n.companyUrl;return d.jsxs("div",{className:je("relative bg-element-background border-t border-text-primary/30 rounded-3xl flex flex-col overflow-hidden h-full",e),children:[d.jsx("div",{className:"absolute inset-0 bg-element-background z-0"}),d.jsxs("div",{className:"absolute inset-0 flex z-10",children:[d.jsx("div",{className:"flex-1"}),d.jsxs("div",{className:"relative opacity-70 transition-all duration-200",children:[d.jsx("img",{src:n.image,alt:n.imageAlt,className:"h-full w-auto object-cover"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-element-background to-transparent"})]})]}),!t&&d.jsx("div",{className:"absolute top-0 left-0 right-0 h-[20%] bg-gradient-to-b from-element-background to-transparent z-20"}),d.jsxs("div",{className:"relative z-30 p-6 flex flex-col h-full",children:[d.jsxs("blockquote",{className:"text-sm text-foreground mb-4 flex-1 pr-[40%] leading-relaxed",children:['"',n.quote,'"']}),d.jsxs("div",{className:"mt-auto",children:[d.jsx("div",{className:"text-sm font-medium text-foreground",children:(n.id==="simone"||n.id==="tommy")&&r?d.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"underline",children:n.name}):n.name}),d.jsxs("div",{className:"text-xs text-text-primary/80 mt-1",children:[n.title,n.company&&d.jsxs(d.Fragment,{children:[n.title&&", ",r?d.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"underline",children:n.company}):n.company]})]})]})]})]})},ohe=({compact:n=!1,className:e})=>{const[t,r]=E.useState(0),[s,i]=E.useState(!0);return E.useEffect(()=>{if(!n||!s)return;const a=setInterval(()=>{r(o=>(o+1)%Ch.length)},4e3);return()=>clearInterval(a)},[n,s]),d.jsx("div",{className:je("relative w-full items-center justify-center max-w-4xl mx-auto flex flex-col min-h-[900px]",e),children:d.jsxs("div",{className:"relative flex flex-col md:grid md:grid-cols-2 gap-8 w-full h-full md:-mt-10 md:py-16 px-4 md:px-16",children:[d.jsxs("div",{className:"flex flex-col gap-8 items-stretch md:items-start",children:[d.jsx("div",{className:"w-full md:w-80",children:d.jsx(Rp,{testimonial:Ch.find(a=>a.id==="eric"),className:"w-full"})}),d.jsx("div",{className:"w-full md:w-80 md:mt-8",children:d.jsx(Rp,{testimonial:Ch.find(a=>a.id==="tommy"),className:"w-full"})}),d.jsx("div",{className:"w-full md:w-80 md:mt-8",children:d.jsx(Rp,{testimonial:Ch.find(a=>a.id==="simone"),className:"w-full"})})]}),d.jsxs("div",{className:"flex flex-col gap-8 items-stretch md:items-end",children:[d.jsx("div",{className:"w-full md:w-80 md:mt-16",children:d.jsx(Rp,{testimonial:Ch.find(a=>a.id==="pedro"),className:"w-full"})}),d.jsx("div",{className:"w-full md:w-80 md:mt-8",children:d.jsx(Rp,{testimonial:Ch.find(a=>a.id==="fabrizio"),className:"w-full"})})]})]})})},lhe=E.lazy(()=>Ze(()=>Promise.resolve().then(()=>CNe),void 0).then(n=>new Promise(e=>{requestAnimationFrame(()=>e(n))}))),che=({onLoad:n,children:e})=>(E.useEffect(()=>{n()},[n]),d.jsx(d.Fragment,{children:e})),uhe=ve.memo(function(){const e=Jn(),[t,r]=E.useState(1),[s,i]=E.useState(2),[a,o]=E.useState(.3),[l,c]=E.useState(-20),[u,f]=E.useState(!1);E.useEffect(()=>{const g=()=>{const y=window.scrollY,b=window.innerHeight,x=0,S=b*.5;if(y<=x)r(1);else if(y>=S)r(0);else{const R=(y-x)/(S-x);r(1-R)}const T=b*.5,_=b*.75;if(y<=T)i(2),o(.3),c(-20);else if(y<_){const R=(y-T)/(_-T);i(2*(1-R)),o(.3*(1-R)),c(-20)}else{i(0),o(0);const R=b;if(y>=R)c(0);else{const I=(y-_)/(R-_);c(-20*(1-I))}}};return window.addEventListener("scroll",g),()=>window.removeEventListener("scroll",g)},[]);const m={"@context":"https://schema.org","@graph":[wde(),Ede(),Sde(),Tde(),_de()]};return d.jsxs("div",{className:"min-h-screen text-foreground",children:[d.jsx(Rz,{title:"Flask - Video Collaboration for Creative Teams",description:"Next-gen video collaboration tool for creative teams. Record in-depth feedback, add any reference on your screen, and let AI extract what matters. Tag, filter, and organize comments on a visual canvas.",canonical:"/",ogImage:"/images/OpenGraphImage.png",structuredData:m,keywords:"video collaboration, creative feedback, flask do, do flask, flask . do, video review, team collaboration, creative tools, video annotation, screen recording, AI feedback, visual feedback, creative workflow, design feedback, video comments, creative teams, visual canvas, tagging system"}),d.jsx("div",{style:{opacity:t,transition:"opacity 0.1s ease-out "}}),d.jsx(hde,{}),d.jsx(xde,{}),d.jsxs("main",{className:"relative flex flex-col items-center",style:{zIndex:1},children:[d.jsxs("div",{className:"flex flex-col w-full max-w-7xl md:pt-24 px-4 md:px-12 relative justify-between",style:{minHeight:"calc(100vh - 96px)"},children:[d.jsx("div",{className:"flex-1 md:flex-1",style:{maxHeight:"150px",minHeight:"20px"}}),d.jsxs("div",{className:"flex flex-col items-center space-y-6 md:space-y-8 text-center w-full",children:[d.jsx("div",{className:"w-full 2xl:max-w-6xl lg:max-w-4xl shadow-2xl shadow-black/50 border-t border-text-primary/30 rounded-[32px] p-2 bg-element-background z-10 relative",children:d.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:d.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full rounded-3xl",src:"https://www.youtube.com/embed/rFzF9nP1vcY?modestbranding=1&rel=0&showinfo=0&controls=0&fs=0&loop=1&playlist=rFzF9nP1vcY&disablekb=1&iv_load_policy=3",title:"Flask Demo Video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})})}),d.jsxs("div",{className:"space-y-2 flex flex-col items-center relative z-20",children:[d.jsx("h1",{className:"text-3xl leading-tight tracking-tight md:leading-none ",style:{color:"#FFFFFF",textShadow:"0 4px 8px rgba(0, 0, 0, 0.4)"},children:"Video collaboration, built for how creatives actually work"}),d.jsx("h3",{className:"text-lg md:text-md  tracking-tight leading-7 text-text-primary/90 md:leading-10",style:{textShadow:"0 4px 8px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.6)"},children:"Notion + Loom, but for videos"})]})]}),d.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative z-10 mb-6 md:mt-0",style:{minHeight:"20px"},children:[d.jsxs(dt,{onClick:()=>e("/dash"),className:"group rounded-full flex items-center gap-3 px-12 py-6 w-auto button-primary font-semibold text-md cursor-pointer shadow-xl hover:shadow-xl transition-all duration-200",children:[d.jsx("span",{children:"Get Started "}),d.jsx(nS,{className:"group-hover:translate-x-2 transition-transform duration-200"})]}),d.jsx(dt,{onClick:()=>window.open("https://cal.com/enricotartarotti/flask-20?overlayCalendar=true","_blank"),className:"group rounded-full flex items-center gap-3 px-6 py-3 w-auto button-secondary mt-3 text-sm cursor-pointer shadow-xl hover:shadow-xl transition-all duration-200",children:d.jsx("span",{children:"Book a Demo "})})]})]}),d.jsx("div",{className:"w-full flex justify-center mt-24",style:{overflow:"visible",position:"relative",zIndex:0},children:d.jsxs("div",{className:"relative",children:[" ",d.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",width:"100vw",height:"200vh",pointerEvents:"none",zIndex:1,isolation:"isolate",opacity:u?1:0,transition:"opacity 1.5s ease-in"},children:d.jsx(E.Suspense,{fallback:null,children:d.jsx(che,{onLoad:()=>f(!0),children:d.jsx(lhe,{raysOrigin:"bottom-center",raysSpeed:.25,lightSpread:7,opacity:1,saturation:2,rayLength:s,followMouse:!1,mouseInfluence:0,distortion:.1,distortionPhase:a,className:"custom-rays",gradientColors:["#D15DFF","#F78264","#EFD7A4","#CFDEF6"],gradientStops:[0,.25,.5,1],gradientScale:.1,noiseAmount:.2,gradientOpacity:1})})})}),d.jsx("div",{style:{position:"absolute",top:"50px",left:"50%",transform:"translateX(-50%)",width:"100vw",zIndex:0,pointerEvents:"none"}}),d.jsx("img",{src:"/images/flasklogo.png",alt:"Flask",className:"w-40 h-40 object-contain -mt-4",style:{transform:`rotate(${l}deg)`,zIndex:0,position:"relative",transition:"transform 0.1s ease-out"}})]})}),d.jsxs("div",{className:"w-full flex flex-col items-center justify-center mt-16 mb-8 px-4",children:[d.jsx("div",{className:"mb-10",children:d.jsx("a",{href:"https://www.producthunt.com/products/flask-6/launches/flask-4",target:"_blank",rel:"noopener noreferrer",className:"block",children:d.jsx("img",{src:"/svgs/award.svg",alt:"Flask - Product of the Month",className:"w-full px-8 md:w-[400px] h-auto  transition-opacity duration-200 hover:opacity-80"})})}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6 items-center justify-center",children:[d.jsx("a",{href:"https://www.producthunt.com/products/flask-6/launches/flask-4",target:"_blank",rel:"noopener noreferrer",className:"block",children:d.jsx("img",{src:"/svgs/award2.svg",alt:"Flask - Product of the Month #1 Artificial Intelligence",className:"w-full px-12 md:w-[320px] h-auto transition-opacity duration-200 hover:opacity-80"})}),d.jsx("a",{href:"https://www.producthunt.com/products/flask-6/launches/flask-4",target:"_blank",rel:"noopener noreferrer",className:"block",children:d.jsx("img",{src:"/svgs/award3.svg",alt:"Flask - Product of the Month #1 Design Tools",className:"w-full px-12 md:w-[320px] h-auto transition-opacity duration-200 hover:opacity-80"})})]})]}),d.jsx("div",{className:"w-full px-4  relative",style:{zIndex:1},children:d.jsx(ohe,{})}),d.jsx("div",{id:"features",className:"w-full max-w-6xl mb-24 px-4 md:px-8 ",children:d.jsxs("div",{className:" p-8 md:p-12 space-y-8 ",children:[d.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-center",children:[d.jsxs("div",{className:"flex-1 space-y-4",children:[d.jsx("h2",{className:"text-2xl font-semibold text-white tracking-tight",children:d.jsx("div",{className:"flex",children:"Show, don't type."})}),d.jsx("ul",{className:"space-y-3 text-md",children:d.jsx("li",{className:"text-text-secondary",children:"Record your feedback and share any reference on your screen. Watch Flask turn your 5-minute ramble into 3 clear tasks"})})]}),d.jsx("div",{className:"flex-1",children:d.jsx("img",{src:"/images/showdonttell.png",alt:"Show don't tell - Flask video feedback",className:"w-full h-auto rounded-xl"})})]}),d.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-8 items-center",children:[d.jsxs("div",{className:"flex-1 space-y-4",children:[d.jsx("h2",{className:"text-2xl font-semibold text-white tracking-tight",children:"Free, unlimited video collaboration ."}),d.jsxs("ul",{className:"space-y-3 text-md",children:[d.jsx("li",{className:"text-text-secondary",children:"Unlimited videos, unlimited feedback,for free using YouTube."}),d.jsx("li",{className:"text-text-secondary",children:"For creative teams, Flask Pro gives you shared workspaces and uploads directly to Flask."})]})]}),d.jsx("div",{className:"flex-1 flex justify-end items-center",children:d.jsx("div",{className:" bg-zinc-700 rounded-xl  overflow-hidden",children:d.jsx("img",{src:"/images/freepro.jpg",alt:"Free unlimited collaboration",className:"w-full h-full object-cover"})})})]}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-center",children:[d.jsxs("div",{className:"flex-1 space-y-4",children:[d.jsx("h2",{className:"text-2xl font-semibold text-white tracking-tight",children:"Tag, filter, and organize."}),d.jsx("ul",{className:"space-y-3 text-md",children:d.jsx("li",{className:"text-text-secondary",children:"Create custom tags, filter what's shown, build the system that works for you."})})]}),d.jsx("div",{className:"flex-1",children:d.jsx("img",{src:"/images/Tag-preview.png",alt:"Tag, filter, and organize - Flask tagging system",className:"w-full h-auto rounded-xl"})})]})]})}),d.jsx("div",{id:"pricing",className:"w-full max-w-5xl px-4 md:px-8 ",children:d.jsxs("div",{className:"bg-card-background  rounded-3xl p-8 ",children:[d.jsx("h2",{className:"text-3xl font-semibold text-white text-center pb-16 tracking-tight",children:"Pricing"}),d.jsx(yde,{})]})}),d.jsx("div",{id:"faq",className:"w-full max-w-3xl mx-auto mt-16 px-4 md:px-0",children:d.jsx(ihe,{})}),d.jsx("div",{id:"talk-to-us",className:"w-full max-w-5xl mx-auto  px-4 md:px-0 mb-24 md:mb-24",children:d.jsx(ahe,{})}),d.jsxs("div",{className:"w-full max-w-4xl mx-auto mb-24 px-4 md:px-8",children:[d.jsx("div",{className:"flex flex-col items-center text-left",children:d.jsxs("p",{className:"text-text-primary text-2xl",style:{fontFamily:"'Reenie Beanie'"},children:["I built Flask because as a video creative, I hated working with my team. ",d.jsx("br",{})," ",d.jsx("br",{}),"Not because they weren't good, but because the tools to do it sucked.  ",d.jsx("br",{})," ",d.jsx("br",{}),"Creativity and taste cannot be typed: they are complex and nuanced, and no tool on the market seems to realize this. ",d.jsx("br",{}),d.jsx("br",{}),"Flask is the best creative collaboration tool I've ever used",d.jsx("br",{}),d.jsx("br",{}),"My job is for it to become yours as well.",d.jsx("br",{}),d.jsx("br",{}),"- Enrico, Founder"]})}),d.jsx("div",{className:"flex justify-center mt-12",children:d.jsx(dt,{size:"lg",className:"button-secondary rounded-full flex items-start gap-3 px-8 py-4 h-auto",asChild:!0,children:d.jsx("a",{href:"/manifesto",children:"Manifesto "})})})]})]}),d.jsx(Az,{})]})}),dhe=ve.memo(function(){return d.jsx(E.Suspense,{fallback:d.jsx("div",{className:"min-h-screen"}),children:d.jsx(uhe,{})})});function Vf(n){if(!n)return null;const e=[/(?:youtube\.com\/watch\?v=|youtube\.com\/embed\/|youtube\.com\/v\/|youtu\.be\/|youtube\.com\/shorts\/)([a-zA-Z0-9_-]{11})/,/^([a-zA-Z0-9_-]{11})$/];for(const t of e){const r=n.match(t);if(r&&r[1])return r[1]}return null}const hhe=async n=>{if(!Vf(n))return et.error("Invalid YouTube URL"),{valid:!1,error:"Invalid YouTube URL"};try{const t=await Ht("/api/youtube/validate",{method:"POST",body:JSON.stringify({url:n})}),r=await t.json();return!t.ok||!r.valid?(et.error(r.error||"Video not found or unavailable"),{valid:!1,error:r.error||"Video not found or unavailable"}):{valid:!0,title:r.title,videoId:r.videoId,duration:r.duration,channelTitle:r.channelTitle,thumbnail:r.thumbnail}}catch(t){return console.error("Error validating YouTube URL:",t),et.error("Failed to validate YouTube URL"),{valid:!1,error:"Failed to validate YouTube URL"}}};function fhe(n,e=globalThis?.document){const t=xa(n);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var mhe="DismissableLayer",zC="dismissableLayer.update",phe="dismissableLayer.pointerDownOutside",ghe="dismissableLayer.focusOutside",N3,Yz=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),om=E.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=n,c=E.useContext(Yz),[u,f]=E.useState(null),m=u?.ownerDocument??globalThis?.document,[,g]=E.useState({}),y=$t(e,L=>f(L)),b=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=b.indexOf(x),T=u?b.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,R=T>=S,I=bhe(L=>{const k=L.target,M=[...c.branches].some(D=>D.contains(k));!R||M||(s?.(L),a?.(L),L.defaultPrevented||o?.())},m),C=xhe(L=>{const k=L.target;[...c.branches].some(D=>D.contains(k))||(i?.(L),a?.(L),L.defaultPrevented||o?.())},m);return fhe(L=>{T===c.layers.size-1&&(r?.(L),!L.defaultPrevented&&o&&(L.preventDefault(),o()))},m),E.useEffect(()=>{if(u)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(N3=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),j3(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=N3)}},[u,m,t,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),j3())},[u,c]),E.useEffect(()=>{const L=()=>g({});return document.addEventListener(zC,L),()=>document.removeEventListener(zC,L)},[]),d.jsx(_t.div,{...l,ref:y,style:{pointerEvents:_?R?"auto":"none":void 0,...n.style},onFocusCapture:rt(n.onFocusCapture,C.onFocusCapture),onBlurCapture:rt(n.onBlurCapture,C.onBlurCapture),onPointerDownCapture:rt(n.onPointerDownCapture,I.onPointerDownCapture)})});om.displayName=mhe;var vhe="DismissableLayerBranch",yhe=E.forwardRef((n,e)=>{const t=E.useContext(Yz),r=E.useRef(null),s=$t(e,r);return E.useEffect(()=>{const i=r.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),d.jsx(_t.div,{...n,ref:s})});yhe.displayName=vhe;function bhe(n,e=globalThis?.document){const t=xa(n),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Xz(phe,t,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function xhe(n,e=globalThis?.document){const t=xa(n),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Xz(ghe,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function j3(){const n=new CustomEvent(zC);document.dispatchEvent(n)}function Xz(n,e,t,{discrete:r}){const s=t.originalEvent.target,i=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?cz(s,i):s.dispatchEvent(i)}var sA="focusScope.autoFocusOnMount",iA="focusScope.autoFocusOnUnmount",F3={bubbles:!1,cancelable:!0},whe="FocusScope",Wv=E.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=n,[o,l]=E.useState(null),c=xa(s),u=xa(i),f=E.useRef(null),m=$t(e,b=>l(b)),g=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(_){if(g.paused||!o)return;const R=_.target;o.contains(R)?f.current=R:Cc(f.current,{select:!0})},x=function(_){if(g.paused||!o)return;const R=_.relatedTarget;R!==null&&(o.contains(R)||Cc(f.current,{select:!0}))},S=function(_){if(document.activeElement===document.body)for(const I of _)I.removedNodes.length>0&&Cc(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",x);const T=new MutationObserver(S);return o&&T.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",x),T.disconnect()}}},[r,o,g.paused]),E.useEffect(()=>{if(o){$3.add(g);const b=document.activeElement;if(!o.contains(b)){const S=new CustomEvent(sA,F3);o.addEventListener(sA,c),o.dispatchEvent(S),S.defaultPrevented||(Ehe(Rhe(Qz(o)),{select:!0}),document.activeElement===b&&Cc(o))}return()=>{o.removeEventListener(sA,c),setTimeout(()=>{const S=new CustomEvent(iA,F3);o.addEventListener(iA,u),o.dispatchEvent(S),S.defaultPrevented||Cc(b??document.body,{select:!0}),o.removeEventListener(iA,u),$3.remove(g)},0)}}},[o,c,u,g]);const y=E.useCallback(b=>{if(!t&&!r||g.paused)return;const x=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,S=document.activeElement;if(x&&S){const T=b.currentTarget,[_,R]=She(T);_&&R?!b.shiftKey&&S===R?(b.preventDefault(),t&&Cc(_,{select:!0})):b.shiftKey&&S===_&&(b.preventDefault(),t&&Cc(R,{select:!0})):S===T&&b.preventDefault()}},[t,r,g.paused]);return d.jsx(_t.div,{tabIndex:-1,...a,ref:m,onKeyDown:y})});Wv.displayName=whe;function Ehe(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Cc(r,{select:e}),document.activeElement!==t)return}function She(n){const e=Qz(n),t=U3(e,n),r=U3(e.reverse(),n);return[t,r]}function Qz(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function U3(n,e){for(const t of n)if(!The(t,{upTo:e}))return t}function The(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function _he(n){return n instanceof HTMLInputElement&&"select"in n}function Cc(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&_he(n)&&e&&n.select()}}var $3=Ahe();function Ahe(){let n=[];return{add(e){const t=n[0];e!==t&&t?.pause(),n=B3(n,e),n.unshift(e)},remove(e){n=B3(n,e),n[0]?.resume()}}}function B3(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function Rhe(n){return n.filter(e=>e.tagName!=="A")}var Che="Portal",lm=E.forwardRef((n,e)=>{const{container:t,...r}=n,[s,i]=E.useState(!1);vr(()=>i(!0),[]);const a=t||s&&globalThis?.document?.body;return a?q8.createPortal(d.jsx(_t.div,{...r,ref:e}),a):null});lm.displayName=Che;var aA=0;function oS(){E.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??H3()),document.body.insertAdjacentElement("beforeend",n[1]??H3()),aA++,()=>{aA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),aA--}},[])}function H3(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var Co=function(){return Co=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Co.apply(this,arguments)};function Zz(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function khe(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}var Qb="right-scroll-bar-position",Zb="width-before-scroll-bar",Ihe="with-scroll-bars-hidden",Lhe="--removed-body-scroll-bar-size";function oA(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function Dhe(n,e){var t=E.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var Phe=typeof window<"u"?E.useLayoutEffect:E.useEffect,V3=new WeakMap;function Mhe(n,e){var t=Dhe(null,function(r){return n.forEach(function(s){return oA(s,r)})});return Phe(function(){var r=V3.get(t);if(r){var s=new Set(r),i=new Set(n),a=t.current;s.forEach(function(o){i.has(o)||oA(o,null)}),i.forEach(function(o){s.has(o)||oA(o,a)})}V3.set(t,n)},[n]),t}function Ohe(n){return n}function Nhe(n,e){e===void 0&&(e=Ohe);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(i){var a=e(i,r);return t.push(a),function(){t=t.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;t.length;){var a=t;t=[],a.forEach(i)}t={push:function(o){return i(o)},filter:function(){return t}}},assignMedium:function(i){r=!0;var a=[];if(t.length){var o=t;t=[],o.forEach(i),a=t}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),t}}}};return s}function jhe(n){n===void 0&&(n={});var e=Nhe(null);return e.options=Co({async:!0,ssr:!1},n),e}var Jz=function(n){var e=n.sideCar,t=Zz(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,Co({},t))};Jz.isSideCarExport=!0;function Fhe(n,e){return n.useMedium(e),Jz}var e7=jhe(),lA=function(){},lS=E.forwardRef(function(n,e){var t=E.useRef(null),r=E.useState({onScrollCapture:lA,onWheelCapture:lA,onTouchMoveCapture:lA}),s=r[0],i=r[1],a=n.forwardProps,o=n.children,l=n.className,c=n.removeScrollBar,u=n.enabled,f=n.shards,m=n.sideCar,g=n.noRelative,y=n.noIsolation,b=n.inert,x=n.allowPinchZoom,S=n.as,T=S===void 0?"div":S,_=n.gapMode,R=Zz(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),I=m,C=Mhe([t,e]),L=Co(Co({},R),s);return E.createElement(E.Fragment,null,u&&E.createElement(I,{sideCar:e7,removeScrollBar:c,shards:f,noRelative:g,noIsolation:y,inert:b,setCallbacks:i,allowPinchZoom:!!x,lockRef:t,gapMode:_}),a?E.cloneElement(E.Children.only(o),Co(Co({},L),{ref:C})):E.createElement(T,Co({},L,{className:l,ref:C}),o))});lS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};lS.classNames={fullWidth:Zb,zeroRight:Qb};var Uhe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $he(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=Uhe();return e&&n.setAttribute("nonce",e),n}function Bhe(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function Hhe(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var Vhe=function(){var n=0,e=null;return{add:function(t){n==0&&(e=$he())&&(Bhe(e,t),Hhe(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},zhe=function(){var n=Vhe();return function(e,t){E.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},t7=function(){var n=zhe(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},Ghe={left:0,top:0,right:0,gap:0},cA=function(n){return parseInt(n||"",10)||0},qhe=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[cA(t),cA(r),cA(s)]},Whe=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Ghe;var e=qhe(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},Khe=t7(),_f="data-scroll-locked",Yhe=function(n,e,t,r){var s=n.left,i=n.top,a=n.right,o=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(Ihe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(_f,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qb,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Zb,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Qb," .").concat(Qb,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Zb," .").concat(Zb,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(_f,`] {
    `).concat(Lhe,": ").concat(o,`px;
  }
`)},z3=function(){var n=parseInt(document.body.getAttribute(_f)||"0",10);return isFinite(n)?n:0},Xhe=function(){E.useEffect(function(){return document.body.setAttribute(_f,(z3()+1).toString()),function(){var n=z3()-1;n<=0?document.body.removeAttribute(_f):document.body.setAttribute(_f,n.toString())}},[])},Qhe=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;Xhe();var i=E.useMemo(function(){return Whe(s)},[s]);return E.createElement(Khe,{styles:Yhe(i,!e,s,t?"":"!important")})},GC=!1;if(typeof window<"u")try{var Qy=Object.defineProperty({},"passive",{get:function(){return GC=!0,!0}});window.addEventListener("test",Qy,Qy),window.removeEventListener("test",Qy,Qy)}catch{GC=!1}var kh=GC?{passive:!1}:!1,Zhe=function(n){return n.tagName==="TEXTAREA"},n7=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!Zhe(n)&&t[e]==="visible")},Jhe=function(n){return n7(n,"overflowY")},efe=function(n){return n7(n,"overflowX")},G3=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=r7(n,r);if(s){var i=s7(n,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},tfe=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},nfe=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},r7=function(n,e){return n==="v"?Jhe(e):efe(e)},s7=function(n,e){return n==="v"?tfe(e):nfe(e)},rfe=function(n,e){return n==="h"&&e==="rtl"?-1:1},sfe=function(n,e,t,r,s){var i=rfe(n,window.getComputedStyle(e).direction),a=i*r,o=t.target,l=e.contains(o),c=!1,u=a>0,f=0,m=0;do{if(!o)break;var g=s7(n,o),y=g[0],b=g[1],x=g[2],S=b-x-i*y;(y||S)&&r7(n,o)&&(f+=S,m+=y);var T=o.parentNode;o=T&&T.nodeType===Node.DOCUMENT_FRAGMENT_NODE?T.host:T}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(u&&Math.abs(f)<1||!u&&Math.abs(m)<1)&&(c=!0),c},Zy=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},q3=function(n){return[n.deltaX,n.deltaY]},W3=function(n){return n&&"current"in n?n.current:n},ife=function(n,e){return n[0]===e[0]&&n[1]===e[1]},afe=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},ofe=0,Ih=[];function lfe(n){var e=E.useRef([]),t=E.useRef([0,0]),r=E.useRef(),s=E.useState(ofe++)[0],i=E.useState(t7)[0],a=E.useRef(n);E.useEffect(function(){a.current=n},[n]),E.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var b=khe([n.lockRef.current],(n.shards||[]).map(W3),!0).filter(Boolean);return b.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var o=E.useCallback(function(b,x){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var S=Zy(b),T=t.current,_="deltaX"in b?b.deltaX:T[0]-S[0],R="deltaY"in b?b.deltaY:T[1]-S[1],I,C=b.target,L=Math.abs(_)>Math.abs(R)?"h":"v";if("touches"in b&&L==="h"&&C.type==="range")return!1;var k=G3(L,C);if(!k)return!0;if(k?I=L:(I=L==="v"?"h":"v",k=G3(L,C)),!k)return!1;if(!r.current&&"changedTouches"in b&&(_||R)&&(r.current=I),!I)return!0;var M=r.current||I;return sfe(M,x,b,M==="h"?_:R)},[]),l=E.useCallback(function(b){var x=b;if(!(!Ih.length||Ih[Ih.length-1]!==i)){var S="deltaY"in x?q3(x):Zy(x),T=e.current.filter(function(I){return I.name===x.type&&(I.target===x.target||x.target===I.shadowParent)&&ife(I.delta,S)})[0];if(T&&T.should){x.cancelable&&x.preventDefault();return}if(!T){var _=(a.current.shards||[]).map(W3).filter(Boolean).filter(function(I){return I.contains(x.target)}),R=_.length>0?o(x,_[0]):!a.current.noIsolation;R&&x.cancelable&&x.preventDefault()}}},[]),c=E.useCallback(function(b,x,S,T){var _={name:b,delta:x,target:S,should:T,shadowParent:cfe(S)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(R){return R!==_})},1)},[]),u=E.useCallback(function(b){t.current=Zy(b),r.current=void 0},[]),f=E.useCallback(function(b){c(b.type,q3(b),b.target,o(b,n.lockRef.current))},[]),m=E.useCallback(function(b){c(b.type,Zy(b),b.target,o(b,n.lockRef.current))},[]);E.useEffect(function(){return Ih.push(i),n.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:m}),document.addEventListener("wheel",l,kh),document.addEventListener("touchmove",l,kh),document.addEventListener("touchstart",u,kh),function(){Ih=Ih.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,kh),document.removeEventListener("touchmove",l,kh),document.removeEventListener("touchstart",u,kh)}},[]);var g=n.removeScrollBar,y=n.inert;return E.createElement(E.Fragment,null,y?E.createElement(i,{styles:afe(s)}):null,g?E.createElement(Qhe,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function cfe(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const ufe=Fhe(e7,lfe);var Kv=E.forwardRef(function(n,e){return E.createElement(lS,Co({},n,{ref:e,sideCar:ufe}))});Kv.classNames=lS.classNames;var dfe=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},Lh=new WeakMap,Jy=new WeakMap,eb={},uA=0,i7=function(n){return n&&(n.host||i7(n.parentNode))},hfe=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=i7(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},ffe=function(n,e,t,r){var s=hfe(e,Array.isArray(n)?n:[n]);eb[t]||(eb[t]=new WeakMap);var i=eb[t],a=[],o=new Set,l=new Set(s),c=function(f){!f||o.has(f)||(o.add(f),c(f.parentNode))};s.forEach(c);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(m){if(o.has(m))u(m);else try{var g=m.getAttribute(r),y=g!==null&&g!=="false",b=(Lh.get(m)||0)+1,x=(i.get(m)||0)+1;Lh.set(m,b),i.set(m,x),a.push(m),b===1&&y&&Jy.set(m,!0),x===1&&m.setAttribute(t,"true"),y||m.setAttribute(r,"true")}catch(S){console.error("aria-hidden: cannot operate on ",m,S)}})};return u(e),o.clear(),uA++,function(){a.forEach(function(f){var m=Lh.get(f)-1,g=i.get(f)-1;Lh.set(f,m),i.set(f,g),m||(Jy.has(f)||f.removeAttribute(r),Jy.delete(f)),g||f.removeAttribute(t)}),uA--,uA||(Lh=new WeakMap,Lh=new WeakMap,Jy=new WeakMap,eb={})}},cS=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=dfe(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),ffe(r,s,t,"aria-hidden")):function(){return null}},uS="Dialog",[a7,o7]=Ns(uS),[mfe,Za]=a7(uS),l7=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=n,o=E.useRef(null),l=E.useRef(null),[c,u]=vi({prop:r,defaultProp:s??!1,onChange:i,caller:uS});return d.jsx(mfe,{scope:e,triggerRef:o,contentRef:l,contentId:zs(),titleId:zs(),descriptionId:zs(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(f=>!f),[u]),modal:a,children:t})};l7.displayName=uS;var c7="DialogTrigger",u7=E.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Za(c7,t),i=$t(e,s.triggerRef);return d.jsx(_t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":yD(s.open),...r,ref:i,onClick:rt(n.onClick,s.onOpenToggle)})});u7.displayName=c7;var gD="DialogPortal",[pfe,d7]=a7(gD,{forceMount:void 0}),h7=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:s}=n,i=Za(gD,e);return d.jsx(pfe,{scope:e,forceMount:t,children:E.Children.map(r,a=>d.jsx($i,{present:t||i.open,children:d.jsx(lm,{asChild:!0,container:s,children:a})}))})};h7.displayName=gD;var dw="DialogOverlay",f7=E.forwardRef((n,e)=>{const t=d7(dw,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=Za(dw,n.__scopeDialog);return i.modal?d.jsx($i,{present:r||i.open,children:d.jsx(vfe,{...s,ref:e})}):null});f7.displayName=dw;var gfe=eu("DialogOverlay.RemoveScroll"),vfe=E.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Za(dw,t);return d.jsx(Kv,{as:gfe,allowPinchZoom:!0,shards:[s.contentRef],children:d.jsx(_t.div,{"data-state":yD(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),bd="DialogContent",m7=E.forwardRef((n,e)=>{const t=d7(bd,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=Za(bd,n.__scopeDialog);return d.jsx($i,{present:r||i.open,children:i.modal?d.jsx(yfe,{...s,ref:e}):d.jsx(bfe,{...s,ref:e})})});m7.displayName=bd;var yfe=E.forwardRef((n,e)=>{const t=Za(bd,n.__scopeDialog),r=E.useRef(null),s=$t(e,t.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return cS(i)},[]),d.jsx(p7,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rt(n.onCloseAutoFocus,i=>{i.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:rt(n.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:rt(n.onFocusOutside,i=>i.preventDefault())})}),bfe=E.forwardRef((n,e)=>{const t=Za(bd,n.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return d.jsx(p7,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{n.onCloseAutoFocus?.(i),i.defaultPrevented||(r.current||t.triggerRef.current?.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{n.onInteractOutside?.(i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;t.triggerRef.current?.contains(a)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),p7=E.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=n,o=Za(bd,t),l=E.useRef(null),c=$t(e,l);return oS(),d.jsxs(d.Fragment,{children:[d.jsx(Wv,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(om,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":yD(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(wfe,{titleId:o.titleId}),d.jsx(Sfe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),vD="DialogTitle",g7=E.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Za(vD,t);return d.jsx(_t.h2,{id:s.titleId,...r,ref:e})});g7.displayName=vD;var v7="DialogDescription",y7=E.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Za(v7,t);return d.jsx(_t.p,{id:s.descriptionId,...r,ref:e})});y7.displayName=v7;var b7="DialogClose",x7=E.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Za(b7,t);return d.jsx(_t.button,{type:"button",...r,ref:e,onClick:rt(n.onClick,()=>s.onOpenChange(!1))})});x7.displayName=b7;function yD(n){return n?"open":"closed"}var w7="DialogTitleWarning",[xfe,E7]=vue(w7,{contentName:bd,titleName:vD,docsSlug:"dialog"}),wfe=({titleId:n})=>{const e=E7(w7),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return E.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},Efe="DialogDescriptionWarning",Sfe=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${E7(Efe).contentName}}.`;return E.useEffect(()=>{const s=n.current?.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},S7=l7,T7=u7,_7=h7,bD=f7,xD=m7,wD=g7,ED=y7,A7=x7;const Zn=S7,Tfe=T7,_fe=_7,R7=E.forwardRef(({className:n,...e},t)=>d.jsx(bD,{ref:t,className:je("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));R7.displayName=bD.displayName;const Kn=E.forwardRef(({className:n,children:e,overlayClassName:t,...r},s)=>d.jsxs(_fe,{children:[d.jsx(R7,{className:t}),d.jsx(xD,{ref:s,className:je("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 element-border bg-element-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-3xl",n),...r,children:e})]}));Kn.displayName=xD.displayName;const ar=({className:n,...e})=>d.jsx("div",{className:je("flex flex-col space-y-1.5 text-center sm:text-left ",n),...e});ar.displayName="DialogHeader";const ys=({className:n,...e})=>d.jsx("div",{className:je("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...e});ys.displayName="DialogFooter";const or=E.forwardRef(({className:n,...e},t)=>d.jsx(wD,{ref:t,className:je("text-lg font-semibold leading-none tracking-tight ",n),...e}));or.displayName=wD.displayName;const zl=E.forwardRef(({className:n,...e},t)=>d.jsx(ED,{ref:t,className:je("text-sm text-muted-foreground",n),...e}));zl.displayName=ED.displayName;const Afe=({open:n,onOpenChange:e})=>{const{signInWithGoogle:t}=Ar(),r=async()=>{try{const s=window.location.pathname+window.location.search;await t(s)}catch(s){console.error("Error signing in with Google:",s)}};return d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsx(Kn,{className:"max-w-sm bg-card-background/50 backdrop-blur-lg py-8 rounded-3xl border-border text-white",children:d.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h2",{className:"text-2xl font-bold",children:"Almost there"}),d.jsx("p",{className:"text-sm text-text-secondary",children:"Continue with Google to add elements"})]}),d.jsxs(dt,{onClick:r,className:"w-full max-w-xs bg-white text-black hover:bg-white/90",children:[d.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),d.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),d.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),d.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),d.jsxs("p",{className:"text-xs text-text-secondary text-center px-4",children:["By continuing, you agree to the"," ",d.jsx("a",{href:"/terms-of-service",className:"text-text-primary hover:underline",children:"Terms of Service"})," ","and"," ",d.jsx("a",{href:"/privacy-policy",className:"text-text-primary hover:underline",children:"Privacy Policy"}),"."]})]})})})},Rfe=({open:n,onOpenChange:e,title:t="Flask Pro"})=>{const r=Jn(),s=()=>{e(!1),r("/#pricing")};return d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-md",onClick:i=>i.stopPropagation(),children:[d.jsx(ar,{children:d.jsx(or,{children:t})}),d.jsxs("p",{className:"text-sm text-text-secondary mt-2",children:["Flask gives you free, unlimited video collaboration using YouTube as storage. ",d.jsx("br",{}),d.jsx("br",{}),"Upload your video to YouTube (unlisted or public) and drop the link in Flask.",d.jsx("p",{className:"text-sm text-text-primary mt-4",children:"To upload videos directly from your device, upgrade to Flask Pro"})]}),d.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[d.jsx(dt,{onClick:s,variant:"ghost",className:"text-text-secondary button-secondary px-6 py-3 h-full hover:text-text-primary text-sm flex-1",children:"Upgrade to Flask Pro"}),d.jsx("div",{onClick:()=>e(!1),className:"button-primary flex items-center font-semibold rounded-xl justify-center px-6 h-full cursor-pointer text-sm flex-1",children:d.jsx("span",{children:"Got it"})})]})]})})},Cfe=["top","right","bottom","left"],tu=Math.min,Ii=Math.max,hw=Math.round,tb=Math.floor,Bo=n=>({x:n,y:n}),kfe={left:"right",right:"left",bottom:"top",top:"bottom"},Ife={start:"end",end:"start"};function qC(n,e,t){return Ii(n,tu(e,t))}function Ul(n,e){return typeof n=="function"?n(e):n}function $l(n){return n.split("-")[0]}function cm(n){return n.split("-")[1]}function SD(n){return n==="x"?"y":"x"}function TD(n){return n==="y"?"height":"width"}const Lfe=new Set(["top","bottom"]);function Oo(n){return Lfe.has($l(n))?"y":"x"}function _D(n){return SD(Oo(n))}function Dfe(n,e,t){t===void 0&&(t=!1);const r=cm(n),s=_D(n),i=TD(s);let a=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=fw(a)),[a,fw(a)]}function Pfe(n){const e=fw(n);return[WC(n),e,WC(e)]}function WC(n){return n.replace(/start|end/g,e=>Ife[e])}const K3=["left","right"],Y3=["right","left"],Mfe=["top","bottom"],Ofe=["bottom","top"];function Nfe(n,e,t){switch(n){case"top":case"bottom":return t?e?Y3:K3:e?K3:Y3;case"left":case"right":return e?Mfe:Ofe;default:return[]}}function jfe(n,e,t,r){const s=cm(n);let i=Nfe($l(n),t==="start",r);return s&&(i=i.map(a=>a+"-"+s),e&&(i=i.concat(i.map(WC)))),i}function fw(n){return n.replace(/left|right|bottom|top/g,e=>kfe[e])}function Ffe(n){return{top:0,right:0,bottom:0,left:0,...n}}function C7(n){return typeof n!="number"?Ffe(n):{top:n,right:n,bottom:n,left:n}}function mw(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function X3(n,e,t){let{reference:r,floating:s}=n;const i=Oo(e),a=_D(e),o=TD(a),l=$l(e),c=i==="y",u=r.x+r.width/2-s.width/2,f=r.y+r.height/2-s.height/2,m=r[o]/2-s[o]/2;let g;switch(l){case"top":g={x:u,y:r.y-s.height};break;case"bottom":g={x:u,y:r.y+r.height};break;case"right":g={x:r.x+r.width,y:f};break;case"left":g={x:r.x-s.width,y:f};break;default:g={x:r.x,y:r.y}}switch(cm(e)){case"start":g[a]-=m*(t&&c?-1:1);break;case"end":g[a]+=m*(t&&c?-1:1);break}return g}const Ufe=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=t,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:f}=X3(c,r,l),m=r,g={},y=0;for(let b=0;b<o.length;b++){const{name:x,fn:S}=o[b],{x:T,y:_,data:R,reset:I}=await S({x:u,y:f,initialPlacement:r,placement:m,strategy:s,middlewareData:g,rects:c,platform:a,elements:{reference:n,floating:e}});u=T??u,f=_??f,g={...g,[x]:{...g[x],...R}},I&&y<=50&&(y++,typeof I=="object"&&(I.placement&&(m=I.placement),I.rects&&(c=I.rects===!0?await a.getElementRects({reference:n,floating:e,strategy:s}):I.rects),{x:u,y:f}=X3(c,m,l)),b=-1)}return{x:u,y:f,placement:m,strategy:s,middlewareData:g}};async function iv(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:m=!1,padding:g=0}=Ul(e,n),y=C7(g),x=o[m?f==="floating"?"reference":"floating":f],S=mw(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(x)))==null||t?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),T=f==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),R=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},I=mw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:T,offsetParent:_,strategy:l}):T);return{top:(S.top-I.top+y.top)/R.y,bottom:(I.bottom-S.bottom+y.bottom)/R.y,left:(S.left-I.left+y.left)/R.x,right:(I.right-S.right+y.right)/R.x}}const $fe=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=e,{element:c,padding:u=0}=Ul(n,e)||{};if(c==null)return{};const f=C7(u),m={x:t,y:r},g=_D(s),y=TD(g),b=await a.getDimensions(c),x=g==="y",S=x?"top":"left",T=x?"bottom":"right",_=x?"clientHeight":"clientWidth",R=i.reference[y]+i.reference[g]-m[g]-i.floating[y],I=m[g]-i.reference[g],C=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let L=C?C[_]:0;(!L||!await(a.isElement==null?void 0:a.isElement(C)))&&(L=o.floating[_]||i.floating[y]);const k=R/2-I/2,M=L/2-b[y]/2-1,D=tu(f[S],M),U=tu(f[T],M),$=D,V=L-b[y]-U,B=L/2-b[y]/2+k,W=qC($,B,V),F=!l.arrow&&cm(s)!=null&&B!==W&&i.reference[y]/2-(B<$?D:U)-b[y]/2<0,j=F?B<$?B-$:B-V:0;return{[g]:m[g]+j,data:{[g]:W,centerOffset:B-W-j,...F&&{alignmentOffset:j}},reset:F}}}),Bfe=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...x}=Ul(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const S=$l(s),T=Oo(o),_=$l(o)===o,R=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=m||(_||!b?[fw(o)]:Pfe(o)),C=y!=="none";!m&&C&&I.push(...jfe(o,b,y,R));const L=[o,...I],k=await iv(e,x),M=[];let D=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&M.push(k[S]),f){const B=Dfe(s,a,R);M.push(k[B[0]],k[B[1]])}if(D=[...D,{placement:s,overflows:M}],!M.every(B=>B<=0)){var U,$;const B=(((U=i.flip)==null?void 0:U.index)||0)+1,W=L[B];if(W&&(!(f==="alignment"?T!==Oo(W):!1)||D.every(q=>Oo(q.placement)===T?q.overflows[0]>0:!0)))return{data:{index:B,overflows:D},reset:{placement:W}};let F=($=D.filter(j=>j.overflows[0]<=0).sort((j,q)=>j.overflows[1]-q.overflows[1])[0])==null?void 0:$.placement;if(!F)switch(g){case"bestFit":{var V;const j=(V=D.filter(q=>{if(C){const H=Oo(q.placement);return H===T||H==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(H=>H>0).reduce((H,N)=>H+N,0)]).sort((q,H)=>q[1]-H[1])[0])==null?void 0:V[0];j&&(F=j);break}case"initialPlacement":F=o;break}if(s!==F)return{reset:{placement:F}}}return{}}}};function Q3(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function Z3(n){return Cfe.some(e=>n[e]>=0)}const Hfe=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...s}=Ul(n,e);switch(r){case"referenceHidden":{const i=await iv(e,{...s,elementContext:"reference"}),a=Q3(i,t.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Z3(a)}}}case"escaped":{const i=await iv(e,{...s,altBoundary:!0}),a=Q3(i,t.floating);return{data:{escapedOffsets:a,escaped:Z3(a)}}}default:return{}}}}},k7=new Set(["left","top"]);async function Vfe(n,e){const{placement:t,platform:r,elements:s}=n,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=$l(t),o=cm(t),l=Oo(t)==="y",c=k7.has(a)?-1:1,u=i&&l?-1:1,f=Ul(e,n);let{mainAxis:m,crossAxis:g,alignmentAxis:y}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof y=="number"&&(g=o==="end"?y*-1:y),l?{x:g*u,y:m*c}:{x:m*c,y:g*u}}const zfe=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:i,placement:a,middlewareData:o}=e,l=await Vfe(e,n);return a===((t=o.offset)==null?void 0:t.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Gfe=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:x=>{let{x:S,y:T}=x;return{x:S,y:T}}},...l}=Ul(n,e),c={x:t,y:r},u=await iv(e,l),f=Oo($l(s)),m=SD(f);let g=c[m],y=c[f];if(i){const x=m==="y"?"top":"left",S=m==="y"?"bottom":"right",T=g+u[x],_=g-u[S];g=qC(T,g,_)}if(a){const x=f==="y"?"top":"left",S=f==="y"?"bottom":"right",T=y+u[x],_=y-u[S];y=qC(T,y,_)}const b=o.fn({...e,[m]:g,[f]:y});return{...b,data:{x:b.x-t,y:b.y-r,enabled:{[m]:i,[f]:a}}}}}},qfe=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:i,middlewareData:a}=e,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Ul(n,e),u={x:t,y:r},f=Oo(s),m=SD(f);let g=u[m],y=u[f];const b=Ul(o,e),x=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const _=m==="y"?"height":"width",R=i.reference[m]-i.floating[_]+x.mainAxis,I=i.reference[m]+i.reference[_]-x.mainAxis;g<R?g=R:g>I&&(g=I)}if(c){var S,T;const _=m==="y"?"width":"height",R=k7.has($l(s)),I=i.reference[f]-i.floating[_]+(R&&((S=a.offset)==null?void 0:S[f])||0)+(R?0:x.crossAxis),C=i.reference[f]+i.reference[_]+(R?0:((T=a.offset)==null?void 0:T[f])||0)-(R?x.crossAxis:0);y<I?y=I:y>C&&(y=C)}return{[m]:g,[f]:y}}}},Wfe=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:i,platform:a,elements:o}=e,{apply:l=()=>{},...c}=Ul(n,e),u=await iv(e,c),f=$l(s),m=cm(s),g=Oo(s)==="y",{width:y,height:b}=i.floating;let x,S;f==="top"||f==="bottom"?(x=f,S=m===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(S=f,x=m==="end"?"top":"bottom");const T=b-u.top-u.bottom,_=y-u.left-u.right,R=tu(b-u[x],T),I=tu(y-u[S],_),C=!e.middlewareData.shift;let L=R,k=I;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(k=_),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(L=T),C&&!m){const D=Ii(u.left,0),U=Ii(u.right,0),$=Ii(u.top,0),V=Ii(u.bottom,0);g?k=y-2*(D!==0||U!==0?D+U:Ii(u.left,u.right)):L=b-2*($!==0||V!==0?$+V:Ii(u.top,u.bottom))}await l({...e,availableWidth:k,availableHeight:L});const M=await a.getDimensions(o.floating);return y!==M.width||b!==M.height?{reset:{rects:!0}}:{}}}};function dS(){return typeof window<"u"}function um(n){return I7(n)?(n.nodeName||"").toLowerCase():"#document"}function Ni(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Yo(n){var e;return(e=(I7(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function I7(n){return dS()?n instanceof Node||n instanceof Ni(n).Node:!1}function Ga(n){return dS()?n instanceof Element||n instanceof Ni(n).Element:!1}function Wo(n){return dS()?n instanceof HTMLElement||n instanceof Ni(n).HTMLElement:!1}function J3(n){return!dS()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Ni(n).ShadowRoot}const Kfe=new Set(["inline","contents"]);function Yv(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=qa(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!Kfe.has(s)}const Yfe=new Set(["table","td","th"]);function Xfe(n){return Yfe.has(um(n))}const Qfe=[":popover-open",":modal"];function hS(n){return Qfe.some(e=>{try{return n.matches(e)}catch{return!1}})}const Zfe=["transform","translate","scale","rotate","perspective"],Jfe=["transform","translate","scale","rotate","perspective","filter"],eme=["paint","layout","strict","content"];function AD(n){const e=RD(),t=Ga(n)?qa(n):n;return Zfe.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||Jfe.some(r=>(t.willChange||"").includes(r))||eme.some(r=>(t.contain||"").includes(r))}function tme(n){let e=nu(n);for(;Wo(e)&&!zf(e);){if(AD(e))return e;if(hS(e))return null;e=nu(e)}return null}function RD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const nme=new Set(["html","body","#document"]);function zf(n){return nme.has(um(n))}function qa(n){return Ni(n).getComputedStyle(n)}function fS(n){return Ga(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function nu(n){if(um(n)==="html")return n;const e=n.assignedSlot||n.parentNode||J3(n)&&n.host||Yo(n);return J3(e)?e.host:e}function L7(n){const e=nu(n);return zf(e)?n.ownerDocument?n.ownerDocument.body:n.body:Wo(e)&&Yv(e)?e:L7(e)}function av(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=L7(n),i=s===((r=n.ownerDocument)==null?void 0:r.body),a=Ni(s);if(i){const o=KC(a);return e.concat(a,a.visualViewport||[],Yv(s)?s:[],o&&t?av(o):[])}return e.concat(s,av(s,[],t))}function KC(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function D7(n){const e=qa(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Wo(n),i=s?n.offsetWidth:t,a=s?n.offsetHeight:r,o=hw(t)!==i||hw(r)!==a;return o&&(t=i,r=a),{width:t,height:r,$:o}}function CD(n){return Ga(n)?n:n.contextElement}function Af(n){const e=CD(n);if(!Wo(e))return Bo(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:i}=D7(e);let a=(i?hw(t.width):t.width)/r,o=(i?hw(t.height):t.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const rme=Bo(0);function P7(n){const e=Ni(n);return!RD()||!e.visualViewport?rme:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function sme(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ni(n)?!1:e}function xd(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),i=CD(n);let a=Bo(1);e&&(r?Ga(r)&&(a=Af(r)):a=Af(n));const o=sme(i,t,r)?P7(i):Bo(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,f=s.height/a.y;if(i){const m=Ni(i),g=r&&Ga(r)?Ni(r):r;let y=m,b=KC(y);for(;b&&r&&g!==y;){const x=Af(b),S=b.getBoundingClientRect(),T=qa(b),_=S.left+(b.clientLeft+parseFloat(T.paddingLeft))*x.x,R=S.top+(b.clientTop+parseFloat(T.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,f*=x.y,l+=_,c+=R,y=Ni(b),b=KC(y)}}return mw({width:u,height:f,x:l,y:c})}function mS(n,e){const t=fS(n).scrollLeft;return e?e.left+t:xd(Yo(n)).left+t}function M7(n,e){const t=n.getBoundingClientRect(),r=t.left+e.scrollLeft-mS(n,t),s=t.top+e.scrollTop;return{x:r,y:s}}function ime(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const i=s==="fixed",a=Yo(r),o=e?hS(e.floating):!1;if(r===a||o&&i)return t;let l={scrollLeft:0,scrollTop:0},c=Bo(1);const u=Bo(0),f=Wo(r);if((f||!f&&!i)&&((um(r)!=="body"||Yv(a))&&(l=fS(r)),Wo(r))){const g=xd(r);c=Af(r),u.x=g.x+r.clientLeft,u.y=g.y+r.clientTop}const m=a&&!f&&!i?M7(a,l):Bo(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+m.x,y:t.y*c.y-l.scrollTop*c.y+u.y+m.y}}function ame(n){return Array.from(n.getClientRects())}function ome(n){const e=Yo(n),t=fS(n),r=n.ownerDocument.body,s=Ii(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Ii(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-t.scrollLeft+mS(n);const o=-t.scrollTop;return qa(r).direction==="rtl"&&(a+=Ii(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}const e$=25;function lme(n,e){const t=Ni(n),r=Yo(n),s=t.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const u=RD();(!u||u&&e==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}const c=mS(r);if(c<=0){const u=r.ownerDocument,f=u.body,m=getComputedStyle(f),g=u.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,y=Math.abs(r.clientWidth-f.clientWidth-g);y<=e$&&(i-=y)}else c<=e$&&(i+=c);return{width:i,height:a,x:o,y:l}}const cme=new Set(["absolute","fixed"]);function ume(n,e){const t=xd(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,i=Wo(n)?Af(n):Bo(1),a=n.clientWidth*i.x,o=n.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function t$(n,e,t){let r;if(e==="viewport")r=lme(n,t);else if(e==="document")r=ome(Yo(n));else if(Ga(e))r=ume(e,t);else{const s=P7(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return mw(r)}function O7(n,e){const t=nu(n);return t===e||!Ga(t)||zf(t)?!1:qa(t).position==="fixed"||O7(t,e)}function dme(n,e){const t=e.get(n);if(t)return t;let r=av(n,[],!1).filter(o=>Ga(o)&&um(o)!=="body"),s=null;const i=qa(n).position==="fixed";let a=i?nu(n):n;for(;Ga(a)&&!zf(a);){const o=qa(a),l=AD(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&cme.has(s.position)||Yv(a)&&!l&&O7(n,a))?r=r.filter(u=>u!==a):s=o,a=nu(a)}return e.set(n,r),r}function hme(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const a=[...t==="clippingAncestors"?hS(e)?[]:dme(e,this._c):[].concat(t),r],o=a[0],l=a.reduce((c,u)=>{const f=t$(e,u,s);return c.top=Ii(f.top,c.top),c.right=tu(f.right,c.right),c.bottom=tu(f.bottom,c.bottom),c.left=Ii(f.left,c.left),c},t$(e,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function fme(n){const{width:e,height:t}=D7(n);return{width:e,height:t}}function mme(n,e,t){const r=Wo(e),s=Yo(e),i=t==="fixed",a=xd(n,!0,i,e);let o={scrollLeft:0,scrollTop:0};const l=Bo(0);function c(){l.x=mS(s)}if(r||!r&&!i)if((um(e)!=="body"||Yv(s))&&(o=fS(e)),r){const g=xd(e,!0,i,e);l.x=g.x+e.clientLeft,l.y=g.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?M7(s,o):Bo(0),f=a.left+o.scrollLeft-l.x-u.x,m=a.top+o.scrollTop-l.y-u.y;return{x:f,y:m,width:a.width,height:a.height}}function dA(n){return qa(n).position==="static"}function n$(n,e){if(!Wo(n)||qa(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Yo(n)===t&&(t=t.ownerDocument.body),t}function N7(n,e){const t=Ni(n);if(hS(n))return t;if(!Wo(n)){let s=nu(n);for(;s&&!zf(s);){if(Ga(s)&&!dA(s))return s;s=nu(s)}return t}let r=n$(n,e);for(;r&&Xfe(r)&&dA(r);)r=n$(r,e);return r&&zf(r)&&dA(r)&&!AD(r)?t:r||tme(n)||t}const pme=async function(n){const e=this.getOffsetParent||N7,t=this.getDimensions,r=await t(n.floating);return{reference:mme(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function gme(n){return qa(n).direction==="rtl"}const vme={convertOffsetParentRelativeRectToViewportRelativeRect:ime,getDocumentElement:Yo,getClippingRect:hme,getOffsetParent:N7,getElementRects:pme,getClientRects:ame,getDimensions:fme,getScale:Af,isElement:Ga,isRTL:gme};function j7(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function yme(n,e){let t=null,r;const s=Yo(n);function i(){var o;clearTimeout(r),(o=t)==null||o.disconnect(),t=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=n.getBoundingClientRect(),{left:u,top:f,width:m,height:g}=c;if(o||e(),!m||!g)return;const y=tb(f),b=tb(s.clientWidth-(u+m)),x=tb(s.clientHeight-(f+g)),S=tb(u),_={rootMargin:-y+"px "+-b+"px "+-x+"px "+-S+"px",threshold:Ii(0,tu(1,l))||1};let R=!0;function I(C){const L=C[0].intersectionRatio;if(L!==l){if(!R)return a();L?a(!1,L):r=setTimeout(()=>{a(!1,1e-7)},1e3)}L===1&&!j7(c,n.getBoundingClientRect())&&a(),R=!1}try{t=new IntersectionObserver(I,{..._,root:s.ownerDocument})}catch{t=new IntersectionObserver(I,_)}t.observe(n)}return a(!0),i}function bme(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=CD(n),u=s||i?[...c?av(c):[],...av(e)]:[];u.forEach(S=>{s&&S.addEventListener("scroll",t,{passive:!0}),i&&S.addEventListener("resize",t)});const f=c&&o?yme(c,t):null;let m=-1,g=null;a&&(g=new ResizeObserver(S=>{let[T]=S;T&&T.target===c&&g&&(g.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var _;(_=g)==null||_.observe(e)})),t()}),c&&!l&&g.observe(c),g.observe(e));let y,b=l?xd(n):null;l&&x();function x(){const S=xd(n);b&&!j7(b,S)&&t(),b=S,y=requestAnimationFrame(x)}return t(),()=>{var S;u.forEach(T=>{s&&T.removeEventListener("scroll",t),i&&T.removeEventListener("resize",t)}),f?.(),(S=g)==null||S.disconnect(),g=null,l&&cancelAnimationFrame(y)}}const xme=zfe,wme=Gfe,Eme=Bfe,Sme=Wfe,Tme=Hfe,r$=$fe,_me=qfe,Ame=(n,e,t)=>{const r=new Map,s={platform:vme,...t},i={...s.platform,_c:r};return Ufe(n,e,{...s,platform:i})};var Rme=typeof document<"u",Cme=function(){},Jb=Rme?E.useLayoutEffect:Cme;function pw(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!pw(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const i=s[r];if(!(i==="_owner"&&n.$$typeof)&&!pw(n[i],e[i]))return!1}return!0}return n!==n&&e!==e}function F7(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function s$(n,e){const t=F7(n);return Math.round(e*t)/t}function hA(n){const e=E.useRef(n);return Jb(()=>{e.current=n}),e}function kme(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=n,[u,f]=E.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[m,g]=E.useState(r);pw(m,r)||g(r);const[y,b]=E.useState(null),[x,S]=E.useState(null),T=E.useCallback(q=>{q!==C.current&&(C.current=q,b(q))},[]),_=E.useCallback(q=>{q!==L.current&&(L.current=q,S(q))},[]),R=i||y,I=a||x,C=E.useRef(null),L=E.useRef(null),k=E.useRef(u),M=l!=null,D=hA(l),U=hA(s),$=hA(c),V=E.useCallback(()=>{if(!C.current||!L.current)return;const q={placement:e,strategy:t,middleware:m};U.current&&(q.platform=U.current),Ame(C.current,L.current,q).then(H=>{const N={...H,isPositioned:$.current!==!1};B.current&&!pw(k.current,N)&&(k.current=N,Hs.flushSync(()=>{f(N)}))})},[m,e,t,U,$]);Jb(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,f(q=>({...q,isPositioned:!1})))},[c]);const B=E.useRef(!1);Jb(()=>(B.current=!0,()=>{B.current=!1}),[]),Jb(()=>{if(R&&(C.current=R),I&&(L.current=I),R&&I){if(D.current)return D.current(R,I,V);V()}},[R,I,V,D,M]);const W=E.useMemo(()=>({reference:C,floating:L,setReference:T,setFloating:_}),[T,_]),F=E.useMemo(()=>({reference:R,floating:I}),[R,I]),j=E.useMemo(()=>{const q={position:t,left:0,top:0};if(!F.floating)return q;const H=s$(F.floating,u.x),N=s$(F.floating,u.y);return o?{...q,transform:"translate("+H+"px, "+N+"px)",...F7(F.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:H,top:N}},[t,o,F.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:V,refs:W,elements:F,floatingStyles:j}),[u,V,W,F,j])}const Ime=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?r$({element:r.current,padding:s}).fn(t):{}:r?r$({element:r,padding:s}).fn(t):{}}}},Lme=(n,e)=>({...xme(n),options:[n,e]}),Dme=(n,e)=>({...wme(n),options:[n,e]}),Pme=(n,e)=>({..._me(n),options:[n,e]}),Mme=(n,e)=>({...Eme(n),options:[n,e]}),Ome=(n,e)=>({...Sme(n),options:[n,e]}),Nme=(n,e)=>({...Tme(n),options:[n,e]}),jme=(n,e)=>({...Ime(n),options:[n,e]});var Fme="Arrow",U7=E.forwardRef((n,e)=>{const{children:t,width:r=10,height:s=5,...i}=n;return d.jsx(_t.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});U7.displayName=Fme;var Ume=U7;function pS(n){const[e,t]=E.useState(void 0);return vr(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=n.offsetWidth,o=n.offsetHeight;t({width:a,height:o})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var kD="Popper",[$7,du]=Ns(kD),[$me,B7]=$7(kD),H7=n=>{const{__scopePopper:e,children:t}=n,[r,s]=E.useState(null);return d.jsx($me,{scope:e,anchor:r,onAnchorChange:s,children:t})};H7.displayName=kD;var V7="PopperAnchor",z7=E.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...s}=n,i=B7(V7,t),a=E.useRef(null),o=$t(e,a);return E.useEffect(()=>{i.onAnchorChange(r?.current||a.current)}),r?null:d.jsx(_t.div,{...s,ref:o})});z7.displayName=V7;var ID="PopperContent",[Bme,Hme]=$7(ID),G7=E.forwardRef((n,e)=>{const{__scopePopper:t,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:m=!1,updatePositionStrategy:g="optimized",onPlaced:y,...b}=n,x=B7(ID,t),[S,T]=E.useState(null),_=$t(e,ee=>T(ee)),[R,I]=E.useState(null),C=pS(R),L=C?.width??0,k=C?.height??0,M=r+(i!=="center"?"-"+i:""),D=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},U=Array.isArray(c)?c:[c],$=U.length>0,V={padding:D,boundary:U.filter(zme),altBoundary:$},{refs:B,floatingStyles:W,placement:F,isPositioned:j,middlewareData:q}=kme({strategy:"fixed",placement:M,whileElementsMounted:(...ee)=>bme(...ee,{animationFrame:g==="always"}),elements:{reference:x.anchor},middleware:[Lme({mainAxis:s+k,alignmentAxis:a}),l&&Dme({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Pme():void 0,...V}),l&&Mme({...V}),Ome({...V,apply:({elements:ee,rects:oe,availableWidth:te,availableHeight:se})=>{const{width:he,height:Z}=oe.reference,pe=ee.floating.style;pe.setProperty("--radix-popper-available-width",`${te}px`),pe.setProperty("--radix-popper-available-height",`${se}px`),pe.setProperty("--radix-popper-anchor-width",`${he}px`),pe.setProperty("--radix-popper-anchor-height",`${Z}px`)}}),R&&jme({element:R,padding:o}),Gme({arrowWidth:L,arrowHeight:k}),m&&Nme({strategy:"referenceHidden",...V})]}),[H,N]=K7(F),O=xa(y);vr(()=>{j&&O?.()},[j,O]);const z=q.arrow?.x,G=q.arrow?.y,Y=q.arrow?.centerOffset!==0,[Q,J]=E.useState();return vr(()=>{S&&J(window.getComputedStyle(S).zIndex)},[S]),d.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:j?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[q.transformOrigin?.x,q.transformOrigin?.y].join(" "),...q.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:d.jsx(Bme,{scope:t,placedSide:H,onArrowChange:I,arrowX:z,arrowY:G,shouldHideArrow:Y,children:d.jsx(_t.div,{"data-side":H,"data-align":N,...b,ref:_,style:{...b.style,animation:j?void 0:"none"}})})})});G7.displayName=ID;var q7="PopperArrow",Vme={top:"bottom",right:"left",bottom:"top",left:"right"},W7=E.forwardRef(function(e,t){const{__scopePopper:r,...s}=e,i=Hme(q7,r),a=Vme[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(Ume,{...s,ref:t,style:{...s.style,display:"block"}})})});W7.displayName=q7;function zme(n){return n!==null}var Gme=n=>({name:"transformOrigin",options:n,fn(e){const{placement:t,rects:r,middlewareData:s}=e,a=s.arrow?.centerOffset!==0,o=a?0:n.arrowWidth,l=a?0:n.arrowHeight,[c,u]=K7(t),f={start:"0%",center:"50%",end:"100%"}[u],m=(s.arrow?.x??0)+o/2,g=(s.arrow?.y??0)+l/2;let y="",b="";return c==="bottom"?(y=a?f:`${m}px`,b=`${-l}px`):c==="top"?(y=a?f:`${m}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?f:`${g}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?f:`${g}px`),{data:{x:y,y:b}}}});function K7(n){const[e,t="center"]=n.split("-");return[e,t]}var Xv=H7,Qv=z7,gS=G7,vS=W7,Y7=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qme="VisuallyHidden",X7=E.forwardRef((n,e)=>d.jsx(_t.span,{...n,ref:e,style:{...Y7,...n.style}}));X7.displayName=qme;var Wme=X7,[yS,gje]=Ns("Tooltip",[du]),bS=du(),Q7="TooltipProvider",Kme=700,YC="tooltip.open",[Yme,LD]=yS(Q7),DD=n=>{const{__scopeTooltip:e,delayDuration:t=Kme,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=n,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),d.jsx(Yme,{scope:e,isOpenDelayedRef:a,delayDuration:t,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};DD.displayName=Q7;var ov="Tooltip",[Xme,Zv]=yS(ov),Z7=n=>{const{__scopeTooltip:e,children:t,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=n,l=LD(ov,n.__scopeTooltip),c=bS(e),[u,f]=E.useState(null),m=zs(),g=E.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,x=E.useRef(!1),[S,T]=vi({prop:r,defaultProp:s??!1,onChange:L=>{L?(l.onOpen(),document.dispatchEvent(new CustomEvent(YC))):l.onClose(),i?.(L)},caller:ov}),_=E.useMemo(()=>S?x.current?"delayed-open":"instant-open":"closed",[S]),R=E.useCallback(()=>{window.clearTimeout(g.current),g.current=0,x.current=!1,T(!0)},[T]),I=E.useCallback(()=>{window.clearTimeout(g.current),g.current=0,T(!1)},[T]),C=E.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{x.current=!0,T(!0),g.current=0},b)},[b,T]);return E.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),d.jsx(Xv,{...c,children:d.jsx(Xme,{scope:e,contentId:m,open:S,stateAttribute:_,trigger:u,onTriggerChange:f,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?C():R()},[l.isOpenDelayedRef,C,R]),onTriggerLeave:E.useCallback(()=>{y?I():(window.clearTimeout(g.current),g.current=0)},[I,y]),onOpen:R,onClose:I,disableHoverableContent:y,children:t})})};Z7.displayName=ov;var XC="TooltipTrigger",J7=E.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=Zv(XC,t),i=LD(XC,t),a=bS(t),o=E.useRef(null),l=$t(e,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),f=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),d.jsx(Qv,{asChild:!0,...a,children:d.jsx(_t.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:rt(n.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:rt(n.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:rt(n.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:rt(n.onFocus,()=>{c.current||s.onOpen()}),onBlur:rt(n.onBlur,s.onClose),onClick:rt(n.onClick,s.onClose)})})});J7.displayName=XC;var PD="TooltipPortal",[Qme,Zme]=yS(PD,{forceMount:void 0}),eG=n=>{const{__scopeTooltip:e,forceMount:t,children:r,container:s}=n,i=Zv(PD,e);return d.jsx(Qme,{scope:e,forceMount:t,children:d.jsx($i,{present:t||i.open,children:d.jsx(lm,{asChild:!0,container:s,children:r})})})};eG.displayName=PD;var Gf="TooltipContent",tG=E.forwardRef((n,e)=>{const t=Zme(Gf,n.__scopeTooltip),{forceMount:r=t.forceMount,side:s="top",...i}=n,a=Zv(Gf,n.__scopeTooltip);return d.jsx($i,{present:r||a.open,children:a.disableHoverableContent?d.jsx(nG,{side:s,...i,ref:e}):d.jsx(Jme,{side:s,...i,ref:e})})}),Jme=E.forwardRef((n,e)=>{const t=Zv(Gf,n.__scopeTooltip),r=LD(Gf,n.__scopeTooltip),s=E.useRef(null),i=$t(e,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=t,u=s.current,{onPointerInTransitChange:f}=r,m=E.useCallback(()=>{o(null),f(!1)},[f]),g=E.useCallback((y,b)=>{const x=y.currentTarget,S={x:y.clientX,y:y.clientY},T=spe(S,x.getBoundingClientRect()),_=ipe(S,T),R=ape(b.getBoundingClientRect()),I=lpe([..._,...R]);o(I),f(!0)},[f]);return E.useEffect(()=>()=>m(),[m]),E.useEffect(()=>{if(l&&u){const y=x=>g(x,u),b=x=>g(x,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,g,m]),E.useEffect(()=>{if(a){const y=b=>{const x=b.target,S={x:b.clientX,y:b.clientY},T=l?.contains(x)||u?.contains(x),_=!ope(S,a);T?m():_&&(m(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,m]),d.jsx(nG,{...n,ref:i})}),[epe,tpe]=yS(ov,{isInside:!1}),npe=lz("TooltipContent"),nG=E.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=n,l=Zv(Gf,t),c=bS(t),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(YC,u),()=>document.removeEventListener(YC,u)),[u]),E.useEffect(()=>{if(l.trigger){const f=m=>{m.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),d.jsx(om,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:d.jsxs(gS,{"data-state":l.stateAttribute,...c,...o,ref:e,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[d.jsx(npe,{children:r}),d.jsx(epe,{scope:t,isInside:!0,children:d.jsx(Wme,{id:l.contentId,role:"tooltip",children:s||r})})]})})});tG.displayName=Gf;var rG="TooltipArrow",rpe=E.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=bS(t);return tpe(rG,t).isInside?null:d.jsx(vS,{...s,...r,ref:e})});rpe.displayName=rG;function spe(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),s=Math.abs(e.right-n.x),i=Math.abs(e.left-n.x);switch(Math.min(t,r,s,i)){case i:return"left";case s:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function ipe(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function ape(n){const{top:e,right:t,bottom:r,left:s}=n;return[{x:s,y:e},{x:t,y:e},{x:t,y:r},{x:s,y:r}]}function ope(n,e){const{x:t,y:r}=n;let s=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const o=e[i],l=e[a],c=o.x,u=o.y,f=l.x,m=l.y;u>r!=m>r&&t<(f-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function lpe(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),cpe(e)}function cpe(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const s=n[r];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const s=n[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var upe=DD,dpe=Z7,hpe=J7,fpe=eG,sG=tG;const yi=upe,Tr=dpe,_r=hpe,$n=E.forwardRef(({className:n,sideOffset:e=4,...t},r)=>d.jsx(fpe,{children:d.jsx(sG,{ref:r,sideOffset:e,className:je("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t})}));$n.displayName=sG.displayName;var fA="rovingFocusGroup.onEntryFocus",mpe={bubbles:!1,cancelable:!0},Jv="RovingFocusGroup",[QC,iG,ppe]=Gv(Jv),[gpe,aG]=Ns(Jv,[ppe]),[vpe,ype]=gpe(Jv),oG=E.forwardRef((n,e)=>d.jsx(QC.Provider,{scope:n.__scopeRovingFocusGroup,children:d.jsx(QC.Slot,{scope:n.__scopeRovingFocusGroup,children:d.jsx(bpe,{...n,ref:e})})}));oG.displayName=Jv;var bpe=E.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...f}=n,m=E.useRef(null),g=$t(e,m),y=qv(i),[b,x]=vi({prop:a,defaultProp:o??null,onChange:l,caller:Jv}),[S,T]=E.useState(!1),_=xa(c),R=iG(t),I=E.useRef(!1),[C,L]=E.useState(0);return E.useEffect(()=>{const k=m.current;if(k)return k.addEventListener(fA,_),()=>k.removeEventListener(fA,_)},[_]),d.jsx(vpe,{scope:t,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:E.useCallback(k=>x(k),[x]),onItemShiftTab:E.useCallback(()=>T(!0),[]),onFocusableItemAdd:E.useCallback(()=>L(k=>k+1),[]),onFocusableItemRemove:E.useCallback(()=>L(k=>k-1),[]),children:d.jsx(_t.div,{tabIndex:S||C===0?-1:0,"data-orientation":r,...f,ref:g,style:{outline:"none",...n.style},onMouseDown:rt(n.onMouseDown,()=>{I.current=!0}),onFocus:rt(n.onFocus,k=>{const M=!I.current;if(k.target===k.currentTarget&&M&&!S){const D=new CustomEvent(fA,mpe);if(k.currentTarget.dispatchEvent(D),!D.defaultPrevented){const U=R().filter(F=>F.focusable),$=U.find(F=>F.active),V=U.find(F=>F.id===b),W=[$,V,...U].filter(Boolean).map(F=>F.ref.current);uG(W,u)}}I.current=!1}),onBlur:rt(n.onBlur,()=>T(!1))})})}),lG="RovingFocusGroupItem",cG=E.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=n,l=zs(),c=i||l,u=ype(lG,t),f=u.currentTabStopId===c,m=iG(t),{onFocusableItemAdd:g,onFocusableItemRemove:y,currentTabStopId:b}=u;return E.useEffect(()=>{if(r)return g(),()=>y()},[r,g,y]),d.jsx(QC.ItemSlot,{scope:t,id:c,focusable:r,active:s,children:d.jsx(_t.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:rt(n.onMouseDown,x=>{r?u.onItemFocus(c):x.preventDefault()}),onFocus:rt(n.onFocus,()=>u.onItemFocus(c)),onKeyDown:rt(n.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const S=Epe(x,u.orientation,u.dir);if(S!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let _=m().filter(R=>R.focusable).map(R=>R.ref.current);if(S==="last")_.reverse();else if(S==="prev"||S==="next"){S==="prev"&&_.reverse();const R=_.indexOf(x.currentTarget);_=u.loop?Spe(_,R+1):_.slice(R+1)}setTimeout(()=>uG(_))}}),children:typeof a=="function"?a({isCurrentTabStop:f,hasTabStop:b!=null}):a})})});cG.displayName=lG;var xpe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wpe(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function Epe(n,e,t){const r=wpe(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return xpe[r]}function uG(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function Spe(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var Tpe=oG,_pe=cG,ZC=["Enter"," "],Ape=["ArrowDown","PageUp","Home"],dG=["ArrowUp","PageDown","End"],Rpe=[...Ape,...dG],Cpe={ltr:[...ZC,"ArrowRight"],rtl:[...ZC,"ArrowLeft"]},kpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},e0="Menu",[lv,Ipe,Lpe]=Gv(e0),[Ld,hG]=Ns(e0,[Lpe,du,aG]),t0=du(),fG=aG(),[mG,hu]=Ld(e0),[Dpe,n0]=Ld(e0),pG=n=>{const{__scopeMenu:e,open:t=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=n,o=t0(e),[l,c]=E.useState(null),u=E.useRef(!1),f=xa(i),m=qv(s);return E.useEffect(()=>{const g=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",g,{capture:!0}),()=>{document.removeEventListener("keydown",g,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),d.jsx(Xv,{...o,children:d.jsx(mG,{scope:e,open:t,onOpenChange:f,content:l,onContentChange:c,children:d.jsx(Dpe,{scope:e,onClose:E.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:m,modal:a,children:r})})})};pG.displayName=e0;var Ppe="MenuAnchor",MD=E.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,s=t0(t);return d.jsx(Qv,{...s,...r,ref:e})});MD.displayName=Ppe;var OD="MenuPortal",[Mpe,gG]=Ld(OD,{forceMount:void 0}),vG=n=>{const{__scopeMenu:e,forceMount:t,children:r,container:s}=n,i=hu(OD,e);return d.jsx(Mpe,{scope:e,forceMount:t,children:d.jsx($i,{present:t||i.open,children:d.jsx(lm,{asChild:!0,container:s,children:r})})})};vG.displayName=OD;var va="MenuContent",[Ope,ND]=Ld(va),yG=E.forwardRef((n,e)=>{const t=gG(va,n.__scopeMenu),{forceMount:r=t.forceMount,...s}=n,i=hu(va,n.__scopeMenu),a=n0(va,n.__scopeMenu);return d.jsx(lv.Provider,{scope:n.__scopeMenu,children:d.jsx($i,{present:r||i.open,children:d.jsx(lv.Slot,{scope:n.__scopeMenu,children:a.modal?d.jsx(Npe,{...s,ref:e}):d.jsx(jpe,{...s,ref:e})})})})}),Npe=E.forwardRef((n,e)=>{const t=hu(va,n.__scopeMenu),r=E.useRef(null),s=$t(e,r);return E.useEffect(()=>{const i=r.current;if(i)return cS(i)},[]),d.jsx(jD,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:rt(n.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),jpe=E.forwardRef((n,e)=>{const t=hu(va,n.__scopeMenu);return d.jsx(jD,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),Fpe=eu("MenuContent.ScrollLock"),jD=E.forwardRef((n,e)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:g,disableOutsideScroll:y,...b}=n,x=hu(va,t),S=n0(va,t),T=t0(t),_=fG(t),R=Ipe(t),[I,C]=E.useState(null),L=E.useRef(null),k=$t(e,L,x.onContentChange),M=E.useRef(0),D=E.useRef(""),U=E.useRef(0),$=E.useRef(null),V=E.useRef("right"),B=E.useRef(0),W=y?Kv:E.Fragment,F=y?{as:Fpe,allowPinchZoom:!0}:void 0,j=H=>{const N=D.current+H,O=R().filter(ee=>!ee.disabled),z=document.activeElement,G=O.find(ee=>ee.ref.current===z)?.textValue,Y=O.map(ee=>ee.textValue),Q=Xpe(Y,N,G),J=O.find(ee=>ee.textValue===Q)?.ref.current;(function ee(oe){D.current=oe,window.clearTimeout(M.current),oe!==""&&(M.current=window.setTimeout(()=>ee(""),1e3))})(N),J&&setTimeout(()=>J.focus())};E.useEffect(()=>()=>window.clearTimeout(M.current),[]),oS();const q=E.useCallback(H=>V.current===$.current?.side&&Zpe(H,$.current?.area),[]);return d.jsx(Ope,{scope:t,searchRef:D,onItemEnter:E.useCallback(H=>{q(H)&&H.preventDefault()},[q]),onItemLeave:E.useCallback(H=>{q(H)||(L.current?.focus(),C(null))},[q]),onTriggerLeave:E.useCallback(H=>{q(H)&&H.preventDefault()},[q]),pointerGraceTimerRef:U,onPointerGraceIntentChange:E.useCallback(H=>{$.current=H},[]),children:d.jsx(W,{...F,children:d.jsx(Wv,{asChild:!0,trapped:s,onMountAutoFocus:rt(i,H=>{H.preventDefault(),L.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:d.jsx(om,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:g,children:d.jsx(Tpe,{asChild:!0,..._,dir:S.dir,orientation:"vertical",loop:r,currentTabStopId:I,onCurrentTabStopIdChange:C,onEntryFocus:rt(l,H=>{S.isUsingKeyboardRef.current||H.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(gS,{role:"menu","aria-orientation":"vertical","data-state":OG(x.open),"data-radix-menu-content":"",dir:S.dir,...T,...b,ref:k,style:{outline:"none",...b.style},onKeyDown:rt(b.onKeyDown,H=>{const O=H.target.closest("[data-radix-menu-content]")===H.currentTarget,z=H.ctrlKey||H.altKey||H.metaKey,G=H.key.length===1;O&&(H.key==="Tab"&&H.preventDefault(),!z&&G&&j(H.key));const Y=L.current;if(H.target!==Y||!Rpe.includes(H.key))return;H.preventDefault();const J=R().filter(ee=>!ee.disabled).map(ee=>ee.ref.current);dG.includes(H.key)&&J.reverse(),Kpe(J)}),onBlur:rt(n.onBlur,H=>{H.currentTarget.contains(H.target)||(window.clearTimeout(M.current),D.current="")}),onPointerMove:rt(n.onPointerMove,cv(H=>{const N=H.target,O=B.current!==H.clientX;if(H.currentTarget.contains(N)&&O){const z=H.clientX>B.current?"right":"left";V.current=z,B.current=H.clientX}}))})})})})})})});yG.displayName=va;var Upe="MenuGroup",FD=E.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return d.jsx(_t.div,{role:"group",...r,ref:e})});FD.displayName=Upe;var $pe="MenuLabel",bG=E.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return d.jsx(_t.div,{...r,ref:e})});bG.displayName=$pe;var gw="MenuItem",i$="menu.itemSelect",xS=E.forwardRef((n,e)=>{const{disabled:t=!1,onSelect:r,...s}=n,i=E.useRef(null),a=n0(gw,n.__scopeMenu),o=ND(gw,n.__scopeMenu),l=$t(e,i),c=E.useRef(!1),u=()=>{const f=i.current;if(!t&&f){const m=new CustomEvent(i$,{bubbles:!0,cancelable:!0});f.addEventListener(i$,g=>r?.(g),{once:!0}),cz(f,m),m.defaultPrevented?c.current=!1:a.onClose()}};return d.jsx(xG,{...s,ref:l,disabled:t,onClick:rt(n.onClick,u),onPointerDown:f=>{n.onPointerDown?.(f),c.current=!0},onPointerUp:rt(n.onPointerUp,f=>{c.current||f.currentTarget?.click()}),onKeyDown:rt(n.onKeyDown,f=>{const m=o.searchRef.current!=="";t||m&&f.key===" "||ZC.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});xS.displayName=gw;var xG=E.forwardRef((n,e)=>{const{__scopeMenu:t,disabled:r=!1,textValue:s,...i}=n,a=ND(gw,t),o=fG(t),l=E.useRef(null),c=$t(e,l),[u,f]=E.useState(!1),[m,g]=E.useState("");return E.useEffect(()=>{const y=l.current;y&&g((y.textContent??"").trim())},[i.children]),d.jsx(lv.ItemSlot,{scope:t,disabled:r,textValue:s??m,children:d.jsx(_pe,{asChild:!0,...o,focusable:!r,children:d.jsx(_t.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:rt(n.onPointerMove,cv(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:rt(n.onPointerLeave,cv(y=>a.onItemLeave(y))),onFocus:rt(n.onFocus,()=>f(!0)),onBlur:rt(n.onBlur,()=>f(!1))})})})}),Bpe="MenuCheckboxItem",wG=E.forwardRef((n,e)=>{const{checked:t=!1,onCheckedChange:r,...s}=n;return d.jsx(AG,{scope:n.__scopeMenu,checked:t,children:d.jsx(xS,{role:"menuitemcheckbox","aria-checked":vw(t)?"mixed":t,...s,ref:e,"data-state":BD(t),onSelect:rt(s.onSelect,()=>r?.(vw(t)?!0:!t),{checkForDefaultPrevented:!1})})})});wG.displayName=Bpe;var EG="MenuRadioGroup",[Hpe,Vpe]=Ld(EG,{value:void 0,onValueChange:()=>{}}),SG=E.forwardRef((n,e)=>{const{value:t,onValueChange:r,...s}=n,i=xa(r);return d.jsx(Hpe,{scope:n.__scopeMenu,value:t,onValueChange:i,children:d.jsx(FD,{...s,ref:e})})});SG.displayName=EG;var TG="MenuRadioItem",_G=E.forwardRef((n,e)=>{const{value:t,...r}=n,s=Vpe(TG,n.__scopeMenu),i=t===s.value;return d.jsx(AG,{scope:n.__scopeMenu,checked:i,children:d.jsx(xS,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":BD(i),onSelect:rt(r.onSelect,()=>s.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});_G.displayName=TG;var UD="MenuItemIndicator",[AG,zpe]=Ld(UD,{checked:!1}),RG=E.forwardRef((n,e)=>{const{__scopeMenu:t,forceMount:r,...s}=n,i=zpe(UD,t);return d.jsx($i,{present:r||vw(i.checked)||i.checked===!0,children:d.jsx(_t.span,{...s,ref:e,"data-state":BD(i.checked)})})});RG.displayName=UD;var Gpe="MenuSeparator",CG=E.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return d.jsx(_t.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});CG.displayName=Gpe;var qpe="MenuArrow",kG=E.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,s=t0(t);return d.jsx(vS,{...s,...r,ref:e})});kG.displayName=qpe;var $D="MenuSub",[Wpe,IG]=Ld($D),LG=n=>{const{__scopeMenu:e,children:t,open:r=!1,onOpenChange:s}=n,i=hu($D,e),a=t0(e),[o,l]=E.useState(null),[c,u]=E.useState(null),f=xa(s);return E.useEffect(()=>(i.open===!1&&f(!1),()=>f(!1)),[i.open,f]),d.jsx(Xv,{...a,children:d.jsx(mG,{scope:e,open:r,onOpenChange:f,content:c,onContentChange:u,children:d.jsx(Wpe,{scope:e,contentId:zs(),triggerId:zs(),trigger:o,onTriggerChange:l,children:t})})})};LG.displayName=$D;var Wp="MenuSubTrigger",DG=E.forwardRef((n,e)=>{const t=hu(Wp,n.__scopeMenu),r=n0(Wp,n.__scopeMenu),s=IG(Wp,n.__scopeMenu),i=ND(Wp,n.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:n.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const f=o.current;return()=>{window.clearTimeout(f),l(null)}},[o,l]),d.jsx(MD,{asChild:!0,...c,children:d.jsx(xG,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":OG(t.open),...n,ref:rS(e,s.onTriggerChange),onClick:f=>{n.onClick?.(f),!(n.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:rt(n.onPointerMove,cv(f=>{i.onItemEnter(f),!f.defaultPrevented&&!n.disabled&&!t.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{t.onOpenChange(!0),u()},100))})),onPointerLeave:rt(n.onPointerLeave,cv(f=>{u();const m=t.content?.getBoundingClientRect();if(m){const g=t.content?.dataset.side,y=g==="right",b=y?-5:5,x=m[y?"left":"right"],S=m[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+b,y:f.clientY},{x,y:m.top},{x:S,y:m.top},{x:S,y:m.bottom},{x,y:m.bottom}],side:g}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:rt(n.onKeyDown,f=>{const m=i.searchRef.current!=="";n.disabled||m&&f.key===" "||Cpe[r.dir].includes(f.key)&&(t.onOpenChange(!0),t.content?.focus(),f.preventDefault())})})})});DG.displayName=Wp;var PG="MenuSubContent",MG=E.forwardRef((n,e)=>{const t=gG(va,n.__scopeMenu),{forceMount:r=t.forceMount,...s}=n,i=hu(va,n.__scopeMenu),a=n0(va,n.__scopeMenu),o=IG(PG,n.__scopeMenu),l=E.useRef(null),c=$t(e,l);return d.jsx(lv.Provider,{scope:n.__scopeMenu,children:d.jsx($i,{present:r||i.open,children:d.jsx(lv.Slot,{scope:n.__scopeMenu,children:d.jsx(jD,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{a.isUsingKeyboardRef.current&&l.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:rt(n.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:rt(n.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:rt(n.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),m=kpe[a.dir].includes(u.key);f&&m&&(i.onOpenChange(!1),o.trigger?.focus(),u.preventDefault())})})})})})});MG.displayName=PG;function OG(n){return n?"open":"closed"}function vw(n){return n==="indeterminate"}function BD(n){return vw(n)?"indeterminate":n?"checked":"unchecked"}function Kpe(n){const e=document.activeElement;for(const t of n)if(t===e||(t.focus(),document.activeElement!==e))return}function Ype(n,e){return n.map((t,r)=>n[(e+r)%n.length])}function Xpe(n,e,t){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=t?n.indexOf(t):-1;let a=Ype(n,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==t));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==t?l:void 0}function Qpe(n,e){const{x:t,y:r}=n;let s=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const o=e[i],l=e[a],c=o.x,u=o.y,f=l.x,m=l.y;u>r!=m>r&&t<(f-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function Zpe(n,e){if(!e)return!1;const t={x:n.clientX,y:n.clientY};return Qpe(t,e)}function cv(n){return e=>e.pointerType==="mouse"?n(e):void 0}var Jpe=pG,ege=MD,tge=vG,nge=yG,rge=FD,sge=bG,ige=xS,age=wG,oge=SG,lge=_G,cge=RG,uge=CG,dge=kG,hge=LG,fge=DG,mge=MG,wS="DropdownMenu",[pge,vje]=Ns(wS,[hG]),js=hG(),[gge,NG]=pge(wS),jG=n=>{const{__scopeDropdownMenu:e,children:t,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=n,l=js(e),c=E.useRef(null),[u,f]=vi({prop:s,defaultProp:i??!1,onChange:a,caller:wS});return d.jsx(gge,{scope:e,triggerId:zs(),triggerRef:c,contentId:zs(),open:u,onOpenChange:f,onOpenToggle:E.useCallback(()=>f(m=>!m),[f]),modal:o,children:d.jsx(Jpe,{...l,open:u,onOpenChange:f,dir:r,modal:o,children:t})})};jG.displayName=wS;var FG="DropdownMenuTrigger",UG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...s}=n,i=NG(FG,t),a=js(t);return d.jsx(ege,{asChild:!0,...a,children:d.jsx(_t.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:rS(e,i.triggerRef),onPointerDown:rt(n.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:rt(n.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});UG.displayName=FG;var vge="DropdownMenuPortal",$G=n=>{const{__scopeDropdownMenu:e,...t}=n,r=js(e);return d.jsx(tge,{...r,...t})};$G.displayName=vge;var BG="DropdownMenuContent",HG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=NG(BG,t),i=js(t),a=E.useRef(!1);return d.jsx(nge,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:rt(n.onCloseAutoFocus,o=>{a.current||s.triggerRef.current?.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:rt(n.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});HG.displayName=BG;var yge="DropdownMenuGroup",bge=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(rge,{...s,...r,ref:e})});bge.displayName=yge;var xge="DropdownMenuLabel",VG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(sge,{...s,...r,ref:e})});VG.displayName=xge;var wge="DropdownMenuItem",zG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(ige,{...s,...r,ref:e})});zG.displayName=wge;var Ege="DropdownMenuCheckboxItem",GG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(age,{...s,...r,ref:e})});GG.displayName=Ege;var Sge="DropdownMenuRadioGroup",Tge=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(oge,{...s,...r,ref:e})});Tge.displayName=Sge;var _ge="DropdownMenuRadioItem",qG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(lge,{...s,...r,ref:e})});qG.displayName=_ge;var Age="DropdownMenuItemIndicator",WG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(cge,{...s,...r,ref:e})});WG.displayName=Age;var Rge="DropdownMenuSeparator",KG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(uge,{...s,...r,ref:e})});KG.displayName=Rge;var Cge="DropdownMenuArrow",kge=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(dge,{...s,...r,ref:e})});kge.displayName=Cge;var Ige=n=>{const{__scopeDropdownMenu:e,children:t,open:r,onOpenChange:s,defaultOpen:i}=n,a=js(e),[o,l]=vi({prop:r,defaultProp:i??!1,onChange:s,caller:"DropdownMenuSub"});return d.jsx(hge,{...a,open:o,onOpenChange:l,children:t})},Lge="DropdownMenuSubTrigger",YG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(fge,{...s,...r,ref:e})});YG.displayName=Lge;var Dge="DropdownMenuSubContent",XG=E.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=js(t);return d.jsx(mge,{...s,...r,ref:e,style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});XG.displayName=Dge;var Pge=jG,Mge=UG,Oge=$G,QG=HG,ZG=VG,JG=zG,e9=GG,t9=qG,Nge=WG,n9=KG,jge=Ige,r9=YG,s9=XG;const Gs=Pge,qs=Mge,HD=jge,ES=E.forwardRef(({className:n,inset:e,children:t,...r},s)=>d.jsxs(r9,{ref:s,className:je("flex cursor-default select-none items-center px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",n),...r,children:[t,d.jsx(Gce,{className:"ml-auto h-4 w-4"})]}));ES.displayName=r9.displayName;const SS=E.forwardRef(({className:n,...e},t)=>d.jsx(s9,{ref:t,className:je("z-50 min-w-[8rem] overflow-hidden rounded border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...e}));SS.displayName=s9.displayName;const Ms=E.forwardRef(({className:n,sideOffset:e=4,...t},r)=>d.jsx(Oge,{children:d.jsx(QG,{ref:r,sideOffset:e,className:je("z-50 min-w-[8rem] overflow-hidden rounded-xl border border-border bg-inbetween-background p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t})}));Ms.displayName=QG.displayName;const Pn=E.forwardRef(({className:n,inset:e,...t},r)=>d.jsx(JG,{ref:r,className:je("relative flex cursor-default select-none items-center rounded px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",n),...t}));Pn.displayName=JG.displayName;const Fge=E.forwardRef(({className:n,children:e,checked:t,...r},s)=>d.jsxs(e9,{ref:s,className:je("relative flex cursor-default select-none items-center rounded-xl py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),checked:t,...r,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(Nge,{children:d.jsx(is,{className:"h-4 w-4"})})}),e]}));Fge.displayName=e9.displayName;const Uge=E.forwardRef(({className:n,children:e,...t},r)=>d.jsx(t9,{ref:r,className:je("relative flex cursor-default select-none items-center rounded-xl py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...t,children:e}));Uge.displayName=t9.displayName;const $ge=E.forwardRef(({className:n,inset:e,...t},r)=>d.jsx(ZG,{ref:r,className:je("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",n),...t}));$ge.displayName=ZG.displayName;const uv=E.forwardRef(({className:n,...e},t)=>d.jsx(n9,{ref:t,className:je("-mx-1 my-1 h-px bg-muted",n),...e}));uv.displayName=n9.displayName;const Bge=()=>{const n=Jn(),{user:e}=Ar(),t=Ft(le=>le.currentTeam),r=Ft(le=>le.isLoadingTeams),s=Ft(le=>le.createNewFlask),i=t?.team_type==="free_team",a=r,o=E.useRef(null),l=E.useRef(null),[c,u]=E.useState(""),[f,m]=E.useState([]),[g,y]=E.useState(!1),[b,x]=E.useState(0),[S,T]=E.useState(0),[_,R]=E.useState(!1),[I,C]=E.useState(!1),[L,k]=E.useState([]),[M,D]=E.useState(new Set),[U,$]=E.useState(!1),[V,B]=E.useState(new Map),[W,F]=E.useState(null),j=10,q=20*1024*1024*1024,[H,N]=E.useState(!1),[O,z]=E.useState(!1),[G,Y]=E.useState(!1),[Q,J]=E.useState(!1),[ee,oe]=E.useState(!1),[te,se]=E.useState(!1),he=le=>{const ie=Array.from(le.target.files||[]);if(ie.length===0)return;if(ie.length>j){Mr({title:"Too many files",description:`Maximum ${j} files allowed`,variant:"destructive"}),o.current&&(o.current.value="");return}if(ie.filter(ne=>!ne.type.startsWith("video/")).length>0){Mr({title:"Invalid files",description:"Please select only video files",variant:"destructive"}),o.current&&(o.current.value="");return}if(ie.reduce((ne,ce)=>ne+ce.size,0)>q){Mr({title:"Files too large",description:"Total size cannot exceed 20GB",variant:"destructive"}),o.current&&(o.current.value="");return}m(ie),u("")},Z=async()=>{if(f.length===0||!e)return;R(!0),x(0),T(0);const le=[],ie=new Map;try{for(let fe=0;fe<f.length;fe++){const Ie=f[fe];T(fe),x(0);const ne=await Ht("/api/mux/upload/create",{method:"POST",body:JSON.stringify({title:Ie.name})});if(!ne.ok)throw new Error(`Failed to create upload for ${Ie.name}`);const{uploadUrl:ce,assetId:Ce}=await ne.json();le.push(Ce),await new Promise((Oe,ze)=>{const We=new XMLHttpRequest;F(We),We.upload.addEventListener("progress",tt=>{tt.lengthComputable&&x(tt.loaded/tt.total*100)}),We.addEventListener("load",()=>{We.status===200||We.status===201?Oe():ze(new Error(`Upload failed with status ${We.status}`)),F(null)}),We.addEventListener("error",()=>{ze(new Error("Upload failed")),F(null)}),We.addEventListener("abort",()=>{ze(new Error("Upload cancelled")),F(null)}),We.open("PUT",ce),We.setRequestHeader("Content-Type",Ie.type),We.send(Ie)})}k(le),R(!1),C(!0),D(new Set);for(const fe of le){const Ie=setInterval(async()=>{try{const ne=await Ht(`/api/assets/${fe}`);if(ne.ok){const ce=await ne.json();ce.asset&&ce.asset.status==="ready"&&(clearInterval(Ie),ie.delete(fe),D(Ce=>new Set([...Ce,fe])),D(Ce=>{const Oe=new Set([...Ce,fe]);return Oe.size===le.length&&(C(!1),$(!0),pe(le)),Oe}))}}catch(ne){console.error(`Error checking asset ${fe} status:`,ne)}},2e3);ie.set(fe,Ie)}B(ie)}catch(fe){console.error("Upload error:",fe),ie.forEach(Ie=>clearInterval(Ie)),Mr({title:"Upload Failed",description:fe instanceof Error?fe.message:"Failed to upload videos. Please try again.",variant:"destructive"}),R(!1),C(!1),x(0),k([]),D(new Set)}},pe=async le=>{if(e?.id)try{let ie;f.length===1?ie=f[0].name:ie=`New Flask (${f.length} assets)`;const fe=await s({userId:e.id,name:ie,assetIds:le});if(!fe)throw new Error("Failed to create flask");Y(!0),setTimeout(()=>{n(`/flask/${fe.id}`)},1500)}catch(ie){console.error("Error creating flask:",ie),Mr({title:"Error",description:"Failed to create flask. Please try again.",variant:"destructive"})}finally{$(!1)}},ye=async()=>{window.confirm("Are you sure you want to cancel the upload?")&&(W&&W.abort(),V.forEach(ie=>clearInterval(ie)),B(new Map),R(!1),C(!1),x(0),k([]),D(new Set),m([]),F(null),T(0),o.current&&(o.current.value=""))};ve.useEffect(()=>()=>{V.forEach(le=>clearInterval(le)),Y(!1)},[V]);const ae=async()=>{if(!e){N(!0);return}if(f.length>0){if(i&&!a){y(!0);return}if(L.length===0){await Z();return}if(I||L.length>0&&M.size<L.length)return}else if(!c.trim())return;$(!0);try{if(c.trim()&&f.length===0){const le=await hhe(c);if(!le.valid){Mr({title:"Invalid YouTube URL",description:"error"in le?le.error:"Please enter a valid YouTube URL",variant:"destructive"}),oe(!0),setTimeout(()=>oe(!1),3e3),$(!1);return}const ie=await s({userId:e.id,youtubeUrl:c,name:le.title||"YouTube Video",thumbnail:le.thumbnail});if(!ie)throw new Error("Failed to create flask");Y(!0),setTimeout(()=>{n(`/flask/${ie.id}`)},1500)}else if(L.length>0&&M.size===L.length){await pe(L);return}else throw new Error("No valid input for flask creation")}catch(le){console.error("Error creating flask:",le),Mr({title:"Error",description:"Failed to create flask. Please try again.",variant:"destructive"})}finally{$(!1)}};return d.jsxs("div",{className:"w-full md:w-auto flex flex-col items-center gap-4 px-4 md:px-0",children:[d.jsx("div",{className:"flex flex-col items-center w-full md:w-auto",children:d.jsx("div",{className:"relative flex items-center justify-center w-full md:w-auto",children:d.jsx("div",{className:"relative w-full md:w-auto",children:d.jsxs("div",{className:"h-[48px] md:h-[64px] rounded-full md:max-w-[600px] bg-element-background/50 bg-gradient-to-t from-element-background via-element-background to-text-primary/5  border-t border-text-primary/30 shadow-2xl flex items-center p-1.5 w-full",children:[d.jsxs(Gs,{onOpenChange:se,children:[d.jsx(qs,{asChild:!0,children:d.jsx("div",{className:"cursor-pointer",children:d.jsx(Jg,{className:"mr-2 md:mr-4 z-10 ml-3 md:ml-6 scale-75 md:scale-100",isOpen:te})})}),d.jsxs(Ms,{align:"start",className:"bg-card-background border-border w-64",children:[d.jsx(Pn,{onClick:()=>{navigator.clipboard.writeText("This is the best video collaboration tool I've ever used: https://www.flask.do"),J(!0),setTimeout(()=>J(!1),2e3),se(!1),Mr({title:"Link copied!",description:"Share Flask with your friends"})},className:"text-text-primary hover:bg-card-background/50 cursor-pointer py-3",children:d.jsxs("div",{className:"flex items-center w-full gap-4",children:[d.jsx("div",{className:"w-5 flex items-center justify-center flex-shrink-0",children:d.jsx(tz,{className:"h-4 w-4"})}),d.jsx("span",{children:Q?"Link copied!":"Share Flask with friends"})]})}),d.jsx(Pn,{onClick:()=>n("/"),className:"text-text-primary hover:bg-card-background/50 cursor-pointer py-3",children:d.jsxs("div",{className:"flex items-center w-full gap-4",children:[d.jsx("div",{className:"w-5 flex items-center justify-center flex-shrink-0",children:d.jsx(zce,{className:"h-4 w-4"})}),d.jsx("span",{children:"Go to Landing Page"})]})})]})]}),d.jsx("div",{className:"relative flex-1 ml-2 md:ml-5",children:d.jsxs("div",{className:je("flex items-center rounded-full h-full bg-card-background border-b border-border/70 gap-2 px-1.5 py-1.5 md:min-w-[300px]"),children:[f.length>0?d.jsx("div",{className:"flex items-center gap-2 px-3 py-2.5 flex-1 max-w-full h-full",children:_?d.jsxs(d.Fragment,{children:[d.jsxs("span",{className:"text-sm text-text-primary truncate flex-1 animate-pulse opacity-80",children:["Uploading ",Math.round(b),"%",f.length>1&&` (${S+1} of ${f.length})`]}),d.jsx("button",{onClick:le=>{le.stopPropagation(),ye()},className:"ml-2 text-text-secondary hover:text-text-primary transition-colors flex-shrink-0 rounded-full p-1 hover:bg-element-background/50",children:d.jsx($o,{className:"w-3 h-3"})})]}):I?d.jsxs(d.Fragment,{children:[d.jsxs("span",{className:"text-sm text-text-primary truncate flex-1 animate-pulse opacity-80",children:["Processing (",M.size," of"," ",L.length,")"]}),d.jsx("button",{onClick:le=>{le.stopPropagation(),ye()},className:"ml-2 text-text-secondary hover:text-text-primary transition-colors flex-shrink-0 rounded-full p-1 hover:bg-element-background/50",children:d.jsx($o,{className:"w-3 h-3"})})]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-sm text-text-primary truncate flex-1",children:f.length===1?f[0].name:`${f.length} files`}),d.jsx("button",{onClick:le=>{le.stopPropagation(),m([]),k([]),D(new Set),o.current&&(o.current.value="")},className:"ml-2 text-text-secondary hover:text-text-primary transition-colors flex-shrink-0",children:d.jsx($o,{className:"w-3 h-3"})})]})}):d.jsxs(d.Fragment,{children:[d.jsx(yi,{delayDuration:100,children:d.jsxs(Tr,{open:O||ee,onOpenChange:z,children:[d.jsx(_r,{asChild:!0,children:d.jsxs("div",{className:"relative flex-1",children:[d.jsx("input",{type:"text",value:c,onChange:le=>u(le.target.value),onKeyDown:le=>{le.key==="Enter"&&(le.preventDefault(),ae())},className:"bg-transparent border-none outline-none text-text-secondary text-sm pl-4 mb-1 pr-3 w-full min-w-0",placeholder:""}),!c&&d.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-sm text-text-secondary pointer-events-none flex items-center gap-2",children:[d.jsx("span",{className:"md:hidden",children:"Video link"}),d.jsx("span",{className:"hidden md:inline",children:"Paste Video link"}),d.jsx("div",{className:"hidden md:flex items-center gap-1 opacity-50",children:d.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:d.jsx("path",{d:"M21.582,6.186c-0.23-0.86-0.908-1.538-1.768-1.768C18.254,4,12,4,12,4S5.746,4,4.186,4.418 c-0.86,0.23-1.538,0.908-1.768,1.768C2,7.746,2,12,2,12s0,4.254,0.418,5.814c0.23,0.86,0.908,1.538,1.768,1.768 C5.746,20,12,20,12,20s6.254,0,7.814-0.418c0.861-0.23,1.538-0.908,1.768-1.768C22,16.254,22,12,22,12S22,7.746,21.582,6.186z M10,15.464V8.536L16,12L10,15.464z"})})}),d.jsx("span",{className:"hidden md:inline",children:"or"})]})]})}),d.jsx($n,{side:"bottom",className:"mt-5 rounded-3xl",children:ee?d.jsxs("div",{className:"p-3",children:[d.jsx("p",{className:"text-text-primary",children:"Link not recognized."}),d.jsx("p",{className:"text-text-secondary",children:"YouTube unlisted and public videos are supported"})]}):d.jsxs("div",{className:"space-y-2 min-w-72 p-3 ",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-text-primary font-bold",children:"YouTube"}),d.jsx("span",{className:"text-text-primary text-right ml-4",children:"Public or Unlisted videos and Shorts"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-text-secondary font-bold",children:"Google Drive"}),d.jsx("span",{className:"text-text-secondary text-right ml-4",children:"Coming soon"})]})]})})]})}),!c.trim()&&d.jsxs("button",{onClick:()=>{if(!e){N(!0);return}if(i&&!a){y(!0);return}o.current?.click()},className:je("button-secondary flex items-center gap-1 md:gap-2 px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm flex-shrink-0"),children:[d.jsx(fue,{className:"w-3 md:w-4 h-3 md:h-4 text-text-primary"}),d.jsx("span",{className:"hidden sm:inline",children:"Upload"})]})]}),d.jsx("input",{ref:o,type:"file",accept:"video/*",multiple:!0,className:"hidden",onChange:he})]})}),d.jsx(yi,{delayDuration:0,children:d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsx("div",{className:"ml-1.5",children:d.jsx("button",{ref:l,onClick:ae,disabled:U||_||I||G||f.length===0&&c.trim()==="",className:je("button-primary flex min-w-8 md:min-w-12 items-center justify-center py-1 transition-all duration-300 font-semibold cursor-pointer rounded-full disabled:opacity-40 disabled:cursor-default h-8 md:h-12 ml-1 md:ml-2 text-xs md:text-sm",U||_||I||G?"px-2 md:px-3":"px-3 md:px-4",U||_||I||G||f.length===0&&c.trim()===""?"opacity-40":""),children:U||_||I||G?d.jsx("div",{className:"animate-spin h-4 w-4",children:d.jsxs("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):d.jsxs(d.Fragment,{children:[d.jsx(nS,{className:"w-4 h-4 md:hidden"}),d.jsx("span",{className:"text-sm font-medium hidden md:inline",children:"Create Flask"})]})})})}),d.jsx($n,{side:"bottom",className:"mt-2",children:d.jsx("p",{children:"Add a video (Link or Upload) to create a Flask"})})]})})]})})})}),d.jsx(Afe,{open:H,onOpenChange:N}),d.jsx(Rfe,{open:g,onOpenChange:y,title:"Use YouTube to Add a Video"})]})},a$=()=>{const{user:n}=Ar(),e=Os(),t=Ft(s=>s.currentTeam),r=e.pathname==="/dash";return d.jsx("div",{className:"relative w-full bg-transparent text-white/80 transition-colors overflow-visible duration-200",children:d.jsx("div",{className:"w-full",children:d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n&&r&&d.jsx(Bge,{}),!r&&d.jsx("div",{className:"flex-1"}),n&&r&&t&&t.team_type==="free_team"&&d.jsx("a",{href:"/#pricing",className:"h-[48px] hidden md:block",children:d.jsxs("div",{className:"button-primary h-full flex items-center gap-2 px-4 mr-5 cursor-pointer",children:[d.jsx("span",{className:"text-sm !font-semibold",children:"Upgrade to Flask Pro"}),d.jsx(nS,{className:"w-4 h-4"})]})})]})})})};var i9="en",VD={},JC={};function a9(){return i9}function Hge(n){i9=n}function Vge(n){return VD[n]}function zge(n){if(!n)throw new Error("No locale data passed");VD[n.locale]=n,JC[n.locale.toLowerCase()]=n.locale}function o$(n){if(VD[n])return n;if(JC[n.toLowerCase()])return JC[n.toLowerCase()]}function o9(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.localeMatcher||"lookup";switch(t){case"lookup":return l$(n);case"best fit":return l$(n);default:throw new RangeError('Invalid "localeMatcher" option: '.concat(t))}}function l$(n){var e=o$(n);if(e)return e;for(var t=n.split("-");n.length>1;){t.pop(),n=t.join("-");var r=o$(n);if(r)return r}}var xe={af:function(e){return e==1?"one":"other"},am:function(e){return e>=0&&e<=1?"one":"other"},ar:function(e){var t=String(e).split("."),r=Number(t[0])==e,s=r&&t[0].slice(-2);return e==0?"zero":e==1?"one":e==2?"two":s>=3&&s<=10?"few":s>=11&&s<=99?"many":"other"},ast:function(e){var t=String(e).split("."),r=!t[1];return e==1&&r?"one":"other"},be:function(e){var t=String(e).split("."),r=Number(t[0])==e,s=r&&t[0].slice(-1),i=r&&t[0].slice(-2);return s==1&&i!=11?"one":s>=2&&s<=4&&(i<12||i>14)?"few":r&&s==0||s>=5&&s<=9||i>=11&&i<=14?"many":"other"},br:function(e){var t=String(e).split("."),r=Number(t[0])==e,s=r&&t[0].slice(-1),i=r&&t[0].slice(-2),a=r&&t[0].slice(-6);return s==1&&i!=11&&i!=71&&i!=91?"one":s==2&&i!=12&&i!=72&&i!=92?"two":(s==3||s==4||s==9)&&(i<10||i>19)&&(i<70||i>79)&&(i<90||i>99)?"few":e!=0&&r&&a==0?"many":"other"},bs:function(e){var t=String(e).split("."),r=t[0],s=t[1]||"",i=!t[1],a=r.slice(-1),o=r.slice(-2),l=s.slice(-1),c=s.slice(-2);return i&&a==1&&o!=11||l==1&&c!=11?"one":i&&a>=2&&a<=4&&(o<12||o>14)||l>=2&&l<=4&&(c<12||c>14)?"few":"other"},ca:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-6);return e==1&&s?"one":r!=0&&i==0&&s?"many":"other"},ceb:function(e){var t=String(e).split("."),r=t[0],s=t[1]||"",i=!t[1],a=r.slice(-1),o=s.slice(-1);return i&&(r==1||r==2||r==3)||i&&a!=4&&a!=6&&a!=9||!i&&o!=4&&o!=6&&o!=9?"one":"other"},cs:function(e){var t=String(e).split("."),r=t[0],s=!t[1];return e==1&&s?"one":r>=2&&r<=4&&s?"few":s?"other":"many"},cy:function(e){return e==0?"zero":e==1?"one":e==2?"two":e==3?"few":e==6?"many":"other"},da:function(e){var t=String(e).split("."),r=t[0],s=Number(t[0])==e;return e==1||!s&&(r==0||r==1)?"one":"other"},dsb:function(e){var t=String(e).split("."),r=t[0],s=t[1]||"",i=!t[1],a=r.slice(-2),o=s.slice(-2);return i&&a==1||o==1?"one":i&&a==2||o==2?"two":i&&(a==3||a==4)||o==3||o==4?"few":"other"},dz:function(e){return"other"},es:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-6);return e==1?"one":r!=0&&i==0&&s?"many":"other"},ff:function(e){return e>=0&&e<2?"one":"other"},fr:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-6);return e>=0&&e<2?"one":r!=0&&i==0&&s?"many":"other"},ga:function(e){var t=String(e).split("."),r=Number(t[0])==e;return e==1?"one":e==2?"two":r&&e>=3&&e<=6?"few":r&&e>=7&&e<=10?"many":"other"},gd:function(e){var t=String(e).split("."),r=Number(t[0])==e;return e==1||e==11?"one":e==2||e==12?"two":r&&e>=3&&e<=10||r&&e>=13&&e<=19?"few":"other"},he:function(e){var t=String(e).split("."),r=t[0],s=!t[1];return r==1&&s||r==0&&!s?"one":r==2&&s?"two":"other"},is:function(e){var t=String(e).split("."),r=t[0],s=(t[1]||"").replace(/0+$/,""),i=Number(t[0])==e,a=r.slice(-1),o=r.slice(-2);return i&&a==1&&o!=11||s%10==1&&s%100!=11?"one":"other"},ksh:function(e){return e==0?"zero":e==1?"one":"other"},lt:function(e){var t=String(e).split("."),r=t[1]||"",s=Number(t[0])==e,i=s&&t[0].slice(-1),a=s&&t[0].slice(-2);return i==1&&(a<11||a>19)?"one":i>=2&&i<=9&&(a<11||a>19)?"few":r!=0?"many":"other"},lv:function(e){var t=String(e).split("."),r=t[1]||"",s=r.length,i=Number(t[0])==e,a=i&&t[0].slice(-1),o=i&&t[0].slice(-2),l=r.slice(-2),c=r.slice(-1);return i&&a==0||o>=11&&o<=19||s==2&&l>=11&&l<=19?"zero":a==1&&o!=11||s==2&&c==1&&l!=11||s!=2&&c==1?"one":"other"},mk:function(e){var t=String(e).split("."),r=t[0],s=t[1]||"",i=!t[1],a=r.slice(-1),o=r.slice(-2),l=s.slice(-1),c=s.slice(-2);return i&&a==1&&o!=11||l==1&&c!=11?"one":"other"},mt:function(e){var t=String(e).split("."),r=Number(t[0])==e,s=r&&t[0].slice(-2);return e==1?"one":e==2?"two":e==0||s>=3&&s<=10?"few":s>=11&&s<=19?"many":"other"},pa:function(e){return e==0||e==1?"one":"other"},pl:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-1),a=r.slice(-2);return e==1&&s?"one":s&&i>=2&&i<=4&&(a<12||a>14)?"few":s&&r!=1&&(i==0||i==1)||s&&i>=5&&i<=9||s&&a>=12&&a<=14?"many":"other"},pt:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-6);return r==0||r==1?"one":r!=0&&i==0&&s?"many":"other"},ro:function(e){var t=String(e).split("."),r=!t[1],s=Number(t[0])==e,i=s&&t[0].slice(-2);return e==1&&r?"one":!r||e==0||e!=1&&i>=1&&i<=19?"few":"other"},ru:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-1),a=r.slice(-2);return s&&i==1&&a!=11?"one":s&&i>=2&&i<=4&&(a<12||a>14)?"few":s&&i==0||s&&i>=5&&i<=9||s&&a>=11&&a<=14?"many":"other"},se:function(e){return e==1?"one":e==2?"two":"other"},si:function(e){var t=String(e).split("."),r=t[0],s=t[1]||"";return e==0||e==1||r==0&&s==1?"one":"other"},sl:function(e){var t=String(e).split("."),r=t[0],s=!t[1],i=r.slice(-2);return s&&i==1?"one":s&&i==2?"two":s&&(i==3||i==4)||!s?"few":"other"}};xe.as=xe.am;xe.az=xe.af;xe.bg=xe.af;xe.bn=xe.am;xe.brx=xe.af;xe.ce=xe.af;xe.chr=xe.af;xe.de=xe.ast;xe.ee=xe.af;xe.el=xe.af;xe.en=xe.ast;xe.et=xe.ast;xe.eu=xe.af;xe.fa=xe.am;xe.fi=xe.ast;xe.fil=xe.ceb;xe.fo=xe.af;xe.fur=xe.af;xe.fy=xe.ast;xe.gl=xe.ast;xe.gu=xe.am;xe.ha=xe.af;xe.hi=xe.am;xe.hr=xe.bs;xe.hsb=xe.dsb;xe.hu=xe.af;xe.hy=xe.ff;xe.ia=xe.ast;xe.id=xe.dz;xe.ig=xe.dz;xe.it=xe.ca;xe.ja=xe.dz;xe.jgo=xe.af;xe.jv=xe.dz;xe.ka=xe.af;xe.kea=xe.dz;xe.kk=xe.af;xe.kl=xe.af;xe.km=xe.dz;xe.kn=xe.am;xe.ko=xe.dz;xe.ks=xe.af;xe.ku=xe.af;xe.ky=xe.af;xe.lb=xe.af;xe.lkt=xe.dz;xe.lo=xe.dz;xe.ml=xe.af;xe.mn=xe.af;xe.mr=xe.af;xe.ms=xe.dz;xe.my=xe.dz;xe.nb=xe.af;xe.ne=xe.af;xe.nl=xe.ast;xe.nn=xe.af;xe.no=xe.af;xe.or=xe.af;xe.pcm=xe.am;xe.ps=xe.af;xe.rm=xe.af;xe.sah=xe.dz;xe.sc=xe.ast;xe.sd=xe.af;xe.sk=xe.cs;xe.so=xe.af;xe.sq=xe.af;xe.sr=xe.bs;xe.su=xe.dz;xe.sv=xe.ast;xe.sw=xe.ast;xe.ta=xe.af;xe.te=xe.af;xe.th=xe.dz;xe.ti=xe.pa;xe.tk=xe.af;xe.to=xe.dz;xe.tr=xe.af;xe.ug=xe.af;xe.uk=xe.ru;xe.ur=xe.ast;xe.uz=xe.af;xe.vi=xe.dz;xe.wae=xe.af;xe.wo=xe.dz;xe.xh=xe.af;xe.yi=xe.ast;xe.yo=xe.dz;xe.yue=xe.dz;xe.zh=xe.dz;xe.zu=xe.am;function c$(n){return n==="pt-PT"?n:qge(n)}var Gge=/^([a-z0-9]+)/i;function qge(n){var e=n.match(Gge);if(!e)throw new TypeError("Invalid locale: ".concat(n));return e[1]}function Wge(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function u$(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Kge(n,e,t){return e&&u$(n.prototype,e),t&&u$(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}var ek=function(){function n(e,t){Wge(this,n);var r=n.supportedLocalesOf(e);if(r.length===0)throw new RangeError("Unsupported locale: "+e);if(t&&t.type!=="cardinal")throw new RangeError('Only "cardinal" "type" is supported');this.$=xe[c$(r[0])]}return Kge(n,[{key:"select",value:function(t){return this.$(t)}}],[{key:"supportedLocalesOf",value:function(t){return typeof t=="string"&&(t=[t]),t.filter(function(r){return xe[c$(r)]})}}]),n}();function tk(n){"@babel/helpers - typeof";return tk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tk(n)}function d$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function h$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?d$(Object(t),!0).forEach(function(r){Yge(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):d$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Yge(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f$(n,e){return Jge(n)||Zge(n,e)||Qge(n,e)||Xge()}function Xge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qge(n,e){if(n){if(typeof n=="string")return m$(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return m$(n,e)}}function m$(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Zge(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],s=!0,i=!1,a,o;try{for(t=t.call(n);!(s=(a=t.next()).done)&&(r.push(a.value),!(e&&r.length===e));s=!0);}catch(l){i=!0,o=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(i)throw o}}return r}}function Jge(n){if(Array.isArray(n))return n}function eve(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function tve(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function nve(n,e,t){return e&&tve(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var rve=["second","minute","hour","day","week","month","quarter","year"],sve=["auto","always"],ive=["long","short","narrow"],ave=["lookup","best fit"],ru=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};eve(this,n);var r=t.numeric,s=t.style,i=t.localeMatcher;if(this.numeric="always",this.style="long",this.localeMatcher="lookup",r!==void 0){if(sve.indexOf(r)<0)throw new RangeError('Invalid "numeric" option: '.concat(r));this.numeric=r}if(s!==void 0){if(ive.indexOf(s)<0)throw new RangeError('Invalid "style" option: '.concat(s));this.style=s}if(i!==void 0){if(ave.indexOf(i)<0)throw new RangeError('Invalid "localeMatcher" option: '.concat(i));this.localeMatcher=i}if(typeof e=="string"&&(e=[e]),e.push(a9()),this.locale=n.supportedLocalesOf(e,{localeMatcher:this.localeMatcher})[0],!this.locale)throw new Error("No supported locale was found");ek.supportedLocalesOf(this.locale).length>0?this.pluralRules=new ek(this.locale):console.warn('"'.concat(this.locale,'" locale is not supported')),typeof Intl<"u"&&Intl.NumberFormat?(this.numberFormat=new Intl.NumberFormat(this.locale),this.numberingSystem=this.numberFormat.resolvedOptions().numberingSystem):this.numberingSystem="latn",this.locale=o9(this.locale,{localeMatcher:this.localeMatcher})}return nve(n,[{key:"format",value:function(){var t=p$(arguments),r=f$(t,2),s=r[0],i=r[1];return this.getRule(s,i).replace("{0}",this.formatNumber(Math.abs(s)))}},{key:"formatToParts",value:function(){var t=p$(arguments),r=f$(t,2),s=r[0],i=r[1],a=this.getRule(s,i),o=a.indexOf("{0}");if(o<0)return[{type:"literal",value:a}];var l=[];return o>0&&l.push({type:"literal",value:a.slice(0,o)}),l=l.concat(this.formatNumberToParts(Math.abs(s)).map(function(c){return h$(h$({},c),{},{unit:i})})),o+3<a.length-1&&l.push({type:"literal",value:a.slice(o+3)}),l}},{key:"getRule",value:function(t,r){var s=Vge(this.locale)[this.style][r];if(typeof s=="string")return s;if(this.numeric==="auto"){if(t===-2||t===-1){var i=s["previous".concat(t===-1?"":"-"+Math.abs(t))];if(i)return i}else if(t===1||t===2){var a=s["next".concat(t===1?"":"-"+Math.abs(t))];if(a)return a}else if(t===0&&s.current)return s.current}var o=s[dve(t)?"past":"future"];if(typeof o=="string")return o;var l=this.pluralRules&&this.pluralRules.select(Math.abs(t))||"other";return o[l]||o.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"formatNumberToParts",value:function(t){return this.numberFormat&&this.numberFormat.formatToParts?this.numberFormat.formatToParts(t):[{type:"integer",value:this.formatNumber(t)}]}},{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style,numeric:this.numeric,numberingSystem:this.numberingSystem}}}]),n}();ru.supportedLocalesOf=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string")n=[n];else if(!Array.isArray(n))throw new TypeError('Invalid "locales" argument');return n.filter(function(t){return o9(t,e)})};ru.addLocale=zge;ru.setDefaultLocale=Hge;ru.getDefaultLocale=a9;ru.PluralRules=ek;var mA='Invalid "unit" argument';function ove(n){if(tk(n)==="symbol")throw new TypeError(mA);if(typeof n!="string")throw new RangeError("".concat(mA,": ").concat(n));if(n[n.length-1]==="s"&&(n=n.slice(0,n.length-1)),rve.indexOf(n)<0)throw new RangeError("".concat(mA,": ").concat(n));return n}var lve='Invalid "number" argument';function cve(n){if(n=Number(n),Number.isFinite&&!Number.isFinite(n))throw new RangeError("".concat(lve,": ").concat(n));return n}function uve(n){return 1/n===-1/0}function dve(n){return n<0||n===0&&uve(n)}function p$(n){if(n.length<2)throw new TypeError('"unit" argument is required');return[cve(n[0]),ove(n[1])]}function yw(n){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yw(n)}function hve(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function fve(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function mve(n,e,t){return e&&fve(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var g$=function(){function n(){hve(this,n),this.cache={}}return mve(n,[{key:"get",value:function(){for(var t=this.cache,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];for(var a=0,o=s;a<o.length;a++){var l=o[a];if(yw(t)!=="object")return;t=t[l]}return t}},{key:"put",value:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];for(var i=r.pop(),a=r.pop(),o=this.cache,l=0,c=r;l<c.length;l++){var u=c[l];yw(o[u])!=="object"&&(o[u]={}),o=o[u]}return o[a]=i}}]),n}();function nk(n){"@babel/helpers - typeof";return nk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nk(n)}function pve(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=gve(n))||e){t&&(n=t);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gve(n,e){if(n){if(typeof n=="string")return v$(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return v$(n,e)}}function v$(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function vve(n,e){for(var t=pve(n),r;!(r=t()).done;){var s=r.value;if(e(s))return s;for(var i=s.split("-");i.length>1;)if(i.pop(),s=i.join("-"),e(s))return s}throw new Error("No locale data has been registered for any of the locales: ".concat(n.join(", ")))}function yve(){var n=(typeof Intl>"u"?"undefined":nk(Intl))==="object";return n&&typeof Intl.DateTimeFormat=="function"}function rk(n){"@babel/helpers - typeof";return rk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rk(n)}function bve(n){return wve(n)&&(Array.isArray(n.steps)||Array.isArray(n.gradation)||Array.isArray(n.flavour)||typeof n.flavour=="string"||Array.isArray(n.labels)||typeof n.labels=="string"||Array.isArray(n.units)||typeof n.custom=="function")}var xve={}.constructor;function wve(n){return rk(n)!==void 0&&n!==null&&n.constructor===xve}var Ml=60,bw=60*Ml,ld=24*bw,sk=7*ld,ik=30.44*ld,l9=146097/400*ld;function Rf(n){switch(n){case"second":return 1;case"minute":return Ml;case"hour":return bw;case"day":return ld;case"week":return sk;case"month":return ik;case"year":return l9}}function c9(n){return n.factor!==void 0?n.factor:Rf(n.unit||n.formatAs)||1}function dv(n){switch(n){case"floor":return Math.floor;default:return Math.round}}function zD(n){switch(n){case"floor":return 1;default:return .5}}function ak(n){"@babel/helpers - typeof";return ak=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ak(n)}function u9(n,e){var t=e.prevStep,r=e.timestamp,s=e.now,i=e.future,a=e.round,o;return t&&(t.id||t.unit)&&(o=n["threshold_for_".concat(t.id||t.unit)]),o===void 0&&n.threshold!==void 0&&(o=n.threshold,typeof o=="function"&&(o=o(s,i))),o===void 0&&(o=n.minTime),ak(o)==="object"&&(t&&t.id&&o[t.id]!==void 0?o=o[t.id]:o=o.default),typeof o=="function"&&(o=o(r,{future:i,getMinTimeForUnit:function(c,u){return y$(c,u||t&&t.formatAs,{round:a})}})),o===void 0&&n.test&&(n.test(r,{now:s,future:i})?o=0:o=9007199254740991),o===void 0&&(t?n.formatAs&&t.formatAs&&(o=y$(n.formatAs,t.formatAs,{round:a})):o=0),o===void 0&&console.warn("[javascript-time-ago] A step should specify `minTime`:\n"+JSON.stringify(n,null,2)),o}function y$(n,e,t){var r=t.round,s=Rf(n),i;if(e==="now"?i=Rf(n):i=Rf(e),s!==void 0&&i!==void 0)return s-i*(1-zD(r))}function b$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Eve(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?b$(Object(t),!0).forEach(function(r){Sve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):b$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Sve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tve(n,e,t){var r=t.now,s=t.future,i=t.round,a=t.units;n=Ave(n,a);var o=_ve(n,e,{now:r,future:s,round:i});{if(o){var l=n[n.indexOf(o)-1],c=n[n.indexOf(o)+1];return[l,o,c]}return[void 0,void 0,n[0]]}}function _ve(n,e,t){var r=t.now,s=t.future,i=t.round;if(n.length!==0){var a=d9(n,e,{now:r,future:s||e<0,round:i});if(a!==-1){var o=n[a];if(o.granularity){var l=dv(i)(Math.abs(e)/c9(o)/o.granularity)*o.granularity;if(l===0&&a>0)return n[a-1]}return o}}}function d9(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=u9(n[r],Eve({prevStep:n[r-1],timestamp:t.now-e*1e3},t));return s===void 0||Math.abs(e)<s?r-1:r===n.length-1?r:d9(n,e,t,r+1)}function Ave(n,e){return n.filter(function(t){var r=t.unit,s=t.formatAs;return r=r||s,r?e.indexOf(r)>=0:!0})}function Rve(n,e,t){var r=t.now,s=t.round;if(Rf(n)){var i=Rf(n)*1e3,a=e>r,o=Math.abs(e-r),l=dv(s)(o/i)*i;return a?l>0?o-l+kve(s,i):o-l+1:-(o-l)+Cve(s,i)}}function Cve(n,e){return zD(n)*e}function kve(n,e){return(1-zD(n))*e+1}var Ive=365*24*60*60*1e3,h9=1e3*Ive;function Lve(n,e,t){var r=t.prevStep,s=t.nextStep,i=t.now,a=t.future,o=t.round,l=n.getTime?n.getTime():n,c=function(y){return Rve(y,l,{now:i,round:o})},u=Pve(a?e:s,l,{future:a,now:i,round:o,prevStep:a?r:e});if(u!==void 0){var f;if(e&&(e.getTimeToNextUpdate&&(f=e.getTimeToNextUpdate(l,{getTimeToNextUpdateForUnit:c,getRoundFunction:dv,now:i,future:a,round:o})),f===void 0)){var m=e.unit||e.formatAs;m&&(f=c(m))}return f===void 0?u:Math.min(f,u)}}function Dve(n,e,t){var r=t.now,s=t.future,i=t.round,a=t.prevStep,o=u9(n,{timestamp:e,now:r,future:s,round:i,prevStep:a});if(o!==void 0)return s?e-o*1e3+1:o===0&&e===r?h9:e+o*1e3}function Pve(n,e,t){var r=t.now,s=t.future,i=t.round,a=t.prevStep;if(n){var o=Dve(n,e,{now:r,future:s,round:i,prevStep:a});return o===void 0?void 0:o-r}else return s?e-r+1:h9}var f9={};function uf(n){return f9[n]}function m9(n){if(!n)throw new Error("[javascript-time-ago] No locale data passed.");f9[n.locale]=n}const Mve=[{formatAs:"now"},{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"}],ok={steps:Mve,labels:"long"};function x$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function w$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?x$(Object(t),!0).forEach(function(r){Ove(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):x$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ove(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const lk=w$(w$({},ok),{},{steps:ok.steps.filter(function(n){return n.formatAs!=="second"})}),p9=[{factor:1,unit:"now"},{threshold:1,threshold_for_now:45.5,factor:1,unit:"second"},{threshold:45.5,factor:Ml,unit:"minute"},{threshold:2.5*Ml,granularity:5,factor:Ml,unit:"minute"},{threshold:22.5*Ml,factor:.5*bw,unit:"half-hour"},{threshold:42.5*Ml,threshold_for_minute:52.5*Ml,factor:bw,unit:"hour"},{threshold:20.5/24*ld,factor:ld,unit:"day"},{threshold:5.5*ld,factor:sk,unit:"week"},{threshold:3.5*sk,factor:ik,unit:"month"},{threshold:10.5*ik,factor:l9,unit:"year"}],E$={gradation:p9,flavour:"long",units:["now","minute","hour","day","week","month","year"]},Nve={gradation:p9,flavour:"long-time",units:["now","minute","hour","day","week","month","year"]};function g9(n){return n instanceof Date?n:new Date(n)}var ck=[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"}],ko={},jve={minTime:function(e,t){t.future;var r=t.getMinTimeForUnit;return r("day")},format:function(e,t){return ko[t]||(ko[t]={}),ko[t].dayMonth||(ko[t].dayMonth=new Intl.DateTimeFormat(t,{month:"short",day:"numeric"})),ko[t].dayMonth.format(g9(e))}},Fve={minTime:function(e,t){var r=t.future;if(r){var s=new Date(new Date(e).getFullYear(),0).getTime()-1;return(e-s)/1e3}else{var i=new Date(new Date(e).getFullYear()+1,0).getTime();return(i-e)/1e3}},format:function(e,t){return ko[t]||(ko[t]={}),ko[t].dayMonthYear||(ko[t].dayMonthYear=new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"})),ko[t].dayMonthYear.format(g9(e))}};yve()?ck.push(jve,Fve):ck.push({formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"});const wd={steps:ck,labels:["mini","short-time","narrow","short"]};function S$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function T$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?S$(Object(t),!0).forEach(function(r){Uve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):S$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Uve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const $ve=T$(T$({},wd),{},{steps:[{formatAs:"now"}].concat(wd.steps)});function _$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function A$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_$(Object(t),!0).forEach(function(r){Bve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Bve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const uk=A$(A$({},wd),{},{steps:wd.steps.filter(function(n){return n.formatAs!=="second"})});function R$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function C$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?R$(Object(t),!0).forEach(function(r){Hve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):R$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Hve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Vve=C$(C$({},uk),{},{steps:[{formatAs:"now"}].concat(uk.steps)});function k$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function nb(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?k$(Object(t),!0).forEach(function(r){zve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):k$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function zve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Gve=nb(nb({},wd),{},{steps:wd.steps.filter(function(n){return n.formatAs!=="second"}).map(function(n){return n.formatAs==="minute"?nb(nb({},n),{},{minTime:Ml}):n})}),hv={steps:[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"month"},{formatAs:"year"}],labels:["mini","short-time","narrow","short"]};function I$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function L$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?I$(Object(t),!0).forEach(function(r){qve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):I$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function qve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Wve=L$(L$({},hv),{},{steps:[{formatAs:"now"}].concat(hv.steps)});function D$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function P$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?D$(Object(t),!0).forEach(function(r){Kve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):D$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Kve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const dk=P$(P$({},hv),{},{steps:hv.steps.filter(function(n){return n.formatAs!=="second"})});function M$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function O$(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?M$(Object(t),!0).forEach(function(r){Yve(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):M$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Yve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Xve=O$(O$({},dk),{},{steps:[{formatAs:"now"}].concat(dk.steps)});function Qve(n){switch(n){case"default":case"round":return ok;case"round-minute":return lk;case"approximate":return E$;case"time":case"approximate-time":return Nve;case"mini":return hv;case"mini-now":return Wve;case"mini-minute":return dk;case"mini-minute-now":return Xve;case"twitter":return wd;case"twitter-now":return $ve;case"twitter-minute":return uk;case"twitter-minute-now":return Vve;case"twitter-first-minute":return Gve;default:return E$}}function xw(n){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xw(n)}function Zve(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=v9(n))||e){t&&(n=t);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jve(n,e){return n0e(n)||t0e(n,e)||v9(n,e)||e0e()}function e0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v9(n,e){if(n){if(typeof n=="string")return N$(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return N$(n,e)}}function N$(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function t0e(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],s=!0,i=!1,a,o;try{for(t=t.call(n);!(s=(a=t.next()).done)&&(r.push(a.value),!(e&&r.length===e));s=!0);}catch(l){i=!0,o=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(i)throw o}}return r}}function n0e(n){if(Array.isArray(n))return n}function r0e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function s0e(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function i0e(n,e,t){return e&&s0e(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var za=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.polyfill;r0e(this,n),typeof e=="string"&&(e=[e]),this.locale=vve(e.concat(n.getDefaultLocale()),uf),typeof Intl<"u"&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale)),r===!1?(this.IntlRelativeTimeFormat=Intl.RelativeTimeFormat,this.IntlPluralRules=Intl.PluralRules):(this.IntlRelativeTimeFormat=ru,this.IntlPluralRules=ru.PluralRules),this.relativeTimeFormatCache=new g$,this.pluralRulesCache=new g$}return i0e(n,[{key:"format",value:function(t,r,s){s||(r&&!u0e(r)?(s=r,r=void 0):s={}),r||(r=lk),typeof r=="string"&&(r=Qve(r));var i=a0e(t),a=this.getLabels(r.flavour||r.labels),o=a.labels,l=a.labelsType,c;r.now!==void 0&&(c=r.now),c===void 0&&s.now!==void 0&&(c=s.now),c===void 0&&(c=Date.now());var u=(c-i)/1e3,f=s.future||u<0,m=c0e(o,uf(this.locale).now,uf(this.locale).long,f);if(r.custom){var g=r.custom({now:c,date:new Date(i),time:i,elapsed:u,locale:this.locale});if(g!==void 0)return g}var y=l0e(r.units,o,m),b=s.round||r.round,x=Tve(r.gradation||r.steps||lk.steps,u,{now:c,units:y,round:b,future:f}),S=Jve(x,3),T=S[0],_=S[1],R=S[2],I=this.formatDateForStep(i,_,u,{labels:o,labelsType:l,nowLabel:m,now:c,future:f,round:b})||"";if(s.getTimeToNextUpdate){var C=Lve(i,_,{nextStep:R,prevStep:T,now:c,future:f,round:b});return[I,C]}return I}},{key:"formatDateForStep",value:function(t,r,s,i){var a=this,o=i.labels,l=i.labelsType,c=i.nowLabel,u=i.now,f=i.future,m=i.round;if(r){if(r.format)return r.format(t,this.locale,{formatAs:function(S,T){return a.formatValue(T,S,{labels:o,future:f})},now:u,future:f});var g=r.unit||r.formatAs;if(!g)throw new Error("[javascript-time-ago] Each step must define either `formatAs` or `format()`. Step: ".concat(JSON.stringify(r)));if(g==="now")return c;var y=Math.abs(s)/c9(r);r.granularity&&(y=dv(m)(y/r.granularity)*r.granularity);var b=-1*Math.sign(s)*dv(m)(y);switch(b===0&&(f?b=0:b=-0),l){case"long":case"short":case"narrow":return this.getFormatter(l).format(b,g);default:return this.formatValue(b,g,{labels:o,future:f})}}}},{key:"formatValue",value:function(t,r,s){var i=s.labels,a=s.future;return this.getFormattingRule(i,r,t,{future:a}).replace("{0}",this.formatNumber(Math.abs(t)))}},{key:"getFormattingRule",value:function(t,r,s,i){var a=i.future;if(this.locale,t=t[r],typeof t=="string")return t;var o=s===0?a?"future":"past":s<0?"past":"future",l=t[o]||t;if(typeof l=="string")return l;var c=this.getPluralRules().select(Math.abs(s));return l[c]||l.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"getFormatter",value:function(t){return this.relativeTimeFormatCache.get(this.locale,t)||this.relativeTimeFormatCache.put(this.locale,t,new this.IntlRelativeTimeFormat(this.locale,{style:t}))}},{key:"getPluralRules",value:function(){return this.pluralRulesCache.get(this.locale)||this.pluralRulesCache.put(this.locale,new this.IntlPluralRules(this.locale))}},{key:"getLabels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];typeof t=="string"&&(t=[t]),t=t.map(function(o){switch(o){case"tiny":case"mini-time":return"mini";default:return o}}),t=t.concat("long");for(var r=uf(this.locale),s=Zve(t),i;!(i=s()).done;){var a=i.value;if(r[a])return{labelsType:a,labels:r[a]}}}}]),n}(),y9="en";za.getDefaultLocale=function(){return y9};za.setDefaultLocale=function(n){return y9=n};za.addDefaultLocale=function(n){if(j$)return console.error("[javascript-time-ago] `TimeAgo.addDefaultLocale()` can only be called once. To add other locales, use `TimeAgo.addLocale()`.");j$=!0,za.setDefaultLocale(n.locale),za.addLocale(n)};var j$;za.addLocale=function(n){m9(n),ru.addLocale(n)};za.locale=za.addLocale;za.addLabels=function(n,e,t){var r=uf(n);r||(m9({locale:n}),r=uf(n)),r[e]=t};function a0e(n){if(n.constructor===Date||o0e(n))return n.getTime();if(typeof n=="number")return n;throw new Error("Unsupported relative time formatter input: ".concat(xw(n),", ").concat(n))}function o0e(n){return xw(n)==="object"&&typeof n.getTime=="function"}function l0e(n,e,t){var r=Object.keys(e);return t&&r.push("now"),n&&(r=n.filter(function(s){return s==="now"||r.indexOf(s)>=0})),r}function c0e(n,e,t,r){var s=n.now||e&&e.now;if(s)return typeof s=="string"?s:r?s.future:s.past;if(t&&t.second&&t.second.current)return t.second.current}function u0e(n){return typeof n=="string"||bve(n)}const d0e={locale:"en",long:{year:{previous:"last year",current:"this year",next:"next year",past:{one:"{0} year ago",other:"{0} years ago"},future:{one:"in {0} year",other:"in {0} years"}},quarter:{previous:"last quarter",current:"this quarter",next:"next quarter",past:{one:"{0} quarter ago",other:"{0} quarters ago"},future:{one:"in {0} quarter",other:"in {0} quarters"}},month:{previous:"last month",current:"this month",next:"next month",past:{one:"{0} month ago",other:"{0} months ago"},future:{one:"in {0} month",other:"in {0} months"}},week:{previous:"last week",current:"this week",next:"next week",past:{one:"{0} week ago",other:"{0} weeks ago"},future:{one:"in {0} week",other:"in {0} weeks"}},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:{one:"{0} hour ago",other:"{0} hours ago"},future:{one:"in {0} hour",other:"in {0} hours"}},minute:{current:"this minute",past:{one:"{0} minute ago",other:"{0} minutes ago"},future:{one:"in {0} minute",other:"in {0} minutes"}},second:{current:"now",past:{one:"{0} second ago",other:"{0} seconds ago"},future:{one:"in {0} second",other:"in {0} seconds"}}},short:{year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0} yr. ago",future:"in {0} yr."},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:{one:"{0} qtr. ago",other:"{0} qtrs. ago"},future:{one:"in {0} qtr.",other:"in {0} qtrs."}},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0} mo. ago",future:"in {0} mo."},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0} wk. ago",future:"in {0} wk."},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:"{0} hr. ago",future:"in {0} hr."},minute:{current:"this minute",past:"{0} min. ago",future:"in {0} min."},second:{current:"now",past:"{0} sec. ago",future:"in {0} sec."}},narrow:{year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0}y ago",future:"in {0}y"},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:"{0}q ago",future:"in {0}q"},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0}mo ago",future:"in {0}mo"},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0}w ago",future:"in {0}w"},day:{previous:"yesterday",current:"today",next:"tomorrow",past:"{0}d ago",future:"in {0}d"},hour:{current:"this hour",past:"{0}h ago",future:"in {0}h"},minute:{current:"this minute",past:"{0}m ago",future:"in {0}m"},second:{current:"now",past:"{0}s ago",future:"in {0}s"}},now:{now:{current:"now",future:"in a moment",past:"just now"}},mini:{year:"{0}yr",month:"{0}mo",week:"{0}wk",day:"{0}d",hour:"{0}h",minute:"{0}m",second:"{0}s",now:"now"},"short-time":{year:"{0} yr.",month:"{0} mo.",week:"{0} wk.",day:{one:"{0} day",other:"{0} days"},hour:"{0} hr.",minute:"{0} min.",second:"{0} sec."},"long-time":{year:{one:"{0} year",other:"{0} years"},month:{one:"{0} month",other:"{0} months"},week:{one:"{0} week",other:"{0} weeks"},day:{one:"{0} day",other:"{0} days"},hour:{one:"{0} hour",other:"{0} hours"},minute:{one:"{0} minute",other:"{0} minutes"},second:{one:"{0} second",other:"{0} seconds"}}};function h0e(n){if(!isFinite(n)||isNaN(n)||n<0)return"--:--";const e=Math.floor(n/3600),t=Math.floor(n%3600/60),r=Math.floor(n%60),s=String(t).padStart(2,"0"),i=String(r).padStart(2,"0");return e>0?`${String(e).padStart(2,"0")}:${s}:${i}`:`${s}:${i}`}za.addDefaultLocale(d0e);const f0e=new za("en-US");function b9(n){const e=f0e.format(n,"mini-minute-now");return e==="now"||e.match(/[A-Z]|^\d{4}/)?e:`${e} ago`}const ww=({assets:n,flaskName:e,className:t,style:r,onLoad:s,onError:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,f]=E.useState(0),m=E.useMemo(()=>!n||n.length===0?null:n.find(S=>S.asset_type==="youtube"||S.asset_type==="native"),[n]),g=E.useMemo(()=>{if(!m)return null;if(m.thumbnail_url&&u===0)return m.thumbnail_url;if(m.asset_type==="youtube"){const S=m.youtube_video_id||(m.youtube_url?Vf(m.youtube_url):null);if(S){const T=m.thumbnail_url?u-1:u;return T===0?`https://img.youtube.com/vi/${S}/maxresdefault.jpg`:T===1?`https://img.youtube.com/vi/${S}/hqdefault.jpg`:T===2?`https://img.youtube.com/vi/${S}/mqdefault.jpg`:`https://img.youtube.com/vi/${S}/default.jpg`}}if(m.asset_type==="native"&&m.mux_playback_id){const S=m.duration||0,T=Math.floor(S/2);return`https://image.mux.com/${m.mux_playback_id}/thumbnail.jpg?time=${T}&width=640&height=360&fit_mode=crop`}return null},[m,u]);E.useEffect(()=>{o(!1),c(!1),f(0)},[m?.id]);const y=()=>{c(!0),o(!1),s?.()},b=()=>{const S=m?.thumbnail_url?4:3;m&&u<S?f(T=>T+1):(o(!0),i?.())},x=m?.thumbnail_url?4:3;return!g||a&&u>=x?d.jsx("div",{className:je("bg-gradient-to-br from-gray-800 to-gray-500",t),style:r,children:d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})})}):d.jsx("img",{src:g,alt:e||"Flask thumbnail",className:t,style:r,onLoad:y,onError:b,loading:"lazy"})},m0e=({width:n=48,height:e=49,className:t="",color:r="currentColor"})=>d.jsxs("svg",{width:n,height:e,viewBox:"0 0 48 49",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[d.jsx("path",{d:"M18.3339 40.7253H11.9219C9.36164 40.7253 7.28613 38.6498 7.28613 36.0896V12.9107C7.28613 10.3504 9.36164 8.2749 11.9219 8.2749H36.078C38.6383 8.2749 40.7138 10.3504 40.7138 12.9107V17.8139",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M13.8418 16.3691L34.1582 16.3691",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M13.8418 24.7246L18.6201 24.7246",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M13.8418 33.0801L18.6201 33.0801",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("rect",{x:"25.4512",y:"24.7246",width:"15.2627",height:"16.0007",rx:"3",stroke:r,strokeWidth:"4"})]}),x9=({text:n,className:e})=>d.jsx("div",{className:je("inline-flex items-center ",e),children:d.jsx("span",{className:"text-xs font-medium text-text-primary whitespace-nowrap",children:n})}),ha=E.forwardRef(({className:n,type:e,...t},r)=>d.jsx("input",{type:e,className:je("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...t}));ha.displayName="Input";const hk=({children:n,className:e})=>d.jsx("div",{className:je("bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 flex gap-2",e),children:d.jsxs("div",{className:"text-xs text-blue-300/90",children:[d.jsx("span",{className:"font-bold",children:"Tip:"})," ",n]})}),w9=({isOpen:n,onClose:e})=>{const t=E.useRef(null);return Jn(),E.useEffect(()=>{n&&t.current&&t.current.play().catch(()=>{})},[n]),d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[600px]",onClick:r=>r.stopPropagation(),children:[d.jsx(ar,{children:d.jsx(or,{children:"How to add assets to a Flask"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"bg-element-background/50 rounded-lg p-4 space-y-3",children:[d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-sm font-medium text-text-primary mb-1",children:"Upload multiple videos from device"}),d.jsx("p",{className:"text-xs text-text-secondary",children:"They will all be added to a single Flask"})]})}),d.jsx(hk,{children:"You can use this to review and share many files. e.g. 20 YouTube shorts"})]}),d.jsxs("div",{className:"bg-element-background/50 rounded-lg p-4 space-y-3",children:[d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-sm font-medium text-text-primary mb-1",children:"Drag existing flasks"}),d.jsx("p",{className:"text-xs text-text-secondary",children:"This moves their assets into the current flask."})]})}),d.jsx("div",{className:"relative w-full rounded-lg overflow-hidden bg-black/20",children:d.jsxs("video",{ref:t,className:"w-full h-auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,children:[d.jsx("source",{src:"/videos/flask-drag-demo.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]})}),d.jsx(hk,{children:"You can merge multiple versions and revisions of the same project into a single Flask."})]})]}),d.jsx(ys,{className:"mt-6",children:d.jsx("div",{onClick:e,className:"button-primary flex items-center rounded-xl justify-center px-6 py-3 cursor-pointer text-sm font-medium",children:d.jsx("span",{children:"Got it"})})})]})})},fk=({flask:n,onDelete:e,availableTags:t=[],onTagUpdate:r,isPlaceholder:s=!1,showEmptyState:i=!1,isLoading:a=!1})=>{const o=Jn(),l=Ft(V=>V.updateFlaskOptimistic),[c,u]=E.useState(n.flask_tag),[f,m]=E.useState(!1),[g,y]=E.useState(n.name||""),[b,x]=E.useState(!1),[S,T]=E.useState(!1);ve.useEffect(()=>{u(n.flask_tag)},[n.flask_tag]),ve.useEffect(()=>{y(n.name||"")},[n.name]);const _=E.useMemo(()=>{let V=n.updated_at||n.created_at;if(n.assets&&n.assets.length>0){const B=n.assets.map(j=>j.updated_at).filter(Boolean).map(j=>Math.floor(new Date(j).getTime()/6e4));new Set(B).size===1&&n.assets.length>0?n.assets.forEach(j=>{const q=j.created_at;q&&(!V||new Date(q)>new Date(V))&&(V=q)}):n.assets.forEach(j=>{const q=j.updated_at||j.created_at;q&&(!V||new Date(q)>new Date(V))&&(V=q)})}if(!V)return"Never";try{return b9(new Date(V))}catch{return"Invalid date"}},[n.updated_at,n.created_at,n.assets]),R=E.useMemo(()=>{const V=n.assets?.[0];if(!V||!V.duration)return null;const B=V.duration,W=Math.floor(B/3600),F=Math.floor(B%3600/60),j=Math.floor(B%60);return W>0?`${W}:${F.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`:`${F}:${j.toString().padStart(2,"0")}`},[n.assets]),I=n.element_count||0,C=V=>{V.stopPropagation();const B=`${window.location.origin}/flask/${n.id}`;navigator.clipboard.writeText(B).then(()=>{et.success("Link copied!")})},L=()=>{s||o(`/flask/${n.id}`)},k=V=>{const B=V==="none"?null:V;if(B){const W=t.find(F=>F.id===B);u(W||null)}else u(null);r&&r(n.id,B)},M=V=>{V.stopPropagation(),e(n.id,n.name||"Untitled Flask")},D=V=>{V.stopPropagation(),m(!0)},U=async()=>{const V=g.trim();if(!V||V===n.name){m(!1);return}x(!0);try{await l(n.id,{name:V}),et.success("Flask renamed successfully"),m(!1)}catch(B){console.error("Failed to rename flask:",B),et.error("Failed to rename flask")}finally{x(!1)}},$=(n.assets?.length||0)>1;return d.jsxs("div",{className:je("group border-t border-transparent rounded-[36px] ",s?"cursor-default":"cursor-pointer hover:bg-element-background/50 hover:border-border/50 border border-transparent",s&&a&&"animate-opacity-shimmer"),onClick:L,children:[d.jsx("div",{className:"p-3 md:p-5 relative",children:d.jsxs("div",{className:"relative w-full aspect-video",children:[!s&&$&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute inset-0 bg-card-background rounded-3xl border-t shadow-2xl border-text-primary/10 transform -translate-y-9 group-hover:-translate-y-12 mx-10 transition-transform duration-300 z-10"}),d.jsx("div",{className:"absolute inset-0 rounded-3xl border-t shadow-2xl border-text-primary/20 bg-black overflow-hidden transform -translate-y-5 mx-4 group-hover:-translate-y-6 transition-transform duration-300 z-20",children:d.jsx(ww,{assets:n.assets?.slice(1,2)||[],flaskName:n.name,className:"absolute inset-0 w-full h-full object-cover"})})]}),d.jsxs("div",{className:je("relative w-full h-full rounded-3xl border-t bg-element-background/20 overflow-hidden duration-200 shadow-xl transition-all z-30",s?"border-text-primary/5":"border-text-primary/30 group-hover:border-text-primary/60"),children:[d.jsx("div",{className:je("absolute inset-0 transition-opacity duration-200"),children:s?d.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-tr from-element-background/20 to-transparent",children:i&&!a&&d.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-primary pointer-events-none",children:[d.jsx("p",{className:"text-lg mb-2 text-center",children:"No Flasks yet "}),d.jsx("p",{className:"text-xs text-text-secondary text-center px-4",children:"Your first Flask goes here"})]})}):d.jsx(ww,{assets:$?n.assets?.slice(0,1)||[]:n.assets||[],flaskName:n.name,className:"absolute inset-0 w-full h-full object-cover"})}),!s&&d.jsx("div",{className:je("absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent")}),!s&&c&&d.jsx("div",{className:"absolute top-3 left-3 hidden md:block pointer-events-none",children:d.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-black/60 rounded-lg",children:[d.jsx($C,{className:"h-4 w-4 text-white flex-shrink-0"}),d.jsx("span",{className:"text-sm font-medium text-white whitespace-nowrap",children:c.name})]})}),!s&&d.jsx(yi,{children:d.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center gap-2",children:[d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsxs("div",{className:je("flex items-center gap-1 px-2 py-1 bg-black/60 rounded-full text-xs text-text-secondary","group-hover:text-text-primary transition-colors duration-200"),children:[d.jsx(m0e,{width:12,height:12}),d.jsx("span",{children:I})]})}),d.jsx($n,{children:d.jsxs("p",{children:[I," Comments in the Flask"]})})]}),R&&d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsxs("div",{className:je("flex items-center gap-1 px-2 py-1 bg-black/60 rounded-full text-xs text-text-secondary","group-hover:text-text-primary transition-colors duration-200"),children:[d.jsx(ev,{className:"h-3 w-3"}),d.jsx("span",{children:R})]})}),d.jsx($n,{children:d.jsx("p",{children:"Duration"})})]})]})})]})]})}),d.jsx("div",{className:"px-4 pb-4 md:px-6 md:pb-6 -mt-2",children:d.jsxs("div",{className:"flex items-start justify-between gap-2",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-sm font-bold text-foreground truncate",children:s?d.jsx("div",{className:"h-4 bg-element-background/30 border-t border-white/5 rounded w-24"}):n.name||"Untitled Flask"}),d.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:s?d.jsx("div",{className:"h-3 bg-element-background/30 border-t border-white/5 rounded w-16"}):`Last edit: ${_}`})]}),!s&&d.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:d.jsxs(Gs,{children:[d.jsx(qs,{asChild:!0,onClick:V=>V.stopPropagation(),children:d.jsx(dt,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-accent/50",children:d.jsx(eD,{className:"h-4 w-4"})})}),d.jsxs(Ms,{align:"end",className:"bg-card-background border-border w-64 p-2",children:[d.jsxs(Pn,{onClick:C,className:"cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx(tz,{className:"h-4 w-4 mr-3"}),"Copy link"]}),d.jsxs(Pn,{onClick:D,className:"cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx(tv,{className:"h-4 w-4 mr-3"}),"Rename flask"]}),d.jsxs(HD,{children:[d.jsxs(ES,{className:"cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx($C,{className:"h-4 w-4 mr-3"}),d.jsx("span",{children:c?c.name:"Add tag"})]}),d.jsxs(SS,{className:"bg-card-background border-border w-64 p-2",children:[t.length===0?d.jsx("div",{className:"px-2 py-3 text-center",children:d.jsx("p",{className:"text-sm text-muted-foreground",children:"No tags yet"})}):d.jsx(d.Fragment,{children:t.map(V=>d.jsxs(Pn,{onClick:B=>{B.stopPropagation(),k(V.id)},className:je("cursor-pointer px-3 py-2.5 rounded-md flex items-center justify-between",c?.id===V.id&&"bg-accent"),children:[d.jsxs("div",{className:"flex items-center gap-2",children:[c?.id===V.id&&d.jsx(is,{className:"h-4 w-4"}),d.jsx(x9,{text:V.name,className:"text-xs"})]}),c?.id===V.id&&d.jsx($o,{className:"h-3 w-3 text-muted-foreground",onClick:B=>{B.stopPropagation(),k("none")}})]},V.id))}),d.jsx("div",{className:"h-px bg-border my-1"}),d.jsxs(Pn,{onClick:V=>{V.stopPropagation(),window.dispatchEvent(new CustomEvent("sidebar-create-tag"))},className:"cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx(Jc,{className:"h-4 w-4 mr-3"}),"Create tag"]})]})]}),d.jsxs(Pn,{onClick:V=>{V.stopPropagation(),T(!0)},className:"cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx(Jc,{className:"h-4 w-4 mr-3"}),"Add asset/version"]}),d.jsxs(Pn,{onClick:M,className:"text-red-500 hover:text-red-500 focus:text-red-500 cursor-pointer px-3 py-2.5 rounded-md",children:[d.jsx(rv,{className:"h-4 w-4 mr-3 opacity-100"}),"Delete flask"]})]})]})})]})}),d.jsx(w9,{isOpen:S,onClose:()=>T(!1)}),d.jsx(Zn,{open:f,onOpenChange:m,children:d.jsxs(Kn,{onOpenAutoFocus:V=>{V.preventDefault();const W=V.currentTarget.querySelector("input");W&&(W.focus(),W.select())},children:[d.jsx(ar,{children:d.jsx(or,{children:"Rename Flask"})}),d.jsx(ha,{value:g,onChange:V=>y(V.target.value),placeholder:"Enter flask name",onKeyDown:V=>{V.key==="Enter"&&U()}}),d.jsxs(ys,{children:[d.jsx(dt,{variant:"outline",onClick:()=>{y(n.name||""),m(!1)},children:"Cancel"}),d.jsx(dt,{onClick:U,disabled:b||!g.trim()||g.trim()===n.name,children:b?"Saving...":"Save"})]})]})})]})},TS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function dm(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function GD(n){return"nodeType"in n}function Ks(n){var e,t;return n?dm(n)?n:GD(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function qD(n){const{Document:e}=Ks(n);return n instanceof e}function r0(n){return dm(n)?!1:n instanceof Ks(n).HTMLElement}function E9(n){return n instanceof Ks(n).SVGElement}function hm(n){return n?dm(n)?n.document:GD(n)?qD(n)?n:r0(n)||E9(n)?n.ownerDocument:document:document:document}const Bl=TS?E.useLayoutEffect:E.useEffect;function _S(n){const e=E.useRef(n);return Bl(()=>{e.current=n}),E.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function p0e(){const n=E.useRef(null),e=E.useCallback((r,s)=>{n.current=setInterval(r,s)},[]),t=E.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function fv(n,e){e===void 0&&(e=[n]);const t=E.useRef(n);return Bl(()=>{t.current!==n&&(t.current=n)},e),t}function s0(n,e){const t=E.useRef();return E.useMemo(()=>{const r=n(t.current);return t.current=r,r},[...e])}function Ew(n){const e=_S(n),t=E.useRef(null),r=E.useCallback(s=>{s!==t.current&&e?.(s,t.current),t.current=s},[]);return[t,r]}function Sw(n){const e=E.useRef();return E.useEffect(()=>{e.current=n},[n]),e.current}let pA={};function AS(n,e){return E.useMemo(()=>{if(e)return e;const t=pA[n]==null?0:pA[n]+1;return pA[n]=t,n+"-"+t},[n,e])}function S9(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+n*c)}return i},{...e})}}const Cf=S9(1),Tw=S9(-1);function g0e(n){return"clientX"in n&&"clientY"in n}function WD(n){if(!n)return!1;const{KeyboardEvent:e}=Ks(n.target);return e&&n instanceof e}function v0e(n){if(!n)return!1;const{TouchEvent:e}=Ks(n.target);return e&&n instanceof e}function _w(n){if(v0e(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return g0e(n)?{x:n.clientX,y:n.clientY}:null}const qf=Object.freeze({Translate:{toString(n){if(!n)return;const{x:e,y:t}=n;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(n){if(!n)return;const{scaleX:e,scaleY:t}=n;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(n){if(n)return[qf.Translate.toString(n),qf.Scale.toString(n)].join(" ")}},Transition:{toString(n){let{property:e,duration:t,easing:r}=n;return e+" "+t+"ms "+r}}}),F$="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function y0e(n){return n.matches(F$)?n:n.querySelector(F$)}const b0e={display:"none"};function x0e(n){let{id:e,value:t}=n;return ve.createElement("div",{id:e,style:b0e},t)}function w0e(n){let{id:e,announcement:t,ariaLiveType:r="assertive"}=n;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ve.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},t)}function E0e(){const[n,e]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&e(r)},[]),announcement:n}}const T9=E.createContext(null);function S0e(n){const e=E.useContext(T9);E.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function T0e(){const[n]=E.useState(()=>new Set),e=E.useCallback(r=>(n.add(r),()=>n.delete(r)),[n]);return[E.useCallback(r=>{let{type:s,event:i}=r;n.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[n]),e]}const _0e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},A0e={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function R0e(n){let{announcements:e=A0e,container:t,hiddenTextDescribedById:r,screenReaderInstructions:s=_0e}=n;const{announce:i,announcement:a}=E0e(),o=AS("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),S0e(E.useMemo(()=>({onDragStart(f){let{active:m}=f;i(e.onDragStart({active:m}))},onDragMove(f){let{active:m,over:g}=f;e.onDragMove&&i(e.onDragMove({active:m,over:g}))},onDragOver(f){let{active:m,over:g}=f;i(e.onDragOver({active:m,over:g}))},onDragEnd(f){let{active:m,over:g}=f;i(e.onDragEnd({active:m,over:g}))},onDragCancel(f){let{active:m,over:g}=f;i(e.onDragCancel({active:m,over:g}))}}),[i,e])),!l)return null;const u=ve.createElement(ve.Fragment,null,ve.createElement(x0e,{id:r,value:s.draggable}),ve.createElement(w0e,{id:o,announcement:a}));return t?Hs.createPortal(u,t):u}var Vr;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(Vr||(Vr={}));function Aw(){}function U$(n,e){return E.useMemo(()=>({sensor:n,options:e??{}}),[n,e])}function C0e(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return E.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Wa=Object.freeze({x:0,y:0});function k0e(n,e){const t=_w(n);if(!t)return"0 0";const r={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function I0e(n,e){let{data:{value:t}}=n,{data:{value:r}}=e;return r-t}function L0e(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function D0e(n,e){const t=Math.max(e.top,n.top),r=Math.max(e.left,n.left),s=Math.min(e.left+e.width,n.left+n.width),i=Math.min(e.top+e.height,n.top+n.height),a=s-r,o=i-t;if(r<s&&t<i){const l=e.width*e.height,c=n.width*n.height,u=a*o,f=u/(l+c-u);return Number(f.toFixed(4))}return 0}const _9=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=n;const s=[];for(const i of r){const{id:a}=i,o=t.get(a);if(o){const l=D0e(o,e);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(I0e)};function P0e(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function A9(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Wa}function M0e(n){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+n*o.y,bottom:a.bottom+n*o.y,left:a.left+n*o.x,right:a.right+n*o.x}),{...t})}}const O0e=M0e(1);function R9(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function N0e(n,e,t){const r=R9(e);if(!r)return n;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=n.left-a-(1-s)*parseFloat(t),c=n.top-o-(1-i)*parseFloat(t.slice(t.indexOf(" ")+1)),u=s?n.width/s:n.width,f=i?n.height/i:n.height;return{width:u,height:f,top:c,right:l+u,bottom:c+f,left:l}}const j0e={ignoreTransform:!1};function i0(n,e){e===void 0&&(e=j0e);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:u}=Ks(n).getComputedStyle(n);c&&(t=N0e(t,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=t;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function $$(n){return i0(n,{ignoreTransform:!0})}function F0e(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function U0e(n,e){return e===void 0&&(e=Ks(n).getComputedStyle(n)),e.position==="fixed"}function $0e(n,e){e===void 0&&(e=Ks(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=e[s];return typeof i=="string"?t.test(i):!1})}function KD(n,e){const t=[];function r(s){if(e!=null&&t.length>=e||!s)return t;if(qD(s)&&s.scrollingElement!=null&&!t.includes(s.scrollingElement))return t.push(s.scrollingElement),t;if(!r0(s)||E9(s)||t.includes(s))return t;const i=Ks(n).getComputedStyle(s);return s!==n&&$0e(s,i)&&t.push(s),U0e(s,i)?t:r(s.parentNode)}return n?r(n):t}function C9(n){const[e]=KD(n,1);return e??null}function gA(n){return!TS||!n?null:dm(n)?n:GD(n)?qD(n)||n===hm(n).scrollingElement?window:r0(n)?n:null:null}function k9(n){return dm(n)?n.scrollX:n.scrollLeft}function I9(n){return dm(n)?n.scrollY:n.scrollTop}function mk(n){return{x:k9(n),y:I9(n)}}var ns;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(ns||(ns={}));function L9(n){return!TS||!n?!1:n===document.scrollingElement}function D9(n){const e={x:0,y:0},t=L9(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},r={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},s=n.scrollTop<=e.y,i=n.scrollLeft<=e.x,a=n.scrollTop>=r.y,o=n.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:e}}const B0e={x:.2,y:.2};function H0e(n,e,t,r,s){let{top:i,left:a,right:o,bottom:l}=t;r===void 0&&(r=10),s===void 0&&(s=B0e);const{isTop:c,isBottom:u,isLeft:f,isRight:m}=D9(n),g={x:0,y:0},y={x:0,y:0},b={height:e.height*s.y,width:e.width*s.x};return!c&&i<=e.top+b.height?(g.y=ns.Backward,y.y=r*Math.abs((e.top+b.height-i)/b.height)):!u&&l>=e.bottom-b.height&&(g.y=ns.Forward,y.y=r*Math.abs((e.bottom-b.height-l)/b.height)),!m&&o>=e.right-b.width?(g.x=ns.Forward,y.x=r*Math.abs((e.right-b.width-o)/b.width)):!f&&a<=e.left+b.width&&(g.x=ns.Backward,y.x=r*Math.abs((e.left+b.width-a)/b.width)),{direction:g,speed:y}}function V0e(n){if(n===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:e,left:t,right:r,bottom:s}=n.getBoundingClientRect();return{top:e,left:t,right:r,bottom:s,width:n.clientWidth,height:n.clientHeight}}function P9(n){return n.reduce((e,t)=>Cf(e,mk(t)),Wa)}function z0e(n){return n.reduce((e,t)=>e+k9(t),0)}function G0e(n){return n.reduce((e,t)=>e+I9(t),0)}function M9(n,e){if(e===void 0&&(e=i0),!n)return;const{top:t,left:r,bottom:s,right:i}=e(n);C9(n)&&(s<=0||i<=0||t>=window.innerHeight||r>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const q0e=[["x",["left","right"],z0e],["y",["top","bottom"],G0e]];class YD{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=KD(t),s=P9(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,a,o]of q0e)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class vg{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...t)})},this.target=e}add(e,t,r){var s;(s=this.target)==null||s.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function W0e(n){const{EventTarget:e}=Ks(n);return n instanceof e?n:hm(n)}function vA(n,e){const t=Math.abs(n.x),r=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+r**2)>e:"x"in e&&"y"in e?t>e.x&&r>e.y:"x"in e?t>e.x:"y"in e?r>e.y:!1}var aa;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(aa||(aa={}));function B$(n){n.preventDefault()}function K0e(n){n.stopPropagation()}var Nn;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(Nn||(Nn={}));const O9={start:[Nn.Space,Nn.Enter],cancel:[Nn.Esc],end:[Nn.Space,Nn.Enter,Nn.Tab]},Y0e=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case Nn.Right:return{...t,x:t.x+25};case Nn.Left:return{...t,x:t.x-25};case Nn.Down:return{...t,y:t.y+25};case Nn.Up:return{...t,y:t.y-25}}};class N9{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new vg(hm(t)),this.windowListeners=new vg(Ks(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(aa.Resize,this.handleCancel),this.windowListeners.add(aa.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(aa.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&M9(r),t(Wa)}handleKeyDown(e){if(WD(e)){const{active:t,context:r,options:s}=this.props,{keyboardCodes:i=O9,coordinateGetter:a=Y0e,scrollBehavior:o="smooth"}=s,{code:l}=e;if(i.end.includes(l)){this.handleEnd(e);return}if(i.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Wa;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(e,{active:t,context:r.current,currentCoordinates:u});if(f){const m=Tw(f,u),g={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const x=e.code,{isTop:S,isRight:T,isLeft:_,isBottom:R,maxScroll:I,minScroll:C}=D9(b),L=V0e(b),k={x:Math.min(x===Nn.Right?L.right-L.width/2:L.right,Math.max(x===Nn.Right?L.left:L.left+L.width/2,f.x)),y:Math.min(x===Nn.Down?L.bottom-L.height/2:L.bottom,Math.max(x===Nn.Down?L.top:L.top+L.height/2,f.y))},M=x===Nn.Right&&!T||x===Nn.Left&&!_,D=x===Nn.Down&&!R||x===Nn.Up&&!S;if(M&&k.x!==f.x){const U=b.scrollLeft+m.x,$=x===Nn.Right&&U<=I.x||x===Nn.Left&&U>=C.x;if($&&!m.y){b.scrollTo({left:U,behavior:o});return}$?g.x=b.scrollLeft-U:g.x=x===Nn.Right?b.scrollLeft-I.x:b.scrollLeft-C.x,g.x&&b.scrollBy({left:-g.x,behavior:o});break}else if(D&&k.y!==f.y){const U=b.scrollTop+m.y,$=x===Nn.Down&&U<=I.y||x===Nn.Up&&U>=C.y;if($&&!m.x){b.scrollTo({top:U,behavior:o});return}$?g.y=b.scrollTop-U:g.y=x===Nn.Down?b.scrollTop-I.y:b.scrollTop-C.y,g.y&&b.scrollBy({top:-g.y,behavior:o});break}}this.handleMove(e,Cf(Tw(f,this.referenceCoordinates),g))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}N9.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:r=O9,onActivation:s}=e,{active:i}=t;const{code:a}=n.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&n.target!==o?!1:(n.preventDefault(),s?.({event:n.nativeEvent}),!0)}return!1}}];function H$(n){return!!(n&&"distance"in n)}function V$(n){return!!(n&&"delay"in n)}class XD{constructor(e,t,r){var s;r===void 0&&(r=W0e(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:a}=i;this.props=e,this.events=t,this.document=hm(a),this.documentListeners=new vg(this.document),this.listeners=new vg(r),this.windowListeners=new vg(Ks(a)),this.initialCoordinates=(s=_w(i))!=null?s:Wa,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(aa.Resize,this.handleCancel),this.windowListeners.add(aa.DragStart,B$),this.windowListeners.add(aa.VisibilityChange,this.handleCancel),this.windowListeners.add(aa.ContextMenu,B$),this.documentListeners.add(aa.Keydown,this.handleKeydown),t){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(V$(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(H$(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(aa.Click,K0e,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(aa.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(t=_w(e))!=null?t:Wa,c=Tw(s,l);if(!r&&o){if(H$(o)){if(o.tolerance!=null&&vA(c,o.tolerance))return this.handleCancel();if(vA(c,o.distance))return this.handleStart()}if(V$(o)&&vA(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}e.cancelable&&e.preventDefault(),a(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Nn.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const X0e={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class j9 extends XD{constructor(e){const{event:t}=e,r=hm(t.target);super(e,X0e,r)}}j9.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return!t.isPrimary||t.button!==0?!1:(r?.({event:t}),!0)}}];const Q0e={move:{name:"mousemove"},end:{name:"mouseup"}};var pk;(function(n){n[n.RightClick=2]="RightClick"})(pk||(pk={}));class F9 extends XD{constructor(e){super(e,Q0e,hm(e.event.target))}}F9.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return t.button===pk.RightClick?!1:(r?.({event:t}),!0)}}];const yA={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class U9 extends XD{constructor(e){super(e,yA)}static setup(){return window.addEventListener(yA.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(yA.move.name,e)};function e(){}}}U9.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;const{touches:s}=t;return s.length>1?!1:(r?.({event:t}),!0)}}];var yg;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(yg||(yg={}));var Rw;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(Rw||(Rw={}));function Z0e(n){let{acceleration:e,activator:t=yg.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=Rw.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:f,threshold:m}=n;const g=eye({delta:f,disabled:!i}),[y,b]=p0e(),x=E.useRef({x:0,y:0}),S=E.useRef({x:0,y:0}),T=E.useMemo(()=>{switch(t){case yg.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case yg.DraggableRect:return s}},[t,s,l]),_=E.useRef(null),R=E.useCallback(()=>{const C=_.current;if(!C)return;const L=x.current.x*S.current.x,k=x.current.y*S.current.y;C.scrollBy(L,k)},[]),I=E.useMemo(()=>o===Rw.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!T){b();return}for(const C of I){if(r?.(C)===!1)continue;const L=c.indexOf(C),k=u[L];if(!k)continue;const{direction:M,speed:D}=H0e(C,k,T,e,m);for(const U of["x","y"])g[U][M[U]]||(D[U]=0,M[U]=0);if(D.x>0||D.y>0){b(),_.current=C,y(R,a),x.current=D,S.current=M;return}}x.current={x:0,y:0},S.current={x:0,y:0},b()},[e,R,r,b,i,a,JSON.stringify(T),JSON.stringify(g),y,c,I,u,JSON.stringify(m)])}const J0e={x:{[ns.Backward]:!1,[ns.Forward]:!1},y:{[ns.Backward]:!1,[ns.Forward]:!1}};function eye(n){let{delta:e,disabled:t}=n;const r=Sw(e);return s0(s=>{if(t||!r||!s)return J0e;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[ns.Backward]:s.x[ns.Backward]||i.x===-1,[ns.Forward]:s.x[ns.Forward]||i.x===1},y:{[ns.Backward]:s.y[ns.Backward]||i.y===-1,[ns.Forward]:s.y[ns.Forward]||i.y===1}}},[t,e,r])}function tye(n,e){const t=e!=null?n.get(e):void 0,r=t?t.node.current:null;return s0(s=>{var i;return e==null?null:(i=r??s)!=null?i:null},[r,e])}function nye(n,e){return E.useMemo(()=>n.reduce((t,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:e(a.handler,r)}));return[...t,...i]},[]),[n,e])}var mv;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(mv||(mv={}));var gk;(function(n){n.Optimized="optimized"})(gk||(gk={}));const z$=new Map;function rye(n,e){let{dragging:t,dependencies:r,config:s}=e;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(n),f=x(),m=fv(f),g=E.useCallback(function(S){S===void 0&&(S=[]),!m.current&&a(T=>T===null?S:T.concat(S.filter(_=>!T.includes(_))))},[m]),y=E.useRef(null),b=s0(S=>{if(f&&!t)return z$;if(!S||S===z$||u.current!==n||i!=null){const T=new Map;for(let _ of n){if(!_)continue;if(i&&i.length>0&&!i.includes(_.id)&&_.rect.current){T.set(_.id,_.rect.current);continue}const R=_.node.current,I=R?new YD(l(R),R):null;_.rect.current=I,I&&T.set(_.id,I)}return T}return S},[n,i,t,f,l]);return E.useEffect(()=>{u.current=n},[n]),E.useEffect(()=>{f||g()},[t,f]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{f||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{g(),y.current=null},o))},[o,f,g,...r]),{droppableRects:b,measureDroppableContainers:g,measuringScheduled:i!=null};function x(){switch(c){case mv.Always:return!1;case mv.BeforeDragging:return t;default:return!t}}}function QD(n,e){return s0(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function sye(n,e){return QD(n,e)}function iye(n){let{callback:e,disabled:t}=n;const r=_S(e),s=E.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,t]);return E.useEffect(()=>()=>s?.disconnect(),[s]),s}function RS(n){let{callback:e,disabled:t}=n;const r=_S(e),s=E.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[t]);return E.useEffect(()=>()=>s?.disconnect(),[s]),s}function aye(n){return new YD(i0(n),n)}function G$(n,e,t){e===void 0&&(e=aye);const[r,s]=E.useState(null);function i(){s(l=>{if(!n)return null;if(n.isConnected===!1){var c;return(c=l??t)!=null?c:null}const u=e(n);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=iye({callback(l){if(n)for(const c of l){const{type:u,target:f}=c;if(u==="childList"&&f instanceof HTMLElement&&f.contains(n)){i();break}}}}),o=RS({callback:i});return Bl(()=>{i(),n?(o?.observe(n),a?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),a?.disconnect())},[n]),r}function oye(n){const e=QD(n);return A9(n,e)}const q$=[];function lye(n){const e=E.useRef(n),t=s0(r=>n?r&&r!==q$&&n&&e.current&&n.parentNode===e.current.parentNode?r:KD(n):q$,[n]);return E.useEffect(()=>{e.current=n},[n]),t}function cye(n){const[e,t]=E.useState(null),r=E.useRef(n),s=E.useCallback(i=>{const a=gA(i.target);a&&t(o=>o?(o.set(a,mk(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(n!==i){a(i);const o=n.map(l=>{const c=gA(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,mk(c)]):null}).filter(l=>l!=null);t(o.length?new Map(o):null),r.current=n}return()=>{a(n),a(i)};function a(o){o.forEach(l=>{const c=gA(l);c?.removeEventListener("scroll",s)})}},[s,n]),E.useMemo(()=>n.length?e?Array.from(e.values()).reduce((i,a)=>Cf(i,a),Wa):P9(n):Wa,[n,e])}function W$(n,e){e===void 0&&(e=[]);const t=E.useRef(null);return E.useEffect(()=>{t.current=null},e),E.useEffect(()=>{const r=n!==Wa;r&&!t.current&&(t.current=n),!r&&t.current&&(t.current=null)},[n]),t.current?Tw(n,t.current):Wa}function uye(n){E.useEffect(()=>{if(!TS)return;const e=n.map(t=>{let{sensor:r}=t;return r.setup==null?void 0:r.setup()});return()=>{for(const t of e)t?.()}},n.map(e=>{let{sensor:t}=e;return t}))}function dye(n,e){return E.useMemo(()=>n.reduce((t,r)=>{let{eventName:s,handler:i}=r;return t[s]=a=>{i(a,e)},t},{}),[n,e])}function $9(n){return E.useMemo(()=>n?F0e(n):null,[n])}const K$=[];function hye(n,e){e===void 0&&(e=i0);const[t]=n,r=$9(t?Ks(t):null),[s,i]=E.useState(K$);function a(){i(()=>n.length?n.map(l=>L9(l)?r:new YD(e(l),l)):K$)}const o=RS({callback:a});return Bl(()=>{o?.disconnect(),a(),n.forEach(l=>o?.observe(l))},[n]),s}function B9(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return r0(e)?e:n}function fye(n){let{measure:e}=n;const[t,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(r0(u)){r(f=>{const m=e(u);return f?{...f,width:m.width,height:m.height}:m});break}},[e]),i=RS({callback:s}),a=E.useCallback(c=>{const u=B9(c);i?.disconnect(),u&&i?.observe(u),r(u?e(u):null)},[e,i]),[o,l]=Ew(a);return E.useMemo(()=>({nodeRef:o,rect:t,setRef:l}),[t,o,l])}const mye=[{sensor:j9,options:{}},{sensor:N9,options:{}}],pye={current:{}},ex={draggable:{measure:$$},droppable:{measure:$$,strategy:mv.WhileDragging,frequency:gk.Optimized},dragOverlay:{measure:i0}};class bg extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return(t=(r=this.get(e))==null?void 0:r.node.current)!=null?t:void 0}}const gye={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new bg,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Aw},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ex,measureDroppableContainers:Aw,windowRect:null,measuringScheduled:!1},H9={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Aw,draggableNodes:new Map,over:null,measureDroppableContainers:Aw},a0=E.createContext(H9),V9=E.createContext(gye);function vye(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new bg}}}function yye(n,e){switch(e.type){case Vr.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Vr.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case Vr.DragEnd:case Vr.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Vr.RegisterDroppable:{const{element:t}=e,{id:r}=t,s=new bg(n.droppable.containers);return s.set(r,t),{...n,droppable:{...n.droppable,containers:s}}}case Vr.SetDroppableDisabled:{const{id:t,key:r,disabled:s}=e,i=n.droppable.containers.get(t);if(!i||r!==i.key)return n;const a=new bg(n.droppable.containers);return a.set(t,{...i,disabled:s}),{...n,droppable:{...n.droppable,containers:a}}}case Vr.UnregisterDroppable:{const{id:t,key:r}=e,s=n.droppable.containers.get(t);if(!s||r!==s.key)return n;const i=new bg(n.droppable.containers);return i.delete(t),{...n,droppable:{...n.droppable,containers:i}}}default:return n}}function bye(n){let{disabled:e}=n;const{active:t,activatorEvent:r,draggableNodes:s}=E.useContext(a0),i=Sw(r),a=Sw(t?.id);return E.useEffect(()=>{if(!e&&!r&&i&&a!=null){if(!WD(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const f=y0e(u);if(f){f.focus();break}}})}},[r,e,s,a,i]),null}function z9(n,e){let{transform:t,...r}=e;return n!=null&&n.length?n.reduce((s,i)=>i({transform:s,...r}),t):t}function xye(n){return E.useMemo(()=>({draggable:{...ex.draggable,...n?.draggable},droppable:{...ex.droppable,...n?.droppable},dragOverlay:{...ex.dragOverlay,...n?.dragOverlay}}),[n?.draggable,n?.droppable,n?.dragOverlay])}function wye(n){let{activeNode:e,measure:t,initialRect:r,config:s=!0}=n;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Bl(()=>{if(!a&&!o||!e){i.current=!1;return}if(i.current||!r)return;const c=e?.node.current;if(!c||c.isConnected===!1)return;const u=t(c),f=A9(u,r);if(a||(f.x=0),o||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=C9(c);m&&m.scrollBy({top:f.y,left:f.x})}},[e,a,o,r,t])}const CS=E.createContext({...Wa,scaleX:1,scaleY:1});var Mc;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Mc||(Mc={}));const Eye=E.memo(function(e){var t,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=mye,collisionDetection:f=_9,measuring:m,modifiers:g,...y}=e;const b=E.useReducer(yye,void 0,vye),[x,S]=b,[T,_]=T0e(),[R,I]=E.useState(Mc.Uninitialized),C=R===Mc.Initialized,{draggable:{active:L,nodes:k,translate:M},droppable:{containers:D}}=x,U=L!=null?k.get(L):null,$=E.useRef({initial:null,translated:null}),V=E.useMemo(()=>{var Lt;return L!=null?{id:L,data:(Lt=U?.data)!=null?Lt:pye,rect:$}:null},[L,U]),B=E.useRef(null),[W,F]=E.useState(null),[j,q]=E.useState(null),H=fv(y,Object.values(y)),N=AS("DndDescribedBy",a),O=E.useMemo(()=>D.getEnabled(),[D]),z=xye(m),{droppableRects:G,measureDroppableContainers:Y,measuringScheduled:Q}=rye(O,{dragging:C,dependencies:[M.x,M.y],config:z.droppable}),J=tye(k,L),ee=E.useMemo(()=>j?_w(j):null,[j]),oe=An(),te=sye(J,z.draggable.measure);wye({activeNode:L!=null?k.get(L):null,config:oe.layoutShiftCompensation,initialRect:te,measure:z.draggable.measure});const se=G$(J,z.draggable.measure,te),he=G$(J?J.parentElement:null),Z=E.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:G,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),pe=D.getNodeFor((t=Z.current.over)==null?void 0:t.id),ye=fye({measure:z.dragOverlay.measure}),ae=(r=ye.nodeRef.current)!=null?r:J,le=C?(s=ye.rect)!=null?s:se:null,ie=!!(ye.nodeRef.current&&ye.rect),fe=oye(ie?null:se),Ie=$9(ae?Ks(ae):null),ne=lye(C?pe??J:null),ce=hye(ne),Ce=z9(g,{transform:{x:M.x-fe.x,y:M.y-fe.y,scaleX:1,scaleY:1},activatorEvent:j,active:V,activeNodeRect:se,containerNodeRect:he,draggingNodeRect:le,over:Z.current.over,overlayNodeRect:ye.rect,scrollableAncestors:ne,scrollableAncestorRects:ce,windowRect:Ie}),Oe=ee?Cf(ee,M):null,ze=cye(ne),We=W$(ze),tt=W$(ze,[se]),lt=Cf(Ce,We),Ee=le?O0e(le,Ce):null,be=V&&Ee?f({active:V,collisionRect:Ee,droppableRects:G,droppableContainers:O,pointerCoordinates:Oe}):null,Ae=L0e(be,"id"),[Me,Ue]=E.useState(null),Ge=ie?Ce:Cf(Ce,tt),Ke=P0e(Ge,(i=Me?.rect)!=null?i:null,se),Qe=E.useRef(null),ht=E.useCallback((Lt,jt)=>{let{sensor:Xt,options:nt}=jt;if(B.current==null)return;const Je=k.get(B.current);if(!Je)return;const ot=Lt.nativeEvent,Dt=new Xt({active:B.current,activeNode:Je,event:ot,options:nt,context:Z,onAbort(Ye){if(!k.get(Ye))return;const{onDragAbort:st}=H.current,wt={id:Ye};st?.(wt),T({type:"onDragAbort",event:wt})},onPending(Ye,Xe,st,wt){if(!k.get(Ye))return;const{onDragPending:At}=H.current,Tt={id:Ye,constraint:Xe,initialCoordinates:st,offset:wt};At?.(Tt),T({type:"onDragPending",event:Tt})},onStart(Ye){const Xe=B.current;if(Xe==null)return;const st=k.get(Xe);if(!st)return;const{onDragStart:wt}=H.current,qt={activatorEvent:ot,active:{id:Xe,data:st.data,rect:$}};Hs.unstable_batchedUpdates(()=>{wt?.(qt),I(Mc.Initializing),S({type:Vr.DragStart,initialCoordinates:Ye,active:Xe}),T({type:"onDragStart",event:qt}),F(Qe.current),q(ot)})},onMove(Ye){S({type:Vr.DragMove,coordinates:Ye})},onEnd:me(Vr.DragEnd),onCancel:me(Vr.DragCancel)});Qe.current=Dt;function me(Ye){return async function(){const{active:st,collisions:wt,over:qt,scrollAdjustedTranslate:At}=Z.current;let Tt=null;if(st&&At){const{cancelDrop:zt}=H.current;Tt={activatorEvent:ot,active:st,collisions:wt,delta:At,over:qt},Ye===Vr.DragEnd&&typeof zt=="function"&&await Promise.resolve(zt(Tt))&&(Ye=Vr.DragCancel)}B.current=null,Hs.unstable_batchedUpdates(()=>{S({type:Ye}),I(Mc.Uninitialized),Ue(null),F(null),q(null),Qe.current=null;const zt=Ye===Vr.DragEnd?"onDragEnd":"onDragCancel";if(Tt){const Mn=H.current[zt];Mn?.(Tt),T({type:zt,event:Tt})}})}}},[k]),Vt=E.useCallback((Lt,jt)=>(Xt,nt)=>{const Je=Xt.nativeEvent,ot=k.get(nt);if(B.current!==null||!ot||Je.dndKit||Je.defaultPrevented)return;const Dt={active:ot};Lt(Xt,jt.options,Dt)===!0&&(Je.dndKit={capturedBy:jt.sensor},B.current=nt,ht(Xt,jt))},[k,ht]),mn=nye(u,Vt);uye(u),Bl(()=>{se&&R===Mc.Initializing&&I(Mc.Initialized)},[se,R]),E.useEffect(()=>{const{onDragMove:Lt}=H.current,{active:jt,activatorEvent:Xt,collisions:nt,over:Je}=Z.current;if(!jt||!Xt)return;const ot={active:jt,activatorEvent:Xt,collisions:nt,delta:{x:lt.x,y:lt.y},over:Je};Hs.unstable_batchedUpdates(()=>{Lt?.(ot),T({type:"onDragMove",event:ot})})},[lt.x,lt.y]),E.useEffect(()=>{const{active:Lt,activatorEvent:jt,collisions:Xt,droppableContainers:nt,scrollAdjustedTranslate:Je}=Z.current;if(!Lt||B.current==null||!jt||!Je)return;const{onDragOver:ot}=H.current,Dt=nt.get(Ae),me=Dt&&Dt.rect.current?{id:Dt.id,rect:Dt.rect.current,data:Dt.data,disabled:Dt.disabled}:null,Ye={active:Lt,activatorEvent:jt,collisions:Xt,delta:{x:Je.x,y:Je.y},over:me};Hs.unstable_batchedUpdates(()=>{Ue(me),ot?.(Ye),T({type:"onDragOver",event:Ye})})},[Ae]),Bl(()=>{Z.current={activatorEvent:j,active:V,activeNode:J,collisionRect:Ee,collisions:be,droppableRects:G,draggableNodes:k,draggingNode:ae,draggingNodeRect:le,droppableContainers:D,over:Me,scrollableAncestors:ne,scrollAdjustedTranslate:lt},$.current={initial:le,translated:Ee}},[V,J,be,Ee,k,ae,le,G,D,Me,ne,lt]),Z0e({...oe,delta:M,draggingRect:Ee,pointerCoordinates:Oe,scrollableAncestors:ne,scrollableAncestorRects:ce});const xn=E.useMemo(()=>({active:V,activeNode:J,activeNodeRect:se,activatorEvent:j,collisions:be,containerNodeRect:he,dragOverlay:ye,draggableNodes:k,droppableContainers:D,droppableRects:G,over:Me,measureDroppableContainers:Y,scrollableAncestors:ne,scrollableAncestorRects:ce,measuringConfiguration:z,measuringScheduled:Q,windowRect:Ie}),[V,J,se,j,be,he,ye,k,D,G,Me,Y,ne,ce,z,Q,Ie]),Bn=E.useMemo(()=>({activatorEvent:j,activators:mn,active:V,activeNodeRect:se,ariaDescribedById:{draggable:N},dispatch:S,draggableNodes:k,over:Me,measureDroppableContainers:Y}),[j,mn,V,se,S,N,k,Me,Y]);return ve.createElement(T9.Provider,{value:_},ve.createElement(a0.Provider,{value:Bn},ve.createElement(V9.Provider,{value:xn},ve.createElement(CS.Provider,{value:Ke},c)),ve.createElement(bye,{disabled:o?.restoreFocus===!1})),ve.createElement(R0e,{...o,hiddenTextDescribedById:N}));function An(){const Lt=W?.autoScrollEnabled===!1,jt=typeof l=="object"?l.enabled===!1:l===!1,Xt=C&&!Lt&&!jt;return typeof l=="object"?{...l,enabled:Xt}:{enabled:Xt}}}),Sye=E.createContext(null),Y$="button",Tye="Draggable";function _ye(n){let{id:e,data:t,disabled:r=!1,attributes:s}=n;const i=AS(Tye),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:f,over:m}=E.useContext(a0),{role:g=Y$,roleDescription:y="draggable",tabIndex:b=0}=s??{},x=l?.id===e,S=E.useContext(x?CS:Sye),[T,_]=Ew(),[R,I]=Ew(),C=dye(a,e),L=fv(t);Bl(()=>(f.set(e,{id:e,key:i,node:T,activatorNode:R,data:L}),()=>{const M=f.get(e);M&&M.key===i&&f.delete(e)}),[f,e]);const k=E.useMemo(()=>({role:g,tabIndex:b,"aria-disabled":r,"aria-pressed":x&&g===Y$?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,g,b,x,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:k,isDragging:x,listeners:r?void 0:C,node:T,over:m,setNodeRef:_,setActivatorNodeRef:I,transform:S}}function Aye(){return E.useContext(V9)}const Rye="Droppable",Cye={timeout:25};function kye(n){let{data:e,disabled:t=!1,id:r,resizeObserverConfig:s}=n;const i=AS(Rye),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(a0),u=E.useRef({disabled:t}),f=E.useRef(!1),m=E.useRef(null),g=E.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:x}={...Cye,...s},S=fv(b??r),T=E.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{c(Array.isArray(S.current)?S.current:[S.current]),g.current=null},x)},[x]),_=RS({callback:T,disabled:y||!a}),R=E.useCallback((k,M)=>{_&&(M&&(_.unobserve(M),f.current=!1),k&&_.observe(k))},[_]),[I,C]=Ew(R),L=fv(e);return E.useEffect(()=>{!_||!I.current||(_.disconnect(),f.current=!1,_.observe(I.current))},[I,_]),E.useEffect(()=>(o({type:Vr.RegisterDroppable,element:{id:r,key:i,disabled:t,node:I,rect:m,data:L}}),()=>o({type:Vr.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{t!==u.current.disabled&&(o({type:Vr.SetDroppableDisabled,id:r,key:i,disabled:t}),u.current.disabled=t)},[r,i,t,o]),{active:a,rect:m,isOver:l?.id===r,node:I,over:l,setNodeRef:C}}function Iye(n){let{animation:e,children:t}=n;const[r,s]=E.useState(null),[i,a]=E.useState(null),o=Sw(t);return!t&&!r&&o&&s(o),Bl(()=>{if(!i)return;const l=r?.key,c=r?.props.id;if(l==null||c==null){s(null);return}Promise.resolve(e(c,i)).then(()=>{s(null)})},[e,r,i]),ve.createElement(ve.Fragment,null,t,r?E.cloneElement(r,{ref:a}):null)}const Lye={x:0,y:0,scaleX:1,scaleY:1};function Dye(n){let{children:e}=n;return ve.createElement(a0.Provider,{value:H9},ve.createElement(CS.Provider,{value:Lye},e))}const Pye={position:"fixed",touchAction:"none"},Mye=n=>WD(n)?"transform 250ms ease":void 0,Oye=E.forwardRef((n,e)=>{let{as:t,activatorEvent:r,adjustScale:s,children:i,className:a,rect:o,style:l,transform:c,transition:u=Mye}=n;if(!o)return null;const f=s?c:{...c,scaleX:1,scaleY:1},m={...Pye,width:o.width,height:o.height,top:o.top,left:o.left,transform:qf.Transform.toString(f),transformOrigin:s&&r?k0e(r,o):void 0,transition:typeof u=="function"?u(r):u,...l};return ve.createElement(t,{className:a,style:m,ref:e},i)}),Nye=n=>e=>{let{active:t,dragOverlay:r}=e;const s={},{styles:i,className:a}=n;if(i!=null&&i.active)for(const[o,l]of Object.entries(i.active))l!==void 0&&(s[o]=t.node.style.getPropertyValue(o),t.node.style.setProperty(o,l));if(i!=null&&i.dragOverlay)for(const[o,l]of Object.entries(i.dragOverlay))l!==void 0&&r.node.style.setProperty(o,l);return a!=null&&a.active&&t.node.classList.add(a.active),a!=null&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[l,c]of Object.entries(s))t.node.style.setProperty(l,c);a!=null&&a.active&&t.node.classList.remove(a.active)}},jye=n=>{let{transform:{initial:e,final:t}}=n;return[{transform:qf.Transform.toString(e)},{transform:qf.Transform.toString(t)}]},Fye={duration:250,easing:"ease",keyframes:jye,sideEffects:Nye({styles:{active:{opacity:"0"}}})};function Uye(n){let{config:e,draggableNodes:t,droppableContainers:r,measuringConfiguration:s}=n;return _S((i,a)=>{if(e===null)return;const o=t.get(i);if(!o)return;const l=o.node.current;if(!l)return;const c=B9(a);if(!c)return;const{transform:u}=Ks(a).getComputedStyle(a),f=R9(u);if(!f)return;const m=typeof e=="function"?e:$ye(e);return M9(l,s.draggable.measure),m({active:{id:i,data:o.data,node:l,rect:s.draggable.measure(l)},draggableNodes:t,dragOverlay:{node:a,rect:s.dragOverlay.measure(c)},droppableContainers:r,measuringConfiguration:s,transform:f})})}function $ye(n){const{duration:e,easing:t,sideEffects:r,keyframes:s}={...Fye,...n};return i=>{let{active:a,dragOverlay:o,transform:l,...c}=i;if(!e)return;const u={x:o.rect.left-a.rect.left,y:o.rect.top-a.rect.top},f={scaleX:l.scaleX!==1?a.rect.width*l.scaleX/o.rect.width:1,scaleY:l.scaleY!==1?a.rect.height*l.scaleY/o.rect.height:1},m={x:l.x-u.x,y:l.y-u.y,...f},g=s({...c,active:a,dragOverlay:o,transform:{initial:l,final:m}}),[y]=g,b=g[g.length-1];if(JSON.stringify(y)===JSON.stringify(b))return;const x=r?.({active:a,dragOverlay:o,...c}),S=o.node.animate(g,{duration:e,easing:t,fill:"forwards"});return new Promise(T=>{S.onfinish=()=>{x?.(),T()}})}}let X$=0;function Bye(n){return E.useMemo(()=>{if(n!=null)return X$++,X$},[n])}const Hye=ve.memo(n=>{let{adjustScale:e=!1,children:t,dropAnimation:r,style:s,transition:i,modifiers:a,wrapperElement:o="div",className:l,zIndex:c=999}=n;const{activatorEvent:u,active:f,activeNodeRect:m,containerNodeRect:g,draggableNodes:y,droppableContainers:b,dragOverlay:x,over:S,measuringConfiguration:T,scrollableAncestors:_,scrollableAncestorRects:R,windowRect:I}=Aye(),C=E.useContext(CS),L=Bye(f?.id),k=z9(a,{activatorEvent:u,active:f,activeNodeRect:m,containerNodeRect:g,draggingNodeRect:x.rect,over:S,overlayNodeRect:x.rect,scrollableAncestors:_,scrollableAncestorRects:R,transform:C,windowRect:I}),M=QD(m),D=Uye({config:r,draggableNodes:y,droppableContainers:b,measuringConfiguration:T}),U=M?x.setRef:void 0;return ve.createElement(Dye,null,ve.createElement(Iye,{animation:D},f&&L?ve.createElement(Oye,{key:L,id:f.id,ref:U,as:o,activatorEvent:u,adjustScale:e,className:l,transition:i,rect:M,style:{zIndex:c,...s},transform:k},t):null))}),Vye=({flask:n,onDelete:e,availableTags:t,onTagUpdate:r,isDragging:s,isDragOver:i})=>{const{attributes:a,listeners:o,setNodeRef:l,transform:c}=_ye({id:n.id,data:n}),{setNodeRef:u}=kye({id:n.id,data:n}),f={transform:qf.Translate.toString(c),opacity:s?0:1},m=g=>{l(g),u(g)};return d.jsx("div",{ref:m,style:f,...a,...o,className:je(s?"cursor-grabbing":"cursor-grab","transition-all duration-200",i&&!s&&"ring-2 ring-white ring-opacity-50 rounded-3xl scale-105"),children:d.jsx(fk,{flask:n,onDelete:e,availableTags:t,onTagUpdate:r})})},zye=({isOpen:n,onClose:e,onConfirm:t,flaskName:r,isDeleting:s=!1})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:[d.jsx(rv,{className:"h-5 w-5 text-destructive"}),"Delete Flask"]}),d.jsxs(zl,{className:"pt-4",children:["Are you sure you want to delete ",d.jsxs("strong",{children:['"',r,'"']}),"?",d.jsx("br",{}),d.jsx("br",{}),"This action cannot be undone. All content, annotations, and associated data will be permanently deleted."]})]}),d.jsxs(ys,{className:"pt-6",children:[d.jsx(dt,{variant:"outline",onClick:e,disabled:s,children:"Cancel"}),d.jsx(dt,{variant:"destructive",onClick:t,disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"animate-spin h-4 w-4 mr-2",children:""}),"Deleting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(rv,{className:"h-4 w-4 mr-2"}),"Delete Flask"]})})]})]})}),G9=({isOpen:n,onClose:e,onConfirm:t,tagName:r,isDeleting:s=!1})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:[d.jsx($C,{className:"h-5 w-5 text-destructive"}),"Delete Tag"]}),d.jsxs(zl,{className:"pt-4",children:["Are you sure you want to delete ",d.jsxs("strong",{children:['"',r,'"']}),"?",d.jsx("br",{}),d.jsx("br",{}),"All flasks with this tag will lose it. This action cannot be undone."]})]}),d.jsxs(ys,{className:"pt-6",children:[d.jsx(dt,{variant:"outline",onClick:e,disabled:s,children:"Cancel"}),d.jsx(dt,{variant:"destructive",onClick:t,disabled:s,children:s?"Deleting...":"Delete Tag"})]})]})}),Gye=({isOpen:n,onClose:e,onConfirm:t,sourceFlask:r,targetFlask:s,isMerging:i,isProTeam:a=!1})=>{const o=Jn();if(!r||!s)return null;const l=()=>{e(),o("/#pricing")};return d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[500px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:["Move Assets to ",s.name]}),d.jsxs(zl,{className:"pt-4 space-y-4",children:[a?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[d.jsxs("div",{className:"w-full bg-element-background/50 rounded-lg p-4",children:[d.jsx("div",{className:"text-sm font-medium text-text-primary truncate mb-2",children:r.name}),r.assets&&r.assets.length>0&&d.jsxs("div",{className:"flex gap-2 overflow-x-auto mb-2",children:[r.assets.slice(0,3).map((c,u)=>d.jsx("div",{className:"relative w-16 h-16 flex-shrink-0 rounded overflow-hidden bg-black/20",children:d.jsx(ww,{assets:[c],className:"absolute inset-0 w-full h-full object-cover"})},c.id||u)),r.assets.length>3&&d.jsxs("div",{className:"w-16 h-16 flex-shrink-0 rounded bg-black/40 flex items-center justify-center text-xs text-text-secondary",children:["+",r.assets.length-3]})]}),d.jsxs("div",{className:"text-xs text-text-secondary",children:[r.assetCount||0," assets"]})]}),d.jsx("div",{className:"flex items-center justify-center",children:d.jsx(Vce,{className:"h-5 w-5 text-text-secondary"})}),d.jsxs("div",{className:"w-full bg-element-background/50 rounded-lg p-4 border border-text-primary",children:[d.jsx("div",{className:"text-sm font-medium text-text-primary truncate mb-2",children:s.name}),s.assets&&s.assets.length>0&&d.jsxs("div",{className:"flex gap-2 overflow-x-auto mb-2",children:[s.assets.slice(0,3).map((c,u)=>d.jsx("div",{className:"relative w-16 h-16 flex-shrink-0 rounded overflow-hidden bg-black/20",children:d.jsx(ww,{assets:[c],className:"absolute inset-0 w-full h-full object-cover"})},c.id||u)),s.assets.length>3&&d.jsxs("div",{className:"w-16 h-16 flex-shrink-0 rounded bg-black/40 flex items-center justify-center text-xs text-text-secondary",children:["+",s.assets.length-3]})]}),d.jsxs("div",{className:"text-xs text-text-secondary",children:[s.assetCount||0," assets"]})]})]}),d.jsx("div",{className:"space-y-2 text-sm",children:d.jsxs("div",{className:"text-sm text-text-secondary",children:["All assets, notes and recordings from the Flask"," ",d.jsx("span",{className:"text-text-primary",children:r.name})," ","will be moved into the Flask"," ",d.jsx("span",{className:"text-text-primary",children:s.name}),"."]})})]}):d.jsx("div",{className:" py-2 space-y-4",children:d.jsx("div",{className:"text-sm text-text-primary font-medium",children:"Upgrade to Flask Pro to add multiple assets to a Flask."})}),d.jsx(hk,{children:"You can use this feature to have multiple versions and revisions of the same project into a single Flask."})]})]}),d.jsx(ys,{className:"mt-6",children:a?d.jsxs(d.Fragment,{children:[d.jsx(dt,{variant:"ghost",onClick:e,disabled:i,children:"Cancel"}),d.jsx(dt,{onClick:t,disabled:i,className:"min-w-[120px] font-semibold",children:i?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"mr-2 h-4 w-4 animate-spin"}),"Moving..."]}):`Move ${r.assetCount||0} Assets`})]}):d.jsxs(d.Fragment,{children:[d.jsx(dt,{variant:"ghost",onClick:e,children:"Cancel"}),d.jsx(dt,{onClick:l,className:" font-semibold",children:"Upgrade"})]})})]})})},Q$=()=>{const{user:n,isInitialized:e}=Ar(),t=Jn();zv(n?.id);const r=Ft(Z=>Z.currentTeam),s=Ft(Z=>Z.flasks),i=Ft(Z=>Z.tags),a=Ft(Z=>Z.flaskFilter.tagId),o=Ft(Z=>Z.flaskFilter.searchTerm),l=Ft(Z=>Z.skeleton.showFlaskGrid),c=Ft(Z=>Z.updateFlaskTagOptimistic),u=Ft(Z=>Z.deleteTagOptimistic),f=Ft(Z=>Z.deleteFlaskOptimistic),m=Ft(Z=>Z.setFlasks),[g,y]=E.useState(!1),[b,x]=E.useState(null),[S,T]=E.useState(null),[_,R]=E.useState(!1),[I,C]=E.useState(!1),[L,k]=E.useState(null),[M,D]=E.useState(null),[U,$]=E.useState(!1),[V,B]=E.useState(null),[W,F]=E.useState(null),[j,q]=E.useState(!1),H=E.useMemo(()=>{let Z=s;if(a&&(Z=Z.filter(pe=>pe.flask_tag?.id===a)),o){const pe=o.toLowerCase();Z=Z.filter(ye=>ye.name.toLowerCase().includes(pe))}return[...Z].sort((pe,ye)=>{const ae=fe=>{let Ie=new Date(fe.updated_at||fe.created_at||0).getTime();if(fe.assets&&fe.assets.length>0){const ne=fe.assets.map(Oe=>Oe.updated_at).filter(Boolean).map(Oe=>Math.floor(new Date(Oe).getTime()/6e4));if(new Set(ne).size===1&&fe.assets.length>0){const Oe=Math.max(...fe.assets.map(ze=>new Date(ze.created_at||0).getTime()));Ie=Math.max(Ie,Oe)}else{const Oe=Math.max(...fe.assets.map(ze=>new Date(ze.updated_at||ze.created_at||0).getTime()));Ie=Math.max(Ie,Oe)}}return Ie},le=ae(pe);return ae(ye)-le})},[s,a,o]),N=E.useCallback(async(Z,pe)=>{await c(Z,pe)},[c]),O=E.useCallback((Z,pe)=>{x({id:Z,name:pe}),y(!0)},[]),z=E.useCallback(async()=>{b&&(C(!0),await f(b.id),C(!1),y(!1),x(null))},[b,f]),G=E.useCallback(async()=>{S&&(C(!0),await u(S.id),C(!1),R(!1),T(null))},[S,u]);ve.useEffect(()=>()=>{document.body.style.cursor=""},[]);const Y=C0e(U$(F9,{activationConstraint:{distance:10}}),U$(U9,{activationConstraint:{delay:250,tolerance:5}})),Q=Z=>{k(Z.active.id),document.body.style.cursor="grabbing"},J=Z=>{const pe=Z.over?.id;D(pe&&pe!==L?pe:null)},ee=Z=>{const{active:pe,over:ye}=Z;if(k(null),D(null),document.body.style.cursor="",!ye||pe.id===ye.id)return;const ae=H.find(ie=>ie.id===pe.id),le=H.find(ie=>ie.id===ye.id);if(ae&&le){const ie={...ae,assetCount:ae.assets?.length||0,elementCount:ae.element_count||0,assets:ae.assets||[]},fe={...le,assetCount:le.assets?.length||0,elementCount:le.element_count||0,assets:le.assets||[]};B(ie),F(fe),$(!0)}},oe=E.useCallback(async()=>{if(!(!V||!W)){q(!0);try{const Z=await Ht(`/api/flasks/${W.id}/merge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceFlaskId:V.id})});if(!Z.ok){const le=await Z.json();throw new Error(le.error||"Failed to merge flasks")}const pe=await Z.json(),ae=Ft.getState().flasks.filter(le=>le.id!==V.id);m(ae),et.success(pe.message||"Flasks merged successfully"),$(!1),B(null),F(null),t(`/flask/${W.id}`)}catch(Z){console.error("Error merging flasks:",Z),et.error(Z instanceof Error?Z.message:"Failed to merge flasks")}finally{q(!1)}}},[V,W,m,t]),te=()=>{k(null),D(null),document.body.style.cursor=""},se=E.useMemo(()=>H.find(Z=>Z.id===L),[H,L]),he=E.useMemo(()=>{const Z=H.length,pe=18,ye=[];H.forEach(le=>{ye.push({type:"flask",id:le.id,data:le,key:le.id})});const ae=pe-Z;for(let le=0;le<ae;le++)ye.push({type:"placeholder",id:`placeholder-${le}`,data:null,key:`placeholder-${le}`,showEmptyState:Z===0&&le===0,isLoading:l});return ye},[H,l]);return!n&&e?d.jsx("div",{className:"space-y-6",children:d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 xl:grid-cols-3 gap-2 md:gap-4",children:d.jsx("div",{className:"bg-gradient-to-tr from-element-background/50 to-transparent border border-border/20 rounded-xl aspect-[4/3] flex items-center justify-center",children:d.jsxs("div",{className:"flex flex-col items-center text-text-primary pointer-events-none",children:[d.jsx("p",{className:"text-lg mb-2 text-center",children:"No Flasks yet "}),d.jsx("p",{className:"text-xs text-text-secondary text-center px-4",children:"Sign in to create your first Flask"})]})})})}):d.jsxs(d.Fragment,{children:[d.jsxs(Eye,{sensors:Y,onDragStart:Q,onDragOver:J,onDragEnd:ee,onDragCancel:te,collisionDetection:_9,children:[d.jsx("div",{className:"space-y-6",children:d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 xl:grid-cols-3 gap-2 md:gap-4 relative",children:he.map(Z=>{if(Z.type==="flask")return d.jsx(Vye,{flask:Z.data,onDelete:O,availableTags:i||[],onTagUpdate:N,isDragging:L===Z.data.id,isDragOver:M===Z.data.id},Z.key);{const pe={id:Z.id,name:"",created_at:"",updated_at:"",assets:[],element_count:0,flask_tag:null,user_id:"",access_level:"private"};return d.jsx(fk,{flask:pe,onDelete:()=>{},availableTags:[],onTagUpdate:()=>{},isPlaceholder:!0,showEmptyState:Z.showEmptyState,isLoading:Z.isLoading},Z.key)}})})}),d.jsx(Hye,{children:se?d.jsx("div",{className:"opacity-90 cursor-grabbing",children:d.jsx(fk,{flask:se,onDelete:()=>{},availableTags:[],onTagUpdate:()=>{}})}):null})]}),b&&d.jsx(zye,{isOpen:g,onClose:()=>{y(!1),x(null)},onConfirm:z,flaskName:b.name,isDeleting:I}),S&&d.jsx(G9,{isOpen:_,onClose:()=>{R(!1),T(null)},onConfirm:G,tagName:S.name,isDeleting:I}),d.jsx(Gye,{isOpen:U,onClose:()=>{$(!1),B(null),F(null)},onConfirm:oe,sourceFlask:V,targetFlask:W,isMerging:j,isProTeam:r?.team_type==="pro_team"})]})},qye=({onTeamChange:n})=>{const e=Jn(),{user:t}=Ar(),[r,s]=Cd();zv(t?.id);const i=Ft(m=>m.currentTeam),a=Ft(m=>m.userTeams),o=Ft(m=>m.isLoadingTeams),l=Ft(m=>m.switchTeam),c=async m=>{await l(m);const g=a.find(y=>y.id===m);n&&g&&n({id:g.id,name:g.name})},u=()=>{e("/#pricing")},f=()=>{const m=new URLSearchParams(r);m.set("settings","team"),s(m)};return d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"group w-full bg-card-background border-b border-border/70 rounded-2xl overflow-hidden flex items-center hover:opacity-80 transition-all duration-200",children:[d.jsxs(Gs,{children:[d.jsx(qs,{asChild:!0,children:d.jsx("div",{className:"flex-1 py-3 px-5 min-w-0 overflow-hidden cursor-pointer",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex flex-col min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-foreground truncate",children:i?i.name:"Select Team"}),d.jsx("div",{className:"text-xs text-text-secondary",children:i&&d.jsx("span",{children:i.team_type==="pro_team"?"Pro Team":"Free Team"})})]}),d.jsx("div",{className:"flex items-center ml-4",children:d.jsx(ZV,{className:"h-4 w-4 text-text-secondary"})})]})})}),d.jsxs(Ms,{align:"start",className:"w-full min-w-[var(--radix-dropdown-menu-trigger-width)]",children:[d.jsxs(Pn,{onClick:f,className:"cursor-pointer py-3 px-4",children:[d.jsx(A3,{className:"h-4 w-4 mr-2"}),"Team Settings"]}),d.jsx(uv,{}),d.jsx("div",{className:"px-4 py-2",children:d.jsx("div",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Switch Team"})}),o?d.jsx(Pn,{disabled:!0,className:"py-3 px-4",children:"Loading teams..."}):a.length===0?d.jsx(Pn,{disabled:!0,className:"py-3 px-4",children:"No teams found"}):a.map(m=>d.jsxs(Pn,{onClick:()=>c(m.id),className:"flex items-center justify-between cursor-pointer py-3 px-4",children:[d.jsxs("div",{className:"flex flex-col min-w-0 flex-1 mr-3",children:[d.jsx("span",{className:"font-medium truncate",children:m.name}),d.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:d.jsx("span",{children:m.team_type==="pro_team"?"Pro Team":"Free Team"})})]}),i?.id===m.id&&d.jsx(is,{className:"h-4 w-4 text-primary"})]},m.id)),d.jsx(uv,{}),d.jsxs(Pn,{onClick:u,className:"cursor-pointer py-3 px-4",children:[d.jsx(Jc,{className:"h-4 w-4 mr-2"}),"Create New Team"]})]})]}),d.jsx(dt,{variant:"ghost",size:"icon",onClick:f,className:"h-8 w-8 hover:bg-card-background rounded-lg transition-colors mr-2",children:d.jsx(A3,{className:"h-4 w-4 text-muted-foreground"})})]})})};function Wye({topLeftCornerRadius:n,topRightCornerRadius:e,bottomRightCornerRadius:t,bottomLeftCornerRadius:r,width:s,height:i}){const a={topLeft:-1,topRight:-1,bottomLeft:-1,bottomRight:-1},o={topLeft:n,topRight:e,bottomLeft:r,bottomRight:t};return Object.entries(o).sort(([,l],[,c])=>c-l).forEach(([l,c])=>{const u=l,f=Kye[u],m=Math.min(...f.map(g=>{const y=o[g.corner];if(c===0&&y===0)return 0;const b=a[g.corner],x=g.side==="top"||g.side==="bottom"?s:i;return b>=0?x-a[g.corner]:c/(c+y)*x}));a[u]=m,o[u]=Math.min(c,m)}),{topLeft:{radius:o.topLeft,roundingAndSmoothingBudget:a.topLeft},topRight:{radius:o.topRight,roundingAndSmoothingBudget:a.topRight},bottomLeft:{radius:o.bottomLeft,roundingAndSmoothingBudget:a.bottomLeft},bottomRight:{radius:o.bottomRight,roundingAndSmoothingBudget:a.bottomRight}}}const Kye={topLeft:[{corner:"topRight",side:"top"},{corner:"bottomLeft",side:"left"}],topRight:[{corner:"topLeft",side:"top"},{corner:"bottomRight",side:"right"}],bottomLeft:[{corner:"bottomRight",side:"bottom"},{corner:"topLeft",side:"left"}],bottomRight:[{corner:"bottomLeft",side:"bottom"},{corner:"topRight",side:"right"}]};function Cp({cornerRadius:n,cornerSmoothing:e,preserveSmoothing:t,roundingAndSmoothingBudget:r}){let s=(1+e)*n;if(!t){const y=r/n-1;e=Math.min(e,y),s=Math.min(s,r)}const i=90*(1-e),a=Math.sin(rb(i/2))*n*Math.sqrt(2),o=(90-i)/2,l=n*Math.tan(rb(o/2)),c=45*e,u=l*Math.cos(rb(c)),f=u*Math.tan(rb(c));let m=(s-a-u-f)/3,g=2*m;if(t&&s>r){const y=r-f-a-u,b=y/6,x=y-b;m=Math.min(m,x),g=y-m,s=Math.min(s,r)}return{a:g,b:m,c:u,d:f,p:s,arcSectionLength:a,cornerRadius:n}}function Z$({width:n,height:e,topLeftPathParams:t,topRightPathParams:r,bottomLeftPathParams:s,bottomRightPathParams:i}){return`
    M ${n-r.p} 0
    ${Yye(r)}
    L ${n} ${e-i.p}
    ${Xye(i)}
    L ${s.p} ${e}
    ${Qye(s)}
    L 0 ${t.p}
    ${Zye(t)}
    Z
  `.replace(/[\t\s\n]+/g," ").trim()}function Yye({cornerRadius:n,a:e,b:t,c:r,d:s,p:i,arcSectionLength:a}){return n?su`
    c ${e} 0 ${e+t} 0 ${e+t+r} ${s}
    a ${n} ${n} 0 0 1 ${a} ${a}
    c ${s} ${r}
        ${s} ${t+r}
        ${s} ${e+t+r}`:su`l ${i} 0`}function Xye({cornerRadius:n,a:e,b:t,c:r,d:s,p:i,arcSectionLength:a}){return n?su`
    c 0 ${e}
      0 ${e+t}
      ${-s} ${e+t+r}
    a ${n} ${n} 0 0 1 -${a} ${a}
    c ${-r} ${s}
      ${-(t+r)} ${s}
      ${-(e+t+r)} ${s}`:su`l 0 ${i}`}function Qye({cornerRadius:n,a:e,b:t,c:r,d:s,p:i,arcSectionLength:a}){return n?su`
    c ${-e} 0
      ${-(e+t)} 0
      ${-(e+t+r)} ${-s}
    a ${n} ${n} 0 0 1 -${a} -${a}
    c ${-s} ${-r}
      ${-s} ${-(t+r)}
      ${-s} ${-(e+t+r)}`:su`l ${-i} 0`}function Zye({cornerRadius:n,a:e,b:t,c:r,d:s,p:i,arcSectionLength:a}){return n?su`
    c 0 ${-e}
      0 ${-(e+t)}
      ${s} ${-(e+t+r)}
    a ${n} ${n} 0 0 1 ${a} -${a}
    c ${r} ${-s}
      ${t+r} ${-s}
      ${e+t+r} ${-s}`:su`l 0 ${-i}`}function rb(n){return n*Math.PI/180}function su(n,...e){return n.reduce((t,r,s)=>{let i=e[s];return typeof i=="number"?t+r+i.toFixed(4):t+r+(i??"")},"")}function bA({cornerRadius:n=0,topLeftCornerRadius:e,topRightCornerRadius:t,bottomRightCornerRadius:r,bottomLeftCornerRadius:s,cornerSmoothing:i,width:a,height:o,preserveSmoothing:l=!1}){if(e=e??n,t=t??n,s=s??n,r=r??n,e===t&&t===r&&r===s&&s===e){const g=Math.min(a,o)/2,y=Math.min(e,g),b=Cp({cornerRadius:y,cornerSmoothing:i,preserveSmoothing:l,roundingAndSmoothingBudget:g});return Z$({width:a,height:o,topLeftPathParams:b,topRightPathParams:b,bottomLeftPathParams:b,bottomRightPathParams:b})}const{topLeft:c,topRight:u,bottomLeft:f,bottomRight:m}=Wye({topLeftCornerRadius:e,topRightCornerRadius:t,bottomRightCornerRadius:r,bottomLeftCornerRadius:s,width:a,height:o});return Z$({width:a,height:o,topLeftPathParams:Cp({cornerSmoothing:i,preserveSmoothing:l,cornerRadius:c.radius,roundingAndSmoothingBudget:c.roundingAndSmoothingBudget}),topRightPathParams:Cp({cornerSmoothing:i,preserveSmoothing:l,cornerRadius:u.radius,roundingAndSmoothingBudget:u.roundingAndSmoothingBudget}),bottomRightPathParams:Cp({cornerSmoothing:i,preserveSmoothing:l,cornerRadius:m.radius,roundingAndSmoothingBudget:m.roundingAndSmoothingBudget}),bottomLeftPathParams:Cp({cornerSmoothing:i,preserveSmoothing:l,cornerRadius:f.radius,roundingAndSmoothingBudget:f.roundingAndSmoothingBudget})})}const Jye=(n=8)=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<n;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return`squircle-${t}`},ebe=(n,e)=>{let t=document.getElementById(e);t||(t=document.createElement("style"),t.id=e,document.head.appendChild(t)),t.textContent=n},tbe=(n,e,t)=>{const r=n.clientWidth,s=n.clientHeight,i={preserveSmoothing:!0,cornerSmoothing:1,width:r,height:s,...e};e.borderWidth?(n.classList.add(t),ebe(`
        .${t} {
          position: relative;
          clip-path: path('${bA(i)}');
        }

        .${t}::before {
          content: '';
          display: block;
          position: absolute;
          inset: ${e.borderWidth}px;  
          z-index: -1;
          clip-path: path('${bA({...i,width:r-e.borderWidth*2,height:s-e.borderWidth*2,cornerRadius:e.cornerRadius-e.borderWidth})}');
        }
      `,`style-${t}`)):n.style.clipPath=`path('${bA(i)}')`},nbe=(n,e)=>{const t=Jye();let r;const s=a=>(a!==void 0&&(e=a),tbe(n,e,t)),i=new ResizeObserver(()=>{const a=r;r=[n.clientWidth,n.clientHeight],(a?.[0]!==r[0]||a?.[1]!==r[1])&&s()});return i.observe(n),s.disconnect=()=>{n.classList.remove(t),document.querySelector(`#style-${t}`)?.remove(),i.disconnect()},s},rbe=n=>{const e={};for(const t in n)n[t]!==void 0&&(e[t]=n[t]);return e},sbe=E.forwardRef(({children:n,as:e="div",cornerRadius:t,topLeftCornerRadius:r,topRightCornerRadius:s,bottomRightCornerRadius:i,bottomLeftCornerRadius:a,cornerSmoothing:o,preserveSmoothing:l,borderWidth:c,...u},f)=>{const m=E.useRef(),g=E.useCallback(y=>{const b=rbe({cornerRadius:t,topLeftCornerRadius:r,topRightCornerRadius:s,bottomRightCornerRadius:i,bottomLeftCornerRadius:a,cornerSmoothing:o,preserveSmoothing:l,borderWidth:c});m.current?.disconnect(),y&&(m.current=nbe(y,b)),typeof f=="function"?f(y):f&&(f.current=y)},[t,r,s,i,a,o,l,c]);return ve.createElement(e,{ref:g,...u},n)}),kS=ve.forwardRef(({children:n,className:e,cornerRadius:t=12,cornerSmoothing:r=1,preserveSmoothing:s=!0,borderWidth:i,style:a,as:o="div",...l},c)=>d.jsx(sbe,{ref:c,cornerRadius:t,cornerSmoothing:r,preserveSmoothing:s,borderWidth:i,as:o,className:je(e),style:a,...l,children:n}));kS.displayName="Squircle";const ibe=ve.forwardRef((n,e)=>d.jsx(kS,{ref:e,cornerRadius:8,...n}));ibe.displayName="SquircleSm";const q9=ve.forwardRef((n,e)=>d.jsx(kS,{ref:e,cornerRadius:12,...n}));q9.displayName="SquircleMd";const abe=ve.forwardRef((n,e)=>d.jsx(kS,{ref:e,cornerRadius:16,...n}));abe.displayName="SquircleLg";const gn=({children:n,className:e,animate:t=!1})=>{const[r,s]=E.useState(!1),i=()=>{s(!0)},a=()=>{s(!1)};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:je("z-30 flex h-7 select-none items-center justify-center rounded-sm border border-text-secondary/50 bg-card-background font-semibold text-[10px] text-text-primary shadow-[inset_0_-1px_0_0_rgba(161,161,170,0.5)] translate-y-[1px] -mt-0.5 -mr-1.5 px-1.5 min-w-[28px]",t&&"animate-keyboardTooltipPress",r&&"animate-keyboardTooltipUnpress",e),onMouseEnter:i,onAnimationEnd:a,children:d.jsx("span",{className:"mt-[-1px]",children:d.jsx("span",{className:"pt-2",children:n})})}),d.jsx("style",{children:`
        @keyframes keyboardTooltipPress {
          0% {
            transform: translateY(0);
            box-shadow: inset 0 -2px 0 0 rgba(0, 0, 0, 0.2), 0 1px 2px 0 rgba(0, 0, 0, 0.4);
          }
          50% {
            transform: translateY(1px);
            box-shadow: inset 0 -1px rgba(161, 161, 170, 0.5);
          }
          to {
            transform: translateY(0);
            box-shadow: inset 0 -2px 0 0 rgba(0, 0, 0, 0.2), 0 1px 2px 0 rgba(0, 0, 0, 0.4);
          }
        }

        @keyframes keyboardTooltipUnpress {
          0% {
            transform: translateY(1px);
            box-shadow: inset 0 -1px rgba(161, 161, 170, 0.5);
          }
          50% {
            transform: translateY(0);
            box-shadow: inset 0 -2px 0 0 rgba(0, 0, 0, 0.2), 0 1px 2px 0 rgba(0, 0, 0, 0.4);
          }
          to {
            transform: translateY(1px);
            box-shadow: inset 0 -1px rgba(161, 161, 170, 0.5);
          }
        }

        .animate-keyboardTooltipPress {
          animation: 0.4s ease-in-out 2 keyboardTooltipPress 0.2s;
        }

        .animate-keyboardTooltipUnpress {
          animation: 0.4s ease-in-out 1 keyboardTooltipUnpress;
        }
      `})]})},obe=({isOpen:n,onClose:e})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"max-w-md",children:[d.jsx(ar,{children:d.jsx(or,{className:"text-text-primary",children:"Keyboard Shortcuts"})}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3",children:"Navigate"}),d.jsx("div",{className:"space-y-2",children:d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Next / Previous Element "}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(gn,{children:""}),d.jsx("span",{className:"text-xs text-text-secondary",children:"+"}),d.jsx(gn,{children:"Tab"})]})]})})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3",children:"Add Elements"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Add Comment"}),d.jsx(gn,{children:"C"})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Record Thoughts"}),d.jsx(gn,{children:"R"})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Record Screen"}),d.jsx(gn,{children:"S"})]})]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3",children:"Canvas Actions"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Delete Selected Element"}),d.jsx(gn,{children:""})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Edit Selected Element"}),d.jsx(gn,{children:"E"})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Reply to Selected Element"}),d.jsx(gn,{children:""})]})]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3",children:"Playback Controls"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Seek by 5 seconds"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(gn,{children:""}),d.jsx(gn,{children:""})]})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Next-prev frame"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(gn,{children:""}),d.jsx("span",{className:"text-xs text-text-secondary",children:"+"}),d.jsx(gn,{children:""}),d.jsx(gn,{children:""})]})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Faster / Slower playback"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(gn,{children:"J"}),d.jsx(gn,{children:"L"})]})]})]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3",children:"Zoom"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Zoom In / Out"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(gn,{children:"+"}),d.jsx(gn,{children:"-"})]})]}),d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-text-primary",children:"Reset zoom"}),d.jsx(gn,{children:"Z"})]})]})]})]}),d.jsx(ys,{className:"gap-2",children:d.jsx("button",{onClick:e,className:"button-primary flex items-center rounded-xl justify-center px-6 py-3 cursor-pointer text-sm font-medium",children:"Go smash Keys"})})]})}),vk=ve.memo(({iconOnly:n=!1,largeIcon:e=!1,fullHeightIcon:t=!1,primaryButton:r=!1})=>{const{user:s,profile:i,isInitialized:a,signOut:o}=Ar(),l=Jn(),c=Os(),[u,f]=E.useState(!1),m=C=>C?C.split(" ")[0]:null,g=s&&i?{id:s.id,full_name:i.full_name,avatar_url:i.avatar_url,email:s.email}:null,y=()=>{const C=c.pathname+c.search,L=`/login?returnUrl=${encodeURIComponent(C)}`;l(L)},b=()=>l("/dash"),x=async()=>{try{await o(),et.success("Signed out successfully");const C=c.pathname;C.startsWith("/flask/")?l(C):C==="/dash"||C.startsWith("/team")?l("/"):l(c.pathname)}catch(C){console.error("Error signing out:",C),et.error("Failed to sign out")}},S=()=>l("/#talk-to-us"),T=()=>d.jsxs(Ms,{align:"end",className:"bg-card-background border-border w-64",children:[d.jsxs(Pn,{disabled:!0,className:"text-text-primary flex flex-col items-start",children:[d.jsx("div",{className:"text-xs text-text-secondary",children:"You're logged in as"}),d.jsx("div",{className:"font-medium",children:s.email})]}),d.jsx(uv,{className:"bg-border"}),d.jsx(Pn,{onClick:()=>f(!0),className:"text-text-primary hover:bg-card-background/50",children:d.jsxs("div",{className:"flex items-center w-full gap-4",children:[d.jsx("div",{className:"w-5 flex items-center justify-center flex-shrink-0",children:d.jsx(Xce,{className:"h-4 w-4"})}),d.jsx("span",{children:"Keyboard Shortcuts"})]})}),d.jsx(Pn,{onClick:S,className:"text-text-primary hover:bg-card-background/50",children:d.jsxs("div",{className:"flex items-center w-full gap-4",children:[d.jsx("div",{className:"w-5 flex items-center justify-center flex-shrink-0",children:d.jsx(tue,{className:"h-4 w-4"})}),d.jsx("span",{children:"Help and Feedback"})]})}),d.jsx(uv,{className:"bg-border"}),d.jsx(Pn,{onClick:x,className:"text-text-primary hover:bg-card-background/50",children:d.jsxs("div",{className:"flex items-center w-full gap-4",children:[d.jsx("div",{className:"w-5 flex items-center justify-center flex-shrink-0",children:d.jsx(Jce,{className:"h-4 w-4"})}),d.jsx("span",{children:"Sign out"})]})})]});if(!a)return n?d.jsx(Lo,{circle:!0,width:40,height:40}):d.jsx(q9,{cornerRadius:14,className:"px-4 py-2",children:d.jsx(Lo,{width:80})});if(!s)return n?d.jsxs(Gs,{children:[d.jsx(qs,{asChild:!0,children:d.jsx(dt,{variant:"ghost",className:"h-7 w-7  font-semibold hover:bg-transparent transition-all duration-200 text-card-background rounded-none border-0",children:d.jsx(BC,{className:"h-5 w-5 text-gray-400"})})}),d.jsx(Ms,{align:"end",className:"bg-card-background border-border",children:d.jsxs(Pn,{onClick:y,className:"text-text-primary hover:bg-card-background/50 flex items-center",children:[d.jsx(BC,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]}):d.jsx("div",{onClick:b,className:je("px-4 bg-text-primary bg-gradient-to-t from-teal-300/30 via-text-primary/90 to-text-primary/90 rounded-full py-2","text-card-background flex items-center justify-center","hover:bg-text-primary transition-all duration-200 font-semibold cursor-pointer"),children:d.jsx("span",{className:"text-xs font-medium",children:"Get Started "})});const R=m(i?.full_name)||s.email?.split("@")[0]||"User",I=s?.user_metadata?.avatar_url||s?.user_metadata?.picture;return d.jsxs(d.Fragment,{children:[d.jsxs(Gs,{children:[d.jsx(qs,{asChild:!0,children:n?d.jsx(dt,{variant:"ghost",className:je("p-0 font-semibold hover:bg-transparent transition-all duration-200 text-card-background rounded-none border-0",t?"h-full w-auto":"h-7"),children:d.jsx(sv,{user:g,src:I,size:t?"full":"sm"})}):d.jsxs("div",{className:"px-2 md:px-5 py-3 rounded-2xl h-full w-full hover:opacity-80 text-text-primary flex justify-between items-center gap-3 transition-all duration-200 cursor-pointer",children:[d.jsxs("div",{className:"flex flex-col md:flex",children:[d.jsx("span",{className:"text-sm font-medium hidden md:block",children:R}),d.jsx("span",{className:"text-xs text-text-secondary hidden md:block",children:s.email})]}),d.jsx(sv,{user:g,src:I,size:"sm"})]})}),d.jsx(T,{})]}),d.jsx(obe,{isOpen:u,onClose:()=>f(!1)})]})}),W9=({isOpen:n,onClose:e})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"w-[90vw] max-w-md",style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:0},children:[d.jsx(ar,{className:"text-center",children:d.jsx(or,{className:"text-xl font-semibold mb-4",children:"Limited Features on Mobile"})}),d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("p",{className:"text-text-secondary",children:"Flask is not yet built for mobile."}),d.jsxs("p",{className:"text-text-secondary",children:[" ","While it works to leave a quick comment, to use Flask, open it on Desktop."]}),d.jsx("button",{className:"button-primary w-full flex items-center justify-center px-6 py-3 text-sm font-medium rounded-xl",onClick:e,children:"Got it"})]})]})}),lbe=({tag:n})=>d.jsx(x9,{text:n.name,className:"text-xs transition-colors"}),cbe=({tag:n,selectedTagId:e,onTagClick:t,onTagDelete:r,getFlaskCountForTag:s})=>{const[i,a]=E.useState(!1);return d.jsxs("button",{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:()=>t(n.id),className:je("group flex items-center justify-between px-4 py-3 rounded-lg text-left transition-colors w-full",e===n.id?"bg-card-background border-b border-border/50 text-foreground":"text-muted-foreground hover:text-foreground hover:bg-card-background/30"),children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(lbe,{tag:n}),i&&d.jsx("button",{onClick:o=>{o.stopPropagation(),r(n)},className:"p-0.5 hover:bg-card-background/50 rounded transition-colors",children:d.jsx($o,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]}),d.jsx("span",{className:"text-xs text-muted-foreground",children:s(n.id)})]},n.id)},ube=ve.memo(function(){const{user:e}=Ar();zv(e?.id);const t=Ft(W=>W.tags),r=Ft(W=>W.flasks),s=Ft(W=>W.currentTeam),i=Ft(W=>W.flaskFilter.tagId),a=Ft(W=>W.flaskFilter.userId),o=Ft(W=>W.setFlaskTagFilter),l=Ft(W=>W.setFlaskUserFilter),c=Ft(W=>W.createTagOptimistic),u=Ft(W=>W.deleteTagOptimistic),f=Ft(W=>W.skeleton.showSidebar),m=Ft(W=>W.userProfiles),[g,y]=E.useState(!1),[b,x]=E.useState(""),[S,T]=E.useState(null),[_,R]=E.useState(!1),I=ve.useRef(null);ve.useEffect(()=>{const W=()=>{y(!0),x(""),setTimeout(()=>{I.current?.focus()},100)};return window.addEventListener("sidebar-create-tag",W),()=>{window.removeEventListener("sidebar-create-tag",W)}},[]);const C=E.useCallback(W=>{i===W?o(null):(o(W),l(null))},[i,o,l]),L=E.useCallback(()=>{o(null),l(null)},[o,l]);E.useCallback(W=>{a===W?l(null):(l(W),o(null))},[a,o,l]);const k=E.useCallback(W=>{let F=r;return a&&(F=F.filter(j=>j.user_id===a)),W?F.filter(j=>j.flask_tag?.id===W).length:F.length},[r,a]),M=E.useCallback(W=>r.filter(F=>F.user_id===W).length,[r]);E.useMemo(()=>{const W=new Map;return s?.members&&s.members.forEach(F=>{W.set(F.user_id,{id:F.user_id,name:F.user?.full_name||F.display_name||F.user?.email||F.email||"Unknown",email:F.user?.email||F.email,avatarUrl:F.user?.avatar_url||F.avatar_url,flaskCount:M(F.user_id),isTeamMember:!0})}),r.forEach(F=>{if(F.user_id&&!W.has(F.user_id)){const j=m[F.user_id];W.set(F.user_id,{id:F.user_id,name:j?.full_name||j?.name||j?.email?.split("@")[0]||"Unknown",email:j?.email,avatarUrl:j?.avatar_url,flaskCount:M(F.user_id),isTeamMember:!1})}}),Array.from(W.values())},[s?.members,r,m,M]);const D=E.useCallback(()=>{y(!0),x("")},[]),U=E.useCallback(async()=>{if(!b.trim()){y(!1);return}y(!1);const W=b.trim();x("");try{await c(W)}catch(F){console.error("Failed to create tag:",F)}},[b,c]),$=E.useCallback(W=>{W.key==="Enter"?(W.preventDefault(),U()):W.key==="Escape"&&(W.preventDefault(),y(!1),x(""))},[U]),V=E.useCallback(W=>{T(W),R(!0)},[]),B=E.useCallback(async()=>{S&&(await u(S.id),R(!1),T(null))},[S,u]);return f?d.jsxs("div",{className:"flex flex-col gap-6",children:[d.jsx("div",{className:"w-full rounded-2xl bg-element-background/30 h-24 animate-pulse"}),d.jsx("div",{className:"flex flex-col gap-2",children:d.jsx("div",{className:"h-12 bg-element-background/30  rounded-lg animate-pulse"})}),d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsx("div",{className:"px-4",children:d.jsx("div",{className:"h-4 bg-element-background/30  rounded w-12 animate-pulse"})}),d.jsx("div",{className:"flex flex-col gap-2",children:Array.from({length:2}).map((W,F)=>d.jsx("div",{className:"px-4",children:d.jsx("div",{className:"h-10 bg-element-background/30 rounded-lg animate-pulse"})},`tag-${F}`))})]})]}):d.jsxs("div",{className:"flex flex-col gap-6",children:[d.jsx("div",{className:"flex flex-col gap-2",children:d.jsxs("button",{onClick:L,className:je("flex items-center justify-between px-4 py-3 rounded-lg text-left transition-colors",!i&&!a?"bg-card-background text-foreground border-b border-border/50":"text-muted-foreground hover:text-foreground hover:bg-card-background/30"),children:[d.jsx("span",{className:"text-sm ",children:"All Flasks"}),d.jsx("span",{className:"text-xs text-muted-foreground",children:k(null)})]})}),d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsxs("div",{className:"flex items-center justify-between px-4 pr-2",children:[d.jsx("h3",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"TAGS"}),d.jsx("button",{onClick:D,className:"w-6 h-6 rounded-sm hover:bg-card-background  flex items-center justify-center transition-colors",children:d.jsx("span",{className:"text-xs text-text-primary font-bold",children:"+"})})]}),d.jsxs("div",{className:"flex flex-col gap-1 ",children:[g&&d.jsx("div",{className:"px-4 py-2",children:d.jsx("input",{ref:I,type:"text",value:b,onChange:W=>x(W.target.value),onKeyDown:$,onBlur:W=>{b.trim()?U():y(!1)},autoFocus:!0,className:"w-full px-3 py-1.5 rounded-lg text-sm text-text-primary border border-dashed border-border/50 bg-transparent outline-none focus:border-border focus:bg-border/20 transition-all",placeholder:"Tag name"})}),d.jsx("div",{id:"sidebar-tag-creator-trigger",style:{display:"none"}}),t&&t.length>0?t.map(W=>d.jsx(cbe,{tag:W,selectedTagId:i,onTagClick:C,onTagDelete:V,getFlaskCountForTag:k},W.id)):d.jsx("div",{className:"px-4 py-3 text-sm text-muted-foreground",children:"No tags yet"})]})]}),d.jsx("div",{children:d.jsx(qye,{})}),S&&d.jsx(G9,{isOpen:_,onClose:()=>{R(!1),T(null)},onConfirm:B,tagName:S.name})]})}),dbe=ve.memo(function(){const{user:e}=Ar();zv(e?.id),Ft(a=>a.currentTeam);const[t,r]=E.useState(!1),[s,i]=E.useState(()=>window.innerWidth<768);return E.useEffect(()=>{const a=()=>i(window.innerWidth<768);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),E.useEffect(()=>{s&&r(!0)},[s]),d.jsxs("div",{className:"min-h-screen bg-card-background text-foreground relative",children:[d.jsx("main",{className:"px-4 md:px-16 pb-32",children:d.jsx("div",{className:"w-full",children:e?d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"relative min-h-screen",children:[d.jsx("div",{className:"w-full mt-8 mb-6",children:d.jsx(a$,{})}),d.jsxs("div",{className:"flex flex-col xl:flex-row h-full min-h-screen gap-2 md:gap-4",children:[d.jsx("div",{className:"flex-1 order-1 xl:order-1",children:d.jsx(Q$,{})}),d.jsx("div",{className:"w-full xl:w-80 order-2 xl:order-2",children:d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsx("div",{className:"bg-element-background/50 border-t mt-[22px] border-text-primary/30 p-3  rounded-3xl",children:d.jsx(ube,{})}),d.jsx("div",{className:"w-full bg-element-background/50 border-t border-text-primary/30 rounded-3xl overflow-hidden shadow-2xl",children:d.jsx(vk,{})})]})})]})]})}):d.jsxs(d.Fragment,{children:[d.jsx(a$,{}),d.jsx(Q$,{})]})})}),d.jsx("div",{className:"relative mt-auto",children:d.jsx(Az,{})}),d.jsx(W9,{isOpen:t,onClose:()=>r(!1)})]})}),hbe=ve.memo(function(){return d.jsx(E.Suspense,{fallback:d.jsx("div",{className:"min-h-screen"}),children:d.jsx(dbe,{})})}),yk=({onClick:n,loading:e=!1,className:t=""})=>d.jsxs(dt,{onClick:n,disabled:e,variant:"default",className:`flex items-center button-primary text-md gap-2 py-4 font-bold ${t}`,children:[e?d.jsx(Mo,{className:"mr-2 h-4 w-4 animate-spin"}):d.jsxs("svg",{className:" h-4 w-4 text-black",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#000000"}),d.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#000000"}),d.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#000000"}),d.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#000000"})]}),"Continue with Google"]}),fbe=({className:n,children:e})=>d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        @keyframes shimmer {
          0% {
            transform: translateX(-100%);
          }
          100% {
            transform: translateX(200%);
          }
        }
        .shimmer-effect::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(
            90deg,
            transparent,
            rgba(255, 255, 255, 0.2),
            transparent
          );
          animation: shimmer 2s ease-in-out infinite;
        }
      `}),d.jsx("div",{className:je("shimmer-effect relative overflow-hidden","bg-gradient-to-r from-border/20 via-border/40 to-border/20",n),children:e})]}),mbe=()=>{const[n]=Cd(),e=Jn(),t=YV(),{user:r,isLoading:s}=Ar(),[i,a]=E.useState(!1),o=n.get("returnUrl")||n.get("redirect")||"/dash";ve.useEffect(()=>{if(r&&!s){const c=setTimeout(()=>{o.startsWith("http://")||o.startsWith("https://")?window.location.href=o:e(o)},100);return()=>clearTimeout(c)}},[r,s,o,e]);const l=async()=>{try{a(!0),await t(o)}catch(c){console.error("Google auth error:",c),a(!1)}};return d.jsxs("div",{className:"min-h-screen w-screen bg-card-background flex flex-col overflow-hidden relative",children:[o==="/dash"&&d.jsx("div",{className:"absolute inset-0 z-0",children:d.jsx("img",{src:"/images/blurredbg@0.33x.jpg",alt:"",className:"w-full h-full object-cover"})}),d.jsx("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center p-4 gap-3",children:d.jsxs("div",{className:"w-full max-w-sm",children:[d.jsxs("div",{className:"bg-element-background border-t border-text-primary/30 rounded-[40px] shadow-2xl shadow-black/50 p-4 flex flex-col items-center gap-4",children:[d.jsxs("div",{className:"",children:[d.jsx(oD,{})," "]}),d.jsxs("div",{className:"text-center space-y-3 w-full mt-4",children:[d.jsx("p",{className:"text-sm text-text-secondary font-medium",children:"Sign in to continue"}),s?d.jsx(fbe,{className:"w-full h-[48px] rounded-lg",children:d.jsx("div",{className:"w-full h-full bg-border/20 rounded-lg"})}):d.jsx(yk,{onClick:l,loading:i,className:" py-6 px-8 text-md w-full rounded-full"})]})]}),d.jsxs("p",{className:"text-xs text-text-secondary text-center mt-4 px-16",children:["Continuing, you agree to the"," ",d.jsx("a",{href:"/terms-of-service",className:"text-text-primary hover:underline",children:"Terms of Service"})," ","and"," ",d.jsx("a",{href:"/privacy",className:"text-text-primary hover:underline",children:"Privacy Policy"}),"."]})]})})]})};function pbe(){return d.jsx(mbe,{})}const gbe=n=>{const e=WV(),t=Fce(),r=cn(s=>s.isInitialized);return Xre({queryKey:["flask-access",n,e?.id],queryFn:async()=>{if(!n)return{flask:null,hasViewAccess:!1,hasEditAccess:!1,isOwner:!1,accessLevel:null,error:"not-found"};try{const s=await Ht(`/api/flasks/${n}`);if(!s.ok){const c=await s.json().catch(()=>({}));if(s.status===404)return{flask:null,hasViewAccess:!1,hasEditAccess:!1,isOwner:!1,accessLevel:null,error:"not-found"};if(s.status===401)return{flask:null,hasViewAccess:!1,hasEditAccess:!1,isOwner:!1,accessLevel:null,error:"auth-required"};if(s.status===403)return{flask:null,hasViewAccess:!1,hasEditAccess:!1,isOwner:!1,accessLevel:null,error:"access-denied"};throw new Error(`HTTP ${s.status}`)}const i=await s.json(),a=e?.id===i.user_id,o=i.canEdit||!1;return{flask:i,hasViewAccess:!0,hasEditAccess:o,isOwner:a,accessLevel:i.access_level||"private",error:null}}catch(s){return console.error("Error fetching flask access:",s),{flask:null,hasViewAccess:!1,hasEditAccess:!1,isOwner:!1,accessLevel:null,error:"network-error"}}},enabled:!!n&&r&&!t,retry:(s,i)=>{if(i&&typeof i=="object"&&"error"in i){const a=i;if(["auth-required","access-denied","not-found"].includes(a.error))return!1}return s<2},staleTime:300*1e3,gcTime:600*1e3})},J$=({error:n,accessLevel:e,onSignIn:t})=>{const r=Jn(),s=YV();return d.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-card-background relative",children:d.jsxs("div",{className:"flex flex-col items-center justify-center w-full z-10",children:[d.jsx(Jg,{}),d.jsx("p",{className:"text-white/60 mb-8 max-w-xs text-center",children:"This Flask may not exist or you might not have permission to view it."}),n==="auth-required"&&t?d.jsx(yk,{onClick:t}):n==="auth-required"?d.jsx(yk,{onClick:()=>{const i=window.location.pathname;s(i)}}):d.jsx(dt,{onClick:()=>r("/"),variant:"link",className:"mt-4 text-white/80",children:"Go Back"})]})})},tx=(n,e)=>{Yt.isAvailable()&&Yt.capture(`recording_${n}`,{...e,timestamp:new Date().toISOString()})},vbe=n=>{Yt.isAvailable()&&Yt.capture("flask_shared",{...n,timestamp:new Date().toISOString()})},ybe=n=>{Yt.isAvailable()&&Yt.capture("element_created",{...n,timestamp:new Date().toISOString()})},sb={isHovered:!1,isEditing:!1,showMetaBar:!1,editingContent:!1},Kc=Ws()(Ui(bi((n,e)=>({editingElementIds:new Set,hoveredElementIds:new Set,currentTextEditElementId:null,currentDescriptionEditElementId:null,isDragging:!1,isFrameDragging:!1,isPanning:!1,placementMode:null,modals:{isSettingsOpen:!1,isShareModalOpen:!1,isAccessModalOpen:!1,isImagePickerOpen:!1},deletionConfirmationState:{isOpen:!1,elementsToDelete:[],onConfirm:null},toolbar:{isVisible:!0,activeTab:null,isExpanded:!1},elementUI:{},isLoading:!1,showGrid:!1,showRulers:!1,showDebugInfo:!1,cursorMode:"default",shortcutsEnabled:!0,setElementEditing:(t,r)=>n(s=>{s.elementUI[t]||(s.elementUI[t]={...sb}),s.elementUI[t].isEditing=r,r?s.editingElementIds.add(t):s.editingElementIds.delete(t)}),setElementHovered:(t,r)=>n(s=>{s.elementUI[t]||(s.elementUI[t]={...sb}),s.elementUI[t].isHovered=r,r?s.hoveredElementIds.add(t):s.hoveredElementIds.delete(t)}),setElementEditingContent:(t,r)=>n(s=>{s.elementUI[t]||(s.elementUI[t]={...sb}),s.elementUI[t].editingContent=r}),setElementShowMetaBar:(t,r)=>n(s=>{s.elementUI[t]||(s.elementUI[t]={...sb}),s.elementUI[t].showMetaBar=r}),clearElementUI:t=>n(r=>{delete r.elementUI[t],r.editingElementIds.delete(t),r.hoveredElementIds.delete(t)}),setCurrentTextEditElementId:t=>n(r=>{r.currentTextEditElementId=t}),setCurrentDescriptionEditElementId:t=>n(r=>{r.currentDescriptionEditElementId=t}),setIsDragging:t=>n(r=>{r.isDragging=t}),setIsFrameDragging:t=>n(r=>{r.isFrameDragging=t}),setIsPanning:t=>n(r=>{r.isPanning=t}),setPlacementMode:t=>n(r=>{r.placementMode=t}),startPlacement:t=>n(r=>{r.placementMode=t,r.cursorMode="crosshair"}),cancelPlacement:()=>n(t=>{t.placementMode=null,t.cursorMode="default"}),openModal:t=>n(r=>{r.modals[t]=!0}),closeModal:t=>n(r=>{r.modals[t]=!1}),closeAllModals:()=>n(t=>{Object.keys(t.modals).forEach(r=>{t.modals[r]=!1})}),openDeletionConfirmation:(t,r,s="element")=>n(i=>{i.deletionConfirmationState={isOpen:!0,elementsToDelete:t,onConfirm:r,deletionType:s}}),closeDeletionConfirmation:()=>n(t=>{t.deletionConfirmationState={isOpen:!1,elementsToDelete:[],onConfirm:null}}),confirmDeletion:()=>{const t=e(),{onConfirm:r}=t.deletionConfirmationState;r&&r(),n(s=>{s.deletionConfirmationState={isOpen:!1,elementsToDelete:[],onConfirm:null}})},setToolbarVisible:t=>n(r=>{r.toolbar.isVisible=t}),setToolbarActiveTab:t=>n(r=>{r.toolbar.activeTab=t}),setToolbarExpanded:t=>n(r=>{r.toolbar.isExpanded=t}),setIsLoading:t=>n(r=>{r.isLoading=t}),setShowGrid:t=>n(r=>{r.showGrid=t}),setShowRulers:t=>n(r=>{r.showRulers=t}),setShowDebugInfo:t=>n(r=>{r.showDebugInfo=t}),setCursorMode:t=>n(r=>{r.cursorMode=t}),setShortcutsEnabled:t=>n(r=>{r.shortcutsEnabled=t}),clearAllEditingStates:()=>n(t=>{t.editingElementIds.clear(),Object.keys(t.elementUI).forEach(r=>{t.elementUI[r].isEditing=!1,t.elementUI[r].editingContent=!1})}),clearAllHoverStates:()=>n(t=>{t.hoveredElementIds.clear(),Object.keys(t.elementUI).forEach(r=>{t.elementUI[r].isHovered=!1,t.elementUI[r].showMetaBar=!1})}),reset:()=>n(t=>{t.editingElementIds.clear(),t.hoveredElementIds.clear(),t.currentTextEditElementId=null,t.currentDescriptionEditElementId=null,t.isDragging=!1,t.isFrameDragging=!1,t.isPanning=!1,t.placementMode=null,t.modals={isSettingsOpen:!1,isShareModalOpen:!1,isAccessModalOpen:!1,isImagePickerOpen:!1},t.toolbar={isVisible:!0,activeTab:null,isExpanded:!1},t.elementUI={},t.isLoading=!1,t.showGrid=!1,t.showRulers=!1,t.showDebugInfo=!1,t.cursorMode="default",t.shortcutsEnabled=!0})})))),bbe=Object.freeze(Object.defineProperty({__proto__:null,useUIStore:Kc},Symbol.toStringTag,{value:"Module"})),ZD=(n,e)=>{const t=n?.full_name;return t?t.split(" ")[0]:e&&!e.includes("@")?e.split(" ")[0]:n?.email?n.email.split("@")[0]:e&&e.includes("@")?e.split("@")[0]:"Unknown"},e4="includeTags",t4="excludeTags";typeof window<"u"&&window.addEventListener("popstate",()=>{setTimeout(()=>{dn.getState().initializeFromUrl()},100)});const dn=Ws()(Ui(bi((n,e)=>({filterMode:"include",activeFilterIds:[],isFilterToolbarOpen:!1,isUpdatingFromUrl:!1,addFilter:(t,r=!0)=>n(s=>{s.activeFilterIds.includes(t)||s.activeFilterIds.push(t),r&&!s.isUpdatingFromUrl&&setTimeout(()=>e().updateUrlFromState(),0)}),removeFilter:(t,r=!0)=>n(s=>{s.activeFilterIds=s.activeFilterIds.filter(i=>i!==t),r&&!s.isUpdatingFromUrl&&setTimeout(()=>e().updateUrlFromState(),0)}),toggleFilter:t=>{e().activeFilterIds.includes(t)?e().removeFilter(t):e().addFilter(t)},isFilterActive:t=>e().activeFilterIds.includes(t),setFilterMode:t=>n(r=>{r.filterMode=t,r.isUpdatingFromUrl||setTimeout(()=>e().updateUrlFromState(),0)}),openFilterToolbar:()=>n(t=>{t.isFilterToolbarOpen=!0}),closeFilterToolbar:()=>n(t=>{t.isFilterToolbarOpen=!1}),toggleFilterToolbar:()=>n(t=>{t.isFilterToolbarOpen=!t.isFilterToolbarOpen}),isElementVisible:t=>{const r=e();if(!e().isFilteringActive())return!0;const s=De.getState(),i=s.getElementTags(t.id),a=s.getElementAppTags(t.id),o=[],l=[],c=[];r.activeFilterIds.forEach(f=>{f.startsWith("apptag:creator:")?l.push(f.replace("apptag:creator:","")):f.startsWith("apptag:time:")?c.push(f.replace("apptag:time:","")):o.push(f)});let u=!1;if(o.length>0&&!u&&i?.some(m=>o.includes(m.id))&&(u=!0),l.length>0&&!u){const f=a?.find(m=>m.type==="creator");f&&l.includes(f.creatorId)&&(u=!0)}if(c.length>0&&!u){const f=a?.find(m=>m.type==="creationTime");if(f&&f.timestamp){const m=f.timestamp*1e3,g=Date.now();for(const y of c)if(y==="last24h"){const b=g-864e5;if(m>=b){u=!0;break}}else if(y==="thisweek"){const b=g-6048e5;if(m>=b){u=!0;break}}else if(y==="new"&&s.unseenElementIds?.has(t.id)){u=!0;break}}}return u||Object.values(s.boardState.elements).some(g=>{const y=g.links?.find(b=>b?.type==="element");return y&&y.targetElementId===t.id?e().isElementVisible(g):!1})&&(u=!0),(!i||i.length===0)&&(!a||a.length===0)?r.filterMode==="exclude":r.filterMode==="include"?u:!u},resetFilters:()=>n(t=>{t.activeFilterIds=[],t.filterMode="include",t.isFilterToolbarOpen=!1}),clearAllFilters:()=>{n(t=>{t.activeFilterIds=[]}),e().updateUrlFromState()},getVisibleElementCount:()=>{const r=De.getState().boardState.elements,s=Object.values(r).filter(a=>a&&a.type!=="asset");return{visible:s.filter(a=>a?e().isElementVisible(a):!1).length,total:s.length}},isFilteringActive:()=>e().activeFilterIds.length>0,updateUrlFromState:()=>{const t=e();if(!window.location.pathname.includes("/flask/"))return;const s=new URLSearchParams(window.location.search).get("asset"),i=new URLSearchParams;if(s&&i.set("asset",s),t.activeFilterIds.length>0){const o=t.filterMode==="include"?e4:t4;i.set(o,t.activeFilterIds.join(","))}const a=`${window.location.pathname}${i.toString()?"?"+i.toString():""}`;window.history.replaceState({},"",a)},initializeFromUrl:()=>{if(!De.getState().isDataLoaded)return;const r=new URLSearchParams(window.location.search),s=r.get(e4),i=r.get(t4);if(n(a=>{a.isUpdatingFromUrl=!0}),s){const a=s.split(",").filter(o=>o.length>0);n(o=>{o.filterMode="include",o.activeFilterIds=a})}else if(i){const a=i.split(",").filter(o=>o.length>0);n(o=>{o.filterMode="exclude",o.activeFilterIds=a})}else n(a=>{a.filterMode="include",a.activeFilterIds=[]});n(a=>{a.isUpdatingFromUrl=!1})},syncWithUrl:()=>{e().initializeFromUrl()}}))));function xbe(n,e,t){return{id:`apptag:creator:${n}`,type:"apptag",name:e,appTagType:"creator",appTagValue:n,avatarUrl:t}}function xA(n){let e="";return n==="last24h"?e="Last 24 hours":n==="thisweek"?e="Last 7 days":n==="new"&&(e="New"),{id:`apptag:time:${n}`,type:"apptag",name:e,appTagType:"time",appTagValue:n}}function K9(n){const e=new Map;return Object.values(n.boardState.elements).forEach(r=>{if(!r||r.type==="asset")return;const i=n.getElementAppTags(r.id)?.find(a=>a.type==="creator");if(i&&i.creatorId&&i.creatorName&&!e.has(i.creatorId)){const a=i.creatorId?n.userProfiles[i.creatorId]:void 0,o=ZD(a,i.creatorName);e.set(i.creatorId,{name:o,avatarUrl:i.creatorAvatarUrl})}}),Array.from(e.entries()).map(([r,s])=>xbe(r,s.name,s.avatarUrl))}function Y9(n){const e=[xA("last24h"),xA("thisweek")];return n&&n.unseenElementIds&&n.unseenElementIds.size>0&&e.unshift(xA("new")),e}const _o=Ws()(Ui(bi((n,e)=>({currentTextEditElementId:null,currentDescriptionEditElementId:null,originalTextContent:null,originalDescriptionContent:null,newlyCreatedElements:new Set,enterTextEditMode:(t,r)=>n(s=>{s.currentTextEditElementId=t,s.originalTextContent=r}),exitTextEditMode:()=>n(t=>{t.currentTextEditElementId=null,t.originalTextContent=null}),isElementInTextEditMode:t=>e().currentTextEditElementId===t,enterDescriptionEditMode:t=>n(r=>{r.currentDescriptionEditElementId=t}),exitDescriptionEditMode:()=>n(t=>{t.currentDescriptionEditElementId=null}),isElementInDescriptionEditMode:t=>e().currentDescriptionEditElementId===t,markElementAsNew:t=>n(r=>{r.newlyCreatedElements.add(t)}),removeNewElement:t=>n(r=>{r.newlyCreatedElements.delete(t)}),isElementNew:t=>e().newlyCreatedElements.has(t),clearNewElements:()=>n(t=>{t.newlyCreatedElements.clear()}),reset:()=>n(t=>{t.currentTextEditElementId=null,t.currentDescriptionEditElementId=null,t.originalTextContent=null,t.originalDescriptionContent=null,t.newlyCreatedElements.clear()})})))),hs=[];for(let n=0;n<256;++n)hs.push((n+256).toString(16).slice(1));function wbe(n,e=0){return(hs[n[e+0]]+hs[n[e+1]]+hs[n[e+2]]+hs[n[e+3]]+"-"+hs[n[e+4]]+hs[n[e+5]]+"-"+hs[n[e+6]]+hs[n[e+7]]+"-"+hs[n[e+8]]+hs[n[e+9]]+"-"+hs[n[e+10]]+hs[n[e+11]]+hs[n[e+12]]+hs[n[e+13]]+hs[n[e+14]]+hs[n[e+15]]).toLowerCase()}let wA;const Ebe=new Uint8Array(16);function Sbe(){if(!wA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");wA=crypto.getRandomValues.bind(crypto)}return wA(Ebe)}const Tbe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),n4={randomUUID:Tbe};function td(n,e,t){if(n4.randomUUID&&!n)return n4.randomUUID();n=n||{};const r=n.random??n.rng?.()??Sbe();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,wbe(r)}const _be=320,Abe={text:120,asset:480,link:1,recording:180},Rbe=200,Cbe=100;function kbe(n){const{elementType:e,customWidth:t}=n,r=Math.max(t||_be,Rbe);let s;return s=Abe[e],s=Math.max(s,Cbe),{width:r,height:s}}const Ibe=()=>kbe({elementType:"text"}),ln=Ws()(Ui(bi((n,e)=>({saveStatus:"idle",lastSyncedTime:null,pendingOperations:0,activeUploads:0,uploadQueue:[],isProcessingQueue:!1,maxConcurrentUploads:2,setSaveStatus:t=>{n(r=>{r.saveStatus=t,t==="synced"&&(r.lastSyncedTime=new Date)})},startUpload:()=>{n(t=>{t.activeUploads+=1,t.saveStatus="uploading"})},endUpload:()=>{n(t=>{t.activeUploads-=1,t.activeUploads===0&&t.pendingOperations===0?(t.saveStatus="synced",t.lastSyncedTime=new Date):t.activeUploads===0&&t.pendingOperations>0&&(t.saveStatus="syncing")})},startOperation:()=>{n(t=>{t.pendingOperations+=1,t.activeUploads===0&&(t.saveStatus="syncing")})},endOperation:t=>{n(r=>{r.pendingOperations-=1,r.activeUploads===0&&r.pendingOperations===0&&(t?(r.saveStatus="synced",r.lastSyncedTime=new Date):navigator.onLine?r.saveStatus="error":r.saveStatus="offline")})},uploadRecording:async t=>{const{elementId:r,flaskId:s,type:i,blob:a,audioBlob:o,recordingDurationSeconds:l,selectedTags:c,linkingMode:u}=t;try{const{fetchWithCredentials:f}=await Ze(async()=>{const{fetchWithCredentials:T}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:T}},void 0),m=await f("/api/recordings/create",{method:"POST",body:JSON.stringify({flaskId:s,recordingType:i})});if(!m.ok)throw new Error("Failed to create Mux upload");const{uploadUrl:g,uploadId:y,recordingId:b}=await m.json(),{useCanvasStore:x}=await Ze(async()=>{const{useCanvasStore:T}=await Promise.resolve().then(()=>ks);return{useCanvasStore:T}},void 0);await x.getState().updateElement(r,{recordingId:b});try{await f(`/api/recordings/${b}/update`,{method:"PATCH",body:JSON.stringify({elementId:r})})}catch(T){console.warn("[PersistenceStore] Failed to link recording to element:",T)}const S=e().queueUpload({elementId:r,blob:a,audioBlob:o,uploadUrl:g,muxUploadId:y,recordingId:b})}catch(f){throw console.error("[PersistenceStore] Failed to upload recording:",f),f}},uploadImage:async t=>{const{attachmentId:r,flaskId:s,blob:i,originalFilename:a,width:o,height:l,fileSize:c,mimeType:u,isDraft:f,draftKey:m}=t,y={id:td(),elementId:r,blob:i,uploadType:"image",attachmentId:r,flaskId:s,originalFilename:a,width:o,height:l,fileSize:c,mimeType:u,status:"queued",progress:0,retryCount:0,maxRetries:3,createdAt:Date.now(),isDraft:f,draftKey:m};n(b=>{b.uploadQueue.push(y)}),e().startUpload(),e().processQueue()},saveElement:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{error:i}=await Lr.from("elements").insert(t);if(i)throw i;s(!0)}catch(i){throw console.error("Failed to save element:",i),s(!1),i}},updateElement:async(t,r)=>{const{startOperation:s,endOperation:i}=e();if(Object.keys(r).length!==0){s();try{const{error:a}=await Lr.from("elements").update(r).eq("id",t);if(a)throw a;i(!0)}catch(a){throw console.error("Failed to update element:",a),i(!1),a}}},deleteElement:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{error:i}=await Lr.from("elements").delete().eq("id",t);if(i)throw i;s(!0)}catch(i){throw console.error("Failed to delete element:",i),s(!1),i}},loadElements:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{fetchWithCredentials:i}=await Ze(async()=>{const{fetchWithCredentials:c}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:c}},void 0),a=await i(`/api/assets/${t}/elements`);if(!a.ok)throw new Error(`Failed to load elements: ${a.statusText}`);const l=(await a.json()||[]).map(c=>{const u=(c.attachments||[]).map(m=>{const g=m.recordings;return{id:m.id,elementId:c.id,type:m.attachment_type,displayOrder:m.display_order,recordingId:m.recording_id,recordingType:m.recording_type,videoUrl:g?.hls_url,thumbnailUrl:g?.thumbnail_url,duration:g?.duration,recordingState:g?.hls_url?"completed":"processing",aiSummary:g?.ai_summary,aiTranscript:g?.ai_transcript,aiProcessingStatus:g?.ai_processing_status,hasAiInsights:!!(g?.ai_summary||g?.ai_transcript),aiInsights:g?.ai_transcript||g?.ai_summary?{transcript:g?.ai_transcript,summary:g?.ai_summary}:void 0,imageUrl:m.image_url,imageWidth:m.image_width,imageHeight:m.image_height,fileUrl:m.file_url,fileName:m.file_name,fileSize:m.file_size,mimeType:m.mime_type,metadata:m.metadata,createdAt:m.created_at,createdBy:m.created_by}}).sort((m,g)=>m.displayOrder-g.displayOrder),f=u.find(m=>m.type==="recording");return c.type==="recording"&&f?{...c,attachments:u,videoUrl:f.videoUrl,thumbnailUrl:f.thumbnailUrl,duration:f.duration,recordingId:f.recordingId,aiSummary:f.aiSummary,hasAIInsights:f.hasAiInsights,aiInsights:f.aiInsights}:{...c,attachments:u,content:c.content||""}});return s(!0),l}catch(i){return console.error("Failed to load elements:",i),s(!1),[]}},loadTags:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{fetchWithCredentials:i}=await Ze(async()=>{const{fetchWithCredentials:l}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:l}},void 0),a=await i(`/api/flasks/${t}/tags`);if(!a.ok)throw new Error(`Failed to load tags: ${a.statusText}`);const o=await a.json();return s(!0),o||[]}catch(i){return console.error("Failed to load tags:",i),s(!1),[]}},saveTag:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{error:i}=await Lr.from("element_tags").insert(t);if(i)throw i;s(!0)}catch(i){throw console.error("Failed to save tag:",i),s(!1),i}},updateTag:async(t,r)=>{const{startOperation:s,endOperation:i}=e();s();try{const{error:a}=await Lr.from("element_tags").update(r).eq("id",t);if(a)throw a;i(!0)}catch(a){throw console.error("Failed to update tag:",a),i(!1),a}},deleteTag:async t=>{const{startOperation:r,endOperation:s}=e();r();try{const{error:i}=await Lr.from("element_tags").delete().eq("id",t);if(i)throw i;s(!0)}catch(i){throw console.error("Failed to delete tag:",i),s(!1),i}},renameTag:async(t,r)=>{const{startOperation:s,endOperation:i}=e();s();try{const{error:a}=await Lr.from("element_tags").update({name:r}).eq("id",t);if(a)throw a;i(!0)}catch(a){throw console.error("Failed to rename tag:",a),i(!1),a}},changeTagColor:async(t,r)=>{const{startOperation:s,endOperation:i}=e();s();try{const{error:a}=await Lr.from("element_tags").update({color:r}).eq("id",t);if(a)throw a;i(!0)}catch(a){throw console.error("Failed to change tag color:",a),i(!1),a}},queueUpload:t=>{const r=td(),s=!t.uploadUrl||!t.muxUploadId||!t.recordingId,i={id:r,elementId:t.elementId,blob:t.blob,audioBlob:t.audioBlob,uploadUrl:t.uploadUrl,muxUploadId:t.muxUploadId,recordingId:t.recordingId,flaskId:t.flaskId,recordingType:t.recordingType,status:s?"preparing":"queued",progress:0,retryCount:0,maxRetries:3,createdAt:Date.now(),isDraft:t.isDraft,localBlobUrl:t.localBlobUrl};return n(a=>{a.uploadQueue.push(i)}),e().startUpload(),s?(async()=>{try{if(!t.flaskId||!t.recordingType)throw new Error("flaskId and recordingType required for preparation");const{fetchWithCredentials:a}=await Ze(async()=>{const{fetchWithCredentials:f}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:f}},void 0),o=await a("/api/recordings/create",{method:"POST",body:JSON.stringify({flaskId:t.flaskId,recordingType:t.recordingType})});if(!o.ok)throw new Error("Failed to create Mux upload");const{uploadUrl:l,uploadId:c,recordingId:u}=await o.json();if(n(f=>{const m=f.uploadQueue.find(g=>g.id===r);m&&(m.uploadUrl=l,m.muxUploadId=c,m.recordingId=u,m.status="queued",t.isDraft&&(m.elementId=u))}),t.isDraft){const{useCanvasStore:f}=await Ze(async()=>{const{useCanvasStore:S}=await Promise.resolve().then(()=>ks);return{useCanvasStore:S}},void 0),{supabase:m}=await Ze(async()=>{const{supabase:S}=await Promise.resolve().then(()=>hg);return{supabase:S}},void 0);if(f.getState().getDraftElement(i.draftKey))`${t.elementId}${u}`,f.getState().updateDraftAttachment(t.elementId,{id:u,recordingId:u},i.draftKey);else{`${u}`;const S=f.getState().boardState.elements;let T=null,_=-1;for(const[R,I]of Object.entries(S))if(I.attachments){const C=I.attachments.findIndex(L=>L.id===t.elementId||L.recordingId===t.elementId);if(C!==-1){T=R,_=C;break}}if(T){`${T}`;const R=S[T],I=R.attachments[_],C={id:td(),element_id:T,attachment_type:"recording",display_order:_,recording_id:u,recording_type:t.recordingType,created_by:I.createdBy||void 0,created_at:I.createdAt||new Date().toISOString()},{error:L}=await m.from("attachments").insert([C]);L?console.error("[PersistenceStore] Failed to create attachment record:",L):(C.id,f.getState().updateElement(T,{attachments:R.attachments.map((k,M)=>M===_?{...k,id:u,recordingId:u}:k)})),await m.from("recordings").update({element_id:T}).eq("id",u)}else console.warn(`[PersistenceStore] Could not find element with temp attachment ${t.elementId}`)}const{useRecordingStore:y}=await Ze(async()=>{const{useRecordingStore:S}=await Promise.resolve().then(()=>wk);return{useRecordingStore:S}},void 0),b=y.getState().getElementState(t.elementId);b&&(y.getState().updateElementState(u,{...b,id:u}),y.setState(S=>{delete S.elements[t.elementId]}),`${t.elementId}${u}`);const{useAIStore:x}=await Ze(async()=>{const{useAIStore:S}=await Promise.resolve().then(()=>F2);return{useAIStore:S}},void 0);x.getState().updateRecordingId(t.elementId,u),`${t.elementId}${u}`;try{const S=i.audioBlob||i.blob;`${u}${S.size}`;const T=f.getState().getDraftElement(i.draftKey);T&&await x.getState().startProcessing(T.id,u,S)}catch(S){console.warn("[PersistenceStore] AI processing failed for draft:",S)}}e().processQueue()}catch(a){if(console.error("[PersistenceStore] Preparation failed:",r,a),n(o=>{const l=o.uploadQueue.find(c=>c.id===r);l&&(l.status="failed",l.error=a instanceof Error?a.message:"Preparation failed")}),e().endUpload(),t.isDraft){const{useCanvasStore:o}=await Ze(async()=>{const{useCanvasStore:l}=await Promise.resolve().then(()=>ks);return{useCanvasStore:l}},void 0);o.getState().removeDraftAttachment(t.elementId)}}})():e().processQueue(),r},processQueue:async()=>{if(!e().isProcessingQueue){n(r=>{r.isProcessingQueue=!0});try{for(;;){const r=e();if(r.uploadQueue.filter(a=>a.status==="uploading").length>=r.maxConcurrentUploads)break;const i=r.uploadQueue.find(a=>a.status==="queued");if(!i)break;e().executeUpload(i).catch(a=>{console.error("[PersistenceStore] Upload failed:",a)})}}finally{n(r=>{r.isProcessingQueue=!1})}}},executeUpload:async t=>{const r=t.id;return t.uploadType,n(s=>{const i=s.uploadQueue.find(a=>a.id===r);i&&(i.status="uploading",i.lastAttemptAt=Date.now())}),t.uploadType==="image"?e().executeImageUpload(t):new Promise((s,i)=>{const a=new XMLHttpRequest;n(l=>{const c=l.uploadQueue.find(u=>u.id===r);c&&(c.xhr=a)});const o=l=>{console.error("[PersistenceStore] Upload error:",r,l);const u=e().uploadQueue.find(f=>f.id===r);if(!u){i(l);return}if(u.retryCount<u.maxRetries){const m=[1e3,2e3,5e3][u.retryCount]||1e4;`${r}${m}`,u.retryCount+1,`${u.maxRetries}`,n(g=>{const y=g.uploadQueue.find(b=>b.id===r);y&&(y.status="queued",y.retryCount++,y.error=l.message,y.xhr=void 0)}),e().endUpload(),setTimeout(()=>{e().processQueue()},m);return}else console.error(`[PersistenceStore] Upload ${r} failed after ${u.maxRetries} retries`),n(f=>{const m=f.uploadQueue.find(g=>g.id===r);m&&(m.status="failed",m.error=l.message,m.xhr=void 0)}),e().endUpload(),e().processQueue(),i(l)};a.upload.addEventListener("progress",l=>{if(l.lengthComputable){const c=Math.round(l.loaded/l.total*100);n(u=>{const f=u.uploadQueue.find(m=>m.id===r);f&&(f.progress=c)})}}),a.addEventListener("load",async()=>{if(a.status===200||a.status===201){n(l=>{const c=l.uploadQueue.find(u=>u.id===r);c&&(c.status="processing",c.progress=100,c.xhr=void 0)}),e().endUpload(),t.elementId;try{const{fetchWithCredentials:l}=await Ze(async()=>{const{fetchWithCredentials:g}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:g}},void 0),c=await l("/api/recordings/complete",{method:"POST",body:JSON.stringify({recordingId:t.recordingId,uploadId:t.muxUploadId})});if(!c.ok){const g=await c.text();throw console.error("[PersistenceStore] Failed to complete upload:",g),new Error("Failed to complete recording")}const u=await c.json(),{useCanvasStore:f}=await Ze(async()=>{const{useCanvasStore:g}=await Promise.resolve().then(()=>ks);return{useCanvasStore:g}},void 0),m=f.getState().getDraftElement();if(m){const g=m.attachments.find(y=>y.recordingId===t.recordingId);g&&(`${t.recordingId}`,f.getState().updateDraftAttachment(g.id,{recordingState:"processing"}))}}catch(l){console.error("[PersistenceStore] Error completing upload:",l),o(l);return}e().startPollingForRecording(t.recordingId),e().processQueue(),s()}else o(new Error(`Upload failed: ${a.status}`))}),a.addEventListener("error",()=>{o(new Error("Network error"))}),a.addEventListener("abort",()=>{o(new Error("Upload canceled"))}),a.open("PUT",t.uploadUrl),a.setRequestHeader("Content-Type",t.blob.type),a.send(t.blob)})},executeImageUpload:async t=>{const r=t.id;return new Promise((s,i)=>{const a=u=>{console.error("[PersistenceStore] Image upload error:",r,u);const m=e().uploadQueue.find(g=>g.id===r);if(!m){i(u);return}if(m.retryCount<m.maxRetries){const y=[1e3,2e3,5e3][m.retryCount]||1e4;`${r}${y}`,m.retryCount+1,`${m.maxRetries}`,n(b=>{const x=b.uploadQueue.find(S=>S.id===r);x&&(x.status="queued",x.retryCount++,x.error=u.message)}),e().endUpload(),setTimeout(()=>{e().processQueue()},y);return}else console.error(`[PersistenceStore] Image upload ${r} failed after ${m.maxRetries} retries`),n(g=>{const y=g.uploadQueue.find(b=>b.id===r);y&&(y.status="failed",y.error=u.message)}),e().endUpload(),e().processQueue(),i(u)},o=Date.now(),l=t.mimeType?.split("/")[1]||"webp",c=`${t.flaskId}/${t.attachmentId}_${o}.${l}`;Lr.storage.from("images").upload(c,t.blob,{contentType:t.mimeType||"image/webp",upsert:!1}).then(async({data:u,error:f})=>{if(f){a(new Error(`Storage upload failed: ${f.message}`));return}u.path;const{data:m}=Lr.storage.from("images").getPublicUrl(c),g=m.publicUrl,b=(await Ze(()=>Promise.resolve().then(()=>ks),void 0)).useCanvasStore.getState(),x=b.getDraftElement(t.draftKey);if(x){const S=x.attachments.find(T=>T.id===t.attachmentId);S&&(`${t.attachmentId}`,b.updateDraftAttachment(S.id,{imageUrl:g,metadata:{storagePath:c,originalFilename:t.originalFilename||"image"}},t.draftKey))}n(S=>{const T=S.uploadQueue.find(_=>_.id===r);T&&(T.status="completed",T.progress=100)}),e().endUpload(),n(S=>{const T=S.uploadQueue.findIndex(_=>_.id===r);T!==-1&&S.uploadQueue.splice(T,1)}),e().processQueue(),s()}).catch(u=>{a(u)})})},retryFailedUpload:async t=>{const r=e().uploadQueue.find(s=>s.id===t);if(!(!r||r.status!=="failed")){if(!navigator.onLine){n(s=>{const i=s.uploadQueue.find(a=>a.id===t);i&&(i.error="No internet connection")}),e().setSaveStatus("offline");return}n(s=>{const i=s.uploadQueue.find(a=>a.id===t);i&&(i.status="preparing",i.retryCount=0,i.error=void 0,i.progress=0)}),e().startUpload();try{const{fetchWithCredentials:s}=await Ze(async()=>{const{fetchWithCredentials:c}=await Promise.resolve().then(()=>Th);return{fetchWithCredentials:c}},void 0),i=await s("/api/recordings/create",{method:"POST",body:JSON.stringify({flaskId:r.flaskId,recordingType:r.recordingType})});if(!i.ok)throw new Error("Failed to create Mux upload");const{uploadUrl:a,uploadId:o,recordingId:l}=await i.json();if(n(c=>{const u=c.uploadQueue.find(f=>f.id===t);u&&(u.uploadUrl=a,u.muxUploadId=o,u.recordingId=l,u.status="queued")}),r.isDraft){const{useCanvasStore:c}=await Ze(async()=>{const{useCanvasStore:f}=await Promise.resolve().then(()=>ks);return{useCanvasStore:f}},void 0),u=r.recordingId;c.getState().updateDraftAttachment(u,{id:l,recordingId:l})}e().processQueue()}catch(s){console.error("[PersistenceStore] Re-preparation failed:",t,s);const i=s instanceof Error&&(s.message.includes("fetch")||s.message.includes("network")||s.message.includes("Failed to fetch")||!navigator.onLine),a=i?"No internet connection":s instanceof Error?s.message:"Re-preparation failed";n(o=>{const l=o.uploadQueue.find(c=>c.id===t);l&&(l.status="failed",l.error=a)}),i?e().setSaveStatus("offline"):e().setSaveStatus("error"),e().endUpload()}}},startPollingForRecording:async t=>{const i=Date.now(),a=async()=>{if(e().uploadQueue.find(l=>l.recordingId===t&&l.status==="processing")){if(Date.now()-i>12e4){console.warn(`[PersistenceStore] Polling timeout for ${t}`);return}try{const{supabase:l}=await Ze(async()=>{const{supabase:f}=await Promise.resolve().then(()=>hg);return{supabase:f}},void 0),{data:c,error:u}=await l.from("recordings").select("id, status, hls_url, thumbnail_url, duration, mux_playback_id").eq("id",t).single();if(u){console.error(`[PersistenceStore] Error polling recording ${t}:`,u),setTimeout(a,2e3);return}if(c&&c.status==="ready"&&c.hls_url){`${t}`;const{useCanvasStore:f}=await Ze(async()=>{const{useCanvasStore:b}=await Promise.resolve().then(()=>ks);return{useCanvasStore:b}},void 0),m=f.getState().getDraftElement();if(m){const b=m.attachments.find(x=>x.recordingId===t);b&&(`${t}`,f.getState().updateDraftAttachment(b.id,{videoUrl:c.hls_url,thumbnailUrl:c.thumbnail_url||void 0,duration:c.duration||0,recordingState:"completed"}))}const g=f.getState().boardState.elements;let y=!1;for(const[b,x]of Object.entries(g))if(x?.attachments){const S=x.attachments.findIndex(T=>T.recordingId===t);if(S!==-1){`${b}`;const T=[...x.attachments];T[S]={...T[S],videoUrl:c.hls_url,thumbnailUrl:c.thumbnail_url||void 0,duration:c.duration||0,recordingState:"completed"},f.getState().updateElement(b,{attachments:T}),y=!0;break}}!y&&!m&&console.warn(`[PersistenceStore]  Recording ${t} ready but not found in any element or draft`),n(b=>{b.uploadQueue=b.uploadQueue.filter(x=>x.recordingId!==t)}),`${t}`}else setTimeout(a,2e3)}catch(l){console.error(`[PersistenceStore] Error in polling loop for ${t}:`,l),setTimeout(a,2e3)}}};setTimeout(a,2e3)},retryAllFailedUploads:async()=>{const t=e().uploadQueue.filter(r=>r.status==="failed");for(const r of t)await e().retryFailedUpload(r.id)},getFailedUploads:()=>e().uploadQueue.filter(t=>t.status==="failed"),cancelUpload:t=>{const r=e().uploadQueue.find(s=>s.id===t);r?.xhr&&r.xhr.abort(),n(s=>{const i=s.uploadQueue.findIndex(a=>a.id===t);i!==-1&&s.uploadQueue.splice(i,1)})}}))));typeof window<"u"&&(window.addEventListener("online",()=>{const n=ln.getState();n.saveStatus==="offline"&&n.pendingOperations===0&&n.setSaveStatus("synced")}),window.addEventListener("offline",()=>{ln.getState().setSaveStatus("offline")}));typeof window<"u"&&Lr.channel("recording-ready").on("broadcast",{event:"video.ready"},async n=>{const{recordingId:e,hlsUrl:t,thumbnailUrl:r,duration:s}=n.payload;if(e&&t){const{useCanvasStore:i}=await Ze(async()=>{const{useCanvasStore:f}=await Promise.resolve().then(()=>ks);return{useCanvasStore:f}},void 0),a=i.getState().getDraftElement();if(a){const f=a.attachments.find(m=>m.recordingId===e);f&&i.getState().updateDraftAttachment(f.id,{videoUrl:t,thumbnailUrl:r,duration:s,recordingState:"completed"})}const o=i.getState().boardState.elements;`${Object.keys(o).length}`,Object.entries(o).forEach(([f,m])=>{m?.attachments&&m.attachments.length>0&&(`${f}${m.attachments.length}`,m.attachments.map(g=>({id:g.id,recordingId:g.recordingId,state:g.recordingState})))});let l=!1;for(const[f,m]of Object.entries(o))if(m?.attachments){const g=m.attachments.findIndex(y=>y.recordingId===e);if(g!==-1){const y=[...m.attachments];y[g]={...y[g],videoUrl:t,thumbnailUrl:r,duration:s,recordingState:"completed"},i.getState().updateElement(f,{attachments:y}),l=!0;break}}l||console.warn(`[PersistenceStore]  Recording ${e} not found in any element attachments`);const u=ln.getState().uploadQueue.find(f=>f.recordingId===e);u&&(`${u.id}`,ln.setState(f=>{f.uploadQueue=f.uploadQueue.filter(m=>m.recordingId!==e)}))}}).subscribe(n=>{n==="SUBSCRIPTION_ERROR"&&console.error("[PersistenceStore] Broadcast subscription error")});const X9=()=>{const{saveStatus:n,lastSyncedTime:e,pendingOperations:t,activeUploads:r}=ln();return{state:n,lastSyncedTime:e,queueLength:0,flaskQueueLength:0,hasUnsavedChanges:t>0,activeUploads:r,hasActiveUploads:r>0,setSyncing:()=>ln.getState().setSaveStatus("syncing"),setSynced:()=>ln.getState().setSaveStatus("synced"),setOffline:()=>ln.getState().setSaveStatus("offline"),setError:()=>ln.getState().setSaveStatus("error"),setIdle:()=>ln.getState().setSaveStatus("idle"),onRetry:async()=>{ln.getState().uploadQueue.filter(i=>i.status==="failed").length>0?await ln.getState().retryAllFailedUploads():ln.getState().setSaveStatus("synced")}}},EA=Object.freeze(Object.defineProperty({__proto__:null,useElementPersistence:ln,useSaveStatus:X9},Symbol.toStringTag,{value:"Module"})),Vn=n=>n?8:Pr/2+10,yt=Ws()(Ui((n,e)=>({timelineScale:1,timelineOffset:Vn(typeof window<"u"&&window.innerWidth<768),scrollableThreads:new Set,anyThreadNeedsScroll:!1,maxVerticalScroll:0,hoveredScrollableThread:null,threadScrollOffsets:new Map,activeScrollingThread:null,scrollEnabledThreads:new Set,scrollEnabledAtOffset:null,threadContainerRefs:new Map,threadMaxScrollHeights:new Map,isScrolling:!1,scrollTimeout:null,lastScrollTimestamp:0,isAutoFollowEnabled:!1,lastPlayheadInteraction:null,viewportWidth:typeof window<"u"?window.innerWidth:1920,isMobile:typeof window<"u"&&window.innerWidth<768,duration:0,visibleTimeStart:0,visibleTimeEnd:0,visibleDuration:0,playbarWidth:0,setTimelineScale:t=>{const r=e(),s=Math.max(0,r.viewportWidth-Vn(r.isMobile)*2)*t,i=r.duration/t,o=-r.timelineOffset/s*r.duration,l=o+i;n({timelineScale:t,playbarWidth:s,visibleDuration:i,visibleTimeStart:o,visibleTimeEnd:l})},setTimelineOffset:t=>{const r=e(),s=Math.max(0,r.viewportWidth-Vn(r.isMobile)*2)*r.timelineScale,i=r.duration/r.timelineScale,a=-t/s,o=Math.max(0,a*r.duration),l=Math.min(r.duration,o+i);n({timelineOffset:t,visibleTimeStart:o,visibleTimeEnd:l})},updateThreadScrollability:(t,r,s)=>{const i=e(),a=new Set(i.scrollableThreads);r?a.add(t):a.delete(t);const o=a.size>0,l=o?Math.max(s,i.maxVerticalScroll):0;n({scrollableThreads:a,anyThreadNeedsScroll:o,maxVerticalScroll:l})},clearScrollableThreads:()=>{n({scrollableThreads:new Set,anyThreadNeedsScroll:!1,maxVerticalScroll:0,hoveredScrollableThread:null})},setHoveredScrollableThread:t=>{n({hoveredScrollableThread:t})},setThreadScrollOffset:(t,r)=>{const s=e(),i=new Map(s.threadScrollOffsets);i.set(t,r),n({threadScrollOffsets:i})},setActiveScrollingThread:t=>{n({activeScrollingThread:t})},resetAllThreadScrolls:()=>{e().threadContainerRefs.forEach(r=>{r.scrollTop>0&&(r.scrollTop=0)}),n({threadScrollOffsets:new Map,activeScrollingThread:null,scrollEnabledThreads:new Set,scrollEnabledAtOffset:null,threadMaxScrollHeights:new Map})},enableThreadScrollOnHover:t=>{const r=e(),s=new Set(r.scrollEnabledThreads);s.add(t),n({scrollEnabledThreads:s,scrollEnabledAtOffset:r.timelineOffset})},disableThreadScrollOnLeave:t=>{const r=e(),s=new Set(r.scrollEnabledThreads);s.delete(t),n({scrollEnabledThreads:s})},isThreadScrollEnabled:t=>e().scrollEnabledThreads.has(t),registerThreadContainer:(t,r)=>{const s=e(),i=new Map(s.threadContainerRefs);i.set(t,r),n({threadContainerRefs:i})},unregisterThreadContainer:t=>{const r=e(),s=new Map(r.threadContainerRefs);s.delete(t),n({threadContainerRefs:s})},scrollThreadToBottom:t=>{const s=e().threadContainerRefs.get(t);if(s){const i=s.scrollHeight-s.clientHeight;s.scrollTo({top:Math.max(0,i),behavior:"smooth"})}},scrollThreadToTop:t=>{const s=e().threadContainerRefs.get(t);s&&s.scrollTo({top:0,behavior:"smooth"})},notifyThreadHeightChanged:t=>{const r=e(),s=r.threadContainerRefs.get(t);if(!s)return;const i=s.scrollHeight-s.scrollTop-s.clientHeight<50;if(r.scrollEnabledThreads.has(t)&&i){const a=s.scrollHeight-s.clientHeight;s.scrollTo({top:Math.max(0,a),behavior:"smooth"})}},setThreadMaxScrollHeight:(t,r)=>{const s=e(),i=new Map(s.threadMaxScrollHeights);i.set(t,r),n({threadMaxScrollHeights:i})},getThreadMaxScrollHeight:t=>e().threadMaxScrollHeights.get(t)??null,setIsScrolling:t=>{n({isScrolling:t})},startScrolling:()=>{const t=e();t.scrollTimeout&&clearTimeout(t.scrollTimeout),n({isScrolling:!0,scrollTimeout:null,lastScrollTimestamp:Date.now()})},stopScrollingDelayed:()=>{const t=e();t.scrollTimeout&&clearTimeout(t.scrollTimeout);const r=setTimeout(()=>{n({isScrolling:!1,scrollTimeout:null})},500);n({scrollTimeout:r})},setViewportWidth:t=>{const r=e(),s=Math.max(0,t-Vn(r.isMobile)*2)*r.timelineScale,i=r.duration/r.timelineScale;n({viewportWidth:t,playbarWidth:s,visibleDuration:i})},setDuration:t=>{const r=e(),s=t/r.timelineScale;n({duration:t,visibleDuration:s,visibleTimeEnd:Math.min(t,r.visibleTimeStart+s)})},updateTimelineTransform:(t,r)=>{const s=e(),a=Math.max(0,s.viewportWidth-Vn(s.isMobile)*2)*t,o=Vn(s.isMobile),l=s.viewportWidth-Vn(s.isMobile)-a,c=Math.max(l,Math.min(o,r)),u=s.duration/t,m=(o-c)/a,g=Math.max(0,m*s.duration),y=Math.min(s.duration,g+u);n({timelineScale:t,timelineOffset:c,playbarWidth:a,visibleDuration:u,visibleTimeStart:g,visibleTimeEnd:y})},applyTransform:(t,r)=>{e().updateTimelineTransform(t,r)},smoothZoomToTimeRange:(t,r,s,i)=>{const a=e(),o=a.viewportWidth,l=o-Vn(a.isMobile)*2,c=r-t;let u;if(s&&s>10)u=Math.max(1,Math.min(1200,s));else{const M=280/(c/a.duration*l);u=Math.max(1,Math.min(1200,M*1.2))}const f=(t+r)/2,m=l*u,g=f/a.duration*m,y=o/2-g,b=o-Vn(a.isMobile)-m,x=Vn(a.isMobile),S=Math.max(b,Math.min(x,y)),T=a.timelineScale,_=a.timelineOffset,R=Date.now(),I=800,C=()=>{const L=Date.now()-R,k=Math.min(1,L/I);let M;k<.5?M=2*k*k:M=1-2*(1-k)*(1-k),M=(Math.sin((M-.5)*Math.PI)+1)/2;const D=T+(u-T)*M,U=_+(S-_)*M;a.updateTimelineTransform(D,U),k<1?requestAnimationFrame(C):(a.updateTimelineTransform(u,S),i&&i())};requestAnimationFrame(C)},progressiveZoomToUngroup:(t,r,s,i)=>{const a=e();let o=0;const l=10,c=()=>{o++;const f=e();if(i()&&o<l){const g=Math.min(1200,f.timelineScale*1.5);a.smoothZoomToTimeRange(t,r,g,()=>{setTimeout(c,150)})}},u=a.timelineScale*2;a.smoothZoomToTimeRange(t,r,u,c)},zoomToShowElements:(t,r)=>{const s=e(),i=De.getState();if(!i){console.warn("Canvas store not available"),r&&r();return}const a=i.boardState.elements,o=dn.getState(),l=V=>{const B=a[V];return B&&o.isElementVisible(B)};if(t.length===1){const V=a[t[0]];if(V&&V.links&&l(t[0])){const B=V.links.find(W=>W.type==="timeline");if(B){let W=0;B.timeRange?W=(B.timeRange.start+B.timeRange.end)/2:B.timestamp!==void 0&&(W=B.timestamp);const F=W/s.duration*100,j=s.timelineScale,H=s.viewportWidth*j,N=Pr/H*100,z=-s.timelineOffset/H*100,G=z+100/j,Y=F-N/2,Q=F+N/2;if(Y>=z&&Q<=G){const ee=[];Object.entries(a).forEach(([te,se])=>{if(!se||!se.links||te===t[0]||!l(te))return;const he=se.links.find(ae=>ae.type==="timeline");if(!he)return;let Z;if(he.timeRange)Z=(he.timeRange.start+he.timeRange.end)/2;else if(he.timestamp!==void 0)Z=he.timestamp;else return;Math.abs(Z-W)/s.duration*100<N*2&&ee.push({time:Z})});let oe=!1;for(const te of ee)if(Math.abs(te.time-W)/s.duration*100<N){oe=!0;break}if(!oe){r&&r();return}}}}}let c=0,u=!1;if(t.length===1){const V=a[t[0]];if(V&&V.links&&l(t[0])){const B=V.links.find(W=>W.type==="timeline");B&&(B.timeRange?c=(B.timeRange.start+B.timeRange.end)/2:B.timestamp!==void 0&&(c=B.timestamp),u=!0)}}else{let V=1/0,B=-1/0;t.forEach(W=>{const F=a[W];if(!F||!F.links||!l(W))return;const j=F.links.find(q=>q.type==="timeline");j&&(j.timeRange?(V=Math.min(V,j.timeRange.start),B=Math.max(B,j.timeRange.end)):j.timestamp!==void 0&&(V=Math.min(V,j.timestamp),B=Math.max(B,j.timestamp)))}),V!==1/0&&B!==-1/0&&(c=(V+B)/2,u=!0)}if(!u){console.warn("No valid timeline links found for elements"),r&&r();return}const f=s.viewportWidth,m=f-Pr,g=[];Object.entries(a).forEach(([V,B])=>{if(!B||!B.links||!l(V))return;const W=B.links.find(j=>j.type==="timeline");if(!W)return;let F;if(W.timeRange)F=(W.timeRange.start+W.timeRange.end)/2;else if(W.timestamp!==void 0)F=W.timestamp;else return;g.push({id:V,time:F})}),g.sort((V,B)=>V.time-B.time);let y=1/0;t.forEach(V=>{const B=g.findIndex(F=>F.id===V);if(B===-1)return;const W=g[B].time;if(B>0){const F=Math.abs(W-g[B-1].time);F>0&&(y=Math.min(y,F))}if(B<g.length-1){const F=Math.abs(g[B+1].time-W);F>0&&(y=Math.min(y,F))}});const b=s.timelineScale,x=s.timelineOffset,S=Pr/(m*b)*100;let T=!1;if(y!==1/0&&y>0){const V=y/s.duration*100;T=S>V*.9}const _=m*b,R=c/s.duration*_,I=-x,C=I+f,L=R>=I-Pr/2&&R<=C+Pr/2;if(!T&&L){r&&r();return}let k;if(T)if(y===1/0||y===0)k=3;else{const V=y/s.duration*100,B=Pr*100/(m*V);k=Math.max(1,Math.min(1200,B*1.05))}else k=b;let M=x;if(!L||T){const V=m*k,B=c/s.duration*V,W=f/2-B,F=f-Pr/2-V,j=Pr/2;M=Math.max(F,Math.min(j,W))}if(t.length===1){const V=a[t[0]];V&&V.links&&(V.links.find(B=>B.type==="timeline"),V.links.find(B=>B.type==="element"))}if(Math.abs(b-k)<.001&&Math.abs(x-M)<.5){r&&r();return}const D=Date.now(),U=400,$=()=>{const V=Date.now()-D,B=Math.min(1,V/U);let W=1-Math.pow(1-B,3);const F=b+(k-b)*W,j=x+(M-x)*W;s.updateTimelineTransform(F,j),B<1?requestAnimationFrame($):(s.updateTimelineTransform(k,M),r&&r())};requestAnimationFrame($)},resetZoom:t=>{const r=e(),s=1,i=Vn(r.isMobile),a=r.timelineScale,o=r.timelineOffset;if(Math.abs(a-s)<.001&&Math.abs(o-i)<.5){t&&t();return}const l=Date.now(),c=800,u=()=>{const f=Date.now()-l,m=Math.min(1,f/c);let g;m<.5?g=2*m*m:g=1-2*(1-m)*(1-m),g=(Math.sin((g-.5)*Math.PI)+1)/2;const y=a+(s-a)*g,b=o+(i-o)*g;r.updateTimelineTransform(y,b),m<1?requestAnimationFrame(u):(r.updateTimelineTransform(s,i),t&&t())};requestAnimationFrame(u)},enableAutoFollow:()=>{n({isAutoFollowEnabled:!0})},disableAutoFollow:()=>{n({isAutoFollowEnabled:!1})},checkAndCenterPlayhead:t=>{const r=e(),s=r.duration;if(s===0)return;if(t>=r.visibleTimeStart&&t<=r.visibleTimeEnd)r.enableAutoFollow();else{const a=r.viewportWidth,l=(a-Vn(r.isMobile)*2)*r.timelineScale,c=t/s*l,u=a/2-c,f=a-Vn(r.isMobile)-l,m=Vn(r.isMobile),g=Math.max(f,Math.min(m,u)),y=r.timelineOffset,b=Date.now(),x=400,S=()=>{const T=Date.now()-b,_=Math.min(1,T/x),R=1-Math.pow(1-_,3),I=y+(g-y)*R;r.updateTimelineTransform(r.timelineScale,I),_<1?requestAnimationFrame(S):r.enableAutoFollow()};requestAnimationFrame(S)}},ensurePlayheadVisible:()=>{const t=e(),s=He.getState().currentTime,i=t.duration;if(i===0)return;const a=s>=t.visibleTimeStart&&s<=t.visibleTimeEnd,l=(t.visibleTimeEnd-t.visibleTimeStart)*.15,c=s<t.visibleTimeStart+l||s>t.visibleTimeEnd-l;if(a&&!c)return;const u=t.viewportWidth,m=(u-Vn(t.isMobile)*2)*t.timelineScale,g=s/i*m,y=u/2-g,b=u-Vn(t.isMobile)-m,x=Vn(t.isMobile),S=Math.max(b,Math.min(x,y)),T=t.timelineOffset,_=Date.now(),R=400,I=()=>{const C=Date.now()-_,L=Math.min(1,C/R),k=1-Math.pow(1-L,3),M=T+(S-T)*k;t.updateTimelineTransform(t.timelineScale,M),L<1?requestAnimationFrame(I):t.updateTimelineTransform(t.timelineScale,S)};requestAnimationFrame(I)},zoomIn:()=>{const t=e(),r=t.timelineScale,s=Math.min(r*1.5,1200);if(Math.abs(r-s)<.001)return;const i=(t.visibleTimeStart+t.visibleTimeEnd)/2,a=t.viewportWidth,l=(a-Vn(t.isMobile)*2)*s,c=i/t.duration*l,u=a/2-c,f=a-Vn(t.isMobile)-l,m=Vn(t.isMobile),g=Math.max(f,Math.min(m,u)),y=t.timelineOffset,b=Date.now(),x=400,S=()=>{const T=Date.now()-b,_=Math.min(1,T/x),R=1-Math.pow(1-_,3),I=r+(s-r)*R,C=y+(g-y)*R;t.updateTimelineTransform(I,C),_<1?requestAnimationFrame(S):t.updateTimelineTransform(s,g)};requestAnimationFrame(S)},zoomOut:()=>{const t=e(),r=t.timelineScale,s=Math.max(r/1.5,1);if(Math.abs(r-s)<.001)return;const i=(t.visibleTimeStart+t.visibleTimeEnd)/2,a=t.viewportWidth,l=(a-Vn(t.isMobile)*2)*s,c=i/t.duration*l,u=a/2-c,f=a-Vn(t.isMobile)-l,m=Vn(t.isMobile),g=Math.max(f,Math.min(m,u)),y=t.timelineOffset,b=Date.now(),x=400,S=()=>{const T=Date.now()-b,_=Math.min(1,T/x),R=1-Math.pow(1-_,3),I=r+(s-r)*R,C=y+(g-y)*R;t.updateTimelineTransform(I,C),_<1?requestAnimationFrame(S):t.updateTimelineTransform(s,g)};requestAnimationFrame(S)},setMobileState:t=>{const r=e();if(r.isMobile!==t){const s=Vn(t),i=Vn(r.isMobile);let a=r.timelineOffset;if(i!==s){const o=s-i;a=r.timelineOffset+o}n({isMobile:t,timelineOffset:a}),r.updateTimelineTransform(r.timelineScale,a)}},recordPlayheadInteraction:t=>n({lastPlayheadInteraction:{timestamp:Date.now(),playheadTime:t}}),getLastPlayheadInteraction:()=>e().lastPlayheadInteraction,clearPlayheadInteraction:()=>n({lastPlayheadInteraction:null}),getPixelsPerSecond:()=>{const t=e();return t.playbarWidth/t.duration},getTimeFromPosition:t=>{const r=e();return r.playbarWidth===0?0:t/r.playbarWidth*r.duration},getPositionFromTime:t=>{const r=e();return r.duration===0?0:t/r.duration*r.playbarWidth}}))),xg=Object.freeze(Object.defineProperty({__proto__:null,useTimelineStore:yt},Symbol.toStringTag,{value:"Module"}));function Cw(n,e,t,r=320,s=OH){const i=e?.position||{x:0,y:0},a=e?.dimensions||{width:1200},o=e?.duration||0,l=a.width,c=l/(16/9),f=i.x+l/2-t/2,m=o>0?n/o:0,y=f+m*t-r/2,T=i.y+c+60+40+s;return{x:y,y:T}}const Lbe=Object.freeze(Object.defineProperty({__proto__:null,playheadToCanvasCoordinates:Cw},Symbol.toStringTag,{value:"Module"})),Dbe={elements:{},rootElements:[],tags:{}},Pbe={scale:mU*1.5,positionX:0,positionY:0,previousScale:mU*1.5,wrapperComponent:null,contentComponent:null},De=Ws()(Ui(bi((n,e)=>({boardState:Dbe,isDataLoaded:!1,flaskId:null,currentAssetId:null,availableAssets:[],hasEditingPermissions:!1,currentUserId:null,currentUserName:null,currentUserAvatarUrl:null,selectedFrames:[],selectedChildrenIds:[],selectedElementId:void 0,pillOperationState:{isActive:!1,operationType:null,elementId:null,linkIndex:null,currentTime:null,timeRange:null},transformState:Pbe,isAtMinZoom:!0,userProfiles:{},unseenElementIds:new Set,lastSeenAt:null,timelineDraft:null,timelineDraftManuallyPositioned:!1,replyDrafts:{},replyDraftsManuallyPositioned:{},setBoardState:t=>n(r=>{const s=Object.values(t.elements).filter(i=>i.type==="recording");s.length>0&&(`${s.length}`,s.map(i=>({id:i.id,recordingState:i.recordingState,videoUrl:i.videoUrl,thumbnailUrl:i.thumbnailUrl}))),r.boardState=t,r.boardState.elements={...t.elements}}),setIsDataLoaded:t=>n(r=>{r.isDataLoaded=t}),setHasEditingPermissions:t=>n(r=>{r.hasEditingPermissions=t}),setCurrentUserData:(t,r,s)=>n(i=>{i.currentUserId=t,i.currentUserName=r,i.currentUserAvatarUrl=s}),setSelectedFrames:t=>{n(r=>{r.selectedFrames=t}),t.length===1&&e().seekToElementTimestamp(t[0])},setSelectedChildrenIds:t=>n(r=>{r.selectedChildrenIds=t}),setSelectedElementId:t=>n(r=>{r.selectedElementId=t}),setUserProfiles:t=>n(r=>{r.userProfiles=t}),setFlaskId:t=>n(r=>{r.flaskId=t}),createElement:async(t,r={},s,i,a=!1)=>{const o=e();if(!o.hasEditingPermissions)return console.warn(`Attempted to create ${t} element without editing permissions - blocked`),null;const{rootElements:l,elements:c}=o.boardState,u=td(),f=r.createdBy||o.currentUserId,m=r.creatorName||o.currentUserName||null,g=r.creatorAvatarUrl||o.currentUserAvatarUrl||null;let y;try{const{useToolbarStore:b}=await Ze(async()=>{const{useToolbarStore:T}=await Promise.resolve().then(()=>di);return{useToolbarStore:T}},void 0),x=b.getState(),S=x.pendingTimelineLink;if(S){const T=S.start===S.end?{type:"timeline",timestamp:S.start}:{type:"timeline",timeRange:{start:S.start,end:S.end}},_=(r.links||[]).filter(R=>R&&R.type!=="timeline");r={...r,links:[..._,T]}}if(!r.tagIds||r.tagIds.length===0){const T=x.selectedTags;T&&T.length>0&&(r={...r,tagIds:T})}}catch{}if(r.links&&r.links.length>0){const b=r.links.find(x=>x.type==="timeline"&&x.timestamp!==void 0&&!x.timeRange);if(b&&b.timestamp!==void 0){const x=e().getLastElementAtTimestamp(b.timestamp);if(x){const _=o.boardState.elements[x]?.links?.find(L=>L.type==="timeline"&&L.timestamp!==void 0)?.timestamp;`${b.timestamp}${_}${x}${Math.abs((b.timestamp||0)-(_||0))}`;const I=e().findRootElementInThread(x)||x,C=r.links.filter(L=>!(L.type==="timeline"&&L.timestamp!==void 0&&!L.timeRange));r={...r,links:[...C,{type:"element",targetElementId:I}]},Ze(async()=>{const{toast:L}=await Promise.resolve().then(()=>Fy);return{toast:L}},void 0).then(({toast:L})=>{L.info("There was already something here. Comment added as a reply.")}).catch(()=>{console.warn("[CanvasStore] Failed to show toast notification")})}}}switch(t){case"text":const b=Ibe();y={id:u,title:r.title||`Text ${Object.keys(o.boardState.elements).length+1}`,position:r.position||{x:0,y:0},dimensions:r.dimensions||b,type:"text",children:[],content:r.content||"",parentId:s,createdBy:f,createdAt:r.createdAt||new Date().toISOString(),creatorName:m,creatorAvatarUrl:g,links:r.links||[],tagIds:r.tagIds||[],attachments:r.attachments?r.attachments.map(S=>({...S,elementId:u})):[]};break;case"recording":const x={width:Pr,height:240};y={id:u,title:r.title||`Recording ${Object.keys(o.boardState.elements).length+1}`,position:r.position||{x:0,y:0},dimensions:r.dimensions||x,type:"recording",children:[],recordingType:r.recordingType||"thoughts",recordingId:r.recordingId||void 0,videoUrl:r.videoUrl||void 0,thumbnailUrl:r.thumbnailUrl||void 0,errorMessage:r.errorMessage||void 0,parentId:s,createdBy:f,createdAt:r.createdAt||new Date().toISOString(),creatorName:m,creatorAvatarUrl:g,links:r.links||[],tagIds:r.tagIds||[]};break;default:return console.warn(`Unknown element type: ${t}`),null}if(n(b=>{b.boardState.elements[u]=y,s?b.boardState.elements[s]&&b.boardState.elements[s].children.push(u):b.boardState.rootElements.push(u),_o.getState().markElementAsNew(u),f&&!b.userProfiles[f]&&(b.userProfiles[f]={id:f,full_name:m}),b.boardState.elements={...b.boardState.elements}}),!r.skipPersist)try{await ln.getState().saveElement({id:u,flask_id:o.flaskId,asset_id:o.currentAssetId,type:t,title:y.title,content:y.content,links:y.links,tag_ids:y.tagIds,created_by:f,creator_name:m,creator_avatar_url:g,timeline_timestamp:void 0,timeline_start:void 0,timeline_end:void 0,parent_element_id:void 0,...t==="recording"&&{recording_type:y.recordingType,recording_id:y.recordingId,video_url:y.videoUrl,thumbnail_url:y.thumbnailUrl}})}catch(b){throw console.error("[CanvasStore] Failed to persist element:",b),n(x=>{delete x.boardState.elements[u],x.boardState.rootElements=x.boardState.rootElements.filter(S=>S!==u),s&&x.boardState.elements[s]&&(x.boardState.elements[s].children=x.boardState.elements[s].children.filter(S=>S!==u))}),b}n(b=>{b.selectedFrames=[u],b.selectedChildrenIds=[]});try{const{useToolbarStore:b}=await Ze(async()=>{const{useToolbarStore:S}=await Promise.resolve().then(()=>di);return{useToolbarStore:S}},void 0),x=b.getState();x.setPendingTimelineLink(null),x.clearSelectedTags()}catch{}try{const{useTimelineStore:b}=await Ze(async()=>{const{useTimelineStore:x}=await Promise.resolve().then(()=>xg);return{useTimelineStore:x}},void 0);b.getState().zoomToShowElements([u])}catch{}if(typeof window<"u"&&Yt.isAvailable()){let b;t==="text"?b="text":t==="recording"?b=(r.recordingType||"thoughts")==="screen"?"screen":"recording":b=t;let x="other",S;r?.createdViaKeyboard?(x="keyboard_shortcut",S=r.keyboardShortcut):i==="keyboard_shortcuts"?x="keyboard_shortcut":i==="playheadmenu"?x="toolbar_click":i||(x="toolbar_click"),ybe({elementId:u,flaskId:o.flaskId,userId:f,type:b,createdVia:i,input_method:x,shortcut_used:S})}return u},updateElement:async(t,r)=>{const s=e(),i=s.boardState.elements[t];if(i){if(!s.hasEditingPermissions){console.warn(`Attempted to update element ${t} without editing permissions - blocked`);return}if(e().checkElementOwnership(t,"update")){n(a=>{a.boardState.elements[t]&&(Object.assign(a.boardState.elements[t],r),a.boardState.elements={...a.boardState.elements})});try{const a={};if(r.title!==void 0&&(a.title=r.title),r.links!==void 0&&(a.links=r.links),r.tagIds!==void 0&&(a.tag_ids=r.tagIds),i.type==="text"&&r.content!==void 0&&(a.content=r.content),i.type==="recording"){const o=r;o.recordingId!==void 0&&(a.recording_id=o.recordingId),o.videoUrl!==void 0&&(a.video_url=o.videoUrl),o.thumbnailUrl!==void 0&&(a.thumbnail_url=o.thumbnailUrl),o.duration!==void 0&&(a.duration=o.duration),o.hasAIInsights!==void 0&&(a.has_ai_insights=o.hasAIInsights),o.aiSummary!==void 0&&(a.ai_summary=o.aiSummary)}if(await ln.getState().updateElement(t,a),i.type==="recording"){const o=r;if(o.aiSummary!==void 0){const l=i;if(l.recordingId){const c={ai_summary:o.aiSummary},{error:u}=await Lr.from("recordings").update(c).eq("id",l.recordingId);u&&console.error("[CanvasStore] Failed to update recording summary in recordings table:",u)}}}}catch(a){throw console.error("[CanvasStore] Failed to persist element update:",a),n(o=>{o.boardState.elements[t]&&(Object.assign(o.boardState.elements[t],i),o.boardState.elements={...o.boardState.elements})}),a}}}},deleteElementsDirectly:async t=>{if(!t.length)return 0;const r=e();if(!r.hasEditingPermissions)return console.warn("Attempted to delete elements without editing permissions - blocked"),0;const s=[];for(const u of t)e().checkElementOwnership(u,"deletion")||s.push(u);if(s.length>0)return console.warn(`[CanvasStore] Cannot delete ${s.length} elements not owned by current user:`,s),0;try{const{useRecordingStore:u}=await Ze(async()=>{const{useRecordingStore:g}=await Promise.resolve().then(()=>wk);return{useRecordingStore:g}},void 0),f=u.getState(),m=f.activeRecordingElementId;m&&t.includes(m)&&(`${m}`,await f.stopRecording(),`${m}`)}catch(u){console.error("[CanvasStore] Error checking/cleaning recording state during deletion:",u)}try{const{useMediaStore:u}=await Ze(async()=>{const{useMediaStore:g}=await Promise.resolve().then(()=>oa);return{useMediaStore:g}},void 0),f=u.getState(),m=f.activeRecordingId;if(m)for(const g of t){const y=r.boardState.elements[g];if(y&&y.attachments&&y.attachments.some(x=>x.id===m)){`${g}${m}`,f.clearActiveRecording(),`${m}`;break}}}catch(u){console.error("[CanvasStore] Error checking/cleaning recording playback state during deletion:",u)}let i=0;const a=[],o=new Set(t),l=e().boardState.elements,c=u=>{const f=l[u];f?.children&&f.children.forEach(m=>{o.has(m)||(o.add(m),c(m))})};t.forEach(c),n(u=>{const f=u.boardState.elements;o.forEach(m=>{if(f[m]){const g=f[m];if(g.type==="recording"&&g.videoUrl){const y=g;a.push({url:y.videoUrl,thumbnailUrl:y.thumbnailUrl})}if(g.parentId&&f[g.parentId]){const y=f[g.parentId];y.children=y.children.filter(b=>b!==m)}delete f[m],i++,u.boardState.assetId===m&&(u.boardState.assetId=void 0)}}),u.boardState.rootElements=u.boardState.rootElements.filter(m=>!o.has(m))});try{const{error:u}=await Lr.from("elements").delete().in("id",Array.from(o));if(u){console.error("[CanvasStore] Failed to delete elements from database:",u);const{toast:f}=await Ze(async()=>{const{toast:m}=await Promise.resolve().then(()=>Fy);return{toast:m}},void 0);f.error("Failed to delete elements. Please try again.")}else`${o.size}`}catch(u){console.error("[CanvasStore] Error deleting elements from database:",u);const{toast:f}=await Ze(async()=>{const{toast:m}=await Promise.resolve().then(()=>Fy);return{toast:m}},void 0);f.error("Failed to delete elements. Please try again.")}return i},setFramePositionDirectly:(t,r)=>n(s=>{s.boardState.elements[t]&&(s.boardState.elements[t].position=r,s.boardState.elements={...s.boardState.elements})}),finalizeFramePosition:async(t,r)=>{e().setFramePositionDirectly(t,r)},addLinkToElement:async(t,r)=>{if(!e().hasEditingPermissions){console.warn(`Attempted to add link to element ${t} without editing permissions - blocked`);return}if(!e().checkElementOwnership(t,"link addition"))return;const i=e().boardState.elements[t];if(!i)return;const a=[...i.links||[],r];n(o=>{const l=o.boardState.elements[t];l&&(l.links=a,o.boardState.elements={...o.boardState.elements})});try{await ln.getState().updateElement(t,{links:a})}catch(o){console.error("[CanvasStore] Failed to persist link addition:",o)}},updateElementLink:async(t,r,s)=>{if(!e().hasEditingPermissions){console.warn(`Attempted to update link on element ${t} without editing permissions - blocked`);return}if(!e().checkElementOwnership(t,"link update"))return;const a=e().boardState.elements[t];if(!a||!a.links||!a.links[r])return;const o=[...a.links];o[r]={...o[r],...s},n(l=>{const c=l.boardState.elements[t];c&&(c.links=o,l.boardState.elements={...l.boardState.elements})});try{await ln.getState().updateElement(t,{links:o})}catch(l){console.error("[CanvasStore] Failed to persist link update:",l)}},removeElementLink:async(t,r)=>{if(!e().hasEditingPermissions){console.warn(`Attempted to remove link from element ${t} without editing permissions - blocked`);return}e().checkElementOwnership(t,"link removal")&&n(i=>{const a=i.boardState.elements[t];a&&a.links&&(a.links.splice(r,1),i.boardState.elements={...i.boardState.elements})})},updateElementLinkVisual:(t,r,s)=>{n(i=>{const a=i.boardState.elements[t];a&&a.links&&a.links[r]&&(Object.assign(a.links[r],s),i.boardState.elements={...i.boardState.elements})})},commitElementLinkUpdate:async(t,r)=>{if(!e().hasEditingPermissions){console.warn(`Attempted to commit link update on element ${t} without editing permissions - blocked`);return}const i=e().boardState.elements[t];if(i&&i.links)try{await ln.getState().updateElement(t,{links:i.links})}catch(a){console.error("[CanvasStore] Failed to commit link update:",a)}},getTimelineLinks:()=>{const t=e(),r=[];return Object.entries(t.boardState.elements).forEach(([s,i])=>{i&&i.links&&i.links.forEach((a,o)=>{a.type==="timeline"&&r.push({elementId:s,element:i,linkIndex:o,link:a})})}),r},getElementLinks:()=>{const t=e(),r=[];return Object.entries(t.boardState.elements).forEach(([s,i])=>{i&&i.links&&i.links.forEach((a,o)=>{a.type==="element"&&r.push({elementId:s,element:i,linkIndex:o,link:a})})}),r},hasElementsLinkingToIt:t=>{const r=e();for(const s of Object.values(r.boardState.elements))if(s&&s.links&&s.links.some(a=>a&&a.type==="element"&&a.targetElementId===t))return!0;return!1},findRootElementInThread:t=>{const r=e(),s=r.boardState.elements[t];if(!s)return null;if(s.links?.some(o=>o.type==="timeline"))return t;const a=s.links?.find(o=>o.type==="element");if(a&&a.targetElementId){const o=new Set;let l=a.targetElementId;for(;l&&!o.has(l);){o.add(l);const c=r.boardState.elements[l];if(!c)break;if(c.links?.some(m=>m.type==="timeline"))return l;const f=c.links?.find(m=>m.type==="element");if(f&&f.targetElementId)l=f.targetElementId;else break}}return null},fetchUnseenElements:async()=>{const t=e(),{currentAssetId:r,currentUserId:s,boardState:i}=t;if(!r||!s){n(a=>{a.unseenElementIds=new Set,a.lastSeenAt=null});return}try{const{supabase:a}=await Ze(async()=>{const{supabase:u}=await Promise.resolve().then(()=>hg);return{supabase:u}},void 0),{data:o}=await a.from("asset_last_seen").select("last_seen_at").eq("user_id",s).eq("asset_id",r).single(),l=o?.last_seen_at||null,c=new Set;Object.values(i.elements).forEach(u=>{u.createdBy!==s&&(l?u.createdAt&&new Date(u.createdAt)>new Date(l)&&c.add(u.id):c.add(u.id))}),n(u=>{u.unseenElementIds=c,u.lastSeenAt=l}),`${c.size}`}catch(a){console.error("[CanvasStore] Error fetching unseen elements:",a),n(o=>{o.unseenElementIds=new Set,o.lastSeenAt=null})}},_getDraft:(t="timeline")=>{const r=e();return t==="timeline"?r.timelineDraft:r.replyDrafts[t]},_setDraft:(t="timeline",r)=>{n(s=>{t==="timeline"?s.timelineDraft=r:r===null?delete s.replyDrafts[t]:s.replyDrafts[t]=r})},_getDraftManuallyPositioned:(t="timeline")=>{const r=e();return t==="timeline"?r.timelineDraftManuallyPositioned:r.replyDraftsManuallyPositioned[t]||!1},_setDraftManuallyPositioned:(t="timeline",r)=>{n(s=>{t==="timeline"?s.timelineDraftManuallyPositioned=r:s.replyDraftsManuallyPositioned[t]=r})},initializeDraft:(t,r="timeline")=>{const s=`draft-${td()}`,i=cn.getState().user,a=cn.getState().profile,o=1200;let l;if(t.type==="timeline"){const u=t.timestamp||t.timeRange?.start||0;l=Cw(u,null,o,320,30)}else l=Cw(0,null,o,320,30);const c={id:s,type:"text",title:"Text",content:"",position:l,children:[],links:[t],tagIds:[],attachments:[],createdBy:i?.id,createdAt:new Date().toISOString(),creatorName:a?.full_name||i?.email||"User",creatorAvatarUrl:a?.avatar_url};e()._setDraft(r,c),e()._setDraftManuallyPositioned(r,!1)},updateDraftText:(t,r="timeline")=>{n(s=>{const i=r==="timeline"?s.timelineDraft:s.replyDrafts[r];i&&(i.content=t)})},updateDraftLink:(t,r=!1,s="timeline")=>{n(i=>{const a=s==="timeline"?i.timelineDraft:i.replyDrafts[s];a&&(a.links=[t]),r&&(s==="timeline"?i.timelineDraftManuallyPositioned=!0:i.replyDraftsManuallyPositioned[s]=!0)})},addDraftAttachment:(t,r="timeline")=>{n(s=>{const i=r==="timeline"?s.timelineDraft:s.replyDrafts[r];i&&(i.attachments||(i.attachments=[]),i.attachments.push(t))}),t.id},updateDraftAttachment:(t,r,s="timeline")=>{n(i=>{const a=s==="timeline"?i.timelineDraft:i.replyDrafts[s];if(a){const o=a.attachments.findIndex(l=>l.id===t);o!==-1&&(a.attachments[o]={...a.attachments[o],...r})}})},removeDraftAttachment:(t,r="timeline")=>{n(s=>{const i=r==="timeline"?s.timelineDraft:s.replyDrafts[r];i&&(i.attachments=i.attachments.filter(a=>a.id!==t))})},deleteAttachment:async(t,r)=>{const s=e(),i=s.boardState.elements[t];if(!i||!i.attachments){console.warn("[CanvasStore] Element or attachments not found:",t);return}if(!s.hasEditingPermissions){console.warn("[CanvasStore] Attempted to delete attachment without editing permissions - blocked");return}if(!e().checkElementOwnership(t,"attachment deletion"))return;const a=i.attachments.find(o=>o.id===r);if(!a){console.warn("[CanvasStore] Attachment not found:",r);return}n(o=>{const l=o.boardState.elements[t];l&&l.attachments&&(l.attachments=l.attachments.filter(c=>c.id!==r),o.boardState.elements={...o.boardState.elements})});try{const{error:o}=await Lr.from("attachments").delete().eq("id",r);if(o)throw console.error("[CanvasStore] Failed to delete attachment:",o),o;if(a.recordingId){const{error:l}=await Lr.from("recordings").delete().eq("id",a.recordingId);l?console.error("[CanvasStore] Failed to delete recording:",l):a.recordingId}}catch(o){console.error("[CanvasStore] Error deleting attachment:",o),n(c=>{const u=c.boardState.elements[t];u&&u.attachments&&(u.attachments.push(a),c.boardState.elements={...c.boardState.elements})});const{toast:l}=await Ze(async()=>{const{toast:c}=await Promise.resolve().then(()=>Fy);return{toast:c}},void 0);l.error("Failed to delete attachment. Please try again.")}},deleteAttachmentWithConfirmation:(t,r)=>{const{openDeletionConfirmation:s}=Kc.getState();s([r],()=>{e().deleteAttachment(t,r)},"attachment")},addTagToDraft:(t,r="timeline")=>{n(s=>{const i=r==="timeline"?s.timelineDraft:s.replyDrafts[r];i&&(i.tagIds||(i.tagIds=[]),i.tagIds.includes(t)||i.tagIds.push(t))})},removeTagFromDraft:(t,r="timeline")=>{n(s=>{const i=r==="timeline"?s.timelineDraft:s.replyDrafts[r];i&&i.tagIds&&(i.tagIds=i.tagIds.filter(a=>a!==t))})},getDraftElement:(t="timeline")=>e()._getDraft(t),submitDraft:async(t="timeline")=>{const r=e()._getDraft(t);if(!r)return console.warn("[CanvasStore] No draft element to submit for key:",t),null;r.id;const{useMediaStore:s}=await Ze(async()=>{const{useMediaStore:l}=await Promise.resolve().then(()=>oa);return{useMediaStore:l}},void 0),i=s.getState().currentTime,o=(t==="timeline"?e().timelineDraftManuallyPositioned:e().replyDraftsManuallyPositioned[t])?r.links:r.links.map(l=>l.type==="timeline"?{type:"timeline",timestamp:i}:l);try{const l=await e().createElement("text",{position:r.position,content:r.content,title:r.title,links:o,tagIds:r.tagIds,attachments:r.attachments,createdBy:r.createdBy,createdAt:r.createdAt,creatorName:r.creatorName,creatorAvatarUrl:r.creatorAvatarUrl},void 0,void 0);if(!l)throw new Error("Failed to create element");return r.attachments.length>0&&(r.attachments.length,(async()=>{try{const{supabase:c}=await Ze(async()=>{const{supabase:x}=await Promise.resolve().then(()=>hg);return{supabase:x}},void 0),u=r.attachments.filter(x=>x.type==="recording"&&x.recordingId&&x.recordingId.startsWith("temp-")?(x.recordingId,!1):!0);if(u.length===0)return;u.length,r.attachments.length;const f=new Map,m=u.map((x,S)=>{const T=td();f.set(x.id,T);const _={id:T,element_id:l,attachment_type:x.type,display_order:S,created_by:x.createdBy||void 0,created_at:x.createdAt||new Date().toISOString()};return x.type==="recording"?{..._,recording_id:x.recordingId||void 0,recording_type:x.recordingType||void 0}:x.type==="image"?{..._,image_url:x.imageUrl||void 0,image_width:x.imageWidth||void 0,image_height:x.imageHeight||void 0,file_size:x.fileSize||void 0,mime_type:x.mimeType||void 0,metadata:x.metadata||void 0}:_}),{error:g}=await c.from("attachments").insert(m);if(g){console.error("[CanvasStore] Failed to create attachment records:",g);return}m.length;const y=u.filter(x=>x.type==="recording"&&x.recordingId&&!x.recordingId.startsWith("temp-")).map(x=>x.recordingId).filter(Boolean);if(y.length>0){const{error:x}=await c.from("recordings").update({element_id:l}).in("id",y);x?console.error("[CanvasStore] Failed to update recordings:",x):y.length}const b=u.filter(x=>x.type==="image");if(b.length>0)for(const x of b){const S=x.metadata?.storagePath;if(!S){console.warn("[CanvasStore] Image attachment missing storage_path, skipping update:",x.id);continue}const T=f.get(x.id);if(!T){console.error("[CanvasStore] Could not find real attachment ID for temp ID:",x.id);continue}const{error:_}=await c.from("images").update({attachment_id:T}).eq("storage_path",S).is("attachment_id",null);_&&console.error("[CanvasStore] Failed to update image record:",_)}}catch(c){console.error("[CanvasStore] Error persisting attachments:",c)}})()),e()._setDraft(t,null),e()._setDraftManuallyPositioned(t,!1),l}catch(l){return console.error("[CanvasStore] Failed to submit draft:",l),null}},discardDraft:async(t="timeline")=>{const r=e()._getDraft(t);if(r){if(r.id,r.attachments.length>0)try{const{supabase:s}=await Ze(async()=>{const{supabase:o}=await Promise.resolve().then(()=>hg);return{supabase:o}},void 0),i=r.attachments.map(o=>o.recordingId),{error:a}=await s.from("recordings").delete().in("id",i).is("element_id",null);a?console.error("[CanvasStore] Failed to delete draft recordings:",a):r.attachments.length}catch(s){console.error("[CanvasStore] Error deleting draft recordings:",s)}e()._setDraft(t,null),e()._setDraftManuallyPositioned(t,!1)}},requestDiscardDraft:(t,r="timeline")=>{const s=e()._getDraft(r);if(s?.content,s?.content?.trim().length,s?.attachments?.length,s?.tagIds?.length,!s){t();return}const i=(s.content?.trim().length||0)>0||(s.attachments?.length||0)>0;s.content?.trim().length,s.attachments?.length,s.tagIds?.length,i?Ze(async()=>{const{useToolbarStore:a}=await Promise.resolve().then(()=>di);return{useToolbarStore:a}},void 0).then(({useToolbarStore:a})=>{a.getState().setPendingDiscardCallback(async()=>{await e().discardDraft(r),t()})}):(e().discardDraft(r),t())},initializeCanvas:async(t,r=!1,s=0,i)=>{i?.length,n(o=>{o.isDataLoaded=!1,o.flaskId=t,o.hasEditingPermissions=r});const a=cn.getState();a.user&&n(o=>{o.currentUserId=a.user.id,o.currentUserName=a.profile?.full_name||a.user.email,o.currentUserAvatarUrl=a.profile?.avatar_url});try{let o=i;if(!o){const{data:b,error:x}=await Lr.from("assets").select("*").eq("flask_id",t).order("created_at",{ascending:!1});if(x)throw x;o=b}const l=o?.[s]||o?.[0];if(!l)throw new Error("No assets found for this flask");n(b=>{b.availableAssets=o||[],b.currentAssetId=l.id});const[c,u]=await Promise.all([ln.getState().loadElements(l.id),ln.getState().loadTags(t)]),f={};u.forEach(b=>{f[b.id]={id:b.id,name:b.name,color:b.color||"accent-gray"}});const m={elements:{},rootElements:[],tags:f};c.forEach(b=>{const x={id:b.id,type:b.type,title:b.title||"",position:b.position,dimensions:b.dimensions,parentId:b.parent_id,children:b.children||[],createdBy:b.created_by,createdAt:b.created_at,creatorName:b.creator_name,creatorAvatarUrl:b.creator_avatar_url,links:b.links||[],tagIds:b.tag_ids||[],attachments:b.attachments||[]};b.type==="text"?x.content=b.content||"":b.type==="asset"?Object.assign(x,{youtubeUrl:b.youtube_url,playbarWidth:b.playbar_width,duration:b.duration,startTime:b.start_time,playbackRate:b.playback_rate,isMuted:b.is_muted}):b.type==="recording"&&(b.id,b.recordings,b.recordings,b.recordings?.ai_processing_status??b.ai_processing_status,b.ai_summary,b.recordings?.ai_transcript??b.ai_transcript,(b.recordings?.ai_transcript??b.ai_transcript)?.length,Object.assign(x,{recordingType:b.recording_type,recordingId:b.recording_id,videoUrl:b.recordings?.hls_url??b.video_url,thumbnailUrl:b.recordings?.thumbnail_url??b.thumbnail_url,duration:b.recordings?.duration??b.duration,recordingState:"completed",aiStatus:b.recordings?.ai_processing_status??b.ai_processing_status??"pending",aiSummary:b.ai_summary||"",hasAIInsights:b.has_ai_insights??!1,aiInsights:(b.recordings?.ai_processing_status??b.ai_processing_status)==="completed"&&b.ai_summary?{transcript:b.recordings?.ai_transcript??b.ai_transcript,summary:b.ai_summary}:void 0}),b.id,x.aiInsights,x.aiInsights?.transcript),m.elements[b.id]=x,b.parent_id||m.rootElements.push(b.id),b.type==="asset"&&(m.assetId=b.id)}),n(b=>{b.boardState={elements:m.elements||{},rootElements:m.rootElements||[],tags:m.tags||{},assetId:m.assetId},b.boardState.elements={...m.elements}});const g=new Set;if(Object.values(m.elements).forEach(b=>{b.createdBy&&g.add(b.createdBy)}),g.size>0){g.size;try{await cn.getState().fetchUserProfiles(Array.from(g));const b=cn.getState().userProfiles;n(x=>{x.userProfiles={...b},Object.values(x.boardState.elements).forEach(S=>{if(S.createdBy&&b[S.createdBy]){const T=b[S.createdBy];S.creatorName=T.name||T.full_name||T.email||S.creatorName,S.creatorAvatarUrl=T.avatar_url||S.creatorAvatarUrl}}),x.boardState.elements={...x.boardState.elements}})}catch(b){console.error("[CanvasStore] Failed to fetch user profiles:",b)}}n(b=>{b.isDataLoaded=!0}),await e().fetchUnseenElements();const{useTimelineStore:y}=await Ze(async()=>{const{useTimelineStore:b}=await Promise.resolve().then(()=>xg);return{useTimelineStore:b}},void 0);y.getState().resetZoom()}catch(o){throw console.error("[CanvasStore] Canvas initialization failed:",o),n(l=>{l.isDataLoaded=!1,l.boardState={elements:{},rootElements:[],tags:{}}}),o}},switchAsset:async t=>{const r=e();if(r.currentAssetId===t)return;if(!r.availableAssets.find(i=>i.id===t)){console.error("[CanvasStore] Asset not found in available assets:",t);return}n(i=>{i.isDataLoaded=!1,i.currentAssetId=t});try{const[i,a]=await Promise.all([ln.getState().loadElements(t),ln.getState().loadTags(r.flaskId)]),o={};a.forEach(u=>{o[u.id]={id:u.id,name:u.name,color:u.color||"accent-gray"}});const l={elements:{},rootElements:[],tags:o};i.forEach(u=>{const f={id:u.id,type:u.type,title:u.title||"",position:u.position,dimensions:u.dimensions,parentId:u.parent_id,children:u.children||[],createdBy:u.created_by,createdAt:u.created_at,creatorName:u.creator_name,creatorAvatarUrl:u.creator_avatar_url,links:u.links||[],tagIds:u.tag_ids||[],attachments:u.attachments||[]};u.type==="text"?f.content=u.content||"":u.type==="recording"&&Object.assign(f,{recordingType:u.recording_type,recordingId:u.recording_id,videoUrl:u.video_url,thumbnailUrl:u.thumbnail_url,duration:u.duration,recordingState:"completed",aiStatus:u.ai_processing_status||"pending",aiSummary:u.ai_summary||"",hasAIInsights:!1,aiInsights:u.ai_processing_status==="completed"&&u.ai_summary?{transcript:u.ai_transcript,summary:u.ai_summary}:void 0}),l.elements[u.id]=f,u.parent_id||l.rootElements.push(u.id)}),n(u=>{u.boardState=l,u.boardState.elements={...l.elements},u.isDataLoaded=!0}),await e().fetchUnseenElements();const{useTimelineStore:c}=await Ze(async()=>{const{useTimelineStore:u}=await Promise.resolve().then(()=>xg);return{useTimelineStore:u}},void 0);c.getState().resetZoom()}catch(i){throw console.error("[CanvasStore] Failed to switch asset:",i),n(a=>{a.isDataLoaded=!0}),i}},reset:()=>n(t=>{t.boardState={elements:{},rootElements:[],tags:{}},t.isDataLoaded=!1,t.selectedFrames=[],t.selectedChildrenIds=[],t.selectedElementId=void 0,t.pillOperationState={isActive:!1,operationType:null,elementId:null,linkIndex:null,currentTime:null,timeRange:null},t.userProfiles={},t.flaskId=null,t.currentAssetId=null,t.availableAssets=[],t.currentUserId=null,t.currentUserName=null,t.currentUserAvatarUrl=null}),startPillOperation:(t,r,s,i,a)=>{n(o=>{o.pillOperationState={isActive:!0,operationType:t,elementId:r,linkIndex:s,currentTime:i,timeRange:a||null}})},updatePillOperation:(t,r)=>{n(s=>{s.pillOperationState={...s.pillOperationState,currentTime:t,timeRange:r||null}})},endPillOperation:()=>{n(t=>{t.pillOperationState={isActive:!1,operationType:null,elementId:null,linkIndex:null,currentTime:null,timeRange:null}})},selectElement:(t,r)=>{const s=e().boardState.elements[t];s&&dn.getState().isElementVisible(s)&&(n(a=>{a.selectedFrames=[t],a.selectedChildrenIds=[t]}),e().seekToElementTimestamp(t))},toggleElementSelection:t=>{const r=e().boardState.elements[t];if(!(r&&dn.getState().isElementVisible(r)))return;const i=e(),{selectedFrames:a}=i;a.includes(t)?n(o=>{o.selectedFrames=[],o.selectedChildrenIds=[]}):(n(o=>{o.selectedFrames=[t],o.selectedChildrenIds=[t]}),e().seekToElementTimestamp(t))},clearSelection:()=>{e(),Ze(async()=>{const{useToolbarStore:t}=await Promise.resolve().then(()=>di);return{useToolbarStore:t}},void 0).then(({useToolbarStore:t})=>{const r=t.getState();r.state,r.textContent,r.textContent.trim(),r.state==="draft"&&!r.textContent.trim()&&!r.editingElementId&&(r.clearText(),r.exitToIdle())}),n(t=>{t.selectedFrames=[],t.selectedChildrenIds=[]})},selectElementWithModifiers:t=>{const s=e().boardState.elements[t];s&&dn.getState().isElementVisible(s)&&(Ze(async()=>{const{useToolbarStore:a}=await Promise.resolve().then(()=>di);return{useToolbarStore:a}},void 0).then(({useToolbarStore:a})=>{const{state:o,exitToIdle:l,clearText:c}=a.getState();o==="draft"&&(c(),l())}),n(a=>{a.selectedFrames=[t],a.selectedChildrenIds=[t]}),e().seekToElementTimestamp(t))},seekToElementTimestamp:t=>{const r=e(),s=r.boardState.elements[t];if(!s||!s.links||r.currentTextEditElementId===t)return;const i=s.links.find(o=>o.type==="timeline");if(!i)return;let a;if(i.timeRange)a=i.timeRange.start;else if(i.timestamp!==void 0)a=i.timestamp;else return;Ze(async()=>{const{useMediaStore:o}=await Promise.resolve().then(()=>oa);return{useMediaStore:o}},void 0).then(({useMediaStore:o})=>{const l=o.getState();l.playerRef&&l.isReady&&l.seek(a)}).catch(o=>{console.warn("[CanvasStore] Failed to import media store for seeking:",o)})},enterTextEditMode:t=>{const r=_o.getState();if(r.currentTextEditElementId===t){e().exitTextEditMode();return}const s=e().boardState.elements[t];if(!(s&&dn.getState().isElementVisible(s)))return;if(!s||s.type!=="text"){console.warn("[CanvasStore] Cannot enter text edit mode for non-text element:",t);return}if(!e().checkElementOwnership(t,"text editing"))return;r.exitDescriptionEditMode();const a=s.content||"";r.enterTextEditMode(t,a),n(o=>{o.selectedFrames=[t],o.selectedChildrenIds=[t]})},exitTextEditMode:()=>{const t=_o.getState();t.currentTextEditElementId,t.exitTextEditMode()},isElementInTextEditMode:t=>_o.getState().isElementInTextEditMode(t),enterDescriptionEditMode:t=>{const r=_o.getState();if(r.currentDescriptionEditElementId===t){e().exitDescriptionEditMode();return}const s=e().boardState.elements[t];!s||s.type!=="recording"||!dn.getState().isElementVisible(s)||(r.exitTextEditMode(),r.enterDescriptionEditMode(t),n(a=>{a.selectedElementId=t,a.selectedFrames=[],a.selectedChildrenIds=[]}))},exitDescriptionEditMode:()=>{_o.getState().exitDescriptionEditMode()},isElementInDescriptionEditMode:t=>_o.getState().isElementInDescriptionEditMode(t),pauseAllRecordings:()=>{const t=new CustomEvent("pauseAllRecordings");window.dispatchEvent(t)},deleteElementsWithConfirmation:async t=>{if(!t.length)return;if(!e().hasEditingPermissions){console.warn("Attempted to delete elements without editing permissions - blocked");return}const s=[];for(const a of t)e().checkElementOwnership(a,"deletion")||s.push(a);if(s.length>0){console.warn(`[CanvasStore] Cannot delete ${s.length} elements not owned by current user:`,s);return}const i=async()=>{await e().deleteElementsDirectly(t)};Kc.getState().openDeletionConfirmation(t,i)},deleteElements:async t=>(await e().deleteElementsWithConfirmation(t),0),createTag:async t=>{const r=e();if(!r.hasEditingPermissions||!r.flaskId)return console.warn(`Attempted to create tag "${t}" without editing permissions - blocked`),null;const s=Object.values(r.boardState.tags||{}).find(u=>u.name.toLowerCase()===t.toLowerCase());if(s)return s.id;const i=td(),a=["accent-purple","accent-blue","accent-teal","accent-green","accent-lime","accent-orange","accent-red"],o=new Set(Object.values(r.boardState.tags||{}).map(u=>u.color));let l=a.find(u=>!o.has(u));if(!l){const f=Object.keys(r.boardState.tags||{}).length%a.length;l=a[f]}const c={id:i,name:t.trim(),color:l};n(u=>{u.boardState.tags||(u.boardState.tags={}),u.boardState.tags[i]=c});try{await ln.getState().saveTag({id:i,flask_id:r.flaskId,name:t.trim(),color:l,created_by:r.currentUserId})}catch(u){throw n(f=>{f.boardState.tags&&delete f.boardState.tags[i]}),u}return typeof window<"u"&&Yt.isAvailable()&&Yt.capture("tag_created",{tagId:i,flaskId:r.flaskId,userId:r.currentUserId,name:t.trim()}),i},addTagToElement:async(t,r)=>{const s=e();if(!s.hasEditingPermissions){console.warn(`Attempted to add tag to element ${t} without editing permissions - blocked`);return}const i=s.boardState.elements[t];if(i){n(a=>{const o=a.boardState.elements[t];o&&(o.tagIds||(o.tagIds=[]),o.tagIds.includes(r)||(o.tagIds.push(r),a.boardState.elements={...a.boardState.elements}))});try{const a=i.tagIds?[...i.tagIds]:[];a.includes(r)||a.push(r),await ln.getState().updateElement(t,{tag_ids:a}),`${r}${t}`}catch(a){console.error("[CanvasStore] Failed to persist tag addition:",a),n(o=>{const l=o.boardState.elements[t];l&&l.tagIds&&(l.tagIds=l.tagIds.filter(c=>c!==r),o.boardState.elements={...o.boardState.elements})})}}},removeTagFromElement:async(t,r)=>{const s=e();if(!s.hasEditingPermissions){console.warn(`Attempted to remove tag from element ${t} without editing permissions - blocked`);return}const i=s.boardState.elements[t];if(!i||!i.tagIds)return;const a=[...i.tagIds];n(o=>{const l=o.boardState.elements[t];l&&l.tagIds&&(l.tagIds=l.tagIds.filter(c=>c!==r),o.boardState.elements={...o.boardState.elements})});try{const o=a.filter(l=>l!==r);await ln.getState().updateElement(t,{tag_ids:o}),`${r}${t}`}catch(o){console.error("[CanvasStore] Failed to persist tag removal:",o),n(l=>{const c=l.boardState.elements[t];c&&(c.tagIds=a,l.boardState.elements={...l.boardState.elements})})}},getTagsByIds:t=>{const s=e().boardState.tags||{};return t.map(i=>s[i]).filter(Boolean)},getAllTags:()=>{const t=e();return Object.values(t.boardState.tags||{})},getElementTags:t=>{const s=e().boardState.elements[t];return!s||!s.tagIds?[]:e().getTagsByIds(s.tagIds)},getElementsWithTag:t=>{const r=e();return Object.values(r.boardState.elements).filter(i=>i.tagIds?.includes(t))},deleteTag:async t=>{const r=e();if(!r.hasEditingPermissions){console.warn(`Attempted to delete tag ${t} without editing permissions - blocked`);return}const s=r.boardState.tags?.[t];n(i=>{Object.values(i.boardState.elements).forEach(a=>{a.tagIds&&(a.tagIds=a.tagIds.filter(o=>o!==t))}),i.boardState.tags&&i.boardState.tags[t]&&delete i.boardState.tags[t],i.boardState.elements={...i.boardState.elements}});try{await ln.getState().deleteTag(t)}catch(i){throw s&&n(a=>{a.boardState.tags||(a.boardState.tags={}),a.boardState.tags[t]=s}),i}},renameTag:async(t,r)=>{const s=e();if(!s.hasEditingPermissions){console.warn(`Attempted to rename tag ${t} without editing permissions - blocked`);return}const i=s.boardState.tags?.[t];if(!i){console.warn(`Tag ${t} not found`);return}n(a=>{a.boardState.tags&&a.boardState.tags[t]&&(a.boardState.tags[t]={...a.boardState.tags[t],name:r.trim()})});try{await ln.getState().renameTag(t,r.trim())}catch(a){throw n(o=>{o.boardState.tags&&i&&(o.boardState.tags[t]=i)}),a}},changeTagColor:async(t,r)=>{const s=e();if(!s.hasEditingPermissions){console.warn(`Attempted to change tag color ${t} without editing permissions - blocked`);return}const i=s.boardState.tags?.[t];if(!i){console.warn(`Tag ${t} not found`);return}n(a=>{a.boardState.tags&&a.boardState.tags[t]&&(a.boardState.tags[t]={...a.boardState.tags[t],color:r})});try{await ln.getState().changeTagColor(t,r)}catch(a){throw n(o=>{o.boardState.tags&&i&&(o.boardState.tags[t]=i)}),a}},getElementAppTags:t=>{const s=e().boardState.elements[t];if(!s||s.type==="asset")return[];const i=[];if(s.createdBy&&s.creatorName){const a=`apptag-creator-${t}`;i.push({id:a,type:"creator",elementId:t,creatorId:s.createdBy,creatorName:s.creatorName,creatorAvatarUrl:s.creatorAvatarUrl})}if(s.createdAt){const a=`apptag-creationtime-${t}`,o=new Date(s.createdAt);i.push({id:a,type:"creationTime",elementId:t,timestamp:Math.floor(o.getTime()/1e3)})}return s.links&&s.links.length>0&&s.links.forEach((a,o)=>{if(a.type==="timeline"){const l=`apptag-linktime-${t}-${o}`;a.timestamp!==void 0?i.push({id:l,type:"linkTime",elementId:t,timestamp:a.timestamp}):a.timeRange&&i.push({id:l,type:"linkTime",elementId:t,timeRange:a.timeRange})}}),i},getAppTagById:t=>{const r=t.match(/^apptag-\w+-(.+?)(?:-\d+)?$/);if(!r)return;const s=r[1];return e().getElementAppTags(s).find(a=>a.id===t)},hasElementAtTimestamp:(t,r=.05)=>{const s=e();for(const i of Object.values(s.boardState.elements))if(!(!i||i.type==="asset")&&i.links&&i.links.length>0){for(const a of i.links)if(a.type==="timeline"){if("timestamp"in a&&a.timestamp!==void 0&&Math.abs(a.timestamp-t)<=r)return!0;if("timeRange"in a&&a.timeRange){const{start:o,end:l}=a.timeRange;if(t>=o-r&&t<=l+r)return!0}}}return!1},getLastElementAtTimestamp:(t,r=.05)=>{const s=e(),i=[];for(const[a,o]of Object.entries(s.boardState.elements))if(!(!o||o.type==="asset")&&o.links&&o.links.length>0){for(const l of o.links)if(l.type==="timeline"&&"timestamp"in l&&l.timestamp!==void 0&&Math.abs(l.timestamp-t)<=r){i.push(a);break}}return i.length>0?i[0]:null},isCurrentUserElementOwner:t=>{const r=e(),s=r.boardState.elements[t];return s?s.createdBy===r.currentUserId:!1},checkElementOwnership:(t,r)=>{const s=e(),i=s.boardState.elements[t];if(!i)return console.warn(`[CanvasStore] Element ${t} not found for ${r} ownership check`),!1;if(!s.hasEditingPermissions)return console.warn(`[CanvasStore] User does not have editing permissions for ${r} on element ${t}`),!1;const a=i.createdBy===s.currentUserId;return a||console.warn(`[CanvasStore] User ${s.currentUserId} is not the owner of element ${t} (owned by ${i.createdBy}) - ${r} blocked`),a},createElementViaKeyboard:async t=>{if(!e().hasEditingPermissions){console.warn(`Cannot create ${t} element - no editing permissions`);return}try{const{useRecordingStore:c}=await Ze(async()=>{const{useRecordingStore:m}=await Promise.resolve().then(()=>wk);return{useRecordingStore:m}},void 0),u=c.getState();if(u.globalState==="recording"){`${t}`;return}if(Object.values(u.elements).some(m=>m.state==="preparing"||m.state==="recording")){`${t}`;return}}catch(c){console.warn("Could not check recording state:",c)}const{useUIStore:s}=await Ze(async()=>{const{useUIStore:c}=await Promise.resolve().then(()=>bbe);return{useUIStore:c}},void 0),i=s.getState();if(i.currentTextEditElementId||i.currentDescriptionEditElementId)return;const{useMediaStore:a}=await Ze(async()=>{const{useMediaStore:c}=await Promise.resolve().then(()=>oa);return{useMediaStore:c}},void 0),o=a.getState();o.isPlaying&&o.pause();const l=o.currentTime;if(t==="text"){const{playheadToCanvasCoordinates:c}=await Ze(async()=>{const{playheadToCanvasCoordinates:m}=await Promise.resolve().then(()=>Lbe);return{playheadToCanvasCoordinates:m}},void 0),f=c(l,null,1200,320,30);await e().createElement("text",{position:f,content:"",title:"Text",links:[{type:"timeline",timestamp:l}]},void 0,"keyboard_shortcuts")}else await e().createAndStartRecording({recordingType:t,linkContext:"timeline",timestamp:l,createdVia:"keyboard_shortcuts"})},getTimelineElementsSorted:()=>{const t=e(),r=[];return Object.entries(t.boardState.elements).forEach(([s,i])=>{if(i.type==="asset"||!dn.getState().isElementVisible(i))return;const o=i.links?.find(l=>l.type==="timeline");if(o){let l;if(o.timeRange)l=(o.timeRange.start+o.timeRange.end)/2;else if(o.timestamp!==void 0)l=o.timestamp;else return;r.push({elementId:s,timestamp:l})}}),r.sort((s,i)=>s.timestamp-i.timestamp),r.map(s=>s.elementId),r},cycleToNextElement:()=>{const t=e(),r=e().getTimelineElementsSorted();if(r.length===0)return;const s=t.selectedFrames[0];let i=-1;s&&(i=r.findIndex(l=>l.elementId===s));const a=(i+1)%r.length,o=r[a];o.elementId,r.length,Ze(async()=>{const{centerElement:l}=await Promise.resolve().then(()=>l4);return{centerElement:l}},void 0).then(({centerElement:l})=>{l(o.elementId)})},cycleToPreviousElement:()=>{const t=e(),r=e().getTimelineElementsSorted();if(r.length===0)return;const s=t.selectedFrames[0];let i=-1;s&&(i=r.findIndex(l=>l.elementId===s));let a;i<=0?a=r.length-1:a=i-1;const o=r[a];o.elementId,r.length,Ze(async()=>{const{centerElement:l}=await Promise.resolve().then(()=>l4);return{centerElement:l}},void 0).then(({centerElement:l})=>{l(o.elementId)})},getClosestElementToViewportCenter:()=>{const r=e().getTimelineElementsSorted();if(r.length===0)return null;const s=yt.getState(),{visibleTimeStart:i,visibleTimeEnd:a}=s,o=(i+a)/2;let l=r[0],c=Math.abs(l.timestamp-o);for(const u of r){const f=Math.abs(u.timestamp-o);f<c&&(c=f,l=u)}return l.elementId,l.timestamp,l.elementId}}))));typeof window<"u"&&Ze(async()=>{const{useMediaStore:n}=await Promise.resolve().then(()=>oa);return{useMediaStore:n}},void 0).then(({useMediaStore:n})=>{n.subscribe(e=>e.currentTime,e=>{const t=De.getState();if(t.draftElement&&!t.draftManuallyPositioned&&t.draftElement.links&&t.draftElement.links[0]?.type==="timeline"&&t.draftElement.links[0].timestamp!==void 0){const s={type:"timeline",timestamp:e};t.updateDraftLink(s,!1)}})});typeof window<"u"&&(window.useCanvasStore=De);const ks=Object.freeze(Object.defineProperty({__proto__:null,useCanvasStore:De},Symbol.toStringTag,{value:"Module"})),Mbe=[.25,.5,.75,1,1.25,1.5,1.75,2,4],Obe=[.25,.5,.75,1,1.25,1.5,1.75,2],r4=[.25,1,2,4],s4=[.25,1,2],He=Ws()(Ui(bi((n,e)=>({mediaUrl:null,videoId:null,muxPlaybackId:null,isPlaying:!1,duration:0,currentTime:0,playbackRate:1,isMuted:!1,volume:1,isReady:!1,isBuffering:!1,playerRef:null,smoothCurrentTimeAnimationFrame:null,lastRealTimeUpdate:0,lastRealCurrentTime:0,videoInfo:{width:1280,height:720},isPinned:!1,pinnedPlayerHeight:"35vh",lastPlayedContext:null,storyboard:null,isStoryboardLoading:!1,isPreviewMode:!1,previewTimestamp:null,previewSource:null,isMouseOverPlaybar:!1,isMouseOverPlayhead:!1,hoverTimestamp:null,isCountingDown:!1,countdownProgress:0,countdownStartTime:null,previewCountdownTimer:null,countdownProgressTimer:null,wasPlayingBeforePreview:!1,originalPlaybackPosition:null,isRestoringFromPreview:!1,isRecording:!1,recordingType:null,recordingTime:0,recordingProgress:0,recordedChunks:[],activeRecordingId:null,isMainAssetFullscreen:!1,activeRecordingUrl:null,isRecordingPlaying:!1,recordingCurrentTime:0,recordingDuration:0,recordingPlaybackRate:1,lastRecordingPlaybackRate:1,isRecordingFullscreen:!1,recordingOriginRect:null,activeImageUrl:null,isImageFullscreen:!1,imageOriginRect:null,setMediaUrl:t=>n(r=>{r.mediaUrl=t,r.videoId=t&&t!=="native"?Vf(t):null}),setMuxPlaybackId:t=>n(r=>{r.muxPlaybackId=t}),setIsPlaying:t=>n(r=>{r.isPlaying=t}),setDuration:t=>n(r=>{r.duration=t}),setCurrentTime:t=>{const r=e();if(n(s=>{s.currentTime=t,s.lastRealCurrentTime=t,s.lastRealTimeUpdate=performance.now()}),r.isPlaying&&r.smoothCurrentTimeAnimationFrame===null){const s=()=>{const a=e();if(!a.isPlaying||a.isBuffering){n(f=>{f.smoothCurrentTimeAnimationFrame=null});return}const l=(performance.now()-a.lastRealTimeUpdate)/1e3,c=a.lastRealCurrentTime+l*a.playbackRate,u=Math.min(c,a.duration);if(n(f=>{f.currentTime=u}),a.isPlaying&&u<a.duration){const f=requestAnimationFrame(s);n(m=>{m.smoothCurrentTimeAnimationFrame=f})}else n(f=>{f.smoothCurrentTimeAnimationFrame=null})},i=requestAnimationFrame(s);n(a=>{a.smoothCurrentTimeAnimationFrame=i})}},setPlaybackRate:t=>n(r=>{r.playbackRate=t}),setIsMuted:t=>n(r=>{r.isMuted=t}),setVolume:t=>n(r=>{r.volume=t}),setIsReady:t=>n(r=>{r.isReady=t}),setIsBuffering:t=>n(r=>{r.isBuffering=t}),setPlayerRef:t=>n(r=>{r.playerRef=t}),setVideoInfo:t=>n(r=>{r.videoInfo=t}),setIsPinned:t=>n(r=>{r.isPinned=t}),setPinnedPlayerHeight:t=>n(r=>{r.pinnedPlayerHeight=t}),fetchStoryboard:async t=>{n(r=>{r.isStoryboardLoading=!0});try{const r=await fetch(`https://image.mux.com/${t}/storyboard.json?format=webp`);if(!r.ok)throw new Error(`Failed to fetch storyboard: ${r.statusText}`);const s=await r.json(),i=new Image;await new Promise((a,o)=>{i.onload=()=>{s.spriteSheetWidth=i.width,s.spriteSheetHeight=i.height,a()},i.onerror=()=>{o(new Error("Failed to load sprite sheet image"))},i.src=s.url}),n(a=>{a.storyboard=s,a.isStoryboardLoading=!1})}catch(r){console.error("[MediaStore] Failed to fetch storyboard:",r),n(s=>{s.isStoryboardLoading=!1})}},getTileForTime:t=>{const{storyboard:r}=e();if(!r||!r.tiles.length)return null;const s=Math.max(0,Math.min(t,r.duration));let i=r.tiles[0];for(let a=0;a<r.tiles.length;a++){const o=r.tiles[a],l=r.tiles[a+1];if(s>=o.start&&(!l||s<l.start)){i=o;break}}return i},setPreviewMode:(t,r)=>n(s=>{t&&!s.isPreviewMode&&(s.wasPlayingBeforePreview=s.isPlaying,s.originalPlaybackPosition=s.currentTime),s.isPreviewMode=t,s.previewTimestamp=r||null,t||(s.previewSource=null)}),setPreviewTimestamp:t=>n(r=>{r.previewTimestamp=t}),setPreviewSource:t=>n(r=>{r.previewSource=t}),requestPreview:(t,r)=>{const{isPreviewMode:s}=e();n(i=>{i.previewTimestamp=t,i.previewSource=r,s||(i.wasPlayingBeforePreview=i.isPlaying,i.originalPlaybackPosition=i.currentTime)})},exitPreview:()=>n(t=>{t.previewTimestamp=null,t.previewSource=null}),exitPreviewWithoutRestoration:()=>n(t=>{t.previewTimestamp=null,t.previewSource=null,t.isPreviewMode=!1,t.wasPlayingBeforePreview=!1,t.originalPlaybackPosition=null,t.isRestoringFromPreview=!1}),exitPreviewWithRestoration:()=>{const{playerRef:t,isReady:r,originalPlaybackPosition:s,wasPlayingBeforePreview:i}=e();if(n(a=>{a.isRestoringFromPreview=!0}),t&&r&&s!==null)try{typeof t.currentTime=="function"&&t.currentTime(s)}catch(a){console.error("Error restoring position during preview exit:",a)}n(a=>{a.previewTimestamp=null,a.previewSource=null,a.isPreviewMode=!1}),setTimeout(()=>{if(n(a=>{a.isRestoringFromPreview=!1}),i)try{e().play()}catch(a){console.error("Error resuming playback after preview:",a)}n(a=>{a.wasPlayingBeforePreview=!1,a.originalPlaybackPosition=null})},100)},play:()=>{const{playerRef:t,isReady:r,activeRecordingId:s,isRecordingPlaying:i}=e();if(!t||!r){console.warn("Cannot play: Player not ready or initialized");return}s&&i&&n(a=>{a.isRecordingPlaying=!1}),Ze(async()=>{const{useCanvasStore:a}=await Promise.resolve().then(()=>ks);return{useCanvasStore:a}},void 0).then(({useCanvasStore:a})=>{a.getState().pauseAllRecordings()}).catch(console.error),n(a=>{a.isPlaying=!0,a.lastPlayedContext="main"}),Ze(async()=>{const{useTimelineStore:a}=await Promise.resolve().then(()=>xg);return{useTimelineStore:a}},void 0).then(({useTimelineStore:a})=>{const o=e().currentTime;a.getState().checkAndCenterPlayhead(o)}).catch(console.error);try{typeof t.play=="function"?t.play():console.warn("Player doesn't have a play method")}catch(a){console.error("Error playing video:",a),n(o=>{o.isPlaying=!1})}},pause:()=>{const{playerRef:t,isReady:r,smoothCurrentTimeAnimationFrame:s}=e();if(!t||!r){console.warn("Cannot pause: Player not ready or initialized");return}s!==null&&cancelAnimationFrame(s),n(i=>{i.isPlaying=!1,i.smoothCurrentTimeAnimationFrame=null}),Ze(async()=>{const{useTimelineStore:i}=await Promise.resolve().then(()=>xg);return{useTimelineStore:i}},void 0).then(({useTimelineStore:i})=>{i.getState().disableAutoFollow()}).catch(console.error);try{typeof t.pause=="function"?t.pause():console.warn("Player doesn't have a pause method")}catch(i){console.error("Error pausing video:",i),n(a=>{a.isPlaying=!0})}},togglePlayPause:()=>{const{isPlaying:t}=e();t?e().pause():e().play()},togglePlayPauseContextAware:()=>{const{activeRecordingId:t,isRecordingPlaying:r,isPlaying:s,lastPlayedContext:i,isReady:a,isRecordingFullscreen:o}=e();t&&(o||i==="recording"||i===null||!a)?e().toggleRecordingPlayback():e().togglePlayPause()},setLastPlayedContext:t=>{n(r=>{r.lastPlayedContext=t})},seek:t=>{const{playerRef:r,isReady:s,duration:i}=e();if(!r||!s){console.warn("Cannot seek: Player not ready or initialized");return}if(typeof r.currentTime!="function"){console.warn("Player doesn't have a currentTime method");return}const a=Math.max(0,Math.min(t,i));try{r.currentTime(a),e().setCurrentTime(a)}catch(o){console.error("Error seeking video:",o)}},cyclePlaybackRate:()=>{const{playbackRate:t,playerRef:r,videoId:s}=e(),i=s?Obe:Mbe,o=(i.indexOf(t)+1)%i.length,l=i[o];if(n(c=>{c.playbackRate=l}),r&&typeof r.playbackRate=="function")try{r.playbackRate(l)}catch(c){console.error("Error setting playback rate:",c)}},increasePlaybackRate:()=>{const{playbackRate:t,playerRef:r,videoId:s}=e(),i=s?s4:r4,a=i.indexOf(t);if(a===i.length-1||a===-1&&t>=i[i.length-1])return;const o=a===-1?i.find(l=>l>t)||i[i.length-1]:i[a+1];if(n(l=>{l.playbackRate=o}),r&&typeof r.playbackRate=="function")try{r.playbackRate(o)}catch(l){console.error("Error setting playback rate:",l)}},decreasePlaybackRate:()=>{const{playbackRate:t,playerRef:r,videoId:s}=e(),i=s?s4:r4,a=i.indexOf(t);if(a===0||a===-1&&t<=i[0])return;const o=a===-1?[...i].reverse().find(l=>l<t)||i[0]:i[a-1];if(n(l=>{l.playbackRate=o}),r&&typeof r.playbackRate=="function")try{r.playbackRate(o)}catch(l){console.error("Error setting playback rate:",l)}},toggleMute:()=>{const{isMuted:t,playerRef:r}=e(),s=!t;if(n(i=>{i.isMuted=s}),r&&typeof r.muted=="function")try{r.muted(s)}catch(i){console.error("Error setting mute state:",i)}},seekByFrames:t=>{const{playerRef:r,isReady:s,duration:i,isPlaying:a}=e();if(!r||!s){console.warn("Cannot seek by frames: Player not ready or initialized");return}if(typeof r.currentTime!="function"){console.warn("Player doesn't have a currentTime method for frame seeking");return}a&&e().pause();const o=e().currentTime,l=1/30,c=Math.max(0,Math.min(o+t*l,i));try{r.currentTime(c),e().setCurrentTime(c),`${t}${c.toFixed(3)}`}catch(u){console.error("Error seeking by frames:",u)}},seekForwardOneFrame:()=>{e().seekByFrames(1)},seekBackwardOneFrame:()=>{e().seekByFrames(-1)},seekForwardTenFrames:()=>{e().seekByFrames(10)},seekBackwardTenFrames:()=>{e().seekByFrames(-10)},initializePlayer:t=>{n(r=>{r.mediaUrl=t,r.videoId=t&&t!=="native"?Vf(t):null,r.isReady=!1,r.isPlaying=!1,r.duration=0,r.currentTime=0})},handlePlayerReady:t=>{n(r=>{r.playerRef=t,r.isReady=!0})},handleTimeUpdate:t=>{const{isPreviewMode:r,isRestoringFromPreview:s}=e();!r&&!s&&n(i=>{i.currentTime=t,i.lastRealCurrentTime=t,i.lastRealTimeUpdate=performance.now()})},handleDurationChange:t=>{n(r=>{r.duration=t})},handlePlay:()=>{const{isPlaying:t}=e();t||n(r=>{r.isPlaying=!0})},handlePause:()=>{const{isPlaying:t}=e();t&&n(r=>{r.isPlaying=!1})},handleWaiting:()=>{n(t=>{t.isBuffering=!0})},handleSeeking:()=>{n(t=>{t.isBuffering=!0})},handleSeeked:()=>{},handleCanPlay:()=>{const{isBuffering:t}=e();if(t){n(s=>{s.isBuffering=!1});const r=e();r.isPlaying&&r.smoothCurrentTimeAnimationFrame===null&&r.setCurrentTime(r.currentTime)}},startRecording:async t=>{n(r=>{r.isRecording=!0,r.recordingType=t,r.recordingTime=0,r.recordingProgress=0,r.recordedChunks=[]})},stopRecording:async()=>{const{recordedChunks:t}=e();if(n(r=>{r.isRecording=!1,r.recordingType=null,r.recordingTime=0,r.recordingProgress=0}),t.length>0){const r=new Blob(t,{type:"video/webm"});return e().clearRecordingChunks(),r}return null},pauseRecording:()=>{},resumeRecording:()=>{},setRecordingTime:t=>n(r=>{r.recordingTime=t}),setRecordingProgress:t=>n(r=>{r.recordingProgress=t}),addRecordingChunk:t=>n(r=>{r.recordedChunks.push(t)}),clearRecordingChunks:()=>n(t=>{t.recordedChunks=[]}),setActiveRecording:(t,r,s,i)=>{const a=e();if(a.isPlaying&&a.pause(),i){const o=De.getState(),c=cn.getState().user?.id,f=o.boardState.elements[i]?.createdBy===c;tx("played",{recording_id:t,flask_id:o.flaskId,viewer_id:c,is_owner:f,playback_source:"canvas"})}n(o=>{o.activeRecordingId=t,o.activeRecordingUrl=r,o.isRecordingPlaying=!1,o.recordingCurrentTime=0,o.recordingDuration=0,o.recordingPlaybackRate=o.lastRecordingPlaybackRate,o.recordingOriginRect=s||null})},clearActiveRecording:()=>n(t=>{t.activeRecordingId=null,t.activeRecordingUrl=null,t.isRecordingPlaying=!1,t.recordingCurrentTime=0,t.recordingDuration=0,t.isRecordingFullscreen=!1,t.lastPlayedContext="main",t.recordingOriginRect=null}),setIsRecordingPlaying:t=>{const r=e();t&&r.isPlaying&&r.pause(),n(s=>{s.isRecordingPlaying=t,t&&(s.lastPlayedContext="recording")})},toggleRecordingPlayback:()=>{const t=e();!t.isRecordingPlaying&&t.isPlaying&&t.pause(),n(r=>{r.isRecordingPlaying=!t.isRecordingPlaying})},setRecordingPlaybackRate:t=>n(r=>{r.recordingPlaybackRate=t,r.lastRecordingPlaybackRate=t}),increaseRecordingPlaybackRate:()=>{const{recordingPlaybackRate:t}=e(),r=[.25,.5,.75,1,1.25,1.5,1.75,2],s=r.indexOf(t);if(s<r.length-1){const i=r[s+1];e().setRecordingPlaybackRate(i)}},decreaseRecordingPlaybackRate:()=>{const{recordingPlaybackRate:t}=e(),r=[.25,.5,.75,1,1.25,1.5,1.75,2],s=r.indexOf(t);if(s>0){const i=r[s-1];e().setRecordingPlaybackRate(i)}},seekRecording:t=>{const{recordingDuration:r}=e(),s=Math.max(0,Math.min(t,r||0));n(i=>{i.recordingCurrentTime=s})},setRecordingFullscreen:t=>{const r=e();t?r.isPlaying&&r.pause():setTimeout(()=>{e().clearActiveRecording()},600),n(s=>{s.isRecordingFullscreen=t})},toggleRecordingFullscreen:()=>{const t=e();t.setRecordingFullscreen(!t.isRecordingFullscreen)},setRecordingCurrentTime:t=>n(r=>{r.recordingCurrentTime=t}),setActiveImage:(t,r)=>{const s=e();s.isPlaying&&s.pause(),n(i=>{i.activeImageUrl=t,i.isImageFullscreen=!0,i.imageOriginRect=r||null})},clearActiveImage:()=>n(t=>{t.activeImageUrl=null,t.isImageFullscreen=!1,t.imageOriginRect=null}),setImageFullscreen:t=>{t||setTimeout(()=>{e().clearActiveImage()},600),n(r=>{r.isImageFullscreen=t})},setMainAssetFullscreen:t=>{n(r=>{r.isMainAssetFullscreen=t})},toggleMainAssetFullscreen:()=>{const t=e();t.setMainAssetFullscreen(!t.isMainAssetFullscreen)},reset:()=>n(t=>{t.mediaUrl=null,t.videoId=null,t.muxPlaybackId=null,t.isPlaying=!1,t.duration=0,t.currentTime=0,t.playbackRate=1,t.isMuted=!1,t.volume=1,t.isReady=!1,t.playerRef=null,t.videoInfo={width:1280,height:720},t.isPinned=!1,t.pinnedPlayerHeight="35vh",t.lastPlayedContext=null,t.storyboard=null,t.isStoryboardLoading=!1,t.isPreviewMode=!1,t.previewTimestamp=null,t.previewSource=null,t.isMouseOverPlaybar=!1,t.isMouseOverPlayhead=!1,t.hoverTimestamp=null,t.isCountingDown=!1,t.countdownProgress=0,t.countdownStartTime=null,t.previewCountdownTimer&&(clearTimeout(t.previewCountdownTimer),t.previewCountdownTimer=null),t.countdownProgressTimer&&(clearInterval(t.countdownProgressTimer),t.countdownProgressTimer=null),t.wasPlayingBeforePreview=!1,t.originalPlaybackPosition=null,t.isRestoringFromPreview=!1,t.isRecording=!1,t.recordingType=null,t.recordingTime=0,t.recordingProgress=0,t.recordedChunks=[],t.activeRecordingId=null,t.activeRecordingUrl=null,t.isRecordingPlaying=!1,t.recordingCurrentTime=0,t.recordingDuration=0,t.recordingPlaybackRate=1,t.lastRecordingPlaybackRate=1,t.isRecordingFullscreen=!1,t.activeImageUrl=null,t.isImageFullscreen=!1,t.imageOriginRect=null}),resetPlayer:()=>n(t=>{t.isPlaying=!1,t.duration=0,t.currentTime=0,t.isReady=!1,t.playerRef=null}),resetRecording:()=>n(t=>{t.isRecording=!1,t.recordingType=null,t.recordingTime=0,t.recordingProgress=0,t.recordedChunks=[]}),seekPreviewOnly:t=>{const{playerRef:r,duration:s,mediaUrl:i}=e();if(!r){console.warn("Cannot seek preview: No player reference",{mediaUrl:i});return}if(typeof r.currentTime!="function"){console.warn("Player doesn't have a currentTime method for preview",{playerRef:r,mediaUrl:i});return}const a=Math.max(0,Math.min(t,s||0));try{r.currentTime(a)}catch(o){console.error("Error seeking for preview:",o,{mediaUrl:i,safeTime:a,duration:s})}},pauseForPreview:()=>{const{playerRef:t,wasPlayingBeforePreview:r,mediaUrl:s}=e();if(!t){console.warn("Cannot pause for preview: No player reference",{mediaUrl:s});return}try{typeof t.pause=="function"&&r?(t.pause(),n(i=>{i.isPlaying=!1})):t.pause}catch(i){console.error("Error pausing for preview:",i,{mediaUrl:s})}},restorePlaybackAfterPreview:()=>{const{playerRef:t,isReady:r,originalPlaybackPosition:s,wasPlayingBeforePreview:i}=e();if(!t||!r){console.warn("Cannot restore playback: Player not ready");return}n(a=>{a.isRestoringFromPreview=!0});try{s!==null&&typeof t.currentTime=="function"&&t.currentTime(s),i&&typeof t.play=="function"&&t.play()}catch(a){console.error("Error restoring playback after preview:",a)}setTimeout(()=>{n(a=>{a.wasPlayingBeforePreview=!1,a.originalPlaybackPosition=null,a.isRestoringFromPreview=!1})},100)},setupDefensiveCleanup:()=>{const t=()=>{e().clearAllHoverStates()},r=i=>{i.relatedTarget||e().clearAllHoverStates()},s=()=>{document.hidden&&e().clearAllHoverStates()};return window.addEventListener("blur",t),document.addEventListener("mouseleave",r),document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("blur",t),document.removeEventListener("mouseleave",r),document.removeEventListener("visibilitychange",s)}},setPlaybarHover:(t,r)=>{e(),n(i=>{i.isMouseOverPlaybar=t,t&&r!==void 0?i.hoverTimestamp=r:t||(i.hoverTimestamp=null)});const s=e();t&&!s.isMouseOverPlayhead&&r!==void 0?s.isPreviewMode&&s.previewSource==="hover"?e().requestPreview(r,"hover"):e().startPreviewCountdown(r):(e().stopPreviewCountdown(),t||e().exitPreview())},setPlayheadHover:t=>{if(n(r=>{r.isMouseOverPlayhead=t}),t)e().stopPreviewCountdown(),e().exitPreview();else{const{isMouseOverPlaybar:r,hoverTimestamp:s}=e();r&&s!==null&&e().startPreviewCountdown(s)}},clearAllHoverStates:()=>{n(t=>{t.isMouseOverPlaybar=!1,t.isMouseOverPlayhead=!1,t.hoverTimestamp=null}),e().stopPreviewCountdown(),e().exitPreview()},startPreviewCountdown:t=>{const{playerRef:r,isReady:s,duration:i,isPreviewMode:a,previewSource:o,isMouseOverPlayhead:l,currentTime:c}=e();if(!r||i<=0||a&&o!=="hover"||l)return;e().stopPreviewCountdown();const u=Date.now();n(m=>{m.isCountingDown=!0,m.countdownProgress=0,m.countdownStartTime=u});const f=setInterval(()=>{const{countdownStartTime:m,isMouseOverPlaybar:g,isMouseOverPlayhead:y,currentTime:b}=e();if(!g||y||!m){e().stopPreviewCountdown();return}const x=Date.now()-m,S=Math.min(x/100,1);n(T=>{T.countdownProgress=S}),S>=1&&(clearInterval(f),e().triggerPreview(t))},50);n(m=>{m.countdownProgressTimer=f})},stopPreviewCountdown:()=>{const{previewCountdownTimer:t,countdownProgressTimer:r}=e();t&&clearTimeout(t),r&&clearInterval(r),n(s=>{s.isCountingDown=!1,s.countdownProgress=0,s.countdownStartTime=null,s.previewCountdownTimer=null,s.countdownProgressTimer=null})},triggerPreview:t=>{e().stopPreviewCountdown(),e().requestPreview(t,"hover")}})))),Q9=()=>{const{isPlaying:n,currentTime:e,duration:t,playbackRate:r,isMuted:s,volume:i,isPinned:a,play:o,pause:l,togglePlayPause:c,seek:u,cyclePlaybackRate:f,toggleMute:m,setVolume:g,setIsPinned:y,seekByFrames:b,seekForwardOneFrame:x,seekBackwardOneFrame:S,seekForwardTenFrames:T,seekBackwardTenFrames:_}=He();return{isPlaying:n,currentTime:e,duration:t,playbackRate:r,isMuted:s,volume:i,isPinned:a,play:o,pause:l,togglePlayPause:c,seek:u,cyclePlaybackRate:f,toggleMute:m,setVolume:g,togglePin:()=>y(!a),seekByFrames:b,seekForwardOneFrame:x,seekBackwardOneFrame:S,seekForwardTenFrames:T,seekBackwardTenFrames:_}},oa=Object.freeze(Object.defineProperty({__proto__:null,useMediaStore:He,useVideoControls:Q9},Symbol.toStringTag,{value:"Module"})),Mt=Ws()(Ui(bi((n,e)=>({recordingState:null,state:"idle",isToolbarHovered:!1,isPlayheadHovered:!1,textContent:"",editingElementId:null,recordingType:null,previewStream:null,recordingDuration:"00:00",placeholderElementId:null,selectedTags:[],linkingMode:"timeline",targetElementId:null,pendingDiscardCallback:null,pendingRecordingCancelCallback:null,pendingLoginText:null,aiPills:[],replyToolbar:{recordingState:null,state:"idle",textContent:"",threadId:null,recordingType:null,recordingStartTime:null,recordingDuration:"00:00",previewStream:null,placeholderElementId:null,selectedTags:[],pendingDiscardCallback:null,pendingLoginText:null},savePendingLoginText:()=>{const t=e();if(t.textContent.trim()){n(s=>{s.pendingLoginText=s.textContent}),localStorage.setItem("flask_pending_login_text",t.textContent);const r={linkingMode:t.linkingMode,targetElementId:t.targetElementId};localStorage.setItem("flask_pending_login_linking_state",JSON.stringify(r))}},restorePendingLoginText:()=>{const t=localStorage.getItem("flask_pending_login_text"),r=localStorage.getItem("flask_pending_login_linking_state");t?(n(s=>{if(s.textContent=t,s.pendingLoginText=null,s.state="draft",r)try{const i=JSON.parse(r);s.linkingMode=i.linkingMode,s.targetElementId=i.targetElementId}catch(i){console.error("[ToolbarStore] Failed to parse saved linking state:",i)}}),localStorage.removeItem("flask_pending_login_text"),localStorage.removeItem("flask_pending_login_linking_state")):e().pendingLoginText&&n(i=>{i.textContent=i.pendingLoginText||"",i.pendingLoginText=null,i.state="draft"})},clearPendingLoginText:()=>{n(t=>{t.pendingLoginText=null}),localStorage.removeItem("flask_pending_login_text"),localStorage.removeItem("flask_pending_login_linking_state")},setState:t=>{n(r=>{r.pendingDiscardCallback&&r.state!==t||(r.state=t,t==="preparing"||t==="recording"?r.recordingState=t:(t==="idle"||t==="draft")&&(r.recordingState=null))})},setTextContent:t=>{n(r=>{r.textContent=t,t&&r.state==="idle"&&(r.state="draft",Ze(async()=>{const{useMediaStore:s}=await Promise.resolve().then(()=>oa);return{useMediaStore:s}},void 0).then(({useMediaStore:s})=>{s.getState().pause()}))})},enterFocusedState:()=>{Ze(async()=>{const{useMediaStore:r}=await Promise.resolve().then(()=>oa);return{useMediaStore:r}},void 0).then(({useMediaStore:r})=>{r.getState().pause()});const t=e();Ze(async()=>{const{useCanvasStore:r}=await Promise.resolve().then(()=>ks);return{useCanvasStore:r}},void 0).then(({useCanvasStore:r})=>{Ze(async()=>{const{useMediaStore:s}=await Promise.resolve().then(()=>oa);return{useMediaStore:s}},void 0).then(({useMediaStore:s})=>{const i=r.getState(),a=s.getState();if(!i.getDraftElement("timeline")){let l;t.linkingMode==="element"&&t.targetElementId?l={type:"element",targetElementId:i.findRootElementInThread(t.targetElementId)||t.targetElementId}:l={type:"timeline",timestamp:a.currentTime},i.initializeDraft(l,"timeline")}})}),n(r=>{r.state="draft"})},exitToIdle:(t=!1)=>{if(e().state==="recording"&&!t){n(s=>{s.pendingRecordingCancelCallback=()=>{const i=new CustomEvent("toolbarV2CancelRecording");window.dispatchEvent(i)}});return}if(t){n(s=>{s.state="idle",s.textContent="",s.selectedTags=[],s.editingElementId=null,s.linkingMode==="element"&&(s.linkingMode="timeline",s.targetElementId=null),s.isToolbarHovered=!1});return}Ze(async()=>{const{useCanvasStore:s}=await Promise.resolve().then(()=>ks);return{useCanvasStore:s}},void 0).then(({useCanvasStore:s})=>{s.getState().requestDiscardDraft(()=>{n(a=>{a.state="idle",a.textContent="",a.selectedTags=[],a.editingElementId=null,a.linkingMode==="element"&&(a.linkingMode="timeline",a.targetElementId=null),a.isToolbarHovered=!1})},"timeline")})},clearText:async(t=!1)=>{n(r=>{r.pendingDiscardCallback||(r.linkingMode,r.targetElementId,r.textContent="",r.selectedTags=[],r.state==="draft"&&!r.editingElementId&&(r.state="idle",!t&&r.linkingMode==="element"&&(r.linkingMode="timeline",r.targetElementId=null)))})},setPreviewStream:t=>{n(r=>{r.previewStream&&r.previewStream!==t&&r.previewStream.getTracks().forEach(s=>s.stop()),r.previewStream=t})},loadElementForEditing:(t,r)=>{n(s=>{s.state="draft",s.editingElementId=t,s.textContent=r})},clearEditMode:()=>{n(t=>{t.editingElementId=null,t.textContent="",t.state="idle"})},setPlaceholderElementId:t=>{n(r=>{r.placeholderElementId=t})},setSelectedTags:t=>{n(r=>{r.selectedTags=t})},clearSelectedTags:()=>{n(t=>{t.selectedTags=[]})},startElementLinking:t=>{n(r=>{r.linkingMode="element",r.targetElementId=t,r.state="draft"}),Ze(async()=>{const{useMediaStore:r}=await Promise.resolve().then(()=>oa);return{useMediaStore:r}},void 0).then(({useMediaStore:r})=>{r.getState().pause()}),setTimeout(()=>{const r=document.querySelector("[data-toolbar-textbox]");r&&r.focus({preventScroll:!0})},100)},exitElementLinking:()=>{n(t=>{t.state="idle",t.linkingMode="timeline",t.targetElementId=null,t.textContent="",t.selectedTags=[]})},setPendingDiscardCallback:t=>{n(r=>{r.pendingDiscardCallback=t})},tryExitFocusedState:t=>{const r=e();r.textContent.trim()&&!r.editingElementId&&r.state==="draft"?n(s=>{s.pendingDiscardCallback=t}):t()},setPendingRecordingCancelCallback:t=>{n(r=>{r.pendingRecordingCancelCallback=t})},setToolbarHovered:t=>{n(r=>{r.isToolbarHovered=t})},setPlayheadHovered:t=>{n(r=>{r.isPlayheadHovered=t})},focusTextbox:(t="timeline")=>{if(He.getState().pause(),t==="reply")console.warn("[ToolbarStore] focusTextbox called with 'reply' variant - use enterReplyFocusedState(threadId) instead"),n(r=>{r.replyToolbar.state="draft"}),setTimeout(()=>{const r=document.querySelector("[data-reply-toolbar-textbox]");r&&(r.focus({preventScroll:!0}),r.select())},0);else{const r=e();Ze(async()=>{const{useCanvasStore:s}=await Promise.resolve().then(()=>ks);return{useCanvasStore:s}},void 0).then(({useCanvasStore:s})=>{Ze(async()=>{const{useMediaStore:i}=await Promise.resolve().then(()=>oa);return{useMediaStore:i}},void 0).then(({useMediaStore:i})=>{const a=s.getState(),o=i.getState();if(!a.getDraftElement("timeline")){let c;r.linkingMode==="element"&&r.targetElementId?c={type:"element",targetElementId:a.findRootElementInThread(r.targetElementId)||r.targetElementId}:c={type:"timeline",timestamp:o.currentTime},a.initializeDraft(c,"timeline")}})}),n(s=>{s.state="draft"}),setTimeout(()=>{const s=document.querySelector("[data-toolbar-textbox]");s&&(s.focus({preventScroll:!0}),s.select())},0)}},startRecording:t=>{const r=He.getState();r.isPlaying&&r.pause(),r.isRecordingPlaying&&r.setIsRecordingPlaying(!1),n(s=>{s.recordingState="preparing",s.state="preparing",s.recordingType=t})},stopRecording:()=>{const t=e();t.previewStream&&t.previewStream.getTracks().forEach(r=>r.stop()),n(r=>{r.recordingState=null,r.textContent.trim()?r.state="draft":r.state="idle",r.recordingType=null,r.previewStream=null})},setRecordingDuration:t=>{n(r=>{r.recordingDuration=t})},setReplyToolbarState:t=>{n(r=>{r.replyToolbar.state=t,t==="preparing"||t==="recording"?r.replyToolbar.recordingState=t:(t==="idle"||t==="draft")&&(r.replyToolbar.recordingState=null)})},setReplyTextContent:t=>{n(r=>{r.replyToolbar.textContent=t,t&&r.replyToolbar.state==="idle"&&(r.replyToolbar.state="draft",Ze(async()=>{const{useMediaStore:s}=await Promise.resolve().then(()=>oa);return{useMediaStore:s}},void 0).then(({useMediaStore:s})=>{s.getState().pause()}))})},enterReplyFocusedState:t=>{Ze(async()=>{const{useMediaStore:r}=await Promise.resolve().then(()=>oa);return{useMediaStore:r}},void 0).then(({useMediaStore:r})=>{r.getState().pause()}),Ze(async()=>{const{useCanvasStore:r}=await Promise.resolve().then(()=>ks);return{useCanvasStore:r}},void 0).then(({useCanvasStore:r})=>{const s=r.getState();if(!s.getDraftElement(t)){const o={type:"element",targetElementId:s.findRootElementInThread(t)||t};s.initializeDraft(o,t)}}),n(r=>{r.replyToolbar.state="draft",r.replyToolbar.threadId=t}),setTimeout(()=>{const r=document.querySelector("[data-reply-toolbar-textbox]");r&&(r.focus({preventScroll:!0}),r.select())},150)},exitReplyToIdle:()=>{n(t=>{t.replyToolbar.state="idle",t.replyToolbar.textContent="",t.replyToolbar.selectedTags=[],t.replyToolbar.threadId=null})},clearReplyText:()=>{n(t=>{t.replyToolbar.textContent="",t.replyToolbar.selectedTags=[],t.replyToolbar.state==="draft"&&(t.replyToolbar.state="idle")})},setReplyThreadId:t=>{n(r=>{r.replyToolbar.threadId=t})},startReplyRecording:t=>{const r=He.getState();r.isPlaying&&r.pause(),r.isRecordingPlaying&&r.setIsRecordingPlaying(!1),n(s=>{s.replyToolbar.recordingState="preparing",s.replyToolbar.state="preparing",s.replyToolbar.recordingType=t,s.replyToolbar.recordingStartTime=null,s.replyToolbar.recordingDuration="00:00"})},stopReplyRecording:()=>{const t=e();t.replyToolbar.previewStream&&t.replyToolbar.previewStream.getTracks().forEach(r=>r.stop()),n(r=>{r.replyToolbar.recordingState=null,r.replyToolbar.state="idle",r.replyToolbar.recordingType=null,r.replyToolbar.recordingStartTime=null,r.replyToolbar.recordingDuration="00:00",r.replyToolbar.previewStream=null,r.replyToolbar.selectedTags=[]})},setReplyPreviewStream:t=>{n(r=>{r.replyToolbar.previewStream&&r.replyToolbar.previewStream!==t&&r.replyToolbar.previewStream.getTracks().forEach(s=>s.stop()),r.replyToolbar.previewStream=t})},setReplyRecordingDuration:t=>{n(r=>{r.replyToolbar.recordingDuration=t})},setReplyPlaceholderElementId:t=>{n(r=>{r.replyToolbar.placeholderElementId=t})},setReplySelectedTags:t=>{n(r=>{r.replyToolbar.selectedTags=t})},setReplyPendingDiscardCallback:t=>{n(r=>{r.replyToolbar.pendingDiscardCallback=t})},isAnyToolbarRecording:()=>{const t=e(),r=t.state==="preparing"||t.state==="recording",s=t.replyToolbar.state==="preparing"||t.replyToolbar.state==="recording";return r||s},reset:()=>{const t=e();t.previewStream&&t.previewStream.getTracks().forEach(r=>r.stop()),t.replyToolbar.previewStream&&t.replyToolbar.previewStream.getTracks().forEach(r=>r.stop()),n(r=>{r.recordingState=null,r.state="idle",r.textContent="",r.editingElementId=null,r.recordingType=null,r.recordingDuration="00:00",r.previewStream=null,r.placeholderElementId=null,r.selectedTags=[],r.linkingMode="timeline",r.targetElementId=null,r.pendingDiscardCallback=null,r.pendingRecordingCancelCallback=null,r.isToolbarHovered=!1,r.replyToolbar={recordingState:null,state:"idle",textContent:"",threadId:null,recordingType:null,recordingStartTime:null,recordingDuration:"00:00",previewStream:null,placeholderElementId:null,selectedTags:[],pendingDiscardCallback:null}})}})))),di=Object.freeze(Object.defineProperty({__proto__:null,useToolbarStore:Mt},Symbol.toStringTag,{value:"Module"}));var SA={exports:{}},i4;function Nbe(){return i4||(i4=1,function(n){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function e(N,O){if(!N)throw"First parameter is required.";O=O||{type:"video"},O=new t(N,O);var z=this;function G(ie){return O.disableLogs||z.version,ie&&(O=new t(N,ie)),O.disableLogs||""+O.type,ye?(ye.clearRecordedData(),ye.record(),he("recording"),z.recordingDuration&&se(),z):(Y(function(){z.recordingDuration&&se()}),z)}function Y(ie){ie&&(O.initCallback=function(){ie(),ie=O.initCallback=null});var fe=new r(N,O);ye=new fe(N,O),ye.record(),he("recording"),O.disableLogs||(ye.constructor.name,O.type)}function Q(ie){if(ie=ie||function(){},!ye){pe();return}if(z.state==="paused"){z.resumeRecording(),setTimeout(function(){Q(ie)},1);return}z.state!=="recording"&&!O.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',z.state),O.disableLogs||""+O.type,O.type!=="gif"?ye.stop(fe):(ye.stop(),fe()),he("stopped");function fe(Ie){if(!ye){typeof ie.call=="function"?ie.call(z,""):ie("");return}Object.keys(ye).forEach(function(Ce){typeof ye[Ce]!="function"&&(z[Ce]=ye[Ce])});var ne=ye.blob;if(!ne)if(Ie)ye.blob=ne=Ie;else throw"Recording failed.";if(ne&&!O.disableLogs&&(ne.type,S(ne.size)),ie){var ce;try{ce=u.createObjectURL(ne)}catch{}typeof ie.call=="function"?ie.call(z,ce):ie(ce)}O.autoWriteToDisk&&te(function(Ce){var Oe={};Oe[O.type+"Blob"]=Ce,B.Store(Oe)})}}function J(){if(!ye){pe();return}if(z.state!=="recording"){O.disableLogs||console.warn("Unable to pause the recording. Recording state: ",z.state);return}he("paused"),ye.pause(),O.disableLogs}function ee(){if(!ye){pe();return}if(z.state!=="paused"){O.disableLogs||console.warn("Unable to resume the recording. Recording state: ",z.state);return}he("recording"),ye.resume(),O.disableLogs}function oe(ie){postMessage(new FileReaderSync().readAsDataURL(ie))}function te(ie,fe){if(!ie)throw"Pass a callback function over getDataURL.";var Ie=fe?fe.blob:(ye||{}).blob;if(!Ie){O.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){te(ie,fe)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var ne=Ce(oe);ne.onmessage=function(Oe){ie(Oe.data)},ne.postMessage(Ie)}else{var ce=new FileReader;ce.readAsDataURL(Ie),ce.onload=function(Oe){ie(Oe.target.result)}}function Ce(Oe){try{var ze=u.createObjectURL(new Blob([Oe.toString(),"this.onmessage =  function (eee) {"+Oe.name+"(eee.data);}"],{type:"application/javascript"})),We=new Worker(ze);return u.revokeObjectURL(ze),We}catch{}}}function se(ie){if(ie=ie||0,z.state==="paused"){setTimeout(function(){se(ie)},1e3);return}if(z.state!=="stopped"){if(ie>=z.recordingDuration){Q(z.onRecordingStopped);return}ie+=1e3,setTimeout(function(){se(ie)},1e3)}}function he(ie){z&&(z.state=ie,typeof z.onStateChanged.call=="function"?z.onStateChanged.call(z,ie):z.onStateChanged(ie))}var Z='It seems that recorder is destroyed or "startRecording" is not invoked for '+O.type+" recorder.";function pe(){O.disableLogs!==!0&&console.warn(Z)}var ye,ae={startRecording:G,stopRecording:Q,pauseRecording:J,resumeRecording:ee,initRecorder:Y,setRecordingDuration:function(ie,fe){if(typeof ie>"u")throw"recordingDuration is required.";if(typeof ie!="number")throw"recordingDuration must be a number.";return z.recordingDuration=ie,z.onRecordingStopped=fe||function(){},{onRecordingStopped:function(Ie){z.onRecordingStopped=Ie}}},clearRecordedData:function(){if(!ye){pe();return}ye.clearRecordedData(),O.disableLogs},getBlob:function(){if(!ye){pe();return}return ye.blob},getDataURL:te,toURL:function(){if(!ye){pe();return}return u.createObjectURL(ye.blob)},getInternalRecorder:function(){return ye},save:function(ie){if(!ye){pe();return}T(ye.blob,ie)},getFromDisk:function(ie){if(!ye){pe();return}e.getFromDisk(O.type,ie)},setAdvertisementArray:function(ie){O.advertisement=[];for(var fe=ie.length,Ie=0;Ie<fe;Ie++)O.advertisement.push({duration:Ie,image:ie[Ie]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){z.state==="recording"&&!O.disableLogs&&console.warn("Stop an active recorder."),ye&&typeof ye.clearRecordedData=="function"&&ye.clearRecordedData(),ye=null,he("inactive"),z.blob=null},onStateChanged:function(ie){O.disableLogs},state:"inactive",getState:function(){return z.state},destroy:function(){var ie=O.disableLogs;O={disableLogs:!0},z.reset(),he("destroyed"),ae=z=null,L.AudioContextConstructor&&(L.AudioContextConstructor.close(),L.AudioContextConstructor=null),O.disableLogs=ie,O.disableLogs},version:"5.6.2"};if(!this)return z=ae,ae;for(var le in ae)this[le]=ae[le];return z=this,ae}e.version="5.6.2",n.exports=e,e.getFromDisk=function(N,O){if(!O)throw"callback is mandatory.";""+(N==="all"?"blobs":N+" blob "),B.Fetch(function(z,G){N!=="all"&&G===N+"Blob"&&O&&O(z),N==="all"&&O&&O(z,G.replace("Blob",""))})},e.writeToDisk=function(N){N=N||{},N.audio&&N.video&&N.gif?N.audio.getDataURL(function(O){N.video.getDataURL(function(z){N.gif.getDataURL(function(G){B.Store({audioBlob:O,videoBlob:z,gifBlob:G})})})}):N.audio&&N.video?N.audio.getDataURL(function(O){N.video.getDataURL(function(z){B.Store({audioBlob:O,videoBlob:z})})}):N.audio&&N.gif?N.audio.getDataURL(function(O){N.gif.getDataURL(function(z){B.Store({audioBlob:O,gifBlob:z})})}):N.video&&N.gif?N.video.getDataURL(function(O){N.gif.getDataURL(function(z){B.Store({videoBlob:O,gifBlob:z})})}):N.audio?N.audio.getDataURL(function(O){B.Store({audioBlob:O})}):N.video?N.video.getDataURL(function(O){B.Store({videoBlob:O})}):N.gif&&N.gif.getDataURL(function(O){B.Store({gifBlob:O})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function t(N,O){return!O.recorderType&&!O.type&&(O.audio&&O.video?O.type="video":O.audio&&!O.video&&(O.type="audio")),O.recorderType&&!O.type&&(O.recorderType===$||O.recorderType===U||typeof H<"u"&&O.recorderType===H?O.type="video":O.recorderType===W?O.type="gif":O.recorderType===D?O.type="audio":O.recorderType===M&&(R(N,"audio").length&&R(N,"video").length||!R(N,"audio").length&&R(N,"video").length?O.type="video":R(N,"audio").length&&!R(N,"video").length&&(O.type="audio"))),typeof M<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(O.mimeType||(O.mimeType="video/webm"),O.type||(O.type=O.mimeType.split("/")[0]),O.bitsPerSecond),O.type||(O.mimeType&&(O.type=O.mimeType.split("/")[0]),O.type||(O.type="audio")),O}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function r(N,O){var z;return(y||f||m)&&(z=D),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!y&&(z=M),O.type==="video"&&(y||m)&&(z=$,typeof H<"u"&&typeof ReadableStream<"u"&&(z=H)),O.type==="gif"&&(z=W),O.type==="canvas"&&(z=U),k()&&z!==U&&z!==W&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(R(N,"video").length||R(N,"audio").length)&&(O.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(z=M):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(z=M)),N instanceof Array&&N.length&&(z=j),O.recorderType&&(z=O.recorderType),!O.disableLogs&&z&&z.name&&(z.name||z.constructor.name),!z&&b&&(z=M),z}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function s(N){this.addStream=function(O){O&&(N=O)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var O=this.mediaType,z,G=this.mimeType||{audio:null,video:null,gif:null};if(typeof O.audio!="function"&&k()&&!R(N,"audio").length&&(O.audio=!1),typeof O.video!="function"&&k()&&!R(N,"video").length&&(O.video=!1),typeof O.gif!="function"&&k()&&!R(N,"video").length&&(O.gif=!1),!O.audio&&!O.video&&!O.gif)throw"MediaStream must have either audio or video tracks.";if(O.audio&&(z=null,typeof O.audio=="function"&&(z=O.audio),this.audioRecorder=new e(N,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:z,mimeType:G.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),O.video||this.audioRecorder.startRecording()),O.video){z=null,typeof O.video=="function"&&(z=O.video);var Y=N;if(k()&&O.audio&&typeof O.audio=="function"){var Q=R(N,"video")[0];g?(Y=new x,Y.addTrack(Q),z&&z===$&&(z=M)):(Y=new x,Y.addTrack(Q))}this.videoRecorder=new e(Y,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:z,mimeType:G.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),O.audio||this.videoRecorder.startRecording()}if(O.audio&&O.video){var J=this,ee=k()===!0;(O.audio instanceof D&&O.video||O.audio!==!0&&O.video!==!0&&O.audio!==O.video)&&(ee=!1),ee===!0?(J.audioRecorder=null,J.videoRecorder.startRecording()):J.videoRecorder.initRecorder(function(){J.audioRecorder.initRecorder(function(){J.videoRecorder.startRecording(),J.audioRecorder.startRecording()})})}O.gif&&(z=null,typeof O.gif=="function"&&(z=O.gif),this.gifRecorder=new e(N,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:z,mimeType:G.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(O){O=O||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(z){O(z,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(z){O(z,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(z){O(z,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(O){var z={};return this.audioRecorder&&(z.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(z.video=this.videoRecorder.getBlob()),this.gifRecorder&&(z.gif=this.gifRecorder.getBlob()),O&&O(z),z},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(O){this.getBlob(function(Y){Y.audio&&Y.video?z(Y.audio,function(Q){z(Y.video,function(J){O({audio:Q,video:J})})}):Y.audio?z(Y.audio,function(Q){O({audio:Q})}):Y.video&&z(Y.video,function(Q){O({video:Q})})});function z(Y,Q){if(typeof Worker<"u"){var J=G(function(te){postMessage(new FileReaderSync().readAsDataURL(te))});J.onmessage=function(oe){Q(oe.data)},J.postMessage(Y)}else{var ee=new FileReader;ee.readAsDataURL(Y),ee.onload=function(oe){Q(oe.target.result)}}}function G(Y){var Q=u.createObjectURL(new Blob([Y.toString(),"this.onmessage =  function (eee) {"+Y.name+"(eee.data);}"],{type:"application/javascript"})),J=new Worker(Q),ee;if(typeof u<"u")ee=u;else if(typeof webkitURL<"u")ee=webkitURL;else throw"Neither URL nor webkitURL detected.";return ee.revokeObjectURL(Q),J}},this.writeToDisk=function(){e.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(O){O=O||{audio:!0,video:!0,gif:!0},O.audio&&this.audioRecorder&&this.audioRecorder.save(typeof O.audio=="string"?O.audio:""),O.video&&this.videoRecorder&&this.videoRecorder.save(typeof O.video=="string"?O.video:""),O.gif&&this.gifRecorder&&this.gifRecorder.save(typeof O.gif=="string"?O.gif:"")}}s.getFromDisk=e.getFromDisk,s.writeToDisk=e.writeToDisk,typeof e<"u"&&(e.MRecordRTC=s);var i="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(N){N&&(typeof window<"u"||typeof Xn>"u"||(Xn.navigator={userAgent:i,getUserMedia:function(){}},Xn.console||(Xn.console={}),(typeof Xn.console.log>"u"||typeof Xn.console.error>"u")&&(Xn.console.error=Xn.console.log=Xn.console.log||function(){}),typeof document>"u"&&(N.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var O={getContext:function(){return O},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return O},N.HTMLVideoElement=function(){}),typeof location>"u"&&(N.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(N.screen={width:0,height:0}),typeof u>"u"&&(N.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),N.window=Xn))})(typeof Xn<"u"?Xn:null);var a=window.requestAnimationFrame;if(typeof a>"u"){if(typeof webkitRequestAnimationFrame<"u")a=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")a=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")a=msRequestAnimationFrame;else if(typeof a>"u"){var o=0;a=function(N,O){var z=new Date().getTime(),G=Math.max(0,16-(z-o)),Y=setTimeout(function(){N(z+G)},G);return o=z+G,Y}}}var l=window.cancelAnimationFrame;typeof l>"u"&&(typeof webkitCancelAnimationFrame<"u"?l=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?l=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?l=msCancelAnimationFrame:typeof l>"u"&&(l=function(N){clearTimeout(N)}));var c=window.AudioContext;typeof c>"u"&&(typeof webkitAudioContext<"u"&&(c=webkitAudioContext),typeof mozAudioContext<"u"&&(c=mozAudioContext));var u=window.URL;typeof u>"u"&&typeof webkitURL<"u"&&(u=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var f=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),m=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),y=!m&&!f&&!!navigator.webkitGetUserMedia||_()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,b=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);b&&!y&&navigator.userAgent.indexOf("CriOS")!==-1&&(b=!1,y=!0);var x=window.MediaStream;typeof x>"u"&&typeof webkitMediaStream<"u"&&(x=webkitMediaStream),typeof x<"u"&&typeof x.prototype.stop>"u"&&(x.prototype.stop=function(){this.getTracks().forEach(function(N){N.stop()})});function S(N){var O=1e3,z=["Bytes","KB","MB","GB","TB"];if(N===0)return"0 Bytes";var G=parseInt(Math.floor(Math.log(N)/Math.log(O)),10);return(N/Math.pow(O,G)).toPrecision(3)+" "+z[G]}function T(N,O){if(!N)throw"Blob object is required.";if(!N.type)try{N.type="video/webm"}catch{}var z=(N.type||"video/webm").split("/")[1];if(z.indexOf(";")!==-1&&(z=z.split(";")[0]),O&&O.indexOf(".")!==-1){var G=O.split(".");O=G[0],z=G[1]}var Y=(O||Math.round(Math.random()*9999999999)+888888888)+"."+z;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(N,Y);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(N,Y);var Q=document.createElement("a");Q.href=u.createObjectURL(N),Q.download=Y,Q.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(Q),typeof Q.click=="function"?Q.click():(Q.target="_blank",Q.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),u.revokeObjectURL(Q.href)}function _(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function R(N,O){return!N||!N.getTracks?[]:N.getTracks().filter(function(z){return z.kind===(O||"audio")})}function I(N,O){"srcObject"in O?O.srcObject=N:"mozSrcObject"in O?O.mozSrcObject=N:O.srcObject=N}function C(N,O){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var z=new EBML.Reader,G=new EBML.Decoder,Y=EBML.tools,Q=new FileReader;Q.onload=function(J){var ee=G.decode(this.result);ee.forEach(function(he){z.read(he)}),z.stop();var oe=Y.makeMetadataSeekable(z.metadatas,z.duration,z.cues),te=this.result.slice(z.metadataSize),se=new Blob([oe,te],{type:"video/webm"});O(se)},Q.readAsArrayBuffer(N)}typeof e<"u"&&(e.invokeSaveAsDialog=T,e.getTracks=R,e.getSeekableBlob=C,e.bytesToSize=S,e.isElectron=_);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var L={};typeof c<"u"?L.AudioContext=c:typeof webkitAudioContext<"u"&&(L.AudioContext=webkitAudioContext),typeof e<"u"&&(e.Storage=L);function k(){if(g||b||f)return!0;var N=navigator.userAgent,O=""+parseFloat(navigator.appVersion),z=parseInt(navigator.appVersion,10),G,Y;return(y||m)&&(G=N.indexOf("Chrome"),O=N.substring(G+7)),(Y=O.indexOf(";"))!==-1&&(O=O.substring(0,Y)),(Y=O.indexOf(" "))!==-1&&(O=O.substring(0,Y)),z=parseInt(""+O,10),isNaN(z)&&(O=""+parseFloat(navigator.appVersion),z=parseInt(navigator.appVersion,10)),z>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function M(N,O){var se=this;if(typeof N>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(O=O||{mimeType:"video/webm"},O.type==="audio"){if(R(N,"video").length&&R(N,"audio").length){var z;navigator.mozGetUserMedia?(z=new x,z.addTrack(R(N,"audio")[0])):z=new x(R(N,"audio")),N=z}(!O.mimeType||O.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(O.mimeType=y?"audio/webm":"audio/ogg"),O.mimeType&&O.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(O.mimeType="audio/ogg")}var G=[];this.getArrayOfBlobs=function(){return G},this.record=function(){se.blob=null,se.clearRecordedData(),se.timestamps=[],te=[],G=[];var he=O;O.disableLogs,ee&&(ee=null),y&&!k()&&(he="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&he.mimeType&&(MediaRecorder.isTypeSupported(he.mimeType)||(O.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",he.mimeType),he.mimeType=O.type==="audio"?"audio/webm":"video/webm"));try{ee=new MediaRecorder(N,he),O.mimeType=he.mimeType}catch{ee=new MediaRecorder(N)}he.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in ee&&ee.canRecordMimeType(he.mimeType)===!1&&(O.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",he.mimeType)),ee.ondataavailable=function(Z){if(Z.data&&te.push("ondataavailable: "+S(Z.data.size)),typeof O.timeSlice=="number"){if(Z.data&&Z.data.size&&(G.push(Z.data),Y(),typeof O.ondataavailable=="function")){var pe=O.getNativeBlob?Z.data:new Blob([Z.data],{type:Q(he)});O.ondataavailable(pe)}return}if(!Z.data||!Z.data.size||Z.data.size<100||se.blob){se.recordingCallback&&(se.recordingCallback(new Blob([],{type:Q(he)})),se.recordingCallback=null);return}se.blob=O.getNativeBlob?Z.data:new Blob([Z.data],{type:Q(he)}),se.recordingCallback&&(se.recordingCallback(se.blob),se.recordingCallback=null)},ee.onstart=function(){te.push("started")},ee.onpause=function(){te.push("paused")},ee.onresume=function(){te.push("resumed")},ee.onstop=function(){te.push("stopped")},ee.onerror=function(Z){Z&&(Z.name||(Z.name="UnknownError"),te.push("error: "+Z),O.disableLogs||(Z.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",Z):Z.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",he.mimeType,") is not supported.",Z):Z.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",Z):Z.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",Z):Z.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",Z):Z.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",Z):Z.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",Z):console.error("MediaRecorder Error",Z)),function(pe){if(!se.manuallyStopped&&ee&&ee.state==="inactive"){delete O.timeslice,ee.start(600*1e3);return}setTimeout(pe,1e3)}(),ee.state!=="inactive"&&ee.state!=="stopped"&&ee.stop())},typeof O.timeSlice=="number"?(Y(),ee.start(O.timeSlice)):ee.start(36e5),O.initCallback&&O.initCallback()},this.timestamps=[];function Y(){se.timestamps.push(new Date().getTime()),typeof O.onTimeStamp=="function"&&O.onTimeStamp(se.timestamps[se.timestamps.length-1],se.timestamps)}function Q(he){return ee&&ee.mimeType?ee.mimeType:he.mimeType||"video/webm"}this.stop=function(he){he=he||function(){},se.manuallyStopped=!0,ee&&(this.recordingCallback=he,ee.state==="recording"&&ee.stop(),typeof O.timeSlice=="number"&&setTimeout(function(){se.blob=new Blob(G,{type:Q(O)}),se.recordingCallback(se.blob)},100))},this.pause=function(){ee&&ee.state==="recording"&&ee.pause()},this.resume=function(){ee&&ee.state==="paused"&&ee.resume()},this.clearRecordedData=function(){ee&&ee.state==="recording"&&se.stop(J),J()};function J(){G=[],ee=null,se.timestamps=[]}var ee;this.getInternalRecorder=function(){return ee};function oe(){if("active"in N){if(!N.active)return!1}else if("ended"in N&&N.ended)return!1;return!0}this.blob=null,this.getState=function(){return ee&&ee.state||"inactive"};var te=[];this.getAllStates=function(){return te},typeof O.checkForInactiveTracks>"u"&&(O.checkForInactiveTracks=!1);var se=this;(function he(){if(!(!ee||O.checkForInactiveTracks===!1)){if(oe()===!1){O.disableLogs,se.stop();return}setTimeout(he,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof e<"u"&&(e.MediaStreamRecorder=M);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function D(N,O){if(!R(N,"audio").length)throw"Your stream has no audio tracks.";O=O||{};var z=this,G=[],Y=[],Q=!1,J=0,ee,oe=2,te=O.desiredSampRate;O.leftChannel===!0&&(oe=1),O.numberOfAudioChannels===1&&(oe=1),(!oe||oe<1)&&(oe=2),O.disableLogs||""+oe,typeof O.checkForInactiveTracks>"u"&&(O.checkForInactiveTracks=!0);function se(){if(O.checkForInactiveTracks===!1)return!0;if("active"in N){if(!N.active)return!1}else if("ended"in N&&N.ended)return!1;return!0}this.record=function(){if(se()===!1)throw"Please make sure MediaStream is active.";Ie(),ce=fe=!1,Q=!0,typeof O.timeSlice<"u"&&ze()};function he(We,tt){function lt(be,Ae){var Me=be.numberOfAudioChannels,Ue=be.leftBuffers.slice(0),Ge=be.rightBuffers.slice(0),Ke=be.sampleRate,Qe=be.internalInterleavedLength,ht=be.desiredSampRate;Me===2&&(Ue=xn(Ue,Qe),Ge=xn(Ge,Qe),ht&&(Ue=Vt(Ue,ht,Ke),Ge=Vt(Ge,ht,Ke))),Me===1&&(Ue=xn(Ue,Qe),ht&&(Ue=Vt(Ue,ht,Ke))),ht&&(Ke=ht);function Vt(Xe,st,wt){var qt=Math.round(Xe.length*(st/wt)),At=[],Tt=Number((Xe.length-1)/(qt-1));At[0]=Xe[0];for(var zt=1;zt<qt-1;zt++){var Mn=zt*Tt,jr=Number(Math.floor(Mn)).toFixed(),bs=Number(Math.ceil(Mn)).toFixed(),Ea=Mn-jr;At[zt]=mn(Xe[jr],Xe[bs],Ea)}return At[qt-1]=Xe[Xe.length-1],At}function mn(Xe,st,wt){return Xe+(st-Xe)*wt}function xn(Xe,st){for(var wt=new Float64Array(st),qt=0,At=Xe.length,Tt=0;Tt<At;Tt++){var zt=Xe[Tt];wt.set(zt,qt),qt+=zt.length}return wt}function Bn(Xe,st){for(var wt=Xe.length+st.length,qt=new Float64Array(wt),At=0,Tt=0;Tt<wt;)qt[Tt++]=Xe[At],qt[Tt++]=st[At],At++;return qt}function An(Xe,st,wt){for(var qt=wt.length,At=0;At<qt;At++)Xe.setUint8(st+At,wt.charCodeAt(At))}var Lt;Me===2&&(Lt=Bn(Ue,Ge)),Me===1&&(Lt=Ue);var jt=Lt.length,Xt=44+jt*2,nt=new ArrayBuffer(Xt),Je=new DataView(nt);An(Je,0,"RIFF"),Je.setUint32(4,36+jt*2,!0),An(Je,8,"WAVE"),An(Je,12,"fmt "),Je.setUint32(16,16,!0),Je.setUint16(20,1,!0),Je.setUint16(22,Me,!0),Je.setUint32(24,Ke,!0),Je.setUint32(28,Ke*Me*2,!0),Je.setUint16(32,Me*2,!0),Je.setUint16(34,16,!0),An(Je,36,"data"),Je.setUint32(40,jt*2,!0);for(var ot=jt,Dt=44,me=1,Ye=0;Ye<ot;Ye++)Je.setInt16(Dt,Lt[Ye]*(32767*me),!0),Dt+=2;if(Ae)return Ae({buffer:nt,view:Je});postMessage({buffer:nt,view:Je})}if(We.noWorker){lt(We,function(be){tt(be.buffer,be.view)});return}var Ee=Z(lt);Ee.onmessage=function(be){tt(be.data.buffer,be.data.view),u.revokeObjectURL(Ee.workerURL),Ee.terminate()},Ee.postMessage(We)}function Z(We){var tt=u.createObjectURL(new Blob([We.toString(),";this.onmessage =  function (eee) {"+We.name+"(eee.data);}"],{type:"application/javascript"})),lt=new Worker(tt);return lt.workerURL=tt,lt}this.stop=function(We){We=We||function(){},Q=!1,he({desiredSampRate:te,sampleRate:ie,numberOfAudioChannels:oe,internalInterleavedLength:J,leftBuffers:G,rightBuffers:oe===1?[]:Y,noWorker:O.noWorker},function(tt,lt){z.blob=new Blob([lt],{type:"audio/wav"}),z.buffer=new ArrayBuffer(lt.buffer.byteLength),z.view=lt,z.sampleRate=te||ie,z.bufferSize=le,z.length=J,ce=!1,We&&We(z.blob)})},typeof e.Storage>"u"&&(e.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!e.Storage.AudioContextConstructor||e.Storage.AudioContextConstructor.state==="closed")&&(e.Storage.AudioContextConstructor=new e.Storage.AudioContext);var pe=e.Storage.AudioContextConstructor,ye=pe.createMediaStreamSource(N),ae=[0,256,512,1024,2048,4096,8192,16384],le=typeof O.bufferSize>"u"?4096:O.bufferSize;if(ae.indexOf(le)===-1&&(O.disableLogs||""+JSON.stringify(ae,null,"	")),pe.createJavaScriptNode)ee=pe.createJavaScriptNode(le,oe,oe);else if(pe.createScriptProcessor)ee=pe.createScriptProcessor(le,oe,oe);else throw"WebAudio API has no support on this browser.";ye.connect(ee),O.bufferSize||(le=ee.bufferSize);var ie=typeof O.sampleRate<"u"?O.sampleRate:pe.sampleRate||44100;(ie<22050||ie>96e3)&&O.disableLogs,O.disableLogs||O.desiredSampRate&&""+O.desiredSampRate;var fe=!1;this.pause=function(){fe=!0},this.resume=function(){if(se()===!1)throw"Please make sure MediaStream is active.";if(!Q){O.disableLogs,this.record();return}fe=!1},this.clearRecordedData=function(){O.checkForInactiveTracks=!1,Q&&this.stop(ne),ne()};function Ie(){G=[],Y=[],J=0,ce=!1,Q=!1,fe=!1,pe=null,z.leftchannel=G,z.rightchannel=Y,z.numberOfAudioChannels=oe,z.desiredSampRate=te,z.sampleRate=ie,z.recordingLength=J,Oe={left:[],right:[],recordingLength:0}}function ne(){ee&&(ee.onaudioprocess=null,ee.disconnect(),ee=null),ye&&(ye.disconnect(),ye=null),Ie()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var ce=!1;function Ce(We){if(!fe){if(se()===!1&&(O.disableLogs,ee.disconnect(),Q=!1),!Q){ye&&(ye.disconnect(),ye=null);return}ce||(ce=!0,O.onAudioProcessStarted&&O.onAudioProcessStarted(),O.initCallback&&O.initCallback());var tt=We.inputBuffer.getChannelData(0),lt=new Float32Array(tt);if(G.push(lt),oe===2){var Ee=We.inputBuffer.getChannelData(1),be=new Float32Array(Ee);Y.push(be)}J+=le,z.recordingLength=J,typeof O.timeSlice<"u"&&(Oe.recordingLength+=le,Oe.left.push(lt),oe===2&&Oe.right.push(be))}}ee.onaudioprocess=Ce,pe.createMediaStreamDestination?ee.connect(pe.createMediaStreamDestination()):ee.connect(pe.destination),this.leftchannel=G,this.rightchannel=Y,this.numberOfAudioChannels=oe,this.desiredSampRate=te,this.sampleRate=ie,z.recordingLength=J;var Oe={left:[],right:[],recordingLength:0};function ze(){!Q||typeof O.ondataavailable!="function"||typeof O.timeSlice>"u"||(Oe.left.length?(he({desiredSampRate:te,sampleRate:ie,numberOfAudioChannels:oe,internalInterleavedLength:Oe.recordingLength,leftBuffers:Oe.left,rightBuffers:oe===1?[]:Oe.right},function(We,tt){var lt=new Blob([tt],{type:"audio/wav"});O.ondataavailable(lt),setTimeout(ze,O.timeSlice)}),Oe={left:[],right:[],recordingLength:0}):setTimeout(ze,O.timeSlice))}}typeof e<"u"&&(e.StereoAudioRecorder=D);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function U(N,O){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";O=O||{},O.frameInterval||(O.frameInterval=10);var z=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(ae){ae in document.createElement("canvas")&&(z=!0)});var G=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,Y=50,Q=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);G&&Q&&Q[2]&&(Y=parseInt(Q[2],10)),G&&Y<52&&(z=!1),O.useWhammyRecorder&&(z=!1);var J,ee;if(z)if(O.disableLogs,N instanceof HTMLCanvasElement)J=N;else if(N instanceof CanvasRenderingContext2D)J=N.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(O.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var oe;this.record=function(){if(oe=!0,z&&!O.useWhammyRecorder){var ae;"captureStream"in J?ae=J.captureStream(25):"mozCaptureStream"in J?ae=J.mozCaptureStream(25):"webkitCaptureStream"in J&&(ae=J.webkitCaptureStream(25));try{var le=new x;le.addTrack(R(ae,"video")[0]),ae=le}catch{}if(!ae)throw"captureStream API are NOT available.";ee=new M(ae,{mimeType:O.mimeType||"video/webm"}),ee.record()}else ye.frames=[],pe=new Date().getTime(),Z();O.initCallback&&O.initCallback()},this.getWebPImages=function(ae){if(N.nodeName.toLowerCase()!=="canvas"){ae();return}var le=ye.frames.length;ye.frames.forEach(function(ie,fe){var Ie=le-fe;O.disableLogs||Ie+""+le,O.onEncodingCallback&&O.onEncodingCallback(Ie,le);var ne=ie.image.toDataURL("image/webp",1);ye.frames[fe].image=ne}),O.disableLogs,ae()},this.stop=function(ae){oe=!1;var le=this;if(z&&ee){ee.stop(ae);return}this.getWebPImages(function(){ye.compile(function(ie){O.disableLogs,le.blob=ie,le.blob.forEach&&(le.blob=new Blob([],{type:"video/webm"})),ae&&ae(le.blob),ye.frames=[]})})};var te=!1;this.pause=function(){if(te=!0,ee instanceof M){ee.pause();return}},this.resume=function(){if(te=!1,ee instanceof M){ee.resume();return}oe||this.record()},this.clearRecordedData=function(){oe&&this.stop(se),se()};function se(){ye.frames=[],oe=!1,te=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function he(){var ae=document.createElement("canvas"),le=ae.getContext("2d");return ae.width=N.width,ae.height=N.height,le.drawImage(N,0,0),ae}function Z(){if(te)return pe=new Date().getTime(),setTimeout(Z,500);if(N.nodeName.toLowerCase()==="canvas"){var ae=new Date().getTime()-pe;pe=new Date().getTime(),ye.frames.push({image:he(),duration:ae}),oe&&setTimeout(Z,O.frameInterval);return}html2canvas(N,{grabMouse:typeof O.showMousePointer>"u"||O.showMousePointer,onrendered:function(le){var ie=new Date().getTime()-pe;if(!ie)return setTimeout(Z,O.frameInterval);pe=new Date().getTime(),ye.frames.push({image:le.toDataURL("image/webp",1),duration:ie}),oe&&setTimeout(Z,O.frameInterval)}})}var pe=new Date().getTime(),ye=new V.Video(100)}typeof e<"u"&&(e.CanvasRecorder=U);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function $(N,O){O=O||{},O.frameInterval||(O.frameInterval=10),O.disableLogs||O.frameInterval,this.record=function(){O.width||(O.width=320),O.height||(O.height=240),O.video||(O.video={width:O.width,height:O.height}),O.canvas||(O.canvas={width:O.width,height:O.height}),oe.width=O.canvas.width||320,oe.height=O.canvas.height||240,te=oe.getContext("2d"),O.video&&O.video instanceof HTMLVideoElement?(se=O.video.cloneNode(),O.initCallback&&O.initCallback()):(se=document.createElement("video"),I(N,se),se.onloadedmetadata=function(){O.initCallback&&O.initCallback()},se.width=O.video.width,se.height=O.video.height),se.muted=!0,se.play(),he=new Date().getTime(),Z=new V.Video,O.disableLogs||(oe.width,oe.height,se.width||oe.width,se.height||oe.height),z(O.frameInterval)};function z(pe){pe=typeof pe<"u"?pe:10;var ye=new Date().getTime()-he;if(!ye)return setTimeout(z,pe,pe);if(J)return he=new Date().getTime(),setTimeout(z,100);he=new Date().getTime(),se.paused&&se.play(),te.drawImage(se,0,0,oe.width,oe.height),Z.frames.push({duration:ye,image:oe.toDataURL("image/webp")}),Q||setTimeout(z,pe,pe)}function G(pe){var ye=-1,ae=pe.length;(function le(){if(ye++,ye===ae){pe.callback();return}setTimeout(function(){pe.functionToLoop(le,ye)},1)})()}function Y(pe,ye,ae,le,ie){var fe=document.createElement("canvas");fe.width=oe.width,fe.height=oe.height;var Ie=fe.getContext("2d"),ne=[],ce=pe.length,Ce={r:0,g:0,b:0},Oe=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),ze=0,We=0,tt=!1;G({length:ce,functionToLoop:function(lt,Ee){var be,Ae,Me,Ue=function(){!tt&&Me-be<=Me*We||(tt=!0,ne.push(pe[Ee])),lt()};if(tt)Ue();else{var Ge=new Image;Ge.onload=function(){Ie.drawImage(Ge,0,0,oe.width,oe.height);var Ke=Ie.getImageData(0,0,oe.width,oe.height);be=0,Ae=Ke.data.length,Me=Ke.data.length/4;for(var Qe=0;Qe<Ae;Qe+=4){var ht={r:Ke.data[Qe],g:Ke.data[Qe+1],b:Ke.data[Qe+2]},Vt=Math.sqrt(Math.pow(ht.r-Ce.r,2)+Math.pow(ht.g-Ce.g,2)+Math.pow(ht.b-Ce.b,2));Vt<=Oe*ze&&be++}Ue()},Ge.src=pe[Ee].image}},callback:function(){ne=ne.concat(pe.slice(ce)),ne.length<=0&&ne.push(pe[pe.length-1]),ie(ne)}})}var Q=!1;this.stop=function(pe){pe=pe||function(){},Q=!0;var ye=this;setTimeout(function(){Y(Z.frames,-1,null,null,function(ae){Z.frames=ae,O.advertisement&&O.advertisement.length&&(Z.frames=O.advertisement.concat(Z.frames)),Z.compile(function(le){ye.blob=le,ye.blob.forEach&&(ye.blob=new Blob([],{type:"video/webm"})),pe&&pe(ye.blob)})})},10)};var J=!1;this.pause=function(){J=!0},this.resume=function(){J=!1,Q&&this.record()},this.clearRecordedData=function(){Q||this.stop(ee),ee()};function ee(){Z.frames=[],Q=!0,J=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var oe=document.createElement("canvas"),te=oe.getContext("2d"),se,he,Z}typeof e<"u"&&(e.WhammyRecorder=$);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var V=function(){function N(G){this.frames=[],this.duration=G||1,this.quality=.8}N.prototype.add=function(G,Y){if("canvas"in G&&(G=G.canvas),"toDataURL"in G&&(G=G.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(G))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:G,duration:Y||this.duration})};function O(G){var Y=u.createObjectURL(new Blob([G.toString(),"this.onmessage =  function (eee) {"+G.name+"(eee.data);}"],{type:"application/javascript"})),Q=new Worker(Y);return u.revokeObjectURL(Y),Q}function z(G){function Y(ie){var fe=J(ie);if(!fe)return[];for(var Ie=3e4,ne=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:ae(fe.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:fe.width,id:176},{data:fe.height,id:186}]}]}]}]}],ce=0,Ce=0;ce<ie.length;){var Oe=[],ze=0;do Oe.push(ie[ce]),ze+=ie[ce].duration,ce++;while(ce<ie.length&&ze<Ie);var We=0,tt={id:524531317,data:Q(Ce,We,Oe)};ne[1].data.push(tt),Ce+=ze}return se(ne)}function Q(ie,fe,Ie){return[{data:ie,id:231}].concat(Ie.map(function(ne){var ce=he({frame:ne.data.slice(4),trackNum:1,timecode:Math.round(fe)});return fe+=ne.duration,{data:ce,id:163}}))}function J(ie){if(!ie[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var fe=ie[0].width,Ie=ie[0].height,ne=ie[0].duration,ce=1;ce<ie.length;ce++)ne+=ie[ce].duration;return{duration:ne,width:fe,height:Ie}}function ee(ie){for(var fe=[];ie>0;)fe.push(ie&255),ie=ie>>8;return new Uint8Array(fe.reverse())}function oe(ie){return new Uint8Array(ie.split("").map(function(fe){return fe.charCodeAt(0)}))}function te(ie){var fe=[],Ie=ie.length%8?new Array(9-ie.length%8).join("0"):"";ie=Ie+ie;for(var ne=0;ne<ie.length;ne+=8)fe.push(parseInt(ie.substr(ne,8),2));return new Uint8Array(fe)}function se(ie){for(var fe=[],Ie=0;Ie<ie.length;Ie++){var ne=ie[Ie].data;typeof ne=="object"&&(ne=se(ne)),typeof ne=="number"&&(ne=te(ne.toString(2))),typeof ne=="string"&&(ne=oe(ne));var ce=ne.size||ne.byteLength||ne.length,Ce=Math.ceil(Math.ceil(Math.log(ce)/Math.log(2))/8),Oe=ce.toString(2),ze=new Array(Ce*7+7+1-Oe.length).join("0")+Oe,We=new Array(Ce).join("0")+"1"+ze;fe.push(ee(ie[Ie].id)),fe.push(te(We)),fe.push(ne)}return new Blob(fe,{type:"video/webm"})}function he(ie){var fe=0;fe|=128;var Ie=[ie.trackNum|128,ie.timecode>>8,ie.timecode&255,fe].map(function(ne){return String.fromCharCode(ne)}).join("")+ie.frame;return Ie}function Z(ie){for(var fe=ie.RIFF[0].WEBP[0],Ie=fe.indexOf("*"),ne=0,ce=[];ne<4;ne++)ce[ne]=fe.charCodeAt(Ie+3+ne);var Ce,Oe,ze;return ze=ce[1]<<8|ce[0],Ce=ze&16383,ze=ce[3]<<8|ce[2],Oe=ze&16383,{width:Ce,height:Oe,data:fe,riff:ie}}function pe(ie,fe){return parseInt(ie.substr(fe+4,4).split("").map(function(Ie){var ne=Ie.charCodeAt(0).toString(2);return new Array(8-ne.length+1).join("0")+ne}).join(""),2)}function ye(ie){for(var fe=0,Ie={};fe<ie.length;){var ne=ie.substr(fe,4),ce=pe(ie,fe),Ce=ie.substr(fe+4+4,ce);fe+=8+ce,Ie[ne]=Ie[ne]||[],ne==="RIFF"||ne==="LIST"?Ie[ne].push(ye(Ce)):Ie[ne].push(Ce)}return Ie}function ae(ie){return[].slice.call(new Uint8Array(new Float64Array([ie]).buffer),0).map(function(fe){return String.fromCharCode(fe)}).reverse().join("")}var le=new Y(G.map(function(ie){var fe=Z(ye(atob(ie.image.slice(23))));return fe.duration=ie.duration,fe}));postMessage(le)}return N.prototype.compile=function(G){var Y=O(z);Y.onmessage=function(Q){if(Q.data.error){console.error(Q.data.error);return}G(Q.data)},Y.postMessage(this.frames)},{Video:N}}();typeof e<"u"&&(e.Whammy=V);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var B={init:function(){var N=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var O=1,z=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),G,Y=indexedDB.open(z,O);function Q(ee){ee.createObjectStore(N.dataStoreName)}function J(){var ee=G.transaction([N.dataStoreName],"readwrite");N.videoBlob&&ee.objectStore(N.dataStoreName).put(N.videoBlob,"videoBlob"),N.gifBlob&&ee.objectStore(N.dataStoreName).put(N.gifBlob,"gifBlob"),N.audioBlob&&ee.objectStore(N.dataStoreName).put(N.audioBlob,"audioBlob");function oe(te){ee.objectStore(N.dataStoreName).get(te).onsuccess=function(se){N.callback&&N.callback(se.target.result,te)}}oe("audioBlob"),oe("videoBlob"),oe("gifBlob")}Y.onerror=N.onError,Y.onsuccess=function(){if(G=Y.result,G.onerror=N.onError,G.setVersion)if(G.version!==O){var ee=G.setVersion(O);ee.onsuccess=function(){Q(G),J()}}else J();else J()},Y.onupgradeneeded=function(ee){Q(ee.target.result)}},Fetch:function(N){return this.callback=N,this.init(),this},Store:function(N){return this.audioBlob=N.audioBlob,this.videoBlob=N.videoBlob,this.gifBlob=N.gifBlob,this.init(),this},onError:function(N){console.error(JSON.stringify(N,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof e<"u"&&(e.DiskStorage=B);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function W(N,O){if(typeof GIFEncoder>"u"){var z=document.createElement("script");z.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(z)}O=O||{};var G=N instanceof CanvasRenderingContext2D||N instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(pe.record,1e3);return}if(!oe){setTimeout(pe.record,1e3);return}G||(O.width||(O.width=te.offsetWidth||320),O.height||(O.height=te.offsetHeight||240),O.video||(O.video={width:O.width,height:O.height}),O.canvas||(O.canvas={width:O.width,height:O.height}),J.width=O.canvas.width||320,J.height=O.canvas.height||240,te.width=O.video.width||320,te.height=O.video.height||240),Z=new GIFEncoder,Z.setRepeat(0),Z.setDelay(O.frameRate||200),Z.setQuality(O.quality||10),Z.start(),typeof O.onGifRecordingStarted=="function"&&O.onGifRecordingStarted();function ye(ae){if(pe.clearedRecordedData!==!0){if(Y)return setTimeout(function(){ye(ae)},100);se=a(ye),typeof he===void 0&&(he=ae),!(ae-he<90)&&(!G&&te.paused&&te.play(),G||ee.drawImage(te,0,0,J.width,J.height),O.onGifPreview&&O.onGifPreview(J.toDataURL("image/png")),Z.addFrame(ee),he=ae)}}se=a(ye),O.initCallback&&O.initCallback()},this.stop=function(ye){ye=ye||function(){},se&&l(se),this.blob=new Blob([new Uint8Array(Z.stream().bin)],{type:"image/gif"}),ye(this.blob),Z.stream().bin=[]};var Y=!1;this.pause=function(){Y=!0},this.resume=function(){Y=!1},this.clearRecordedData=function(){pe.clearedRecordedData=!0,Q()};function Q(){Z&&(Z.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var J=document.createElement("canvas"),ee=J.getContext("2d");G&&(N instanceof CanvasRenderingContext2D?(ee=N,J=ee.canvas):N instanceof HTMLCanvasElement&&(ee=N.getContext("2d"),J=N));var oe=!0;if(!G){var te=document.createElement("video");te.muted=!0,te.autoplay=!0,te.playsInline=!0,oe=!1,te.onloadedmetadata=function(){oe=!0},I(N,te),te.play()}var se=null,he,Z,pe=this}typeof e<"u"&&(e.GifRecorder=W);function F(N,O){var z="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(ne){typeof e<"u"||ne&&(typeof window<"u"||typeof Xn>"u"||(Xn.navigator={userAgent:z,getUserMedia:function(){}},Xn.console||(Xn.console={}),(typeof Xn.console.log>"u"||typeof Xn.console.error>"u")&&(Xn.console.error=Xn.console.log=Xn.console.log||function(){}),typeof document>"u"&&(ne.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var ce={getContext:function(){return ce},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return ce},ne.HTMLVideoElement=function(){}),typeof location>"u"&&(ne.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(ne.screen={width:0,height:0}),typeof te>"u"&&(ne.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),ne.window=Xn))})(typeof Xn<"u"?Xn:null),O=O||"multi-streams-mixer";var G=[],Y=!1,Q=document.createElement("canvas"),J=Q.getContext("2d");Q.style.opacity=0,Q.style.position="absolute",Q.style.zIndex=-1,Q.style.top="-1000em",Q.style.left="-1000em",Q.className=O,(document.body||document.documentElement).appendChild(Q),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var ee=this,oe=window.AudioContext;typeof oe>"u"&&(typeof webkitAudioContext<"u"&&(oe=webkitAudioContext),typeof mozAudioContext<"u"&&(oe=mozAudioContext));var te=window.URL;typeof te>"u"&&typeof webkitURL<"u"&&(te=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var se=window.MediaStream;typeof se>"u"&&typeof webkitMediaStream<"u"&&(se=webkitMediaStream),typeof se<"u"&&typeof se.prototype.stop>"u"&&(se.prototype.stop=function(){this.getTracks().forEach(function(ne){ne.stop()})});var he={};typeof oe<"u"?he.AudioContext=oe:typeof webkitAudioContext<"u"&&(he.AudioContext=webkitAudioContext);function Z(ne,ce){"srcObject"in ce?ce.srcObject=ne:"mozSrcObject"in ce?ce.mozSrcObject=ne:ce.srcObject=ne}this.startDrawingFrames=function(){pe()};function pe(){if(!Y){var ne=G.length,ce=!1,Ce=[];if(G.forEach(function(ze){ze.stream||(ze.stream={}),ze.stream.fullcanvas?ce=ze:Ce.push(ze)}),ce)Q.width=ce.stream.width,Q.height=ce.stream.height;else if(Ce.length){Q.width=ne>1?Ce[0].width*2:Ce[0].width;var Oe=1;(ne===3||ne===4)&&(Oe=2),(ne===5||ne===6)&&(Oe=3),(ne===7||ne===8)&&(Oe=4),(ne===9||ne===10)&&(Oe=5),Q.height=Ce[0].height*Oe}else Q.width=ee.width||360,Q.height=ee.height||240;ce&&ce instanceof HTMLVideoElement&&ye(ce),Ce.forEach(function(ze,We){ye(ze,We)}),setTimeout(pe,ee.frameInterval)}}function ye(ne,ce){if(!Y){var Ce=0,Oe=0,ze=ne.width,We=ne.height;ce===1&&(Ce=ne.width),ce===2&&(Oe=ne.height),ce===3&&(Ce=ne.width,Oe=ne.height),ce===4&&(Oe=ne.height*2),ce===5&&(Ce=ne.width,Oe=ne.height*2),ce===6&&(Oe=ne.height*3),ce===7&&(Ce=ne.width,Oe=ne.height*3),typeof ne.stream.left<"u"&&(Ce=ne.stream.left),typeof ne.stream.top<"u"&&(Oe=ne.stream.top),typeof ne.stream.width<"u"&&(ze=ne.stream.width),typeof ne.stream.height<"u"&&(We=ne.stream.height),J.drawImage(ne,Ce,Oe,ze,We),typeof ne.stream.onRender=="function"&&ne.stream.onRender(J,Ce,Oe,ze,We,ce)}}function ae(){Y=!1;var ne=le(),ce=ie();return ce&&ce.getTracks().filter(function(Ce){return Ce.kind==="audio"}).forEach(function(Ce){ne.addTrack(Ce)}),N.forEach(function(Ce){Ce.fullcanvas}),ne}function le(){Ie();var ne;"captureStream"in Q?ne=Q.captureStream():"mozCaptureStream"in Q?ne=Q.mozCaptureStream():ee.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var ce=new se;return ne.getTracks().filter(function(Ce){return Ce.kind==="video"}).forEach(function(Ce){ce.addTrack(Ce)}),Q.stream=ce,ce}function ie(){he.AudioContextConstructor||(he.AudioContextConstructor=new he.AudioContext),ee.audioContext=he.AudioContextConstructor,ee.audioSources=[],ee.useGainNode===!0&&(ee.gainNode=ee.audioContext.createGain(),ee.gainNode.connect(ee.audioContext.destination),ee.gainNode.gain.value=0);var ne=0;if(N.forEach(function(ce){if(ce.getTracks().filter(function(Oe){return Oe.kind==="audio"}).length){ne++;var Ce=ee.audioContext.createMediaStreamSource(ce);ee.useGainNode===!0&&Ce.connect(ee.gainNode),ee.audioSources.push(Ce)}}),!!ne)return ee.audioDestination=ee.audioContext.createMediaStreamDestination(),ee.audioSources.forEach(function(ce){ce.connect(ee.audioDestination)}),ee.audioDestination.stream}function fe(ne){var ce=document.createElement("video");return Z(ne,ce),ce.className=O,ce.muted=!0,ce.volume=0,ce.width=ne.width||ee.width||360,ce.height=ne.height||ee.height||240,ce.play(),ce}this.appendStreams=function(ne){if(!ne)throw"First parameter is required.";ne instanceof Array||(ne=[ne]),ne.forEach(function(ce){var Ce=new se;if(ce.getTracks().filter(function(We){return We.kind==="video"}).length){var Oe=fe(ce);Oe.stream=ce,G.push(Oe),Ce.addTrack(ce.getTracks().filter(function(We){return We.kind==="video"})[0])}if(ce.getTracks().filter(function(We){return We.kind==="audio"}).length){var ze=ee.audioContext.createMediaStreamSource(ce);ee.audioDestination=ee.audioContext.createMediaStreamDestination(),ze.connect(ee.audioDestination),Ce.addTrack(ee.audioDestination.stream.getTracks().filter(function(We){return We.kind==="audio"})[0])}N.push(Ce)})},this.releaseStreams=function(){G=[],Y=!0,ee.gainNode&&(ee.gainNode.disconnect(),ee.gainNode=null),ee.audioSources.length&&(ee.audioSources.forEach(function(ne){ne.disconnect()}),ee.audioSources=[]),ee.audioDestination&&(ee.audioDestination.disconnect(),ee.audioDestination=null),ee.audioContext&&ee.audioContext.close(),ee.audioContext=null,J.clearRect(0,0,Q.width,Q.height),Q.stream&&(Q.stream.stop(),Q.stream=null)},this.resetVideoStreams=function(ne){ne&&!(ne instanceof Array)&&(ne=[ne]),Ie(ne)};function Ie(ne){G=[],ne=ne||N,ne.forEach(function(ce){if(ce.getTracks().filter(function(Oe){return Oe.kind==="video"}).length){var Ce=fe(ce);Ce.stream=ce,G.push(Ce)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=ae}typeof e>"u"&&(n.exports=F);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function j(N,O){N=N||[];var z=this,G,Y;O=O||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},O.frameInterval||(O.frameInterval=10),O.video||(O.video={}),O.video.width||(O.video.width=360),O.video.height||(O.video.height=240),this.record=function(){G=new F(N,O.elementClass||"multi-streams-mixer"),Q().length&&(G.frameInterval=O.frameInterval||10,G.width=O.video.width||360,G.height=O.video.height||240,G.startDrawingFrames()),O.previewStream&&typeof O.previewStream=="function"&&O.previewStream(G.getMixedStream()),Y=new M(G.getMixedStream(),O),Y.record()};function Q(){var J=[];return N.forEach(function(ee){R(ee,"video").forEach(function(oe){J.push(oe)})}),J}this.stop=function(J){Y&&Y.stop(function(ee){z.blob=ee,J(ee),z.clearRecordedData()})},this.pause=function(){Y&&Y.pause()},this.resume=function(){Y&&Y.resume()},this.clearRecordedData=function(){Y&&(Y.clearRecordedData(),Y=null),G&&(G.releaseStreams(),G=null)},this.addStreams=function(J){if(!J)throw"First parameter is required.";J instanceof Array||(J=[J]),N.concat(J),!(!Y||!G)&&(G.appendStreams(J),O.previewStream&&typeof O.previewStream=="function"&&O.previewStream(G.getMixedStream()))},this.resetVideoStreams=function(J){G&&(J&&!(J instanceof Array)&&(J=[J]),G.resetVideoStreams(J))},this.getMixer=function(){return G},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof e<"u"&&(e.MultiStreamRecorder=j);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function q(N,O){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof N>"u")throw'First argument "MediaStream" is required.';var z=this;z.recordRTC=new e(N,O),this.startRecording=function(){return new Promise(function(G,Y){try{z.recordRTC.startRecording(),G()}catch(Q){Y(Q)}})},this.stopRecording=function(){return new Promise(function(G,Y){try{z.recordRTC.stopRecording(function(Q){if(z.blob=z.recordRTC.getBlob(),!z.blob||!z.blob.size){Y("Empty blob.",z.blob);return}G(Q)})}catch(Q){Y(Q)}})},this.pauseRecording=function(){return new Promise(function(G,Y){try{z.recordRTC.pauseRecording(),G()}catch(Q){Y(Q)}})},this.resumeRecording=function(){return new Promise(function(G,Y){try{z.recordRTC.resumeRecording(),G()}catch(Q){Y(Q)}})},this.getDataURL=function(G){return new Promise(function(Y,Q){try{z.recordRTC.getDataURL(function(J){Y(J)})}catch(J){Q(J)}})},this.getBlob=function(){return new Promise(function(G,Y){try{G(z.recordRTC.getBlob())}catch(Q){Y(Q)}})},this.getInternalRecorder=function(){return new Promise(function(G,Y){try{G(z.recordRTC.getInternalRecorder())}catch(Q){Y(Q)}})},this.reset=function(){return new Promise(function(G,Y){try{G(z.recordRTC.reset())}catch(Q){Y(Q)}})},this.destroy=function(){return new Promise(function(G,Y){try{G(z.recordRTC.destroy())}catch(Q){Y(Q)}})},this.getState=function(){return new Promise(function(G,Y){try{G(z.recordRTC.getState())}catch(Q){Y(Q)}})},this.blob=null,this.version="5.6.2"}typeof e<"u"&&(e.RecordRTCPromisesHandler=q);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function H(N,O){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),O=O||{},O.width=O.width||640,O.height=O.height||480,O.frameRate=O.frameRate||30,O.bitrate=O.bitrate||1200,O.realtime=O.realtime||!0;var z;function G(){return new ReadableStream({start:function(te){var se=document.createElement("canvas"),he=document.createElement("video"),Z=!0;he.srcObject=N,he.muted=!0,he.height=O.height,he.width=O.width,he.volume=0,he.onplaying=function(){se.width=O.width,se.height=O.height;var pe=se.getContext("2d"),ye=1e3/O.frameRate,ae=setInterval(function(){if(z&&(clearInterval(ae),te.close()),Z&&(Z=!1,O.onVideoProcessStarted&&O.onVideoProcessStarted()),pe.drawImage(he,0,0),te._controlledReadableStream.state!=="closed")try{te.enqueue(pe.getImageData(0,0,O.width,O.height))}catch{}},ye)},he.play()}})}var Y;function Q(te,se){if(!O.workerPath&&!se){z=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(Z){Z.arrayBuffer().then(function(pe){Q(te,pe)})});return}if(!O.workerPath&&se instanceof ArrayBuffer){var he=new Blob([se],{type:"text/javascript"});O.workerPath=u.createObjectURL(he)}O.workerPath||console.error("workerPath parameter is missing."),Y=new Worker(O.workerPath),Y.postMessage(O.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),Y.addEventListener("message",function(Z){Z.data==="READY"?(Y.postMessage({width:O.width,height:O.height,bitrate:O.bitrate||1200,timebaseDen:O.frameRate||30,realtime:O.realtime}),G().pipeTo(new WritableStream({write:function(pe){if(z){console.error("Got image, but recorder is finished!");return}Y.postMessage(pe.data.buffer,[pe.data.buffer])}}))):Z.data&&(J||oe.push(Z.data))})}this.record=function(){oe=[],J=!1,this.blob=null,Q(N),typeof O.initCallback=="function"&&O.initCallback()};var J;this.pause=function(){J=!0},this.resume=function(){J=!1};function ee(te){if(!Y){te&&te();return}Y.addEventListener("message",function(se){se.data===null&&(Y.terminate(),Y=null,te&&te())}),Y.postMessage(null)}var oe=[];this.stop=function(te){z=!0;var se=this;ee(function(){se.blob=new Blob(oe,{type:"video/webm"}),te(se.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){oe=[],J=!1,this.blob=null},this.blob=null}typeof e<"u"&&(e.WebAssemblyRecorder=H)}(SA)),SA.exports}var bk=Nbe();const a4=Rd(bk);class o4{recordRTC=null;audioRecordRTC=null;stream;options;chunks=[];audioChunks=[];_state="inactive";dataAvailableInterval=null;timeSliceMs=100;enableParallelAudioRecording=!0;ondataavailable=null;onstop=null;onstart=null;onerror=null;onpause=null;onresume=null;constructor(e,t={}){this.stream=e,this.options=t}get state(){return this._state}get mimeType(){return this.options.mimeType||'video/webm;codecs="vp8,opus"'}start(e){if(this._state!=="inactive"){console.warn("[RecordRTCWrapper] Cannot start recording - already recording or paused");return}e&&(this.timeSliceMs=e);try{const t=this.getRecordRTCOptions();this.recordRTC=new a4(this.stream,t),this.chunks=[],this.audioChunks=[],this._state="recording",this.recordRTC.startRecording();const r=this.stream.getAudioTracks();if(this.enableParallelAudioRecording&&r.length>0){const s=new MediaStream(r),i={type:"audio",mimeType:"audio/webm",recorderType:bk.MediaStreamRecorder,audioBitsPerSecond:64e3,disableLogs:!0};this.audioRecordRTC=new a4(s,i),this.audioRecordRTC.startRecording()}e&&this.ondataavailable&&this.setupPeriodicDataEvents(),this.onstart&&this.onstart()}catch(t){console.error("[RecordRTCWrapper] Failed to start recording:",t),this._state="inactive",this.onerror&&this.onerror(new Event("error"))}}stop(){if(this._state==="inactive"){console.warn("[RecordRTCWrapper] Cannot stop recording - not recording");return}if(!this.recordRTC){console.error("[RecordRTCWrapper] RecordRTC instance not found");return}try{this.dataAvailableInterval&&(clearInterval(this.dataAvailableInterval),this.dataAvailableInterval=null),this.audioRecordRTC&&this.audioRecordRTC.stopRecording(()=>{if(this.audioRecordRTC){const e=this.audioRecordRTC.getBlob();this.audioChunks.push(e),e.size}}),this.recordRTC.stopRecording(()=>{if(!this.recordRTC)return;const e=this.recordRTC.getBlob();if(this.chunks.push(e),this.ondataavailable){const t=new xk("dataavailable",{data:e});this.ondataavailable(t)}this._state="inactive",this.onstop&&this.onstop(),e.size})}catch(e){console.error("[RecordRTCWrapper] Failed to stop recording:",e),this._state="inactive",this.onerror&&this.onerror(new Event("error"))}}pause(){if(this._state!=="recording"){console.warn("[RecordRTCWrapper] Cannot pause - not recording");return}if(!this.recordRTC){console.error("[RecordRTCWrapper] RecordRTC instance not found");return}try{this.recordRTC.pauseRecording(),this._state="paused",this.dataAvailableInterval&&(clearInterval(this.dataAvailableInterval),this.dataAvailableInterval=null),this.onpause&&this.onpause()}catch(e){console.error("[RecordRTCWrapper] Failed to pause recording:",e),this.onerror&&this.onerror(new Event("error"))}}resume(){if(this._state!=="paused"){console.warn("[RecordRTCWrapper] Cannot resume - not paused");return}if(!this.recordRTC){console.error("[RecordRTCWrapper] RecordRTC instance not found");return}try{this.recordRTC.resumeRecording(),this._state="recording",this.timeSliceMs&&this.ondataavailable&&this.setupPeriodicDataEvents(),this.onresume&&this.onresume()}catch(e){console.error("[RecordRTCWrapper] Failed to resume recording:",e),this.onerror&&this.onerror(new Event("error"))}}requestData(){if(this._state!=="recording"){console.warn("[RecordRTCWrapper] Cannot request data - not recording");return}}getAudioBlob(){if(this.audioChunks.length>0){const e=new Blob(this.audioChunks,{type:"audio/webm;codecs=opus"});return`${e.size}`,e}return null}async getSeekableBlob(){if(!this.recordRTC)return console.error("[RecordRTCWrapper] RecordRTC instance not found"),null;try{const e=await new Promise((t,r)=>{this.recordRTC&&typeof this.recordRTC.getSeekableBlob=="function"?this.recordRTC.getSeekableBlob(s=>{s?t(s):r(new Error("Failed to get seekable blob"))}):(console.warn("[RecordRTCWrapper] getSeekableBlob not available, using regular blob"),t(this.recordRTC.getBlob()))});return e.size,e}catch(e){return console.error("[RecordRTCWrapper] Failed to get seekable blob:",e),this.recordRTC.getBlob()}}destroy(){if(this.dataAvailableInterval&&(clearInterval(this.dataAvailableInterval),this.dataAvailableInterval=null),this.audioRecordRTC){try{this._state==="recording"||this._state==="paused"?this.audioRecordRTC.stopRecording(()=>{this.audioRecordRTC&&this.audioRecordRTC.destroy()}):this.audioRecordRTC.destroy()}catch(e){console.warn("[RecordRTCWrapper] Error during audio cleanup:",e)}this.audioRecordRTC=null}if(this.recordRTC){try{this._state==="recording"||this._state==="paused"?this.recordRTC.stopRecording(()=>{this.recordRTC&&this.recordRTC.destroy()}):this.recordRTC.destroy()}catch(e){console.warn("[RecordRTCWrapper] Error during cleanup:",e)}this.recordRTC=null}this._state="inactive",this.chunks=[],this.audioChunks=[]}getRecordRTCOptions(){const e=this.options.mimeType||'video/webm;codecs="vp8,opus"';let t="video/webm";return e.includes("mp4")&&(t="video/mp4"),e.includes("vp9")||e.includes("h264"),e.includes("aac"),{type:"video",mimeType:t,recorderType:bk.MediaStreamRecorder,video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},bitsPerSecond:this.options.videoBitsPerSecond||25e5,videoBitsPerSecond:this.options.videoBitsPerSecond||25e5,audioBitsPerSecond:this.options.audioBitsPerSecond||128e3,quality:.8,disableLogs:!0,checkForInactiveTracks:!0,pauseRecordingOnOtherTabs:!1}}setupPeriodicDataEvents(){this.dataAvailableInterval&&clearInterval(this.dataAvailableInterval),this.dataAvailableInterval=setInterval(()=>{if(this._state==="recording"&&this.ondataavailable){const e=new Blob([],{type:this.mimeType}),t=new xk("dataavailable",{data:e});this.ondataavailable(t)}},this.timeSliceMs)}}class xk extends Event{data;constructor(e,t){super(e),this.data=t.data}}typeof window<"u"&&!window.BlobEvent&&(window.BlobEvent=xk);const vs=Ws()(bi((n,e)=>({elements:{},isRecording:!1,recordingStream:null,recordingMediaRecorder:null,recordingChunks:[],recordingType:null,recordingStartTime:null,countdownValue:null,isCountdownActive:!1,pendingStream:null,pendingRecorder:null,flowContext:null,isCancelled:!1,globalState:"idle",activeRecordingElementId:null,pendingRecordingType:null,isPermissionModalVisible:!1,hasRequestedPermission:!1,showPermissionConfirmation:!1,permissions:{camera:"prompt",microphone:"prompt"},settings:{availableCameras:[],availableMicrophones:[],selectedCameraId:null,selectedMicrophoneId:null},isSettingsPopoverOpen:!1,startRecordingFlow:async t=>{const{type:r,context:s,callbacks:i}=t;try{if(e().isRecording)return console.warn("[RecordingStore] Already recording"),{success:!1,error:"Already recording"};n(g=>{g.flowContext=s,g.globalState="preparing",g.isCancelled=!1});const a=e().settings;let o;r==="screen"?o=(async()=>{try{const g=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});let y=null;try{y=await navigator.mediaDevices.getUserMedia({video:!1,audio:a?.selectedMicrophoneId?{deviceId:{exact:a.selectedMicrophoneId}}:!0})}catch(x){console.warn("[RecordingStore] Microphone access failed, using screen only:",x)}const b=new MediaStream([...g.getVideoTracks(),...y?y.getAudioTracks():[]]);return g.getVideoTracks()[0].onended=()=>{e().stopRecordingFlow({currentTime:s.currentTime,position:{x:0,y:0}})},b}catch(g){throw console.error("[RecordingStore] Screen capture failed:",g),new Error("Screen capture denied or failed")}})():o=(async()=>{try{const g={video:a?.selectedCameraId?{deviceId:{exact:a.selectedCameraId}}:!0,audio:a?.selectedMicrophoneId?{deviceId:{exact:a.selectedMicrophoneId}}:!0},y=await navigator.mediaDevices.getUserMedia(g);return y}catch(g){throw console.error("[RecordingStore] Camera/microphone access failed:",g),new Error("Camera or microphone access denied")}})();let l;if(r==="screen")try{l=await o,i?.onScreenSelected?.(),i?.onStreamReady?.(l),n(g=>{g.countdownValue=3,g.isCountdownActive=!0});for(let g=3;g>0;g--){if(e().isCancelled)throw console.trace("[RecordingStore] Cancellation stack trace"),new Error("Recording cancelled");i?.onCountdownTick?.(g),n(y=>{y.countdownValue=g}),await new Promise(y=>setTimeout(y,1e3))}n(g=>{g.countdownValue=0,g.isCountdownActive=!1})}catch(g){return l&&l.getTracks().forEach(y=>y.stop()),n(y=>{y.globalState="idle",y.flowContext=null,y.countdownValue=null,y.isCountdownActive=!1,y.isCancelled=!1}),{success:!1,error:g instanceof Error?g.message:"Failed to acquire media stream"}}else{n(y=>{y.countdownValue=3,y.isCountdownActive=!0});const g=(async()=>{for(let y=3;y>0;y--){if(e().isCancelled)throw console.trace("[RecordingStore] Cancellation stack trace"),new Error("Recording cancelled");i?.onCountdownTick?.(y),n(b=>{b.countdownValue=y}),await new Promise(b=>setTimeout(b,1e3))}n(y=>{y.countdownValue=0,y.isCountdownActive=!1})})();try{l=await o,i?.onStreamReady?.(l),await g}catch(y){return l&&l.getTracks().forEach(b=>b.stop()),n(b=>{b.globalState="idle",b.flowContext=null,b.countdownValue=null,b.isCountdownActive=!1,b.isCancelled=!1}),{success:!1,error:y instanceof Error?y.message:"Failed to acquire media stream"}}}const c=e().isCancelled;if(c)return console.trace("[RecordingStore] Final cancellation check stack trace"),l&&l.getTracks().forEach(g=>{`${g.kind}`,g.stop()}),n(g=>{g.globalState="idle",g.flowContext=null,g.countdownValue=null,g.isCountdownActive=!1}),{success:!1,error:"Recording cancelled"};const u='video/webm;codecs="vp8,opus"',f=new o4(l,{mimeType:u,videoBitsPerSecond:r==="screen"?4e6:25e5});f.ondataavailable=g=>{g.data&&g.data.size>0&&n(y=>{y.recordingChunks.push(g.data)})},f.start(100),n(g=>{g.isRecording=!0,g.recordingStream=l,g.recordingMediaRecorder=f,g.recordingChunks=[],g.recordingType=r,g.recordingStartTime=Date.now(),g.globalState="recording"}),i?.onRecordingStart?.();const m=De.getState();return tx("started",{recording_type:r,flask_id:m.flaskId,method:"unified_flow"}),{success:!0}}catch(a){return console.error("[RecordingStore] startRecordingFlow failed:",a),n(o=>{o.globalState="idle",o.flowContext=null,o.countdownValue=null,o.isCountdownActive=!1}),i?.onError?.(a instanceof Error?a.message:"Unknown error"),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}},stopRecordingFlow:async t=>{const{currentTime:r,position:s}=t,{recordingMediaRecorder:i,recordingStream:a,flowContext:o}=e();if(!i||!o){console.warn("[RecordingStore] No active recording to stop");return}try{const l=await e().stopToolbarRecording();if(!l){console.error("[RecordingStore] No blobs returned from recording"),n(c=>{c.globalState="idle",c.flowContext=null});return}await e().processRecordingBlob(l.videoBlob,o.type,s,r,o.linkingMode,o.targetElementId||null,o.selectedTags,o.pendingTimelineLink,void 0,l.audioBlob),n(c=>{c.globalState="idle",c.flowContext=null})}catch(l){throw console.error("[RecordingStore] stopRecordingFlow failed:",l),n(c=>{c.globalState="idle",c.flowContext=null}),l}},stopRecordingFlowDraft:async t=>{const{draftElementId:r,draftKey:s="timeline"}=t,{recordingMediaRecorder:i,recordingStream:a,flowContext:o}=e();if(!i||!o)return console.warn("[RecordingStore] No active recording to stop"),{success:!1,error:"No active recording"};try{const l=await e().stopToolbarRecording();if(!l)return console.error("[RecordingStore] No blobs returned from recording"),n(u=>{u.globalState="idle",u.flowContext=null}),{success:!1,error:"No recording data"};const c=await e().processRecordingBlobDraft(l.videoBlob,o.type,r,l.audioBlob,s);return n(u=>{u.globalState="idle",u.flowContext=null}),c}catch(l){return console.error("[RecordingStore] stopRecordingFlowDraft failed:",l),n(c=>{c.globalState="idle",c.flowContext=null}),{success:!1,error:l instanceof Error?l.message:"Unknown error"}}},startToolbarRecording:async(t,r)=>{try{const s=e();if(s.isRecording)return console.warn("[RecordingStore] Already recording - current state:",{isRecording:s.isRecording,globalState:s.globalState,recordingType:s.recordingType,hasMediaRecorder:!!s.recordingMediaRecorder,hasStream:!!s.recordingStream}),!1;`${t}`;const i='video/webm;codecs="vp8,opus"',a=new o4(r,{mimeType:i,videoBitsPerSecond:t==="screen"?4e6:25e5});a.ondataavailable=l=>{l.data&&l.data.size>0&&n(c=>{c.recordingChunks.push(l.data)})},a.start(100),n(l=>{l.isRecording=!0,l.recordingStream=r,l.recordingMediaRecorder=a,l.recordingChunks=[],l.recordingType=t,l.recordingStartTime=Date.now()});const o=De.getState();return tx("started",{recording_type:t,flask_id:o.flaskId,method:"toolbar"}),!0}catch(s){return console.error("[RecordingStore] Failed to start recording:",s),!1}},stopToolbarRecording:async()=>new Promise(t=>{const{recordingMediaRecorder:r,recordingStream:s}=e();if(!r){console.warn("[RecordingStore] No recording to stop"),t(null);return}r.onstop=()=>{const i=e().recordingChunks;if(`${i.length}`,i.reduce((a,o)=>a+o.size,0),s&&s.getTracks().forEach(a=>a.stop()),i.length>0){const a=r.mimeType||"video/webm",o=new Blob(i,{type:a});`${o.size}`;const l=r.getAudioBlob?r.getAudioBlob():null;l&&`${l.size}`;const{recordingType:c,recordingStartTime:u}=e(),f=De.getState(),m=u?(Date.now()-u)/1e3:0;tx("completed",{recording_type:c,duration_seconds:Math.round(m),file_size_bytes:o.size,has_audio:c==="thoughts"||c==="screen",flask_id:f.flaskId}),n(g=>{g.isRecording=!1,g.recordingStream=null,g.recordingMediaRecorder=null,g.recordingChunks=[],g.recordingType=null,g.recordingStartTime=null}),t({videoBlob:o,audioBlob:l})}else console.warn("[RecordingStore] No chunks collected"),n(a=>{a.isRecording=!1,a.recordingStream=null,a.recordingMediaRecorder=null,a.recordingChunks=[],a.recordingType=null,a.recordingStartTime=null}),t(null)},r.state==="recording"?r.stop():(console.warn(`[RecordingStore] MediaRecorder not recording: ${r.state}`),t(null))}),cancelToolbarRecording:async()=>{const{recordingMediaRecorder:t,recordingStream:r,flowContext:s}=e();if(n(i=>{i.isCancelled=!0}),t)try{t.state==="recording"&&(t.onstop=()=>{},t.stop())}catch(i){console.error("[RecordingStore] Error stopping media recorder:",i)}if(r)try{r.getTracks().forEach(i=>{i.stop(),`${i.kind}`})}catch(i){console.error("[RecordingStore] Error stopping tracks:",i)}n(i=>{i.isRecording=!1,i.recordingStream=null,i.recordingMediaRecorder=null,i.recordingChunks=[],i.recordingType=null,i.globalState="idle",i.activeRecordingElementId=null,i.flowContext=null,i.countdownValue=null,i.isCountdownActive=!1})},generateThumbnailFromBlob:async t=>new Promise(r=>{try{const s=document.createElement("video"),i=document.createElement("canvas"),a=URL.createObjectURL(t);let o=!1;const l=f=>{o||(o=!0,r(f))},c=setTimeout(()=>{console.warn("[RecordingStore] Thumbnail generation timeout - returning null"),URL.revokeObjectURL(a),l(null)},15e3),u=()=>{try{if(!s.videoWidth||!s.videoHeight)return console.warn("[RecordingStore] Video dimensions not available yet"),!1;i.width=s.videoWidth,i.height=s.videoHeight;const f=i.getContext("2d");return f?(f.drawImage(s,0,0,i.width,i.height),i.toBlob(m=>{if(clearTimeout(c),m){const g=URL.createObjectURL(m);`${i.width}${i.height}`,l(g)}else console.warn("[RecordingStore] Failed to generate thumbnail blob"),l(null);URL.revokeObjectURL(a)},"image/jpeg",.85),!0):(console.warn("[RecordingStore] Failed to get canvas context"),!1)}catch(f){return console.error("[RecordingStore] Error capturing frame:",f),!1}};s.addEventListener("canplay",()=>{if(`${s.duration}${s.videoWidth}${s.videoHeight}`,Number.isFinite(s.duration)&&s.duration>.1&&s.duration!==1/0){const f=s.duration/2;`${f}`;try{s.currentTime=f}catch{console.warn("[RecordingStore] Failed to seek, capturing first frame instead"),u()||(clearTimeout(c),URL.revokeObjectURL(a),l(null))}}else setTimeout(()=>{u()||(clearTimeout(c),URL.revokeObjectURL(a),l(null))},100)},{once:!0}),s.addEventListener("seeked",()=>{`${s.currentTime}`,u()||(clearTimeout(c),URL.revokeObjectURL(a),l(null))},{once:!0}),s.addEventListener("error",f=>{console.error("[RecordingStore] Video error:",f),clearTimeout(c),URL.revokeObjectURL(a),l(null)},{once:!0}),s.src=a,s.muted=!0,s.playsInline=!0,s.preload="auto",s.load()}catch(s){console.error("[RecordingStore] Error in thumbnail generation:",s),r(null)}}),processRecordingBlob:async(t,r,s,i,a="timeline",o=null,l=[],c=null,u,f)=>{`${t.size}`,f&&`${f.size}`;const m=De.getState().flaskId;if(!m)throw new Error("No flask ID available");let g=null;try{const y=De.getState().createElement;let b;if(a==="element"&&o){const{useCanvasStore:M}=await Ze(async()=>{const{useCanvasStore:U}=await Promise.resolve().then(()=>ks);return{useCanvasStore:U}},void 0),D=M.getState().findRootElementInThread(o);D?(b=[{type:"element",targetElementId:D}],`${D}${o}`):(console.warn("[RecordingStore] Could not find root element, linking to original target"),b=[{type:"element",targetElementId:o}])}else c?c.start===c.end?b=[{type:"timeline",timestamp:c.start}]:b=[{type:"timeline",timeRange:{start:c.start,end:c.end}}]:b=[{type:"timeline",timestamp:i}];if(g=await y("recording",{position:s,title:r==="screen"?"Screen Recording":"Thoughts Recording",recordingType:r,links:b,tagIds:l},void 0,void 0),!g)throw new Error("Failed to create element");`${g}`;const x=e().generateThumbnailFromBlob(t),S=URL.createObjectURL(t),T=await x;n(M=>{M.elements[g]={id:g,state:"preparing",type:r,uploadProgress:0,localBlobUrl:S,localThumbnailUrl:T||void 0,recordingDurationSeconds:u,preparingStartTime:Date.now()}});const _=await Ht("/api/recordings/create",{method:"POST",body:JSON.stringify({flaskId:m,recordingType:r})});if(!_.ok){const M=await _.text();throw console.error("[RecordingStore] Failed to create upload:",M),await De.getState().deleteElementsDirectly([g]),new Error("Failed to create recording upload")}const{uploadUrl:R,uploadId:I,recordingId:C}=await _.json();await De.getState().updateElement(g,{recordingId:C});try{await Ht(`/api/recordings/${C}/update`,{method:"PATCH",body:JSON.stringify({elementId:g})})}catch(M){console.warn("[RecordingStore] Failed to update recording with element_id:",M)}n(M=>{M.elements[g]&&(M.elements[g].muxUploadId=I,M.elements[g].recordingId=C)});const{useElementPersistence:L}=await Ze(async()=>{const{useElementPersistence:M}=await Promise.resolve().then(()=>EA);return{useElementPersistence:M}},void 0),k=L.getState().queueUpload({elementId:g,blob:t,audioBlob:f,uploadUrl:R,muxUploadId:I,recordingId:C});try{const{useAIStore:M}=await Ze(async()=>{const{useAIStore:U}=await Promise.resolve().then(()=>F2);return{useAIStore:U}},void 0),D=f||t;`${D.size}`,await M.getState().startProcessing(g,C,D)}catch(M){console.error("[RecordingStore] AI processing failed:",M),await De.getState().updateElement(g,{aiStatus:"failed",aiError:M instanceof Error?M.message:"AI processing failed",aiSummary:"Something went wrong in getting insights"})}}catch(y){console.error("[RecordingStore] Failed to process recording:",y);const{useElementPersistence:b}=await Ze(async()=>{const{useElementPersistence:x}=await Promise.resolve().then(()=>EA);return{useElementPersistence:x}},void 0);throw b.getState().endUpload(),y}},processRecordingBlobDraft:async(t,r,s,i,a="timeline")=>{`${t.size}${s}`,i&&`${i.size}`;const o=De.getState().flaskId;if(!o)return{success:!1,error:"No flask ID available"};try{const{useCanvasStore:l}=await Ze(async()=>{const{useCanvasStore:b}=await Promise.resolve().then(()=>ks);return{useCanvasStore:b}},void 0),c=l.getState().currentUserId,u=`temp-${Date.now()}`,f=URL.createObjectURL(t),m={id:u,elementId:s,type:"recording",displayOrder:0,recordingId:u,recordingType:r,recordingState:"uploading",uploadProgress:0,localBlobUrl:f,aiProcessingStatus:"processing",createdBy:c||void 0,createdAt:new Date().toISOString()};n(b=>{b.elements[u]={id:u,state:"uploading",type:r,uploadProgress:0,localBlobUrl:f}}),l.getState().addDraftAttachment(m,a),`${u}`,`${m.aiProcessingStatus}`;const{useElementPersistence:g}=await Ze(async()=>{const{useElementPersistence:b}=await Promise.resolve().then(()=>EA);return{useElementPersistence:b}},void 0),y=g.getState().queueUpload({elementId:u,blob:t,audioBlob:i,isDraft:!0,flaskId:o,recordingType:r,localBlobUrl:f});return{success:!0,attachment:m}}catch(l){return console.error("[RecordingStore] Failed to process draft recording:",l),{success:!1,error:l instanceof Error?l.message:"Unknown error"}}},pollRecordingStatus:async t=>{const r=e().getElementState(t);if(!r){console.warn(`[RecordingStore] No element state for ${t}`);return}if(r.state==="processing")try{`${t}`;const s=await Ht(`/api/recordings/${r.recordingId}/status`,{method:"POST"});if(!s.ok){const a=await s.text();console.error("[RecordingStore] Status check failed:",a),setTimeout(()=>e().pollRecordingStatus(t),1e4);return}const i=await s.json();if(i.status==="ready"&&i.hlsUrl){i.hlsUrl,i.thumbnailUrl,i.aiStatus;const a=e().elements[t];a?.localBlobUrl&&URL.revokeObjectURL(a.localBlobUrl),e().updateElementState(t,{state:"completed",videoUrl:i.hlsUrl,thumbnailUrl:i.thumbnailUrl,duration:i.duration,aiStatus:i.aiStatus,aiInsights:i.aiInsights,aiError:i.aiError,localBlobUrl:void 0}),await De.getState().updateElement(t,{videoUrl:i.hlsUrl,thumbnailUrl:i.thumbnailUrl,duration:i.duration,recordingState:"completed",aiStatus:i.aiStatus,aiInsights:i.aiInsights,aiError:i.aiError})}else if(i.status==="error"){console.error("[RecordingStore] Recording processing failed");const a=e().elements[t];a?.localBlobUrl&&URL.revokeObjectURL(a.localBlobUrl),e().updateElementState(t,{state:"error",errorMessage:i.error||"Processing failed",localBlobUrl:void 0}),await De.getState().updateElement(t,{recordingState:"error",errorMessage:i.error})}else setTimeout(()=>e().pollRecordingStatus(t),5e3)}catch(s){console.error("[RecordingStore] Error polling status:",s),setTimeout(()=>e().pollRecordingStatus(t),1e4)}},updateElementState:(t,r)=>{if(n(s=>{s.elements[t]&&Object.assign(s.elements[t],r)}),r.state){const i={preparing:"preparing",recording:"recording",uploading:"uploading",processing:"processing",completed:"completed",error:"error"}[r.state];i&&De.getState().updateElement(t,{recordingState:i,...r.videoUrl&&{videoUrl:r.videoUrl},...r.thumbnailUrl&&{thumbnailUrl:r.thumbnailUrl},...r.duration&&{duration:r.duration},...r.errorMessage&&{errorMessage:r.errorMessage}})}},getElementState:t=>e().elements[t],setMuxProcessingStartTime:t=>{n(r=>{r.elements[t]&&(r.elements[t].muxProcessingStartTime=Date.now())})},checkPermissions:async()=>{try{const t=await navigator.permissions.query({name:"camera"}),r=await navigator.permissions.query({name:"microphone"});n(s=>{s.permissions.camera=t.state,s.permissions.microphone=r.state})}catch(t){console.warn("Permission check failed:",t)}},requestPermissions:async t=>{try{const r={};return(t==="camera"||t==="both")&&(r.video=!0),(t==="microphone"||t==="both")&&(r.audio=!0),(await navigator.mediaDevices.getUserMedia(r)).getTracks().forEach(i=>i.stop()),await e().checkPermissions(),!0}catch(r){return console.error("Permission request failed:",r),!1}},enumerateDevices:async()=>{try{const t=await navigator.mediaDevices.enumerateDevices(),r=t.filter(i=>i.kind==="videoinput"),s=t.filter(i=>i.kind==="audioinput");n(i=>{i.settings.availableCameras=r,i.settings.availableMicrophones=s,!i.settings.selectedCameraId&&r.length>0&&(i.settings.selectedCameraId=r[0].deviceId),!i.settings.selectedMicrophoneId&&s.length>0&&(i.settings.selectedMicrophoneId=s[0].deviceId)})}catch(t){console.error("Device enumeration failed:",t)}},setSelectedCamera:t=>{n(r=>{r.settings.selectedCameraId=t})},setSelectedMicrophone:t=>{n(r=>{r.settings.selectedMicrophoneId=t})},openSettingsPopover:()=>{n(t=>{t.isSettingsPopoverOpen=!0})},closeSettingsPopover:()=>{n(t=>{t.isSettingsPopoverOpen=!1})},debugSimulateNoPermissions:()=>{n(t=>{t.permissions.camera="prompt",t.permissions.microphone="prompt"})},setPendingRecordingType:t=>{n(r=>{r.pendingRecordingType=t})},showPermissionModal:()=>{n(t=>{t.isPermissionModalVisible=!0})},hidePermissionModal:()=>{n(t=>{t.isPermissionModalVisible=!1})},setHasRequestedPermission:t=>{n(r=>{r.hasRequestedPermission=t})},setShowPermissionConfirmation:t=>{n(r=>{r.showPermissionConfirmation=t})},prepareRecording:async t=>{try{return n(r=>{r.globalState="preparing",r.activeRecordingElementId=t}),!0}catch(r){return console.error("[RecordingStore] Failed to prepare recording:",r),!1}},startRecording:async t=>{try{return n(r=>{r.globalState="recording",r.activeRecordingElementId=t}),!0}catch(r){return console.error("[RecordingStore] Failed to start recording:",r),!1}},stopRecording:async()=>{try{n(t=>{t.globalState="idle",t.activeRecordingElementId=null})}catch(t){console.error("[RecordingStore] Failed to stop recording:",t)}},cancelRecording:async()=>{try{n(t=>{t.globalState="idle",t.activeRecordingElementId=null})}catch(t){console.error("[RecordingStore] Failed to cancel recording:",t)}},retryRecording:async t=>{const r=e().getElementState(t);if(!r||r.state!=="error")return console.warn(`[RecordingStore] Cannot retry recording for ${t}: not in error state`),!1;try{return n(s=>{s.elements[t]={...s.elements[t],state:"uploading",uploadProgress:0,errorMessage:null}}),`${t}`,!0}catch(s){return console.error("[RecordingStore] Failed to retry recording:",s),!1}},canStartRecording:()=>{const t=e();return t.globalState==="idle"&&!t.isRecording},reset:()=>{const{recordingStream:t,recordingMediaRecorder:r}=e();if(r&&r.state!=="inactive"&&r.stop(),r)try{r.destroy()}catch(s){console.warn("[RecordingStore] Error cleaning up RecordRTC:",s)}t&&t.getTracks().forEach(s=>s.stop()),n(s=>{s.elements={},s.isRecording=!1,s.recordingStream=null,s.recordingMediaRecorder=null,s.recordingChunks=[],s.recordingType=null,s.globalState="idle",s.activeRecordingElementId=null,s.pendingRecordingType=null,s.isPermissionModalVisible=!1,s.hasRequestedPermission=!1,s.showPermissionConfirmation=!1,s.flowContext=null,s.countdownValue=null,s.isCountdownActive=!1,s.isCancelled=!1})},forceResetRecordingState:()=>{const{recordingStream:t,recordingMediaRecorder:r}=e();if(r)try{r.state!=="inactive"&&r.stop(),r.destroy()}catch(s){console.warn("[RecordingStore] Error stopping media recorder during force reset:",s)}if(t)try{t.getTracks().forEach(s=>{try{s.stop()}catch(i){console.warn("[RecordingStore] Error stopping track during force reset:",i)}})}catch(s){console.warn("[RecordingStore] Error stopping tracks during force reset:",s)}n(s=>{s.isRecording=!1,s.recordingStream=null,s.recordingMediaRecorder=null,s.recordingChunks=[],s.recordingType=null,s.globalState="idle",s.activeRecordingElementId=null,s.pendingRecordingType=null,s.isPermissionModalVisible=!1,s.hasRequestedPermission=!1,s.showPermissionConfirmation=!1,s.flowContext=null,s.countdownValue=null,s.isCountdownActive=!1,s.isCancelled=!1})}}))),wk=Object.freeze(Object.defineProperty({__proto__:null,useRecordingStore:vs},Symbol.toStringTag,{value:"Module"})),jbe=()=>{const n=WV(),t=Mt(i=>i.state)==="recording",r=vs(i=>i.isRecording),s=ln(i=>i.saveStatus);E.useEffect(()=>{if(!n)return;const i=()=>!!(r||t||s==="error"),a=o=>{if(i()){const l="Are you sure you want to leave? There might be unsaved changes.";return o.preventDefault(),o.returnValue=l,l}};return window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}},[n,t,r,s])},Fbe=({offsetX:n=0,offsetY:e=0})=>d.jsx("div",{className:"absolute inset-0 w-full h-full bg-card-background pointer-events-none",style:{backgroundImage:"radial-gradient(circle, #7C7C7C 1px, transparent 1px)",backgroundSize:`${fU}px ${fU}px`,backgroundPosition:`${n}px ${e}px`,opacity:.35}});function o0(n,e={}){const{select:t=!0,clearSelection:r=!0}=e,s=De.getState(),i=yt.getState(),a=s.boardState.elements[n];if(!a){console.warn(`[centerElement] Element ${n} not found`);return}const o=a.links?.find(u=>u.type==="element"),l=!!(o&&o.targetElementId),c=l?s.findRootElementInThread(n):n;if(!c){console.warn(`[centerElement] Could not find root element for ${n}`);return}t&&s.selectElement(c,{clearOthers:r,addToSelection:!1}),i.zoomToShowElements([c]),l&&setTimeout(()=>{i.enableThreadScrollOnHover(c),i.scrollThreadToBottom(c)},150)}const l4=Object.freeze(Object.defineProperty({__proto__:null,centerElement:o0},Symbol.toStringTag,{value:"Module"})),Ube=12,kp={"accent-purple":"#a78bfa","accent-blue":"#60a5fa","accent-teal":"#5eead4","accent-green":"#4ade80","accent-lime":"#bef264","accent-orange":"#fdba74","accent-red":"#f87171","accent-gray":"#a1a1aa"},pl=(n,e)=>{const t=parseInt(n.slice(1,3),16),r=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);return`rgba(${t}, ${r}, ${s}, ${e})`},$be=({duration:n,getTimeFromPosition:e,hasEditingPermissions:t})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(null),[c,u]=E.useState(!1),[f,m]=E.useState(!1),[g,y]=E.useState(0),[b,x]=E.useState(0),S=E.useRef(null),T=De(G=>G.boardState.elements);dn(G=>G.activeFilterIds),dn(G=>G.filterMode);const _=dn(G=>G.isElementVisible),R=De(G=>G.isCurrentUserElementOwner),I=De(G=>G.checkElementOwnership),C=De(G=>G.updateElementLinkVisual),L=De(G=>G.commitElementLinkUpdate),k=De(G=>G.startPillOperation),M=De(G=>G.updatePillOperation),D=De(G=>G.endPillOperation),U=He(G=>G.requestPreview),$=He(G=>G.exitPreview),V=De(G=>G.selectedFrames),B=De(G=>G.getElementTags),W=De(G=>G.timelineDraft),F=De(G=>G.timelineDraftManuallyPositioned),j=De(G=>G.updateDraftLink),q=Mt(G=>G.isPlayheadHovered);E.useEffect(()=>{if(!f&&!W)return;let G=null,Y=He.getState().currentTime,Q=performance.now(),J=He.getState().isPlaying;const ee=()=>{const oe=He.getState(),te=performance.now();oe.isPlaying!==J&&(J=oe.isPlaying,Y=oe.currentTime,Q=te,oe.isPlaying||x(oe.currentTime)),Math.abs(oe.currentTime-Y)>.01&&(Y=oe.currentTime,Q=te);let se=Y;if(oe.isPlaying&&!oe.isBuffering){const he=(te-Q)/1e3;se=Y+he*oe.playbackRate,se=Math.min(se,oe.duration)}x(se),G=requestAnimationFrame(ee)};return G=requestAnimationFrame(ee),()=>{G!==null&&cancelAnimationFrame(G)}},[f,W]);const H=E.useMemo(()=>{const G=[];if(Object.entries(T).forEach(([Y,Q])=>{Q&&Q.links&&Q.links.forEach((J,ee)=>{J.type==="timeline"&&G.push({elementId:Y,element:Q,linkIndex:ee,link:J,isDraft:!1})})}),W&&W.links){let Y=W.links.find(Q=>Q.type==="timeline");Y&&(F||(Y={type:"timeline",timestamp:b}),G.push({elementId:"draft-timeline",element:null,linkIndex:0,link:Y,isDraft:!0,draftKey:"timeline",isPlaceholder:!1}))}else f&&G.push({elementId:"draft-placeholder",element:null,linkIndex:0,link:{type:"timeline",timestamp:b},isDraft:!0,draftKey:"placeholder",isPlaceholder:!0});return G},[T,W,F,b,f]),N=E.useCallback((G,Y,Q,J,ee,oe,te,se)=>{if(G.stopPropagation(),G.preventDefault(),!oe&&!se&&!I(Y,"link modification"))return;const he=J.timeRange?.start??J.timestamp??0,Z=J.timeRange?.end??J.timestamp??0,pe=e(G.clientX);l({elementId:Y,isDraft:oe,linkIndex:Q,type:ee,initialMouseX:G.clientX,initialStartTime:he,initialEndTime:Z,currentStartTime:he,currentEndTime:Z,initialTimeAtMouse:pe,isDragging:!1,draftKey:te,isPlaceholder:se})},[I,e]),O=E.useCallback(G=>{if(!o||!S.current)return;const Y=5,Q=Math.abs(G.clientX-o.initialMouseX),{elementId:J,isDraft:ee,linkIndex:oe,type:te,initialStartTime:se,initialEndTime:he,initialTimeAtMouse:Z}=o,pe=he-se;if(!o.isDragging){if(Q<Y)return;const ie=te==="resize-start"?se:te==="resize-end"?he:se;!ee&&!o.isPlaceholder&&k(te==="move"?"move":"resize",J,oe,ie,{start:se,end:he}),o.isPlaceholder||U(ie,"linkdots"),l(fe=>fe?{...fe,isDragging:!0}:null);return}const ye=e(G.clientX);let ae=se,le=he;if(te==="move"){const ie=ye-Z;ae=se+ie,le=he+ie,ae<0&&(ae=0,le=pe),le>n&&(le=n,ae=n-pe)}else te==="resize-start"?(ae=ye,le=he,ae>le&&([ae,le]=[le,ae])):te==="resize-end"&&(ae=se,le=ye,le<ae&&([ae,le]=[le,ae]));ae=Math.max(0,Math.min(ae,n)),le=Math.max(0,Math.min(le,n)),l(ie=>ie?{...ie,currentStartTime:ae,currentEndTime:le}:null),o.isPlaceholder||(ee?j(ae===le?{type:"timeline",timestamp:ae}:{type:"timeline",timeRange:{start:ae,end:le}},!0,o.draftKey):(C(J,oe,{timestamp:ae===le?ae:void 0,timeRange:ae!==le?{start:ae,end:le}:void 0}),M(te==="resize-start"?ae:te==="resize-end"?le:ae,{start:ae,end:le})),U(te==="resize-start"?ae:te==="resize-end"?le:ae,"linkdots"))},[o,n,e,C,j,M,U,k]),z=E.useCallback(async()=>{if(!o)return;const{elementId:G,isDraft:Y,linkIndex:Q,currentStartTime:J,currentEndTime:ee,isDragging:oe,isPlaceholder:te}=o;if(te){oe?Ze(async()=>{const{useToolbarStore:se}=await Promise.resolve().then(()=>di);return{useToolbarStore:se}},void 0).then(({useToolbarStore:se})=>{se.getState().focusTextbox("timeline"),setTimeout(()=>{const Z=De.getState(),pe=J===ee?{type:"timeline",timestamp:J}:{type:"timeline",timeRange:{start:J,end:ee}};Z.updateDraftLink(pe,!0,"timeline")},50)}):Ze(async()=>{const{useToolbarStore:se}=await Promise.resolve().then(()=>di);return{useToolbarStore:se}},void 0).then(({useToolbarStore:se})=>{se.getState().focusTextbox("timeline")}),l(null);return}oe&&(Y||(C(G,Q,{timestamp:J===ee?J:void 0,timeRange:J!==ee?{start:J,end:ee}:void 0}),await L(G,Q),D()),$()),l(null)},[o,C,L,D,$]);return E.useEffect(()=>{if(o){const G=Q=>O(Q),Y=()=>z();return window.addEventListener("mousemove",G),window.addEventListener("mouseup",Y),o.isDragging&&(document.body.style.cursor=o.type==="move"?"grabbing":"ew-resize"),()=>{window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",Y),document.body.style.cursor=""}}},[o,O,z]),E.useEffect(()=>{if(c)m(!0),requestAnimationFrame(()=>{y(1)});else{y(0);const G=setTimeout(()=>{m(!1)},100);return()=>clearTimeout(G)}},[c]),E.useEffect(()=>{const G=Y=>{if(o?.isPlaceholder)return;const Q=document.querySelector(".video-playbar");if(!Q){u(!1);return}const J=Q.getBoundingClientRect(),ee=Y.clientX>=J.left&&Y.clientX<=J.right,oe=Y.clientY>=J.top-6&&Y.clientY<=J.bottom+30;u(ee&&oe)};return window.addEventListener("mousemove",G),()=>{window.removeEventListener("mousemove",G)}},[o]),H.length===0||n<=0?null:d.jsx("div",{ref:S,className:"link-dots relative w-full h-full flex items-center pointer-events-none top-[22px] overflow-visible",children:H.map(({elementId:G,element:Y,linkIndex:Q,link:J,isDraft:ee,draftKey:oe,isPlaceholder:te})=>{const se=V.includes(G),he=o?.elementId===G&&o?.linkIndex===Q,pe=se||r===G&&!o||he||te&&q;if(!ee&&!_(Y))return null;const ye=t&&(ee||R(G));let ae,le;he&&o?(ae=o.currentStartTime,le=o.currentEndTime):(ae=J.timeRange?.start??J.timestamp??0,le=J.timeRange?.end??J.timestamp??0);const ie=Math.max(0,Math.min(ae,n)),fe=Math.max(0,Math.min(le,n)),Ie=ie/n*100,ne=fe/n*100,ce=Math.max(0,ne-Ie),Ce=Math.abs(fe-ie)<.01,Oe=ee?[]:B(G),ze=Oe.length>0?Oe[0].color:void 0,We=pl(ze&&kp[ze]||"#FAFAFA",.5),lt=(()=>{if(Oe.length===0)return{backgroundColor:pl("#E2E8F0",se?.8:.4)};if(Oe.length===1){const Ke=kp[Oe[0].color]||"#E2E8F0";return{backgroundColor:pl(Ke,se?1:.7)}}const Ue=Oe.map(Ke=>kp[Ke.color]||"#E2E8F0");return{background:`linear-gradient(90deg, ${Ue.map((Ke,Qe)=>{const ht=Qe/(Ue.length-1)*100;return`${pl(Ke,se?1:.7)} ${ht}%`}).join(", ")})`}})(),Ee=Ce?`calc(${Ie}% - 34px)`:`${Ie}%`,be=fe-ie,Ae=Ce?100:Math.max(10,100-Math.floor(Math.log10(be*1e3+1)*10)),Me=()=>{if(!pe)return{};if(Oe.length===0)return{backgroundColor:pl("#E2E8F0",se?.95:.65)};if(Oe.length===1){const Ke=kp[Oe[0].color]||"#E2E8F0";return{backgroundColor:pl(Ke,se?1:.9)}}const Ue=Oe.map(Ke=>kp[Ke.color]||"#E2E8F0");return{background:`linear-gradient(90deg, ${Ue.map((Ke,Qe)=>{const ht=Qe/(Ue.length-1)*100;return`${pl(Ke,se?1:.9)} ${ht}%`}).join(", ")})`}};return d.jsxs("div",{className:je("absolute top-2 h-full group overflow-visible",Ce?"pointer-events-none":"pointer-events-auto"),style:{left:Ee,width:Ce?"68px":`${ce}%`,minWidth:Ce?"68px":`${Ube}px`,zIndex:Ae},onMouseEnter:()=>!o&&!Ce&&s(G),onMouseLeave:()=>!o&&!Ce&&s(null),children:[d.jsx("div",{className:je("absolute transform backdrop-blur-md rounded-[8px] pointer-events-auto",Ce?"w-4 left-1/2 -translate-x-1/2":"w-full",!he&&"cursor-pointer",ee&&!te&&"animate-pulse-custom"),style:{...te?{backgroundColor:pl("#E2E8F0",.25)}:ee&&!te?lt:pe?Me():lt,height:ee&&!te||pe?"24px":"16px",top:ee&&!te||pe?"-27px":"-24px",borderTop:`1px solid  ${We}`,boxShadow:"inset 0 0 10px rgba(255, 255, 255, 0.4), 0 4px 12px rgba(0, 0, 0, 0.5), 0 2px 6px rgba(0, 0, 0, 0.3)",position:"relative",transition:ee&&!te?"none":"all 200ms",opacity:te?g:void 0},onClick:Ue=>{if(!(o&&o.isDragging)){if(Ue.stopPropagation(),te){Ze(async()=>{const{useToolbarStore:Ge}=await Promise.resolve().then(()=>di);return{useToolbarStore:Ge}},void 0).then(({useToolbarStore:Ge})=>{Ge.getState().focusTextbox("timeline")});return}ee||o0(G)}},onMouseDown:Ue=>{if(te){N(Ue,G,Q,J,"resize-start",!0,oe,!0);return}ye&&N(Ue,G,Q,J,"move",ee||!1,oe)},onMouseEnter:()=>{!o&&(te||Ce)&&s(G)},onMouseLeave:()=>{!o&&(te||Ce)&&s(null)},children:te&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:d.jsx(Jc,{className:"w-3 h-3 text-text-primary",strokeWidth:2.5})})}),(ye||te)&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute cursor-ew-resize pointer-events-auto",style:{left:Ce?"21px":"-4px",top:"-15px",transform:"translateY(-50%)",width:"16px",zIndex:12},onMouseEnter:()=>{te||(a({elementId:G,linkIndex:Q,side:"left"}),s(G))},onMouseLeave:()=>{te||(a(null),s(null))},onMouseDown:Ue=>{Ue.preventDefault(),Ue.stopPropagation(),N(Ue,G,Q,J,"resize-start",ee||!1,oe,te)},children:d.jsx("div",{className:"absolute rounded-full  bg-text-primary",style:{left:"4px",transform:"translateY(-50%)",width:"3px",height:"18px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",opacity:i?.elementId===G&&i?.linkIndex===Q&&i?.side==="left"||he&&o?.type==="resize-start"?1:0}})}),d.jsx("div",{className:"absolute cursor-ew-resize pointer-events-auto",style:{right:Ce?"21px":"-4px",top:"-15px",transform:"translateY(-50%)",width:"16px",zIndex:12},onMouseEnter:()=>{te||(a({elementId:G,linkIndex:Q,side:"right"}),s(G))},onMouseLeave:()=>{te||(a(null),s(null))},onMouseDown:Ue=>{Ue.preventDefault(),Ue.stopPropagation(),N(Ue,G,Q,J,"resize-end",ee||!1,oe,te)},children:d.jsx("div",{className:"absolute rounded-full bg-text-primary",style:{right:"4px",top:"50%",transform:"translateY(-50%)",width:"3px",height:"18px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",opacity:i?.elementId===G&&i?.linkIndex===Q&&i?.side==="right"||he&&o?.type==="resize-end"?1:0}})})]})]},`${G}-${Q}`)})})},Yc=(n,e,t)=>{const r=document.createElement(n),[s,i]=Array.isArray(e)?[void 0,e]:[e,t];return s&&Object.assign(r,s),i?.forEach(a=>r.appendChild(a)),r},Bbe=(n,e)=>{var t;return e==="left"?n.offsetLeft:(((t=n.offsetParent instanceof HTMLElement?n.offsetParent:null)==null?void 0:t.offsetWidth)??0)-n.offsetWidth-n.offsetLeft},Hbe=n=>n.offsetWidth>0&&n.offsetHeight>0,Vbe=(n,e)=>{!customElements.get(n)&&customElements.define(n,e)};function zbe(n,e,{reverse:t=!1}={}){const r=n.length;for(let s=t?r-1:0;t?s>=0:s<r;t?s--:s++)e(n[s],s)}function Gbe(n,e,t,r){const s=e.formatToParts(n);t&&s.unshift({type:"prefix",value:t}),r&&s.push({type:"suffix",value:r});const i=[],a=[],o=[],l=[],c={},u=b=>`${b}:${c[b]=(c[b]??-1)+1}`;let f="",m=!1,g=!1;for(const b of s){f+=b.value;const x=b.type==="minusSign"||b.type==="plusSign"?"sign":b.type;x==="integer"?(m=!0,a.push(...b.value.split("").map(S=>({type:x,value:parseInt(S)})))):x==="group"?a.push({type:x,value:b.value}):x==="decimal"?(g=!0,o.push({type:x,value:b.value,key:u(x)})):x==="fraction"?o.push(...b.value.split("").map(S=>({type:x,value:parseInt(S),key:u(x),pos:-1-c[x]}))):(m||g?l:i).push({type:x,value:b.value,key:u(x)})}const y=[];for(let b=a.length-1;b>=0;b--){const x=a[b];y.unshift(x.type==="integer"?{...x,key:u(x.type),pos:c[x.type]}:{...x,key:u(x.type)})}return{pre:i,integer:y,fraction:o,post:l,valueAsString:f,value:typeof n=="string"?parseFloat(n):n}}const qbe=String.raw,Wbe=(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0})(),Kbe=typeof CSS<"u"&&CSS.supports&&CSS.supports("line-height","mod(1,1)"),c4=typeof matchMedia<"u"?matchMedia("(prefers-reduced-motion: reduce)"):null,kw="--_number-flow-d-opacity",JD="--_number-flow-d-width",Iw="--_number-flow-dx",e2="--_number-flow-d",Ybe=(()=>{try{return CSS.registerProperty({name:kw,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:Iw,syntax:"<length>",inherits:!0,initialValue:"0px"}),CSS.registerProperty({name:JD,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:e2,syntax:"<number>",inherits:!0,initialValue:"0"}),!0}catch{return!1}})(),Xbe="var(--number-flow-char-height, 1em)",kc="var(--number-flow-mask-height, 0.25em)",u4=`calc(${kc} / 2)`,Ek="var(--number-flow-mask-width, 0.5em)",$u=`calc(${Ek} / var(--scale-x))`,ib="#000 0, transparent 71%",d4=qbe`:host{display:inline-block;direction:ltr;white-space:nowrap;isolation:isolate;line-height:${Xbe} !important}.number,.number__inner{display:inline-block;transform-origin:left top}:host([data-will-change]) :is(.number,.number__inner,.section,.digit,.digit__num,.symbol){will-change:transform}.number{--scale-x:calc(1 + var(${JD}) / var(--width));transform:translateX(var(${Iw})) scaleX(var(--scale-x));margin:0 calc(-1 * ${Ek});position:relative;-webkit-mask-image:linear-gradient(to right,transparent 0,#000 ${$u},#000 calc(100% - ${$u}),transparent ),linear-gradient(to bottom,transparent 0,#000 ${kc},#000 calc(100% - ${kc}),transparent 100% ),radial-gradient(at bottom right,${ib}),radial-gradient(at bottom left,${ib}),radial-gradient(at top left,${ib}),radial-gradient(at top right,${ib});-webkit-mask-size:100% calc(100% - ${kc} * 2),calc(100% - ${$u} * 2) 100%,${$u} ${kc},${$u} ${kc},${$u} ${kc},${$u} ${kc};-webkit-mask-position:center,center,top left,top right,bottom right,bottom left;-webkit-mask-repeat:no-repeat}.number__inner{padding:${u4} ${Ek};transform:scaleX(calc(1 / var(--scale-x))) translateX(calc(-1 * var(${Iw})))}:host > :not(.number){z-index:5}.section,.symbol{display:inline-block;position:relative;isolation:isolate}.section::after{content:'\200b';display:inline-block}.section--justify-left{transform-origin:center left}.section--justify-right{transform-origin:center right}.section > [inert],.symbol > [inert]{margin:0 !important;position:absolute !important;z-index:-1}.digit{display:inline-block;position:relative;--c:var(--current) + var(${e2})}.digit__num,.number .section::after{padding:${u4} 0}.digit__num{display:inline-block;--offset-raw:mod(var(--length) + var(--n) - mod(var(--c),var(--length)),var(--length));--offset:calc( var(--offset-raw) - var(--length) * round(down,var(--offset-raw) / (var(--length) / 2),1) );--y:clamp(-100%,var(--offset) * 100%,100%);transform:translateY(var(--y))}.digit__num[inert]{position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(var(--y))}.digit:not(.is-spinning) .digit__num[inert]{display:none}.symbol__value{display:inline-block;mix-blend-mode:plus-lighter;white-space:pre}.section--justify-left .symbol > [inert]{left:0}.section--justify-right .symbol > [inert]{right:0}.animate-presence{opacity:calc(1 + var(${kw}))}`,Qbe=HTMLElement,Zbe=Kbe&&Wbe&&Ybe;let ab;class Z9 extends Qbe{constructor(){super(),this.created=!1,this.batched=!1;const{animated:e,...t}=this.constructor.defaultProps;this._animated=this.computedAnimated=e,Object.assign(this,t)}get animated(){return this._animated}set animated(e){var t;this.animated!==e&&(this._animated=e,(t=this.shadowRoot)==null||t.getAnimations().forEach(r=>r.finish()))}set data(e){var t;if(e==null)return;const{pre:r,integer:s,fraction:i,post:a,value:o}=e;if(this.created){const l=this._data;this._data=e,this.computedTrend=typeof this.trend=="function"?this.trend(l.value,o):this.trend,this.computedAnimated=Zbe&&this._animated&&(!this.respectMotionPreference||!(c4!=null&&c4.matches))&&Hbe(this),(t=this.plugins)==null||t.forEach(c=>{var u;return(u=c.onUpdate)==null?void 0:u.call(c,e,l,this)}),this.batched||this.willUpdate(),this._pre.update(r),this._num.update({integer:s,fraction:i}),this._post.update(a),this.batched||this.didUpdate()}else{this._data=e,this.attachShadow({mode:"open"});try{this._internals??(this._internals=this.attachInternals()),this._internals.role="img"}catch{}if(typeof CSSStyleSheet<"u"&&this.shadowRoot.adoptedStyleSheets)ab||(ab=new CSSStyleSheet,ab.replaceSync(d4)),this.shadowRoot.adoptedStyleSheets=[ab];else{const l=document.createElement("style");l.textContent=d4,this.shadowRoot.appendChild(l)}this._pre=new f4(this,r,{justify:"right",part:"left"}),this.shadowRoot.appendChild(this._pre.el),this._num=new Jbe(this,s,i),this.shadowRoot.appendChild(this._num.el),this._post=new f4(this,a,{justify:"left",part:"right"}),this.shadowRoot.appendChild(this._post.el),this.created=!0}try{this._internals.ariaLabel=e.valueAsString}catch{}}willUpdate(){this._pre.willUpdate(),this._num.willUpdate(),this._post.willUpdate()}didUpdate(){if(!this.computedAnimated)return;this._abortAnimationsFinish?this._abortAnimationsFinish.abort():this.dispatchEvent(new Event("animationsstart")),this._pre.didUpdate(),this._num.didUpdate(),this._post.didUpdate();const e=new AbortController;Promise.all(this.shadowRoot.getAnimations().map(t=>t.finished)).then(()=>{e.signal.aborted||(this.dispatchEvent(new Event("animationsfinish")),this._abortAnimationsFinish=void 0)}),this._abortAnimationsFinish=e}}Z9.defaultProps={transformTiming:{duration:900,easing:"linear(0,.005,.019,.039,.066,.096,.129,.165,.202,.24,.278,.316,.354,.39,.426,.461,.494,.526,.557,.586,.614,.64,.665,.689,.711,.731,.751,.769,.786,.802,.817,.831,.844,.856,.867,.877,.887,.896,.904,.912,.919,.925,.931,.937,.942,.947,.951,.955,.959,.962,.965,.968,.971,.973,.976,.978,.98,.981,.983,.984,.986,.987,.988,.989,.99,.991,.992,.992,.993,.994,.994,.995,.995,.996,.996,.9963,.9967,.9969,.9972,.9975,.9977,.9979,.9981,.9982,.9984,.9985,.9987,.9988,.9989,1)"},spinTiming:void 0,opacityTiming:{duration:450,easing:"ease-out"},animated:!0,trend:(n,e)=>Math.sign(e-n),respectMotionPreference:!0,plugins:void 0,digits:void 0};class Jbe{constructor(e,t,r,{className:s,...i}={}){this.flow=e,this._integer=new h4(e,t,{justify:"right",part:"integer"}),this._fraction=new h4(e,r,{justify:"left",part:"fraction"}),this._inner=Yc("span",{className:"number__inner"},[this._integer.el,this._fraction.el]),this.el=Yc("span",{...i,part:"number",className:`number ${s??""}`},[this._inner])}willUpdate(){this._prevWidth=this.el.offsetWidth,this._prevLeft=this.el.getBoundingClientRect().left,this._integer.willUpdate(),this._fraction.willUpdate()}update({integer:e,fraction:t}){this._integer.update(e),this._fraction.update(t)}didUpdate(){const e=this.el.getBoundingClientRect();this._integer.didUpdate(),this._fraction.didUpdate();const t=this._prevLeft-e.left,r=this.el.offsetWidth,s=this._prevWidth-r;this.el.style.setProperty("--width",String(r)),this.el.animate({[Iw]:[`${t}px`,"0px"],[JD]:[s,0]},{...this.flow.transformTiming,composite:"accumulate"})}}class J9{constructor(e,t,{justify:r,className:s,...i},a){this.flow=e,this.children=new Map,this.onCharRemove=l=>()=>{this.children.delete(l)},this.justify=r;const o=t.map(l=>this.addChar(l).el);this.el=Yc("span",{...i,className:`section section--justify-${r} ${s??""}`},a?a(o):o)}addChar(e,{startDigitsAtZero:t=!1,...r}={}){const s=e.type==="integer"||e.type==="fraction"?new tq(this,e.type,t?0:e.value,e.pos,{...r,onRemove:this.onCharRemove(e.key)}):new exe(this,e.type,e.value,{...r,onRemove:this.onCharRemove(e.key)});return this.children.set(e.key,s),s}unpop(e){e.el.removeAttribute("inert"),e.el.style.top="",e.el.style[this.justify]=""}pop(e){e.forEach(t=>{t.el.style.top=`${t.el.offsetTop}px`,t.el.style[this.justify]=`${Bbe(t.el,this.justify)}px`}),e.forEach(t=>{t.el.setAttribute("inert",""),t.present=!1})}addNewAndUpdateExisting(e){const t=new Map,r=new Map,s=this.justify==="left",i=s?"prepend":"append";if(zbe(e,a=>{let o;this.children.has(a.key)?(o=this.children.get(a.key),r.set(a,o),this.unpop(o),o.present=!0):(o=this.addChar(a,{startDigitsAtZero:!0,animateIn:!0}),t.set(a,o)),this.el[i](o.el)},{reverse:s}),this.flow.computedAnimated){const a=this.el.getBoundingClientRect();t.forEach(o=>{o.willUpdate(a)})}t.forEach((a,o)=>{a.update(o.value)}),r.forEach((a,o)=>{a.update(o.value)})}willUpdate(){const e=this.el.getBoundingClientRect();this._prevOffset=e[this.justify],this.children.forEach(t=>t.willUpdate(e))}didUpdate(){const e=this.el.getBoundingClientRect();this.children.forEach(s=>s.didUpdate(e));const t=e[this.justify],r=this._prevOffset-t;r&&this.children.size&&this.el.animate({transform:[`translateX(${r}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}}class h4 extends J9{update(e){const t=new Map;this.children.forEach((r,s)=>{e.find(i=>i.key===s)||t.set(s,r),this.unpop(r)}),this.addNewAndUpdateExisting(e),t.forEach(r=>{r instanceof tq&&r.update(0)}),this.pop(t)}}class f4 extends J9{update(e){const t=new Map;this.children.forEach((r,s)=>{e.find(i=>i.key===s)||t.set(s,r)}),this.pop(t),this.addNewAndUpdateExisting(e)}}class Sk{constructor(e,t,{onRemove:r,animateIn:s=!1}={}){this.flow=e,this.el=t,this._present=!0,this._remove=()=>{var i;this.el.remove(),(i=this._onRemove)==null||i.call(this)},this.el.classList.add("animate-presence"),this.flow.computedAnimated&&s&&this.el.animate({[kw]:[-.9999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),this._onRemove=r}get present(){return this._present}set present(e){if(this._present!==e){if(this._present=e,e?this.el.removeAttribute("inert"):this.el.setAttribute("inert",""),!this.flow.computedAnimated){e||this._remove();return}this.el.style.setProperty("--_number-flow-d-opacity",e?"0":"-.999"),this.el.animate({[kw]:e?[-.9999,0]:[.999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),e?this.flow.removeEventListener("animationsfinish",this._remove):this.flow.addEventListener("animationsfinish",this._remove,{once:!0})}}}class eq extends Sk{constructor(e,t,r,s){super(e.flow,r,s),this.section=e,this.value=t,this.el=r}}class tq extends eq{constructor(e,t,r,s,i){var a,o;const l=(((o=(a=e.flow.digits)==null?void 0:a[s])==null?void 0:o.max)??9)+1,c=Array.from({length:l}).map((f,m)=>{const g=Yc("span",{className:"digit__num"},[document.createTextNode(String(m))]);return m!==r&&g.setAttribute("inert",""),g.style.setProperty("--n",String(m)),g}),u=Yc("span",{part:`digit ${t}-digit`,className:"digit"},c);u.style.setProperty("--current",String(r)),u.style.setProperty("--length",String(l)),super(e,r,u,i),this.pos=s,this._onAnimationsFinish=()=>{this.el.classList.remove("is-spinning")},this._numbers=c,this.length=l}willUpdate(e){const t=this.el.getBoundingClientRect();this._prevValue=this.value;const r=t[this.section.justify]-e[this.section.justify],s=t.width/2;this._prevCenter=this.section.justify==="left"?r+s:r-s}update(e){this.el.style.setProperty("--current",String(e)),this._numbers.forEach((t,r)=>r===e?t.removeAttribute("inert"):t.setAttribute("inert","")),this.value=e}didUpdate(e){const t=this.el.getBoundingClientRect(),r=t[this.section.justify]-e[this.section.justify],s=t.width/2,i=this.section.justify==="left"?r+s:r-s,a=this._prevCenter-i;a&&this.el.animate({transform:[`translateX(${a}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"});const o=this.getDelta();o&&(this.el.classList.add("is-spinning"),this.el.animate({[e2]:[-o,0]},{...this.flow.spinTiming??this.flow.transformTiming,composite:"accumulate"}),this.flow.addEventListener("animationsfinish",this._onAnimationsFinish,{once:!0}))}getDelta(){var e;if(this.flow.plugins)for(const s of this.flow.plugins){const i=(e=s.getDelta)==null?void 0:e.call(s,this.value,this._prevValue,this);if(i!=null)return i}const t=this.value-this._prevValue,r=this.flow.computedTrend||Math.sign(t);return r<0&&this.value>this._prevValue?this.value-this.length-this._prevValue:r>0&&this.value<this._prevValue?this.length-this._prevValue+this.value:t}}let exe=class extends eq{constructor(e,t,r,s){const i=Yc("span",{className:"symbol__value",textContent:r});super(e,r,Yc("span",{part:`symbol ${t}`,className:"symbol"},[i]),s),this.type=t,this._children=new Map,this._onChildRemove=a=>()=>{this._children.delete(a)},this._children.set(r,new Sk(this.flow,i,{onRemove:this._onChildRemove(r)}))}willUpdate(e){if(this.type==="decimal")return;const t=this.el.getBoundingClientRect();this._prevOffset=t[this.section.justify]-e[this.section.justify]}update(e){if(this.value!==e){const t=this._children.get(this.value);t&&(t.present=!1);const r=this._children.get(e);if(r)r.present=!0;else{const s=Yc("span",{className:"symbol__value",textContent:e});this.el.appendChild(s),this._children.set(e,new Sk(this.flow,s,{animateIn:!0,onRemove:this._onChildRemove(e)}))}}this.value=e}didUpdate(e){if(this.type==="decimal")return;const t=this.el.getBoundingClientRect()[this.section.justify]-e[this.section.justify],r=this._prevOffset-t;r&&this.el.animate({transform:[`translateX(${r}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}};const txe=parseInt(E.version.match(/^(\d+)\./)?.[1]),t2=txe>=19,nxe=["data","digits"];class n2 extends Z9{attributeChangedCallback(e,t,r){this[e]=JSON.parse(r)}}n2.observedAttributes=t2?[]:nxe;Vbe("number-flow-react",n2);const rxe={},m4=t2?n=>n:JSON.stringify;function p4(n){const{transformTiming:e,spinTiming:t,opacityTiming:r,animated:s,respectMotionPreference:i,trend:a,plugins:o,...l}=n;return[{transformTiming:e,spinTiming:t,opacityTiming:r,animated:s,respectMotionPreference:i,trend:a,plugins:o},l]}class sxe extends E.Component{updateProperties(e){if(!this.el)return;this.el.batched=!this.props.isolate;const[t]=p4(this.props);Object.entries(t).forEach(([r,s])=>{this.el[r]=s??n2.defaultProps[r]}),e?.onAnimationsStart&&this.el.removeEventListener("animationsstart",e.onAnimationsStart),this.props.onAnimationsStart&&this.el.addEventListener("animationsstart",this.props.onAnimationsStart),e?.onAnimationsFinish&&this.el.removeEventListener("animationsfinish",e.onAnimationsFinish),this.props.onAnimationsFinish&&this.el.addEventListener("animationsfinish",this.props.onAnimationsFinish)}componentDidMount(){this.updateProperties(),t2&&this.el&&(this.el.digits=this.props.digits,this.el.data=this.props.data)}getSnapshotBeforeUpdate(e){if(this.updateProperties(e),e.data!==this.props.data){if(this.props.group)return this.props.group.willUpdate(),()=>this.props.group?.didUpdate();if(!this.props.isolate)return this.el?.willUpdate(),()=>this.el?.didUpdate()}return null}componentDidUpdate(e,t,r){r?.()}handleRef(e){this.props.innerRef&&(this.props.innerRef.current=e),this.el=e}render(){const[e,{innerRef:t,className:r,data:s,willChange:i,isolate:a,group:o,digits:l,onAnimationsStart:c,onAnimationsFinish:u,...f}]=p4(this.props);return E.createElement("number-flow-react",{ref:this.handleRef,"data-will-change":i?"":void 0,class:r,...f,dangerouslySetInnerHTML:{__html:""},suppressHydrationWarning:!0,digits:m4(l),data:m4(s)})}constructor(e){super(e),this.handleRef=this.handleRef.bind(this)}}const Er=E.forwardRef(function({value:e,locales:t,format:r,prefix:s,suffix:i,...a},o){E.useImperativeHandle(o,()=>l.current,[]);const l=E.useRef(),c=E.useContext(ixe);c?.useRegister(l);const u=E.useMemo(()=>t?JSON.stringify(t):"",[t]),f=E.useMemo(()=>r?JSON.stringify(r):"",[r]),m=E.useMemo(()=>{const g=rxe[`${u}:${f}`]??=new Intl.NumberFormat(t,r);return Gbe(e,g,s,i)},[e,u,f,s,i]);return E.createElement(sxe,{...a,group:c,data:m,innerRef:l})}),ixe=E.createContext(void 0),axe=({playbarWidth:n,hoverTime:e})=>{const t=He(L=>L.duration),r=He(L=>L.storyboard),s=He(L=>L.getTileForTime),i=He(L=>!!L.muxPlaybackId),a=yt(L=>L.timelineScale),o=yt(L=>L.timelineOffset),[l,c]=E.useState(null),[u,f]=E.useState(!1),m=E.useRef(null);if(E.useEffect(()=>{const L=document.querySelector(".video-playbar");if(L){const k=L.getBoundingClientRect();c(k)}},[a,o]),E.useEffect(()=>(m.current&&clearTimeout(m.current),e===null?f(!1):m.current=setTimeout(()=>f(!0),10),()=>{m.current&&clearTimeout(m.current)}),[e]),e===null||!l)return null;const y=(t>0?e/t:0)*n,b=i&&e!==null?s(e):null,x=i&&r&&b,S=Math.floor(e),T=Math.floor(S/3600),_=Math.floor(S%3600/60),R=S%60,I=l.left+y,C=window.innerHeight-l.top+8;return Hs.createPortal(d.jsx("div",{className:"fixed pointer-events-none z-[9999]",style:{left:`${I}px`,bottom:`${C}px`,transform:`translateX(-50%) translateY(${u?0:8}px)`,opacity:u?1:0,transition:"opacity 100ms ease-out, transform 100ms ease-out"},children:d.jsxs("div",{className:"flex flex-col items-center rounded-2xl overflow-hidden border element-border p-2 bg-inbetween-background text-primary shadow-md shadow-black/30",children:[x&&d.jsx("div",{className:"relative overflow-hidden rounded-xl bg-black mb-2 ",style:{width:`${r.tile_width}px`,height:`${r.tile_height}px`},children:d.jsx("img",{src:r.url,alt:"",className:"absolute",style:{width:`${r.spriteSheetWidth}px`,height:`${r.spriteSheetHeight}px`,objectFit:"none",objectPosition:`-${b.x}px -${b.y}px`}})}),d.jsx("div",{className:"flex items-center justify-center text-xs px-3 py-1 font-mono",children:d.jsxs("div",{className:"flex items-center",children:[T>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:T,format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"h"}),d.jsx("span",{children:":"})]}),(_>0||T>0)&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:_,format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"m"}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:R,format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"s"})]})})]})}),document.body)},oxe={second:[1,2,5,10,15,30],minute:[1,2,5,10,15,30],hour:[1,2,3,4,6,12],day:[1,2,3,7,14]},lxe=240;function cxe(n,e){const t=["second","minute","hour","day"];for(const r of t){const s=oxe[r];for(const i of s){let a;switch(r){case"second":a=i;break;case"minute":a=i*60;break;case"hour":a=i*3600;break;case"day":a=i*86400;break;default:a=1}const o=n/a;if(e/o>=lxe)return{unit:r,step:i}}}return{unit:"second",step:1}}function uxe(n,e=!1){const t=Math.floor(n),r=Math.floor(t/3600),s=Math.floor(t%3600/60),i=t%60,a=[],o="h",l="m",c="s";return r>0&&a.push(d.jsxs(ve.Fragment,{children:[r,d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:o})]},"h")),(s>0||r>0)&&(a.length>0&&a.push(d.jsx(ve.Fragment,{children:":"},"h-sep")),a.push(d.jsxs(ve.Fragment,{children:[s.toString().padStart(2,"0"),d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:l})]},"m"))),(r===0&&s===0||i>0)&&(a.length>0&&a.push(d.jsx(ve.Fragment,{children:":"},"m-sep")),a.push(d.jsxs(ve.Fragment,{children:[i.toString().padStart(2,"0"),d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:c})]},"s"))),d.jsx(d.Fragment,{children:a})}function dxe(n,e,t,r,s){let i;switch(t){case"second":i=r;break;case"minute":i=r*60;break;case"hour":i=r*3600;break;case"day":i=r*86400;break;default:i=1}const a=Math.ceil(n/i)*i;for(let o=a;(o<e||Math.abs(o-e)<.001)&&!(o>e+.001);o+=i)s(o)}const hxe=({duration:n,playbarWidth:e,isFullscreen:t=!1})=>{const r=yt(m=>m.visibleDuration),s=yt(m=>m.visibleTimeStart),i=yt(m=>m.visibleTimeEnd),a=yt(m=>m.timelineScale),o=t?1:a,l=r>0?r:n,{majorTicks:c,minorTicks:u,useVerboseLabels:f}=E.useMemo(()=>{const m=typeof window<"u"?window.innerWidth-80:1840,g=n/o,{unit:y,step:b}=cxe(g,m),x=[],S=500;dxe(0,n,y,b,k=>{k>0&&k<n+.001&&x.length<S&&x.push(k)});const T=[];let _=b;y==="minute"?_*=60:y==="hour"?_*=3600:y==="day"&&(_*=86400);let R=0;_>=10||_>=5?R=_/5:_>=2?R=_/2:_>=.9&&_<=1.1&&(R=.2);const I=m/g,C=R*I;if(R>0&&C>2)for(let k=R;k<n;k+=R){const M=_*.2;!x.some(U=>Math.abs(U-k)<M)&&T.length<S&&T.push(k)}let L=!1;if(x.length>0){const k=x.some(U=>Math.floor(U/3600)>0),M=x.some(U=>Math.floor(U%3600/60)>0),D=x.some(U=>U%60>0);(M&&!D&&!k||D&&!M&&!k||k&&x.every(U=>U%3600===0))&&(L=!0)}return{majorTicks:x,minorTicks:T,unit:y,step:b,useVerboseLabels:L}},[n,e,l,s,i,o]);return!n||n<=0||e<=0?null:d.jsxs("div",{style:{position:"absolute",left:0,width:`${e}px`,top:0,height:"100%",opacity:1,zIndex:5,pointerEvents:"none"},children:[c.map(m=>{const g=m/n*100;return d.jsx(ve.Fragment,{children:d.jsx("div",{className:"text-text-secondary/70",style:{position:"absolute",left:`${g}%`,top:"-18px",transform:"translateX(-50%)",fontSize:12,fontFamily:"monospace, sans-serif",fontWeight:500,lineHeight:1,textAlign:"center",pointerEvents:"none",userSelect:"none",whiteSpace:"nowrap"},children:uxe(m,f)})},`major-${m}`)}),u.map(m=>{const g=m/n*100;return d.jsx(ve.Fragment,{children:d.jsx("div",{className:"bg-text-primary/30",style:{position:"absolute",left:`${g}%`,top:"-14px",width:"4px",height:"4px",borderRadius:"50%",transform:"translateX(-50%)",pointerEvents:"none"}})},`minor-${m}`)})]})};function fxe(n,e,t){return Math.max(e,Math.min(n,t))}const Ls={toVector(n,e){return n===void 0&&(n=e),Array.isArray(n)?n:[n,n]},add(n,e){return[n[0]+e[0],n[1]+e[1]]},sub(n,e){return[n[0]-e[0],n[1]-e[1]]},addTo(n,e){n[0]+=e[0],n[1]+=e[1]},subTo(n,e){n[0]-=e[0],n[1]-=e[1]}};function g4(n,e,t){return e===0||Math.abs(e)===1/0?Math.pow(n,t*5):n*e*t/(e+t*n)}function v4(n,e,t,r=.15){return r===0?fxe(n,e,t):n<e?-g4(e-n,t-e,r)+e:n>t?+g4(n-t,t-e,r)+t:n}function mxe(n,[e,t],[r,s]){const[[i,a],[o,l]]=n;return[v4(e,i,a,r),v4(t,o,l,s)]}function pxe(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gxe(n){var e=pxe(n,"string");return typeof e=="symbol"?e:String(e)}function ii(n,e,t){return e=gxe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function y4(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ir(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?y4(Object(t),!0).forEach(function(r){ii(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):y4(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const nq={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function b4(n){return n?n[0].toUpperCase()+n.slice(1):""}const vxe=["enter","leave"];function yxe(n=!1,e){return n&&!vxe.includes(e)}function bxe(n,e="",t=!1){const r=nq[n],s=r&&r[e]||e;return"on"+b4(n)+b4(s)+(yxe(t,s)?"Capture":"")}const xxe=["gotpointercapture","lostpointercapture"];function wxe(n){let e=n.substring(2).toLowerCase();const t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));const r=xxe.includes(e)?"capturecapture":"capture",s=!!~e.indexOf(r);return s&&(e=e.replace("capture","")),{device:e,capture:s,passive:t}}function Exe(n,e=""){const t=nq[n],r=t&&t[e]||e;return n+r}function IS(n){return"touches"in n}function rq(n){return IS(n)?"touch":"pointerType"in n?n.pointerType:"mouse"}function Sxe(n){return Array.from(n.touches).filter(e=>{var t,r;return e.target===n.currentTarget||((t=n.currentTarget)===null||t===void 0||(r=t.contains)===null||r===void 0?void 0:r.call(t,e.target))})}function Txe(n){return n.type==="touchend"||n.type==="touchcancel"?n.changedTouches:n.targetTouches}function sq(n){return IS(n)?Txe(n)[0]:n}function _xe(n){return Sxe(n).map(e=>e.identifier)}function TA(n){const e=sq(n);return IS(n)?e.identifier:e.pointerId}function x4(n){const e=sq(n);return[e.clientX,e.clientY]}function Axe(n){const e={};if("buttons"in n&&(e.buttons=n.buttons),"shiftKey"in n){const{shiftKey:t,altKey:r,metaKey:s,ctrlKey:i}=n;Object.assign(e,{shiftKey:t,altKey:r,metaKey:s,ctrlKey:i})}return e}function Lw(n,...e){return typeof n=="function"?n(...e):n}function Rxe(){}function Cxe(...n){return n.length===0?Rxe:n.length===1?n[0]:function(){let e;for(const t of n)e=t.apply(this,arguments)||e;return e}}function w4(n,e){return Object.assign({},e,n||{})}const kxe=32;class Ixe{constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:r,args:s}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=s,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?Lw(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:r,shared:s}=this;t.args=this.args;let i=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,Axe(e)),s.down=s.pressed=s.buttons%2===1||s.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const C=t._delta.map(Math.abs);Ls.addTo(t._distance,C)}this.axisIntent&&this.axisIntent(e);const[a,o]=t._movement,[l,c]=r.threshold,{_step:u,values:f}=t;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(a)>=l&&f[0]),u[1]===!1&&(u[1]=Math.abs(o)>=c&&f[1])):(u[0]===!1&&(u[0]=Math.abs(a)>=l&&Math.sign(a)*l),u[1]===!1&&(u[1]=Math.abs(o)>=c&&Math.sign(o)*c)),t.intentional=u[0]!==!1||u[1]!==!1,!t.intentional)return;const m=[0,0];if(r.hasCustomTransform){const[C,L]=f;m[0]=u[0]!==!1?C-u[0]:0,m[1]=u[1]!==!1?L-u[1]:0}else m[0]=u[0]!==!1?a-u[0]:0,m[1]=u[1]!==!1?o-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(m);const g=t.offset,y=t._active&&!t._blocked||t.active;y&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=s[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=Lw(r.bounds,t)),this.setup&&this.setup()),t.movement=m,this.computeOffset()));const[b,x]=t.offset,[[S,T],[_,R]]=t._bounds;t.overflow=[b<S?-1:b>T?1:0,x<_?-1:x>R?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const I=t._active?r.rubberband||[0,0]:[0,0];if(t.offset=mxe(t._bounds,t.offset,I),t.delta=Ls.sub(t.offset,g),this.computeMovement(),y&&(!t.last||i>kxe)){t.delta=Ls.sub(t.offset,g);const C=t.delta.map(Math.abs);Ls.addTo(t.distance,C),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[C[0]/i,C[1]/i],t.timeDelta=i)}}emit(){const e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const s=this.handler(ir(ir(ir({},t),e),{},{[this.aliasKey]:e.values}));s!==void 0&&(e.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Lxe([n,e],t){const r=Math.abs(n),s=Math.abs(e);if(r>s&&r>t)return"x";if(s>r&&s>t)return"y"}class Dxe extends Ixe{constructor(...e){super(...e),ii(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Ls.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Ls.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,r=this.config;if(!t.axis&&e){const s=typeof r.axisThreshold=="object"?r.axisThreshold[rq(e)]:r.axisThreshold;t.axis=Lxe(t._movement,s)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Pxe=n=>n,E4=.15,iq={enabled(n=!0){return n},eventOptions(n,e,t){return ir(ir({},t.shared.eventOptions),n)},preventDefault(n=!1){return n},triggerAllEvents(n=!1){return n},rubberband(n=0){switch(n){case!0:return[E4,E4];case!1:return[0,0];default:return Ls.toVector(n)}},from(n){if(typeof n=="function")return n;if(n!=null)return Ls.toVector(n)},transform(n,e,t){const r=n||t.shared.transform;return this.hasCustomTransform=!!r,r||Pxe},threshold(n){return Ls.toVector(n,0)}},Mxe=0,l0=ir(ir({},iq),{},{axis(n,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(n=Mxe){return n},bounds(n={}){if(typeof n=="function")return i=>l0.bounds(n(i));if("current"in n)return()=>n.current;if(typeof HTMLElement=="function"&&n instanceof HTMLElement)return n;const{left:e=-1/0,right:t=1/0,top:r=-1/0,bottom:s=1/0}=n;return[[e,t],[r,s]]}}),S4={ArrowRight:(n,e=1)=>[n*e,0],ArrowLeft:(n,e=1)=>[-1*n*e,0],ArrowUp:(n,e=1)=>[0,-1*n*e],ArrowDown:(n,e=1)=>[0,n*e]};class Oxe extends Dxe{constructor(...e){super(...e),ii(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const t=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),s={left:t.left-r.left+e.offset[0],right:t.right-r.right+e.offset[0],top:t.top-r.top+e.offset[1],bottom:t.bottom-r.bottom+e.offset[1]};e._bounds=l0.bounds(s)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const t=this.config,r=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;const s=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(s&&s.size>1&&r._pointerActive)&&(this.start(e),this.setupPointer(e),r._pointerId=TA(e),r._pointerActive=!0,this.computeValues(x4(e)),this.computeInitial(),t.preventScrollAxis&&rq(e)!=="mouse"?(r._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const t=this.state,r=this.config;if(!t._pointerActive)return;const s=TA(e);if(t._pointerId!==void 0&&s!==t._pointerId)return;const i=x4(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=Ls.sub(i,t._values),this.computeValues(i)),Ls.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===r.preventScrollAxis||r.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const t=this.state,r=this.config;if(!t._active||!t._pointerActive)return;const s=TA(e);if(t._pointerId!==void 0&&s!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[i,a]=t._distance;if(t.tap=i<=r.tapsThreshold&&a<=r.tapsThreshold,t.tap&&r.filterTaps)t._force=!0;else{const[o,l]=t._delta,[c,u]=t._movement,[f,m]=r.swipe.velocity,[g,y]=r.swipe.distance,b=r.swipe.duration;if(t.elapsedTime<b){const x=Math.abs(o/t.timeDelta),S=Math.abs(l/t.timeDelta);x>f&&Math.abs(c)>g&&(t.swipe[0]=Math.sign(o)),S>m&&Math.abs(u)>y&&(t.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const t=this.config,r=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Nxe(e);const t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const t=S4[e.key];if(t){const r=this.state,s=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=t(this.config.keyboardDisplacement,s),r._keyboardActive=!0,Ls.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in S4&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Nxe(n){"persist"in n&&typeof n.persist=="function"&&n.persist()}const c0=typeof window<"u"&&window.document&&window.document.createElement;function aq(){return c0&&"ontouchstart"in window}function jxe(){return aq()||c0&&window.navigator.maxTouchPoints>1}function Fxe(){return c0&&"onpointerdown"in window}function Uxe(){return c0&&"exitPointerLock"in window.document}function $xe(){try{return"constructor"in GestureEvent}catch{return!1}}const la={isBrowser:c0,gesture:$xe(),touch:aq(),touchscreen:jxe(),pointer:Fxe(),pointerLock:Uxe()},Bxe=250,Hxe=180,Vxe=.5,zxe=50,Gxe=250,qxe=10,T4={mouse:0,touch:0,pen:8},Wxe=ir(ir({},l0),{},{device(n,e,{pointer:{touch:t=!1,lock:r=!1,mouse:s=!1}={}}){return this.pointerLock=r&&la.pointerLock,la.touch&&t?"touch":this.pointerLock?"mouse":la.pointer&&!s?"pointer":la.touch?"touch":"mouse"},preventScrollAxis(n,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&n?Bxe:void 0,!(!la.touchscreen||t===!1))return n||(t!==void 0?"y":void 0)},pointerCapture(n,e,{pointer:{capture:t=!0,buttons:r=1,keys:s=!0}={}}){return this.pointerButtons=r,this.keys=s,!this.pointerLock&&this.device==="pointer"&&t},threshold(n,e,{filterTaps:t=!1,tapsThreshold:r=3,axis:s=void 0}){const i=Ls.toVector(n,t?r:s?1:0);return this.filterTaps=t,this.tapsThreshold=r,i},swipe({velocity:n=Vxe,distance:e=zxe,duration:t=Gxe}={}){return{velocity:this.transform(Ls.toVector(n)),distance:this.transform(Ls.toVector(e)),duration:t}},delay(n=0){switch(n){case!0:return Hxe;case!1:return 0;default:return n}},axisThreshold(n){return n?ir(ir({},T4),n):T4},keyboardDisplacement(n=qxe){return n}});ir(ir({},iq),{},{device(n,e,{shared:t,pointer:{touch:r=!1}={}}){if(t.target&&!la.touch&&la.gesture)return"gesture";if(la.touch&&r)return"touch";if(la.touchscreen){if(la.pointer)return"pointer";if(la.touch)return"touch"}},bounds(n,e,{scaleBounds:t={},angleBounds:r={}}){const s=a=>{const o=w4(Lw(t,a),{min:-1/0,max:1/0});return[o.min,o.max]},i=a=>{const o=w4(Lw(r,a),{min:-1/0,max:1/0});return[o.min,o.max]};return typeof t!="function"&&typeof r!="function"?[s(),i()]:a=>[s(a),i(a)]},threshold(n,e,t){return this.lockDirection=t.axis==="lock",Ls.toVector(n,this.lockDirection?[.1,3]:0)},modifierKey(n){return n===void 0?"ctrlKey":n},pinchOnWheel(n=!0){return n}});ir(ir({},l0),{},{mouseOnly:(n=!0)=>n});ir(ir({},l0),{},{mouseOnly:(n=!0)=>n});const oq=new Map,Tk=new Map;function Kxe(n){oq.set(n.key,n.engine),Tk.set(n.key,n.resolver)}const Yxe={key:"drag",engine:Oxe,resolver:Wxe};function Xxe(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Qxe(n,e){if(n==null)return{};var t=Xxe(n,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}const Zxe={target(n){if(n)return()=>"current"in n?n.current:n},enabled(n=!0){return n},window(n=la.isBrowser?window:void 0){return n},eventOptions({passive:n=!0,capture:e=!1}={}){return{passive:n,capture:e}},transform(n){return n}},Jxe=["target","eventOptions","window","enabled","transform"];function nx(n={},e){const t={};for(const[r,s]of Object.entries(e))switch(typeof s){case"function":t[r]=s.call(t,n[r],r,n);break;case"object":t[r]=nx(n[r],s);break;case"boolean":s&&(t[r]=n[r]);break}return t}function ewe(n,e,t={}){const r=n,{target:s,eventOptions:i,window:a,enabled:o,transform:l}=r,c=Qxe(r,Jxe);if(t.shared=nx({target:s,eventOptions:i,window:a,enabled:o,transform:l},Zxe),e){const u=Tk.get(e);t[e]=nx(ir({shared:t.shared},c),u)}else for(const u in c){const f=Tk.get(u);f&&(t[u]=nx(ir({shared:t.shared},c[u]),f))}return t}class lq{constructor(e,t){ii(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,r,s,i){const a=this._listeners,o=Exe(t,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=ir(ir({},l),i);e.addEventListener(o,s,c);const u=()=>{e.removeEventListener(o,s,c),a.delete(u)};return a.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class twe{constructor(){ii(this,"_timeouts",new Map)}add(e,t,r=140,...s){this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...s))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class nwe{constructor(e){ii(this,"gestures",new Set),ii(this,"_targetEventStore",new lq(this)),ii(this,"gestureEventStores",{}),ii(this,"gestureTimeoutStores",{}),ii(this,"handlers",{}),ii(this,"config",{}),ii(this,"pointerIds",new Set),ii(this,"touchIds",new Set),ii(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),rwe(this,e)}setEventIds(e){if(IS(e))return this.touchIds=new Set(_xe(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=ewe(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,r={};let s;if(!(t.target&&(s=t.target(),!s))){if(t.enabled){for(const a of this.gestures){const o=this.config[a],l=_4(r,o.eventOptions,!!s);if(o.enabled){const c=oq.get(a);new c(this,e,a).bind(l)}}const i=_4(r,t.eventOptions,!!s);for(const a in this.nativeHandlers)i(a,"",o=>this.nativeHandlers[a](ir(ir({},this.state.shared),{},{event:o,args:e})),void 0,!0)}for(const i in r)r[i]=Cxe(...r[i]);if(!s)return r;for(const i in r){const{device:a,capture:o,passive:l}=wxe(i);this._targetEventStore.add(s,a,"",r[i],{capture:o,passive:l})}}}}function Dh(n,e){n.gestures.add(e),n.gestureEventStores[e]=new lq(n,e),n.gestureTimeoutStores[e]=new twe}function rwe(n,e){e.drag&&Dh(n,"drag"),e.wheel&&Dh(n,"wheel"),e.scroll&&Dh(n,"scroll"),e.move&&Dh(n,"move"),e.pinch&&Dh(n,"pinch"),e.hover&&Dh(n,"hover")}const _4=(n,e,t)=>(r,s,i,a={},o=!1)=>{var l,c;const u=(l=a.capture)!==null&&l!==void 0?l:e.capture,f=(c=a.passive)!==null&&c!==void 0?c:e.passive;let m=o?r:bxe(r,s,u);t&&f&&(m+="Passive"),n[m]=n[m]||[],n[m].push(i)};function swe(n,e={},t,r){const s=ve.useMemo(()=>new nwe(n),[]);if(s.applyHandlers(n,r),s.applyConfig(e,t),ve.useEffect(s.effect.bind(s)),ve.useEffect(()=>s.clean.bind(s),[]),e.target===void 0)return s.bind.bind(s)}function iwe(n,e){return Kxe(Yxe),swe({drag:n},e||{},"drag")}const cq=(n={})=>{const{enabled:e=!0,onZoom:t,onPan:r,method:s="event-delegation",transformWrapperRef:i=null}=n,a=E.useRef(null),o=E.useCallback(l=>{const c=l.ctrlKey||l.metaKey,u=!l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey;if(c||u){l.preventDefault(),l.stopPropagation();const f={x:l.clientX,y:l.clientY};if(c){const m=l.deltaY>0?1:-1;if(t)t(m,f);else if(i?.current){const y=i.current.instance.wrapperComponent;if(y){const b=new WheelEvent("wheel",{clientX:l.clientX,clientY:l.clientY,deltaY:l.deltaY,deltaX:l.deltaX,deltaZ:l.deltaZ,ctrlKey:l.ctrlKey,metaKey:l.metaKey,altKey:l.altKey,shiftKey:l.shiftKey,bubbles:!0,cancelable:!0});y.dispatchEvent(b)}}}else if(u){const m=l.deltaX,g=l.deltaY;if(r)r(m,g,f);else if(i?.current){const b=i.current.instance.wrapperComponent;if(b){const x=new WheelEvent("wheel",{clientX:l.clientX,clientY:l.clientY,deltaY:l.deltaY,deltaX:l.deltaX,deltaZ:l.deltaZ,ctrlKey:l.ctrlKey,metaKey:l.metaKey,altKey:l.altKey,shiftKey:l.shiftKey,bubbles:!0,cancelable:!0});b.dispatchEvent(x)}}}}},[t,r,i]);return E.useEffect(()=>{const l=a.current;if(!(!e||!l)){if(s==="event-delegation")return l.addEventListener("wheel",o,{passive:!1}),()=>{l.removeEventListener("wheel",o)};if(s==="css-override"){const c={touchAction:l.style.touchAction,userSelect:l.style.userSelect};l.style.touchAction="none",l.style.userSelect="none";const u=f=>{if(l.contains(f.target)){const m=f.ctrlKey||f.metaKey,g=!f.ctrlKey&&!f.metaKey&&!f.shiftKey&&!f.altKey;(m||g)&&o(f)}};return document.addEventListener("wheel",u,{passive:!1}),()=>{l.style.touchAction=c.touchAction,l.style.userSelect=c.userSelect,document.removeEventListener("wheel",u)}}}},[e,o,s]),a},r2=cq,uq=E.createContext(void 0),awe=({children:n,flask:e,flaskId:t,hasEditingPermissions:r,isCreator:s,accessLevel:i=null,currentAssetIndex:a=0,onUpdateFlaskName:o,onUpdateFlaskAccessLevel:l,onUpdateFlaskThumbnail:c,onAssetChange:u})=>{const f={flask:e,flaskId:t,hasEditingPermissions:r,isCreator:s,accessLevel:i,currentAssetIndex:a,onUpdateFlaskName:o,onUpdateFlaskAccessLevel:l,onUpdateFlaskThumbnail:c,onAssetChange:u};return d.jsx(uq.Provider,{value:f,children:n})},Dd=()=>{const n=E.useContext(uq);if(n===void 0)throw new Error("useFlaskContext must be used within a FlaskProvider");return n},owe=({isOpen:n,onClose:e})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{children:[d.jsxs(ar,{children:[d.jsx(or,{children:"Active Recording Detected"}),d.jsx(zl,{children:"You are currently recording. End the active recording before starting another one."})]}),d.jsx(ys,{children:d.jsx(dt,{onClick:e,autoFocus:!0,children:"OK"})})]})}),lwe=({isDragging:n=!1,toolbarProps:e,isFullscreen:t=!1,onDraggingChange:r})=>{const s=E.useRef(null),[i,a]=E.useState(!1),[o,l]=E.useState(!1),{accessLevel:c,isCreator:u}=Dd(),f=c==="viewonly"&&!u;KV(),De(C=>C.boardState),De(C=>C.createElement),De(C=>C.setSelectedFrames);const m=He(C=>C.duration),g=He(C=>C.currentTime),y=m>0?g/m*100:0,b=Mt(C=>C.setPlayheadHovered),x=n||o,S=He(C=>C.requestPreview),T=He(C=>C.exitPreview);E.useEffect(()=>{const C=s.current;if(!C||m===0)return;let L=null,k=He.getState().currentTime,M=performance.now(),D=He.getState().isPlaying;const U=()=>{const $=He.getState(),V=performance.now();if($.isPlaying!==D&&(D=$.isPlaying,k=$.currentTime,M=V,!$.isPlaying)){const W=$.currentTime/$.duration*100;C.style.left=`${W}%`}Math.abs($.currentTime-k)>.01&&(k=$.currentTime,M=V);let B=k;if($.isPlaying&&!$.isBuffering){const W=(V-M)/1e3;B=k+W*$.playbackRate,B=Math.min(B,$.duration)}if($.duration>0){const W=B/$.duration*100;C.style.left=`${W}%`}L=requestAnimationFrame(U)};return L=requestAnimationFrame(U),()=>{L!==null&&cancelAnimationFrame(L)}},[m]);const R=r2({transformWrapperRef:null});E.useEffect(()=>{const C=s.current;if(!C)return;const L=k=>{let M=C.parentElement;for(;M;){if(M.classList.contains("overflow-hidden")){const D=new WheelEvent("wheel",{deltaX:k.deltaX,deltaY:k.deltaY,deltaZ:k.deltaZ,deltaMode:k.deltaMode,clientX:k.clientX,clientY:k.clientY,screenX:k.screenX,screenY:k.screenY,ctrlKey:k.ctrlKey,shiftKey:k.shiftKey,altKey:k.altKey,metaKey:k.metaKey,button:k.button,buttons:k.buttons,relatedTarget:k.relatedTarget,view:k.view,bubbles:!0,cancelable:!0});M.dispatchEvent(D),k.preventDefault(),k.stopPropagation();break}M=M.parentElement}};return C.addEventListener("wheel",L,{passive:!1}),()=>{C.removeEventListener("wheel",L)}},[]);const I=iwe(({first:C,last:L,tap:k,event:M,active:D})=>{if(!(f||t)){if(M?.preventDefault(),M?.stopPropagation(),k){Ze(async()=>{const{useToolbarStore:U}=await Promise.resolve().then(()=>di);return{useToolbarStore:U}},void 0).then(({useToolbarStore:U})=>{U.getState().focusTextbox("timeline")});return}if(!C){if(L){document.body.style.cursor="",l(!1),r?.(!1);return}if(D){const U=He.getState().seek;o||(l(!0),r?.(!0),document.body.style.cursor="grabbing");const $=document.querySelector(".video-playbar");if(!$||m<=0)return;const V=$.getBoundingClientRect(),F=Math.max(0,Math.min(1,(M.clientX-V.left)/V.width))*m;U(F)}}}},{threshold:5,preventDefault:!0,filterTaps:!0});return d.jsxs(d.Fragment,{children:[d.jsx(owe,{isOpen:i,onClose:()=>a(!1)}),d.jsx("div",{ref:C=>{s.current=C,R.current=C},...I(),className:"absolute z-[25] handle-current flex items-center justify-center overflow-hidden backdrop-blur-sm drop-shadow-lg cursor-pointer touch-none",style:{left:`${y}%`,top:"8px",transform:"translate(-50%, -50%)",pointerEvents:"auto",width:"16px",height:"24px",borderRadius:"8px",backgroundColor:"rgba(226, 232, 240, 0.4)",borderTop:"1px solid #FAFAFA",boxShadow:"inset 0 0 10px rgba(255, 255, 255, 0.4), 0 0px 18px -1px rgba(0, 0, 0, 0.4)"},onMouseEnter:()=>{!x&&!f&&!t&&(b(!0),S(g,"linkdots"))},onMouseLeave:()=>{t||(b(!1),T())}})]})},dq=({currentTime:n,duration:e,isPlaying:t,playbarWidth:r,hasEditingPermissions:s,youtubeUrl:i,nativeAsset:a,onCreateLinkedFrame:o,onCreateElementInFrame:l,preventSeekOnLinkClick:c=!0,onPlayheadHoverChange:u,timelineScale:f=1,isFullscreen:m=!1})=>{const g=E.useRef(null),y=E.useRef(null),[b,x]=E.useState(!1),[S,T]=E.useState(!1),[_,R]=E.useState(null),[I,C]=E.useState(!1);E.useRef(null),De(te=>te.boardState),De(te=>te.selectedFrames),De(te=>te.setSelectedFrames);const L=yt(te=>te.recordPlayheadInteraction);He(te=>te.togglePlayPause);const k=He(te=>te.seek);He(te=>te.isCountingDown),He(te=>te.countdownProgress);const D=!!He(te=>te.muxPlaybackId),U=He(te=>te.setPlaybarHover);He(te=>te.requestPreview),He(te=>te.exitPreview);const $=He(te=>te.exitPreviewWithoutRestoration),V=He(te=>te.setupDefensiveCleanup),B=n,W=!!(i||a?.hls_url);E.useEffect(()=>{const te=y.current;if(!te||e===0||!W)return;let se=null,he=He.getState().currentTime,Z=performance.now(),pe=He.getState().isPlaying;const ye=()=>{const ae=He.getState(),le=performance.now();if(ae.isPlaying!==pe&&(pe=ae.isPlaying,he=ae.currentTime,Z=le,!ae.isPlaying)){const fe=ae.currentTime/ae.duration*100;te.style.width=`${fe}%`}Math.abs(ae.currentTime-he)>.01&&(he=ae.currentTime,Z=le);let ie=he;if(ae.isPlaying&&!ae.isBuffering){const fe=(le-Z)/1e3;ie=he+fe*ae.playbackRate,ie=Math.min(ie,ae.duration)}if(ae.duration>0){const fe=ie/ae.duration*100;te.style.width=`${fe}%`}se=requestAnimationFrame(ye)};return se=requestAnimationFrame(ye),()=>{se!==null&&cancelAnimationFrame(se)}},[e,W]),E.useMemo(()=>i?Vf(i):null,[i]);const F=E.useCallback(te=>{if(!g.current||e<=0)return 0;const se=g.current.getBoundingClientRect();return se.width===0?0:Math.max(0,Math.min(1,(te-se.left)/se.width))*e},[e]),j=E.useCallback(te=>{if(!b&&g.current){const se=g.current.getBoundingClientRect();if(te.clientY>=se.top&&te.clientY<=se.bottom&&te.clientX>=se.left&&te.clientX<=se.right){const Z=F(te.clientX);R(Z),D||U(!0,Z)}else R(null),D||U(!1)}},[F,U,b,D]),q=E.useCallback(()=>{b||(R(null),D||U(!1),C(!1))},[b,U,D]),H=He(te=>te.previewTimestamp),N=He(te=>te.previewSource),O=He(te=>te.setPreviewMode),z=He(te=>te.isPreviewMode),G=He(te=>te.seekPreviewOnly),Y=He(te=>te.pauseForPreview),Q=He(te=>te.exitPreviewWithRestoration);E.useEffect(()=>{if(N==="linkdots"&&H!==null)R(H);else if(N===null&&H===null&&g.current){const te=g.current.getBoundingClientRect(),se=window.lastMouseEvent;se&&(se.clientY>=te.top&&se.clientY<=te.bottom&&se.clientX>=te.left&&se.clientX<=te.right||R(null))}},[N,H]),E.useEffect(()=>{const te=se=>{window.lastMouseEvent=se};return window.addEventListener("mousemove",te),()=>window.removeEventListener("mousemove",te)},[]);const J=N==="linkdots"?H:_;E.useEffect(()=>{H!==null&&N?!(D&&N==="linkdots")&&(z?G(H):(O(!0,H),Y(),setTimeout(()=>{G(H)},50))):H===null&&z&&N===null&&Q()},[H,N,z,O,G,Y,Q,D]),E.useEffect(()=>V(),[V]),E.useEffect(()=>{b&&z&&N!=="linkdots"&&$()},[b,z,N,$]);const ee=E.useCallback(te=>{if(!g.current||e<=0)return;te.preventDefault();const se=He.getState().wasPlayingBeforePreview;$(),R(null);const he=F(te.clientX);x(!0),k(he);let Z=null;const pe=ae=>{ae.preventDefault(),Z&&cancelAnimationFrame(Z),Z=requestAnimationFrame(()=>{const le=F(ae.clientX);k(le)})},ye=ae=>{Z&&(cancelAnimationFrame(Z),Z=null),document.removeEventListener("mousemove",pe),document.removeEventListener("mouseup",ye);const le=F(ae.clientX);L(le),x(!1),R(null),se&&setTimeout(()=>{const{play:ie}=He.getState();ie()},50)};document.addEventListener("mousemove",pe),document.addEventListener("mouseup",ye)},[e,F,k,$,U]);E.useCallback(te=>{C(te)},[]);const oe=je("video-playbar relative flex h-full items-center justify-center  rounded-full text-white",{"select-none":b});return d.jsxs("div",{className:oe,style:{position:"relative",zIndex:10},children:[!m&&d.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 pointer-events-none w-[1000000px] -z-[2] bg-card-background",style:{top:"-100px",height:"134px"}}),d.jsxs("div",{className:"relative rounded-sm flex-grow bg-transparent overflow-visible",children:[d.jsxs("div",{ref:g,className:je("h-4 rounded-full relative element-border overflow-visible   bg-gradient-to-b from-grey-400 to-slate-400/20 bg-text-secondary/20",W?b?"cursor-grabbing":"cursor-pointer":"cursor-not-allowed"),style:{width:`${r}px`},onMouseMove:!W||b?void 0:te=>{te.stopPropagation(),j(te)},onMouseDown:W?te=>{te.stopPropagation(),ee(te)}:void 0,onMouseLeave:q,children:[d.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-sm pointer-events-none",children:d.jsxs("div",{ref:y,className:"absolute top-0 left-0 h-4 rounded-l-full rounded-r-2xl pointer-events-none overflow-hidden transition-none border-0",style:{width:`${!W||e<=0?0:B/e*100}%`,backgroundColor:"#CFDFF6"},children:[d.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"url('/svgs/playbargradient.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"right center",backgroundSize:"auto 100%"}}),d.jsx("div",{className:"absolute inset-0 shadow-inner shadow-cyan-100/70"})]})}),_!==null&&!b&&d.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 pointer-events-none bg-white",style:{left:`${e>0?_/e*100:0}%`,transform:"translateX(0)"}}),d.jsx(hxe,{duration:e,playbarWidth:r,timelineScale:f,isFullscreen:m})]}),W&&e>1&&!m&&d.jsx("div",{style:{position:"absolute",left:0,width:"100%",top:"100%",zIndex:5},children:d.jsx($be,{duration:e,getTimeFromPosition:F,hasEditingPermissions:s})}),W&&e>0&&!b&&!S&&d.jsx(axe,{playbarWidth:r,hoverTime:J})]}),d.jsx(lwe,{isDragging:b,isFullscreen:m,onDraggingChange:T,toolbarProps:{flaskId:void 0,hasEditingPermissions:s,currentTime:n,duration:e,flask:void 0,isCreator:!1,onAccessLevelChange:void 0}})]})},pv=E.createContext({});function s2(n){const e=E.useRef(null);return e.current===null&&(e.current=n()),e.current}const i2=typeof window<"u",a2=i2?E.useLayoutEffect:E.useEffect,LS=E.createContext(null);function o2(n,e){n.indexOf(e)===-1&&n.push(e)}function l2(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Hl=(n,e,t)=>t>e?e:t<n?n:t;let c2=()=>{};const Vl={},hq=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function fq(n){return typeof n=="object"&&n!==null}const mq=n=>/^0[^.\s]+$/u.test(n);function u2(n){let e;return()=>(e===void 0&&(e=n()),e)}const ya=n=>n,cwe=(n,e)=>t=>e(n(t)),u0=(...n)=>n.reduce(cwe),gv=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class d2{constructor(){this.subscriptions=[]}add(e){return o2(this.subscriptions,e),()=>l2(this.subscriptions,e)}notify(e,t,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ho=n=>n*1e3,Vo=n=>n/1e3;function pq(n,e){return e?n*(1e3/e):0}const gq=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,uwe=1e-7,dwe=12;function hwe(n,e,t,r,s){let i,a,o=0;do a=e+(t-e)/2,i=gq(a,r,s)-n,i>0?t=a:e=a;while(Math.abs(i)>uwe&&++o<dwe);return a}function d0(n,e,t,r){if(n===e&&t===r)return ya;const s=i=>hwe(i,0,1,n,t);return i=>i===0||i===1?i:gq(s(i),e,r)}const vq=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,yq=n=>e=>1-n(1-e),bq=d0(.33,1.53,.69,.99),h2=yq(bq),xq=vq(h2),wq=n=>(n*=2)<1?.5*h2(n):.5*(2-Math.pow(2,-10*(n-1))),f2=n=>1-Math.sin(Math.acos(n)),Eq=yq(f2),Sq=vq(f2),fwe=d0(.42,0,1,1),mwe=d0(0,0,.58,1),Tq=d0(.42,0,.58,1),pwe=n=>Array.isArray(n)&&typeof n[0]!="number",_q=n=>Array.isArray(n)&&typeof n[0]=="number",gwe={linear:ya,easeIn:fwe,easeInOut:Tq,easeOut:mwe,circIn:f2,circInOut:Sq,circOut:Eq,backIn:h2,backInOut:xq,backOut:bq,anticipate:wq},vwe=n=>typeof n=="string",A4=n=>{if(_q(n)){c2(n.length===4);const[e,t,r,s]=n;return d0(e,t,r,s)}else if(vwe(n))return gwe[n];return n},ob=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function ywe(n,e){let t=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(u){a.has(u)&&(c.schedule(u),n()),u(o)}const c={schedule:(u,f=!1,m=!1)=>{const y=m&&s?t:r;return f&&a.add(u),y.has(u)||y.add(u),u},cancel:u=>{r.delete(u),a.delete(u)},process:u=>{if(o=u,s){i=!0;return}s=!0,[t,r]=[r,t],t.forEach(l),t.clear(),s=!1,i&&(i=!1,c.process(u))}};return c}const bwe=40;function Aq(n,e){let t=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>t=!0,a=ob.reduce((_,R)=>(_[R]=ywe(i),_),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:f,preRender:m,render:g,postRender:y}=a,b=()=>{const _=Vl.useManualTiming?s.timestamp:performance.now();t=!1,Vl.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(_-s.timestamp,bwe),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),f.process(s),m.process(s),g.process(s),y.process(s),s.isProcessing=!1,t&&e&&(r=!1,n(b))},x=()=>{t=!0,r=!0,s.isProcessing||n(b)};return{schedule:ob.reduce((_,R)=>{const I=a[R];return _[R]=(C,L=!1,k=!1)=>(t||x(),I.schedule(C,L,k)),_},{}),cancel:_=>{for(let R=0;R<ob.length;R++)a[ob[R]].cancel(_)},state:s,steps:a}}const{schedule:qn,cancel:iu,state:fs,steps:_A}=Aq(typeof requestAnimationFrame<"u"?requestAnimationFrame:ya,!0);let rx;function xwe(){rx=void 0}const pi={now:()=>(rx===void 0&&pi.set(fs.isProcessing||Vl.useManualTiming?fs.timestamp:performance.now()),rx),set:n=>{rx=n,queueMicrotask(xwe)}},Rq=n=>e=>typeof e=="string"&&e.startsWith(n),m2=Rq("--"),wwe=Rq("var(--"),p2=n=>wwe(n)?Ewe.test(n.split("/*")[0].trim()):!1,Ewe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,fm={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},vv={...fm,transform:n=>Hl(0,1,n)},lb={...fm,default:1},wg=n=>Math.round(n*1e5)/1e5,g2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Swe(n){return n==null}const Twe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,v2=(n,e)=>t=>!!(typeof t=="string"&&Twe.test(t)&&t.startsWith(n)||e&&!Swe(t)&&Object.prototype.hasOwnProperty.call(t,e)),Cq=(n,e,t)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(g2);return{[n]:parseFloat(s),[e]:parseFloat(i),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},_we=n=>Hl(0,255,n),AA={...fm,transform:n=>Math.round(_we(n))},nd={test:v2("rgb","red"),parse:Cq("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+AA.transform(n)+", "+AA.transform(e)+", "+AA.transform(t)+", "+wg(vv.transform(r))+")"};function Awe(n){let e="",t="",r="",s="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),s=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),s=n.substring(4,5),e+=e,t+=t,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const _k={test:v2("#"),parse:Awe,transform:nd.transform},h0=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Ic=h0("deg"),zo=h0("%"),Ot=h0("px"),Rwe=h0("vh"),Cwe=h0("vw"),R4={...zo,parse:n=>zo.parse(n)/100,transform:n=>zo.transform(n*100)},df={test:v2("hsl","hue"),parse:Cq("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+zo.transform(wg(e))+", "+zo.transform(wg(t))+", "+wg(vv.transform(r))+")"},Dr={test:n=>nd.test(n)||_k.test(n)||df.test(n),parse:n=>nd.test(n)?nd.parse(n):df.test(n)?df.parse(n):_k.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?nd.transform(n):df.transform(n),getAnimatableNone:n=>{const e=Dr.parse(n);return e.alpha=0,Dr.transform(e)}},kwe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Iwe(n){return isNaN(n)&&typeof n=="string"&&(n.match(g2)?.length||0)+(n.match(kwe)?.length||0)>0}const kq="number",Iq="color",Lwe="var",Dwe="var(",C4="${}",Pwe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function yv(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=e.replace(Pwe,l=>(Dr.test(l)?(r.color.push(i),s.push(Iq),t.push(Dr.parse(l))):l.startsWith(Dwe)?(r.var.push(i),s.push(Lwe),t.push(l)):(r.number.push(i),s.push(kq),t.push(parseFloat(l))),++i,C4)).split(C4);return{values:t,split:o,indexes:r,types:s}}function Lq(n){return yv(n).values}function Dq(n){const{split:e,types:t}=yv(n),r=e.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=e[a],s[a]!==void 0){const o=t[a];o===kq?i+=wg(s[a]):o===Iq?i+=Dr.transform(s[a]):i+=s[a]}return i}}const Mwe=n=>typeof n=="number"?0:Dr.test(n)?Dr.getAnimatableNone(n):n;function Owe(n){const e=Lq(n);return Dq(n)(e.map(Mwe))}const au={test:Iwe,parse:Lq,createTransformer:Dq,getAnimatableNone:Owe};function RA(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Nwe({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let s=0,i=0,a=0;if(!e)s=i=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;s=RA(l,o,n+1/3),i=RA(l,o,n),a=RA(l,o,n-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function Dw(n,e){return t=>t>0?e:n}const sr=(n,e,t)=>n+(e-n)*t,CA=(n,e,t)=>{const r=n*n,s=t*(e*e-r)+r;return s<0?0:Math.sqrt(s)},jwe=[_k,nd,df],Fwe=n=>jwe.find(e=>e.test(n));function k4(n){const e=Fwe(n);if(!e)return!1;let t=e.parse(n);return e===df&&(t=Nwe(t)),t}const I4=(n,e)=>{const t=k4(n),r=k4(e);if(!t||!r)return Dw(n,e);const s={...t};return i=>(s.red=CA(t.red,r.red,i),s.green=CA(t.green,r.green,i),s.blue=CA(t.blue,r.blue,i),s.alpha=sr(t.alpha,r.alpha,i),nd.transform(s))},Ak=new Set(["none","hidden"]);function Uwe(n,e){return Ak.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function $we(n,e){return t=>sr(n,e,t)}function y2(n){return typeof n=="number"?$we:typeof n=="string"?p2(n)?Dw:Dr.test(n)?I4:Vwe:Array.isArray(n)?Pq:typeof n=="object"?Dr.test(n)?I4:Bwe:Dw}function Pq(n,e){const t=[...n],r=t.length,s=n.map((i,a)=>y2(i)(i,e[a]));return i=>{for(let a=0;a<r;a++)t[a]=s[a](i);return t}}function Bwe(n,e){const t={...n,...e},r={};for(const s in t)n[s]!==void 0&&e[s]!==void 0&&(r[s]=y2(n[s])(n[s],e[s]));return s=>{for(const i in r)t[i]=r[i](s);return t}}function Hwe(n,e){const t=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],a=n.indexes[i][r[i]],o=n.values[a]??0;t[s]=o,r[i]++}return t}const Vwe=(n,e)=>{const t=au.createTransformer(e),r=yv(n),s=yv(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Ak.has(n)&&!s.values.length||Ak.has(e)&&!r.values.length?Uwe(n,e):u0(Pq(Hwe(r,s),s.values),t):Dw(n,e)};function Mq(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?sr(n,e,t):y2(n)(n,e)}const zwe=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>qn.update(e,t),stop:()=>iu(e),now:()=>fs.isProcessing?fs.timestamp:pi.now()}},Oq=(n,e,t=10)=>{let r="";const s=Math.max(Math.round(e/t),2);for(let i=0;i<s;i++)r+=Math.round(n(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Pw=2e4;function b2(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<Pw;)e+=t,r=n.next(e);return e>=Pw?1/0:e}function Gwe(n,e=100,t){const r=t({...n,keyframes:[0,e]}),s=Math.min(b2(r),Pw);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Vo(s)}}const qwe=5;function Nq(n,e,t){const r=Math.max(e-qwe,0);return pq(t-n(r),e-r)}const dr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},kA=.001;function Wwe({duration:n=dr.duration,bounce:e=dr.bounce,velocity:t=dr.velocity,mass:r=dr.mass}){let s,i,a=1-e;a=Hl(dr.minDamping,dr.maxDamping,a),n=Hl(dr.minDuration,dr.maxDuration,Vo(n)),a<1?(s=c=>{const u=c*a,f=u*n,m=u-t,g=Rk(c,a),y=Math.exp(-f);return kA-m/g*y},i=c=>{const f=c*a*n,m=f*t+t,g=Math.pow(a,2)*Math.pow(c,2)*n,y=Math.exp(-f),b=Rk(Math.pow(c,2),a);return(-s(c)+kA>0?-1:1)*((m-g)*y)/b}):(s=c=>{const u=Math.exp(-c*n),f=(c-t)*n+1;return-kA+u*f},i=c=>{const u=Math.exp(-c*n),f=(t-c)*(n*n);return u*f});const o=5/n,l=Ywe(s,i,o);if(n=Ho(n),isNaN(l))return{stiffness:dr.stiffness,damping:dr.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const Kwe=12;function Ywe(n,e,t){let r=t;for(let s=1;s<Kwe;s++)r=r-n(r)/e(r);return r}function Rk(n,e){return n*Math.sqrt(1-e*e)}const Xwe=["duration","bounce"],Qwe=["stiffness","damping","mass"];function L4(n,e){return e.some(t=>n[t]!==void 0)}function Zwe(n){let e={velocity:dr.velocity,stiffness:dr.stiffness,damping:dr.damping,mass:dr.mass,isResolvedFromDuration:!1,...n};if(!L4(n,Qwe)&&L4(n,Xwe))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),s=r*r,i=2*Hl(.05,1,1-(n.bounce||0))*Math.sqrt(s);e={...e,mass:dr.mass,stiffness:s,damping:i}}else{const t=Wwe(n);e={...e,...t,mass:dr.mass},e.isResolvedFromDuration=!0}return e}function Mw(n=dr.visualDuration,e=dr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:s}=t;const i=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:f,velocity:m,isResolvedFromDuration:g}=Zwe({...t,velocity:-Vo(t.velocity||0)}),y=m||0,b=c/(2*Math.sqrt(l*u)),x=a-i,S=Vo(Math.sqrt(l/u)),T=Math.abs(x)<5;r||(r=T?dr.restSpeed.granular:dr.restSpeed.default),s||(s=T?dr.restDelta.granular:dr.restDelta.default);let _;if(b<1){const I=Rk(S,b);_=C=>{const L=Math.exp(-b*S*C);return a-L*((y+b*S*x)/I*Math.sin(I*C)+x*Math.cos(I*C))}}else if(b===1)_=I=>a-Math.exp(-S*I)*(x+(y+S*x)*I);else{const I=S*Math.sqrt(b*b-1);_=C=>{const L=Math.exp(-b*S*C),k=Math.min(I*C,300);return a-L*((y+b*S*x)*Math.sinh(k)+I*x*Math.cosh(k))/I}}const R={calculatedDuration:g&&f||null,next:I=>{const C=_(I);if(g)o.done=I>=f;else{let L=I===0?y:0;b<1&&(L=I===0?Ho(y):Nq(_,I,C));const k=Math.abs(L)<=r,M=Math.abs(a-C)<=s;o.done=k&&M}return o.value=o.done?a:C,o},toString:()=>{const I=Math.min(b2(R),Pw),C=Oq(L=>R.next(I*L).value,I,30);return I+"ms "+C},toTransition:()=>{}};return R}Mw.applyToOptions=n=>{const e=Gwe(n,100,Mw);return n.ease=e.ease,n.duration=Ho(e.duration),n.type="keyframes",n};function Ck({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const f=n[0],m={done:!1,value:f},g=k=>o!==void 0&&k<o||l!==void 0&&k>l,y=k=>o===void 0?l:l===void 0||Math.abs(o-k)<Math.abs(l-k)?o:l;let b=t*e;const x=f+b,S=a===void 0?x:a(x);S!==x&&(b=S-f);const T=k=>-b*Math.exp(-k/r),_=k=>S+T(k),R=k=>{const M=T(k),D=_(k);m.done=Math.abs(M)<=c,m.value=m.done?S:D};let I,C;const L=k=>{g(m.value)&&(I=k,C=Mw({keyframes:[m.value,y(m.value)],velocity:Nq(_,k,m.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return L(0),{calculatedDuration:null,next:k=>{let M=!1;return!C&&I===void 0&&(M=!0,R(k),L(k)),I!==void 0&&k>=I?C.next(k-I):(!M&&R(k),m)}}}function Jwe(n,e,t){const r=[],s=t||Vl.mix||Mq,i=n.length-1;for(let a=0;a<i;a++){let o=s(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||ya:e;o=u0(l,o)}r.push(o)}return r}function eEe(n,e,{clamp:t=!0,ease:r,mixer:s}={}){const i=n.length;if(c2(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[i-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Jwe(e,r,s),l=o.length,c=u=>{if(a&&u<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(u<n[f+1]);f++);const m=gv(n[f],n[f+1],u);return o[f](m)};return t?u=>c(Hl(n[0],n[i-1],u)):c}function tEe(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const s=gv(0,e,r);n.push(sr(t,1,s))}}function nEe(n){const e=[0];return tEe(e,n.length-1),e}function rEe(n,e){return n.map(t=>t*e)}function sEe(n,e){return n.map(()=>e||Tq).splice(0,n.length-1)}function Eg({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const s=pwe(r)?r.map(A4):A4(r),i={done:!1,value:e[0]},a=rEe(t&&t.length===e.length?t:nEe(e),n),o=eEe(a,e,{ease:Array.isArray(s)?s:sEe(e,s)});return{calculatedDuration:n,next:l=>(i.value=o(l),i.done=l>=n,i)}}const iEe=n=>n!==null;function x2(n,{repeat:e,repeatType:t="loop"},r,s=1){const i=n.filter(iEe),o=s<0||e&&t!=="loop"&&e%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const aEe={decay:Ck,inertia:Ck,tween:Eg,keyframes:Eg,spring:Mw};function jq(n){typeof n.type=="string"&&(n.type=aEe[n.type])}class w2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const oEe=n=>n/100;class E2 extends w2{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==pi.now()&&this.tick(pi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;jq(e);const{type:t=Eg,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=e;let{keyframes:o}=e;const l=t||Eg;l!==Eg&&typeof o[0]!="number"&&(this.mixKeyframes=u0(oEe,Mq(o[0],o[1])),o=[0,100]);const c=l({...e,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=b2(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:f,repeatType:m,repeatDelay:g,type:y,onUpdate:b,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const S=this.currentTime-c*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,R=r;if(f){const k=Math.min(this.currentTime,s)/o;let M=Math.floor(k),D=k%1;!D&&k>=1&&(D=1),D===1&&M--,M=Math.min(M,f+1),!!(M%2)&&(m==="reverse"?(D=1-D,g&&(D-=g/o)):m==="mirror"&&(R=a)),_=Hl(0,1,D)*o}const I=T?{done:!1,value:u[0]}:R.next(_);i&&(I.value=i(I.value));let{done:C}=I;!T&&l!==null&&(C=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return L&&y!==Ck&&(I.value=x2(u,this.options,x,this.speed)),b&&b(I.value),L&&this.finish(),I}then(e,t){return this.finished.then(e,t)}get duration(){return Vo(this.calculatedDuration)}get time(){return Vo(this.currentTime)}set time(e){e=Ho(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(pi.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Vo(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=zwe,startTime:t}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(pi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function lEe(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const rd=n=>n*180/Math.PI,kk=n=>{const e=rd(Math.atan2(n[1],n[0]));return Ik(e)},cEe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:kk,rotateZ:kk,skewX:n=>rd(Math.atan(n[1])),skewY:n=>rd(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},Ik=n=>(n=n%360,n<0&&(n+=360),n),D4=kk,P4=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),M4=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),uEe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:P4,scaleY:M4,scale:n=>(P4(n)+M4(n))/2,rotateX:n=>Ik(rd(Math.atan2(n[6],n[5]))),rotateY:n=>Ik(rd(Math.atan2(-n[2],n[0]))),rotateZ:D4,rotate:D4,skewX:n=>rd(Math.atan(n[4])),skewY:n=>rd(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function Lk(n){return n.includes("scale")?1:0}function Dk(n,e){if(!n||n==="none")return Lk(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(t)r=uEe,s=t;else{const o=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=cEe,s=o}if(!s)return Lk(e);const i=r[e],a=s[1].split(",").map(hEe);return typeof i=="function"?i(a):a[i]}const dEe=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return Dk(t,e)};function hEe(n){return parseFloat(n.trim())}const mm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],pm=new Set(mm),O4=n=>n===fm||n===Ot,fEe=new Set(["x","y","z"]),mEe=mm.filter(n=>!fEe.has(n));function pEe(n){const e=[];return mEe.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const cd={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>Dk(e,"x"),y:(n,{transform:e})=>Dk(e,"y")};cd.translateX=cd.x;cd.translateY=cd.y;const ud=new Set;let Pk=!1,Mk=!1,Ok=!1;function Fq(){if(Mk){const n=Array.from(ud).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const s=pEe(r);s.length&&(t.set(r,s),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=t.get(r);s&&s.forEach(([i,a])=>{r.getValue(i)?.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Mk=!1,Pk=!1,ud.forEach(n=>n.complete(Ok)),ud.clear()}function Uq(){ud.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Mk=!0)})}function gEe(){Ok=!0,Uq(),Fq(),Ok=!1}class S2{constructor(e,t,r,s,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(ud.add(this),Pk||(Pk=!0,qn.read(Uq),qn.resolveKeyframes(Fq))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:s}=this;if(e[0]===null){const i=s?.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&t){const o=r.readValue(t,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}lEe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ud.delete(this)}cancel(){this.state==="scheduled"&&(ud.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const vEe=n=>n.startsWith("--");function yEe(n,e,t){vEe(e)?n.style.setProperty(e,t):n.style[e]=t}const bEe=u2(()=>window.ScrollTimeline!==void 0),xEe={};function wEe(n,e){const t=u2(n);return()=>xEe[e]??t()}const $q=wEe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Kp=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,N4={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Kp([0,.65,.55,1]),circOut:Kp([.55,0,1,.45]),backIn:Kp([.31,.01,.66,-.59]),backOut:Kp([.33,1.53,.69,.99])};function Bq(n,e){if(n)return typeof n=="function"?$q()?Oq(n,e):"ease-out":_q(n)?Kp(n):Array.isArray(n)?n.map(t=>Bq(t,e)||N4.easeOut):N4[n]}function EEe(n,e,t,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[e]:t};l&&(u.offset=l);const f=Bq(o,s);Array.isArray(f)&&(u.easing=f);const m={delay:r,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),n.animate(u,m)}function Hq(n){return typeof n=="function"&&"applyToOptions"in n}function SEe({type:n,...e}){return Hq(n)&&$q()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class TEe extends w2{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=e,c2(typeof e.type!="string");const c=SEe(e);this.animation=EEe(t,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=x2(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):yEe(t,r,u),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Vo(Number(e))}get time(){return Vo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ho(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&bEe()?(this.animation.timeline=e,ya):t(this)}}const Vq={anticipate:wq,backInOut:xq,circInOut:Sq};function _Ee(n){return n in Vq}function AEe(n){typeof n.ease=="string"&&_Ee(n.ease)&&(n.ease=Vq[n.ease])}const j4=10;class REe extends TEe{constructor(e){AEe(e),jq(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const o=new E2({...a,autoplay:!1}),l=Ho(this.finishedTime??this.time);t.setWithVelocity(o.sample(l-j4).value,o.sample(l).value,j4),o.stop()}}const F4=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(au.test(n)||n==="0")&&!n.startsWith("url("));function CEe(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function kEe(n,e,t,r){const s=n[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=n[n.length-1],a=F4(s,e),o=F4(i,e);return!a||!o?!1:CEe(n)||(t==="spring"||Hq(t))&&r}function Nk(n){n.duration=0,n.type}const IEe=new Set(["opacity","clipPath","filter","transform"]),LEe=u2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function DEe(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:s,damping:i,type:a}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return LEe()&&t&&IEe.has(t)&&(t!=="transform"||!c)&&!l&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const PEe=40;class MEe extends w2{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=pi.now();const m={autoplay:e,delay:t,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...f},g=u?.KeyframeResolver||S2;this.keyframeResolver=new g(o,(y,b,x)=>this.onKeyframesResolved(y,b,m,!x),l,c,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=pi.now(),kEe(e,i,a,o)||((Vl.instantAnimations||!l)&&u?.(x2(e,r,t)),e[0]=e[e.length-1],Nk(r),r.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>PEe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},g=!c&&DEe(m)?new REe({...m,element:m.motionValue.owner.current}):new E2(m);g.finished.then(()=>this.notifyFinished()).catch(ya),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),gEe()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const OEe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function NEe(n){const e=OEe.exec(n);if(!e)return[,];const[,t,r,s]=e;return[`--${t??r}`,s]}function zq(n,e,t=1){const[r,s]=NEe(n);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const a=i.trim();return hq(a)?parseFloat(a):a}return p2(s)?zq(s,e,t+1):s}function T2(n,e){return n?.[e]??n?.default??n}const Gq=new Set(["width","height","top","left","right","bottom",...mm]),jEe={test:n=>n==="auto",parse:n=>n},qq=n=>e=>e.test(n),Wq=[fm,Ot,zo,Ic,Cwe,Rwe,jEe],U4=n=>Wq.find(qq(n));function FEe(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||mq(n):!0}const UEe=new Set(["brightness","contrast","saturate","opacity"]);function $Ee(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(g2)||[];if(!r)return n;const s=t.replace(r,"");let i=UEe.has(e)?1:0;return r!==t&&(i*=100),e+"("+i+s+")"}const BEe=/\b([a-z-]*)\(.*?\)/gu,jk={...au,getAnimatableNone:n=>{const e=n.match(BEe);return e?e.map($Ee).join(" "):n}},$4={...fm,transform:Math.round},HEe={rotate:Ic,rotateX:Ic,rotateY:Ic,rotateZ:Ic,scale:lb,scaleX:lb,scaleY:lb,scaleZ:lb,skew:Ic,skewX:Ic,skewY:Ic,distance:Ot,translateX:Ot,translateY:Ot,translateZ:Ot,x:Ot,y:Ot,z:Ot,perspective:Ot,transformPerspective:Ot,opacity:vv,originX:R4,originY:R4,originZ:Ot},_2={borderWidth:Ot,borderTopWidth:Ot,borderRightWidth:Ot,borderBottomWidth:Ot,borderLeftWidth:Ot,borderRadius:Ot,radius:Ot,borderTopLeftRadius:Ot,borderTopRightRadius:Ot,borderBottomRightRadius:Ot,borderBottomLeftRadius:Ot,width:Ot,maxWidth:Ot,height:Ot,maxHeight:Ot,top:Ot,right:Ot,bottom:Ot,left:Ot,padding:Ot,paddingTop:Ot,paddingRight:Ot,paddingBottom:Ot,paddingLeft:Ot,margin:Ot,marginTop:Ot,marginRight:Ot,marginBottom:Ot,marginLeft:Ot,backgroundPositionX:Ot,backgroundPositionY:Ot,...HEe,zIndex:$4,fillOpacity:vv,strokeOpacity:vv,numOctaves:$4},VEe={..._2,color:Dr,backgroundColor:Dr,outlineColor:Dr,fill:Dr,stroke:Dr,borderColor:Dr,borderTopColor:Dr,borderRightColor:Dr,borderBottomColor:Dr,borderLeftColor:Dr,filter:jk,WebkitFilter:jk},Kq=n=>VEe[n];function Yq(n,e){let t=Kq(n);return t!==jk&&(t=au),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const zEe=new Set(["auto","none","0"]);function GEe(n,e,t){let r=0,s;for(;r<n.length&&!s;){const i=n[r];typeof i=="string"&&!zEe.has(i)&&yv(i).values.length&&(s=n[r]),r++}if(s&&t)for(const i of e)n[i]=Yq(t,s)}class qEe extends S2{constructor(e,t,r,s,i){super(e,t,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),p2(c))){const u=zq(c,t.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Gq.has(r)||e.length!==2)return;const[s,i]=e,a=U4(s),o=U4(i);if(a!==o)if(O4(a)&&O4(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else cd[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||FEe(e[s]))&&r.push(s);r.length&&GEe(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=cd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const s=t[t.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(t);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=cd[t](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,l])=>{e.getValue(o).set(l)}),this.resolveNoneKeyframes()}}function WEe(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const s=t?.[n]??r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}const Xq=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function Qq(n){return fq(n)&&"offsetHeight"in n}const B4=30,KEe=n=>!isNaN(parseFloat(n));class YEe{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const s=pi.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=pi.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=KEe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new d2);const r=this.events[e].add(t);return e==="change"?()=>{r(),qn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=pi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>B4)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,B4);return pq(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wf(n,e){return new YEe(n,e)}const{schedule:A2}=Aq(queueMicrotask,!1),Da={x:!1,y:!1};function Zq(){return Da.x||Da.y}function XEe(n){return n==="x"||n==="y"?Da[n]?null:(Da[n]=!0,()=>{Da[n]=!1}):Da.x||Da.y?null:(Da.x=Da.y=!0,()=>{Da.x=Da.y=!1})}function Jq(n,e){const t=WEe(n),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[t,s,()=>r.abort()]}function H4(n){return!(n.pointerType==="touch"||Zq())}function QEe(n,e,t={}){const[r,s,i]=Jq(n,t),a=o=>{if(!H4(o))return;const{target:l}=o,c=e(l,o);if(typeof c!="function"||!l)return;const u=f=>{H4(f)&&(c(f),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}const eW=(n,e)=>e?n===e?!0:eW(n,e.parentElement):!1,R2=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,ZEe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function JEe(n){return ZEe.has(n.tagName)||n.tabIndex!==-1}const sx=new WeakSet;function V4(n){return e=>{e.key==="Enter"&&n(e)}}function IA(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const eSe=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=V4(()=>{if(sx.has(t))return;IA(t,"down");const s=V4(()=>{IA(t,"up")}),i=()=>IA(t,"cancel");t.addEventListener("keyup",s,e),t.addEventListener("blur",i,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function z4(n){return R2(n)&&!Zq()}function tSe(n,e,t={}){const[r,s,i]=Jq(n,t),a=o=>{const l=o.currentTarget;if(!z4(o))return;sx.add(l);const c=e(l,o),u=(g,y)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),sx.has(l)&&sx.delete(l),z4(g)&&typeof c=="function"&&c(g,{success:y})},f=g=>{u(g,l===window||l===document||t.useGlobalTarget||eW(l,g.target))},m=g=>{u(g,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",m,s)};return r.forEach(o=>{(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),Qq(o)&&(o.addEventListener("focus",c=>eSe(c,s)),!JEe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function tW(n){return fq(n)&&"ownerSVGElement"in n}function nSe(n){return tW(n)&&n.tagName==="svg"}const Ds=n=>!!(n&&n.getVelocity),rSe=[...Wq,Dr,au],sSe=n=>rSe.find(qq(n)),C2=E.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class iSe extends E.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,s=Qq(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function aSe({children:n,isPresent:e,anchorX:t,root:r}){const s=E.useId(),i=E.useRef(null),a=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=E.useContext(C2);return E.useInsertionEffect(()=>{const{width:l,height:c,top:u,left:f,right:m}=a.current;if(e||!i.current||!l||!c)return;const g=t==="left"?`left: ${f}`:`right: ${m}`;i.current.dataset.motionPopId=s;const y=document.createElement("style");o&&(y.nonce=o);const b=r??document.head;return b.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${g}px !important;
            top: ${u}px !important;
          }
        `),()=>{b.contains(y)&&b.removeChild(y)}},[e]),d.jsx(iSe,{isPresent:e,childRef:i,sizeRef:a,children:E.cloneElement(n,{ref:i})})}const oSe=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o,root:l})=>{const c=s2(lSe),u=E.useId();let f=!0,m=E.useMemo(()=>(f=!1,{id:u,initial:e,isPresent:t,custom:s,onExitComplete:g=>{c.set(g,!0);for(const y of c.values())if(!y)return;r&&r()},register:g=>(c.set(g,!1),()=>c.delete(g))}),[t,c,r]);return i&&f&&(m={...m}),E.useMemo(()=>{c.forEach((g,y)=>c.set(y,!1))},[t]),E.useEffect(()=>{!t&&!c.size&&r&&r()},[t]),a==="popLayout"&&(n=d.jsx(aSe,{isPresent:t,anchorX:o,root:l,children:n})),d.jsx(LS.Provider,{value:m,children:n})};function lSe(){return new Map}function nW(n=!0){const e=E.useContext(LS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:s}=e,i=E.useId();E.useEffect(()=>{if(n)return s(i)},[n]);const a=E.useCallback(()=>n&&r&&r(i),[i,r,n]);return!t&&r?[!1,a]:[!0]}const cb=n=>n.key||"";function G4(n){const e=[];return E.Children.forEach(n,t=>{E.isValidElement(t)&&e.push(t)}),e}const Ed=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left",root:l})=>{const[c,u]=nW(a),f=E.useMemo(()=>G4(n),[n]),m=a&&!c?[]:f.map(cb),g=E.useRef(!0),y=E.useRef(f),b=s2(()=>new Map),[x,S]=E.useState(f),[T,_]=E.useState(f);a2(()=>{g.current=!1,y.current=f;for(let C=0;C<T.length;C++){const L=cb(T[C]);m.includes(L)?b.delete(L):b.get(L)!==!0&&b.set(L,!1)}},[T,m.length,m.join("-")]);const R=[];if(f!==x){let C=[...f];for(let L=0;L<T.length;L++){const k=T[L],M=cb(k);m.includes(M)||(C.splice(L,0,k),R.push(k))}return i==="wait"&&R.length&&(C=R),_(G4(C)),S(f),null}const{forceRender:I}=E.useContext(pv);return d.jsx(d.Fragment,{children:T.map(C=>{const L=cb(C),k=a&&!c?!1:f===T||m.includes(L),M=()=>{if(b.has(L))b.set(L,!0);else return;let D=!0;b.forEach(U=>{U||(D=!1)}),D&&(I?.(),_(y.current),a&&u?.(),r&&r())};return d.jsx(oSe,{isPresent:k,initial:!g.current||t?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:l,onExitComplete:k?void 0:M,anchorX:o,children:C},L)})})},cSe=E.createContext(null);function uSe(){const n=E.useRef(!1);return a2(()=>(n.current=!0,()=>{n.current=!1}),[]),n}function dSe(){const n=uSe(),[e,t]=E.useState(0),r=E.useCallback(()=>{n.current&&t(e+1)},[e]);return[E.useCallback(()=>qn.postRender(r),[r]),e]}const hSe=n=>!n.isLayoutDirty&&n.willUpdate(!1);function q4(){const n=new Set,e=new WeakMap,t=()=>n.forEach(hSe);return{add:r=>{n.add(r),e.set(r,r.addEventListener("willUpdate",t))},remove:r=>{n.delete(r);const s=e.get(r);s&&(s(),e.delete(r)),t()},dirty:t}}const rW=n=>n===!0,fSe=n=>rW(n===!0)||n==="id",mSe=({children:n,id:e,inherit:t=!0})=>{const r=E.useContext(pv),s=E.useContext(cSe),[i,a]=dSe(),o=E.useRef(null),l=r.id||s;o.current===null&&(fSe(t)&&l&&(e=e?l+"-"+e:l),o.current={id:e,group:rW(t)&&r.group||q4()});const c=E.useMemo(()=>({...o.current,forceRender:i}),[a]);return d.jsx(pv.Provider,{value:c,children:n})},sW=E.createContext({strict:!1}),W4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Kf={};for(const n in W4)Kf[n]={isEnabled:e=>W4[n].some(t=>!!e[t])};function pSe(n){for(const e in n)Kf[e]={...Kf[e],...n[e]}}const gSe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ow(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||gSe.has(n)}let iW=n=>!Ow(n);function vSe(n){typeof n=="function"&&(iW=e=>e.startsWith("on")?!Ow(e):n(e))}try{vSe(require("@emotion/is-prop-valid").default)}catch{}function ySe(n,e,t){const r={};for(const s in n)s==="values"&&typeof n.values=="object"||(iW(s)||t===!0&&Ow(s)||!e&&!Ow(s)||n.draggable&&s.startsWith("onDrag"))&&(r[s]=n[s]);return r}const DS=E.createContext({});function PS(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function bv(n){return typeof n=="string"||Array.isArray(n)}const k2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],I2=["initial",...k2];function MS(n){return PS(n.animate)||I2.some(e=>bv(n[e]))}function aW(n){return!!(MS(n)||n.variants)}function bSe(n,e){if(MS(n)){const{initial:t,animate:r}=n;return{initial:t===!1||bv(t)?t:void 0,animate:bv(r)?r:void 0}}return n.inherit!==!1?e:{}}function xSe(n){const{initial:e,animate:t}=bSe(n,E.useContext(DS));return E.useMemo(()=>({initial:e,animate:t}),[K4(e),K4(t)])}function K4(n){return Array.isArray(n)?n.join(" "):n}const xv={};function wSe(n){for(const e in n)xv[e]=n[e],m2(e)&&(xv[e].isCSSVariable=!0)}function oW(n,{layout:e,layoutId:t}){return pm.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!xv[n]||n==="opacity")}const ESe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},SSe=mm.length;function TSe(n,e,t){let r="",s=!0;for(let i=0;i<SSe;i++){const a=mm[i],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=Xq(o,_2[a]);if(!l){s=!1;const u=ESe[a]||a;r+=`${u}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,s?"":r):s&&(r="none"),r}function L2(n,e,t){const{style:r,vars:s,transformOrigin:i}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(pm.has(l)){a=!0;continue}else if(m2(l)){s[l]=c;continue}else{const u=Xq(c,_2[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(e.transform||(a||t?r.transform=TSe(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const D2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function lW(n,e,t){for(const r in e)!Ds(e[r])&&!oW(r,t)&&(n[r]=e[r])}function _Se({transformTemplate:n},e){return E.useMemo(()=>{const t=D2();return L2(t,e,n),Object.assign({},t.vars,t.style)},[e])}function ASe(n,e){const t=n.style||{},r={};return lW(r,t,n),Object.assign(r,_Se(n,e)),r}function RSe(n,e){const t={},r=ASe(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const CSe={offset:"stroke-dashoffset",array:"stroke-dasharray"},kSe={offset:"strokeDashoffset",array:"strokeDasharray"};function ISe(n,e,t=1,r=0,s=!0){n.pathLength=1;const i=s?CSe:kSe;n[i.offset]=Ot.transform(-r);const a=Ot.transform(e),o=Ot.transform(t);n[i.array]=`${a} ${o}`}function cW(n,{attrX:e,attrY:t,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(L2(n,o,c),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:f,style:m}=n;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=u?.transformBox??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),t!==void 0&&(f.y=t),r!==void 0&&(f.scale=r),s!==void 0&&ISe(f,s,i,a,!1)}const uW=()=>({...D2(),attrs:{}}),dW=n=>typeof n=="string"&&n.toLowerCase()==="svg";function LSe(n,e,t,r){const s=E.useMemo(()=>{const i=uW();return cW(i,e,dW(r),n.transformTemplate,n.style),{...i.attrs,style:{...i.style}}},[e]);if(n.style){const i={};lW(i,n.style,n),s.style={...i,...s.style}}return s}const DSe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function P2(n){return typeof n!="string"||n.includes("-")?!1:!!(DSe.indexOf(n)>-1||/[A-Z]/u.test(n))}function PSe(n,e,t,{latestValues:r},s,i=!1){const o=(P2(n)?LSe:RSe)(e,r,s,n),l=ySe(e,typeof n=="string",i),c=n!==E.Fragment?{...l,...o,ref:t}:{},{children:u}=e,f=E.useMemo(()=>Ds(u)?u.get():u,[u]);return E.createElement(n,{...c,children:f})}function Y4(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function M2(n,e,t,r){if(typeof e=="function"){const[s,i]=Y4(r);e=e(t!==void 0?t:n.custom,s,i)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[s,i]=Y4(r);e=e(t!==void 0?t:n.custom,s,i)}return e}function ix(n){return Ds(n)?n.get():n}function MSe({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,s){return{latestValues:OSe(t,r,s,n),renderState:e()}}function OSe(n,e,t,r){const s={},i=r(n,{});for(const m in i)s[m]=ix(i[m]);let{initial:a,animate:o}=n;const l=MS(n),c=aW(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let u=t?t.initial===!1:!1;u=u||a===!1;const f=u?o:a;if(f&&typeof f!="boolean"&&!PS(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const y=M2(n,m[g]);if(y){const{transitionEnd:b,transition:x,...S}=y;for(const T in S){let _=S[T];if(Array.isArray(_)){const R=u?_.length-1:0;_=_[R]}_!==null&&(s[T]=_)}for(const T in b)s[T]=b[T]}}}return s}const hW=n=>(e,t)=>{const r=E.useContext(DS),s=E.useContext(LS),i=()=>MSe(n,e,r,s);return t?i():s2(i)};function O2(n,e,t){const{style:r}=n,s={};for(const i in r)(Ds(r[i])||e.style&&Ds(e.style[i])||oW(i,n)||t?.getValue(i)?.liveStyle!==void 0)&&(s[i]=r[i]);return s}const NSe=hW({scrapeMotionValuesFromProps:O2,createRenderState:D2});function fW(n,e,t){const r=O2(n,e,t);for(const s in n)if(Ds(n[s])||Ds(e[s])){const i=mm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=n[s]}return r}const jSe=hW({scrapeMotionValuesFromProps:fW,createRenderState:uW}),FSe=Symbol.for("motionComponentSymbol");function hf(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function USe(n,e,t){return E.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):hf(t)&&(t.current=r))},[e])}const N2=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$Se="framerAppearId",mW="data-"+N2($Se),pW=E.createContext({});function BSe(n,e,t,r,s){const{visualElement:i}=E.useContext(DS),a=E.useContext(sW),o=E.useContext(LS),l=E.useContext(C2).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(n,{visualState:e,parent:i,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,f=E.useContext(pW);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&HSe(c.current,t,s,f);const m=E.useRef(!1);E.useInsertionEffect(()=>{u&&m.current&&u.update(t,o)});const g=t[mW],y=E.useRef(!!g&&!window.MotionHandoffIsComplete?.(g)&&window.MotionHasOptimisedAnimation?.(g));return a2(()=>{u&&(m.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),y.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(g)}),y.current=!1),u.enteringChildren=void 0)}),u}function HSe(n,e,t,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:gW(n.parent)),n.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&hf(o),visualElement:n,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function gW(n){if(n)return n.options.allowProjection!==!1?n.projection:gW(n.parent)}function LA(n,{forwardMotionProps:e=!1}={},t,r){t&&pSe(t);const s=P2(n)?jSe:NSe;function i(o,l){let c;const u={...E.useContext(C2),...o,layoutId:VSe(o)},{isStatic:f}=u,m=xSe(o),g=s(o,f);if(!f&&i2){zSe();const y=GSe(u);c=y.MeasureLayout,m.visualElement=BSe(n,g,u,r,y.ProjectionNode)}return d.jsxs(DS.Provider,{value:m,children:[c&&m.visualElement?d.jsx(c,{visualElement:m.visualElement,...u}):null,PSe(n,o,USe(g,m.visualElement,l),g,f,e)]})}i.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const a=E.forwardRef(i);return a[FSe]=n,a}function VSe({layoutId:n}){const e=E.useContext(pv).id;return e&&n!==void 0?e+"-"+n:n}function zSe(n,e){E.useContext(sW).strict}function GSe(n){const{drag:e,layout:t}=Kf;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function qSe(n,e){if(typeof Proxy>"u")return LA;const t=new Map,r=(i,a)=>LA(i,a,n,e),s=(i,a)=>r(i,a);return new Proxy(s,{get:(i,a)=>a==="create"?r:(t.has(a)||t.set(a,LA(a,void 0,n,e)),t.get(a))})}function vW({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function WSe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function KSe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function DA(n){return n===void 0||n===1}function Fk({scale:n,scaleX:e,scaleY:t}){return!DA(n)||!DA(e)||!DA(t)}function qu(n){return Fk(n)||yW(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function yW(n){return X4(n.x)||X4(n.y)}function X4(n){return n&&n!=="0%"}function Nw(n,e,t){const r=n-t,s=e*r;return t+s}function Q4(n,e,t,r,s){return s!==void 0&&(n=Nw(n,s,r)),Nw(n,t,r)+e}function Uk(n,e=0,t=1,r,s){n.min=Q4(n.min,e,t,r,s),n.max=Q4(n.max,e,t,r,s)}function bW(n,{x:e,y:t}){Uk(n.x,e.translate,e.scale,e.originPoint),Uk(n.y,t.translate,t.scale,t.originPoint)}const Z4=.999999999999,J4=1.0000000000001;function YSe(n,e,t,r=!1){const s=t.length;if(!s)return;e.x=e.y=1;let i,a;for(let o=0;o<s;o++){i=t[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&mf(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,bW(n,a)),r&&qu(i.latestValues)&&mf(n,i.latestValues))}e.x<J4&&e.x>Z4&&(e.x=1),e.y<J4&&e.y>Z4&&(e.y=1)}function ff(n,e){n.min=n.min+e,n.max=n.max+e}function e5(n,e,t,r,s=.5){const i=sr(n.min,n.max,s);Uk(n,e,t,i,r)}function mf(n,e){e5(n.x,e.x,e.scaleX,e.scale,e.originX),e5(n.y,e.y,e.scaleY,e.scale,e.originY)}function xW(n,e){return vW(KSe(n.getBoundingClientRect(),e))}function XSe(n,e,t){const r=xW(n,t),{scroll:s}=e;return s&&(ff(r.x,s.offset.x),ff(r.y,s.offset.y)),r}const t5=()=>({translate:0,scale:1,origin:0,originPoint:0}),pf=()=>({x:t5(),y:t5()}),n5=()=>({min:0,max:0}),xr=()=>({x:n5(),y:n5()}),$k={current:null},wW={current:!1};function QSe(){if(wW.current=!0,!!i2)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>$k.current=n.matches;n.addEventListener("change",e),e()}else $k.current=!1}const ZSe=new WeakMap;function JSe(n,e,t){for(const r in e){const s=e[r],i=t[r];if(Ds(s))n.addValue(r,s);else if(Ds(i))n.addValue(r,Wf(s,{owner:n}));else if(i!==s)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=n.getStaticValue(r);n.addValue(r,Wf(a!==void 0?a:s,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const r5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eTe{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=S2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=pi.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,qn.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=MS(t),this.isVariantNode=aW(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in f){const g=f[m];l[m]!==void 0&&Ds(g)&&g.set(l[m])}}mount(e){this.current=e,ZSe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),wW.current||QSe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:$k.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),iu(this.notifyUpdate),iu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=pm.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&qn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Kf){const t=Kf[e];if(!t)continue;const{isEnabled:r,Feature:s}=t;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):xr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<r5.length;r++){const s=r5[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=e[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=JSe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Wf(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(hq(r)||mq(r))?r=parseFloat(r):!sSe(r)&&au.test(t)&&(r=Yq(e,t)),this.setBaseTarget(e,Ds(r)?r.get():r)),Ds(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const i=M2(this.props,t,this.presenceContext?.custom);i&&(r=i[e])}if(t&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ds(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new d2),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){A2.render(this.render)}}class EW extends eTe{constructor(){super(...arguments),this.KeyframeResolver=qEe}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ds(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function SW(n,{style:e,vars:t},r,s){const i=n.style;let a;for(a in e)i[a]=e[a];s?.applyProjectionStyles(i,r);for(a in t)i.setProperty(a,t[a])}function tTe(n){return window.getComputedStyle(n)}class nTe extends EW{constructor(){super(...arguments),this.type="html",this.renderInstance=SW}readValueFromInstance(e,t){if(pm.has(t))return this.projection?.isProjecting?Lk(t):dEe(e,t);{const r=tTe(e),s=(m2(t)?r.getPropertyValue(t):r[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return xW(e,t)}build(e,t,r){L2(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return O2(e,t,r)}}const TW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function rTe(n,e,t,r){SW(n,e,void 0,r);for(const s in e.attrs)n.setAttribute(TW.has(s)?s:N2(s),e.attrs[s])}class sTe extends EW{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=xr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(pm.has(t)){const r=Kq(t);return r&&r.default||0}return t=TW.has(t)?t:N2(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return fW(e,t,r)}build(e,t,r){cW(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,s){rTe(e,t,r,s)}mount(e){this.isSVGTag=dW(e.tagName),super.mount(e)}}const iTe=(n,e)=>P2(n)?new sTe(e):new nTe(e,{allowProjection:n!==E.Fragment});function kf(n,e,t){const r=n.getProps();return M2(r,e,t!==void 0?t:r.custom,n)}const Bk=n=>Array.isArray(n);function aTe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Wf(t))}function oTe(n){return Bk(n)?n[n.length-1]||0:n}function lTe(n,e){const t=kf(n,e);let{transitionEnd:r={},transition:s={},...i}=t||{};i={...i,...r};for(const a in i){const o=oTe(i[a]);aTe(n,a,o)}}function cTe(n){return!!(Ds(n)&&n.add)}function Hk(n,e){const t=n.getValue("willChange");if(cTe(t))return t.add(e);if(!t&&Vl.WillChange){const r=new Vl.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function _W(n){return n.props[mW]}const uTe=n=>n!==null;function dTe(n,{repeat:e,repeatType:t="loop"},r){const s=n.filter(uTe),i=e&&t!=="loop"&&e%2===1?0:s.length-1;return s[i]}const hTe={type:"spring",stiffness:500,damping:25,restSpeed:10},fTe=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),mTe={type:"keyframes",duration:.8},pTe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gTe=(n,{keyframes:e})=>e.length>2?mTe:pm.has(n)?n.startsWith("scale")?fTe(e[1]):hTe:pTe;function vTe({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const j2=(n,e,t,r={},s,i)=>a=>{const o=T2(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Ho(l);const u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:i?void 0:s};vTe(o)||Object.assign(u,gTe(n,u)),u.duration&&(u.duration=Ho(u.duration)),u.repeatDelay&&(u.repeatDelay=Ho(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let f=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Nk(u),u.delay===0&&(f=!0)),(Vl.instantAnimations||Vl.skipAnimations)&&(f=!0,Nk(u),u.delay=0),u.allowFlatten=!o.type&&!o.ease,f&&!i&&e.get()!==void 0){const m=dTe(u.keyframes,o);if(m!==void 0){qn.update(()=>{u.onUpdate(m),u.onComplete()});return}}return o.isSync?new E2(u):new MEe(u)};function yTe({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function AW(n,e,{delay:t=0,transitionOverride:r,type:s}={}){let{transition:i=n.getDefaultTransition(),transitionEnd:a,...o}=e;r&&(i=r);const l=[],c=s&&n.animationState&&n.animationState.getState()[s];for(const u in o){const f=n.getValue(u,n.latestValues[u]??null),m=o[u];if(m===void 0||c&&yTe(c,u))continue;const g={delay:t,...T2(i||{},u)},y=f.get();if(y!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===y&&!g.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const S=_W(n);if(S){const T=window.MotionHandoffAnimation(S,u,qn);T!==null&&(g.startTime=T,b=!0)}}Hk(n,u),f.start(j2(u,f,m,n.shouldReduceMotion&&Gq.has(u)?{type:!1}:g,n,b));const x=f.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{qn.update(()=>{a&&lTe(n,a)})}),l}function RW(n,e,t,r=0,s=1){const i=Array.from(n).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),a=n.size,o=(a-1)*r;return typeof t=="function"?t(i,a):s===1?i*r:o-i*r}function Vk(n,e,t={}){const r=kf(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const i=r?()=>Promise.all(AW(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:f}=s;return bTe(n,e,l,c,u,f,t)}:()=>Promise.resolve(),{when:o}=s;if(o){const[l,c]=o==="beforeChildren"?[i,a]:[a,i];return l().then(()=>c())}else return Promise.all([i(),a(t.delay)])}function bTe(n,e,t=0,r=0,s=0,i=1,a){const o=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),o.push(Vk(l,e,{...a,delay:t+(typeof r=="function"?0:r)+RW(n.variantChildren,l,r,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function xTe(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>Vk(n,i,t));r=Promise.all(s)}else if(typeof e=="string")r=Vk(n,e,t);else{const s=typeof e=="function"?kf(n,e,t.custom):e;r=Promise.all(AW(n,s,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function CW(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const wTe=I2.length;function kW(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?kW(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<wTe;t++){const r=I2[t],s=n.props[r];(bv(s)||s===!1)&&(e[r]=s)}return e}const ETe=[...k2].reverse(),STe=k2.length;function TTe(n){return e=>Promise.all(e.map(({animation:t,options:r})=>xTe(n,t,r)))}function _Te(n){let e=TTe(n),t=s5(),r=!0;const s=l=>(c,u)=>{const f=kf(n,u,l==="exit"?n.presenceContext?.custom:void 0);if(f){const{transition:m,transitionEnd:g,...y}=f;c={...c,...y,...g}}return c};function i(l){e=l(n)}function a(l){const{props:c}=n,u=kW(n.parent)||{},f=[],m=new Set;let g={},y=1/0;for(let x=0;x<STe;x++){const S=ETe[x],T=t[S],_=c[S]!==void 0?c[S]:u[S],R=bv(_),I=S===l?T.isActive:null;I===!1&&(y=x);let C=_===u[S]&&_!==c[S]&&R;if(C&&r&&n.manuallyAnimateOnMount&&(C=!1),T.protectedKeys={...g},!T.isActive&&I===null||!_&&!T.prevProp||PS(_)||typeof _=="boolean")continue;const L=ATe(T.prevProp,_);let k=L||S===l&&T.isActive&&!C&&R||x>y&&R,M=!1;const D=Array.isArray(_)?_:[_];let U=D.reduce(s(S),{});I===!1&&(U={});const{prevResolvedValues:$={}}=T,V={...$,...U},B=j=>{k=!0,m.has(j)&&(M=!0,m.delete(j)),T.needsAnimating[j]=!0;const q=n.getValue(j);q&&(q.liveStyle=!1)};for(const j in V){const q=U[j],H=$[j];if(g.hasOwnProperty(j))continue;let N=!1;Bk(q)&&Bk(H)?N=!CW(q,H):N=q!==H,N?q!=null?B(j):m.add(j):q!==void 0&&m.has(j)?B(j):T.protectedKeys[j]=!0}T.prevProp=_,T.prevResolvedValues=U,T.isActive&&(g={...g,...U}),r&&n.blockInitialAnimation&&(k=!1);const W=C&&L;k&&(!W||M)&&f.push(...D.map(j=>{const q={type:S};if(typeof j=="string"&&r&&!W&&n.manuallyAnimateOnMount&&n.parent){const{parent:H}=n,N=kf(H,j);if(H.enteringChildren&&N){const{delayChildren:O}=N.transition||{};q.delay=RW(H.enteringChildren,n,O)}}return{animation:j,options:q}}))}if(m.size){const x={};if(typeof c.initial!="boolean"){const S=kf(n,Array.isArray(c.initial)?c.initial[0]:c.initial);S&&S.transition&&(x.transition=S.transition)}m.forEach(S=>{const T=n.getBaseTarget(S),_=n.getValue(S);_&&(_.liveStyle=!0),x[S]=T??null}),f.push({animation:x})}let b=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(b=!1),r=!1,b?e(f):Promise.resolve()}function o(l,c){if(t[l].isActive===c)return Promise.resolve();n.variantChildren?.forEach(f=>f.animationState?.setActive(l,c)),t[l].isActive=c;const u=a(l);for(const f in t)t[f].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>t,reset:()=>{t=s5(),r=!0}}}function ATe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!CW(e,n):!1}function Bu(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function s5(){return{animate:Bu(!0),whileInView:Bu(),whileHover:Bu(),whileTap:Bu(),whileDrag:Bu(),whileFocus:Bu(),exit:Bu()}}class fu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class RTe extends fu{constructor(e){super(e),e.animationState||(e.animationState=_Te(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();PS(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let CTe=0;class kTe extends fu{constructor(){super(...arguments),this.id=CTe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);t&&!e&&s.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const ITe={animation:{Feature:RTe},exit:{Feature:kTe}};function wv(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function f0(n){return{point:{x:n.pageX,y:n.pageY}}}const LTe=n=>e=>R2(e)&&n(e,f0(e));function Sg(n,e,t,r){return wv(n,e,LTe(t),r)}const IW=1e-4,DTe=1-IW,PTe=1+IW,LW=.01,MTe=0-LW,OTe=0+LW;function Vs(n){return n.max-n.min}function NTe(n,e,t){return Math.abs(n-e)<=t}function i5(n,e,t,r=.5){n.origin=r,n.originPoint=sr(e.min,e.max,n.origin),n.scale=Vs(t)/Vs(e),n.translate=sr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=DTe&&n.scale<=PTe||isNaN(n.scale))&&(n.scale=1),(n.translate>=MTe&&n.translate<=OTe||isNaN(n.translate))&&(n.translate=0)}function Tg(n,e,t,r){i5(n.x,e.x,t.x,r?r.originX:void 0),i5(n.y,e.y,t.y,r?r.originY:void 0)}function a5(n,e,t){n.min=t.min+e.min,n.max=n.min+Vs(e)}function jTe(n,e,t){a5(n.x,e.x,t.x),a5(n.y,e.y,t.y)}function o5(n,e,t){n.min=e.min-t.min,n.max=n.min+Vs(e)}function _g(n,e,t){o5(n.x,e.x,t.x),o5(n.y,e.y,t.y)}function ta(n){return[n("x"),n("y")]}const DW=({current:n})=>n?n.ownerDocument.defaultView:null,l5=(n,e)=>Math.abs(n-e);function FTe(n,e){const t=l5(n.x,e.x),r=l5(n.y,e.y);return Math.sqrt(t**2+r**2)}class PW{constructor(e,t,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=MA(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,y=FTe(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!g&&!y)return;const{point:b}=m,{timestamp:x}=fs;this.history.push({...b,timestamp:x});const{onStart:S,onMove:T}=this.handlers;g||(S&&S(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,m)},this.handlePointerMove=(m,g)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=PA(g,this.transformPagePoint),qn.update(this.updatePoint,!0)},this.handlePointerUp=(m,g)=>{this.end();const{onEnd:y,onSessionEnd:b,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=MA(m.type==="pointercancel"?this.lastMoveEventInfo:PA(g,this.transformPagePoint),this.history);this.startEvent&&y&&y(m,S),b&&b(m,S)},!R2(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=s||window;const o=f0(e),l=PA(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=fs;this.history=[{...c,timestamp:u}];const{onSessionStart:f}=t;f&&f(e,MA(l,this.history)),this.removeListeners=u0(Sg(this.contextWindow,"pointermove",this.handlePointerMove),Sg(this.contextWindow,"pointerup",this.handlePointerUp),Sg(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),iu(this.updatePoint)}}function PA(n,e){return e?{point:e(n.point)}:n}function c5(n,e){return{x:n.x-e.x,y:n.y-e.y}}function MA({point:n},e){return{point:n,delta:c5(n,MW(e)),offset:c5(n,UTe(e)),velocity:$Te(e,.1)}}function UTe(n){return n[0]}function MW(n){return n[n.length-1]}function $Te(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const s=MW(n);for(;t>=0&&(r=n[t],!(s.timestamp-r.timestamp>Ho(e)));)t--;if(!r)return{x:0,y:0};const i=Vo(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function BTe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?sr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?sr(t,n,r.max):Math.min(n,t)),n}function u5(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function HTe(n,{top:e,left:t,bottom:r,right:s}){return{x:u5(n.x,t,s),y:u5(n.y,e,r)}}function d5(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function VTe(n,e){return{x:d5(n.x,e.x),y:d5(n.y,e.y)}}function zTe(n,e){let t=.5;const r=Vs(n),s=Vs(e);return s>r?t=gv(e.min,e.max-r,n.min):r>s&&(t=gv(n.min,n.max-s,e.min)),Hl(0,1,t)}function GTe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const zk=.35;function qTe(n=zk){return n===!1?n=0:n===!0&&(n=zk),{x:h5(n,"left","right"),y:h5(n,"top","bottom")}}function h5(n,e,t){return{min:f5(n,e),max:f5(n,t)}}function f5(n,e){return typeof n=="number"?n:n[e]||0}const WTe=new WeakMap;class KTe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=xr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(f0(f).point)},a=(f,m)=>{const{drag:g,dragPropagation:y,onDragStart:b}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=XEe(g),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ta(S=>{let T=this.getAxisMotionValue(S).get()||0;if(zo.test(T)){const{projection:_}=this.visualElement;if(_&&_.layout){const R=_.layout.layoutBox[S];R&&(T=Vs(R)*(parseFloat(T)/100))}}this.originPoint[S]=T}),b&&qn.postRender(()=>b(f,m)),Hk(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m;const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:b,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:S}=m;if(y&&this.currentDirection===null){this.currentDirection=YTe(S),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",m.point,S),this.updateAxis("y",m.point,S),this.visualElement.render(),x&&x(f,m)},l=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m,this.stop(f,m),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>ta(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new PW(e,{onSessionStart:i,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:DW(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,s=t||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:a}=s;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&qn.postRender(()=>o(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:s}=this.getProps();if(!r||!ub(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=BTe(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;e&&hf(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=HTe(r.layoutBox,e):this.constraints=!1,this.elastic=qTe(t),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ta(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=GTe(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!hf(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=XSe(r,s.root,this.visualElement.getTransformPagePoint());let a=VTe(s.layout.layoutBox,i);if(t){const o=t(WSe(a));this.hasMutatedConstraints=!!o,o&&(a=vW(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=ta(u=>{if(!ub(u,t,this.currentDirection))return;let f=l&&l[u]||{};a&&(f={min:0,max:0});const m=s?200:1e6,g=s?40:1e7,y={type:"inertia",velocity:r?e[u]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return Hk(this.visualElement,e),r.start(j2(e,r,0,t,this.visualElement,!1))}stopAnimation(){ta(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ta(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[t];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ta(t=>{const{drag:r}=this.getProps();if(!ub(t,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(t);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[t];i.set(e[t]-sr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!hf(t)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ta(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=zTe({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ta(a=>{if(!ub(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(sr(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;WTe.set(this.visualElement,this);const e=this.visualElement.current,t=Sg(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();hf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),qn.read(r);const a=wv(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ta(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=l[u].translate,f.set(f.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),t(),i(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=zk,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function ub(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function YTe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class XTe extends fu{constructor(e){super(e),this.removeGroupControls=ya,this.removeListeners=ya,this.controls=new KTe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ya}unmount(){this.removeGroupControls(),this.removeListeners()}}const m5=n=>(e,t)=>{n&&qn.postRender(()=>n(e,t))};class QTe extends fu{constructor(){super(...arguments),this.removePointerDownListener=ya}onPointerDown(e){this.session=new PW(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:DW(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:m5(e),onStart:m5(t),onMove:r,onEnd:(i,a)=>{delete this.session,s&&qn.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Sg(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ax={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function p5(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ip={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ot.test(n))n=parseFloat(n);else return n;const t=p5(n,e.target.x),r=p5(n,e.target.y);return`${t}% ${r}%`}},ZTe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,s=au.parse(n);if(s.length>5)return r;const i=au.createTransformer(n),a=typeof s[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;s[0+a]/=o,s[1+a]/=l;const c=sr(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};let OA=!1;class JTe extends E.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;wSe(e_e),i&&(t.group&&t.group.add(i),r&&r.register&&s&&r.register(i),OA&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ax.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,OA=!0,s||e.layoutDependency!==t||t===void 0||e.isPresent!==i?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||qn.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),A2.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:s}=e;OA=!0,s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function OW(n){const[e,t]=nW(),r=E.useContext(pv);return d.jsx(JTe,{...n,layoutGroup:r,switchLayoutGroup:E.useContext(pW),isPresent:e,safeToRemove:t})}const e_e={borderRadius:{...Ip,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ip,borderTopRightRadius:Ip,borderBottomLeftRadius:Ip,borderBottomRightRadius:Ip,boxShadow:ZTe};function t_e(n,e,t){const r=Ds(n)?n:Wf(n);return r.start(j2("",r,e,t)),r.animation}const n_e=(n,e)=>n.depth-e.depth;class r_e{constructor(){this.children=[],this.isDirty=!1}add(e){o2(this.children,e),this.isDirty=!0}remove(e){l2(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(n_e),this.isDirty=!1,this.children.forEach(e)}}function s_e(n,e){const t=pi.now(),r=({timestamp:s})=>{const i=s-t;i>=e&&(iu(r),n(i-e))};return qn.setup(r,!0),()=>iu(r)}const NW=["TopLeft","TopRight","BottomLeft","BottomRight"],i_e=NW.length,g5=n=>typeof n=="string"?parseFloat(n):n,v5=n=>typeof n=="number"||Ot.test(n);function a_e(n,e,t,r,s,i){s?(n.opacity=sr(0,t.opacity??1,o_e(r)),n.opacityExit=sr(e.opacity??1,0,l_e(r))):i&&(n.opacity=sr(e.opacity??1,t.opacity??1,r));for(let a=0;a<i_e;a++){const o=`border${NW[a]}Radius`;let l=y5(e,o),c=y5(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||v5(l)===v5(c)?(n[o]=Math.max(sr(g5(l),g5(c),r),0),(zo.test(c)||zo.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=sr(e.rotate||0,t.rotate||0,r))}function y5(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const o_e=jW(0,.5,Eq),l_e=jW(.5,.95,ya);function jW(n,e,t){return r=>r<n?0:r>e?1:t(gv(n,e,r))}function b5(n,e){n.min=e.min,n.max=e.max}function Xi(n,e){b5(n.x,e.x),b5(n.y,e.y)}function x5(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function w5(n,e,t,r,s){return n-=e,n=Nw(n,1/t,r),s!==void 0&&(n=Nw(n,1/s,r)),n}function c_e(n,e=0,t=1,r=.5,s,i=n,a=n){if(zo.test(e)&&(e=parseFloat(e),e=sr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=sr(i.min,i.max,r);n===i&&(o-=e),n.min=w5(n.min,e,t,o,s),n.max=w5(n.max,e,t,o,s)}function E5(n,e,[t,r,s],i,a){c_e(n,e[t],e[r],e[s],e.scale,i,a)}const u_e=["x","scaleX","originX"],d_e=["y","scaleY","originY"];function S5(n,e,t,r){E5(n.x,e,u_e,t?t.x:void 0,r?r.x:void 0),E5(n.y,e,d_e,t?t.y:void 0,r?r.y:void 0)}function T5(n){return n.translate===0&&n.scale===1}function FW(n){return T5(n.x)&&T5(n.y)}function _5(n,e){return n.min===e.min&&n.max===e.max}function h_e(n,e){return _5(n.x,e.x)&&_5(n.y,e.y)}function A5(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function UW(n,e){return A5(n.x,e.x)&&A5(n.y,e.y)}function R5(n){return Vs(n.x)/Vs(n.y)}function C5(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class f_e{constructor(){this.members=[]}add(e){o2(this.members,e),e.scheduleRender()}remove(e){if(l2(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let r;for(let s=t;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function m_e(n,e,t){let r="";const s=n.x.translate/e.x,i=n.y.translate/e.y,a=t?.z||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:u,rotateX:f,rotateY:m,skewX:g,skewY:y}=t;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),f&&(r+=`rotateX(${f}deg) `),m&&(r+=`rotateY(${m}deg) `),g&&(r+=`skewX(${g}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const NA=["","X","Y","Z"],p_e=1e3;let g_e=0;function jA(n,e,t,r){const{latestValues:s}=e;s[n]&&(t[n]=s[n],e.setStaticValue(n,0),r&&(r[n]=0))}function $W(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=_W(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:s,layoutId:i}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",qn,!(s||i))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&$W(r)}function BW({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=e?.()){this.id=g_e++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(b_e),this.nodes.forEach(S_e),this.nodes.forEach(T_e),this.nodes.forEach(x_e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new r_e)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new d2),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=tW(a)&&!nSe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),n){let u,f=0;const m=()=>this.root.updateBlockedByResize=!1;qn.read(()=>{f=window.innerWidth}),n(a,()=>{const g=window.innerWidth;g!==f&&(f=g,this.root.updateBlockedByResize=!0,u&&u(),u=s_e(m,250),ax.hasAnimatedSinceResize&&(ax.hasAnimatedSinceResize=!1,this.nodes.forEach(L5)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||k_e,{onLayoutAnimationStart:b,onLayoutAnimationComplete:x}=c.getProps(),S=!this.targetLayout||!UW(this.targetLayout,g),T=!f&&m;if(this.options.layoutRoot||this.resumeFrom||T||f&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...T2(y,"layout"),onPlay:b,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(u,T)}else f||L5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),iu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(__e),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&$W(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(k5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(I5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(E_e),this.nodes.forEach(v_e),this.nodes.forEach(y_e)):this.nodes.forEach(I5),this.clearAllSnapshots();const o=pi.now();fs.delta=Hl(0,1e3/60,o-fs.timestamp),fs.timestamp=o,fs.isProcessing=!0,_A.update.process(fs),_A.preRender.process(fs),_A.render.process(fs),fs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,A2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(w_e),this.sharedNodes.forEach(A_e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Vs(this.snapshot.measuredBox.x)&&!Vs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=xr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!FW(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||qu(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),I_e(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return xr();const o=a.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(L_e))){const{scroll:c}=this.root;c&&(ff(o.x,c.offset.x),ff(o.y,c.offset.y))}return o}removeElementScroll(a){const o=xr();if(Xi(o,a),this.scroll?.wasRoot)return o;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:f}=c;c!==this.root&&u&&f.layoutScroll&&(u.wasRoot&&Xi(o,a),ff(o.x,u.offset.x),ff(o.y,u.offset.y))}return o}applyTransform(a,o=!1){const l=xr();Xi(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&mf(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),qu(u.latestValues)&&mf(l,u.latestValues)}return qu(this.latestValues)&&mf(l,this.latestValues),l}removeTransform(a){const o=xr();Xi(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!qu(c.latestValues))continue;Fk(c.latestValues)&&c.updateSnapshot();const u=xr(),f=c.measurePageBox();Xi(u,f),S5(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return qu(this.latestValues)&&S5(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:f}=this.options;if(!(!this.layout||!(u||f))){if(this.resolvedRelativeTargetAt=fs.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xr(),this.relativeTargetOrigin=xr(),_g(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=xr(),this.targetWithTransforms=xr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jTe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xi(this.target,this.layout.layoutBox),bW(this.target,this.targetDelta)):Xi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xr(),this.relativeTargetOrigin=xr(),_g(this.relativeTargetOrigin,this.target,m.target),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Fk(this.parent.latestValues)||yW(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===fs.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Xi(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;YSe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=xr());const{target:g}=a;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(x5(this.prevProjectionDelta.x,this.projectionDelta.x),x5(this.prevProjectionDelta.y,this.projectionDelta.y)),Tg(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!C5(this.projectionDelta.x,this.prevProjectionDelta.x)||!C5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.visualElement?.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=pf(),this.projectionDelta=pf(),this.projectionDeltaWithTransform=pf()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},f=pf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=xr(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=g!==y,x=this.getStack(),S=!x||x.members.length<=1,T=!!(b&&!S&&this.options.crossfade===!0&&!this.path.some(C_e));this.animationProgress=0;let _;this.mixTargetDelta=R=>{const I=R/1e3;D5(f.x,a.x,I),D5(f.y,a.y,I),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(_g(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),R_e(this.relativeTarget,this.relativeTargetOrigin,m,I),_&&h_e(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=xr()),Xi(_,this.relativeTarget)),b&&(this.animationValues=u,a_e(u,c,this.latestValues,I,T,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=I},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(iu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qn.update(()=>{ax.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Wf(0)),this.currentAnimation=t_e(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(p_e),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&HW(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||xr();const f=Vs(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=Vs(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Xi(o,l),mf(o,u),Tg(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new f_e),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){const{layoutId:a}=this.options;return a?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:a}=this.options;return a?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&jA("z",a,c,this.animationValues);for(let u=0;u<NA.length;u++)jA(`rotate${NA[u]}`,a,c,this.animationValues),jA(`skew${NA[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=ix(o?.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=ix(o?.pointerEvents)||""),this.hasProjected&&!qu(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let f=m_e(this.projectionDeltaWithTransform,this.treeScale,u);l&&(f=l(u,f)),a.transform=f;const{x:m,y:g}=this.projectionDelta;a.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,c.animationValues?a.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:a.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const y in xv){if(u[y]===void 0)continue;const{correct:b,applyTo:x,isCSSVariable:S}=xv[y],T=f==="none"?u[y]:b(u[y],c);if(x){const _=x.length;for(let R=0;R<_;R++)a[x[R]]=T}else S?this.options.visualElement.renderState.vars[y]=T:a[y]=T}this.options.layoutId&&(a.pointerEvents=c===this?ix(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>a.currentAnimation?.stop()),this.root.nodes.forEach(k5),this.root.sharedNodes.clear()}}}function v_e(n){n.updateLayout()}function y_e(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:s}=n.options,i=e.source!==n.layout.source;s==="size"?ta(u=>{const f=i?e.measuredBox[u]:e.layoutBox[u],m=Vs(f);f.min=t[u].min,f.max=f.min+m}):HW(s,e.layoutBox,t)&&ta(u=>{const f=i?e.measuredBox[u]:e.layoutBox[u],m=Vs(t[u]);f.max=f.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[u].max=n.relativeTarget[u].min+m)});const a=pf();Tg(a,t,e.layoutBox);const o=pf();i?Tg(o,n.applyTransform(r,!0),e.measuredBox):Tg(o,t,e.layoutBox);const l=!FW(a);let c=!1;if(!n.resumeFrom){const u=n.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:f,layout:m}=u;if(f&&m){const g=xr();_g(g,e.layoutBox,f.layoutBox);const y=xr();_g(y,t,m.layoutBox),UW(g,y)||(c=!0),u.options.layoutRoot&&(n.relativeTarget=y,n.relativeTargetOrigin=g,n.relativeParent=u)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:o,layoutDelta:a,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function b_e(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function x_e(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function w_e(n){n.clearSnapshot()}function k5(n){n.clearMeasurements()}function I5(n){n.isLayoutDirty=!1}function E_e(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function L5(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function S_e(n){n.resolveTargetDelta()}function T_e(n){n.calcProjection()}function __e(n){n.resetSkewAndRotation()}function A_e(n){n.removeLeadSnapshot()}function D5(n,e,t){n.translate=sr(e.translate,0,t),n.scale=sr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function P5(n,e,t,r){n.min=sr(e.min,t.min,r),n.max=sr(e.max,t.max,r)}function R_e(n,e,t,r){P5(n.x,e.x,t.x,r),P5(n.y,e.y,t.y,r)}function C_e(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const k_e={duration:.45,ease:[.4,0,.1,1]},M5=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),O5=M5("applewebkit/")&&!M5("chrome/")?Math.round:ya;function N5(n){n.min=O5(n.min),n.max=O5(n.max)}function I_e(n){N5(n.x),N5(n.y)}function HW(n,e,t){return n==="position"||n==="preserve-aspect"&&!NTe(R5(e),R5(t),.2)}function L_e(n){return n!==n.root&&n.scroll?.wasRoot}const D_e=BW({attachResizeListener:(n,e)=>wv(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),FA={current:void 0},VW=BW({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!FA.current){const n=new D_e({});n.mount(window),n.setOptions({layoutScroll:!0}),FA.current=n}return FA.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),P_e={pan:{Feature:QTe},drag:{Feature:XTe,ProjectionNode:VW,MeasureLayout:OW}};function j5(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const s="onHover"+t,i=r[s];i&&qn.postRender(()=>i(e,f0(e)))}class M_e extends fu{mount(){const{current:e}=this.node;e&&(this.unmount=QEe(e,(t,r)=>(j5(this.node,r,"Start"),s=>j5(this.node,s,"End"))))}unmount(){}}class O_e extends fu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=u0(wv(this.node.current,"focus",()=>this.onFocus()),wv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function F5(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const s="onTap"+(t==="End"?"":t),i=r[s];i&&qn.postRender(()=>i(e,f0(e)))}class N_e extends fu{mount(){const{current:e}=this.node;e&&(this.unmount=tSe(e,(t,r)=>(F5(this.node,r,"Start"),(s,{success:i})=>F5(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Gk=new WeakMap,UA=new WeakMap,j_e=n=>{const e=Gk.get(n.target);e&&e(n)},F_e=n=>{n.forEach(j_e)};function U_e({root:n,...e}){const t=n||document;UA.has(t)||UA.set(t,{});const r=UA.get(t),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(F_e,{root:n,...e})),r[s]}function $_e(n,e,t){const r=U_e(e);return Gk.set(n,t),r.observe(n),()=>{Gk.delete(n),r.unobserve(n)}}const B_e={some:0,all:1};class H_e extends fu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:s="some",once:i}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:B_e[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=c?u:f;m&&m(l)};return $_e(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(V_e(e,t))&&this.startObserver()}unmount(){}}function V_e({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const z_e={inView:{Feature:H_e},tap:{Feature:N_e},focus:{Feature:O_e},hover:{Feature:M_e}},G_e={layout:{ProjectionNode:VW,MeasureLayout:OW}},q_e={...ITe,...z_e,...P_e,...G_e},Ka=qSe(q_e,iTe);Vse();const W_e=200;let ka=null;const Oc=Ws()(Ui(bi((n,e)=>({pressedKeys:new Set,isSpacePressed:!1,isSpaceHeld:!1,modifiers:{ctrl:!1,alt:!1,shift:!1,meta:!1},isPanning:!1,isInInputElement:!1,shortcuts:{enabled:!0,preventDefaults:!0},setKeyPressed:(t,r)=>n(s=>{const i=new Set(s.pressedKeys);return r?i.add(t.toLowerCase()):i.delete(t.toLowerCase()),{pressedKeys:i}}),setSpacePressed:t=>{ka&&(clearTimeout(ka),ka=null),n(r=>{r.isSpacePressed=t,r.isSpaceHeld=!1,r.isPanning=!1}),t&&(ka=setTimeout(()=>{e().isSpacePressed&&n(s=>{s.isSpaceHeld=!0,s.isPanning=!0}),ka=null},W_e))},setSpaceHeld:t=>n(r=>{r.isSpaceHeld=t,t||(r.isPanning=!1)}),setModifier:(t,r)=>n(s=>{s.modifiers[t]!==r&&(s.modifiers[t]=r)}),setPanning:t=>n(r=>{r.isPanning!==t&&(r.isPanning=t)}),setInInputElement:t=>n(r=>{r.isInInputElement!==t&&(r.isInInputElement=t)}),setShortcutsEnabled:t=>n(r=>{r.shortcuts.enabled!==t&&(r.shortcuts.enabled=t)}),isKeyPressed:t=>{const{pressedKeys:r}=e();return r.has(t.toLowerCase())},isKeyCombo:(t,r={})=>{const s=e(),i=t.every(o=>s.pressedKeys.has(o.toLowerCase())),a=Object.entries(r).every(([o,l])=>s.modifiers[o]===l);return i&&a},reset:()=>{ka&&(clearTimeout(ka),ka=null),n(t=>{t.pressedKeys.clear(),t.isSpacePressed=!1,t.isSpaceHeld=!1,t.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},t.isPanning=!1,t.isInInputElement=!1})},safeReset:()=>{const t=e();ka&&(clearTimeout(ka),ka=null),(t.pressedKeys.size>0||t.isSpacePressed||t.isSpaceHeld||t.isPanning||t.isInInputElement||Object.values(t.modifiers).some(Boolean))&&n(s=>{s.pressedKeys.clear(),s.isSpacePressed=!1,s.isSpaceHeld=!1,s.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},s.isPanning=!1,s.isInInputElement=!1})},clearAllKeys:()=>n(t=>{t.pressedKeys.clear(),t.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1}})})))),Ag=Ws()(Ui(bi((n,e)=>({currentTeam:null,isLoading:!1,error:null,userTeams:[],isLoadingUserTeams:!1,fetchCurrentTeam:async t=>{if(t){n(r=>{r.isLoading=!0,r.error=null});try{const r=ua(),{data:s,error:i}=await r.from("user_teams").select("*, teams(*)").eq("user_id",t).eq("active",!0).single();if(i){console.error("Error fetching user team:",i),n(c=>{c.error="Failed to fetch team",c.isLoading=!1});return}if(!s?.teams){n(c=>{c.currentTeam=null,c.isLoading=!1});return}const a=s.teams,o=await Ht(`/api/teams/${a.id}`);if(!o.ok)throw new Error("Failed to fetch team details");const l=await o.json();n(c=>{c.currentTeam=l.team,c.isLoading=!1})}catch(r){console.error("Error in fetchCurrentTeam:",r),n(s=>{s.error=r instanceof Error?r.message:"Failed to fetch team",s.isLoading=!1})}}},fetchUserTeams:async t=>{if(t){n(r=>{r.isLoadingUserTeams=!0});try{const r=ua(),{data:s,error:i}=await r.from("user_teams").select("*, teams(*)").eq("user_id",t).order("joined_at",{ascending:!1});if(i){console.error("Error fetching user teams:",i);return}const a=s?.map(o=>o.teams).filter(Boolean);n(o=>{o.userTeams=a||[],o.isLoadingUserTeams=!1})}catch(r){console.error("Error in fetchUserTeams:",r),n(s=>{s.isLoadingUserTeams=!1})}}},switchTeam:async t=>{const r=ua();try{const{user:s}=cn.getState();if(!s)throw new Error("Not authenticated");await r.from("user_teams").update({active:!1}).eq("user_id",s.id);const{error:i}=await r.from("user_teams").update({active:!0}).eq("user_id",s.id).eq("team_id",t);if(i)throw i;await e().fetchCurrentTeam(s.id),Mr({title:"Team switched successfully"})}catch(s){console.error("Error switching team:",s),Mr({title:"Failed to switch team",variant:"destructive"})}},updateTeamName:async(t,r)=>{try{const s=await Ht(`/api/teams/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r})});if(!s.ok)throw new Error("Failed to update team name");const i=await s.json();n(a=>{a.currentTeam&&a.currentTeam.id===t&&(a.currentTeam.name=r);const o=a.userTeams.findIndex(l=>l.id===t);o!==-1&&(a.userTeams[o].name=r)}),Mr({title:"Team name updated"})}catch(s){throw console.error("Error updating team name:",s),Mr({title:"Failed to update team name",variant:"destructive"}),s}},updateInviteEnabled:async(t,r)=>{try{if(!(await Ht(`/api/teams/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({invite_enabled:r})})).ok)throw new Error("Failed to update invite settings");n(i=>{i.currentTeam&&i.currentTeam.id===t&&(i.currentTeam.invite_enabled=r)}),Mr({title:r?"Invites enabled":"Invites disabled"})}catch(s){throw console.error("Error updating invite settings:",s),Mr({title:"Failed to update invite settings",variant:"destructive"}),s}},removeMember:async(t,r)=>{try{const s=await Ht(`/api/teams/${t}/members/${r}`,{method:"DELETE"});if(!s.ok){const i=await s.json();throw new Error(i.error||"Failed to remove member")}await e().refreshTeam(),Mr({title:"Member removed"})}catch(s){throw console.error("Error removing member:",s),Mr({title:s instanceof Error?s.message:"Failed to remove member",variant:"destructive"}),s}},refreshTeam:async()=>{const t=e().currentTeam;if(t)try{const r=await Ht(`/api/teams/${t.id}`);if(!r.ok)throw new Error("Failed to refresh team");const s=await r.json();n(i=>{i.currentTeam=s.team})}catch(r){console.error("Error refreshing team:",r)}},isProTeam:()=>e().currentTeam?.team_type==="pro_team",isFreeTeam:()=>e().currentTeam?.team_type==="free_team",hasActiveSubscription:()=>{const t=e().currentTeam;return t?.team_type==="pro_team"&&t?.subscription_status==="active"},isTeamAdmin:t=>{const r=e().currentTeam;return r?r.members.find(i=>i.user_id===t)?.role==="admin":!1},isOnTrial:()=>e().currentTeam?.subscription_status==="trialing",getTrialDaysRemaining:()=>{const t=e().currentTeam;if(t?.subscription_status!=="trialing"||!t?.current_period_end)return null;const r=new Date(t.current_period_end),s=new Date,i=Math.ceil((r.getTime()-s.getTime())/(1e3*60*60*24));return Math.max(0,i)},getTrialEndDate:()=>{const t=e().currentTeam;return t?.subscription_status!=="trialing"||!t?.current_period_end?null:new Date(t.current_period_end)},reset:()=>{n(t=>{t.currentTeam=null,t.isLoading=!1,t.error=null,t.userTeams=[],t.isLoadingUserTeams=!1})}})))),K_e=n=>{const e=Ag(s=>s.fetchCurrentTeam),t=Ag(s=>s.fetchUserTeams),r=Ag(s=>s.reset);ve.useEffect(()=>{n?(e(n),t(n)):r()},[n,e,t,r])};Ws()(Ui(bi((n,e)=>({selectedFrames:[],selectedChildrenIds:[],selectedElementId:void 0,setSelectedFrames:t=>n(r=>{r.selectedFrames=t}),setSelectedChildrenIds:t=>n(r=>{r.selectedChildrenIds=t}),setSelectedElementId:t=>n(r=>{r.selectedElementId=t}),selectElement:(t,r,s=()=>!0,i=()=>{})=>{if(!s(t))return;const{addToSelection:o=!0,clearOthers:l=!1}=r||{},c=e(),{selectedFrames:u,selectedChildrenIds:f}=c;l?(n(m=>{m.selectedFrames=[t],m.selectedChildrenIds=[]}),i(t)):o?n(m=>{m.selectedFrames=[...u,t],m.selectedChildrenIds=[...f,t]}):(n(m=>{m.selectedFrames=[t],m.selectedChildrenIds=[t]}),i(t))},toggleElementSelection:(t,r=()=>!0)=>{if(!r(t))return;const i=e(),{selectedFrames:a,selectedChildrenIds:o}=i;a.includes(t)?n(l=>{l.selectedFrames=a.filter(c=>c!==t),l.selectedChildrenIds=o.filter(c=>c!==t)}):n(l=>{l.selectedFrames=[...a,t],l.selectedChildrenIds=[...o,t]})},clearSelection:()=>{n(t=>{t.selectedFrames=[],t.selectedChildrenIds=[]})},selectElementWithModifiers:(t,r,s=()=>!0,i=()=>{})=>{const a=e(),{selectedFrames:o}=a;s(t)&&(r?o.includes(t)?n(c=>{c.selectedFrames=o.filter(u=>u!==t),c.selectedChildrenIds=c.selectedChildrenIds.filter(u=>u!==t)}):n(c=>{c.selectedFrames=[...o,t],c.selectedChildrenIds=[...c.selectedChildrenIds,t]}):(n(c=>{c.selectedFrames=[t],c.selectedChildrenIds=[t]}),i(t)))},isElementSelected:t=>e().selectedFrames.includes(t),getSelectedCount:()=>e().selectedFrames.length,hasSelection:()=>e().selectedFrames.length>0}))));const ea=new Map,Yp=Ws()(bi((n,e)=>({activeJobs:{},startProcessing:async(t,r,s)=>{try{`${r}`,ea.set(r,s),`${r}${s.size}`,n(l=>{l.activeJobs[r]={elementId:t,recordingId:r,status:"uploading",progress:0,retryCount:0,maxRetries:3}});const i=new FormData;i.append("video",s),n(l=>{l.activeJobs[r]&&(l.activeJobs[r].status="processing",l.activeJobs[r].progress=50)});const a=await Ht(`/api/recordings/${r}/ai`,{method:"POST",body:i});if(!a.ok){const l=await a.text();throw new Error(l||"AI processing failed")}const o=await a.json();if(o.insights,o.insights?.transcript,o.insights?.transcript?.length,o.insights?.summary,o.success){n(b=>{b.activeJobs[r]&&(b.activeJobs[r].status=o.isEmpty?"empty":"completed",b.activeJobs[r].progress=100,b.activeJobs[r].insights=o.insights,b.activeJobs[r].isEmpty=o.isEmpty,b.activeJobs[r].retryCount=o.retryCount||0)}),`${r}`;const l=De.getState(),c=o.insights?.summary||"No insights detected",u=o.insights?.transcript,f={aiSummary:c,aiTranscript:u,aiProcessingStatus:o.isEmpty?"empty":"completed",hasAiInsights:!0,aiInsights:o.insights?{transcript:u,summary:c}:void 0};f.aiSummary,f.aiProcessingStatus;const m=l.timelineDraft;if(m){const b=m.attachments.find(x=>x.recordingId===r);if(b){l.updateDraftAttachment(b.id,f,"timeline"),ea.delete(r),setTimeout(()=>{Yp.getState().clearJob(r)},2e3);return}}const g=l.replyDrafts;for(const[b,x]of Object.entries(g)){const S=x.attachments.find(T=>T.recordingId===r);if(S){`${b}`,l.updateDraftAttachment(S.id,f,b),`${b}`,ea.delete(r),setTimeout(()=>{Yp.getState().clearJob(r)},2e3);return}}const y=Object.values(l.boardState.elements);for(const b of y)if(b.attachments?.find(S=>S.recordingId===r)){`${b.id}`;const S=b.attachments.map(T=>T.recordingId===r?{...T,...f}:T);await l.updateElement(b.id,{attachments:S});break}ea.delete(r),`${r}`,setTimeout(()=>{Yp.getState().clearJob(r)},2e3)}else throw new Error(o.error||"AI processing failed")}catch(i){console.error("[AIStore] Processing failed:",i);const a=ea.has(r);n(c=>{c.activeJobs[r]&&(c.activeJobs[r].status="failed",c.activeJobs[r].error=i instanceof Error?i.message:"Processing failed",c.activeJobs[r].retryable=a)});const o=De.getState();if(e().activeJobs[r]){const c=o.timelineDraft;if(c){const m=c.attachments.find(g=>g.recordingId===r);m&&o.updateDraftAttachment(m.id,{aiSummary:"Something went wrong in getting insights",aiProcessingStatus:"failed"},"timeline")}const u=o.replyDrafts;for(const[m,g]of Object.entries(u)){const y=g.attachments.find(b=>b.recordingId===r);y&&o.updateDraftAttachment(y.id,{aiSummary:"Something went wrong in getting insights",aiProcessingStatus:"failed"},m)}const f=Object.values(o.boardState.elements);for(const m of f)if(m.attachments?.find(y=>y.recordingId===r)){const y=m.attachments.map(b=>b.recordingId===r?{...b,aiSummary:"Something went wrong in getting insights",aiProcessingStatus:"failed"}:b);await o.updateElement(m.id,{attachments:y});break}}a||setTimeout(()=>{Yp.getState().clearJob(r)},5e3)}},updateRecordingId:(t,r)=>{const s=e().activeJobs[t];s&&n(a=>{a.activeJobs[r]={...s,recordingId:r},delete a.activeJobs[t]});const i=ea.get(t);i&&(ea.set(r,i),ea.delete(t))},retryProcessing:async t=>{const r=e().activeJobs[t],s=ea.get(t);if(!r||!s){console.error("[AIStore] Cannot retry: no job or blob found for recordingId:",t);return}n(i=>{i.activeJobs[t]&&(i.activeJobs[t].status="uploading",i.activeJobs[t].progress=0,i.activeJobs[t].error=void 0,i.activeJobs[t].retryCount=(i.activeJobs[t].retryCount||0)+1)}),await e().startProcessing(r.elementId,t,s)},updateJobStatus:(t,r)=>{n(s=>{s.activeJobs[t]&&Object.assign(s.activeJobs[t],r)})},clearJob:t=>{ea.delete(t),n(r=>{delete r.activeJobs[t]})},getJobState:t=>e().activeJobs[t],isProcessing:t=>{const r=e().activeJobs[t];return r!==void 0&&(r.status==="uploading"||r.status==="processing")},hasRetainedBlob:t=>ea.has(t)})));typeof window<"u"&&window.addEventListener("beforeunload",()=>{ea.clear()});const F2=Object.freeze(Object.defineProperty({__proto__:null,useAIStore:Yp},Symbol.toStringTag,{value:"Module"})),Y_e="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",X_e="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",qk="numeric",Wk="ascii",Kk="alpha",Rg="asciinumeric",Xp="alphanumeric",Yk="domain",zW="emoji",Q_e="scheme",Z_e="slashscheme",$A="whitespace";function J_e(n,e){return n in e||(e[n]=[]),e[n]}function sd(n,e,t){e[qk]&&(e[Rg]=!0,e[Xp]=!0),e[Wk]&&(e[Rg]=!0,e[Kk]=!0),e[Rg]&&(e[Xp]=!0),e[Kk]&&(e[Xp]=!0),e[Xp]&&(e[Yk]=!0),e[zW]&&(e[Yk]=!0);for(const r in e){const s=J_e(r,t);s.indexOf(n)<0&&s.push(n)}}function e1e(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function Li(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Li.groups={};Li.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(n))return i}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let s=0;s<n.length;s++)this.tt(n[s],e,t,r)},tr(n,e,t,r){r=r||Li.groups;let s;return e&&e.j?s=e:(s=new Li(e),t&&r&&sd(e,t,r)),this.jr.push([n,s]),s},ts(n,e,t,r){let s=this;const i=n.length;if(!i)return s;for(let a=0;a<i-1;a++)s=s.tt(n[a]);return s.tt(n[i-1],e,t,r)},tt(n,e,t,r){r=r||Li.groups;const s=this;if(e&&e.j)return s.j[n]=e,e;const i=e;let a,o=s.go(n);if(o?(a=new Li,Object.assign(a.j,o.j),a.jr.push.apply(a.jr,o.jr),a.jd=o.jd,a.t=o.t):a=new Li,i){if(r)if(a.t&&typeof a.t=="string"){const l=Object.assign(e1e(a.t,r),t);sd(i,l,r)}else t&&sd(i,t,r);a.t=i}return s.j[n]=a,a}};const Qt=(n,e,t,r,s)=>n.ta(e,t,r,s),ur=(n,e,t,r,s)=>n.tr(e,t,r,s),U5=(n,e,t,r,s)=>n.ts(e,t,r,s),qe=(n,e,t,r,s)=>n.tt(e,t,r,s),Sl="WORD",Xk="UWORD",GW="ASCIINUMERICAL",qW="ALPHANUMERICAL",Ev="LOCALHOST",Qk="TLD",Zk="UTLD",ox="SCHEME",Gh="SLASH_SCHEME",U2="NUM",Jk="WS",$2="NL",Cg="OPENBRACE",kg="CLOSEBRACE",jw="OPENBRACKET",Fw="CLOSEBRACKET",Uw="OPENPAREN",$w="CLOSEPAREN",Bw="OPENANGLEBRACKET",Hw="CLOSEANGLEBRACKET",Vw="FULLWIDTHLEFTPAREN",zw="FULLWIDTHRIGHTPAREN",Gw="LEFTCORNERBRACKET",qw="RIGHTCORNERBRACKET",Ww="LEFTWHITECORNERBRACKET",Kw="RIGHTWHITECORNERBRACKET",Yw="FULLWIDTHLESSTHAN",Xw="FULLWIDTHGREATERTHAN",Qw="AMPERSAND",Zw="APOSTROPHE",Jw="ASTERISK",Nc="AT",eE="BACKSLASH",tE="BACKTICK",nE="CARET",Bc="COLON",B2="COMMA",rE="DOLLAR",wo="DOT",sE="EQUALS",H2="EXCLAMATION",na="HYPHEN",Ig="PERCENT",iE="PIPE",aE="PLUS",oE="POUND",Lg="QUERY",V2="QUOTE",WW="FULLWIDTHMIDDLEDOT",z2="SEMI",Eo="SLASH",Dg="TILDE",lE="UNDERSCORE",KW="EMOJI",cE="SYM";var YW=Object.freeze({__proto__:null,ALPHANUMERICAL:qW,AMPERSAND:Qw,APOSTROPHE:Zw,ASCIINUMERICAL:GW,ASTERISK:Jw,AT:Nc,BACKSLASH:eE,BACKTICK:tE,CARET:nE,CLOSEANGLEBRACKET:Hw,CLOSEBRACE:kg,CLOSEBRACKET:Fw,CLOSEPAREN:$w,COLON:Bc,COMMA:B2,DOLLAR:rE,DOT:wo,EMOJI:KW,EQUALS:sE,EXCLAMATION:H2,FULLWIDTHGREATERTHAN:Xw,FULLWIDTHLEFTPAREN:Vw,FULLWIDTHLESSTHAN:Yw,FULLWIDTHMIDDLEDOT:WW,FULLWIDTHRIGHTPAREN:zw,HYPHEN:na,LEFTCORNERBRACKET:Gw,LEFTWHITECORNERBRACKET:Ww,LOCALHOST:Ev,NL:$2,NUM:U2,OPENANGLEBRACKET:Bw,OPENBRACE:Cg,OPENBRACKET:jw,OPENPAREN:Uw,PERCENT:Ig,PIPE:iE,PLUS:aE,POUND:oE,QUERY:Lg,QUOTE:V2,RIGHTCORNERBRACKET:qw,RIGHTWHITECORNERBRACKET:Kw,SCHEME:ox,SEMI:z2,SLASH:Eo,SLASH_SCHEME:Gh,SYM:cE,TILDE:Dg,TLD:Qk,UNDERSCORE:lE,UTLD:Zk,UWORD:Xk,WORD:Sl,WS:Jk});const gl=/[a-z]/,Lp=new RegExp("\\p{L}","u"),BA=new RegExp("\\p{Emoji}","u"),vl=/\d/,HA=/\s/,$5="\r",VA=`
`,t1e="",n1e="",zA="";let db=null,hb=null;function r1e(n=[]){const e={};Li.groups=e;const t=new Li;db==null&&(db=B5(Y_e)),hb==null&&(hb=B5(X_e)),qe(t,"'",Zw),qe(t,"{",Cg),qe(t,"}",kg),qe(t,"[",jw),qe(t,"]",Fw),qe(t,"(",Uw),qe(t,")",$w),qe(t,"<",Bw),qe(t,">",Hw),qe(t,"",Vw),qe(t,"",zw),qe(t,"",Gw),qe(t,"",qw),qe(t,"",Ww),qe(t,"",Kw),qe(t,"",Yw),qe(t,"",Xw),qe(t,"&",Qw),qe(t,"*",Jw),qe(t,"@",Nc),qe(t,"`",tE),qe(t,"^",nE),qe(t,":",Bc),qe(t,",",B2),qe(t,"$",rE),qe(t,".",wo),qe(t,"=",sE),qe(t,"!",H2),qe(t,"-",na),qe(t,"%",Ig),qe(t,"|",iE),qe(t,"+",aE),qe(t,"#",oE),qe(t,"?",Lg),qe(t,'"',V2),qe(t,"/",Eo),qe(t,";",z2),qe(t,"~",Dg),qe(t,"_",lE),qe(t,"\\",eE),qe(t,"",WW);const r=ur(t,vl,U2,{[qk]:!0});ur(r,vl,r);const s=ur(r,gl,GW,{[Rg]:!0}),i=ur(r,Lp,qW,{[Xp]:!0}),a=ur(t,gl,Sl,{[Wk]:!0});ur(a,vl,s),ur(a,gl,a),ur(s,vl,s),ur(s,gl,s);const o=ur(t,Lp,Xk,{[Kk]:!0});ur(o,gl),ur(o,vl,i),ur(o,Lp,o),ur(i,vl,i),ur(i,gl),ur(i,Lp,i);const l=qe(t,VA,$2,{[$A]:!0}),c=qe(t,$5,Jk,{[$A]:!0}),u=ur(t,HA,Jk,{[$A]:!0});qe(t,zA,u),qe(c,VA,l),qe(c,zA,u),ur(c,HA,u),qe(u,$5),qe(u,VA),ur(u,HA,u),qe(u,zA,u);const f=ur(t,BA,KW,{[zW]:!0});qe(f,"#"),ur(f,BA,f),qe(f,t1e,f);const m=qe(f,n1e);qe(m,"#"),ur(m,BA,f);const g=[[gl,a],[vl,s]],y=[[gl,null],[Lp,o],[vl,i]];for(let b=0;b<db.length;b++)bc(t,db[b],Qk,Sl,g);for(let b=0;b<hb.length;b++)bc(t,hb[b],Zk,Xk,y);sd(Qk,{tld:!0,ascii:!0},e),sd(Zk,{utld:!0,alpha:!0},e),bc(t,"file",ox,Sl,g),bc(t,"mailto",ox,Sl,g),bc(t,"http",Gh,Sl,g),bc(t,"https",Gh,Sl,g),bc(t,"ftp",Gh,Sl,g),bc(t,"ftps",Gh,Sl,g),sd(ox,{scheme:!0,ascii:!0},e),sd(Gh,{slashscheme:!0,ascii:!0},e),n=n.sort((b,x)=>b[0]>x[0]?1:-1);for(let b=0;b<n.length;b++){const x=n[b][0],T=n[b][1]?{[Q_e]:!0}:{[Z_e]:!0};x.indexOf("-")>=0?T[Yk]=!0:gl.test(x)?vl.test(x)?T[Rg]=!0:T[Wk]=!0:T[qk]=!0,U5(t,x,x,T)}return U5(t,"localhost",Ev,{ascii:!0}),t.jd=new Li(cE),{start:t,tokens:Object.assign({groups:e},YW)}}function XW(n,e){const t=s1e(e.replace(/[A-Z]/g,o=>o.toLowerCase())),r=t.length,s=[];let i=0,a=0;for(;a<r;){let o=n,l=null,c=0,u=null,f=-1,m=-1;for(;a<r&&(l=o.go(t[a]));)o=l,o.accepts()?(f=0,m=0,u=o):f>=0&&(f+=t[a].length,m++),c+=t[a].length,i+=t[a].length,a++;i-=f,a-=m,c-=f,s.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return s}function s1e(n){const e=[],t=n.length;let r=0;for(;r<t;){let s=n.charCodeAt(r),i,a=s<55296||s>56319||r+1===t||(i=n.charCodeAt(r+1))<56320||i>57343?n[r]:n.slice(r,r+2);e.push(a),r+=a.length}return e}function bc(n,e,t,r,s){let i;const a=e.length;for(let o=0;o<a-1;o++){const l=e[o];n.j[l]?i=n.j[l]:(i=new Li(r),i.jr=s.slice(),n.j[l]=i),n=i}return i=new Li(t),i.jr=s.slice(),n.j[e[a-1]]=i,i}function B5(n){const e=[],t=[];let r=0,s="0123456789";for(;r<n.length;){let i=0;for(;s.indexOf(n[r+i])>=0;)i++;if(i>0){e.push(t.join(""));for(let a=parseInt(n.substring(r,r+i),10);a>0;a--)t.pop();r+=i}else t.push(n[r]),r++}return e}const Sv={defaultProtocol:"http",events:null,format:H5,formatHref:H5,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function G2(n,e=null){let t=Object.assign({},Sv);n&&(t=Object.assign(t,n instanceof G2?n.o:n));const r=t.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=s}G2.prototype={o:Sv,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=t.t in s?s[t.t]:Sv[n],typeof s=="function"&&r&&(s=s(e,t))):typeof s=="function"&&r&&(s=s(e,t.t,t)),s)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function H5(n){return n}function QW(n,e){this.t="token",this.v=n,this.tk=e}QW.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Sv.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),s=n.get("tagName",t,e),i=this.toFormattedString(n),a={},o=n.get("className",t,e),l=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),f=n.getObj("events",t,e);return a.href=r,o&&(a.class=o),l&&(a.target=l),c&&(a.rel=c),u&&Object.assign(a,u),{tagName:s,attributes:a,content:i,eventListeners:f}}};function OS(n,e){class t extends QW{constructor(s,i){super(s,i),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const V5=OS("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),z5=OS("text"),i1e=OS("nl"),fb=OS("url",{isLink:!0,toHref(n=Sv.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Ev&&n[1].t===Bc}}),Qi=n=>new Li(n);function a1e({groups:n}){const e=n.domain.concat([Qw,Jw,Nc,eE,tE,nE,rE,sE,na,U2,Ig,iE,aE,oE,Eo,cE,Dg,lE]),t=[Zw,Bc,B2,wo,H2,Ig,Lg,V2,z2,Bw,Hw,Cg,kg,Fw,jw,Uw,$w,Vw,zw,Gw,qw,Ww,Kw,Yw,Xw],r=[Qw,Zw,Jw,eE,tE,nE,rE,sE,na,Cg,kg,Ig,iE,aE,oE,Lg,Eo,cE,Dg,lE],s=Qi(),i=qe(s,Dg);Qt(i,r,i),Qt(i,n.domain,i);const a=Qi(),o=Qi(),l=Qi();Qt(s,n.domain,a),Qt(s,n.scheme,o),Qt(s,n.slashscheme,l),Qt(a,r,i),Qt(a,n.domain,a);const c=qe(a,Nc);qe(i,Nc,c),qe(o,Nc,c),qe(l,Nc,c);const u=qe(i,wo);Qt(u,r,i),Qt(u,n.domain,i);const f=Qi();Qt(c,n.domain,f),Qt(f,n.domain,f);const m=qe(f,wo);Qt(m,n.domain,f);const g=Qi(V5);Qt(m,n.tld,g),Qt(m,n.utld,g),qe(c,Ev,g);const y=qe(f,na);qe(y,na,y),Qt(y,n.domain,f),Qt(g,n.domain,f),qe(g,wo,m),qe(g,na,y);const b=qe(g,Bc);Qt(b,n.numeric,V5);const x=qe(a,na),S=qe(a,wo);qe(x,na,x),Qt(x,n.domain,a),Qt(S,r,i),Qt(S,n.domain,a);const T=Qi(fb);Qt(S,n.tld,T),Qt(S,n.utld,T),Qt(T,n.domain,a),Qt(T,r,i),qe(T,wo,S),qe(T,na,x),qe(T,Nc,c);const _=qe(T,Bc),R=Qi(fb);Qt(_,n.numeric,R);const I=Qi(fb),C=Qi();Qt(I,e,I),Qt(I,t,C),Qt(C,e,I),Qt(C,t,C),qe(T,Eo,I),qe(R,Eo,I);const L=qe(o,Bc),k=qe(l,Bc),M=qe(k,Eo),D=qe(M,Eo);Qt(o,n.domain,a),qe(o,wo,S),qe(o,na,x),Qt(l,n.domain,a),qe(l,wo,S),qe(l,na,x),Qt(L,n.domain,I),qe(L,Eo,I),qe(L,Lg,I),Qt(D,n.domain,I),Qt(D,e,I),qe(D,Eo,I);const U=[[Cg,kg],[jw,Fw],[Uw,$w],[Bw,Hw],[Vw,zw],[Gw,qw],[Ww,Kw],[Yw,Xw]];for(let $=0;$<U.length;$++){const[V,B]=U[$],W=qe(I,V);qe(C,V,W),qe(W,B,I);const F=Qi(fb);Qt(W,e,F);const j=Qi();Qt(W,t),Qt(F,e,F),Qt(F,t,j),Qt(j,e,F),Qt(j,t,j),qe(F,B,I),qe(j,B,I)}return qe(s,Ev,T),qe(s,$2,i1e),{start:s,tokens:YW}}function o1e(n,e,t){let r=t.length,s=0,i=[],a=[];for(;s<r;){let o=n,l=null,c=null,u=0,f=null,m=-1;for(;s<r&&!(l=o.go(t[s].t));)a.push(t[s++]);for(;s<r&&(c=l||o.go(t[s].t));)l=null,o=c,o.accepts()?(m=0,f=o):m>=0&&m++,s++,u++;if(m<0)s-=u,s<r&&(a.push(t[s]),s++);else{a.length>0&&(i.push(GA(z5,e,a)),a=[]),s-=m,u-=m;const g=f.t,y=t.slice(s-u,s);i.push(GA(g,e,y))}}return a.length>0&&i.push(GA(z5,e,a)),i}function GA(n,e,t){const r=t[0].s,s=t[t.length-1].e,i=e.slice(r,s);return new n(i,t)}const As={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function l1e(){As.scanner=r1e(As.customSchemes);for(let n=0;n<As.tokenQueue.length;n++)As.tokenQueue[n][1]({scanner:As.scanner});As.parser=a1e(As.scanner.tokens);for(let n=0;n<As.pluginQueue.length;n++)As.pluginQueue[n][1]({scanner:As.scanner,parser:As.parser});return As.initialized=!0,As}function ZW(n){return As.initialized||l1e(),o1e(As.parser.start,n,XW(As.scanner.start,n))}ZW.scan=XW;function c1e(n,e,t){const r=ZW(n),s=[];for(let i=0;i<r.length;i++){const a=r[i];if(a.t==="nl"&&e.get("nl2br")){const o=`__linkify-el-${t.elementId++}`;s.push(E.createElement("br",{key:o}))}else if(!a.isLink||!e.check(a))s.push(a.toString());else{let o=e.render(a);if(!("key"in o.props)){const l=`__linkify-el-${t.elementId++}`,c=Object.assign({key:l},o.props);o=E.cloneElement(o,c)}s.push(o)}}return s}function JW(n,e,t){if(E.Children.count(n.props.children)===0)return n;const r=[];E.Children.forEach(n.props.children,a=>{typeof a=="string"?r.push.apply(r,c1e(a,e,t)):E.isValidElement(a)?typeof a.type=="string"&&e.ignoreTags.indexOf(a.type.toUpperCase())>=0?r.push(a):r.push(JW(a,e,t)):r.push(a)});const s=`__linkify-el-${t.elementId++}`,i=Object.assign({key:s},n.props);return E.cloneElement(n,i,r)}const eK=n=>{let e=0;const t=({tagName:l,attributes:c,content:u})=>(c.key=`__linkify-lnk-${e++}`,c.class&&(c.className=c.class,delete c.class),E.createElement(l,c,u)),r={key:"__linkify-wrapper"};for(const l in n)l!=="options"&&l!=="as"&&l!=="tagName"&&l!=="children"&&(r[l]=n[l]);const s=new G2(n.options,t),i=n.as||n.tagName||E.Fragment||"span",a=n.children,o=E.createElement(i,r,a);return JW(o,s,{elementId:0})},G5=new Map;function u1e(n){const[e,t]=E.useState(null),[r,s]=E.useState(!1),[i,a]=E.useState(null);return E.useEffect(()=>{if(!n){t(null);return}const l=G5.get(n);if(l){t(l);return}(async()=>{s(!0),a(null);try{const u=await fetch(`https://image.mux.com/${n}/storyboard.json`);if(!u.ok)throw new Error(`Failed to fetch storyboard: ${u.statusText}`);const f=await u.json(),m=new Image;m.onload=()=>{f.spriteSheetWidth=m.width,f.spriteSheetHeight=m.height,G5.set(n,f),t(f)},m.onerror=()=>{a(new Error("Failed to load sprite sheet image"))},m.src=f.url}catch(u){a(u instanceof Error?u:new Error("Unknown error"))}finally{s(!1)}})()},[n]),{storyboard:e,isLoading:r,error:i,getTileForTime:l=>{if(!e||!e.tiles.length)return null;const c=Math.max(0,Math.min(l,e.duration));let u=e.tiles[0];for(let f=0;f<e.tiles.length;f++){const m=e.tiles[f],g=e.tiles[f+1];if(c>=m.start&&(!g||c<g.start)){u=m;break}}return u}}}const d1e=({text:n,disabled:e=!1,speed:t=5,className:r=""})=>{const s=`${t}s`;return d.jsx("div",{className:`shiny-text ${e?"disabled":""} ${r}`,style:{animationDuration:s},children:n})},h1e=({attachment:n,elementId:e,hasEditingPermissions:t,containerRef:r,isSelected:s=!1,isHovered:i=!1,isReplyElement:a=!1})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[f,m]=E.useState(!1),[g,y]=E.useState(!1),[b,x]=E.useState(!1),[S,T]=E.useState(!1),_=cn(be=>be.user),R=De(be=>be.deleteAttachmentWithConfirmation),C=De(be=>{const Ae=be.getDraftElement();if(Ae&&Ae.id===e)return Ae.attachments.find(Ue=>Ue.id===n.id);const Me=be.boardState.elements[e];if(Me?.attachments)return Me.attachments.find(Ue=>Ue.id===n.id)})||n,L=vs(be=>be.getElementState(n.id)),k=ln(be=>be.uploadQueue.find(Ae=>Ae.elementId===n.id||Ae.elementId===n.recordingId)),M=k?.progress??C.uploadProgress??0,D=k?.status==="uploading"||k?.status==="queued",[U,$]=E.useState(0),[V,B]=E.useState(0),W=He(be=>be.setActiveRecording),F=He(be=>be.setRecordingFullscreen),j=E.useCallback(()=>{const be=C.videoUrl||L?.videoUrl;if(n.id,C.videoUrl,L?.videoUrl,C.recordingType,be){const Ae=te.current?.getBoundingClientRect()||null;W(n.id,be,Ae,e),F(!0)}},[n.id,e,C.videoUrl,C.recordingType,L?.videoUrl,W,F]),q=(()=>{const be=C.videoUrl;return be?"completed":C.recordingState==="error"?"error":C.recordingState==="completed"&&be?"completed":"loading"})();L?.state==="preparing"?U:D&&M>0?10+M*.7:C.recordingState==="processing"?80+V*.2:U,E.useEffect(()=>{if(L?.state==="preparing"&&L.preparingStartTime){const be=L.preparingStartTime,Ae=5e3,Me=setInterval(()=>{const Ue=Date.now()-be,Ge=Math.min(Ue/Ae*10,10);$(Ge),Ge>=10&&clearInterval(Me)},50);return()=>clearInterval(Me)}},[L?.state,L?.preparingStartTime]),E.useEffect(()=>{if(C.recordingState==="processing"){const be=Date.now(),Ae=C.duration&&C.duration>=60?2e4:1e4,Me=setInterval(()=>{const Ue=Date.now()-be,Ge=Math.min(Ue/Ae*100,100);B(Ge),Ge>=100&&clearInterval(Me)},50);return()=>clearInterval(Me)}else B(0)},[C.recordingState,C.duration]),ve.useEffect(()=>{if(L?.state==="uploading"&&M===0&&!o){const be=setTimeout(()=>l(!0),800);return()=>clearTimeout(be)}},[L?.state,M,o]);const N=C.videoUrl||L?.videoUrl,O=C.thumbnailUrl,z=ve.useMemo(()=>{if(!O)return null;const be=O.match(/image\.mux\.com\/([^/]+)\//);return be?be[1]:null},[O]),{storyboard:G,getTileForTime:Y}=u1e(z),[Q,J]=E.useState(null),[ee,oe]=E.useState(null),te=E.useRef(null),[se,he]=E.useState({width:1,height:1}),Z=Q!==null&&G?Y(Q):null;E.useEffect(()=>{const be=()=>{if(te.current){const{clientWidth:Me,clientHeight:Ue}=te.current;he({width:Me||1,height:Ue||1})}};be();const Ae=new ResizeObserver(be);return te.current&&Ae.observe(te.current),()=>Ae.disconnect()},[G]);const pe=be=>{if(!z||!C.duration||!te.current)return;const Ae=te.current.getBoundingClientRect(),Me=be.clientX-Ae.left,Ue=Math.max(0,Math.min(1,Me/Ae.width)),Ge=Ue*C.duration;J(Ge),oe(Ue*100)},ye=()=>{J(null),oe(null)},ae=be=>{if(!be||!isFinite(be))return"0:00";const Ae=Math.floor(be/60),Me=Math.floor(be%60);return`${Ae}:${Me.toString().padStart(2,"0")}`},le=E.useRef(null),[ie,fe]=E.useState(!1);E.useEffect(()=>{const be=le.current,Ae=k?.localBlobUrl||L?.localBlobUrl;if(!be||!Ae)return;const Me=()=>{const Ge=be.duration;Number.isFinite(Ge)&&Ge>0&&Ge!==1/0&&(be.currentTime=Ge/2)},Ue=()=>fe(!0);return be.addEventListener("canplay",Me,{once:!0}),be.addEventListener("error",Ue),be.src=Ae,be.load(),()=>{be.removeEventListener("canplay",Me),be.removeEventListener("error",Ue)}},[k?.localBlobUrl,L?.localBlobUrl]);const[Ie,ne]=E.useState(!1),ce=E.useRef(!1),Ce=E.useRef("");E.useEffect(()=>{const be=C.aiProcessingStatus==="processing",Ae=C.aiSummary||"";be?ce.current=!0:ce.current&&Ae&&Ae!==Ce.current?(ne(!0),Ce.current=Ae,ce.current=!1,setTimeout(()=>{ne(!1)},3e3)):Ae&&!Ce.current&&(Ce.current=Ae)},[C.aiProcessingStatus,C.aiSummary]);const Oe=E.useCallback(()=>{x(!1),R(e,n.id)},[R,e,n.id]),ze=E.useCallback(()=>{x(!1),T(!S)},[S]),We=De(be=>{const Ae=be.boardState.elements[e];if(Ae)return Ae;const Me=be.getDraftElement();return Me&&Me.id===e?Me:null}),tt=E.useCallback(async()=>{if(!C.recordingId)return;const be={aiProcessingStatus:"processing",aiSummary:void 0,aiTranscript:void 0};await De.getState().updateElement(e,{attachments:We?.attachments?.map(Ue=>Ue.id===n.id?{...Ue,...be}:Ue)});const{useAIStore:Me}=await Ze(async()=>{const{useAIStore:Ue}=await Promise.resolve().then(()=>F2);return{useAIStore:Ue}},void 0);await Me.getState().retryProcessing(C.recordingId)},[C.recordingId,e,n.id,We?.attachments]),lt=E.useCallback(async()=>{const be={aiProcessingStatus:"empty",aiSummary:void 0,aiTranscript:void 0};await De.getState().updateElement(e,{attachments:We?.attachments?.map(Me=>Me.id===n.id?{...Me,...be}:Me)})},[e,n.id,We?.attachments]);_?.id,We?.createdBy;const Ee=t;return d.jsxs("div",{className:"w-full flex flex-col rounded-2xl bg-card-background/50 shadow-sm p-1 element-border pt-0 shadow-black/50 relative",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:[Ee&&d.jsx("div",{className:`absolute bottom-2 right-2 z-[80] transition-opacity duration-200 ${g||b?"opacity-100":"opacity-0"}`,children:d.jsxs("div",{className:"flex items-center bg-card-background/70 backdrop-blur-lg element-border rounded-full overflow-hidden",onMouseEnter:()=>y(!0),children:[d.jsxs("button",{className:"flex items-center gap-1.5 h-[30px] px-2.5 hover:bg-border/30 transition-colors",onClick:j,onMouseDown:be=>be.stopPropagation(),children:[q==="loading"||C.aiProcessingStatus==="processing"?d.jsxs("svg",{className:"w-3.5 h-3.5 text-text-secondary animate-spin",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):d.jsx("svg",{className:"w-3.5 h-3.5 text-text-secondary hover:text-text-primary transition-colors duration-100",fill:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{d:"M8 5v14l11-7z"})}),C.duration&&d.jsx("span",{className:"text-xs text-text-secondary hover:text-text-primary transition-colors duration-100 font-mono",children:ae(C.duration)})]}),d.jsx("div",{className:"h-[18px] w-[1px] bg-border/30"}),d.jsxs(Gs,{modal:!1,open:b,onOpenChange:x,children:[d.jsx(qs,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-[30px] w-[30px] hover:bg-border/30 transition-colors",onMouseDown:be=>be.stopPropagation(),onClick:be=>be.stopPropagation(),children:d.jsx(cw,{size:14,className:"text-text-secondary hover:text-text-primary transition-colors duration-100"})})}),d.jsxs(Ms,{align:"end",side:"bottom",sideOffset:8,alignOffset:0,className:"min-w-[160px] z-[100] bg-card-background",onMouseDown:be=>be.stopPropagation(),onClick:be=>be.stopPropagation(),avoidCollisions:!0,collisionPadding:8,children:[C.aiSummary&&C.aiTranscript&&d.jsx("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:ze,children:d.jsx("span",{children:S?"Show Summary":"Show Transcript"})}),d.jsx("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:Oe,children:d.jsx("span",{children:"Delete"})})]})]})]})}),d.jsxs("div",{className:"w-full pt-1 px-3",children:[C.aiProcessingStatus==="processing"&&d.jsx("div",{className:"flex items-center py-2 gap-2",children:d.jsx(d1e,{text:"Compiling insights..",disabled:!1,speed:3,className:"text-xs text-text-primary"})}),C.aiProcessingStatus==="completed"&&d.jsx("div",{className:"text-xs text-text-primary py-1 leading-relaxed cursor-text",style:{userSelect:"text",WebkitUserSelect:"text",MozUserSelect:"text",msUserSelect:"text"},onMouseDown:be=>be.stopPropagation(),children:S&&C.aiTranscript?d.jsx("div",{className:"whitespace-pre-wrap",children:C.aiTranscript}):C.aiSummary?d.jsx(d.Fragment,{children:C.aiSummary.split(`
`).map((be,Ae)=>{if(!be.trim())return null;if(Ie){const Me=be.split(" ").filter(Ue=>Ue.trim());return d.jsx("div",{className:"mb-1",children:Me.map((Ue,Ge)=>d.jsxs(Ka.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:Ae*.15+Ge*.09,duration:.45},children:[Ue," "]},Ge))},Ae)}else return d.jsx("div",{className:"mb-1",children:be},Ae)})}):null}),C.aiProcessingStatus==="empty"&&d.jsx("div",{className:"text-xs text-text-secondary/50 italic py-1",children:"No insights detected"}),C.aiProcessingStatus==="failed"&&d.jsxs("div",{className:"text-xs py-1",children:[d.jsx("div",{className:"text-text-secondary/70 mb-1",children:"Something went wrong in summarizing recording."}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:tt,className:"text-text-secondary hover:text-text-primary underline transition-colors",children:"Try again"}),d.jsx("span",{className:"text-text-secondary/50",children:""}),d.jsx("button",{onClick:lt,className:"text-text-secondary hover:text-text-primary underline transition-colors",children:"Dismiss"})]})]})]}),d.jsx("div",{className:"w-full aspect-[16/9] relative",children:d.jsxs("div",{className:"absolute inset-0 h-full w-full overflow-hidden rounded-md flex flex-col",children:[q==="completed"&&N&&d.jsx("div",{className:"flex-1 relative",children:d.jsxs("div",{ref:te,className:"absolute inset-0 z-[70] cursor-pointer",onMouseLeave:ye,onMouseMove:pe,onClick:j,children:[G&&(()=>{const be=Z||G.tiles[Math.floor(G.tiles.length/2)];if(!be)return console.warn("[RecordingAttachment] No display tile found",{storyboard:G,currentTile:Z}),null;const Ae=se.width,Me=se.height,Ue=Ae/G.tile_width,Ge=Me/G.tile_height,Ke=Math.max(Ue,Ge),Qe=(G.spriteSheetWidth||0)*Ke,ht=(G.spriteSheetHeight||0)*Ke,Vt=be.x*Ke,mn=be.y*Ke;return d.jsx("div",{className:"w-full h-full overflow-hidden",style:{backgroundImage:`url(${G.url})`,backgroundSize:`${Qe}px ${ht}px`,backgroundPosition:`-${Vt}px -${mn}px`,backgroundRepeat:"no-repeat"}})})(),!G&&O&&d.jsx("img",{src:O,alt:"Recording thumbnail",className:"w-full h-full object-cover"}),!G&&!O&&d.jsx("div",{className:"w-full h-full bg-black/10"}),d.jsx(Ed,{children:ee!==null&&d.jsx(Ka.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"absolute top-0 bottom-0 w-[2px] bg-white/20 pointer-events-none z-[80] shadow-lg",style:{left:`${ee}%`}})})]})}),q==="loading"&&d.jsx("div",{className:"absolute inset-0 flex flex-col",children:d.jsxs("div",{className:"flex-1 relative",children:[(k?.localBlobUrl||L?.localBlobUrl)&&!ie&&d.jsx("video",{ref:le,className:"w-full h-full object-cover absolute inset-0",muted:!0,playsInline:!0,preload:"auto"}),d.jsx("div",{className:"absolute inset-0 bg-black/20"})]})}),q==="error"&&d.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:d.jsxs("div",{className:"text-white text-center p-6 max-w-sm",children:[d.jsx("p",{className:"text-lg font-medium mb-2",children:"Upload Failed"}),d.jsx("p",{className:"text-sm text-white/80",children:L?.errorMessage||"An error occurred"})]})})]})})]})},f1e=({attachment:n,elementId:e,hasEditingPermissions:t,containerRef:r,isSelected:s=!1,isHovered:i=!1,isReplyElement:a=!1})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[f,m]=E.useState(!1),g=E.useRef(null);cn(k=>k.user);const y=De(k=>k.deleteAttachmentWithConfirmation),b=He(k=>k.setActiveImage),S=De(k=>{const M=k.getDraftElement();if(M&&M.id===e)return M.attachments?.find(U=>U.id===n.id);const D=k.boardState.elements[e];if(D?.attachments)return D.attachments.find(U=>U.id===n.id)})||n,T=ln(k=>k.uploadQueue.find(M=>M.attachmentId===n.id)),_=T?.status==="uploading"||T?.status==="queued",R=(()=>{const k=S.imageUrl;return k&&!_?"completed":T?.status==="failed"?"error":_?"loading":k?"completed":"loading"})(),I=E.useCallback(()=>{u(!1),y(e,n.id)},[y,e,n.id]),C=E.useCallback(()=>{if(S.imageUrl&&!f&&R==="completed"){const k=g.current?.getBoundingClientRect()||null;b(S.imageUrl,k)}},[S.imageUrl,f,R,b]),L=t;return d.jsx(d.Fragment,{children:d.jsxs("div",{className:"w-full flex flex-col rounded-2xl bg-card-background/50 shadow-sm p-1 element-border pt-0 shadow-black/50 relative",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[L&&d.jsx("div",{className:`absolute bottom-2 right-2 z-[80] transition-opacity duration-200 ${o||c?"opacity-100":"opacity-0"}`,children:d.jsxs("div",{className:"flex items-center bg-card-background/70 backdrop-blur-lg element-border rounded-full overflow-hidden",onMouseEnter:()=>l(!0),children:[R==="loading"&&d.jsxs(d.Fragment,{children:[d.jsx("button",{className:"flex items-center gap-1.5 h-[30px] px-2.5 hover:bg-border/30 transition-colors",onClick:C,onMouseDown:k=>k.stopPropagation(),children:d.jsxs("svg",{className:"w-3.5 h-3.5 text-text-secondary animate-spin",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),d.jsx("div",{className:"h-[18px] w-[1px] bg-border/30"})]}),d.jsxs(Gs,{modal:!1,open:c,onOpenChange:u,children:[d.jsx(qs,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-[30px] w-[30px] hover:bg-border/30 transition-colors",onMouseDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:d.jsx(cw,{size:14,className:"text-text-secondary hover:text-text-primary transition-colors duration-100"})})}),d.jsx(Ms,{align:"end",side:"bottom",sideOffset:8,alignOffset:0,className:"min-w-[160px] z-[100] bg-card-background",onMouseDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),avoidCollisions:!0,collisionPadding:8,children:d.jsx("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:I,children:d.jsx("span",{children:"Delete"})})})]})]})}),d.jsx("div",{className:"w-full aspect-square relative",children:d.jsxs("div",{className:"absolute inset-0 h-full w-full overflow-hidden rounded-md flex flex-col",children:[R==="completed"&&S.imageUrl&&d.jsx("div",{ref:g,className:"flex-1 relative cursor-pointer",onClick:C,children:d.jsx("img",{src:S.imageUrl,alt:"Attachment",className:"w-full h-full object-cover",onError:()=>m(!0),loading:"lazy"})}),R==="loading"&&d.jsxs("div",{className:"flex-1 relative",children:[S.imageUrl&&d.jsx("img",{src:S.imageUrl,alt:"Uploading...",className:"w-full h-full object-cover"}),!S.imageUrl&&d.jsx("div",{className:"w-full h-full bg-border/20 animate-pulse"})]}),R==="error"&&d.jsxs("div",{className:"flex-1 relative bg-red-500/10 flex flex-col items-center justify-center",children:[d.jsx("div",{className:"text-sm text-red-400",children:"Failed to upload image"}),d.jsx("div",{className:"text-xs text-red-400/70 mt-1",children:T?.error||"Unknown error"})]})]})})]})})},tK=({attachments:n,elementId:e,hasEditingPermissions:t,isSelected:r=!1,isHovered:s=!1,isReplyElement:i=!1})=>{const a=E.useRef(null),o=n.filter(u=>u.type==="recording"),l=n.filter(u=>u.type==="image"),c=n.filter(u=>u.type!=="recording"&&u.type!=="image");return d.jsxs("div",{ref:a,className:"flex flex-col gap-2",children:[o.map(u=>d.jsx(h1e,{attachment:u,elementId:e,hasEditingPermissions:t,containerRef:a,isSelected:r,isHovered:s,isReplyElement:i},u.id)),l.length>0&&d.jsx("div",{className:"grid grid-cols-2 gap-1",children:l.map(u=>d.jsx(f1e,{attachment:u,elementId:e,hasEditingPermissions:t,containerRef:a,isSelected:r,isHovered:s,isReplyElement:i},u.id))}),c.map(u=>{switch(u.type){case"file":return d.jsxs("div",{className:"attachment-file p-2 border border-white/10 rounded",children:[d.jsx("div",{className:"text-xs text-white/50",children:"File attachment (coming soon)"}),u.fileName&&d.jsx("div",{className:"mt-1 text-xs text-white",children:u.fileName})]},u.id);default:return d.jsx("div",{className:"attachment-unknown p-2 border border-red-500/50 rounded",children:d.jsxs("div",{className:"text-xs text-red-400",children:["Unknown attachment type: ",u.type]})},u.id)}})]})},m1e=({element:n,hasEditingPermissions:e,isSelected:t,containerRef:r,isReplyElement:s=!1})=>{const i=cn(T=>T.user),a=De(T=>T.isElementInTextEditMode),o=De(T=>T.exitTextEditMode),l=De(T=>T.updateElement),c=De(T=>T.boardState.elements[n.id]);i?.id,n.createdBy;const u=a(n.id),f=E.useRef(null),m=E.useRef(!1),g=c?.content||"",y=c?.attachments||[];E.useEffect(()=>{n.type==="recording"&&(n.id,y.length,c?.type)},[n.id,n.type,y.length,c]),E.useEffect(()=>{if(u&&f.current){const T=f.current;T.textContent=g,setTimeout(()=>{T.focus();const _=window.getSelection();if(!_)return;const R=document.createRange();R.selectNodeContents(T),R.collapse(!1),_.removeAllRanges(),_.addRange(R)},0)}},[u,g,n.id]);const b=E.useCallback(()=>{if(u&&f.current&&!m.current){m.current=!0;try{const T=f.current.textContent||f.current.innerText||"";l(n.id,{content:T}),o(),f.current.blur();const _=window.getSelection();_&&_.removeAllRanges()}finally{m.current=!1}}},[u,l,n.id,o]);E.useEffect(()=>{const T=_=>{u&&!m.current&&r.current&&!r.current.contains(_.target)&&b()};return u&&document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[u,b,r,n.id]),E.useEffect(()=>{!t&&u&&!m.current&&b()},[t,u,b]);const x=T=>{let _=T.target;for(;_&&_!==f.current;){if(_.tagName==="A")return;_=_.parentElement}u&&f.current?.contains(T.target)&&T.stopPropagation()},S={target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline"};return d.jsxs("div",{className:je("relative text-left w-full",u&&"bg-card-background/50 p-2 !rounded-2xl border-b border-white/10"),onClick:x,children:[(g||u)&&d.jsxs("div",{className:"w-full mb-2 mt-1",children:[u&&d.jsx("div",{ref:f,contentEditable:!0,suppressContentEditableWarning:!0,className:je("text-white w-full focus:outline-none whitespace-pre-wrap overflow-hidden max-h-fit text-editing"),"data-placeholder":"Add text..",style:{fontSize:"12px",outline:"none",whiteSpace:"pre-wrap",wordBreak:"break-word",border:"none",margin:0,padding:0,minHeight:"1.5em",userSelect:"text",WebkitUserSelect:"text",overflowY:"auto"},onBlur:()=>{m.current||setTimeout(b,0)}}),!u&&d.jsx("div",{className:je("text-white w-full whitespace-pre-wrap overflow-hidden max-h-fit text-display"),style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word",margin:0,padding:"4px 4px",minHeight:"1.5em",overflowY:"auto",userSelect:"text",WebkitUserSelect:"text",cursor:"default"},children:d.jsx("span",{style:{cursor:"text"},children:d.jsx(eK,{options:S,children:g})})}),u&&d.jsx("div",{className:"flex justify-end mt-2",children:d.jsx("button",{className:"flex button-primary items-center gap-1 justify-center h-7 w-7 text-xs rounded-full transition-colors",onClick:T=>{T.stopPropagation(),b()},onMouseDown:T=>T.stopPropagation(),children:d.jsx(is,{className:"w-5 h-5"})})})]}),y.length>0&&d.jsx("div",{className:"element-attachments mt-2",children:d.jsx(tK,{attachments:y,elementId:n.id,hasEditingPermissions:e,isSelected:t,isHovered:!1,isReplyElement:s})})]})},p1e=n=>{const e=n.trim().split(" ");return e.length>1?`${e[0][0]}${e[e.length-1][0]}`.toUpperCase():n.substring(0,2).toUpperCase()},q5={"accent-purple":"#a78bfa","accent-blue":"#60a5fa","accent-teal":"#5eead4","accent-green":"#4ade80","accent-lime":"#bef264","accent-orange":"#fdba74","accent-red":"#f87171","accent-gray":"#a1a1aa","no-tags-color":"#6b7280",transparent:"transparent",apptag:"#71717D"},Bs=({image:n,text:e,children:t,type:r,appTagType:s,color:i="border",className:a,showRemove:o=!1,onRemove:l,isRemovable:c=!0,icon:u,showNewIndicator:f=!1})=>{const m=S=>{const T=q5[S]||q5["accent-gray"];return{background:`linear-gradient(${T}30, ${T}20), var(--card-background)`,border:`0.5px solid ${T}2s0`,borderTop:`0.5px solid ${T}50`,boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",color:T}};let g=e;r==="person"&&e&&e.includes("@")&&(g=e.split("@")[0]);const y=r==="apptag",b=y?"apptag":i,x=o&&l&&c;return d.jsxs("div",{className:je("inline-flex items-center gap-1.5 px-2 py-1 rounded-full font-normal shadow-sm shadow-black/20 relative",(r==="tag"||y)&&"element-tag",a),style:(r==="tag"||y)&&b?m(b):{},children:[f&&d.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full border border-card-background"}),(r==="person"||y&&s==="creator")&&d.jsxs(sD,{className:"h-4 w-4 -ml-1",children:[n&&d.jsx(iD,{src:n,alt:g||"",className:"h-full w-full object-cover"}),d.jsx(aD,{className:"text-[8px] font-medium bg-current text-current border-0 -ml-1",children:p1e(g||"")})]}),u&&d.jsx("span",{className:"flex items-center opacity-60",children:u}),d.jsx("span",{className:je("text-xs whitespace-nowrap",r==="person"&&"text-text-primary",y&&s==="linkTime"&&"font-mono",y&&"text-zinc-400"),children:t||g}),x&&d.jsx("button",{className:"flex items-center justify-center hover:opacity-70 transition-opacity",onClick:S=>{S.preventDefault(),S.stopPropagation(),l(S)},onMouseDown:S=>{S.preventDefault(),S.stopPropagation()},children:d.jsx($o,{size:12})})]})};var nK="AlertDialog",[g1e,xje]=Ns(nK,[o7]),Gl=o7(),rK=n=>{const{__scopeAlertDialog:e,...t}=n,r=Gl(e);return d.jsx(S7,{...r,...t,modal:!0})};rK.displayName=nK;var v1e="AlertDialogTrigger",y1e=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=Gl(t);return d.jsx(T7,{...s,...r,ref:e})});y1e.displayName=v1e;var b1e="AlertDialogPortal",sK=n=>{const{__scopeAlertDialog:e,...t}=n,r=Gl(e);return d.jsx(_7,{...r,...t})};sK.displayName=b1e;var x1e="AlertDialogOverlay",iK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=Gl(t);return d.jsx(bD,{...s,...r,ref:e})});iK.displayName=x1e;var If="AlertDialogContent",[w1e,E1e]=g1e(If),S1e=lz("AlertDialogContent"),aK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,children:r,...s}=n,i=Gl(t),a=E.useRef(null),o=$t(e,a),l=E.useRef(null);return d.jsx(xfe,{contentName:If,titleName:oK,docsSlug:"alert-dialog",children:d.jsx(w1e,{scope:t,cancelRef:l,children:d.jsxs(xD,{role:"alertdialog",...i,...s,ref:o,onOpenAutoFocus:rt(s.onOpenAutoFocus,c=>{c.preventDefault(),l.current?.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[d.jsx(S1e,{children:r}),d.jsx(_1e,{contentRef:a})]})})})});aK.displayName=If;var oK="AlertDialogTitle",lK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=Gl(t);return d.jsx(wD,{...s,...r,ref:e})});lK.displayName=oK;var cK="AlertDialogDescription",uK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=Gl(t);return d.jsx(ED,{...s,...r,ref:e})});uK.displayName=cK;var T1e="AlertDialogAction",dK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=Gl(t);return d.jsx(A7,{...s,...r,ref:e})});dK.displayName=T1e;var hK="AlertDialogCancel",fK=E.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,{cancelRef:s}=E1e(hK,t),i=Gl(t),a=$t(e,s);return d.jsx(A7,{...i,...r,ref:a})});fK.displayName=hK;var _1e=({contentRef:n})=>{const e=`\`${If}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${If}\` by passing a \`${cK}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${If}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return E.useEffect(()=>{document.getElementById(n.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,n]),null},A1e=rK,R1e=sK,mK=iK,pK=aK,gK=dK,vK=fK,yK=lK,bK=uK;const xK=A1e,C1e=R1e,wK=E.forwardRef(({className:n,...e},t)=>d.jsx(mK,{className:je("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e,ref:t}));wK.displayName=mK.displayName;const q2=E.forwardRef(({className:n,...e},t)=>d.jsxs(C1e,{children:[d.jsx(wK,{}),d.jsx(pK,{ref:t,className:je("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...e})]}));q2.displayName=pK.displayName;const W2=({className:n,...e})=>d.jsx("div",{className:je("flex flex-col space-y-2 text-center sm:text-left",n),...e});W2.displayName="AlertDialogHeader";const K2=({className:n,...e})=>d.jsx("div",{className:je("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...e});K2.displayName="AlertDialogFooter";const Y2=E.forwardRef(({className:n,...e},t)=>d.jsx(yK,{ref:t,className:je("text-lg font-semibold",n),...e}));Y2.displayName=yK.displayName;const X2=E.forwardRef(({className:n,...e},t)=>d.jsx(bK,{ref:t,className:je("text-sm text-muted-foreground",n),...e}));X2.displayName=bK.displayName;const Q2=E.forwardRef(({className:n,...e},t)=>d.jsx(gK,{ref:t,className:je(cD(),n),...e}));Q2.displayName=gK.displayName;const Z2=E.forwardRef(({className:n,...e},t)=>d.jsx(vK,{ref:t,className:je(cD({variant:"outline"}),"mt-2 sm:mt-0",n),...e}));Z2.displayName=vK.displayName;const EK=({isOpen:n,onClose:e,onConfirm:t,tagName:r,elementCount:s})=>d.jsx(xK,{open:n,onOpenChange:e,children:d.jsxs(q2,{children:[d.jsxs(W2,{children:[d.jsx(Y2,{children:"Delete Tag"}),d.jsxs(X2,{children:["You're deleting the tag ",r,". This tag will be removed from ",s," element",s!==1?"s":"","."]})]}),d.jsxs(K2,{children:[d.jsx(Z2,{onClick:e,children:"Cancel"}),d.jsx(Q2,{onClick:()=>{t(),e()},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Tag"})]})]})}),SK=({isOpen:n,onClose:e,onConfirm:t,currentName:r,isRenaming:s=!1})=>{const[i,a]=E.useState(r);E.useEffect(()=>{n&&a(r)},[n,r]);const o=c=>{c.preventDefault(),i.trim()&&i.trim()!==r&&t(i.trim())},l=i.trim().length>0&&i.trim()!==r;return d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:[d.jsx(tv,{className:"h-5 w-5"}),"Rename Tag"]}),d.jsxs(zl,{className:"pt-4",children:["Enter a new name for the tag ",d.jsxs("strong",{children:['"',r,'"']})]})]}),d.jsxs("form",{onSubmit:o,children:[d.jsx("div",{className:"py-4",children:d.jsx(ha,{value:i,onChange:c=>a(c.target.value),placeholder:"Tag name",disabled:s,autoFocus:!0,className:"w-full"})}),d.jsxs(ys,{className:"pt-2",children:[d.jsx(dt,{type:"button",variant:"outline",onClick:e,disabled:s,children:"Cancel"}),d.jsx(dt,{type:"submit",className:"button-primary",disabled:!l||s,children:s?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"animate-spin h-4 w-4 mr-2",children:""}),"Renaming..."]}):d.jsxs(d.Fragment,{children:[d.jsx(tv,{className:"h-4 w-4 mr-2"}),"Rename Tag"]})})]})]})]})})},W5=n=>Symbol.iterator in n,K5=n=>"entries"in n,Y5=(n,e)=>{const t=n instanceof Map?n:new Map(n.entries()),r=e instanceof Map?e:new Map(e.entries());if(t.size!==r.size)return!1;for(const[s,i]of t)if(!Object.is(i,r.get(s)))return!1;return!0},k1e=(n,e)=>{const t=n[Symbol.iterator](),r=e[Symbol.iterator]();let s=t.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=t.next(),i=r.next()}return!!s.done&&!!i.done};function I1e(n,e){return Object.is(n,e)?!0:typeof n!="object"||n===null||typeof e!="object"||e===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(e)?!1:W5(n)&&W5(e)?K5(n)&&K5(e)?Y5(n,e):k1e(n,e):Y5({entries:()=>Object.entries(n)},{entries:()=>Object.entries(e)})}function TK(n){const e=ve.useRef(void 0);return t=>{const r=n(t);return I1e(e.current,r)?e.current:e.current=r}}const X5=[],L1e={"accent-purple":"#a78bfa","accent-blue":"#60a5fa","accent-teal":"#5eead4","accent-green":"#4ade80","accent-lime":"#bef264","accent-orange":"#fdba74","accent-red":"#f87171","accent-gray":"#a1a1aa"},D1e=({element:n,searchValue:e,onSearchChange:t,onClose:r,onTagCreated:s,isDraft:i=!1,draftKey:a="timeline"})=>{const o=De(TK(te=>i?(a==="timeline"?te.timelineDraft:te.replyDrafts[a])?.tagIds??X5:te.boardState.elements[n.id]?.tagIds??X5)),l=De(te=>te.boardState.tags||{}),c=Object.values(l),u=De(te=>te.addTagToElement),f=De(te=>te.removeTagFromElement),m=De(te=>te.addTagToDraft),g=De(te=>te.removeTagFromDraft),y=De(te=>te.createTag),b=De(te=>te.deleteTag),x=De(te=>te.renameTag),S=De(te=>te.changeTagColor),T=De(te=>te.getElementsWithTag),[_,R]=E.useState(0),[I,C]=E.useState(!1),[L,k]=E.useState(null),[M,D]=E.useState({isOpen:!1,tagId:null,tagName:"",elementCount:0}),[U,$]=E.useState({isOpen:!1,tagId:null,tagName:""}),[V,B]=E.useState(!1),W=c.filter(te=>te.name.toLowerCase().includes(e.toLowerCase())),F=e.trim()&&!c.some(te=>te.name.toLowerCase()===e.trim().toLowerCase()),j=W.length+(F?1:0),q=()=>{const te=["accent-purple","accent-blue","accent-teal","accent-green","accent-lime","accent-orange","accent-red"],se=new Set(c.map(Z=>Z.color));let he=te.find(Z=>!se.has(Z));if(!he){const Z=c.length%te.length;he=te[Z]}return he},H=E.useCallback(async()=>{const te=e.trim();if(te&&!I){C(!0);try{const se=await y(te);se&&(i?m(se,a):await u(n.id,se),s?.())}finally{C(!1)}}},[e,I,y,u,m,n.id,i,a,s]),N=(te,se)=>{const he=T(te);if(he.length===0){b(te);return}D({isOpen:!0,tagId:te,tagName:se,elementCount:he.length})},O=()=>{M.tagId&&b(M.tagId)},z=()=>{D({isOpen:!1,tagId:null,tagName:"",elementCount:0})},G=(te,se)=>{$({isOpen:!0,tagId:te,tagName:se})},Y=async te=>{if(U.tagId){B(!0);try{await x(U.tagId,te),$({isOpen:!1,tagId:null,tagName:""})}catch(se){console.error("Failed to rename tag:",se)}finally{B(!1)}}},Q=()=>{V||$({isOpen:!1,tagId:null,tagName:""})},J=async(te,se)=>{try{await S(te,se)}catch(he){console.error("Failed to change tag color:",he)}},ee=[{name:"Purple",value:"accent-purple"},{name:"Blue",value:"accent-blue"},{name:"Teal",value:"accent-teal"},{name:"Green",value:"accent-green"},{name:"Lime",value:"accent-lime"},{name:"Orange",value:"accent-orange"},{name:"Red",value:"accent-red"}],oe=E.useCallback(async te=>{if(te<W.length){const se=W[te];o.includes(se.id)?i?g(se.id,a):await f(n.id,se.id):i?m(se.id,a):await u(n.id,se.id),t("")}else F&&te===W.length&&H()},[W,o,F,n.id,u,f,m,g,i,a,H,t]);return E.useEffect(()=>{const te=se=>{U.isOpen||M.isOpen||j!==0&&(se.key==="ArrowDown"?(se.preventDefault(),se.stopPropagation(),R(he=>(he+1)%j)):se.key==="ArrowUp"?(se.preventDefault(),se.stopPropagation(),R(he=>(he-1+j)%j)):se.key==="Enter"&&(se.preventDefault(),se.stopPropagation(),oe(_)))};return window.addEventListener("keydown",te,!0),()=>window.removeEventListener("keydown",te,!0)},[_,j,oe,U.isOpen,M.isOpen]),E.useEffect(()=>{R(0)},[e]),d.jsxs("div",{className:"py-2",children:[d.jsx("div",{className:"px-3 py-2 text-xs text-text-secondary/60",children:"Select a Tag or create one"}),W.length===0&&!F?d.jsx("div",{className:"px-3 py-2 text-xs text-text-secondary",children:e?"No tags found":"No tags available"}):d.jsxs("div",{className:"overflow-y-auto",children:[W.map((te,se)=>{const he=o.includes(te.id),Z=se===_,pe=L===te.id;return d.jsxs("div",{className:je("flex items-center justify-between px-3 py-1.5 cursor-pointer transition-colors rounded-lg mx-2",Z&&"bg-white/10",!Z&&"hover:bg-white/5"),onClick:()=>oe(se),onMouseEnter:()=>{R(se),k(te.id)},onMouseLeave:()=>k(null),children:[d.jsx(Bs,{text:te.name,type:"tag",color:te.color}),d.jsxs("div",{className:"flex items-center gap-2",children:[pe?d.jsxs(Gs,{modal:!1,children:[d.jsx(qs,{asChild:!0,onClick:ye=>ye.stopPropagation(),children:d.jsx("button",{className:"w-5 h-5 flex items-center justify-center hover:bg-white/10 rounded transition-colors",children:d.jsx(eD,{className:"w-4 h-4 text-text-secondary"})})}),d.jsxs(Ms,{align:"start",side:"bottom",sideOffset:4,className:"min-w-[140px] z-[250]",children:[d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:ye=>{ye.stopPropagation(),G(te.id,te.name)},children:[d.jsx(tv,{className:"w-4 h-4"}),d.jsx("span",{children:"Rename tag"})]}),d.jsxs(HD,{children:[d.jsxs(ES,{className:"text-text-primary focus:text-text-primary gap-2",children:[d.jsx(rz,{className:"w-4 h-4"}),d.jsx("span",{children:"Color"})]}),d.jsx(SS,{className:"min-w-[120px]",children:ee.map(ye=>d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:ae=>{ae.stopPropagation(),J(te.id,ye.value)},children:[d.jsx("div",{className:"w-4 h-4 rounded-full border border-white/20",style:{backgroundColor:L1e[ye.value]}}),d.jsx("span",{children:ye.name}),te.color===ye.value&&d.jsx("span",{className:"ml-auto text-xs",children:""})]},ye.value))})]}),d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:ye=>{ye.stopPropagation(),N(te.id,te.name)},children:[d.jsx(rv,{className:"w-4 h-4"}),d.jsx("span",{children:"Delete tag"})]})]})]}):d.jsx("div",{className:"w-5 h-5"}),d.jsx("div",{className:je("w-4 h-4 border rounded-sm flex items-center justify-center transition-colors",he?"bg-accent border-accent text-accent-foreground":"border-border/50"),children:he&&d.jsx("span",{className:"text-xs",children:""})})]})]},te.id)}),F&&d.jsx("div",{className:je("flex items-center justify-between px-3 py-1.5 cursor-pointer transition-colors border-t border-border/30 mt-1 mx-2 rounded-lg",_===W.length&&"bg-white/10",_!==W.length&&"hover:bg-white/5"),onClick:H,onMouseEnter:()=>R(W.length),children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Jc,{size:14,className:"text-text-secondary"}),d.jsx("span",{className:"text-sm text-text-secondary",children:"Create"}),d.jsx(Bs,{text:e.trim(),type:"tag",color:q()})]})})]}),d.jsx(EK,{isOpen:M.isOpen,onClose:z,onConfirm:O,tagName:M.tagName,elementCount:M.elementCount}),d.jsx(SK,{isOpen:U.isOpen,onClose:Q,onConfirm:Y,currentName:U.tagName,isRenaming:V})]})},J2=ve.memo(({element:n,hasEditingPermissions:e,isVisible:t,isSelected:r,isHovered:s=!1,variant:i="reply"})=>{const a=cn(b=>b.user),{accessLevel:o,isCreator:l}=Dd(),[c,u]=E.useState(!1),f=o==="viewonly"&&!l,m=a?.id===n.createdBy;E.useEffect(()=>{(!r||!t)&&u(!1)},[r,t]);const g=()=>{u(!1);const b=De.getState().deleteElements;b([n.id])},y=()=>{if(u(!1),n.type==="text"){const b=De.getState().enterTextEditMode;b(n.id)}else if(n.type==="recording"){const b=De.getState().enterDescriptionEditMode;b(n.id)}};return E.useEffect(()=>{if(c&&!r&&i==="main"){const b=De.getState().setSelectedFrames;b([n.id])}},[c,r,n.id,i]),!e||f||!m||!t?null:i==="reply"?d.jsxs(Gs,{modal:!1,open:c,onOpenChange:u,children:[d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsx(qs,{asChild:!0,children:d.jsx("button",{className:je("flex items-center justify-center transition-opacity duration-200",s?"opacity-100":"opacity-0"),onMouseDown:b=>b.stopPropagation(),onClick:b=>b.stopPropagation(),children:d.jsx(cw,{size:14,className:"text-text-secondary hover:text-text-primary transition-colors duration-100"})})})}),d.jsx($n,{side:"bottom",className:"z-[100]",children:d.jsx("p",{children:"More options"})})]}),d.jsxs(Ms,{align:"end",side:"bottom",sideOffset:8,alignOffset:0,className:"min-w-[160px] z-[100] bg-card-background",onMouseDown:b=>b.stopPropagation(),onClick:b=>b.stopPropagation(),avoidCollisions:!0,collisionPadding:8,children:[(n.type==="text"||n.type==="recording")&&d.jsxs("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:y,children:[d.jsx("span",{children:"Edit Text"}),r&&d.jsx(gn,{className:"opacity-50",children:"E"})]}),d.jsxs("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:g,children:[d.jsx("span",{children:"Delete"}),r&&d.jsx(gn,{className:"opacity-50",children:""})]})]})]}):d.jsxs(Gs,{modal:!1,open:c,onOpenChange:u,children:[d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsx(qs,{asChild:!0,children:d.jsx("button",{className:je("element-button flex items-center justify-center h-[30px] w-[30px] rounded-2xl hover:bg-border/30 transition-opacity duration-200",r||s?"opacity-100":"opacity-0"),onMouseDown:b=>b.stopPropagation(),onClick:b=>b.stopPropagation(),children:d.jsx(cw,{size:14,className:"text-text-secondary hover:text-text-primary transition-colors duration-100"})})})}),d.jsx($n,{side:"bottom",className:"z-[100]",children:d.jsx("p",{children:"More options"})})]}),d.jsxs(Ms,{align:"end",side:"bottom",sideOffset:8,alignOffset:0,className:"min-w-[160px] z-[100] bg-card-background",onMouseDown:b=>b.stopPropagation(),onClick:b=>b.stopPropagation(),avoidCollisions:!0,collisionPadding:8,children:[(n.type==="text"||n.type==="recording")&&d.jsxs("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:y,children:[d.jsx("span",{children:"Edit Text"}),r&&d.jsx(gn,{className:"opacity-50",children:"E"})]}),d.jsxs("button",{className:"flex items-center justify-between w-full px-3 py-2 text-sm hover:bg-border/50 transition-colors rounded-xl",onClick:g,children:[d.jsx("span",{children:"Delete"}),r&&d.jsx(gn,{className:"opacity-50",children:""})]})]})]})});J2.displayName="MoreOptionsButton";var NS="Popover",[_K,wje]=Ns(NS,[du]),m0=du(),[P1e,mu]=_K(NS),AK=n=>{const{__scopePopover:e,children:t,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=n,o=m0(e),l=E.useRef(null),[c,u]=E.useState(!1),[f,m]=vi({prop:r,defaultProp:s??!1,onChange:i,caller:NS});return d.jsx(Xv,{...o,children:d.jsx(P1e,{scope:e,contentId:zs(),triggerRef:l,open:f,onOpenChange:m,onOpenToggle:E.useCallback(()=>m(g=>!g),[m]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:t})})};AK.displayName=NS;var RK="PopoverAnchor",M1e=E.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=mu(RK,t),i=m0(t),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),d.jsx(Qv,{...i,...r,ref:e})});M1e.displayName=RK;var CK="PopoverTrigger",kK=E.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=mu(CK,t),i=m0(t),a=$t(e,s.triggerRef),o=d.jsx(_t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":MK(s.open),...r,ref:a,onClick:rt(n.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:d.jsx(Qv,{asChild:!0,...i,children:o})});kK.displayName=CK;var eP="PopoverPortal",[O1e,N1e]=_K(eP,{forceMount:void 0}),IK=n=>{const{__scopePopover:e,forceMount:t,children:r,container:s}=n,i=mu(eP,e);return d.jsx(O1e,{scope:e,forceMount:t,children:d.jsx($i,{present:t||i.open,children:d.jsx(lm,{asChild:!0,container:s,children:r})})})};IK.displayName=eP;var Yf="PopoverContent",LK=E.forwardRef((n,e)=>{const t=N1e(Yf,n.__scopePopover),{forceMount:r=t.forceMount,...s}=n,i=mu(Yf,n.__scopePopover);return d.jsx($i,{present:r||i.open,children:i.modal?d.jsx(F1e,{...s,ref:e}):d.jsx(U1e,{...s,ref:e})})});LK.displayName=Yf;var j1e=eu("PopoverContent.RemoveScroll"),F1e=E.forwardRef((n,e)=>{const t=mu(Yf,n.__scopePopover),r=E.useRef(null),s=$t(e,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return cS(a)},[]),d.jsx(Kv,{as:j1e,allowPinchZoom:!0,children:d.jsx(DK,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rt(n.onCloseAutoFocus,a=>{a.preventDefault(),i.current||t.triggerRef.current?.focus()}),onPointerDownOutside:rt(n.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:rt(n.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),U1e=E.forwardRef((n,e)=>{const t=mu(Yf,n.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return d.jsx(DK,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{n.onCloseAutoFocus?.(i),i.defaultPrevented||(r.current||t.triggerRef.current?.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{n.onInteractOutside?.(i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;t.triggerRef.current?.contains(a)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),DK=E.forwardRef((n,e)=>{const{__scopePopover:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...f}=n,m=mu(Yf,t),g=m0(t);return oS(),d.jsx(Wv,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(om,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>m.onOpenChange(!1),children:d.jsx(gS,{"data-state":MK(m.open),role:"dialog",id:m.contentId,...g,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),PK="PopoverClose",$1e=E.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=mu(PK,t);return d.jsx(_t.button,{type:"button",...r,ref:e,onClick:rt(n.onClick,()=>s.onOpenChange(!1))})});$1e.displayName=PK;var B1e="PopoverArrow",H1e=E.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=m0(t);return d.jsx(vS,{...s,...r,ref:e})});H1e.displayName=B1e;function MK(n){return n?"open":"closed"}var V1e=AK,z1e=kK,G1e=IK,OK=LK;const q1e=V1e,W1e=z1e,NK=E.forwardRef(({className:n,align:e="center",sideOffset:t=4,...r},s)=>d.jsx(G1e,{children:d.jsx(OK,{ref:s,align:e,sideOffset:t,className:je("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...r})}));NK.displayName=OK.displayName;const Q5=[],tP=ve.memo(ve.forwardRef(({element:n,hasEditingPermissions:e,forceOpen:t=!1,onRequestClose:r,isHovered:s=!1,isReadOnly:i=!1,showMoreMenu:a=!1,isVisible:o=!0,isSelected:l=!1,isDraft:c=!1,draftKey:u="timeline",isInToolbar:f=!1,onEscapeFromToolbar:m},g)=>{const y=De(TK(H=>c?(u==="timeline"?H.timelineDraft:H.replyDrafts[u])?.tagIds??Q5:H.boardState.elements[n.id]?.tagIds??Q5)),b=De(H=>H.boardState.tags||{}),x=De(H=>H.removeTagFromElement),S=De(H=>H.removeTagFromDraft),T=De(H=>H.getElementAppTags),_=De(H=>H.userProfiles),R=De(H=>H.unseenElementIds),[I,C]=E.useState(!1),[L,k]=E.useState(""),M=E.useRef(null),D=R?.has(n.id)??!1,U=y.map(H=>Object.values(b).find(N=>N.id===H)).filter(Boolean),$=c?(()=>{const H=[];return n.createdBy&&n.creatorName&&H.push({id:`apptag-creator-${n.id}`,type:"creator",elementId:n.id,creatorId:n.createdBy,creatorName:n.creatorName,creatorAvatarUrl:n.creatorAvatarUrl}),H})():T(n.id),V=i?$.filter(H=>H.type==="creator"||H.type==="creationTime"):$.filter(H=>H.type!=="linkTime"),B=i?[]:U;if(E.useEffect(()=>{t&&e&&C(!0)},[t,e]),E.useEffect(()=>{I&&setTimeout(()=>M.current?.focus(),50)},[I]),!(i?V.length>0:c||t||B.length>0||V.length>0))return null;const F=H=>{const N=Math.floor(H),O=Math.floor(N/3600),z=Math.floor(N%3600/60),G=N%60,Y=[];return O>0&&Y.push(d.jsxs(ve.Fragment,{children:[O,d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:"h"})]},"h")),(z>0||O>0)&&(Y.length>0&&Y.push(d.jsx(ve.Fragment,{children:":"},"h-sep")),Y.push(d.jsxs(ve.Fragment,{children:[z.toString().padStart(2,"0"),d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:"m"})]},"m"))),(O===0&&z===0||G>0)&&(Y.length>0&&Y.push(d.jsx(ve.Fragment,{children:":"},"m-sep")),Y.push(d.jsxs(ve.Fragment,{children:[G.toString().padStart(2,"0"),d.jsx("span",{style:{opacity:.6,verticalAlign:"baseline"},children:"s"})]},"s"))),d.jsx(d.Fragment,{children:Y})},j=H=>{if(H.type==="creator"){const N=H.creatorId?_[H.creatorId]:void 0;return{text:ZD(N,H.creatorName)}}else if(H.type==="creationTime"){const N=new Date(H.timestamp*1e3);return{text:b9(N),icon:d.jsx(ev,{size:12})}}else if(H.type==="linkTime"){if(H.timestamp!==void 0)return{content:F(H.timestamp),icon:d.jsx(nv,{size:12})};if(H.timeRange)return{content:d.jsxs(d.Fragment,{children:[F(H.timeRange.start),d.jsx("span",{style:{opacity:.6},children:"-"}),F(H.timeRange.end)]}),icon:d.jsx(nv,{size:12})}}return{text:""}},q=H=>{C(H),H||(k(""),r?.())};return ve.useImperativeHandle(g,()=>({focusTagInput:()=>{C(!0),setTimeout(()=>M.current?.focus(),50)}})),i?d.jsx("div",{className:"w-full relative group",children:d.jsxs(yi,{delayDuration:300,children:[d.jsx("div",{className:"h-full px-2 py-2 flex flex-wrap gap-1 items-center",children:V.map(H=>{const N=j(H);return d.jsx(Bs,{text:N.text,type:"apptag",appTagType:H.type,image:H.type==="creator"?H.creatorAvatarUrl:void 0,isRemovable:!1,icon:N.icon,showNewIndicator:H.type==="creationTime"&&D,children:N.content},H.id)})}),a&&d.jsx("div",{className:"absolute right-[13px] top-2",children:d.jsx(J2,{element:n,hasEditingPermissions:e,isVisible:o,isSelected:l,isHovered:s,variant:"reply"})})]})}):d.jsx("div",{className:"w-full relative group","data-tags-section":!0,children:d.jsx(yi,{delayDuration:300,children:d.jsxs(q1e,{open:I,onOpenChange:q,modal:!1,children:[d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsx(W1e,{asChild:!0,disabled:I||!e,children:d.jsxs("div",{className:`border-transparent h-full px-1 rounded-3xl py-1 m-1 flex flex-wrap gap-1 items-center transition-colors duration-100 ${e?`cursor-pointer ${I?"bg-card-background/80":"hover:bg-card-background/50"}`:""}`,onClick:H=>{!I&&e&&q(!0)},children:[V.map(H=>{const N=j(H);return d.jsx(Bs,{text:N.text,type:"apptag",appTagType:H.type,image:H.type==="creator"?H.creatorAvatarUrl:void 0,isRemovable:!1,icon:N.icon,showNewIndicator:H.type==="creationTime"&&D,children:N.content},H.id)}),B.map(H=>d.jsx(Bs,{text:H.name,type:"tag",color:H.color,showRemove:I&&e,onRemove:N=>{c?S(H.id,u):x(n.id,H.id)}},H.id)),I&&e&&d.jsx("input",{ref:M,type:"text",value:L,onChange:H=>k(H.target.value),onKeyDown:H=>{H.stopPropagation(),H.key==="Escape"&&(q(!1),H.preventDefault(),f&&m&&m())},onClick:H=>H.stopPropagation(),onMouseDown:H=>H.stopPropagation(),className:"flex-1 w-full bg-transparent outline-none text-xs text-text-primary placeholder:text-text-secondary/60 p-1",placeholder:""}),!I&&B.length===0&&V.length===0&&d.jsx("span",{className:"text-xs text-text-secondary/60",children:"Add tags..."})]})})}),e&&!I&&d.jsx($n,{side:"top",className:"text-xs",children:"Tags"})]}),e&&d.jsx(NK,{align:"start",side:"bottom",sideOffset:4,className:"p-0 min-w-[250px] rounded-xl z-[200]",onMouseDown:H=>H.stopPropagation(),onClick:H=>H.stopPropagation(),avoidCollisions:!0,collisionPadding:16,"data-tag-picker":"true",children:d.jsx(D1e,{element:n,searchValue:L,onSearchChange:k,onClose:()=>q(!1),onTagCreated:()=>{k("")},isDraft:c,draftKey:u})})]})})})}));tP.displayName="TagsSection";const jK=ve.memo(({element:n,isVisible:e,hasEditingPermissions:t,isSelected:r,isHovered:s=!1,threadId:i})=>{const{accessLevel:a,isCreator:o}=Dd(),l=Jn(),c=cn(x=>x.user),u=a==="viewonly"&&!o,f=i||n.id,g=Mt(x=>x.replyToolbar.threadId)===f,y=x=>{if(x?.preventDefault(),x?.stopPropagation(),!c){const _=window.location.pathname;l(`/login?redirect=${encodeURIComponent(_)}`);return}const S=yt.getState();if(De.getState().setSelectedFrames([f]),g){S.scrollThreadToBottom(f),setTimeout(()=>{Mt.getState().focusTextbox("reply")},100);return}S.enableThreadScrollOnHover(f),Mt.getState().setReplyThreadId(f),Mt.getState().enterReplyFocusedState(f),setTimeout(()=>{S.scrollThreadToBottom(f),S.notifyThreadHeightChanged(f)},50)},b=!u;return!b||!e?null:d.jsx("div",{className:"w-full relative px-3",children:d.jsx(yi,{delayDuration:300,children:d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[b&&d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsxs("button",{className:"element-button flex items-center justify-center gap-1.5 h-[30px] px-2.5 rounded-2xl hover:bg-border/30 transition-colors group/reply-btn",onClick:x=>y(x),onMouseDown:x=>x.stopPropagation(),children:[d.jsx("span",{className:"text-xs text-text-secondary group-hover/reply-btn:text-text-primary transition-colors duration-100",children:"Reply"}),d.jsx(oue,{size:14,className:"text-text-secondary group-hover/reply-btn:text-text-primary transition-colors duration-100"})]})}),d.jsx($n,{side:"bottom",className:"z-[100]",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("p",{children:"Reply"}),r&&d.jsx(gn,{children:""})]})})]}),d.jsx(J2,{element:n,hasEditingPermissions:t,isVisible:e,isSelected:r,isHovered:s,variant:"main"})]})})})});jK.displayName="ActionBar";const Z5=({width:n=48,height:e=49,className:t="",color:r="currentColor"})=>d.jsxs("svg",{width:n,height:e,viewBox:"0 0 48 49",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[d.jsx("path",{d:"M38 8.5H10C7.79086 8.5 6 10.2909 6 12.5V28.5C6 30.7091 7.79086 32.5 10 32.5H38C40.2091 32.5 42 30.7091 42 28.5V12.5C42 10.2909 40.2091 8.5 38 8.5Z",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M4 40.5H44",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]}),K1e=({width:n=48,height:e=49,className:t="",color:r="currentColor"})=>d.jsxs("svg",{width:n,height:e,viewBox:"0 0 48 49",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[d.jsx("path",{d:"M4 20.5V26.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M12 12.5V34.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M20 6.5V42.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M28 16.5V30.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M36 10.5V36.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("path",{d:"M44 20.5V26.5",stroke:r,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})]});function Y1e(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}function FK(n,e){return new Promise(function(t,r){let s;return X1e(n).then(function(i){try{return s=i,t(new Blob([e.slice(0,2),s,e.slice(2)],{type:"image/jpeg"}))}catch(a){return r(a)}},r)})}const X1e=n=>new Promise((e,t)=>{const r=new FileReader;r.addEventListener("load",({target:{result:s}})=>{const i=new DataView(s);let a=0;if(i.getUint16(a)!==65496)return t("not a valid JPEG");for(a+=2;;){const o=i.getUint16(a);if(o===65498)break;const l=i.getUint16(a+2);if(o===65505&&i.getUint32(a+4)===1165519206){const c=a+10;let u;switch(i.getUint16(c)){case 18761:u=!0;break;case 19789:u=!1;break;default:return t("TIFF header contains invalid endian")}if(i.getUint16(c+2,u)!==42)return t("TIFF header contains invalid version");const f=i.getUint32(c+4,u),m=c+f+2+12*i.getUint16(c+f,u);for(let g=c+f+2;g<m;g+=12)if(i.getUint16(g,u)==274){if(i.getUint16(g+2,u)!==3)return t("Orientation data type is invalid");if(i.getUint32(g+4,u)!==1)return t("Orientation data count is invalid");i.setUint16(g+8,1,u);break}return e(s.slice(a,a+2+l))}a+=2+l}return e(new Blob)}),r.readAsArrayBuffer(n)});var uE={},Q1e={get exports(){return uE},set exports(n){uE=n}};(function(n){var e,t,r={};Q1e.exports=r,r.parse=function(s,i){for(var a=r.bin.readUshort,o=r.bin.readUint,l=0,c={},u=new Uint8Array(s),f=u.length-4;o(u,f)!=101010256;)f--;l=f,l+=4;var m=a(u,l+=4);a(u,l+=2);var g=o(u,l+=2),y=o(u,l+=4);l+=4,l=y;for(var b=0;b<m;b++){o(u,l),l+=4,l+=4,l+=4,o(u,l+=4),g=o(u,l+=4);var x=o(u,l+=4),S=a(u,l+=4),T=a(u,l+2),_=a(u,l+4);l+=6;var R=o(u,l+=8);l+=4,l+=S+T+_,r._readLocal(u,R,c,g,x,i)}return c},r._readLocal=function(s,i,a,o,l,c){var u=r.bin.readUshort,f=r.bin.readUint;f(s,i),u(s,i+=4),u(s,i+=2);var m=u(s,i+=2);f(s,i+=2),f(s,i+=4),i+=4;var g=u(s,i+=8),y=u(s,i+=2);i+=2;var b=r.bin.readUTF8(s,i,g);if(i+=g,i+=y,c)a[b]={size:l,csize:o};else{var x=new Uint8Array(s.buffer,i);if(m==0)a[b]=new Uint8Array(x.buffer.slice(i,i+o));else{if(m!=8)throw"unknown compression method: "+m;var S=new Uint8Array(l);r.inflateRaw(x,S),a[b]=S}}},r.inflateRaw=function(s,i){return r.F.inflate(s,i)},r.inflate=function(s,i){return s[0],s[1],r.inflateRaw(new Uint8Array(s.buffer,s.byteOffset+2,s.length-6),i)},r.deflate=function(s,i){i==null&&(i={level:6});var a=0,o=new Uint8Array(50+Math.floor(1.1*s.length));o[a]=120,o[a+1]=156,a+=2,a=r.F.deflateRaw(s,o,a,i.level);var l=r.adler(s,0,s.length);return o[a+0]=l>>>24&255,o[a+1]=l>>>16&255,o[a+2]=l>>>8&255,o[a+3]=l>>>0&255,new Uint8Array(o.buffer,0,a+4)},r.deflateRaw=function(s,i){i==null&&(i={level:6});var a=new Uint8Array(50+Math.floor(1.1*s.length)),o=r.F.deflateRaw(s,a,o,i.level);return new Uint8Array(a.buffer,0,o)},r.encode=function(s,i){i==null&&(i=!1);var a=0,o=r.bin.writeUint,l=r.bin.writeUshort,c={};for(var u in s){var f=!r._noNeed(u)&&!i,m=s[u],g=r.crc.crc(m,0,m.length);c[u]={cpr:f,usize:m.length,crc:g,file:f?r.deflateRaw(m):m}}for(var u in c)a+=c[u].file.length+30+46+2*r.bin.sizeUTF8(u);a+=22;var y=new Uint8Array(a),b=0,x=[];for(var u in c){var S=c[u];x.push(b),b=r._writeHeader(y,b,u,S,0)}var T=0,_=b;for(var u in c)S=c[u],x.push(b),b=r._writeHeader(y,b,u,S,1,x[T++]);var R=b-_;return o(y,b,101010256),b+=4,l(y,b+=4,T),l(y,b+=2,T),o(y,b+=2,R),o(y,b+=4,_),b+=4,b+=2,y.buffer},r._noNeed=function(s){var i=s.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(i)!=-1},r._writeHeader=function(s,i,a,o,l,c){var u=r.bin.writeUint,f=r.bin.writeUshort,m=o.file;return u(s,i,l==0?67324752:33639248),i+=4,l==1&&(i+=2),f(s,i,20),f(s,i+=2,0),f(s,i+=2,o.cpr?8:0),u(s,i+=2,0),u(s,i+=4,o.crc),u(s,i+=4,m.length),u(s,i+=4,o.usize),f(s,i+=4,r.bin.sizeUTF8(a)),f(s,i+=2,0),i+=2,l==1&&(i+=2,i+=2,u(s,i+=6,c),i+=4),i+=r.bin.writeUTF8(s,i,a),l==0&&(s.set(m,i),i+=m.length),i},r.crc={table:function(){for(var s=new Uint32Array(256),i=0;i<256;i++){for(var a=i,o=0;o<8;o++)1&a?a=3988292384^a>>>1:a>>>=1;s[i]=a}return s}(),update:function(s,i,a,o){for(var l=0;l<o;l++)s=r.crc.table[255&(s^i[a+l])]^s>>>8;return s},crc:function(s,i,a){return 4294967295^r.crc.update(4294967295,s,i,a)}},r.adler=function(s,i,a){for(var o=1,l=0,c=i,u=i+a;c<u;){for(var f=Math.min(c+5552,u);c<f;)l+=o+=s[c++];o%=65521,l%=65521}return l<<16|o},r.bin={readUshort:function(s,i){return s[i]|s[i+1]<<8},writeUshort:function(s,i,a){s[i]=255&a,s[i+1]=a>>8&255},readUint:function(s,i){return 16777216*s[i+3]+(s[i+2]<<16|s[i+1]<<8|s[i])},writeUint:function(s,i,a){s[i]=255&a,s[i+1]=a>>8&255,s[i+2]=a>>16&255,s[i+3]=a>>24&255},readASCII:function(s,i,a){for(var o="",l=0;l<a;l++)o+=String.fromCharCode(s[i+l]);return o},writeASCII:function(s,i,a){for(var o=0;o<a.length;o++)s[i+o]=a.charCodeAt(o)},pad:function(s){return s.length<2?"0"+s:s},readUTF8:function(s,i,a){for(var o,l="",c=0;c<a;c++)l+="%"+r.bin.pad(s[i+c].toString(16));try{o=decodeURIComponent(l)}catch{return r.bin.readASCII(s,i,a)}return o},writeUTF8:function(s,i,a){for(var o=a.length,l=0,c=0;c<o;c++){var u=a.charCodeAt(c);if((4294967168&u)==0)s[i+l]=u,l++;else if((4294965248&u)==0)s[i+l]=192|u>>6,s[i+l+1]=128|u>>0&63,l+=2;else if((4294901760&u)==0)s[i+l]=224|u>>12,s[i+l+1]=128|u>>6&63,s[i+l+2]=128|u>>0&63,l+=3;else{if((4292870144&u)!=0)throw"e";s[i+l]=240|u>>18,s[i+l+1]=128|u>>12&63,s[i+l+2]=128|u>>6&63,s[i+l+3]=128|u>>0&63,l+=4}}return l},sizeUTF8:function(s){for(var i=s.length,a=0,o=0;o<i;o++){var l=s.charCodeAt(o);if((4294967168&l)==0)a++;else if((4294965248&l)==0)a+=2;else if((4294901760&l)==0)a+=3;else{if((4292870144&l)!=0)throw"e";a+=4}}return a}},r.F={},r.F.deflateRaw=function(s,i,a,o){var l=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],c=r.F.U,u=r.F._goodIndex;r.F._hash;var f=r.F._putsE,m=0,g=a<<3,y=0,b=s.length;if(o==0){for(;m<b;)f(i,g,m+(U=Math.min(65535,b-m))==b?1:0),g=r.F._copyExact(s,m,U,i,g+8),m+=U;return g>>>3}var x=c.lits,S=c.strt,T=c.prev,_=0,R=0,I=0,C=0,L=0,k=0;for(b>2&&(S[k=r.F._hash(s,0)]=0),m=0;m<b;m++){if(L=k,m+1<b-2){k=r.F._hash(s,m+1);var M=m+1&32767;T[M]=S[k],S[k]=M}if(y<=m){(_>14e3||R>26697)&&b-m>100&&(y<m&&(x[_]=m-y,_+=2,y=m),g=r.F._writeBlock(m==b-1||y==b?1:0,x,_,C,s,I,m-I,i,g),_=R=C=0,I=m);var D=0;m<b-2&&(D=r.F._bestMatch(s,m,T,L,Math.min(l[2],b-m),l[3]));var U=D>>>16,$=65535&D;if(D!=0){$=65535&D;var V=u(U=D>>>16,c.of0);c.lhst[257+V]++;var B=u($,c.df0);c.dhst[B]++,C+=c.exb[V]+c.dxb[B],x[_]=U<<23|m-y,x[_+1]=$<<16|V<<8|B,_+=2,y=m+U}else c.lhst[s[m]]++;R++}}for(I==m&&s.length!=0||(y<m&&(x[_]=m-y,_+=2,y=m),g=r.F._writeBlock(1,x,_,C,s,I,m-I,i,g),_=0,R=0,_=R=C=0,I=m);(7&g)!=0;)g++;return g>>>3},r.F._bestMatch=function(s,i,a,o,l,c){var u=32767&i,f=a[u],m=u-f+32768&32767;if(f==u||o!=r.F._hash(s,i-m))return 0;for(var g=0,y=0,b=Math.min(32767,i);m<=b&&--c!=0&&f!=u;){if(g==0||s[i+g]==s[i+g-m]){var x=r.F._howLong(s,i,m);if(x>g){if(y=m,(g=x)>=l)break;m+2<x&&(x=m+2);for(var S=0,T=0;T<x-2;T++){var _=i-m+T+32768&32767,R=_-a[_]+32768&32767;R>S&&(S=R,f=_)}}}m+=(u=f)-(f=a[u])+32768&32767}return g<<16|y},r.F._howLong=function(s,i,a){if(s[i]!=s[i-a]||s[i+1]!=s[i+1-a]||s[i+2]!=s[i+2-a])return 0;var o=i,l=Math.min(s.length,i+258);for(i+=3;i<l&&s[i]==s[i-a];)i++;return i-o},r.F._hash=function(s,i){return(s[i]<<8|s[i+1])+(s[i+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(s,i,a,o,l,c,u,f,m){var g,y,b,x,S,T,_,R,I,C=r.F.U,L=r.F._putsF,k=r.F._putsE;C.lhst[256]++,y=(g=r.F.getTrees())[0],b=g[1],x=g[2],S=g[3],T=g[4],_=g[5],R=g[6],I=g[7];var M=32+((m+3&7)==0?0:8-(m+3&7))+(u<<3),D=o+r.F.contSize(C.fltree,C.lhst)+r.F.contSize(C.fdtree,C.dhst),U=o+r.F.contSize(C.ltree,C.lhst)+r.F.contSize(C.dtree,C.dhst);U+=14+3*_+r.F.contSize(C.itree,C.ihst)+(2*C.ihst[16]+3*C.ihst[17]+7*C.ihst[18]);for(var $=0;$<286;$++)C.lhst[$]=0;for($=0;$<30;$++)C.dhst[$]=0;for($=0;$<19;$++)C.ihst[$]=0;var V=M<D&&M<U?0:D<U?1:2;if(L(f,m,s),L(f,m+1,V),m+=3,V==0){for(;(7&m)!=0;)m++;m=r.F._copyExact(l,c,u,f,m)}else{var B,W;if(V==1&&(B=C.fltree,W=C.fdtree),V==2){r.F.makeCodes(C.ltree,y),r.F.revCodes(C.ltree,y),r.F.makeCodes(C.dtree,b),r.F.revCodes(C.dtree,b),r.F.makeCodes(C.itree,x),r.F.revCodes(C.itree,x),B=C.ltree,W=C.dtree,k(f,m,S-257),k(f,m+=5,T-1),k(f,m+=5,_-4),m+=4;for(var F=0;F<_;F++)k(f,m+3*F,C.itree[1+(C.ordr[F]<<1)]);m+=3*_,m=r.F._codeTiny(R,C.itree,f,m),m=r.F._codeTiny(I,C.itree,f,m)}for(var j=c,q=0;q<a;q+=2){for(var H=i[q],N=H>>>23,O=j+(8388607&H);j<O;)m=r.F._writeLit(l[j++],B,f,m);if(N!=0){var z=i[q+1],G=z>>16,Y=z>>8&255,Q=255&z;k(f,m=r.F._writeLit(257+Y,B,f,m),N-C.of0[Y]),m+=C.exb[Y],L(f,m=r.F._writeLit(Q,W,f,m),G-C.df0[Q]),m+=C.dxb[Q],j+=N}}m=r.F._writeLit(256,B,f,m)}return m},r.F._copyExact=function(s,i,a,o,l){var c=l>>>3;return o[c]=a,o[c+1]=a>>>8,o[c+2]=255-o[c],o[c+3]=255-o[c+1],c+=4,o.set(new Uint8Array(s.buffer,i,a),c),l+(a+4<<3)},r.F.getTrees=function(){for(var s=r.F.U,i=r.F._hufTree(s.lhst,s.ltree,15),a=r.F._hufTree(s.dhst,s.dtree,15),o=[],l=r.F._lenCodes(s.ltree,o),c=[],u=r.F._lenCodes(s.dtree,c),f=0;f<o.length;f+=2)s.ihst[o[f]]++;for(f=0;f<c.length;f+=2)s.ihst[c[f]]++;for(var m=r.F._hufTree(s.ihst,s.itree,7),g=19;g>4&&s.itree[1+(s.ordr[g-1]<<1)]==0;)g--;return[i,a,m,l,u,g,o,c]},r.F.getSecond=function(s){for(var i=[],a=0;a<s.length;a+=2)i.push(s[a+1]);return i},r.F.nonZero=function(s){for(var i="",a=0;a<s.length;a+=2)s[a+1]!=0&&(i+=(a>>1)+",");return i},r.F.contSize=function(s,i){for(var a=0,o=0;o<i.length;o++)a+=i[o]*s[1+(o<<1)];return a},r.F._codeTiny=function(s,i,a,o){for(var l=0;l<s.length;l+=2){var c=s[l],u=s[l+1];o=r.F._writeLit(c,i,a,o);var f=c==16?2:c==17?3:7;c>15&&(r.F._putsE(a,o,u,f),o+=f)}return o},r.F._lenCodes=function(s,i){for(var a=s.length;a!=2&&s[a-1]==0;)a-=2;for(var o=0;o<a;o+=2){var l=s[o+1],c=o+3<a?s[o+3]:-1,u=o+5<a?s[o+5]:-1,f=o==0?-1:s[o-1];if(l==0&&c==l&&u==l){for(var m=o+5;m+2<a&&s[m+2]==l;)m+=2;(g=Math.min(m+1-o>>>1,138))<11?i.push(17,g-3):i.push(18,g-11),o+=2*g-2}else if(l==f&&c==l&&u==l){for(m=o+5;m+2<a&&s[m+2]==l;)m+=2;var g=Math.min(m+1-o>>>1,6);i.push(16,g-3),o+=2*g-2}else i.push(l,0)}return a>>>1},r.F._hufTree=function(s,i,a){var o=[],l=s.length,c=i.length,u=0;for(u=0;u<c;u+=2)i[u]=0,i[u+1]=0;for(u=0;u<l;u++)s[u]!=0&&o.push({lit:u,f:s[u]});var f=o.length,m=o.slice(0);if(f==0)return 0;if(f==1){var g=o[0].lit;return m=g==0?1:0,i[1+(g<<1)]=1,i[1+(m<<1)]=1,1}o.sort(function(R,I){return R.f-I.f});var y=o[0],b=o[1],x=0,S=1,T=2;for(o[0]={lit:-1,f:y.f+b.f,l:y,r:b,d:0};S!=f-1;)y=x!=S&&(T==f||o[x].f<o[T].f)?o[x++]:o[T++],b=x!=S&&(T==f||o[x].f<o[T].f)?o[x++]:o[T++],o[S++]={lit:-1,f:y.f+b.f,l:y,r:b};var _=r.F.setDepth(o[S-1],0);for(_>a&&(r.F.restrictDepth(m,a,_),_=a),u=0;u<f;u++)i[1+(m[u].lit<<1)]=m[u].d;return _},r.F.setDepth=function(s,i){return s.lit!=-1?(s.d=i,i):Math.max(r.F.setDepth(s.l,i+1),r.F.setDepth(s.r,i+1))},r.F.restrictDepth=function(s,i,a){var o=0,l=1<<a-i,c=0;for(s.sort(function(f,m){return m.d==f.d?f.f-m.f:m.d-f.d}),o=0;o<s.length&&s[o].d>i;o++){var u=s[o].d;s[o].d=i,c+=l-(1<<a-u)}for(c>>>=a-i;c>0;)(u=s[o].d)<i?(s[o].d++,c-=1<<i-u-1):o++;for(;o>=0;o--)s[o].d==i&&c<0&&(s[o].d--,c++);c!=0},r.F._goodIndex=function(s,i){var a=0;return i[16|a]<=s&&(a|=16),i[8|a]<=s&&(a|=8),i[4|a]<=s&&(a|=4),i[2|a]<=s&&(a|=2),i[1|a]<=s&&(a|=1),a},r.F._writeLit=function(s,i,a,o){return r.F._putsF(a,o,i[s<<1]),o+i[1+(s<<1)]},r.F.inflate=function(s,i){var a=Uint8Array;if(s[0]==3&&s[1]==0)return i||new a(0);var o=r.F,l=o._bitsF,c=o._bitsE,u=o._decodeTiny,f=o.makeCodes,m=o.codes2map,g=o._get17,y=o.U,b=i==null;b&&(i=new a(s.length>>>2<<3));for(var x,S,T=0,_=0,R=0,I=0,C=0,L=0,k=0,M=0,D=0;T==0;)if(T=l(s,D,1),_=l(s,D+1,2),D+=3,_!=0){if(b&&(i=r.F._check(i,M+(1<<17))),_==1&&(x=y.flmap,S=y.fdmap,L=511,k=31),_==2){R=c(s,D,5)+257,I=c(s,D+5,5)+1,C=c(s,D+10,4)+4,D+=14;for(var U=0;U<38;U+=2)y.itree[U]=0,y.itree[U+1]=0;var $=1;for(U=0;U<C;U++){var V=c(s,D+3*U,3);y.itree[1+(y.ordr[U]<<1)]=V,V>$&&($=V)}D+=3*C,f(y.itree,$),m(y.itree,$,y.imap),x=y.lmap,S=y.dmap,D=u(y.imap,(1<<$)-1,R+I,s,D,y.ttree);var B=o._copyOut(y.ttree,0,R,y.ltree);L=(1<<B)-1;var W=o._copyOut(y.ttree,R,I,y.dtree);k=(1<<W)-1,f(y.ltree,B),m(y.ltree,B,x),f(y.dtree,W),m(y.dtree,W,S)}for(;;){var F=x[g(s,D)&L];D+=15&F;var j=F>>>4;if(!(j>>>8))i[M++]=j;else{if(j==256)break;var q=M+j-254;if(j>264){var H=y.ldef[j-257];q=M+(H>>>3)+c(s,D,7&H),D+=7&H}var N=S[g(s,D)&k];D+=15&N;var O=N>>>4,z=y.ddef[O],G=(z>>>4)+l(s,D,15&z);for(D+=15&z,b&&(i=r.F._check(i,M+(1<<17)));M<q;)i[M]=i[M++-G],i[M]=i[M++-G],i[M]=i[M++-G],i[M]=i[M++-G];M=q}}}else{(7&D)!=0&&(D+=8-(7&D));var Y=4+(D>>>3),Q=s[Y-4]|s[Y-3]<<8;b&&(i=r.F._check(i,M+Q)),i.set(new a(s.buffer,s.byteOffset+Y,Q),M),D=Y+Q<<3,M+=Q}return i.length==M?i:i.slice(0,M)},r.F._check=function(s,i){var a=s.length;if(i<=a)return s;var o=new Uint8Array(Math.max(a<<1,i));return o.set(s,0),o},r.F._decodeTiny=function(s,i,a,o,l,c){for(var u=r.F._bitsE,f=r.F._get17,m=0;m<a;){var g=s[f(o,l)&i];l+=15&g;var y=g>>>4;if(y<=15)c[m]=y,m++;else{var b=0,x=0;y==16?(x=3+u(o,l,2),l+=2,b=c[m-1]):y==17?(x=3+u(o,l,3),l+=3):y==18&&(x=11+u(o,l,7),l+=7);for(var S=m+x;m<S;)c[m]=b,m++}}return l},r.F._copyOut=function(s,i,a,o){for(var l=0,c=0,u=o.length>>>1;c<a;){var f=s[c+i];o[c<<1]=0,o[1+(c<<1)]=f,f>l&&(l=f),c++}for(;c<u;)o[c<<1]=0,o[1+(c<<1)]=0,c++;return l},r.F.makeCodes=function(s,i){for(var a,o,l,c,u=r.F.U,f=s.length,m=u.bl_count,g=0;g<=i;g++)m[g]=0;for(g=1;g<f;g+=2)m[s[g]]++;var y=u.next_code;for(a=0,m[0]=0,o=1;o<=i;o++)a=a+m[o-1]<<1,y[o]=a;for(l=0;l<f;l+=2)(c=s[l+1])!=0&&(s[l]=y[c],y[c]++)},r.F.codes2map=function(s,i,a){for(var o=s.length,l=r.F.U.rev15,c=0;c<o;c+=2)if(s[c+1]!=0)for(var u=c>>1,f=s[c+1],m=u<<4|f,g=i-f,y=s[c]<<g,b=y+(1<<g);y!=b;)a[l[y]>>>15-i]=m,y++},r.F.revCodes=function(s,i){for(var a=r.F.U.rev15,o=15-i,l=0;l<s.length;l+=2){var c=s[l]<<i-s[l+1];s[l]=a[c]>>>o}},r.F._putsE=function(s,i,a){a<<=7&i;var o=i>>>3;s[o]|=a,s[o+1]|=a>>>8},r.F._putsF=function(s,i,a){a<<=7&i;var o=i>>>3;s[o]|=a,s[o+1]|=a>>>8,s[o+2]|=a>>>16},r.F._bitsE=function(s,i,a){return(s[i>>>3]|s[1+(i>>>3)]<<8)>>>(7&i)&(1<<a)-1},r.F._bitsF=function(s,i,a){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)&(1<<a)-1},r.F._get17=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)},r.F._get25=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16|s[3+(i>>>3)]<<24)>>>(7&i)},r.F.U=(e=Uint16Array,t=Uint32Array,{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(65536),prev:new e(32768)}),function(){for(var s=r.F.U,i=0;i<32768;i++){var a=i;a=(4278255360&(a=(4042322160&(a=(3435973836&(a=(2863311530&a)>>>1|(1431655765&a)<<1))>>>2|(858993459&a)<<2))>>>4|(252645135&a)<<4))>>>8|(16711935&a)<<8,s.rev15[i]=(a>>>16|a<<16)>>>17}function o(l,c,u){for(;c--!=0;)l.push(0,u)}for(i=0;i<32;i++)s.ldef[i]=s.of0[i]<<3|s.exb[i],s.ddef[i]=s.df0[i]<<4|s.dxb[i];o(s.fltree,144,8),o(s.fltree,112,9),o(s.fltree,24,7),o(s.fltree,8,8),r.F.makeCodes(s.fltree,9),r.F.codes2map(s.fltree,9,s.flmap),r.F.revCodes(s.fltree,9),o(s.fdtree,32,5),r.F.makeCodes(s.fdtree,5),r.F.codes2map(s.fdtree,5,s.fdmap),r.F.revCodes(s.fdtree,5),o(s.itree,19,0),o(s.ltree,286,0),o(s.dtree,30,0),o(s.ttree,320,0)}()})();var Z1e=Y1e({__proto__:null,default:uE},[uE]);const La=function(){var n={nextZero(u,f){for(;u[f]!=0;)f++;return f},readUshort:(u,f)=>u[f]<<8|u[f+1],writeUshort(u,f,m){u[f]=m>>8&255,u[f+1]=255&m},readUint:(u,f)=>16777216*u[f]+(u[f+1]<<16|u[f+2]<<8|u[f+3]),writeUint(u,f,m){u[f]=m>>24&255,u[f+1]=m>>16&255,u[f+2]=m>>8&255,u[f+3]=255&m},readASCII(u,f,m){let g="";for(let y=0;y<m;y++)g+=String.fromCharCode(u[f+y]);return g},writeASCII(u,f,m){for(let g=0;g<m.length;g++)u[f+g]=m.charCodeAt(g)},readBytes(u,f,m){const g=[];for(let y=0;y<m;y++)g.push(u[f+y]);return g},pad:u=>u.length<2?`0${u}`:u,readUTF8(u,f,m){let g,y="";for(let b=0;b<m;b++)y+=`%${n.pad(u[f+b].toString(16))}`;try{g=decodeURIComponent(y)}catch{return n.readASCII(u,f,m)}return g}};function e(u,f,m,g){const y=f*m,b=i(g),x=Math.ceil(f*b/8),S=new Uint8Array(4*y),T=new Uint32Array(S.buffer),{ctype:_}=g,{depth:R}=g,I=n.readUshort;if(_==6){const H=y<<2;if(R==8)for(var C=0;C<H;C+=4)S[C]=u[C],S[C+1]=u[C+1],S[C+2]=u[C+2],S[C+3]=u[C+3];if(R==16)for(C=0;C<H;C++)S[C]=u[C<<1]}else if(_==2){const H=g.tabs.tRNS;if(H==null){if(R==8)for(C=0;C<y;C++){var L=3*C;T[C]=255<<24|u[L+2]<<16|u[L+1]<<8|u[L]}if(R==16)for(C=0;C<y;C++)L=6*C,T[C]=255<<24|u[L+4]<<16|u[L+2]<<8|u[L]}else{var k=H[0];const N=H[1],O=H[2];if(R==8)for(C=0;C<y;C++){var M=C<<2;L=3*C,T[C]=255<<24|u[L+2]<<16|u[L+1]<<8|u[L],u[L]==k&&u[L+1]==N&&u[L+2]==O&&(S[M+3]=0)}if(R==16)for(C=0;C<y;C++)M=C<<2,L=6*C,T[C]=255<<24|u[L+4]<<16|u[L+2]<<8|u[L],I(u,L)==k&&I(u,L+2)==N&&I(u,L+4)==O&&(S[M+3]=0)}}else if(_==3){const H=g.tabs.PLTE,N=g.tabs.tRNS,O=N?N.length:0;if(R==1)for(var D=0;D<m;D++){var U=D*x,$=D*f;for(C=0;C<f;C++){M=$+C<<2;var V=3*(B=u[U+(C>>3)]>>7-((7&C)<<0)&1);S[M]=H[V],S[M+1]=H[V+1],S[M+2]=H[V+2],S[M+3]=B<O?N[B]:255}}if(R==2)for(D=0;D<m;D++)for(U=D*x,$=D*f,C=0;C<f;C++)M=$+C<<2,V=3*(B=u[U+(C>>2)]>>6-((3&C)<<1)&3),S[M]=H[V],S[M+1]=H[V+1],S[M+2]=H[V+2],S[M+3]=B<O?N[B]:255;if(R==4)for(D=0;D<m;D++)for(U=D*x,$=D*f,C=0;C<f;C++)M=$+C<<2,V=3*(B=u[U+(C>>1)]>>4-((1&C)<<2)&15),S[M]=H[V],S[M+1]=H[V+1],S[M+2]=H[V+2],S[M+3]=B<O?N[B]:255;if(R==8)for(C=0;C<y;C++){var B;M=C<<2,V=3*(B=u[C]),S[M]=H[V],S[M+1]=H[V+1],S[M+2]=H[V+2],S[M+3]=B<O?N[B]:255}}else if(_==4){if(R==8)for(C=0;C<y;C++){M=C<<2;var W=u[F=C<<1];S[M]=W,S[M+1]=W,S[M+2]=W,S[M+3]=u[F+1]}if(R==16)for(C=0;C<y;C++){var F;M=C<<2,W=u[F=C<<2],S[M]=W,S[M+1]=W,S[M+2]=W,S[M+3]=u[F+2]}}else if(_==0)for(k=g.tabs.tRNS?g.tabs.tRNS:-1,D=0;D<m;D++){const H=D*x,N=D*f;if(R==1)for(var j=0;j<f;j++){var q=(W=255*(u[H+(j>>>3)]>>>7-(7&j)&1))==255*k?0:255;T[N+j]=q<<24|W<<16|W<<8|W}else if(R==2)for(j=0;j<f;j++)q=(W=85*(u[H+(j>>>2)]>>>6-((3&j)<<1)&3))==85*k?0:255,T[N+j]=q<<24|W<<16|W<<8|W;else if(R==4)for(j=0;j<f;j++)q=(W=17*(u[H+(j>>>1)]>>>4-((1&j)<<2)&15))==17*k?0:255,T[N+j]=q<<24|W<<16|W<<8|W;else if(R==8)for(j=0;j<f;j++)q=(W=u[H+j])==k?0:255,T[N+j]=q<<24|W<<16|W<<8|W;else if(R==16)for(j=0;j<f;j++)W=u[H+(j<<1)],q=I(u,H+(j<<1))==k?0:255,T[N+j]=q<<24|W<<16|W<<8|W}return S}function t(u,f,m,g){const y=i(u),b=Math.ceil(m*y/8),x=new Uint8Array((b+1+u.interlace)*g);return f=u.tabs.CgBI?s(f,x):r(f,x),u.interlace==0?f=a(f,u,0,m,g):u.interlace==1&&(f=function(T,_){const R=_.width,I=_.height,C=i(_),L=C>>3,k=Math.ceil(R*C/8),M=new Uint8Array(I*k);let D=0;const U=[0,0,4,0,2,0,1],$=[0,4,0,2,0,1,0],V=[8,8,8,4,4,2,2],B=[8,8,4,4,2,2,1];let W=0;for(;W<7;){const j=V[W],q=B[W];let H=0,N=0,O=U[W];for(;O<I;)O+=j,N++;let z=$[W];for(;z<R;)z+=q,H++;const G=Math.ceil(H*C/8);a(T,_,D,H,N);let Y=0,Q=U[W];for(;Q<I;){let J=$[W],ee=D+Y*G<<3;for(;J<R;){var F;if(C==1&&(F=(F=T[ee>>3])>>7-(7&ee)&1,M[Q*k+(J>>3)]|=F<<7-((7&J)<<0)),C==2&&(F=(F=T[ee>>3])>>6-(7&ee)&3,M[Q*k+(J>>2)]|=F<<6-((3&J)<<1)),C==4&&(F=(F=T[ee>>3])>>4-(7&ee)&15,M[Q*k+(J>>1)]|=F<<4-((1&J)<<2)),C>=8){const oe=Q*k+J*L;for(let te=0;te<L;te++)M[oe+te]=T[(ee>>3)+te]}ee+=C,J+=q}Y++,Q+=j}H*N!=0&&(D+=N*(1+G)),W+=1}return M}(f,u)),f}function r(u,f){return s(new Uint8Array(u.buffer,2,u.length-6),f)}var s=function(){const u={H:{}};return u.H.N=function(f,m){const g=Uint8Array;let y,b,x=0,S=0,T=0,_=0,R=0,I=0,C=0,L=0,k=0;if(f[0]==3&&f[1]==0)return m||new g(0);const M=u.H,D=M.b,U=M.e,$=M.R,V=M.n,B=M.A,W=M.Z,F=M.m,j=m==null;for(j&&(m=new g(f.length>>>2<<5));x==0;)if(x=D(f,k,1),S=D(f,k+1,2),k+=3,S!=0){if(j&&(m=u.H.W(m,L+(1<<17))),S==1&&(y=F.J,b=F.h,I=511,C=31),S==2){T=U(f,k,5)+257,_=U(f,k+5,5)+1,R=U(f,k+10,4)+4,k+=14;let H=1;for(var q=0;q<38;q+=2)F.Q[q]=0,F.Q[q+1]=0;for(q=0;q<R;q++){const z=U(f,k+3*q,3);F.Q[1+(F.X[q]<<1)]=z,z>H&&(H=z)}k+=3*R,V(F.Q,H),B(F.Q,H,F.u),y=F.w,b=F.d,k=$(F.u,(1<<H)-1,T+_,f,k,F.v);const N=M.V(F.v,0,T,F.C);I=(1<<N)-1;const O=M.V(F.v,T,_,F.D);C=(1<<O)-1,V(F.C,N),B(F.C,N,y),V(F.D,O),B(F.D,O,b)}for(;;){const H=y[W(f,k)&I];k+=15&H;const N=H>>>4;if(!(N>>>8))m[L++]=N;else{if(N==256)break;{let O=L+N-254;if(N>264){const J=F.q[N-257];O=L+(J>>>3)+U(f,k,7&J),k+=7&J}const z=b[W(f,k)&C];k+=15&z;const G=z>>>4,Y=F.c[G],Q=(Y>>>4)+D(f,k,15&Y);for(k+=15&Y;L<O;)m[L]=m[L++-Q],m[L]=m[L++-Q],m[L]=m[L++-Q],m[L]=m[L++-Q];L=O}}}}else{(7&k)!=0&&(k+=8-(7&k));const H=4+(k>>>3),N=f[H-4]|f[H-3]<<8;j&&(m=u.H.W(m,L+N)),m.set(new g(f.buffer,f.byteOffset+H,N),L),k=H+N<<3,L+=N}return m.length==L?m:m.slice(0,L)},u.H.W=function(f,m){const g=f.length;if(m<=g)return f;const y=new Uint8Array(g<<1);return y.set(f,0),y},u.H.R=function(f,m,g,y,b,x){const S=u.H.e,T=u.H.Z;let _=0;for(;_<g;){const R=f[T(y,b)&m];b+=15&R;const I=R>>>4;if(I<=15)x[_]=I,_++;else{let C=0,L=0;I==16?(L=3+S(y,b,2),b+=2,C=x[_-1]):I==17?(L=3+S(y,b,3),b+=3):I==18&&(L=11+S(y,b,7),b+=7);const k=_+L;for(;_<k;)x[_]=C,_++}}return b},u.H.V=function(f,m,g,y){let b=0,x=0;const S=y.length>>>1;for(;x<g;){const T=f[x+m];y[x<<1]=0,y[1+(x<<1)]=T,T>b&&(b=T),x++}for(;x<S;)y[x<<1]=0,y[1+(x<<1)]=0,x++;return b},u.H.n=function(f,m){const g=u.H.m,y=f.length;let b,x,S,T;const _=g.j;for(var R=0;R<=m;R++)_[R]=0;for(R=1;R<y;R+=2)_[f[R]]++;const I=g.K;for(b=0,_[0]=0,x=1;x<=m;x++)b=b+_[x-1]<<1,I[x]=b;for(S=0;S<y;S+=2)T=f[S+1],T!=0&&(f[S]=I[T],I[T]++)},u.H.A=function(f,m,g){const y=f.length,b=u.H.m.r;for(let x=0;x<y;x+=2)if(f[x+1]!=0){const S=x>>1,T=f[x+1],_=S<<4|T,R=m-T;let I=f[x]<<R;const C=I+(1<<R);for(;I!=C;)g[b[I]>>>15-m]=_,I++}},u.H.l=function(f,m){const g=u.H.m.r,y=15-m;for(let b=0;b<f.length;b+=2){const x=f[b]<<m-f[b+1];f[b]=g[x]>>>y}},u.H.M=function(f,m,g){g<<=7&m;const y=m>>>3;f[y]|=g,f[y+1]|=g>>>8},u.H.I=function(f,m,g){g<<=7&m;const y=m>>>3;f[y]|=g,f[y+1]|=g>>>8,f[y+2]|=g>>>16},u.H.e=function(f,m,g){return(f[m>>>3]|f[1+(m>>>3)]<<8)>>>(7&m)&(1<<g)-1},u.H.b=function(f,m,g){return(f[m>>>3]|f[1+(m>>>3)]<<8|f[2+(m>>>3)]<<16)>>>(7&m)&(1<<g)-1},u.H.Z=function(f,m){return(f[m>>>3]|f[1+(m>>>3)]<<8|f[2+(m>>>3)]<<16)>>>(7&m)},u.H.i=function(f,m){return(f[m>>>3]|f[1+(m>>>3)]<<8|f[2+(m>>>3)]<<16|f[3+(m>>>3)]<<24)>>>(7&m)},u.H.m=function(){const f=Uint16Array,m=Uint32Array;return{K:new f(16),j:new f(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new f(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new m(32),J:new f(512),_:[],h:new f(32),$:[],w:new f(32768),C:[],v:[],d:new f(32768),D:[],u:new f(512),Q:[],r:new f(32768),s:new m(286),Y:new m(30),a:new m(19),t:new m(15e3),k:new f(65536),g:new f(32768)}}(),function(){const f=u.H.m;for(var m=0;m<32768;m++){let y=m;y=(2863311530&y)>>>1|(1431655765&y)<<1,y=(3435973836&y)>>>2|(858993459&y)<<2,y=(4042322160&y)>>>4|(252645135&y)<<4,y=(4278255360&y)>>>8|(16711935&y)<<8,f.r[m]=(y>>>16|y<<16)>>>17}function g(y,b,x){for(;b--!=0;)y.push(0,x)}for(m=0;m<32;m++)f.q[m]=f.S[m]<<3|f.T[m],f.c[m]=f.p[m]<<4|f.z[m];g(f._,144,8),g(f._,112,9),g(f._,24,7),g(f._,8,8),u.H.n(f._,9),u.H.A(f._,9,f.J),u.H.l(f._,9),g(f.$,32,5),u.H.n(f.$,5),u.H.A(f.$,5,f.h),u.H.l(f.$,5),g(f.Q,19,0),g(f.C,286,0),g(f.D,30,0),g(f.v,320,0)}(),u.H.N}();function i(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth}function a(u,f,m,g,y){let b=i(f);const x=Math.ceil(g*b/8);let S,T;b=Math.ceil(b/8);let _=u[m],R=0;if(_>1&&(u[m]=[0,0,1][_-2]),_==3)for(R=b;R<x;R++)u[R+1]=u[R+1]+(u[R+1-b]>>>1)&255;for(let I=0;I<y;I++)if(S=m+I*x,T=S+I+1,_=u[T-1],R=0,_==0)for(;R<x;R++)u[S+R]=u[T+R];else if(_==1){for(;R<b;R++)u[S+R]=u[T+R];for(;R<x;R++)u[S+R]=u[T+R]+u[S+R-b]}else if(_==2)for(;R<x;R++)u[S+R]=u[T+R]+u[S+R-x];else if(_==3){for(;R<b;R++)u[S+R]=u[T+R]+(u[S+R-x]>>>1);for(;R<x;R++)u[S+R]=u[T+R]+(u[S+R-x]+u[S+R-b]>>>1)}else{for(;R<b;R++)u[S+R]=u[T+R]+o(0,u[S+R-x],0);for(;R<x;R++)u[S+R]=u[T+R]+o(u[S+R-b],u[S+R-x],u[S+R-b-x])}return u}function o(u,f,m){const g=u+f-m,y=g-u,b=g-f,x=g-m;return y*y<=b*b&&y*y<=x*x?u:b*b<=x*x?f:m}function l(u,f,m){m.width=n.readUint(u,f),f+=4,m.height=n.readUint(u,f),f+=4,m.depth=u[f],f++,m.ctype=u[f],f++,m.compress=u[f],f++,m.filter=u[f],f++,m.interlace=u[f],f++}function c(u,f,m,g,y,b,x,S,T){const _=Math.min(f,y),R=Math.min(m,b);let I=0,C=0;for(let W=0;W<R;W++)for(let F=0;F<_;F++)if(x>=0&&S>=0?(I=W*f+F<<2,C=(S+W)*y+x+F<<2):(I=(-S+W)*f-x+F<<2,C=W*y+F<<2),T==0)g[C]=u[I],g[C+1]=u[I+1],g[C+2]=u[I+2],g[C+3]=u[I+3];else if(T==1){var L=u[I+3]*.00392156862745098,k=u[I]*L,M=u[I+1]*L,D=u[I+2]*L,U=g[C+3]*(1/255),$=g[C]*U,V=g[C+1]*U,B=g[C+2]*U;const j=1-L,q=L+U*j,H=q==0?0:1/q;g[C+3]=255*q,g[C+0]=(k+$*j)*H,g[C+1]=(M+V*j)*H,g[C+2]=(D+B*j)*H}else if(T==2)L=u[I+3],k=u[I],M=u[I+1],D=u[I+2],U=g[C+3],$=g[C],V=g[C+1],B=g[C+2],L==U&&k==$&&M==V&&D==B?(g[C]=0,g[C+1]=0,g[C+2]=0,g[C+3]=0):(g[C]=k,g[C+1]=M,g[C+2]=D,g[C+3]=L);else if(T==3){if(L=u[I+3],k=u[I],M=u[I+1],D=u[I+2],U=g[C+3],$=g[C],V=g[C+1],B=g[C+2],L==U&&k==$&&M==V&&D==B)continue;if(L<220&&U>20)return!1}return!0}return{decode:function(f){const m=new Uint8Array(f);let g=8;const y=n,b=y.readUshort,x=y.readUint,S={tabs:{},frames:[]},T=new Uint8Array(m.length);let _,R=0,I=0;const C=[137,80,78,71,13,10,26,10];for(var L=0;L<8;L++)if(m[L]!=C[L])throw"The input is not a PNG file!";for(;g<m.length;){const W=y.readUint(m,g);g+=4;const F=y.readASCII(m,g,4);if(g+=4,F=="IHDR")l(m,g,S);else if(F=="iCCP"){for(var k=g;m[k]!=0;)k++;y.readASCII(m,g,k-g),m[k+1];const j=m.slice(k+2,g+W);let q=null;try{q=r(j)}catch{q=s(j)}S.tabs[F]=q}else if(F=="CgBI")S.tabs[F]=m.slice(g,g+4);else if(F=="IDAT"){for(L=0;L<W;L++)T[R+L]=m[g+L];R+=W}else if(F=="acTL")S.tabs[F]={num_frames:x(m,g),num_plays:x(m,g+4)},_=new Uint8Array(m.length);else if(F=="fcTL"){I!=0&&((B=S.frames[S.frames.length-1]).data=t(S,_.slice(0,I),B.rect.width,B.rect.height),I=0);const j={x:x(m,g+12),y:x(m,g+16),width:x(m,g+4),height:x(m,g+8)};let q=b(m,g+22);q=b(m,g+20)/(q==0?100:q);const H={rect:j,delay:Math.round(1e3*q),dispose:m[g+24],blend:m[g+25]};S.frames.push(H)}else if(F=="fdAT"){for(L=0;L<W-4;L++)_[I+L]=m[g+L+4];I+=W-4}else if(F=="pHYs")S.tabs[F]=[y.readUint(m,g),y.readUint(m,g+4),m[g+8]];else if(F=="cHRM")for(S.tabs[F]=[],L=0;L<8;L++)S.tabs[F].push(y.readUint(m,g+4*L));else if(F=="tEXt"||F=="zTXt"){S.tabs[F]==null&&(S.tabs[F]={});var M=y.nextZero(m,g),D=y.readASCII(m,g,M-g),U=g+W-M-1;if(F=="tEXt")V=y.readASCII(m,M+1,U);else{var $=r(m.slice(M+2,M+2+U));V=y.readUTF8($,0,$.length)}S.tabs[F][D]=V}else if(F=="iTXt"){S.tabs[F]==null&&(S.tabs[F]={}),M=0,k=g,M=y.nextZero(m,k),D=y.readASCII(m,k,M-k);const j=m[k=M+1];var V;m[k+1],k+=2,M=y.nextZero(m,k),y.readASCII(m,k,M-k),k=M+1,M=y.nextZero(m,k),y.readUTF8(m,k,M-k),U=W-((k=M+1)-g),j==0?V=y.readUTF8(m,k,U):($=r(m.slice(k,k+U)),V=y.readUTF8($,0,$.length)),S.tabs[F][D]=V}else if(F=="PLTE")S.tabs[F]=y.readBytes(m,g,W);else if(F=="hIST"){const j=S.tabs.PLTE.length/3;for(S.tabs[F]=[],L=0;L<j;L++)S.tabs[F].push(b(m,g+2*L))}else if(F=="tRNS")S.ctype==3?S.tabs[F]=y.readBytes(m,g,W):S.ctype==0?S.tabs[F]=b(m,g):S.ctype==2&&(S.tabs[F]=[b(m,g),b(m,g+2),b(m,g+4)]);else if(F=="gAMA")S.tabs[F]=y.readUint(m,g)/1e5;else if(F=="sRGB")S.tabs[F]=m[g];else if(F=="bKGD")S.ctype==0||S.ctype==4?S.tabs[F]=[b(m,g)]:S.ctype==2||S.ctype==6?S.tabs[F]=[b(m,g),b(m,g+2),b(m,g+4)]:S.ctype==3&&(S.tabs[F]=m[g]);else if(F=="IEND")break;g+=W,y.readUint(m,g),g+=4}var B;return I!=0&&((B=S.frames[S.frames.length-1]).data=t(S,_.slice(0,I),B.rect.width,B.rect.height)),S.data=t(S,T,S.width,S.height),delete S.compress,delete S.interlace,delete S.filter,S},toRGBA8:function(f){const m=f.width,g=f.height;if(f.tabs.acTL==null)return[e(f.data,m,g,f).buffer];const y=[];f.frames[0].data==null&&(f.frames[0].data=f.data);const b=m*g*4,x=new Uint8Array(b),S=new Uint8Array(b),T=new Uint8Array(b);for(let R=0;R<f.frames.length;R++){const I=f.frames[R],C=I.rect.x,L=I.rect.y,k=I.rect.width,M=I.rect.height,D=e(I.data,k,M,f);if(R!=0)for(var _=0;_<b;_++)T[_]=x[_];if(I.blend==0?c(D,k,M,x,m,g,C,L,0):I.blend==1&&c(D,k,M,x,m,g,C,L,1),y.push(x.buffer.slice(0)),I.dispose!=0){if(I.dispose==1)c(S,k,M,x,m,g,C,L,0);else if(I.dispose==2)for(_=0;_<b;_++)x[_]=T[_]}}return y},_paeth:o,_copyTile:c,_bin:n}}();(function(){const{_copyTile:n}=La,{_bin:e}=La,t=La._paeth;var r={table:function(){const k=new Uint32Array(256);for(let M=0;M<256;M++){let D=M;for(let U=0;U<8;U++)1&D?D=3988292384^D>>>1:D>>>=1;k[M]=D}return k}(),update(k,M,D,U){for(let $=0;$<U;$++)k=r.table[255&(k^M[D+$])]^k>>>8;return k},crc:(k,M,D)=>4294967295^r.update(4294967295,k,M,D)};function s(k,M,D,U){M[D]+=k[0]*U>>4,M[D+1]+=k[1]*U>>4,M[D+2]+=k[2]*U>>4,M[D+3]+=k[3]*U>>4}function i(k){return Math.max(0,Math.min(255,k))}function a(k,M){const D=k[0]-M[0],U=k[1]-M[1],$=k[2]-M[2],V=k[3]-M[3];return D*D+U*U+$*$+V*V}function o(k,M,D,U,$,V,B){B==null&&(B=1);const W=U.length,F=[];for(var j=0;j<W;j++){const Q=U[j];F.push([Q>>>0&255,Q>>>8&255,Q>>>16&255,Q>>>24&255])}for(j=0;j<W;j++){let Q=4294967295;for(var q=0,H=0;H<W;H++){var N=a(F[j],F[H]);H!=j&&N<Q&&(Q=N,q=H)}}const O=new Uint32Array($.buffer),z=new Int16Array(M*D*4),G=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(j=0;j<G.length;j++)G[j]=255*((G[j]+.5)/16-.5);for(let Q=0;Q<D;Q++)for(let J=0;J<M;J++){var Y;j=4*(Q*M+J),B!=2?Y=[i(k[j]+z[j]),i(k[j+1]+z[j+1]),i(k[j+2]+z[j+2]),i(k[j+3]+z[j+3])]:(N=G[4*(3&Q)+(3&J)],Y=[i(k[j]+N),i(k[j+1]+N),i(k[j+2]+N),i(k[j+3]+N)]),q=0;let ee=16777215;for(H=0;H<W;H++){const se=a(Y,F[H]);se<ee&&(ee=se,q=H)}const oe=F[q],te=[Y[0]-oe[0],Y[1]-oe[1],Y[2]-oe[2],Y[3]-oe[3]];B==1&&(J!=M-1&&s(te,z,j+4,7),Q!=D-1&&(J!=0&&s(te,z,j+4*M-4,3),s(te,z,j+4*M,5),J!=M-1&&s(te,z,j+4*M+4,1))),V[j>>2]=q,O[j>>2]=U[q]}}function l(k,M,D,U,$){$==null&&($={});const{crc:V}=r,B=e.writeUint,W=e.writeUshort,F=e.writeASCII;let j=8;const q=k.frames.length>1;let H,N=!1,O=33+(q?20:0);if($.sRGB!=null&&(O+=13),$.pHYs!=null&&(O+=21),$.iCCP!=null&&(H=pako.deflate($.iCCP),O+=21+H.length+4),k.ctype==3){for(var z=k.plte.length,G=0;G<z;G++)k.plte[G]>>>24!=255&&(N=!0);O+=8+3*z+4+(N?8+1*z+4:0)}for(var Y=0;Y<k.frames.length;Y++)q&&(O+=38),O+=(oe=k.frames[Y]).cimg.length+12,Y!=0&&(O+=4);O+=12;const Q=new Uint8Array(O),J=[137,80,78,71,13,10,26,10];for(G=0;G<8;G++)Q[G]=J[G];if(B(Q,j,13),j+=4,F(Q,j,"IHDR"),j+=4,B(Q,j,M),j+=4,B(Q,j,D),j+=4,Q[j]=k.depth,j++,Q[j]=k.ctype,j++,Q[j]=0,j++,Q[j]=0,j++,Q[j]=0,j++,B(Q,j,V(Q,j-17,17)),j+=4,$.sRGB!=null&&(B(Q,j,1),j+=4,F(Q,j,"sRGB"),j+=4,Q[j]=$.sRGB,j++,B(Q,j,V(Q,j-5,5)),j+=4),$.iCCP!=null){const te=13+H.length;B(Q,j,te),j+=4,F(Q,j,"iCCP"),j+=4,F(Q,j,"ICC profile"),j+=11,j+=2,Q.set(H,j),j+=H.length,B(Q,j,V(Q,j-(te+4),te+4)),j+=4}if($.pHYs!=null&&(B(Q,j,9),j+=4,F(Q,j,"pHYs"),j+=4,B(Q,j,$.pHYs[0]),j+=4,B(Q,j,$.pHYs[1]),j+=4,Q[j]=$.pHYs[2],j++,B(Q,j,V(Q,j-13,13)),j+=4),q&&(B(Q,j,8),j+=4,F(Q,j,"acTL"),j+=4,B(Q,j,k.frames.length),j+=4,B(Q,j,$.loop!=null?$.loop:0),j+=4,B(Q,j,V(Q,j-12,12)),j+=4),k.ctype==3){for(B(Q,j,3*(z=k.plte.length)),j+=4,F(Q,j,"PLTE"),j+=4,G=0;G<z;G++){const te=3*G,se=k.plte[G],he=255&se,Z=se>>>8&255,pe=se>>>16&255;Q[j+te+0]=he,Q[j+te+1]=Z,Q[j+te+2]=pe}if(j+=3*z,B(Q,j,V(Q,j-3*z-4,3*z+4)),j+=4,N){for(B(Q,j,z),j+=4,F(Q,j,"tRNS"),j+=4,G=0;G<z;G++)Q[j+G]=k.plte[G]>>>24&255;j+=z,B(Q,j,V(Q,j-z-4,z+4)),j+=4}}let ee=0;for(Y=0;Y<k.frames.length;Y++){var oe=k.frames[Y];q&&(B(Q,j,26),j+=4,F(Q,j,"fcTL"),j+=4,B(Q,j,ee++),j+=4,B(Q,j,oe.rect.width),j+=4,B(Q,j,oe.rect.height),j+=4,B(Q,j,oe.rect.x),j+=4,B(Q,j,oe.rect.y),j+=4,W(Q,j,U[Y]),j+=2,W(Q,j,1e3),j+=2,Q[j]=oe.dispose,j++,Q[j]=oe.blend,j++,B(Q,j,V(Q,j-30,30)),j+=4);const te=oe.cimg;B(Q,j,(z=te.length)+(Y==0?0:4)),j+=4;const se=j;F(Q,j,Y==0?"IDAT":"fdAT"),j+=4,Y!=0&&(B(Q,j,ee++),j+=4),Q.set(te,j),j+=z,B(Q,j,V(Q,se,j-se)),j+=4}return B(Q,j,0),j+=4,F(Q,j,"IEND"),j+=4,B(Q,j,V(Q,j-4,4)),j+=4,Q.buffer}function c(k,M,D){for(let U=0;U<k.frames.length;U++){const $=k.frames[U];$.rect.width;const V=$.rect.height,B=new Uint8Array(V*$.bpl+V);$.cimg=g($.img,V,$.bpp,$.bpl,B,M,D)}}function u(k,M,D,U,$){const V=$[0],B=$[1],W=$[2],F=$[3],j=$[4],q=$[5];let H=6,N=8,O=255;for(var z=0;z<k.length;z++){const le=new Uint8Array(k[z]);for(var G=le.length,Y=0;Y<G;Y+=4)O&=le[Y+3]}const Q=O!=255,J=function(ie,fe,Ie,ne,ce,Ce){const Oe=[];for(var ze=0;ze<ie.length;ze++){const Ae=new Uint8Array(ie[ze]),Me=new Uint32Array(Ae.buffer);var We;let Ue=0,Ge=0,Ke=fe,Qe=Ie,ht=ne?1:0;if(ze!=0){const Vt=Ce||ne||ze==1||Oe[ze-2].dispose!=0?1:2;let mn=0,xn=1e9;for(let Bn=0;Bn<Vt;Bn++){var tt=new Uint8Array(ie[ze-1-Bn]);const An=new Uint32Array(ie[ze-1-Bn]);let Lt=fe,jt=Ie,Xt=-1,nt=-1;for(let ot=0;ot<Ie;ot++)for(let Dt=0;Dt<fe;Dt++)Me[Ee=ot*fe+Dt]!=An[Ee]&&(Dt<Lt&&(Lt=Dt),Dt>Xt&&(Xt=Dt),ot<jt&&(jt=ot),ot>nt&&(nt=ot));Xt==-1&&(Lt=jt=Xt=nt=0),ce&&((1&Lt)==1&&Lt--,(1&jt)==1&&jt--);const Je=(Xt-Lt+1)*(nt-jt+1);Je<xn&&(xn=Je,mn=Bn,Ue=Lt,Ge=jt,Ke=Xt-Lt+1,Qe=nt-jt+1)}tt=new Uint8Array(ie[ze-1-mn]),mn==1&&(Oe[ze-1].dispose=2),We=new Uint8Array(Ke*Qe*4),n(tt,fe,Ie,We,Ke,Qe,-Ue,-Ge,0),ht=n(Ae,fe,Ie,We,Ke,Qe,-Ue,-Ge,3)?1:0,ht==1?m(Ae,fe,Ie,We,{x:Ue,y:Ge,width:Ke,height:Qe}):n(Ae,fe,Ie,We,Ke,Qe,-Ue,-Ge,0)}else We=Ae.slice(0);Oe.push({rect:{x:Ue,y:Ge,width:Ke,height:Qe},img:We,blend:ht,dispose:0})}if(ne)for(ze=0;ze<Oe.length;ze++){if((be=Oe[ze]).blend==1)continue;const Ae=be.rect,Me=Oe[ze-1].rect,Ue=Math.min(Ae.x,Me.x),Ge=Math.min(Ae.y,Me.y),Ke={x:Ue,y:Ge,width:Math.max(Ae.x+Ae.width,Me.x+Me.width)-Ue,height:Math.max(Ae.y+Ae.height,Me.y+Me.height)-Ge};Oe[ze-1].dispose=1,ze-1!=0&&f(ie,fe,Ie,Oe,ze-1,Ke,ce),f(ie,fe,Ie,Oe,ze,Ke,ce)}let lt=0;if(ie.length!=1)for(var Ee=0;Ee<Oe.length;Ee++){var be;lt+=(be=Oe[Ee]).rect.width*be.rect.height}return Oe}(k,M,D,V,B,W),ee={},oe=[],te=[];if(U!=0){const le=[];for(Y=0;Y<J.length;Y++)le.push(J[Y].img.buffer);const ie=function(ce){let Ce=0;for(var Oe=0;Oe<ce.length;Oe++)Ce+=ce[Oe].byteLength;const ze=new Uint8Array(Ce);let We=0;for(Oe=0;Oe<ce.length;Oe++){const tt=new Uint8Array(ce[Oe]),lt=tt.length;for(let Ee=0;Ee<lt;Ee+=4){let be=tt[Ee],Ae=tt[Ee+1],Me=tt[Ee+2];const Ue=tt[Ee+3];Ue==0&&(be=Ae=Me=0),ze[We+Ee]=be,ze[We+Ee+1]=Ae,ze[We+Ee+2]=Me,ze[We+Ee+3]=Ue}We+=lt}return ze.buffer}(le),fe=b(ie,U);for(Y=0;Y<fe.plte.length;Y++)oe.push(fe.plte[Y].est.rgba);let Ie=0;for(Y=0;Y<J.length;Y++){const ne=(he=J[Y]).img.length;var se=new Uint8Array(fe.inds.buffer,Ie>>2,ne>>2);te.push(se);const ce=new Uint8Array(fe.abuf,Ie,ne);q&&o(he.img,he.rect.width,he.rect.height,oe,ce,se),he.img.set(ce),Ie+=ne}}else for(z=0;z<J.length;z++){var he=J[z];const le=new Uint32Array(he.img.buffer);var Z=he.rect.width;for(G=le.length,se=new Uint8Array(G),te.push(se),Y=0;Y<G;Y++){const ie=le[Y];if(Y!=0&&ie==le[Y-1])se[Y]=se[Y-1];else if(Y>Z&&ie==le[Y-Z])se[Y]=se[Y-Z];else{let fe=ee[ie];if(fe==null&&(ee[ie]=fe=oe.length,oe.push(ie),oe.length>=300))break;se[Y]=fe}}}const pe=oe.length;for(pe<=256&&j==0&&(N=pe<=2?1:pe<=4?2:pe<=16?4:8,N=Math.max(N,F)),z=0;z<J.length;z++){(he=J[z]).rect.x,he.rect.y,Z=he.rect.width;const le=he.rect.height;let ie=he.img;new Uint32Array(ie.buffer);let fe=4*Z,Ie=4;if(pe<=256&&j==0){fe=Math.ceil(N*Z/8);var ye=new Uint8Array(fe*le);const ne=te[z];for(let ce=0;ce<le;ce++){Y=ce*fe;const Ce=ce*Z;if(N==8)for(var ae=0;ae<Z;ae++)ye[Y+ae]=ne[Ce+ae];else if(N==4)for(ae=0;ae<Z;ae++)ye[Y+(ae>>1)]|=ne[Ce+ae]<<4-4*(1&ae);else if(N==2)for(ae=0;ae<Z;ae++)ye[Y+(ae>>2)]|=ne[Ce+ae]<<6-2*(3&ae);else if(N==1)for(ae=0;ae<Z;ae++)ye[Y+(ae>>3)]|=ne[Ce+ae]<<7-1*(7&ae)}ie=ye,H=3,Ie=1}else if(Q==0&&J.length==1){ye=new Uint8Array(Z*le*3);const ne=Z*le;for(Y=0;Y<ne;Y++){const ce=3*Y,Ce=4*Y;ye[ce]=ie[Ce],ye[ce+1]=ie[Ce+1],ye[ce+2]=ie[Ce+2]}ie=ye,H=2,Ie=3,fe=3*Z}he.img=ie,he.bpl=fe,he.bpp=Ie}return{ctype:H,depth:N,plte:oe,frames:J}}function f(k,M,D,U,$,V,B){const W=Uint8Array,F=Uint32Array,j=new W(k[$-1]),q=new F(k[$-1]),H=$+1<k.length?new W(k[$+1]):null,N=new W(k[$]),O=new F(N.buffer);let z=M,G=D,Y=-1,Q=-1;for(let ee=0;ee<V.height;ee++)for(let oe=0;oe<V.width;oe++){const te=V.x+oe,se=V.y+ee,he=se*M+te,Z=O[he];Z==0||U[$-1].dispose==0&&q[he]==Z&&(H==null||H[4*he+3]!=0)||(te<z&&(z=te),te>Y&&(Y=te),se<G&&(G=se),se>Q&&(Q=se))}Y==-1&&(z=G=Y=Q=0),B&&((1&z)==1&&z--,(1&G)==1&&G--),V={x:z,y:G,width:Y-z+1,height:Q-G+1};const J=U[$];J.rect=V,J.blend=1,J.img=new Uint8Array(V.width*V.height*4),U[$-1].dispose==0?(n(j,M,D,J.img,V.width,V.height,-V.x,-V.y,0),m(N,M,D,J.img,V)):n(N,M,D,J.img,V.width,V.height,-V.x,-V.y,0)}function m(k,M,D,U,$){n(k,M,D,U,$.width,$.height,-$.x,-$.y,2)}function g(k,M,D,U,$,V,B){const W=[];let F,j=[0,1,2,3,4];V!=-1?j=[V]:(M*U>5e5||D==1)&&(j=[0]),B&&(F={level:0});const q=Z1e;for(var H=0;H<j.length;H++){for(let z=0;z<M;z++)y($,k,z,U,D,j[H]);W.push(q.deflate($,F))}let N,O=1e9;for(H=0;H<W.length;H++)W[H].length<O&&(N=H,O=W[H].length);return W[N]}function y(k,M,D,U,$,V){const B=D*U;let W=B+D;if(k[W]=V,W++,V==0)if(U<500)for(var F=0;F<U;F++)k[W+F]=M[B+F];else k.set(new Uint8Array(M.buffer,B,U),W);else if(V==1){for(F=0;F<$;F++)k[W+F]=M[B+F];for(F=$;F<U;F++)k[W+F]=M[B+F]-M[B+F-$]+256&255}else if(D==0){for(F=0;F<$;F++)k[W+F]=M[B+F];if(V==2)for(F=$;F<U;F++)k[W+F]=M[B+F];if(V==3)for(F=$;F<U;F++)k[W+F]=M[B+F]-(M[B+F-$]>>1)+256&255;if(V==4)for(F=$;F<U;F++)k[W+F]=M[B+F]-t(M[B+F-$],0,0)+256&255}else{if(V==2)for(F=0;F<U;F++)k[W+F]=M[B+F]+256-M[B+F-U]&255;if(V==3){for(F=0;F<$;F++)k[W+F]=M[B+F]+256-(M[B+F-U]>>1)&255;for(F=$;F<U;F++)k[W+F]=M[B+F]+256-(M[B+F-U]+M[B+F-$]>>1)&255}if(V==4){for(F=0;F<$;F++)k[W+F]=M[B+F]+256-t(0,M[B+F-U],0)&255;for(F=$;F<U;F++)k[W+F]=M[B+F]+256-t(M[B+F-$],M[B+F-U],M[B+F-$-U])&255}}}function b(k,M){const D=new Uint8Array(k),U=D.slice(0),$=new Uint32Array(U.buffer),V=x(U,M),B=V[0],W=V[1],F=D.length,j=new Uint8Array(F>>2);let q;if(D.length<2e7)for(var H=0;H<F;H+=4)q=S(B,N=D[H]*(1/255),O=D[H+1]*(1/255),z=D[H+2]*(1/255),G=D[H+3]*(1/255)),j[H>>2]=q.ind,$[H>>2]=q.est.rgba;else for(H=0;H<F;H+=4){var N=D[H]*.00392156862745098,O=D[H+1]*(1/255),z=D[H+2]*(1/255),G=D[H+3]*(1/255);for(q=B;q.left;)q=T(q.est,N,O,z,G)<=0?q.left:q.right;j[H>>2]=q.ind,$[H>>2]=q.est.rgba}return{abuf:U.buffer,inds:j,plte:W}}function x(k,M,D){D==null&&(D=1e-4);const U=new Uint32Array(k.buffer),$={i0:0,i1:k.length,bst:null,est:null,tdst:0,left:null,right:null};$.bst=I(k,$.i0,$.i1),$.est=C($.bst);const V=[$];for(;V.length<M;){let W=0,F=0;for(var B=0;B<V.length;B++)V[B].est.L>W&&(W=V[B].est.L,F=B);if(W<D)break;const j=V[F],q=_(k,U,j.i0,j.i1,j.est.e,j.est.eMq255);if(j.i0>=q||j.i1<=q){j.est.L=0;continue}const H={i0:j.i0,i1:q,bst:null,est:null,tdst:0,left:null,right:null};H.bst=I(k,H.i0,H.i1),H.est=C(H.bst);const N={i0:q,i1:j.i1,bst:null,est:null,tdst:0,left:null,right:null};for(N.bst={R:[],m:[],N:j.bst.N-H.bst.N},B=0;B<16;B++)N.bst.R[B]=j.bst.R[B]-H.bst.R[B];for(B=0;B<4;B++)N.bst.m[B]=j.bst.m[B]-H.bst.m[B];N.est=C(N.bst),j.left=H,j.right=N,V[F]=H,V.push(N)}for(V.sort((W,F)=>F.bst.N-W.bst.N),B=0;B<V.length;B++)V[B].ind=B;return[$,V]}function S(k,M,D,U,$){if(k.left==null)return k.tdst=function(H,N,O,z,G){const Y=N-H[0],Q=O-H[1],J=z-H[2],ee=G-H[3];return Y*Y+Q*Q+J*J+ee*ee}(k.est.q,M,D,U,$),k;const V=T(k.est,M,D,U,$);let B=k.left,W=k.right;V>0&&(B=k.right,W=k.left);const F=S(B,M,D,U,$);if(F.tdst<=V*V)return F;const j=S(W,M,D,U,$);return j.tdst<F.tdst?j:F}function T(k,M,D,U,$){const{e:V}=k;return V[0]*M+V[1]*D+V[2]*U+V[3]*$-k.eMq}function _(k,M,D,U,$,V){for(U-=4;D<U;){for(;R(k,D,$)<=V;)D+=4;for(;R(k,U,$)>V;)U-=4;if(D>=U)break;const B=M[D>>2];M[D>>2]=M[U>>2],M[U>>2]=B,D+=4,U-=4}for(;R(k,D,$)>V;)D-=4;return D+4}function R(k,M,D){return k[M]*D[0]+k[M+1]*D[1]+k[M+2]*D[2]+k[M+3]*D[3]}function I(k,M,D){const U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$=[0,0,0,0],V=D-M>>2;for(let B=M;B<D;B+=4){const W=k[B]*.00392156862745098,F=k[B+1]*(1/255),j=k[B+2]*(1/255),q=k[B+3]*(1/255);$[0]+=W,$[1]+=F,$[2]+=j,$[3]+=q,U[0]+=W*W,U[1]+=W*F,U[2]+=W*j,U[3]+=W*q,U[5]+=F*F,U[6]+=F*j,U[7]+=F*q,U[10]+=j*j,U[11]+=j*q,U[15]+=q*q}return U[4]=U[1],U[8]=U[2],U[9]=U[6],U[12]=U[3],U[13]=U[7],U[14]=U[11],{R:U,m:$,N:V}}function C(k){const{R:M}=k,{m:D}=k,{N:U}=k,$=D[0],V=D[1],B=D[2],W=D[3],F=U==0?0:1/U,j=[M[0]-$*$*F,M[1]-$*V*F,M[2]-$*B*F,M[3]-$*W*F,M[4]-V*$*F,M[5]-V*V*F,M[6]-V*B*F,M[7]-V*W*F,M[8]-B*$*F,M[9]-B*V*F,M[10]-B*B*F,M[11]-B*W*F,M[12]-W*$*F,M[13]-W*V*F,M[14]-W*B*F,M[15]-W*W*F],q=j,H=L;let N=[Math.random(),Math.random(),Math.random(),Math.random()],O=0,z=0;if(U!=0)for(let Y=0;Y<16&&(N=H.multVec(q,N),z=Math.sqrt(H.dot(N,N)),N=H.sml(1/z,N),!(Y!=0&&Math.abs(z-O)<1e-9));Y++)O=z;const G=[$*F,V*F,B*F,W*F];return{Cov:j,q:G,e:N,L:O,eMq255:H.dot(H.sml(255,G),N),eMq:H.dot(N,G),rgba:(Math.round(255*G[3])<<24|Math.round(255*G[2])<<16|Math.round(255*G[1])<<8|Math.round(255*G[0])<<0)>>>0}}var L={multVec:(k,M)=>[k[0]*M[0]+k[1]*M[1]+k[2]*M[2]+k[3]*M[3],k[4]*M[0]+k[5]*M[1]+k[6]*M[2]+k[7]*M[3],k[8]*M[0]+k[9]*M[1]+k[10]*M[2]+k[11]*M[3],k[12]*M[0]+k[13]*M[1]+k[14]*M[2]+k[15]*M[3]],dot:(k,M)=>k[0]*M[0]+k[1]*M[1]+k[2]*M[2]+k[3]*M[3],sml:(k,M)=>[k*M[0],k*M[1],k*M[2],k*M[3]]};La.encode=function(M,D,U,$,V,B,W){$==null&&($=0),W==null&&(W=!1);const F=u(M,D,U,$,[!1,!1,!1,0,W,!1]);return c(F,-1),l(F,D,U,V,B)},La.encodeLL=function(M,D,U,$,V,B,W,F){const j={ctype:0+($==1?0:2)+(V==0?0:4),depth:B,frames:[]},q=($+V)*B,H=q*D;for(let N=0;N<M.length;N++)j.frames.push({rect:{x:0,y:0,width:D,height:U},img:new Uint8Array(M[N]),blend:0,dispose:1,bpp:Math.ceil(q/8),bpl:Math.ceil(H/8)});return c(j,0,!0),l(j,D,U,W,F)},La.encode.compress=u,La.encode.dither=o,La.quantize=b,La.quantize.getKDtree=x,La.quantize.getNearest=S})();const UK={toArrayBuffer(n,e){const t=n.width,r=n.height,s=t<<2,i=n.getContext("2d").getImageData(0,0,t,r),a=new Uint32Array(i.data.buffer),o=(32*t+31)/32<<2,l=o*r,c=122+l,u=new ArrayBuffer(c),f=new DataView(u),m=1<<20;let g,y,b,x,S=m,T=0,_=0,R=0;function I(k){f.setUint16(_,k,!0),_+=2}function C(k){f.setUint32(_,k,!0),_+=4}function L(k){_+=k}I(19778),C(c),L(4),C(122),C(108),C(t),C(-r>>>0),I(1),I(32),C(3),C(l),C(2835),C(2835),L(8),C(16711680),C(65280),C(255),C(4278190080),C(1466527264),function k(){for(;T<r&&S>0;){for(x=122+T*o,g=0;g<s;)S--,y=a[R++],b=y>>>24,f.setUint32(x+g,y<<8|b),g+=4;T++}R<a.length?(S=m,setTimeout(k,UK._dly)):e(u)}()},toBlob(n,e){this.toArrayBuffer(n,t=>{e(new Blob([t],{type:"image/bmp"}))})},_dly:9};var ci={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},J1e={[ci.CHROME]:16384,[ci.FIREFOX]:11180,[ci.DESKTOP_SAFARI]:16384,[ci.IE]:8192,[ci.IOS]:4096,[ci.ETC]:8192};const nP=typeof window<"u",$K=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,dE=nP&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),eAe=(nP||$K)&&(dE&&dE.getOriginalSymbol(window,"File")||typeof File<"u"&&File),BK=(nP||$K)&&(dE&&dE.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function rP(n,e,t=Date.now()){return new Promise(r=>{const s=n.split(","),i=s[0].match(/:(.*?);/)[1],a=globalThis.atob(s[1]);let o=a.length;const l=new Uint8Array(o);for(;o--;)l[o]=a.charCodeAt(o);const c=new Blob([l],{type:i});c.name=e,c.lastModified=t,r(c)})}function HK(n){return new Promise((e,t)=>{const r=new BK;r.onload=()=>e(r.result),r.onerror=s=>t(s),r.readAsDataURL(n)})}function VK(n){return new Promise((e,t)=>{const r=new Image;r.onload=()=>e(r),r.onerror=s=>t(s),r.src=n})}function id(){if(id.cachedResult!==void 0)return id.cachedResult;let n=ci.ETC;const{userAgent:e}=navigator;return/Chrom(e|ium)/i.test(e)?n=ci.CHROME:/iP(ad|od|hone)/i.test(e)&&/WebKit/i.test(e)?n=ci.IOS:/Safari/i.test(e)?n=ci.DESKTOP_SAFARI:/Firefox/i.test(e)?n=ci.FIREFOX:(/MSIE/i.test(e)||document.documentMode)&&(n=ci.IE),id.cachedResult=n,id.cachedResult}function zK(n,e){const t=id(),r=J1e[t];let s=n,i=e,a=s*i;const o=s>i?i/s:s/i;for(;a>r*r;){const l=(r+s)/2,c=(r+i)/2;l<c?(i=c,s=c*o):(i=l*o,s=l),a=s*i}return{width:s,height:i}}function jS(n,e){let t,r;try{if(t=new OffscreenCanvas(n,e),r=t.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{t=document.createElement("canvas"),r=t.getContext("2d")}return t.width=n,t.height=e,[t,r]}function GK(n,e){const{width:t,height:r}=zK(n.width,n.height),[s,i]=jS(t,r);return e&&/jpe?g/.test(e)&&(i.fillStyle="white",i.fillRect(0,0,s.width,s.height)),i.drawImage(n,0,0,s.width,s.height),s}function lx(){return lx.cachedResult!==void 0||(lx.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),lx.cachedResult}function hE(n,e={}){return new Promise(function(t,r){let s,i;var a=function(){try{return i=GK(s,e.fileType||n.type),t([s,i])}catch(l){return r(l)}},o=function(l){try{var c=function(u){try{throw u}catch(f){return r(f)}};try{let u;return HK(n).then(function(f){try{return u=f,VK(u).then(function(m){try{return s=m,function(){try{return a()}catch(g){return r(g)}}()}catch(g){return c(g)}},c)}catch(m){return c(m)}},c)}catch(u){c(u)}}catch(u){return r(u)}};try{if(lx()||[ci.DESKTOP_SAFARI,ci.MOBILE_SAFARI].includes(id()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(n).then(function(l){try{return s=l,a()}catch{return o()}},o)}catch{o()}})}function fE(n,e,t,r,s=1){return new Promise(function(i,a){let o;if(e==="image/png"){let c,u,f;return c=n.getContext("2d"),{data:u}=c.getImageData(0,0,n.width,n.height),f=La.encode([u.buffer],n.width,n.height,4096*s),o=new Blob([f],{type:e}),o.name=t,o.lastModified=r,l.call(this)}{let c=function(){return l.call(this)};if(e==="image/bmp")return new Promise(u=>UK.toBlob(n,u)).then((function(u){try{return o=u,o.name=t,o.lastModified=r,c.call(this)}catch(f){return a(f)}}).bind(this),a);{let u=function(){return c.call(this)};if(typeof OffscreenCanvas=="function"&&n instanceof OffscreenCanvas)return n.convertToBlob({type:e,quality:s}).then((function(f){try{return o=f,o.name=t,o.lastModified=r,u.call(this)}catch(m){return a(m)}}).bind(this),a);{let f;return f=n.toDataURL(e,s),rP(f,t,r).then((function(m){try{return o=m,u.call(this)}catch(g){return a(g)}}).bind(this),a)}}}function l(){return i(o)}})}function Ao(n){n.width=0,n.height=0}function gf(){return new Promise(function(n,e){let t,r,s,i;return gf.cachedResult!==void 0?n(gf.cachedResult):rP("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(a){try{return t=a,hE(t).then(function(o){try{return r=o[1],fE(r,t.type,t.name,t.lastModified).then(function(l){try{return s=l,Ao(r),hE(s).then(function(c){try{return i=c[0],gf.cachedResult=i.width===1&&i.height===2,n(gf.cachedResult)}catch(u){return e(u)}},e)}catch(c){return e(c)}},e)}catch(l){return e(l)}},e)}catch(o){return e(o)}},e)})}function qK(n){return new Promise((e,t)=>{const r=new BK;r.onload=s=>{const i=new DataView(s.target.result);if(i.getUint16(0,!1)!=65496)return e(-2);const a=i.byteLength;let o=2;for(;o<a;){if(i.getUint16(o+2,!1)<=8)return e(-1);const l=i.getUint16(o,!1);if(o+=2,l==65505){if(i.getUint32(o+=2,!1)!=1165519206)return e(-1);const c=i.getUint16(o+=6,!1)==18761;o+=i.getUint32(o+4,c);const u=i.getUint16(o,c);o+=2;for(let f=0;f<u;f++)if(i.getUint16(o+12*f,c)==274)return e(i.getUint16(o+12*f+8,c))}else{if((65280&l)!=65280)break;o+=i.getUint16(o,!1)}}return e(-1)},r.onerror=s=>t(s),r.readAsArrayBuffer(n)})}function WK(n,e){const{width:t}=n,{height:r}=n,{maxWidthOrHeight:s}=e;let i,a=n;return isFinite(s)&&(t>s||r>s)&&([a,i]=jS(t,r),t>r?(a.width=s,a.height=r/t*s):(a.width=t/r*s,a.height=s),i.drawImage(n,0,0,a.width,a.height),Ao(n)),a}function KK(n,e){const{width:t}=n,{height:r}=n,[s,i]=jS(t,r);switch(e>4&&e<9?(s.width=r,s.height=t):(s.width=t,s.height=r),e){case 2:i.transform(-1,0,0,1,t,0);break;case 3:i.transform(-1,0,0,-1,t,r);break;case 4:i.transform(1,0,0,-1,0,r);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,r,0);break;case 7:i.transform(0,-1,-1,0,r,t);break;case 8:i.transform(0,-1,1,0,0,t)}return i.drawImage(n,0,0,t,r),Ao(n),s}function J5(n,e,t=0){return new Promise(function(r,s){let i,a,o,l,c,u,f,m,g,y,b,x,S,T,_,R,I,C,L,k;function M(U=5){if(e.signal&&e.signal.aborted)throw e.signal.reason;i+=U,e.onProgress(Math.min(i,100))}function D(U){if(e.signal&&e.signal.aborted)throw e.signal.reason;i=Math.min(Math.max(U,i),100),e.onProgress(i)}return i=t,a=e.maxIteration||10,o=1024*e.maxSizeMB*1024,M(),hE(n,e).then((function(U){try{return[,l]=U,M(),c=WK(l,e),M(),new Promise(function($,V){var B;if(!(B=e.exifOrientation))return qK(n).then((function(F){try{return B=F,W.call(this)}catch(j){return V(j)}}).bind(this),V);function W(){return $(B)}return W.call(this)}).then((function($){try{return u=$,M(),gf().then((function(V){try{return f=V?c:KK(c,u),M(),m=e.initialQuality||1,g=e.fileType||n.type,fE(f,g,n.name,n.lastModified,m).then((function(B){try{{let F=function(){if(a--&&(_>o||_>S)){let q,H;return q=k?.95*L.width:L.width,H=k?.95*L.height:L.height,[I,C]=jS(q,H),C.drawImage(L,0,0,q,H),m*=g==="image/png"?.85:.95,fE(I,g,n.name,n.lastModified,m).then(function(N){try{return R=N,Ao(L),L=I,_=R.size,D(Math.min(99,Math.floor((T-_)/(T-o)*100))),F}catch(O){return s(O)}},s)}return[1]},j=function(){return Ao(L),Ao(I),Ao(c),Ao(f),Ao(l),D(100),r(R)};if(y=B,M(),b=y.size>o,x=y.size>n.size,!b&&!x)return D(100),r(y);var W;return S=n.size,T=y.size,_=T,L=f,k=!e.alwaysKeepResolution&&b,(W=(function(q){for(;q;){if(q.then)return void q.then(W,s);try{if(q.pop){if(q.length)return q.pop()?j.call(this):q;q=F}else q=q.call(this)}catch(H){return s(H)}}}).bind(this))(F)}}catch(F){return s(F)}}).bind(this),s)}catch(B){return s(B)}}).bind(this),s)}catch(V){return s(V)}}).bind(this),s)}catch($){return s($)}}).bind(this),s)})}const tAe=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let qA;function nAe(n,e){return new Promise((t,r)=>{qA||(qA=function(a){const o=[];return o.push(a),URL.createObjectURL(new Blob(o))}(tAe));const s=new Worker(qA);s.addEventListener("message",function(a){if(e.signal&&e.signal.aborted)s.terminate();else if(a.data.progress===void 0){if(a.data.error)return r(new Error(a.data.error)),void s.terminate();t(a.data.file),s.terminate()}else e.onProgress(a.data.progress)}),s.addEventListener("error",r),e.signal&&e.signal.addEventListener("abort",()=>{r(e.signal.reason),s.terminate()}),s.postMessage({file:n,imageCompressionLibUrl:e.libURL,options:{...e,onProgress:void 0,signal:void 0}})})}function Ss(n,e){return new Promise(function(t,r){let s,i,a,o,l,c;if(s={...e},a=0,{onProgress:o}=s,s.maxSizeMB=s.maxSizeMB||Number.POSITIVE_INFINITY,l=typeof s.useWebWorker!="boolean"||s.useWebWorker,delete s.useWebWorker,s.onProgress=g=>{a=g,typeof o=="function"&&o(a)},!(n instanceof Blob||n instanceof eAe))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(n.type))return r(new Error("The file given is not an image"));if(c=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!l||typeof Worker!="function"||c)return J5(n,s).then((function(g){try{return i=g,m.call(this)}catch(y){return r(y)}}).bind(this),r);var u=(function(){try{return m.call(this)}catch(g){return r(g)}}).bind(this),f=function(g){try{return J5(n,s).then(function(y){try{return i=y,u()}catch(b){return r(b)}},r)}catch(y){return r(y)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",nAe(n,s).then(function(g){try{return i=g,u()}catch{return f()}},f)}catch{f()}function m(){try{i.name=n.name,i.lastModified=n.lastModified}catch{}try{s.preserveExif&&n.type==="image/jpeg"&&(!s.fileType||s.fileType&&s.fileType===n.type)&&(i=FK(n,i))}catch{}return t(i)}})}Ss.getDataUrlFromFile=HK,Ss.getFilefromDataUrl=rP,Ss.loadImage=VK,Ss.drawImageInCanvas=GK,Ss.drawFileInCanvas=hE,Ss.canvasToFile=fE,Ss.getExifOrientation=qK,Ss.handleMaxWidthOrHeight=WK,Ss.followExifOrientation=KK,Ss.cleanupCanvasMemory=Ao,Ss.isAutoOrientationInBrowser=gf,Ss.approximateBelowMaximumCanvasSizeOfBrowser=zK,Ss.copyExifWithoutOrientation=FK,Ss.getBrowserName=id,Ss.version="2.0.2";async function YK(n,e=10){const t=n.size,r={maxSizeMB:e,maxWidthOrHeight:4096,useWebWorker:!0,fileType:"image/webp",initialQuality:.85};try{const s=await Ss(n,r),i=await rAe(s);return{blob:s,width:i.width,height:i.height,originalSize:t,compressedSize:s.size,mimeType:s.type}}catch(s){throw console.error("[compressImage] Compression failed:",s),new Error(`Failed to compress image: ${s instanceof Error?s.message:"Unknown error"}`)}}async function rAe(n){return new Promise((e,t)=>{const r=new Image,s=URL.createObjectURL(n);r.onload=()=>{URL.revokeObjectURL(s),e({width:r.naturalWidth,height:r.naturalHeight})},r.onerror=()=>{URL.revokeObjectURL(s),t(new Error("Failed to load image for dimension extraction"))},r.src=s})}function XK(n){return["image/jpeg","image/jpg","image/png","image/webp","image/gif","image/avif"].includes(n.type)}function mE(n,[e,t]){return Math.min(t,Math.max(e,n))}function FS(n){const e=E.useRef({value:n,previous:n});return E.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var sAe=[" ","Enter","ArrowUp","ArrowDown"],iAe=[" ","Enter"],Sd="Select",[US,$S,aAe]=Gv(Sd),[gm,Eje]=Ns(Sd,[aAe,du]),BS=du(),[oAe,pu]=gm(Sd),[lAe,cAe]=gm(Sd),QK=n=>{const{__scopeSelect:e,children:t,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:f,disabled:m,required:g,form:y}=n,b=BS(e),[x,S]=E.useState(null),[T,_]=E.useState(null),[R,I]=E.useState(!1),C=qv(c),[L,k]=vi({prop:r,defaultProp:s??!1,onChange:i,caller:Sd}),[M,D]=vi({prop:a,defaultProp:o,onChange:l,caller:Sd}),U=E.useRef(null),$=x?y||!!x.closest("form"):!0,[V,B]=E.useState(new Set),W=Array.from(V).map(F=>F.props.value).join(";");return d.jsx(Xv,{...b,children:d.jsxs(oAe,{required:g,scope:e,trigger:x,onTriggerChange:S,valueNode:T,onValueNodeChange:_,valueNodeHasChildren:R,onValueNodeHasChildrenChange:I,contentId:zs(),value:M,onValueChange:D,open:L,onOpenChange:k,dir:C,triggerPointerDownPosRef:U,disabled:m,children:[d.jsx(US.Provider,{scope:e,children:d.jsx(lAe,{scope:n.__scopeSelect,onNativeOptionAdd:E.useCallback(F=>{B(j=>new Set(j).add(F))},[]),onNativeOptionRemove:E.useCallback(F=>{B(j=>{const q=new Set(j);return q.delete(F),q})},[]),children:t})}),$?d.jsxs(wY,{"aria-hidden":!0,required:g,tabIndex:-1,name:u,autoComplete:f,value:M,onChange:F=>D(F.target.value),disabled:m,form:y,children:[M===void 0?d.jsx("option",{value:""}):null,Array.from(V)]},W):null]})})};QK.displayName=Sd;var ZK="SelectTrigger",JK=E.forwardRef((n,e)=>{const{__scopeSelect:t,disabled:r=!1,...s}=n,i=BS(t),a=pu(ZK,t),o=a.disabled||r,l=$t(e,a.onTriggerChange),c=$S(t),u=E.useRef("touch"),[f,m,g]=SY(b=>{const x=c().filter(_=>!_.disabled),S=x.find(_=>_.value===a.value),T=TY(x,b,S);T!==void 0&&a.onValueChange(T.value)}),y=b=>{o||(a.onOpenChange(!0),g()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return d.jsx(Qv,{asChild:!0,...i,children:d.jsx(_t.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":EY(a.value)?"":void 0,...s,ref:l,onClick:rt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:rt(s.onPointerDown,b=>{u.current=b.pointerType;const x=b.target;x.hasPointerCapture(b.pointerId)&&x.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:rt(s.onKeyDown,b=>{const x=f.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&m(b.key),!(x&&b.key===" ")&&sAe.includes(b.key)&&(y(),b.preventDefault())})})})});JK.displayName=ZK;var eY="SelectValue",tY=E.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,children:i,placeholder:a="",...o}=n,l=pu(eY,t),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,f=$t(e,l.onValueNodeChange);return vr(()=>{c(u)},[c,u]),d.jsx(_t.span,{...o,ref:f,style:{pointerEvents:"none"},children:EY(l.value)?d.jsx(d.Fragment,{children:a}):i})});tY.displayName=eY;var uAe="SelectIcon",nY=E.forwardRef((n,e)=>{const{__scopeSelect:t,children:r,...s}=n;return d.jsx(_t.span,{"aria-hidden":!0,...s,ref:e,children:r||""})});nY.displayName=uAe;var dAe="SelectPortal",rY=n=>d.jsx(lm,{asChild:!0,...n});rY.displayName=dAe;var Td="SelectContent",sY=E.forwardRef((n,e)=>{const t=pu(Td,n.__scopeSelect),[r,s]=E.useState();if(vr(()=>{s(new DocumentFragment)},[]),!t.open){const i=r;return i?Hs.createPortal(d.jsx(iY,{scope:n.__scopeSelect,children:d.jsx(US.Slot,{scope:n.__scopeSelect,children:d.jsx("div",{children:n.children})})}),i):null}return d.jsx(aY,{...n,ref:e})});sY.displayName=Td;var Pa=10,[iY,gu]=gm(Td),hAe="SelectContentImpl",fAe=eu("SelectContent.RemoveScroll"),aY=E.forwardRef((n,e)=>{const{__scopeSelect:t,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:y,hideWhenDetached:b,avoidCollisions:x,...S}=n,T=pu(Td,t),[_,R]=E.useState(null),[I,C]=E.useState(null),L=$t(e,ee=>R(ee)),[k,M]=E.useState(null),[D,U]=E.useState(null),$=$S(t),[V,B]=E.useState(!1),W=E.useRef(!1);E.useEffect(()=>{if(_)return cS(_)},[_]),oS();const F=E.useCallback(ee=>{const[oe,...te]=$().map(Z=>Z.ref.current),[se]=te.slice(-1),he=document.activeElement;for(const Z of ee)if(Z===he||(Z?.scrollIntoView({block:"nearest"}),Z===oe&&I&&(I.scrollTop=0),Z===se&&I&&(I.scrollTop=I.scrollHeight),Z?.focus(),document.activeElement!==he))return},[$,I]),j=E.useCallback(()=>F([k,_]),[F,k,_]);E.useEffect(()=>{V&&j()},[V,j]);const{onOpenChange:q,triggerPointerDownPosRef:H}=T;E.useEffect(()=>{if(_){let ee={x:0,y:0};const oe=se=>{ee={x:Math.abs(Math.round(se.pageX)-(H.current?.x??0)),y:Math.abs(Math.round(se.pageY)-(H.current?.y??0))}},te=se=>{ee.x<=10&&ee.y<=10?se.preventDefault():_.contains(se.target)||q(!1),document.removeEventListener("pointermove",oe),H.current=null};return H.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",te,{capture:!0})}}},[_,q,H]),E.useEffect(()=>{const ee=()=>q(!1);return window.addEventListener("blur",ee),window.addEventListener("resize",ee),()=>{window.removeEventListener("blur",ee),window.removeEventListener("resize",ee)}},[q]);const[N,O]=SY(ee=>{const oe=$().filter(he=>!he.disabled),te=oe.find(he=>he.ref.current===document.activeElement),se=TY(oe,ee,te);se&&setTimeout(()=>se.ref.current.focus())}),z=E.useCallback((ee,oe,te)=>{const se=!W.current&&!te;(T.value!==void 0&&T.value===oe||se)&&(M(ee),se&&(W.current=!0))},[T.value]),G=E.useCallback(()=>_?.focus(),[_]),Y=E.useCallback((ee,oe,te)=>{const se=!W.current&&!te;(T.value!==void 0&&T.value===oe||se)&&U(ee)},[T.value]),Q=r==="popper"?eI:oY,J=Q===eI?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:y,hideWhenDetached:b,avoidCollisions:x}:{};return d.jsx(iY,{scope:t,content:_,viewport:I,onViewportChange:C,itemRefCallback:z,selectedItem:k,onItemLeave:G,itemTextRefCallback:Y,focusSelectedItem:j,selectedItemText:D,position:r,isPositioned:V,searchRef:N,children:d.jsx(Kv,{as:fAe,allowPinchZoom:!0,children:d.jsx(Wv,{asChild:!0,trapped:T.open,onMountAutoFocus:ee=>{ee.preventDefault()},onUnmountAutoFocus:rt(s,ee=>{T.trigger?.focus({preventScroll:!0}),ee.preventDefault()}),children:d.jsx(om,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:ee=>ee.preventDefault(),onDismiss:()=>T.onOpenChange(!1),children:d.jsx(Q,{role:"listbox",id:T.contentId,"data-state":T.open?"open":"closed",dir:T.dir,onContextMenu:ee=>ee.preventDefault(),...S,...J,onPlaced:()=>B(!0),ref:L,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:rt(S.onKeyDown,ee=>{const oe=ee.ctrlKey||ee.altKey||ee.metaKey;if(ee.key==="Tab"&&ee.preventDefault(),!oe&&ee.key.length===1&&O(ee.key),["ArrowUp","ArrowDown","Home","End"].includes(ee.key)){let se=$().filter(he=>!he.disabled).map(he=>he.ref.current);if(["ArrowUp","End"].includes(ee.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(ee.key)){const he=ee.target,Z=se.indexOf(he);se=se.slice(Z+1)}setTimeout(()=>F(se)),ee.preventDefault()}})})})})})})});aY.displayName=hAe;var mAe="SelectItemAlignedPosition",oY=E.forwardRef((n,e)=>{const{__scopeSelect:t,onPlaced:r,...s}=n,i=pu(Td,t),a=gu(Td,t),[o,l]=E.useState(null),[c,u]=E.useState(null),f=$t(e,L=>u(L)),m=$S(t),g=E.useRef(!1),y=E.useRef(!0),{viewport:b,selectedItem:x,selectedItemText:S,focusSelectedItem:T}=a,_=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&x&&S){const L=i.trigger.getBoundingClientRect(),k=c.getBoundingClientRect(),M=i.valueNode.getBoundingClientRect(),D=S.getBoundingClientRect();if(i.dir!=="rtl"){const he=D.left-k.left,Z=M.left-he,pe=L.left-Z,ye=L.width+pe,ae=Math.max(ye,k.width),le=window.innerWidth-Pa,ie=mE(Z,[Pa,Math.max(Pa,le-ae)]);o.style.minWidth=ye+"px",o.style.left=ie+"px"}else{const he=k.right-D.right,Z=window.innerWidth-M.right-he,pe=window.innerWidth-L.right-Z,ye=L.width+pe,ae=Math.max(ye,k.width),le=window.innerWidth-Pa,ie=mE(Z,[Pa,Math.max(Pa,le-ae)]);o.style.minWidth=ye+"px",o.style.right=ie+"px"}const U=m(),$=window.innerHeight-Pa*2,V=b.scrollHeight,B=window.getComputedStyle(c),W=parseInt(B.borderTopWidth,10),F=parseInt(B.paddingTop,10),j=parseInt(B.borderBottomWidth,10),q=parseInt(B.paddingBottom,10),H=W+F+V+q+j,N=Math.min(x.offsetHeight*5,H),O=window.getComputedStyle(b),z=parseInt(O.paddingTop,10),G=parseInt(O.paddingBottom,10),Y=L.top+L.height/2-Pa,Q=$-Y,J=x.offsetHeight/2,ee=x.offsetTop+J,oe=W+F+ee,te=H-oe;if(oe<=Y){const he=U.length>0&&x===U[U.length-1].ref.current;o.style.bottom="0px";const Z=c.clientHeight-b.offsetTop-b.offsetHeight,pe=Math.max(Q,J+(he?G:0)+Z+j),ye=oe+pe;o.style.height=ye+"px"}else{const he=U.length>0&&x===U[0].ref.current;o.style.top="0px";const pe=Math.max(Y,W+b.offsetTop+(he?z:0)+J)+te;o.style.height=pe+"px",b.scrollTop=oe-Y+b.offsetTop}o.style.margin=`${Pa}px 0`,o.style.minHeight=N+"px",o.style.maxHeight=$+"px",r?.(),requestAnimationFrame(()=>g.current=!0)}},[m,i.trigger,i.valueNode,o,c,b,x,S,i.dir,r]);vr(()=>_(),[_]);const[R,I]=E.useState();vr(()=>{c&&I(window.getComputedStyle(c).zIndex)},[c]);const C=E.useCallback(L=>{L&&y.current===!0&&(_(),T?.(),y.current=!1)},[_,T]);return d.jsx(gAe,{scope:t,contentWrapper:o,shouldExpandOnScrollRef:g,onScrollButtonChange:C,children:d.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:R},children:d.jsx(_t.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});oY.displayName=mAe;var pAe="SelectPopperPosition",eI=E.forwardRef((n,e)=>{const{__scopeSelect:t,align:r="start",collisionPadding:s=Pa,...i}=n,a=BS(t);return d.jsx(gS,{...a,...i,ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});eI.displayName=pAe;var[gAe,sP]=gm(Td,{}),tI="SelectViewport",lY=E.forwardRef((n,e)=>{const{__scopeSelect:t,nonce:r,...s}=n,i=gu(tI,t),a=sP(tI,t),o=$t(e,i.onViewportChange),l=E.useRef(0);return d.jsxs(d.Fragment,{children:[d.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),d.jsx(US.Slot,{scope:t,children:d.jsx(_t.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:rt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=a;if(m?.current&&f){const g=Math.abs(l.current-u.scrollTop);if(g>0){const y=window.innerHeight-Pa*2,b=parseFloat(f.style.minHeight),x=parseFloat(f.style.height),S=Math.max(b,x);if(S<y){const T=S+g,_=Math.min(y,T),R=T-_;f.style.height=_+"px",f.style.bottom==="0px"&&(u.scrollTop=R>0?R:0,f.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});lY.displayName=tI;var cY="SelectGroup",[vAe,yAe]=gm(cY),bAe=E.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=zs();return d.jsx(vAe,{scope:t,id:s,children:d.jsx(_t.div,{role:"group","aria-labelledby":s,...r,ref:e})})});bAe.displayName=cY;var uY="SelectLabel",dY=E.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=yAe(uY,t);return d.jsx(_t.div,{id:s.id,...r,ref:e})});dY.displayName=uY;var pE="SelectItem",[xAe,hY]=gm(pE),fY=E.forwardRef((n,e)=>{const{__scopeSelect:t,value:r,disabled:s=!1,textValue:i,...a}=n,o=pu(pE,t),l=gu(pE,t),c=o.value===r,[u,f]=E.useState(i??""),[m,g]=E.useState(!1),y=$t(e,T=>l.itemRefCallback?.(T,r,s)),b=zs(),x=E.useRef("touch"),S=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return d.jsx(xAe,{scope:t,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:E.useCallback(T=>{f(_=>_||(T?.textContent??"").trim())},[]),children:d.jsx(US.ItemSlot,{scope:t,value:r,disabled:s,textValue:u,children:d.jsx(_t.div,{role:"option","aria-labelledby":b,"data-highlighted":m?"":void 0,"aria-selected":c&&m,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:rt(a.onFocus,()=>g(!0)),onBlur:rt(a.onBlur,()=>g(!1)),onClick:rt(a.onClick,()=>{x.current!=="mouse"&&S()}),onPointerUp:rt(a.onPointerUp,()=>{x.current==="mouse"&&S()}),onPointerDown:rt(a.onPointerDown,T=>{x.current=T.pointerType}),onPointerMove:rt(a.onPointerMove,T=>{x.current=T.pointerType,s?l.onItemLeave?.():x.current==="mouse"&&T.currentTarget.focus({preventScroll:!0})}),onPointerLeave:rt(a.onPointerLeave,T=>{T.currentTarget===document.activeElement&&l.onItemLeave?.()}),onKeyDown:rt(a.onKeyDown,T=>{l.searchRef?.current!==""&&T.key===" "||(iAe.includes(T.key)&&S(),T.key===" "&&T.preventDefault())})})})})});fY.displayName=pE;var Qp="SelectItemText",mY=E.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,...i}=n,a=pu(Qp,t),o=gu(Qp,t),l=hY(Qp,t),c=cAe(Qp,t),[u,f]=E.useState(null),m=$t(e,S=>f(S),l.onItemTextChange,S=>o.itemTextRefCallback?.(S,l.value,l.disabled)),g=u?.textContent,y=E.useMemo(()=>d.jsx("option",{value:l.value,disabled:l.disabled,children:g},l.value),[l.disabled,l.value,g]),{onNativeOptionAdd:b,onNativeOptionRemove:x}=c;return vr(()=>(b(y),()=>x(y)),[b,x,y]),d.jsxs(d.Fragment,{children:[d.jsx(_t.span,{id:l.textId,...i,ref:m}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Hs.createPortal(i.children,a.valueNode):null]})});mY.displayName=Qp;var pY="SelectItemIndicator",gY=E.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return hY(pY,t).isSelected?d.jsx(_t.span,{"aria-hidden":!0,...r,ref:e}):null});gY.displayName=pY;var nI="SelectScrollUpButton",vY=E.forwardRef((n,e)=>{const t=gu(nI,n.__scopeSelect),r=sP(nI,n.__scopeSelect),[s,i]=E.useState(!1),a=$t(e,r.onScrollButtonChange);return vr(()=>{if(t.viewport&&t.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=t.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[t.viewport,t.isPositioned]),s?d.jsx(bY,{...n,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=t;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});vY.displayName=nI;var rI="SelectScrollDownButton",yY=E.forwardRef((n,e)=>{const t=gu(rI,n.__scopeSelect),r=sP(rI,n.__scopeSelect),[s,i]=E.useState(!1),a=$t(e,r.onScrollButtonChange);return vr(()=>{if(t.viewport&&t.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=t.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[t.viewport,t.isPositioned]),s?d.jsx(bY,{...n,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=t;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});yY.displayName=rI;var bY=E.forwardRef((n,e)=>{const{__scopeSelect:t,onAutoScroll:r,...s}=n,i=gu("SelectScrollButton",t),a=E.useRef(null),o=$S(t),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),vr(()=>{o().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[o]),d.jsx(_t.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:rt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:rt(s.onPointerMove,()=>{i.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:rt(s.onPointerLeave,()=>{l()})})}),wAe="SelectSeparator",xY=E.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return d.jsx(_t.div,{"aria-hidden":!0,...r,ref:e})});xY.displayName=wAe;var sI="SelectArrow",EAe=E.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=BS(t),i=pu(sI,t),a=gu(sI,t);return i.open&&a.position==="popper"?d.jsx(vS,{...s,...r,ref:e}):null});EAe.displayName=sI;var SAe="SelectBubbleInput",wY=E.forwardRef(({__scopeSelect:n,value:e,...t},r)=>{const s=E.useRef(null),i=$t(r,s),a=FS(e);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&u){const f=new Event("change",{bubbles:!0});u.call(o,e),o.dispatchEvent(f)}},[a,e]),d.jsx(_t.select,{...t,style:{...Y7,...t.style},ref:i,defaultValue:e})});wY.displayName=SAe;function EY(n){return n===""||n===void 0}function SY(n){const e=xa(n),t=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=t.current+a;e(o),function l(c){t.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[e]),i=E.useCallback(()=>{t.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[t,s,i]}function TY(n,e,t){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=t?n.indexOf(t):-1;let a=TAe(n,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==t));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==t?l:void 0}function TAe(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var _Ae=QK,_Y=JK,AAe=tY,RAe=nY,CAe=rY,AY=sY,kAe=lY,RY=dY,CY=fY,IAe=mY,LAe=gY,kY=vY,IY=yY,LY=xY;const eB=_Ae,tB=AAe,iI=E.forwardRef(({className:n,children:e,...t},r)=>d.jsxs(_Y,{ref:r,className:je("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...t,children:[e,d.jsx(RAe,{asChild:!0,children:d.jsx(Id,{className:"h-4 w-4 opacity-50"})})]}));iI.displayName=_Y.displayName;const DY=E.forwardRef(({className:n,...e},t)=>d.jsx(kY,{ref:t,className:je("flex cursor-default items-center justify-center py-1",n),...e,children:d.jsx(JL,{className:"h-4 w-4"})}));DY.displayName=kY.displayName;const PY=E.forwardRef(({className:n,...e},t)=>d.jsx(IY,{ref:t,className:je("flex cursor-default items-center justify-center py-1",n),...e,children:d.jsx(Id,{className:"h-4 w-4"})}));PY.displayName=IY.displayName;const aI=E.forwardRef(({className:n,children:e,position:t="popper",...r},s)=>d.jsx(CAe,{children:d.jsxs(AY,{ref:s,className:je("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:t,...r,children:[d.jsx(DY,{}),d.jsx(kAe,{className:je("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),d.jsx(PY,{})]})}));aI.displayName=AY.displayName;const DAe=E.forwardRef(({className:n,...e},t)=>d.jsx(RY,{ref:t,className:je("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...e}));DAe.displayName=RY.displayName;const oI=E.forwardRef(({className:n,children:e,...t},r)=>d.jsxs(CY,{ref:r,className:je("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...t,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(LAe,{children:d.jsx(is,{className:"h-4 w-4"})})}),d.jsx(IAe,{children:e})]}));oI.displayName=CY.displayName;const PAe=E.forwardRef(({className:n,...e},t)=>d.jsx(LY,{ref:t,className:je("-mx-1 my-1 h-px bg-muted",n),...e}));PAe.displayName=LY.displayName;const MAe=({isOpen:n,onClose:e,hasEditingPermissions:t=!0,isMobile:r=!1,pendingRecordingType:s=null})=>{const{permissions:i,settings:a,setSelectedMicrophone:o,setSelectedCamera:l,requestPermissions:c,checkPermissions:u,enumerateDevices:f}=vs();E.useEffect(()=>{n&&(u(),f())},[n,u,f]),E.useEffect(()=>{if(!n||!s)return;const L=!(s==="thoughts")||i.camera==="granted",k=i.microphone==="granted";if(L&&k){e();const M=new CustomEvent("startPendingRecording",{detail:{type:s}});window.dispatchEvent(M)}},[n,s,i.camera,i.microphone,e]);const m=async()=>{await c("microphone")?(Yt.capture("recording_permission_granted",{recording_type:s||"unknown",permission_type:"microphone"}),await u(),await f()):Yt.capture("recording_permission_denied",{recording_type:s||"unknown",permission_type:"microphone"})},g=async()=>{await c("camera")?(Yt.capture("recording_permission_granted",{recording_type:s||"unknown",permission_type:"camera"}),await u(),await f()):Yt.capture("recording_permission_denied",{recording_type:s||"unknown",permission_type:"camera"})},[y,b]=E.useState(0),[x,S]=E.useState(null),T=async()=>{if(b(L=>L+1),!x){const L=setTimeout(()=>{b(0),S(null)},5e3);S(L)}y>=2&&(R(!0),b(0),x&&(clearTimeout(x),S(null))),await c("both")?Yt.capture("recording_permission_granted",{recording_type:s||"unknown",permission_type:"both"}):Yt.capture("recording_permission_denied",{recording_type:s||"unknown",permission_type:"both"}),await u(),await f()},[_,R]=E.useState(!1),I=i.camera!=="granted"||i.microphone!=="granted";return E.useEffect(()=>()=>{x&&clearTimeout(x)},[x]),d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsx(ar,{children:d.jsx(or,{children:"Recording Options"})}),d.jsxs("div",{className:"space-y-5 mt-4",children:[d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:je("w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1",i.microphone==="granted"?"bg-text-primary/10 text-text-primary":"bg-orange-500/10 text-orange-400"),children:d.jsx(sue,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-white",children:"Microphone"}),i.microphone==="granted"?d.jsx(is,{className:"w-3.5 h-3.5 text-green-400"}):d.jsx(FC,{className:"w-3.5 h-3.5 text-orange-400"})]}),i.microphone==="granted"?d.jsx(d.Fragment,{children:!r&&a.availableMicrophones.length>0?d.jsxs(eB,{value:a.selectedMicrophoneId||"",onValueChange:o,children:[d.jsx(iI,{className:"w-full h-9 text-sm bg-background/50 border-border/50 text-white hover:bg-background/70 transition-colors",children:d.jsx(tB,{placeholder:"Select microphone"})}),d.jsx(aI,{side:"top",sideOffset:4,className:"bg-background border-border z-[10003]",children:a.availableMicrophones.filter(C=>C.deviceId&&C.deviceId.trim()!=="").map(C=>d.jsx(oI,{value:C.deviceId,className:"text-white hover:bg-white/10 text-sm",children:C.label},C.deviceId))})]}):r?d.jsx("p",{className:"text-sm text-green-400 py-2",children:"Permission granted"}):d.jsx("p",{className:"text-sm text-orange-400 py-2",children:"No microphone devices detected"})}):d.jsx(dt,{onClick:m,variant:"outline",className:je("w-full h-9 text-sm","bg-orange-500/10 border-orange-500/40","text-orange-400 hover:bg-orange-500/20 hover:border-orange-500/60"),children:"Permission not granted"})]})]}),d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:je("w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mt-1",i.camera==="granted"?"bg-text-primary/10 text-text-primary":"bg-orange-500/10 text-orange-400"),children:d.jsx(QV,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-white",children:"Camera"}),i.camera==="granted"?d.jsx(is,{className:"w-3.5 h-3.5 text-green-400"}):d.jsx(FC,{className:"w-3.5 h-3.5 text-orange-400"})]}),i.camera==="granted"?d.jsx(d.Fragment,{children:!r&&a.availableCameras.length>0?d.jsxs(eB,{value:a.selectedCameraId||"",onValueChange:l,children:[d.jsx(iI,{className:"w-full h-9 text-sm bg-background/50 border-border/50 text-white hover:bg-background/70 transition-colors",children:d.jsx(tB,{placeholder:"Select camera"})}),d.jsx(aI,{side:"top",sideOffset:4,className:"bg-background border-border z-[10003]",children:a.availableCameras.filter(C=>C.deviceId&&C.deviceId.trim()!=="").map(C=>d.jsx(oI,{value:C.deviceId,className:"text-white hover:bg-white/10 text-sm",children:C.label},C.deviceId))})]}):r?d.jsx("p",{className:"text-sm text-green-400 py-2",children:"Permission granted"}):d.jsx("p",{className:"text-sm text-orange-400 py-2",children:"No camera devices detected"})}):d.jsx(dt,{onClick:g,variant:"outline",className:je("w-full h-9 text-sm","bg-orange-500/10 border-orange-500/40","text-orange-400 hover:bg-orange-500/20 hover:border-orange-500/60"),children:"Permission not granted"})]})]}),I&&d.jsxs("div",{className:"space-y-2",children:[d.jsxs("button",{onClick:()=>R(!_),className:"text-xs text-text-secondary hover:text-text-primary transition-colors flex items-center gap-1",children:["Permission prompt not appearing?",d.jsx(ez,{className:"w-3 h-3"})]}),_&&d.jsxs("div",{className:"text-xs text-text-secondary space-y-2 bg-background/50 p-3 rounded-lg border border-border/50",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-white mb-1",children:"Chrome:"}),d.jsx("p",{children:"Click the lock icon in the address bar  Site settings  Reset permissions"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-white mb-1",children:"Safari:"}),d.jsx("p",{children:"Safari menu  Settings  Websites  Camera/Microphone  Allow for this site"})]})]})]})]}),d.jsx(ys,{children:I?d.jsx(dt,{className:"button-primary rounded-full",onClick:T,children:"Grant Permissions"}):d.jsx(dt,{variant:"ghost",className:"rounded-full",onClick:e,children:"Close"})})]})})};async function OAe({files:n,draftKey:e,flaskId:t,enterFocusedState:r,currentLink:s,toolbarState:i}){if(n.length===0)return!1;const a=De.getState(),l=(e?a.getDraftElement(e):a.getDraftElement())?.attachments?.filter(u=>u.type==="image").length||0;if(l+n.length>5)return et.error(`Maximum 5 images allowed. You selected ${n.length} but already have ${l}.`),!1;for(const u of n){if(!XK(u))return et.error(`Invalid file type: ${u.name}. Please select JPEG, PNG, WebP, GIF, or AVIF images.`),!1;const f=10*1024*1024;if(u.size>f)return et.error(`Image too large: ${u.name}. Maximum size is 10MB.`),!1}try{i==="idle"&&r&&(r(),a.getDraftElement(e)||s&&a.initializeDraft(s,e));for(const u of n){const f=await YK(u,10);u.name,f.originalSize,f.compressedSize,f.width,f.height;const m=URL.createObjectURL(f.blob),g=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,y={id:g,elementId:"",type:"image",displayOrder:0,fileSize:f.compressedSize,imageWidth:f.width,imageHeight:f.height,mimeType:f.mimeType,imageUrl:m,metadata:{localBlobUrl:m},createdAt:new Date().toISOString()};a.addDraftAttachment(y,e),await ln.getState().uploadImage({attachmentId:g,flaskId:t,blob:f.blob,originalFilename:u.name,width:f.width,height:f.height,fileSize:f.compressedSize,mimeType:f.mimeType,isDraft:!0,draftKey:e})}return!0}catch(u){return console.error("[ImageUploadHelper] Failed to upload images:",u),et.error("Failed to upload images"),!1}}const NAe=({content:n,placeholder:e="Leave your comment..",isEditMode:t,onContentChange:r,onKeyDown:s,onFocus:i,onBlur:a,onArrowUpAtTop:o,className:l,textareaClassName:c,textareaRef:u,containerRef:f,dataAttributes:m={},flaskId:g,draftKey:y})=>{const b=E.useRef(null),x=u||b,S=E.useCallback(async I=>{if(!g)return;const C=I.clipboardData?.items;if(!C)return;const L=[];for(let k=0;k<C.length;k++){const M=C[k];if(M.kind==="file"&&M.type.startsWith("image/")){const D=M.getAsFile();D&&L.push(D)}}L.length>0&&(I.preventDefault(),L.length,await OAe({files:L,flaskId:g,draftKey:y}))},[g,y]),T=E.useCallback(I=>{if(I.key==="ArrowUp"&&o){const C=I.currentTarget,L=C.selectionStart;if(!C.value.substring(0,L).includes(`
`)){I.preventDefault(),o();return}}s?.(I)},[s,o]);E.useEffect(()=>{if(t&&x.current){x.current.style.height="0px";const I=x.current.scrollHeight;x.current.style.height=I+"px"}},[n,t]);const _={target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline"},R=E.useCallback(I=>I?d.jsx(eK,{options:_,children:I}):null,[]);return d.jsx("div",{ref:f,className:je("relative",l),children:t?d.jsx("textarea",{ref:x,value:n,onChange:I=>r?.(I.target.value),onKeyDown:T,onPaste:S,onFocus:i,onBlur:a,placeholder:e,rows:1,className:je("w-full bg-transparent text-white text-sm resize-none outline-none border-none overflow-hidden",c),style:{fontSize:"14px",lineHeight:"1",padding:"0 8px",boxSizing:"border-box"},...m}):d.jsx("div",{className:je("w-full text-xs text-white leading-relaxed px-1 py-1",!n&&"text-text-secondary italic"),children:n?R(n):e})})},jAe=({isOpen:n,onClose:e})=>{const{signInWithGoogle:t}=Ar();return d.jsx(Zn,{open:n,onOpenChange:r=>{r||e()},modal:!0,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",onInteractOutside:r=>{r.preventDefault()},children:[d.jsx(ar,{children:d.jsx(or,{children:"Almost there"})}),d.jsxs("div",{className:"flex flex-col items-center space-y-4 py-4",children:[d.jsxs("button",{onClick:async()=>{try{const r=window.location.pathname+window.location.search;await t(r)}catch(r){console.error("Error signing in with Google:",r)}},className:"w-full bg-white text-black hover:bg-white/90 px-4 py-2.5 rounded-xl font-medium flex items-center justify-center transition-colors text-sm",children:[d.jsxs("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),d.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),d.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),d.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),d.jsx("p",{className:"text-xs text-text-primary pt-0",children:"Your comment will be saved"}),d.jsxs("p",{className:"text-xs text-text-secondary text-center opacity-50 pt-4",children:["By continuing, you agree to the"," ",d.jsx("a",{href:"/terms-of-service",className:"text-text-primary hover:underline",children:"Terms of Service"})," ","and"," ",d.jsx("a",{href:"/privacy-policy",className:"text-text-primary hover:underline",children:"Privacy Policy"}),"."]})]})]})})},mb=({title:n,keycapLetter:e,description:t,icon:r,hideKeycap:s=!1})=>d.jsx($n,{className:"p-4 rounded-3xl  border-text-secondary/50 border z-[100]",children:d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"flex justify-between font-semibold items-center gap-3 whitespace-nowrap",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[r,d.jsx("span",{children:n})]}),!s&&d.jsx(gn,{animate:!0,children:e})]}),t&&d.jsx("div",{className:"flex justify-center items-center mt-1",children:d.jsx("div",{className:"bg-green-500/20 text-green-400 text-xs font-medium px-3 py-1 text-center rounded-full border border-green-500/30",children:t})})]})}),xc=({children:n,content:e,isMobile:t,delayDuration:r=300,open:s})=>t?d.jsx(d.Fragment,{children:n}):d.jsxs(Tr,{delayDuration:r,...s!==void 0?{open:s}:{},children:[d.jsx(_r,{asChild:!0,children:n}),e]}),MY=({hasEditingPermissions:n,variant:e="timeline",threadId:t})=>{const{accessLevel:r,isCreator:s,flask:i,flaskId:a}=Dd(),o=r==="viewonly"&&!s,[l,c]=E.useState(!1),u=e==="reply",f=De(me=>u&&t?me.findRootElementInThread(t)||t:"timeline"),m=De(me=>me.getDraftElement(f)?.content||""),g=Mt(me=>u?me.replyToolbar.recordingState:me.recordingState),y=De(me=>!!me.getDraftElement(f)),b=g??(y?"draft":"idle"),x=Mt(me=>u?me.replyToolbar.recordingType:me.recordingType),S=Mt(me=>u?me.replyToolbar.recordingDuration:me.recordingDuration),T=Mt(me=>u?me.replyToolbar.previewStream:me.previewStream),_=Mt(u?me=>me.startReplyRecording:me=>me.startRecording),R=Mt(u?me=>me.stopReplyRecording:me=>me.stopRecording),I=Mt(u?me=>me.setReplyPreviewStream:me=>me.setPreviewStream),C=u?E.useCallback(()=>{t&&Mt.getState().enterReplyFocusedState(t)},[t]):Mt(me=>me.enterFocusedState),L=Mt(u?me=>me.exitReplyToIdle:me=>me.exitToIdle),k=u?null:Mt(me=>me.editingElementId),M=u?()=>{}:Mt(me=>me.clearEditMode),D=u?"element":Mt(me=>me.linkingMode),U=u?t||null:Mt(me=>me.targetElementId);Mt(me=>me.isToolbarHovered);const $=De(me=>me.getDraftElement(f)),V=$?.attachments||[],B=Mt(me=>me.setToolbarHovered),W=Mt(me=>me.pendingRecordingCancelCallback),F=Mt(me=>me.setPendingRecordingCancelCallback),j=Mt(me=>u?me.replyToolbar.pendingDiscardCallback:me.pendingDiscardCallback),q=Mt(u?me=>me.setReplyPendingDiscardCallback:me=>me.setPendingDiscardCallback),N=Mt(me=>me.replyToolbar.threadId)!==null,O=De(me=>me.createElement),z=De(me=>me.updateElement),G=He(me=>me.currentTime),Y=He(me=>me.pause),Q=cn(me=>me.user),J=cn(me=>me.profile);yt(me=>me.timelineScale),yt(me=>me.timelineOffset),yt(me=>me.playbarWidth),yt(me=>me.visibleTimeStart),yt(me=>me.visibleTimeEnd),yt(me=>me.duration),Q&&J&&(Q.id,J.full_name,J.avatar_url,Q.email),(me=>me?me.split(" ")[0]:null)(J?.full_name)||Q?.email?.split("@")[0];const te=r2(),se=E.useRef(null),he=E.useRef(null),Z=E.useRef(null),pe=E.useRef(null),ye=E.useRef(null),ae=E.useRef(null),le=E.useRef(!1),ie=E.useRef(null),fe=E.useRef(null),Ie=E.useRef(null);E.useRef(!1),E.useRef(!1),E.useRef(null),E.useRef(null),E.useRef(null);const ne=E.useRef(null),[ce,Ce]=E.useState(!1),[Oe,ze]=E.useState(null),[We,tt]=E.useState([0,0,0,0]),[lt,Ee]=E.useState(null),[be,Ae]=E.useState(null),[Me,Ue]=E.useState(()=>window.innerWidth<768),[Ge,Ke]=E.useState(!1),ht=(()=>{const me={width:1e3,height:300,intensity:1,falloff:.7,steps:11,easingCurve:[.8,.7,.55,.4,.25,.15,.08,.04,.02,.01]};return u?{...me,color:"#000000",opacity:0}:b==="recording"?{...me,color:"#FF4444",width:1500,height:500,opacity:.6}:b==="draft"||b==="preparing"?D==="element"?{...me,color:"#BCD8FF",opacity:0}:{...me,color:"#BCD8FF",opacity:.4}:{...me,color:"#000000",opacity:1}})();E.useEffect(()=>{ht.opacity,ht.color},[b,D,ht.opacity,ht.color]);const Vt=me=>{const{color:Ye,intensity:Xe,steps:st,easingCurve:wt}=me,qt=[],At=wt.map((Tt,zt)=>{const Mn=zt/(st-2)*100;return Math.min(Mn,92)});return wt.forEach((Tt,zt)=>{const Mn=Math.round(Xe*Tt*255).toString(16).padStart(2,"0"),jr=At[zt];qt.push(`${Ye}${Mn} ${jr}%`)}),qt.push("transparent 100%"),`radial-gradient(ellipse ${me.width/2}px ${me.height/2}px at center, ${qt.join(", ")})`},mn=()=>{he.current&&(he.current.style.height="auto",he.current.style.height=`${he.current.scrollHeight}px`)},xn=async()=>{const me=De.getState();me.requestDiscardDraft(async()=>{await me.discardDraft(f),L()},f)},Bn=async()=>{if(!(!m.trim()&&V.length===0)){if(!Q){c(!0);return}if(n){le.current=!0,Y();try{if(k)await z(k,{content:m}),M();else{const Ye=Cw(G,null,1200,320,30);let Xe;if(u&&t){const At=De.getState().findRootElementInThread(t);At?(Xe=[{type:"element",targetElementId:At}],`${At}`):(console.warn("[ToolbarV2] Could not find root element, linking to thread ID directly"),Xe=[{type:"element",targetElementId:t}])}else if(D==="element"&&U){const At=De.getState().findRootElementInThread(U);At?(Xe=[{type:"element",targetElementId:At}],`${At}${U}`):(console.warn("[ToolbarV2] Could not find root element, linking to original target"),Xe=[{type:"element",targetElementId:U}])}else Xe=[{type:"timeline",timestamp:G}];const st=De.getState(),wt=st.getDraftElement(f);if((!wt||wt.attachments.length===0)&&(u?Mt.getState().exitReplyToIdle():Mt.getState().exitToIdle(!0),!u&&N&&Mt.getState().exitReplyToIdle(),he.current&&he.current.blur()),wt){wt.attachments.length,u&&t&&st.updateDraftLink(Xe[0],!1,f);const At=await st.submitDraft(f);At||et.error("Failed to create element")}else await O("text",{position:Ye,content:m,title:"Text",links:Xe},void 0,void 0)}}catch{et.error("Failed to save text")}finally{le.current=!1}}}},An=async me=>{if(Mt.getState().isAnyToolbarRecording())return;if(Yt.capture("recording_clicked",{recording_type:me,button_location:"toolbar",is_authenticated:!!Q,has_editing_permissions:n}),!Q){c(!0);return}if(!n)return;await vs.getState().checkPermissions();const Ye=vs.getState().permissions,st=me==="thoughts"&&Ye.camera!=="granted",wt=Ye.microphone!=="granted";if(st||wt){ze(me),Ke(!0);return}ze(null),await Lt(me)},Lt=async me=>{if(Y(),b==="idle"){C();const qt=De.getState();if(!qt.getDraftElement()){let At;u&&t?At={type:"element",targetElementId:qt.findRootElementInThread(t)||t}:D==="element"&&U?At={type:"element",targetElementId:qt.findRootElementInThread(U)||U}:At={type:"timeline",timestamp:G},qt.initializeDraft(At,f)}}u||yt.getState().ensurePlayheadVisible(),me==="thoughts"&&_(me);const Ye=u?"element":D,Xe=u?t:U,st=D==="timeline"?{start:G,end:G}:null,wt=vs.getState();wt.startRecordingFlow;try{const qt=await wt.startRecordingFlow({type:me,context:{type:me,linkingMode:Ye,targetElementId:Xe,currentTime:G,selectedTags:[],pendingTimelineLink:u?null:st},callbacks:{onScreenSelected:()=>{me==="screen"&&_(me)},onCountdownTick:At=>{Ee(At),ne.current&&(ne.current.currentTime=0,ne.current.volume=.4,ne.current.play().catch(()=>{}))},onStreamReady:At=>{I(At),pe.current&&(pe.current.srcObject=At,pe.current.play().catch(()=>{}));try{const Tt=new(window.AudioContext||window.webkitAudioContext);if(fe.current=Tt,At.getAudioTracks().length>0){const Mn=Tt.createMediaStreamSource(At),jr=Tt.createAnalyser();jr.fftSize=256,jr.smoothingTimeConstant=.3,Mn.connect(jr),ie.current=jr;let bs;const Ea=()=>{if(!ie.current)return;const to=new Uint8Array(ie.current.frequencyBinCount);ie.current.getByteTimeDomainData(to);let Xo=0;for(let Ta=0;Ta<to.length;Ta++){const Qo=(to[Ta]-128)/128;Xo+=Qo*Qo}const Rr=Math.sqrt(Xo/to.length),Sa=Math.min(Rr*10,1),y0=[Sa>.1?Math.min(.3+Sa*.7,1):0,Sa>.25?Math.min(.3+Sa*.7,1):0,Sa>.45?Math.min(.3+Sa*.7,1):0,Sa>.65?Math.min(.3+Sa*.7,1):0];tt(y0),bs=requestAnimationFrame(Ea)};Ea(),fe.current.animationFrameId=bs}}catch(Tt){console.warn("Could not set up audio analysis:",Tt)}},onRecordingStart:()=>{console.trace("[ToolbarV2] onRecordingStart stack trace"),Ee(null),u?Mt.getState().setReplyToolbarState("recording"):Mt.getState().setState("recording");const At=Date.now(),Tt=300;let zt=!1;ae.current=setInterval(()=>{const Mn=Math.floor((Date.now()-At)/1e3);if(!zt&&Mn>=270&&(zt=!0,et.warning("Recording will automatically stop in 30 seconds (5 minute limit)")),Mn>=Tt){et.info("Recording stopped - 5 minute limit reached"),ot();return}const jr=Math.floor(Mn/60).toString().padStart(2,"0"),bs=(Mn%60).toString().padStart(2,"0");u?Mt.getState().setReplyRecordingDuration(`${jr}:${bs}`):Mt.getState().setRecordingDuration(`${jr}:${bs}`)},100)},onError:At=>{console.error("[ToolbarV2] Recording error:",At),et.error(At),R()}}});qt.success||(console.error("[ToolbarV2] Failed to start recording:",qt.error),R())}catch(qt){console.error("[ToolbarV2] Exception in actuallyStartRecording:",qt),R()}},jt=async()=>{const me=document.createElement("input");me.type="file",me.accept="image/jpeg,image/jpg,image/png,image/webp,image/gif,image/avif",me.multiple=!0,me.onchange=async Ye=>{const Xe=Array.from(Ye.target.files||[]);if(Xe.length===0)return;const st=De.getState();if((st.getDraftElement(f)?.attachments?.filter(Tt=>Tt.type==="image").length||0)+Xe.length>5){et.error("You can upload a maximum of 5 images at a time");return}for(const Tt of Xe){if(!XK(Tt)){et.error(`Invalid file type: ${Tt.name}. Please select JPEG, PNG, WebP, GIF, or AVIF images.`);return}const zt=10*1024*1024;if(Tt.size>zt){et.error(`Image too large: ${Tt.name}. Maximum size is 10MB.`);return}}try{if(b==="idle"&&(C(),!st.getDraftElement(f))){let Tt;u&&t?Tt={type:"element",targetElementId:t}:D==="timeline"?Tt={type:"timeline",timestamp:G}:D==="element"&&U?Tt={type:"element",targetElementId:U}:Tt={type:"timeline",timestamp:G},st.initializeDraft(Tt,f)}for(const Tt of Xe){const zt=await YK(Tt,10);Tt.name,zt.originalSize,zt.compressedSize,zt.width,zt.height;const Mn=URL.createObjectURL(zt.blob),jr=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,bs={id:jr,elementId:"",type:"image",displayOrder:0,fileSize:zt.compressedSize,imageWidth:zt.width,imageHeight:zt.height,mimeType:zt.mimeType,imageUrl:Mn,metadata:{localBlobUrl:Mn},createdAt:new Date().toISOString()};if(De.getState().addDraftAttachment(bs,f),!a)throw new Error("Flask ID not found");await ln.getState().uploadImage({attachmentId:jr,flaskId:a,blob:zt.blob,originalFilename:Tt.name,width:zt.width,height:zt.height,fileSize:zt.compressedSize,mimeType:zt.mimeType,isDraft:!0,draftKey:f})}}catch(Tt){console.error("[ToolbarV2] Failed to upload images:",Tt),et.error("Failed to upload images")}},me.click()},Xt=()=>{if(console.trace("[ToolbarV2] handleCancelRecording stack trace"),b==="preparing"){Je();return}F(async()=>{await Je()})},nt=async()=>{if(!x){console.warn("[ToolbarV2] No recording type available for restart");return}const me=x;await Je(),await new Promise(Ye=>setTimeout(Ye,100)),await An(me)},Je=async()=>{ae.current&&(clearInterval(ae.current),ae.current=null),fe.current&&(fe.current.animationFrameId&&cancelAnimationFrame(fe.current.animationFrameId),fe.current.close(),fe.current=null),ie.current=null,tt([0,0,0,0]),T&&(T.getTracks().forEach(me=>me.stop()),I(null)),Ee(null),await vs.getState().cancelToolbarRecording(),R()},ot=async()=>{ae.current&&(clearInterval(ae.current),ae.current=null),fe.current&&(fe.current.animationFrameId&&cancelAnimationFrame(fe.current.animationFrameId),fe.current.close(),fe.current=null),ie.current=null,tt([0,0,0,0]),Ee(null),R(),T&&(T.getTracks().forEach(st=>st.stop()),I(null));const me=De.getState();let Ye=me.getDraftElement(f);if(!Ye){const st=u&&t?{type:"element",targetElementId:t}:{type:"timeline",timestamp:G};me.initializeDraft(st,f),Ye=me.getDraftElement(f)}const Xe=await vs.getState().stopRecordingFlowDraft({draftElementId:Ye.id,draftKey:f});Xe.success?(m||C(),he.current?.focus()):(console.error("[ToolbarV2] Failed to process draft recording:",Xe.error),et.error("Failed to process recording"))},Dt=me=>{me.key==="Enter"&&!me.shiftKey&&(me.preventDefault(),Bn())};return E.useEffect(()=>{if(pe.current&&T)try{pe.current.srcObject=T,pe.current.play().catch(()=>{})}catch{}},[T]),E.useEffect(()=>()=>{T&&T.getTracks().forEach(me=>me.stop())},[T]),E.useEffect(()=>()=>{ae.current&&clearInterval(ae.current),Ie.current&&clearInterval(Ie.current)},[]),E.useEffect(()=>(typeof window<"u"&&(ne.current=new Audio("/click.wav"),ne.current.preload="auto"),()=>{ne.current&&(ne.current=null)}),[]),E.useEffect(()=>{const me=()=>Ue(window.innerWidth<768);return window.addEventListener("resize",me),()=>window.removeEventListener("resize",me)},[]),E.useEffect(()=>{Q&&l&&c(!1)},[Q,l]),E.useEffect(()=>{if(u)return;const me=Ye=>{if(m.trim()||V.length>0)return Ye.preventDefault(),Ye.returnValue="",""};return window.addEventListener("beforeunload",me),()=>{window.removeEventListener("beforeunload",me)}},[u,m,V]),E.useEffect(()=>{mn()},[m]),E.useEffect(()=>{he.current},[u]),E.useEffect(()=>{const me=Ye=>{const{type:Xe}=Ye.detail;Xe==="thoughts"&&An("thoughts")};return window.addEventListener("startPendingRecording",me),()=>{window.removeEventListener("startPendingRecording",me)}},[]),E.useEffect(()=>{const me=Ye=>{if(Ye.key==="Escape"){if(document.activeElement?.closest("[data-tags-section]"))return;if(b==="recording"||b==="preparing")Ye.preventDefault(),Ye.stopPropagation(),Xt();else if(b==="draft"&&(Ye.preventDefault(),Ye.stopPropagation(),!k)){xn();const wt=Z.current?.querySelector("textarea");wt&&wt.blur()}}};return window.addEventListener("keydown",me,!0),()=>{window.removeEventListener("keydown",me,!0)}},[b,m,V,k,u,q,L]),E.useEffect(()=>{D==="timeline"&&(b==="draft"||b==="preparing"||b==="recording")&&setTimeout(()=>{yt.getState().ensurePlayheadVisible()},50)},[b,D]),E.useEffect(()=>{b==="idle"&&B(!1)},[b,B]),E.useEffect(()=>{const me=()=>{Xt()};return window.addEventListener("toolbarV2CancelRecording",me),()=>{window.removeEventListener("toolbarV2CancelRecording",me)}},[]),o?null:d.jsxs(yi,{delayDuration:300,children:[d.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 pointer-events-none z-[55]",children:d.jsxs("div",{className:"relative",style:{width:`${ht.width}px`,height:`${ht.height}px`,transform:"translateY(50%)"},children:[d.jsx("div",{className:"absolute inset-0 w-full h-full transition-opacity duration-200",style:{opacity:b==="idle"?ht.opacity:0,background:Vt({...ht,color:"#000000"})}}),d.jsx("div",{className:"absolute inset-0 w-full h-full transition-opacity duration-200",style:{opacity:b==="recording"||b==="idle"?0:ht.opacity,background:Vt({...ht,color:"#BCD8FF"})}}),d.jsx("div",{className:"absolute inset-0 w-full h-full transition-opacity duration-200",style:{opacity:b==="recording"?ht.opacity:0,background:Vt({...ht,color:"#FF4444",width:1500,height:500})}})]})}),d.jsx("div",{className:je(u?"w-full":"absolute bottom-2 left-1/2","transition-transform duration-200 ease-out","flex flex-col-reverse items-center","z-[60] pointer-events-auto"),style:{transformOrigin:"bottom center",transform:u?void 0:"translateX(-50%)"},children:d.jsxs("div",{className:je("relative toolbar-container",u&&"w-full"),onMouseEnter:()=>{u||B(!0)},onMouseLeave:()=>{u||B(!1)},children:[!u&&d.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{top:"-10px",bottom:"-100px",left:"-10px",right:"-50px"}}),d.jsx("div",{className:je(u?"display-none":"rounded-[22px]",u?"border border-transparent":"border-[0.5px] border-text-primary/10","transition-all duration-200 ease-out",u&&"w-full"),children:d.jsxs("div",{ref:me=>{te&&"current"in te&&(te.current=me),se.current=me},className:je("relative flex items-stretch","z-[41] overflow-visible",u?"border-0":"bg-element-background",u?"-mt-2":"border-t border-white/10",b==="idle"&&"","transition-all duration-200 ease-out",u?"border-t border-border shadow-none":"rounded-[22px] shadow-lg shadow-black/30",u?"w-full h-auto flex-col":b==="preparing"||b==="recording"?"w-[350px] md:w-[400px] h-auto flex-col":"w-[300px] h-auto"),style:{backgroundImage:u?void 0:""},onMouseDown:me=>{me.stopPropagation()},children:[(b==="preparing"||b==="recording")&&d.jsxs("div",{className:"w-full",children:[d.jsx("div",{className:"w-full p-3 ",children:d.jsxs("div",{className:"w-full aspect-video rounded-2xl overflow-hidden bg-black border border-text-secondary/20 relative",children:[T&&d.jsx("video",{ref:pe,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover transition-opacity duration-300 opacity-100",style:{transform:x==="thoughts"?"scaleX(-1)":"none"}}),b==="preparing"&&d.jsx("div",{className:je("absolute inset-0 rounded-2xl bg-black/60 backdrop-blur-sm z-10","flex items-center justify-center","transition-opacity duration-300",lt===0?"opacity-0":"opacity-100"),children:d.jsxs("div",{className:"relative",children:[be!==null&&d.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-4xl font-bold text-white drop-shadow-lg animate-out slide-out-to-top-4 fade-out-0 duration-300",children:be},`out-${be}`),lt!==null&&lt>0?d.jsx("span",{className:"text-4xl font-bold text-white drop-shadow-lg animate-in slide-in-from-bottom-4 fade-in-0 duration-300",children:lt},lt):lt===null?d.jsx("span",{className:"text-sm font-mono text-white/80",children:"Get ready.."}):null]})})]})}),d.jsx("div",{className:"relative flex items-center justify-between px-3 mb-4 h-10",children:(b==="preparing"||b==="recording")&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx($n,{side:"top",className:"z-[100]",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{children:"Cancel recording"}),!u&&d.jsx(gn,{animate:!1,className:"text-xs",children:"ESC"})]})}),children:d.jsx("button",{className:"flex items-center justify-center w-8 h-8 ml-1 rounded-full bg-card-background hover:bg-element-background/80 transition-all duration-200 cursor-pointer",onClick:Xt,...u?{"data-peek-toolbar-cancel-btn":!0}:{"data-toolbar-cancel-btn":!0},children:d.jsx($o,{className:"w-5 h-5 text-text-secondary/50"})})}),b==="recording"&&d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx($n,{side:"top",className:"z-[100]",children:d.jsx("span",{children:"Restart recording"})}),children:d.jsx("button",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-card-background hover:bg-element-background/80 transition-all duration-200 cursor-pointer",onClick:nt,...u?{"data-peek-toolbar-restart-btn":!0}:{"data-toolbar-restart-btn":!0},children:d.jsx(lue,{className:"w-4 h-4 text-text-secondary/50"})})})]}),d.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center gap-1 animate-in fade-in-0 duration-300",children:We.map((me,Ye)=>{const Xe=["#CFDEF6","#CFDEF6","#CFDEF6","#CFDEF6"],st=(b==="preparing"||b==="recording")&&me>0;return d.jsx("div",{className:je("w-1 h-2 rounded-full transition-all duration-75",!st&&"bg-gray-700"),style:{...st&&{backgroundColor:Xe[Ye],opacity:me}}},Ye)})}),d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx($n,{side:"top",className:"z-[100]",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{children:"Stop"}),!u&&d.jsx(gn,{animate:!1,className:"text-xs",children:""})]})}),children:d.jsxs("button",{...u?{"data-peek-toolbar-stop-btn":!0}:{"data-toolbar-stop-btn":!0},onClick:ot,disabled:b==="preparing",className:je("flex items-center gap-2 px-4 h-10 rounded-full transition-all duration-200 animate-in slide-in-from-top-2 fade-in-0",b==="recording"?"bg-red-500 hover:bg-red-500/80 cursor-pointer":"bg-card-background cursor-not-allowed"),children:[d.jsx("div",{className:je("w-3 h-3 rounded-[2px]",b==="recording"?"bg-white":"bg-text-secondary/50")}),d.jsx("span",{className:je("text-sm font-mono font-semibold",b==="recording"?"text-white":"text-text-secondary"),children:b==="recording"?d.jsxs(d.Fragment,{children:[S,S>="04:30"&&" (max 5:00)"]}):"00:00"})]})})]})})]}),!(b==="preparing"||b==="recording")&&d.jsxs("div",{className:"relative w-full pt-1 px-1 flex flex-col",style:{transition:"height 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[d.jsx(Ed,{mode:"sync",children:!u&&$&&d.jsx(Ka.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",stiffness:200,damping:17},className:"",children:d.jsx(tP,{ref:ye,element:$,hasEditingPermissions:n,isReadOnly:!1,isDraft:!0,draftKey:f,isInToolbar:!0,onEscapeFromToolbar:()=>{he.current?.focus()}})},"tags-section")}),d.jsx("div",{ref:Z,className:"cursor-text px-1 pt-1.5",onClick:me=>{const Ye=me.target;!Ye.closest("button")&&!Ye.closest("[data-toolbar-thoughts-btn]")&&!Ye.closest("[data-toolbar-screen-btn]")&&!Ye.closest("[data-toolbar-submit-btn]")&&!Ye.closest("[data-toolbar-settings-btn]")&&Ye!==he.current&&he.current?.focus()},children:d.jsx(NAe,{content:m,placeholder:u||D==="element"?"Add your reply..":"Leave your comment..",isEditMode:!0,textareaRef:he,onContentChange:me=>{De.getState().updateDraftText(me,f)},onKeyDown:Dt,onArrowUpAtTop:()=>{ye.current?.focusTagInput()},flaskId:a,draftKey:f,onFocus:()=>{if(!Q){c(!0),setTimeout(()=>{he.current?.blur()},50);return}Ce(!0),b==="idle"&&C()},onBlur:me=>{if(Ce(!1),le.current||(me.relatedTarget,m.length,V.length,me.relatedTarget&&me.relatedTarget.closest("[data-tags-section]"))||me.relatedTarget&&me.currentTarget.closest(".toolbar-container")?.contains(me.relatedTarget)||!me.relatedTarget||!document.contains(me.relatedTarget))return;const wt=m.trim()||V.length>0;!u&&wt||k||xn()},dataAttributes:u?{"data-reply-toolbar-textbox":"true"}:{"data-toolbar-textbox":"true"}})}),d.jsx(Ed,{mode:"sync",children:V.length>0&&d.jsx(Ka.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2,ease:"easeInOut"},className:"overflow-hidden p-2",children:d.jsx(tK,{attachments:V,elementId:V[0]?.elementId||"",hasEditingPermissions:n,isSelected:!1,isHovered:!1,isReplyElement:!1})},"draft-attachments")}),d.jsxs("div",{className:"relative flex items-center justify-between px-3 mt-2 mb-2 -mx-1.5",children:[d.jsxs("div",{className:"flex items-center gap-0.5 pointer-events-auto",children:[d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx(mb,{title:"Record Thoughts",keycapLetter:"R",description:"2.7x faster than typing",icon:d.jsx(K1e,{className:"w-4 h-4"}),hideKeycap:u}),children:d.jsxs("div",{className:"h-8 px-4 pl-3  flex items-center gap-2 cursor-pointer  transition-all duration-0 button-secondary !bg-text-primary/5",style:{borderTopLeftRadius:"30px",borderBottomLeftRadius:"30px",borderTopRightRadius:"4px",borderBottomRightRadius:"4px"},"data-toolbar-thoughts-btn":!0,onClick:()=>{An("thoughts")},tabIndex:0,children:[d.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 mb-0.5"}),d.jsx("span",{className:" text-text-primary mb-0.5 text-sm",children:"Record"})]})}),d.jsx("div",{className:"hidden md:block",children:d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx(mb,{title:"Record Screen",keycapLetter:"S",description:"Show anything on screen",icon:d.jsx(Z5,{className:"w-4 h-4"}),hideKeycap:u}),children:d.jsx("div",{className:"h-8 w-10 flex items-center justify-center cursor-pointer transition-all duration-0 button-secondary !bg-text-primary/5",style:{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",borderTopRightRadius:"30px",borderBottomRightRadius:"30px"},"data-toolbar-screen-btn":!0,onClick:()=>{An("screen")},tabIndex:0,children:d.jsx(Z5,{className:"w-4 h-4 text-text-primary"})})})}),d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx($n,{side:"top",className:"z-[100]",children:"Recording options"}),children:d.jsx("div",{className:"px-1 h-6 w-6 flex items-center justify-center cursor-pointer text-text-secondary hover:text-text-primary  transition-colors rounded-full","data-toolbar-settings-btn":!0,onClick:()=>Ke(!0),children:d.jsx(uue,{className:"w-3 h-3"})})}),d.jsx("div",{className:"hidden md:block ml-1",children:d.jsx(xc,{isMobile:Me,delayDuration:300,content:d.jsx(mb,{title:"Upload Image",icon:d.jsx(T3,{className:"w-4 h-4"}),hideKeycap:!0}),children:d.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center cursor-pointer transition-all duration-0 ","data-toolbar-image-btn":!0,onClick:jt,tabIndex:0,children:d.jsx(T3,{className:"w-4 h-4 text-text-secondary"})})})})]}),d.jsx(xc,{isMobile:Me,delayDuration:0,open:m.trim()||V.length>0?void 0:!1,content:d.jsx(mb,{title:"Submit",keycapLetter:"",hideKeycap:u}),children:d.jsx("button",{"data-toolbar-submit-btn":!0,disabled:!m.trim()&&V.length===0,onClick:Bn,className:je("h-8 w-8 rounded-full flex items-center justify-center transition-all duration-200",m.trim()||V.length>0?"button-primary cursor-pointer":"bg-card-background/50 text-border"),children:d.jsx(sz,{className:"w-4 h-4 mt-0.5 mr-0.5"})})})]})]})]})})]})}),d.jsx(Zn,{open:!!j,onOpenChange:me=>!me&&q(null),children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsx(ar,{children:d.jsx(or,{children:"Discard unsaved changes?"})}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"You have unsaved text. Do you want to discard it?"}),d.jsxs(ys,{className:"gap-2",children:[d.jsx(dt,{variant:"ghost",onClick:()=>q(null),children:"Keep Editing"}),d.jsx("button",{className:"button-primary flex items-center rounded-xl justify-center px-6 py-3 cursor-pointer text-sm font-medium",onClick:()=>{if(j){const me=j;q(null),me()}},autoFocus:!0,children:d.jsx("span",{children:"Discard"})})]})]})}),d.jsx(MAe,{isOpen:Ge,onClose:()=>{Ke(!1),ze(null)},hasEditingPermissions:n,isMobile:Me,pendingRecordingType:Oe}),d.jsx(jAe,{isOpen:l,onClose:()=>c(!1)}),d.jsx(Zn,{open:!!W,onOpenChange:me=>!me&&F(null),children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsx(ar,{children:d.jsx(or,{children:"Cancel recording?"})}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"Are you sure you want to cancel this recording? This action cannot be undone."}),d.jsxs(ys,{className:"gap-2",children:[d.jsx(dt,{variant:"ghost",onClick:()=>F(null),children:"Keep Recording"}),d.jsx("button",{className:"button-primary flex items-center rounded-xl justify-center px-6 py-3 cursor-pointer text-sm font-medium",onClick:async()=>{if(W){const me=W;F(null),await me()}},autoFocus:!0,children:"Cancel Recording"})]})]})})]})},FAe=ve.lazy(()=>Ze(()=>import("./ElementReply-DWw4NK0w.js"),[]).then(n=>({default:n.ElementReply}))),iP=E.memo(({element:n,hasEditingPermissions:e,isReplyElement:t=!1,width:r,disableAnimations:s=!1})=>{const i=n.isPlaceholder===!0,[a]=E.useState(()=>_o.getState().isElementNew(n.id)),o=_o.getState().removeNewElement;E.useEffect(()=>{if(a&&!i){const j=setTimeout(()=>{o(n.id)},600);return()=>clearTimeout(j)}},[a,n.id,o,i]);const l=De(j=>j.selectedFrames),c=De(j=>j.selectElementWithModifiers),u=dn(j=>j.activeFilterIds),f=dn(j=>j.filterMode),m=dn(j=>j.isElementVisible),g=E.useMemo(()=>m(n),[n,u,f,m]),[y]=E.useState(!1),[b,x]=E.useState(!1);E.useEffect(()=>{if(!S.current)return;const j=()=>{x(!0)},q=()=>{x(!1)},H=new MutationObserver(()=>{S.current?.querySelectorAll('[data-element-child="true"]')?.forEach(z=>{z.addEventListener("mouseenter",j),z.addEventListener("mouseleave",q)})});return H.observe(S.current,{childList:!0,subtree:!0}),S.current.querySelectorAll('[data-element-child="true"]').forEach(O=>{O.addEventListener("mouseenter",j),O.addEventListener("mouseleave",q)}),()=>{H.disconnect(),S.current?.querySelectorAll('[data-element-child="true"]')?.forEach(z=>{z.removeEventListener("mouseenter",j),z.removeEventListener("mouseleave",q)})}},[]);const S=E.useRef(null),T=E.useMemo(()=>l.includes(n.id),[l,n.id]),_=E.useMemo(()=>({width:r??Pr,height:"auto"}),[r]),R=E.useCallback(j=>{!g||i||j.target.dataset.resizeHandle||j.target.tagName==="A"||j.button!==0||j.target.closest("[data-tag-picker]")||(j.stopPropagation(),c(n.id))},[c,n.id,g,i]),I=E.useCallback(j=>{g&&(j.target.dataset.resizeHandle||j.target.tagName!=="A"&&(j.stopPropagation(),j.preventDefault()))},[g]),C={initial:{y:100,opacity:0,scale:.9},animate:{y:0,opacity:1,scale:1},transition:{type:"spring",stiffness:260,damping:20,duration:.4},exit:{opacity:0,scale:.9,transition:{duration:.2}}},[L,k]=E.useState(!1),D=Mt(j=>j.replyToolbar.threadId)===n.id,U=cn(j=>j.user),$=De(j=>j.boardState.elements),V=E.useMemo(()=>t?[]:Object.values($).filter(j=>j?.links?.some(q=>q.type==="element"&&q.targetElementId===n.id)),[$,n.id,t]),[B,W]=E.useState(!s);E.useEffect(()=>{if(s)return;const j=setTimeout(()=>W(!1),50);return()=>clearTimeout(j)},[s]);const F=d.jsx("div",{ref:S,className:je("annotation-element select-none relative group",!s&&"transition-all duration-300 ease-out",B?"opacity-0":"opacity-100"),style:{width:_.width,opacity:g?B?0:1:goe,position:"relative",pointerEvents:g?"auto":"none",transformOrigin:"top center",overflow:"visible",cursor:g?"pointer":"default"},onMouseDown:R,onDoubleClick:I,onMouseEnter:g?()=>x(!0):void 0,onMouseLeave:g?()=>x(!1):void 0,"data-testid":`element-${n.id}`,"data-element-type":n.type,"data-element-id":n.id,children:d.jsx("div",{className:"flex flex-col w-full z-10",style:{overflow:"visible"},children:d.jsx("div",{className:je(T&&!D?"border-[0.5px] border-white/40":"element-border"),style:{borderRadius:24},children:d.jsx("div",{className:je("w-full h-full bg-element-background relative transition-all duration-100 shadow-md shadow-black"),style:{borderRadius:24},children:d.jsxs(d.Fragment,{children:[d.jsx("div",{className:" pt-1 pl-1 pr-1 pb-1",children:d.jsx(tP,{element:n,hasEditingPermissions:e,forceOpen:L,onRequestClose:()=>k(!1),isHovered:b})}),d.jsx("div",{className:"pl-3 pr-3 pb-1",children:d.jsx(m1e,{element:n,hasEditingPermissions:e,isSelected:T,wasDragging:y,containerRef:S,isReplyElement:t})}),d.jsxs("div",{className:" ",children:[!t&&d.jsx(jK,{element:n,isVisible:g,hasEditingPermissions:e,isSelected:T,isHovered:b,isReplyElement:t}),V.length===0&&d.jsx("div",{className:"h-3"})]}),!t&&V.length>0&&d.jsx(d.Fragment,{children:d.jsx("div",{className:"flex flex-col py-2",children:V.map((j,q)=>d.jsx("div",{className:"mb-2 last:mb-0",children:d.jsx(FAe,{element:j,hasEditingPermissions:e,width:r,isLastReply:q===V.length-1,parentThreadId:n.id})},j.id))})}),!t&&U&&e&&D&&d.jsx("div",{className:"w-full pt-2",children:d.jsx(MY,{hasEditingPermissions:e,variant:"reply",threadId:n.id})})]})})})})});return a&&!i&&!s?d.jsx(Ed,{mode:"wait",children:d.jsx(Ka.div,{initial:C.initial,animate:C.animate,transition:C.transition,exit:C.exit,style:{position:"relative"},children:F},n.id)}):F});iP.displayName="Element";const UAe=(n,e)=>{if(n.threadId!==e.threadId||n.x!==e.x||n.y!==e.y||n.scale!==e.scale||n.hasEditingPermissions!==e.hasEditingPermissions||n.playbarWidth!==e.playbarWidth||n.isCollapsed!==e.isCollapsed||n.showOnlyFirst!==e.showOnlyFirst||n.isPeekMode!==e.isPeekMode||n.fullWidth!==e.fullWidth||n.elements.length!==e.elements.length)return!1;for(let t=0;t<n.elements.length;t++)if(n.elements[t].id!==e.elements[t].id)return!1;return!0},lI=E.memo(({threadId:n,elements:e,x:t,y:r,scale:s,hasEditingPermissions:i,playbarWidth:a,isCollapsed:o=!1,isPeekMode:l=!1,fullWidth:c=!1})=>{const u=De(N=>N.selectedFrames),f=Kc(N=>N.hoveredElementIds),m=E.useRef(null),g=E.useRef(null),y=E.useRef(null),b=De(N=>N.userProfiles),x=yt(N=>N.scrollEnabledThreads.has(n)),S=yt(N=>N.threadMaxScrollHeights.get(n)??null),T=yt(N=>N.enableThreadScrollOnHover),_=yt(N=>N.disableThreadScrollOnLeave),R=yt(N=>N.registerThreadContainer),I=yt(N=>N.unregisterThreadContainer),C=yt(N=>N.setThreadMaxScrollHeight),L=E.useCallback(()=>{if(S!==null||o||!m.current||!g.current)return;g.current.scrollTop>0&&(g.current.scrollTop=0);const N=m.current.getBoundingClientRect(),z=window.innerHeight-j1;if(N.bottom>z){const Y=z-N.top;C(n,Y)}},[S,o,n,C]),k=E.useCallback(()=>{T(n)},[n,T]),M=E.useCallback(()=>{_(n)},[n,_]);ve.useEffect(()=>{if(g.current&&!o)return R(n,g.current),()=>I(n)},[n,o,R,I]),ve.useEffect(()=>{x&&S===null&&L()},[x,S,L]);const D=E.useCallback(N=>{if(!x||N.ctrlKey)return;const O=Math.abs(N.deltaX),z=Math.abs(N.deltaY);O>z*.5||N.stopPropagation()},[x,n]);if(E.useEffect(()=>{const N=m.current;if(!(!N||!x))return N.addEventListener("wheel",D,{passive:!1,capture:!0}),()=>{N.removeEventListener("wheel",D,{capture:!0})}},[D,x,n]),e.length===0)return null;const U=e.slice(0,1),$=U[0],V=$.createdBy,B=V?b[V]:void 0,W=ZD(B,$.creatorName),F=!o&&e.some(N=>u.includes(N.id)),j=!o&&e.some(N=>f.has(N.id)),q=F||j?2:1,H=E.useCallback(()=>{o&&o0($.id)},[o,$.id]);return d.jsx("div",{ref:m,className:"relative",style:{left:t,top:r,zIndex:q,transform:`scale(${s})`,transformOrigin:"top center",pointerEvents:"none"},children:o?d.jsx("div",{ref:y,className:"w-12 h-12 mx-auto group pointer-events-auto cursor-pointer",onClick:H,children:d.jsx("div",{className:"w-12 h-12 element-border pointer-events-auto",style:{borderRadius:16},children:d.jsx("div",{className:"w-full h-full bg-element-background group-hover:bg-inbetween-background flex items-center justify-center relative overflow-hidden cursor-pointer",style:{borderRadius:16},children:d.jsx(sv,{user:B,src:B?.avatar_url||$.creatorAvatarUrl,name:W,size:"xs",className:"pointer-events-none"})})})}):d.jsx("div",{ref:g,className:"relative scrollbar-hide",onMouseEnter:k,onMouseLeave:M,style:{width:c||l?"100%":`${Pr}px`,minWidth:c||l?"100%":`${Pr}px`,pointerEvents:"auto",overflowY:S?"auto":"visible",maxHeight:S?`${S+j1}px`:"none",paddingBottom:S?`${j1}px`:"0"},children:U.map(N=>d.jsx(ve.Fragment,{children:d.jsx(Ka.div,{layoutId:`thread-element-${N.id}`,transition:{layout:{type:"spring",stiffness:300,damping:20,duration:100,mass:.65}},className:"pointer-events-auto relative flex flex-col items-center overflow-visible",style:{zIndex:1},children:d.jsx(iP,{element:N,hasEditingPermissions:i,playbarWidth:a,isReplyElement:!1,width:c||l?"100%":Pr,allThreadElements:l?e:void 0})})},N.id))})})},UAe);lI.displayName="ThreadContainer";const $Ae=({creators:n=[],maxVisible:e=2,size:t="sm"})=>{const s=E.useMemo(()=>n.filter((c,u,f)=>c.avatarUrl&&u===f.findIndex(m=>m.avatarUrl===c.avatarUrl)),[n]).slice(0,e),i=s[0],a=s[1];if(!i)return null;const o=t==="xs"?"w-5 h-5":"w-6 h-6",l=t==="xs"?"border":"border-2";return d.jsxs("div",{className:"flex items-center justify-center",children:[d.jsx("img",{src:i.avatarUrl,alt:i.name||"Creator",className:`${o} rounded-full object-cover shadow-lg border border-element-background shadow-black ${l}  z-[2]`}),a&&d.jsx("img",{src:a.avatarUrl,alt:a.name||"Creator",className:`${o} rounded-full object-cover ${l} border-element-background shadow-lg shadow-black -ml-3 z-[1]`})]})},OY=E.memo(({count:n,x:e,y:t,onClick:r,creators:s=[],elements:i=[],hasEditingPermissions:a=!1,playbarWidth:o=0})=>{const[l,c]=E.useState(!0),u=E.useRef(null);return E.useEffect(()=>{c(!0);const f=setTimeout(()=>c(!1),500);return()=>clearTimeout(f)},[]),d.jsx("div",{ref:u,className:je("absolute -translate-x-1/2 z-[2]","bg-element-background rounded-full cursor-pointer","element-border shadow-lg","text-white font-medium select-none group",l&&"animate-springIn"),style:{left:`${e}%`,top:`${t}px`,width:`${vU}px`,height:`${vU}px`,pointerEvents:"auto"},onClick:f=>{f.stopPropagation(),r()},title:`${n} annotations grouped - click to expand`,children:d.jsxs("div",{className:"h-full w-full rounded-full flex items-center justify-center relative group-hover:bg-inbetween-background",children:[d.jsx("span",{className:"text-lg absolute group-hover:opacity-0 transition-opacity duration-150",children:n}),s.length>0&&d.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-75",children:d.jsx($Ae,{creators:s,maxVisible:2,size:"sm"})})]})})});OY.displayName="GroupIndicator";function nB(n,e,t,r){if(n.length===0)return{groups:[],collapsed:[],ungroupedThreads:[]};const s=t*e,i=Pr/s*100,a=moe/s*100,o=[...n].sort((c,u)=>c.positionPercent-u.positionPercent),l=(c,u=4)=>{const f=Math.pow(10,u);return Math.round(c*f)/f};o.map(c=>({type:"thread",positionPercent:l(c.positionPercent),widthPercent:l(i),threads:[c]}));{const c=poe/s*100,u=a,f=[];for(let I=0;I<o.length;I++){const C=o[I];let L=i,k="single";for(let M=0;M<f.length;M++){const D=f[M],U=Math.abs(C.positionPercent-D.center),$=(i+D.width)/2;if(U<$){const V=(c+D.width)/2;if(U>=V){L=c,k="collapsed";break}else{L=c,k="collapsed";break}}}f.push({kind:k,center:C.positionPercent,width:L,threads:[C]})}const m=[];let g=[...f].sort((I,C)=>I.center-C.center),y=0;const b=8,x=i*.3,S=i*.1;for(;y<g.length;){const I=g[y];let C=y+1;const L=[I];for(;C<g.length;){const k=g[C],M=L[L.length-1],D=Math.abs(k.center-M.center),U=L.length>1?S:0,$=(k.width+M.width)/2+U,V=L.reduce((F,j)=>F+j.threads.reduce((q,H)=>q+H.elements.length,0),0),B=k.threads.reduce((F,j)=>F+j.elements.length,0),W=V+B;if(D>=$+x||W>b)break;if(D<$)L.push(k),C++;else break}if(L.length>1){const k=L.flatMap(U=>U.threads),M=k.reduce((U,$)=>U+$.elements.length,0),D=k.reduce((U,$)=>U+$.positionPercent,0)/k.length;m.push({kind:"group",center:D,width:u,threads:k,elementCount:M})}else m.push(L[0]);y=C}const T=[],_=[],R=[];for(const I of m)if(I.kind==="group"){const C=[];I.threads.forEach(D=>{D.timestamp!==void 0&&C.push(D.timestamp),D.timeRange&&C.push(D.timeRange.start,D.timeRange.end)});const L=C.length>0?Math.min(...C):0,k=C.length>0?Math.max(...C):0,M=I.threads.reduce((D,U)=>D+U.elements.length,0);T.push({threads:I.threads,minTime:L,maxTime:k,centerPercent:I.center,elementCount:M})}else if(I.kind==="collapsed")_.push({threads:I.threads,centerPercent:I.center});else{const C=I.threads[0];R.push({...C,linkPositionPercent:C.positionPercent,positionPercent:I.center})}return{groups:T,collapsed:_,ungroupedThreads:R}}}const BAe=OH,HAe=6,NY=E.memo(({duration:n,hasEditingPermissions:e})=>{const t=De(x=>x.boardState.elements),r=dn(x=>x.isElementVisible),s=dn(x=>x.activeFilterIds),i=dn(x=>x.filterMode),a=yt(x=>x.timelineScale),o=0,l=E.useMemo(()=>{const x=[],S=new Set;return Object.entries(t).forEach(([T,_])=>{if(!_||!_.links||S.has(T))return;const R=_.links.find(V=>V.type==="timeline");if(!R)return;if(!r(_)){S.add(T);return}const I=[],C=new Set;C.add(T),I.push(_),S.add(T);const L=[];Object.entries(t).forEach(([V,B])=>{if(!B||V===T)return;B.links?.some(F=>F.type==="element"&&F.targetElementId===T)&&r(B)&&(L.push(B),C.add(V),S.add(V))}),L.sort((V,B)=>{const W=new Date(V.createdAt||0).getTime(),F=new Date(B.createdAt||0).getTime();return W-F}),I.push(...L);let k=0,M,D,U,$;R.timeRange?(D=R.timeRange,U=R.timeRange.start/n*100,$=R.timeRange.end/n*100,k=(R.timeRange.start+R.timeRange.end)/2/n*100):R.timestamp!==void 0&&(M=R.timestamp,k=R.timestamp/n*100),C.forEach(V=>S.add(V)),x.push({rootElementId:T,elements:I,positionPercent:k,timestamp:M,timeRange:D,percentStart:U,percentEnd:$})}),x},[t,n,r,s,i]),c=E.useMemo(()=>{const x=yt.getState(),S=Math.max(0,x.viewportWidth-Pr/2*2),T=x.playbarWidth>0?x.playbarWidth/(x.timelineScale||1):S,_=Math.round(T),{groups:R}=nB(l,1,_),I=new Map;return R.forEach(C=>{const L=C.threads[0]?.rootElementId;C.threads.forEach(k=>I.set(k.rootElementId,L))}),l.forEach(C=>{I.has(C.rootElementId)||I.set(C.rootElementId,C.rootElementId)}),I},[l]),{groups:u,collapsed:f,ungroupedThreads:m}=E.useMemo(()=>{const x=yt.getState(),S=Math.max(0,x.viewportWidth-Pr/2*2),T=x.playbarWidth>0?x.playbarWidth/(x.timelineScale||1):S,_=Math.round(T),R=Math.round(a*100)/100;return nB(l,R,_)},[l,a,c]);E.useEffect(()=>{const x=He.getState().activeRecordingId;if(x){const S=f.some(_=>_.threads.some(R=>R.elements.some(I=>I.id===x))),T=u.some(_=>_.threads.some(R=>R.elements.some(I=>I.id===x)));(S||T)&&He.getState().clearActiveRecording()}},[f,u]);const g=E.useCallback(x=>{const T=[...x.threads].sort((_,R)=>{const I=_.timestamp??(_.timeRange?(_.timeRange.start+_.timeRange.end)/2:0),C=R.timestamp??(R.timeRange?(R.timeRange.start+R.timeRange.end)/2:0);return I-C})[0]?.rootElementId;if(!T){console.warn("[AnnotationLayer] No element found in group");return}x.threads.length,o0(T)},[]);if(n<=0||l.length===0)return null;const b=20+BAe;return d.jsxs("div",{className:"annotation-layer-container w-full h-full",style:{transform:`translateY(${o}px)`,transition:"none"},children:[u.map((x,S)=>{const T=x.threads.flatMap(C=>C.elements.map(L=>({avatarUrl:L.creatorAvatarUrl,name:L.creatorName}))),_=x.threads.map(C=>C.elements[0]),R=x.threads.map(C=>C.rootElementId).sort().join("-"),I=x.threads.length;return d.jsx(OY,{count:I,x:x.centerPercent,y:b-4+HAe,onClick:()=>g(x),creators:T,elements:_,hasEditingPermissions:e,playbarWidth:0},`group-${R}`)}),f.map((x,S)=>{const T=x.threads.flatMap(_=>_.elements);return d.jsx("div",{className:"absolute flex flex-col items-center",style:{left:`${x.centerPercent}%`,top:`${b}px`,transform:"translateX(-50%)",width:"48px",pointerEvents:"auto"},children:d.jsx(lI,{threadId:`collapsed-${S}`,elements:T,x:0,y:0,scale:1,hasEditingPermissions:e,playbarWidth:0,isCollapsed:!0})},`collapsed-${S}`)}),m.map(({rootElementId:x,elements:S,positionPercent:T,linkPositionPercent:_})=>d.jsx("div",{className:"thread-annotation-group absolute flex flex-col items-center",style:{left:`${_??T}%`,top:`${b}px`,transform:"translateX(-50%)",width:`${Pr}px`,overflow:"visible"},children:d.jsx(lI,{threadId:x,elements:S,x:0,y:0,scale:1,hasEditingPermissions:e,playbarWidth:0,showOnlyFirst:!1})},x))]})},(n,e)=>n.duration===e.duration&&n.hasEditingPermissions===e.hasEditingPermissions);NY.displayName="AnnotationLayer";const VAe={"accent-purple":"#a78bfa","accent-blue":"#60a5fa","accent-teal":"#5eead4","accent-green":"#4ade80","accent-lime":"#bef264","accent-orange":"#fdba74","accent-red":"#f87171","accent-gray":"#a1a1aa"},zAe=({hasEditingPermissions:n=!1})=>{const e=De(ne=>ne.boardState.tags||{}),t=Object.values(e),r=De(),s=De(ne=>ne.unseenElementIds),i=E.useMemo(()=>K9(r),[r.boardState.elements]),a=E.useMemo(()=>Y9(r),[s]),o=E.useMemo(()=>t.map(ne=>({id:ne.id,type:"tag",name:ne.name,color:ne.color})),[t]),l=E.useMemo(()=>[...i,...a,...o],[i,a,o]),c=dn(ne=>ne.addFilter),u=dn(ne=>ne.removeFilter),f=dn(ne=>ne.isFilterActive),m=dn(ne=>ne.isFilteringActive),g=dn(ne=>ne.filterMode),y=dn(ne=>ne.setFilterMode),b=De(ne=>ne.deleteTag),x=De(ne=>ne.renameTag),S=De(ne=>ne.changeTagColor),T=De(ne=>ne.getElementsWithTag),_=De(ne=>ne.createTag),[R,I]=E.useState(""),[C,L]=E.useState(0),[k,M]=E.useState(null),[D,U]=E.useState(!1),$=g==="include"?"is":"is-not",[V,B]=E.useState({isOpen:!1,tagId:null,tagName:"",elementCount:0}),[W,F]=E.useState({isOpen:!1,tagId:null,tagName:""}),[j,q]=E.useState(!1),H=E.useRef(null),N=m(),O=E.useMemo(()=>N?l.filter(ne=>{const ce=f(ne.id);return $==="is"?ce:!ce}):[],[N,l,f,$]),z=E.useMemo(()=>l.filter(ne=>ne.name.toLowerCase().includes(R.toLowerCase())),[l,R]),G=R.trim()&&!t.some(ne=>ne.name.toLowerCase()===R.trim().toLowerCase()),Y=z.length+(G?1:0),Q=()=>{const ne=["accent-purple","accent-blue","accent-teal","accent-green","accent-lime","accent-orange","accent-red"],ce=new Set(t.map(Oe=>Oe.color));let Ce=ne.find(Oe=>!ce.has(Oe));if(!Ce){const Oe=t.length%ne.length;Ce=ne[Oe]}return Ce};E.useEffect(()=>{setTimeout(()=>H.current?.focus(),0)},[]),E.useEffect(()=>{L(0)},[R]);const J=E.useCallback(ne=>{N&&f(ne)?u(ne):c(ne)},[N,$,f,c,u]),ee=E.useCallback(async()=>{const ne=R.trim();if(ne&&!D){U(!0);try{await _(ne)&&I("")}finally{U(!1)}}},[R,D,_]),oe=E.useCallback(ne=>{ne<z.length?(J(z[ne].id),I("")):G&&ne===z.length&&ee()},[z,J,G,ee]),te=E.useCallback((ne,ce)=>{ce&&(ce.preventDefault(),ce.stopPropagation()),u(ne)},[u]),se=(ne,ce)=>{const Ce=T(ne);if(Ce.length===0){b(ne);return}B({isOpen:!0,tagId:ne,tagName:ce,elementCount:Ce.length})},he=()=>{V.tagId&&b(V.tagId)},Z=()=>{B({isOpen:!1,tagId:null,tagName:"",elementCount:0})},pe=(ne,ce)=>{F({isOpen:!0,tagId:ne,tagName:ce})},ye=async ne=>{if(W.tagId){q(!0);try{await x(W.tagId,ne),F({isOpen:!1,tagId:null,tagName:""})}catch(ce){console.error("Failed to rename tag:",ce)}finally{q(!1)}}},ae=()=>{j||F({isOpen:!1,tagId:null,tagName:""})},le=async(ne,ce)=>{try{await S(ne,ce)}catch(Ce){console.error("Failed to change tag color:",Ce)}},ie=[{name:"Purple",value:"accent-purple"},{name:"Blue",value:"accent-blue"},{name:"Teal",value:"accent-teal"},{name:"Green",value:"accent-green"},{name:"Lime",value:"accent-lime"},{name:"Orange",value:"accent-orange"},{name:"Red",value:"accent-red"}];E.useEffect(()=>{const ne=ce=>{W.isOpen||V.isOpen||Y!==0&&(ce.key==="ArrowDown"?(ce.preventDefault(),ce.stopPropagation(),L(Ce=>(Ce+1)%Y)):ce.key==="ArrowUp"?(ce.preventDefault(),ce.stopPropagation(),L(Ce=>(Ce-1+Y)%Y)):ce.key==="Enter"&&(ce.preventDefault(),ce.stopPropagation(),oe(C)))};return window.addEventListener("keydown",ne,!0),()=>window.removeEventListener("keydown",ne,!0)},[C,Y,oe,W.isOpen,V.isOpen]);const fe=ne=>{if(!N)return!1;const ce=f(ne);return $==="is"?ce:!ce},Ie=ne=>{if(ne.type==="apptag"){if(ne.appTagType==="creator")return d.jsx(Bs,{text:ne.name,type:"apptag",appTagType:"creator",image:ne.avatarUrl});if(ne.appTagType==="time"){const ce=ne.appTagValue==="new";return d.jsx(Bs,{text:ne.name,type:"apptag",appTagType:"creationTime",icon:d.jsx(ev,{size:12}),showNewIndicator:ce})}}return d.jsx(Bs,{text:ne.name,type:"tag",color:ne.color})};return d.jsxs("div",{className:"w-[260px] animate-in fade-in-0 slide-in-from-bottom-2 duration-200",children:[d.jsxs("div",{className:"w-full bg-inbetween-background element-border shadow-xl shadow-black/50 rounded-3xl",children:[d.jsx("div",{className:"overflow-y-auto py-3",children:z.length===0&&!G?d.jsx("div",{className:"px-3 py-2 text-xs text-text-secondary",children:R?"No filters found":"No filters available"}):d.jsxs(d.Fragment,{children:[z.map((ne,ce)=>{const Ce=fe(ne.id),Oe=ce===C,ze=k===ne.id;ne.type;const We=ne.type==="tag",tt=ce>0?z[ce-1]:null,lt=!R&&ne.appTagType==="creator"&&(!tt||tt.appTagType!=="creator"),Ee=!R&&ne.appTagType==="time"&&(!tt||tt.appTagType!=="time"),be=!R&&We&&(!tt||tt.type!=="tag");return d.jsxs(ve.Fragment,{children:[lt&&d.jsx("div",{className:"px-4 pt-2 pb-1 text-[10px] font-semibold text-text-secondary uppercase tracking-wider",children:"Created by"}),Ee&&d.jsx("div",{className:"px-4 pt-2 pb-1 text-[10px] font-semibold text-text-secondary uppercase tracking-wider",children:"Creation time"}),be&&d.jsx("div",{className:"px-4 pt-2 pb-1 text-[10px] font-semibold text-text-secondary uppercase tracking-wider",children:"Tags"}),d.jsxs("div",{className:je("flex items-center justify-between pr-3 pl-1.5 py-1.5 cursor-pointer transition-colors rounded-3xl mx-2",Oe&&"bg-white/10",!Oe&&"hover:bg-white/5"),onClick:()=>oe(ce),onMouseEnter:()=>{L(ce),M(ne.id)},onMouseLeave:()=>M(null),children:[Ie(ne),d.jsxs("div",{className:"flex items-center gap-2",children:[n&&ze&&We?d.jsxs(Gs,{modal:!1,children:[d.jsx(qs,{asChild:!0,onClick:Ae=>Ae.stopPropagation(),children:d.jsx("button",{className:"w-5 h-5 flex items-center justify-center hover:bg-white/10 rounded transition-colors",children:d.jsx(eD,{className:"w-4 h-4 text-text-secondary"})})}),d.jsxs(Ms,{align:"start",side:"bottom",sideOffset:4,className:"min-w-[140px]",children:[d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:Ae=>{Ae.stopPropagation(),pe(ne.id,ne.name)},children:[d.jsx(tv,{className:"w-4 h-4"}),d.jsx("span",{children:"Rename tag"})]}),d.jsxs(HD,{children:[d.jsxs(ES,{className:"text-text-primary focus:text-text-primary gap-2",children:[d.jsx(rz,{className:"w-4 h-4"}),d.jsx("span",{children:"Color"})]}),d.jsx(SS,{className:"min-w-[120px]",children:ie.map(Ae=>d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:Me=>{Me.stopPropagation(),le(ne.id,Ae.value)},children:[d.jsx("div",{className:"w-4 h-4 rounded-full border border-white/20",style:{backgroundColor:VAe[Ae.value]}}),d.jsx("span",{children:Ae.name}),ne.color===Ae.value&&d.jsx("span",{className:"ml-auto text-xs",children:""})]},Ae.value))})]}),d.jsxs(Pn,{className:"text-text-primary focus:text-text-primary gap-2",onClick:Ae=>{Ae.stopPropagation(),se(ne.id,ne.name)},children:[d.jsx(rv,{className:"w-4 h-4"}),d.jsx("span",{children:"Delete tag"})]})]})]}):d.jsx("div",{className:"w-5 h-5"}),d.jsx("div",{className:je("w-4 h-4 border rounded-sm flex items-center justify-center transition-colors",Ce?"bg-text-secondary text-card-background":"border-text-secondary/50"),children:Ce&&d.jsx("span",{className:"text-xs",children:""})})]})]})]},ne.id)}),G&&d.jsx("div",{className:je("flex items-center justify-between pr-3 pl-1.5 py-1.5 cursor-pointer transition-colors border-t border-border/30 mt-1 mx-2 rounded-3xl",C===z.length&&"bg-white/10",C!==z.length&&"hover:bg-white/5"),onClick:ee,onMouseEnter:()=>L(z.length),children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Jc,{size:14,className:"text-text-secondary ml-1"}),d.jsx("span",{className:"text-xs text-text-secondary",children:"Create Tag "}),d.jsx(Bs,{text:R.trim(),type:"tag",color:Q()})]})})]})}),d.jsx("div",{className:"px-3 pt-3",children:d.jsxs("div",{className:"flex items-center gap-1  text-xs text-text-secondary font-medium",children:[d.jsx("span",{children:"Tag"}),d.jsxs(Gs,{modal:!1,children:[d.jsx(qs,{asChild:!0,children:d.jsxs("button",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-border/30 hover:bg-border/50 transition-colors",children:[d.jsx("span",{className:"text-text-secondary text-xs",children:$==="is"?"contains":"does not contain"}),d.jsx(Id,{className:"w-3 h-3 text-text-secondary"})]})}),d.jsxs(Ms,{align:"start",side:"top",sideOffset:4,children:[d.jsx(Pn,{onClick:()=>y("include"),children:"contains"}),d.jsx(Pn,{onClick:()=>y("exclude"),children:"does not contain"})]})]})]})}),d.jsx("div",{className:"p-2 ",children:d.jsxs("div",{className:"flex flex-wrap gap-1.5 items-center min-h-[44px] px-3 py-2 rounded-3xl bg-card-background element-border",children:[O.map(ne=>d.jsx(ve.Fragment,{children:ne.type==="apptag"&&ne.appTagType==="creator"?d.jsx(Bs,{text:ne.name,type:"apptag",appTagType:"creator",image:ne.avatarUrl,showRemove:!0,onRemove:ce=>te(ne.id,ce)}):ne.type==="apptag"&&ne.appTagType==="time"?d.jsx(Bs,{text:ne.name,type:"apptag",appTagType:"creationTime",icon:d.jsx(ev,{size:12}),showNewIndicator:ne.appTagValue==="new",showRemove:!0,onRemove:ce=>te(ne.id,ce)}):d.jsx(Bs,{text:ne.name,type:"tag",color:ne.color,showRemove:!0,onRemove:ce=>te(ne.id,ce)})},ne.id)),d.jsx("input",{ref:H,type:"text",value:R,onChange:ne=>I(ne.target.value),onKeyDown:ne=>{if(ne.stopPropagation(),ne.key==="Escape")I("");else if(ne.key==="Backspace"&&R===""&&O.length>0){const ce=O[O.length-1];te(ce.id)}},className:" pl-22flex-1 min-w-[60px] bg-transparent outline-none text-xs text-text-primary placeholder:text-text-secondary/60",placeholder:O.length===0?"Search or Create Tags...":""})]})})]}),d.jsx(EK,{isOpen:V.isOpen,onClose:Z,onConfirm:he,tagName:V.tagName,elementCount:V.elementCount}),d.jsx(SK,{isOpen:W.isOpen,onClose:ae,onConfirm:ye,currentName:W.tagName,isRenaming:j})]})},GAe=()=>{const n=yt(L=>L.timelineScale),e=yt(L=>L.timelineOffset),t=yt(L=>L.viewportWidth),r=yt(L=>L.playbarWidth),s=yt(L=>L.updateTimelineTransform),i=E.useRef(null),a=E.useRef(!1),[o,l]=E.useState(!1),[c,u]=E.useState(()=>window.innerWidth<768);E.useEffect(()=>{const L=()=>u(window.innerWidth<768);return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]);const m=typeof window<"u"&&window.innerWidth<768?8:Pr/2+10,g=E.useCallback(L=>{if(!i.current||a.current)return;const k=i.current.getBoundingClientRect(),D=(L.clientX-k.left)/k.width,U=m,$=t-m-r,V=U+D*($-U);s(n,V)},[n,t,r,s]),y=E.useCallback(L=>{L.stopPropagation(),L.preventDefault(),a.current=!0,l(!0);const k=L.clientX,M=e,D=$=>{if(!i.current)return;const V=$.clientX-k,B=i.current.clientWidth,W=m,j=t-m-r-W,H=V/B*j,N=M+H;s(n,N)},U=()=>{a.current=!1,l(!1),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",U),document.body.style.cursor=""};document.addEventListener("mousemove",D),document.addEventListener("mouseup",U),document.body.style.cursor="grabbing"},[e,n,t,r,s]),b=n>1&&r>t,x=Math.max(2,t/r*100),S=m,T=t-m-r;let _=0;T<S&&(_=(e-S)/(T-S),_=Math.max(0,Math.min(1,_)));const R=100-x,I=_*R,C=o?"border-text-primary":"border-text-primary/30 hover:border-text-primary/30";return c?null:d.jsx("div",{ref:i,className:"group relative w-full rounded-full cursor-pointer transition-all duration-200",style:{height:"6px",opacity:b?1:0,pointerEvents:b?"auto":"none"},onMouseDown:g,onMouseEnter:L=>{L.currentTarget.style.height="12px"},onMouseLeave:L=>{L.currentTarget.style.height="6px"},children:d.jsx("div",{className:`absolute top-0 h-full ${C} bg-card-background border rounded-full transition-colors duration-150`,style:{width:`${x}%`,left:`${I}%`,cursor:"grab"},onMouseDown:y})})},qAe=({hasEditingPermissions:n})=>{const[e,t]=E.useState(!1),r=yt(U=>U.resetZoom),s=yt(U=>U.zoomIn),i=yt(U=>U.zoomOut),a=E.useCallback(()=>{r(()=>{})},[r]),o=E.useCallback(()=>{s()},[s]),l=E.useCallback(()=>{i()},[i]),c=dn(U=>U.isFilterToolbarOpen),u=dn(U=>U.toggleFilterToolbar),f=dn(U=>U.clearAllFilters),m=dn(U=>U.addFilter),g=dn(U=>U.setFilterMode);dn(U=>U.getVisibleElementCount);const y=dn(U=>U.activeFilterIds),b=dn(U=>U.filterMode),x=dn(U=>U.isFilteringActive)(),S=De(U=>U.boardState.tags||{}),T=De(),_=De(U=>U.unseenElementIds),R=E.useMemo(()=>K9(T),[T.boardState.elements]),I=E.useMemo(()=>Y9(T),[_]),C=Object.values(S),L=()=>{f(),g("include"),m("apptag:time:new"),t(!0)},k=(_?.size??0)>0&&!e,M=E.useMemo(()=>{const U=[];return y.forEach($=>{if($.startsWith("apptag:creator:")){const V=R.find(B=>B.id===$);V&&U.push(V)}else if($.startsWith("apptag:time:")){const V=I.find(B=>B.id===$);V&&U.push(V)}else{const V=C.find(B=>B.id===$);V&&U.push({id:V.id,name:V.name,color:V.color,type:"tag"})}}),U},[y,R,I,C]),D=U=>U.type==="tag"?d.jsx(Bs,{text:U.name,type:"tag",color:U.color},U.id):U.appTagType==="creator"?d.jsx(Bs,{text:U.name,type:"apptag",appTagType:"creator",image:U.avatarUrl},U.id):U.appTagType==="time"?d.jsx(Bs,{text:U.name,type:"apptag",appTagType:"creationTime",icon:d.jsx(ev,{size:12}),showNewIndicator:U.appTagValue==="new"},U.id):null;return d.jsxs(yi,{delayDuration:0,children:[d.jsx("div",{className:"hidden md:flex absolute bottom-2 left-2 z-50 items-center gap-1",children:d.jsx("div",{className:"h-8 flex items-center bg-inbetween-background backdrop-blur-md rounded-full px-1.5",children:d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-6 w-6 text-text-secondary hover:text-text-primary cursor-pointer rounded transition-colors",onClick:l,type:"button",children:d.jsx(iue,{className:"h-3 w-3"})})}),d.jsx($n,{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:["Zoom out",d.jsx(gn,{children:"-"})]})})]}),d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-6 w-6 text-text-secondary hover:text-text-primary cursor-pointer rounded transition-colors",onClick:a,type:"button",children:d.jsx(cue,{className:"h-3 w-3"})})}),d.jsx($n,{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:["Reset zoom",d.jsx(gn,{children:"Z"})]})})]}),d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-6 w-6 text-text-secondary hover:text-text-primary cursor-pointer rounded transition-colors",onClick:o,type:"button",children:d.jsx(Jc,{className:"h-3 w-3"})})}),d.jsx($n,{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:["Zoom in",d.jsx(gn,{children:"+"})]})})]})]})})}),k&&d.jsx("div",{className:"hidden md:flex absolute bottom-28 left-1/2 -translate-x-1/2 z-50",children:d.jsx("div",{className:"pointer-events-none",children:d.jsx("div",{className:"relative px-6 py-2 pr-2 bg-card-background group border rounded-full pointer-events-auto",children:d.jsxs("div",{className:"relative flex items-center gap-2",children:[d.jsxs("p",{className:"text-xs text-text-secondary whitespace-nowrap",children:[d.jsx("span",{className:"text-primary",children:_?.size??0})," new comment since last access"]}),d.jsx(dt,{onClick:L,className:"h-7 px-4 text-xs button-primary rounded-full",variant:"default",children:"Show"}),d.jsx("button",{onClick:U=>{U.stopPropagation(),t(!0)},className:"relative z-10 p-1 rounded-full bg-element-background transition-colors duration-200","aria-label":"Dismiss new elements indicator",children:d.jsx($o,{className:"h-3 w-3 text-text-secondary/50 hover:text-text-secondary"})})]})})})}),d.jsx("div",{className:"hidden md:flex absolute bottom-2 right-2 z-50 items-center gap-2",children:d.jsxs(Gs,{modal:!1,open:c,onOpenChange:u,children:[d.jsx(qs,{asChild:!0,children:d.jsx("div",{children:x?d.jsxs("button",{className:"flex items-start cursor-pointer transition-all duration-200 ease-out button-primary rounded-[20px] px-4 py-2 gap-2 min-h-[40px] max-w-[400px]",type:"button",children:[d.jsx(_3,{className:"h-4 w-4 flex-shrink-0 mt-1"}),d.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1.5 min-w-0",children:[d.jsx("span",{className:"text-xs font-medium text-card-background whitespace-nowrap",children:b==="include"?"Contains":"Does not contain"}),M.map(D)]}),d.jsxs(Tr,{delayDuration:100,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{onClick:U=>{U.preventDefault(),U.stopPropagation(),f()},className:"flex items-center justify-center w-6 h-6 rounded-full  text-card-background hover:bg-card-background/70 hover:text-white transition-all flex-shrink-0 -mr-2",type:"button",children:d.jsx($o,{className:"h-3.5 w-3.5"})})}),d.jsx($n,{side:"top",children:d.jsx("p",{children:"Clear Filter"})})]})]}):d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center h-10 w-10 cursor-pointer transition-all duration-200 ease-out overflow-hidden button-secondary rounded-full",type:"button",children:d.jsx(_3,{className:"h-4 w-4 flex-shrink-0"})})}),d.jsx($n,{side:"top",children:"Filter"})]})})}),d.jsx(Ms,{align:"end",side:"top",sideOffset:10,className:"p-0 bg-transparent border-none shadow-none",children:d.jsx(zAe,{hasEditingPermissions:n})})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-40",children:d.jsx(GAe,{})})]})},WAe=E.memo(dq,(n,e)=>n.currentTime===e.currentTime&&n.duration===e.duration&&n.isPlaying===e.isPlaying&&n.hasEditingPermissions===e.hasEditingPermissions&&n.youtubeUrl===e.youtubeUrl&&n.nativeAsset===e.nativeAsset&&n.playbarWidth===e.playbarWidth&&n.timelineScale===e.timelineScale),KAe=({hasEditingPermissions:n,youtubeUrl:e,nativeAsset:t,onCreateLinkedFrame:r,onCreateElementInFrame:s})=>{const i=E.useRef(null),a=E.useRef(null),o=E.useRef(null),l=E.useRef(null),c=E.useRef(null),[u,f]=E.useState("none"),m=E.useRef("none"),[g,y]=E.useState(!1),[b,x]=E.useState(0),[S,T]=E.useState(0),[_,R]=E.useState(!1),[I,C]=E.useState(0),L=E.useRef({initialTouches:null,initialScale:1,initialOffset:20,initialDistance:0,centerX:0,lastTouchTime:0}),k=E.useRef({scale:1,offsetX:20}),M=E.useRef(0),D=E.useRef({x:0,y:0}),U=E.useRef(null),$=E.useRef(!1),V=E.useRef("none"),B=E.useRef(null),W=E.useRef("none"),F=He(Ee=>Ee.duration),j=He(Ee=>Ee.currentTime),q=He(Ee=>Ee.isPlaying),H=yt(Ee=>Ee.updateTimelineTransform),N=yt(Ee=>Ee.setDuration),O=yt(Ee=>Ee.setViewportWidth),z=yt(Ee=>Ee.setMobileState),G=yt(Ee=>Ee.timelineScale),Y=yt(Ee=>Ee.timelineOffset),Q=yt(Ee=>Ee.resetAllThreadScrolls),J=yt(Ee=>Ee.disableAutoFollow),ee=yt(Ee=>Ee.isAutoFollowEnabled),oe=yt(Ee=>Ee.playbarWidth);He(Ee=>Ee.playbackRate);const te=De(Ee=>Ee.clearSelection),[se,he]=E.useState(()=>typeof window<"u"?window.innerWidth<768:!1);E.useEffect(()=>{const Ee=()=>he(window.innerWidth<768);return window.addEventListener("resize",Ee),()=>window.removeEventListener("resize",Ee)},[]),E.useEffect(()=>{z(se)},[se,z]);const Z=se?8:Pr/2+10,pe=E.useCallback(()=>i.current?.clientWidth||window.innerWidth,[]),ye=E.useCallback(()=>Math.max(0,pe()-Z*2),[pe]),ae=E.useCallback(Ee=>ye()*Ee,[ye]),le=ae(k.current?.scale||G),ie=E.useCallback((Ee,be)=>{const Ae=k.current.scale;Ee!==Ae&&Q();const Ue=yt.getState().scrollEnabledAtOffset;Ue!==null&&Math.abs(be-Ue)>200&&Q();const Ge=pe(),Ke=ae(Ee),Qe=Ge-Z-Ke,ht=Z,Vt=Math.max(Qe,Math.min(ht,be));k.current={scale:Ee,offsetX:Vt};const mn=.5;if(Math.abs(Vt-ht)<=mn?W.current="left":Math.abs(Vt-Qe)<=mn?W.current="right":W.current="none",o.current){o.current.style.transform=`translate3d(${Vt}px, 0, 0)`;const xn=o.current.querySelector(".timeline-element .video-playbar > div > div");xn&&(xn.style.width=`${ae(Ee)}px`)}yt.getState().disableAutoFollow(),H(Ee,Vt)},[pe,ae,H,Q,J]);E.useEffect(()=>{F>0&&N(F)},[F,N]),E.useEffect(()=>{const Ee=pe();O(Ee)},[]),E.useEffect(()=>{const Ee=k.current.scale,be=k.current.offsetX;if((Math.abs(G-Ee)>.001||Math.abs(Y-be)>.5)&&(k.current={scale:G,offsetX:Y},o.current)){o.current.style.transform=`translate3d(${Y}px, 0, 0)`;const Ae=o.current.querySelector(".timeline-element .video-playbar > div > div");Ae&&(Ae.style.width=`${ae(G)}px`)}},[G,Y,ae]),E.useEffect(()=>{const Ee=()=>{const{scale:be,offsetX:Ae}=k.current,Me=pe();O(Me),ie(be,Ae)};return window.addEventListener("resize",Ee),()=>window.removeEventListener("resize",Ee)},[ie,O,pe]),E.useEffect(()=>{q||yt.getState().disableAutoFollow()},[q]),E.useEffect(()=>{if(!ee||!q||F===0)return;let Ee=null,be=performance.now(),Ae=He.getState().currentTime,Me=performance.now();const Ue=Ge=>{if(!yt.getState().isAutoFollowEnabled)return;const Ke=(Ge-be)/1e3;be=Ge;const Qe=He.getState().playbackRate||1,ht=He.getState(),Vt=yt.getState().duration,mn=yt.getState().playbarWidth;Math.abs(ht.currentTime-Ae)>.01&&(Ae=ht.currentTime,Me=Ge);let xn=Ae;if(ht.isPlaying&&!ht.isBuffering){const zt=(Ge-Me)/1e3;xn=Ae+zt*Qe,xn=Math.min(xn,Vt)}const Bn=mn/Vt*Qe,An=k.current.offsetX,Lt=k.current.scale,jt=xn/Vt*mn,Xt=An+jt,nt=pe(),Je=nt/2;let ot=1;const Dt=Xt-Je;Math.abs(Dt)>10&&(Dt<0?ot=.5:ot=1.5);const Xe=Bn*ot*Ke,st=An-Xe,wt=ae(Lt),qt=nt-Z-wt,Tt=Math.max(qt,Math.min(Z,st));k.current.offsetX=Tt,o.current&&(o.current.style.transform=`translate3d(${Tt}px, 0, 0)`),H(Lt,Tt),yt.getState().isAutoFollowEnabled&&(Ee=requestAnimationFrame(Ue))};return Ue.lastStoreUpdate=performance.now(),Ee=requestAnimationFrame(Ue),()=>{Ee!==null&&cancelAnimationFrame(Ee)}},[ee,q,F,oe,pe,ae,H]);const fe=E.useCallback(Ee=>{const be=m.current;if(be==="none")return;const Ae=i.current?.getBoundingClientRect();if(!Ae||!(Ee.clientX>=Ae.left&&Ee.clientX<=Ae.right&&Ee.clientY>=Ae.top&&Ee.clientY<=Ae.bottom))return;Ee.preventDefault(),Ee.stopPropagation();const Ue=a.current?.getBoundingClientRect();if(!Ue)return;const Ge=k.current.scale,Ke=k.current.offsetX,Qe=yt.getState();if(be==="primary"){const ht=Ee.deltaY,mn=Ke-ht*1.5;ie(Ge,mn),Qe.startScrolling(),Qe.stopScrollingDelayed()}else if(be==="secondary"){const ht=Ee.deltaY,Vt=Ee.clientX-Ue.left,mn=pe(),xn=ye(),Bn=(Vt-Ke)/Ge,An=ht<0?1:-1,jt=1+An*.002*Math.abs(ht),Xt=Math.max(1,Math.min(1200,Ge*jt));let nt=Vt,Je=Bn,ot=nt-Je*Xt;const Dt=ae(Xt),me=mn-Z-Dt,Ye=Z;An<0&&(ot>Ye||ot<me)&&(ot>Ye?(nt=Z,Je=0):ot<me&&(nt=mn-Z,Je=xn),ot=nt-Je*Xt),ie(Xt,ot),Qe.startScrolling(),Qe.stopScrollingDelayed()}},[ie,pe,ae,ye]),Ie=E.useCallback(Ee=>{if(Ee.preventDefault(),Ee.stopPropagation(),m.current!=="none")return;const be=a.current?.getBoundingClientRect();if(!be)return;U.current&&clearTimeout(U.current);const Ae=yt.getState(),Me=Math.abs(Ee.deltaY)>10||Math.abs(Ee.deltaX)>10,Ue=k.current.scale,Ge=k.current.offsetX,Ke=Ee.ctrlKey&&Math.abs(Ee.deltaY)>0&&Ee.wheelDeltaY!==void 0&&Math.abs(Ee.wheelDeltaY)!==Math.abs(Ee.deltaY*3);if(Ke){const Qe=Ee.deltaY!==0?Ee.deltaY:Ee.deltaX,ht=Ee.clientX-be.left,Vt=pe(),mn=ye(),xn=(ht-Ge)/Ue;if(Ke){(!B.current||!B.current.isActive)&&(B.current={isActive:!0,initialScale:Ue,initialOffset:Ge,anchorX:ht,anchorXBase:xn});const Bn=B.current,An=Qe<0?1:-1,Lt=1,jt=Math.abs(Qe),Xt=Math.min(1.2,jt/100),nt=Math.exp(An*Lt*Xt),Je=Math.max(1,Math.min(1200,Ue*nt));let ot=Bn.anchorX,Dt=Bn.anchorXBase,me=ot-Dt*Je;const Ye=ae(Je),Xe=Vt-Z-Ye,st=Z;An<0&&(me>st||me<Xe)&&(me>st?(ot=Z,Dt=0):me<Xe&&(ot=Vt-Z,Dt=mn),me=ot-Dt*Je),ie(Je,me),Ae.startScrolling(),Ae.stopScrollingDelayed()}}else{const Qe=Ee.deltaX;if(D.current.x+=Qe,Math.abs(D.current.x)>2){const Vt=Me?1:.5,mn=Ge-D.current.x*Vt;ie(Ue,mn),Ae.startScrolling(),Ae.stopScrollingDelayed(),D.current.x=0}M.current=0}return U.current=setTimeout(()=>{M.current=0,D.current={x:0,y:0},V.current="none",$.current=!1,B.current&&B.current.isActive&&(B.current.isActive=!1)},150),!1},[ie,pe,ae,ye]),ne=E.useCallback(Ee=>{const be=Ee.target;be.closest(".timeline-element")||be.closest("button")||be.closest("[role='button']")||be.closest("[style*='pointer-events: auto']")||(te(),Ze(async()=>{const{useCanvasStore:Me}=await Promise.resolve().then(()=>ks);return{useCanvasStore:Me}},void 0).then(({useCanvasStore:Me})=>{const Ue=Me.getState();Ue.requestDiscardDraft(()=>{Ue.discardDraft("timeline")},"timeline")}),y(!0),x(Ee.clientX),T(k.current.offsetX))},[te]),ce=E.useCallback(Ee=>{if(!g)return;const be=Ee.clientX-b,Ae=S+be,Me=k.current.scale;ie(Me,Ae)},[g,b,S,ie]),Ce=E.useCallback(()=>{y(!1)},[]),Oe=E.useCallback(Ee=>{if(Ee.length<2)return 0;const be=Ee[0],Ae=Ee[1],Me=be.clientX-Ae.clientX,Ue=be.clientY-Ae.clientY;return Math.sqrt(Me*Me+Ue*Ue)},[]),ze=E.useCallback(Ee=>{if(Ee.length===1)return{x:Ee[0].clientX,y:Ee[0].clientY};const be=Ee[0],Ae=Ee[1];return{x:(be.clientX+Ae.clientX)/2,y:(be.clientY+Ae.clientY)/2}},[]),We=E.useCallback(Ee=>{const be=Ee.target;if(be.closest(".timeline-element")||be.closest("button")||be.closest("[role='button']")||be.closest("[style*='pointer-events: auto']"))return;const Ae=Ee.touches,Me=Date.now();R(!0),C(Me),L.current={initialTouches:Ae,initialScale:k.current.scale,initialOffset:k.current.offsetX,initialDistance:Oe(Ae),centerX:ze(Ae).x,lastTouchTime:Me},te()},[Oe,ze,te]),tt=E.useCallback(Ee=>{if(!_||!L.current.initialTouches)return;Ee.preventDefault();const be=Ee.touches,Ae=L.current;if(be.length===1&&Ae.initialTouches.length===1){const Me=be[0],Ue=Ae.initialTouches[0],Ge=Me.clientX-Ue.clientX,Ke=Ae.initialOffset+Ge;ie(k.current.scale,Ke)}else if(be.length===2&&Ae.initialTouches.length===2){const Me=Oe(be),Ue=ze(be);if(Ae.initialDistance>0){const Ge=Me/Ae.initialDistance,Ke=Math.max(1,Math.min(1200,Ae.initialScale*Ge)),Qe=a.current?.getBoundingClientRect();if(Qe){const ht=Ue.x-Qe.left,Vt=(ht-Ae.initialOffset)/Ae.initialScale,mn=ht-Vt*Ke;ie(Ke,mn)}}}},[_,Oe,ze,ie]),lt=E.useCallback(Ee=>{if(!_)return;Date.now()-I<200&&Ee.changedTouches.length===1&&Ze(async()=>{const{useToolbarStore:Me}=await Promise.resolve().then(()=>di);return{useToolbarStore:Me}},void 0).then(({useToolbarStore:Me})=>{Me.getState().exitToIdle()}),R(!1),L.current={initialTouches:null,initialScale:1,initialOffset:20,initialDistance:0,centerX:0,lastTouchTime:0}},[_,I]);return E.useEffect(()=>{if(g)return document.addEventListener("mousemove",ce),document.addEventListener("mouseup",Ce),()=>{document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",Ce)}},[g,ce,Ce]),E.useEffect(()=>{if(!i.current)return;const be=Ue=>{const Ge=Ue.ctrlKey||Ue.metaKey,Ke=Ue.altKey;let Qe="none";Ke?Qe="secondary":Ge&&(Qe="primary"),m.current!==Qe&&(m.current=Qe,f(Qe),Qe!=="none"&&!c.current&&(c.current=fe,document.addEventListener("wheel",fe,{passive:!1,capture:!0})))},Ae=Ue=>{const Ge=Ue.ctrlKey||Ue.metaKey,Ke=Ue.altKey;let Qe="none";Ke?Qe="secondary":Ge&&(Qe="primary"),m.current!==Qe&&(m.current=Qe,f(Qe),Qe==="none"&&c.current&&(document.removeEventListener("wheel",c.current,{capture:!0}),c.current=null))},Me=()=>{m.current!=="none"&&(m.current="none",f("none"),c.current&&(document.removeEventListener("wheel",c.current,{capture:!0}),c.current=null))};return document.addEventListener("keydown",be),document.addEventListener("keyup",Ae),window.addEventListener("blur",Me),()=>{document.removeEventListener("keydown",be),document.removeEventListener("keyup",Ae),window.removeEventListener("blur",Me),c.current&&(document.removeEventListener("wheel",c.current,{capture:!0}),c.current=null)}},[fe]),E.useEffect(()=>{if(!a.current||!i.current)return;l.current=Ie;const Ee=i.current,be=a.current;Ee.style.touchAction=se?"manipulation":"none",Ee.style.userSelect="none",be.style.touchAction=se?"manipulation":"none",be.style.userSelect="none",Ee.addEventListener("wheel",Ie,{passive:!1});const Ae=Me=>(Me.preventDefault(),!1);return document.addEventListener("gesturestart",Ae,{passive:!1}),document.addEventListener("gesturechange",Ae,{passive:!1}),document.addEventListener("gestureend",Ae,{passive:!1}),()=>{U.current&&clearTimeout(U.current),Ee&&Ee.removeEventListener("wheel",Ie),Ee&&(Ee.style.touchAction="",Ee.style.userSelect=""),be&&(be.style.touchAction="",be.style.userSelect=""),M.current=0,D.current={x:0,y:0},document.removeEventListener("gesturestart",Ae),document.removeEventListener("gesturechange",Ae),document.removeEventListener("gestureend",Ae)}},[Ie,se]),d.jsxs("div",{ref:i,className:"relative w-full h-full overflow-hidden",style:{backgroundColor:"#0a0a0a"},onMouseDown:ne,onTouchStart:We,onTouchMove:tt,onTouchEnd:lt,children:[d.jsx(Fbe,{offsetX:Y,offsetY:0}),d.jsx("div",{className:"absolute pointer-events-none bg-gradient-to-b from-card-background to-transparent",style:{left:"50%",transform:"translateX(-50%)",top:"48px",width:"100000px",height:"48px",zIndex:0,opacity:1}}),d.jsx("div",{ref:a,className:"absolute inset-x-0 top-0 bottom-0 flex items-start justify-start pt-7",style:{cursor:g?"grabbing":"grab"},children:d.jsx("div",{ref:o,className:"relative",style:{transform:`translate3d(${Y}px, 0, 0)`,transition:"none",willChange:"transform",minHeight:"600px",height:"auto"},children:d.jsxs("div",{className:"timeline-element",style:{position:"relative"},children:[d.jsx(WAe,{currentTime:j,duration:F,isPlaying:q,playbarWidth:le,hasEditingPermissions:n,youtubeUrl:e,nativeAsset:t,onCreateLinkedFrame:r,onCreateElementInFrame:s,preventSeekOnLinkClick:!1,timelineScale:G}),d.jsx("div",{style:{position:"absolute",top:"100%",left:0,width:"100%",pointerEvents:"none"},children:d.jsx(NY,{duration:F,hasEditingPermissions:n})})]})})}),d.jsx(qAe,{hasEditingPermissions:n}),d.jsx(MY,{hasEditingPermissions:n})]})},YAe=()=>{const n=Kc(x=>x.deletionConfirmationState),e=Kc(x=>x.closeDeletionConfirmation),t=Kc(x=>x.confirmDeletion),r=De(x=>x.boardState),{isOpen:s,elementsToDelete:i,deletionType:a="element"}=n,o=i.map(x=>r.elements[x]?.title).filter(Boolean),l=i.length,c=l>1,u=a==="attachment"?"attachment":"element",f=a==="attachment"?"attachments":"elements",m=a==="attachment"?"Attachment":"Element",g=a==="attachment"?"Attachments":"Elements",y=async()=>{await t()},b=()=>{e()};return d.jsx(Zn,{open:s,onOpenChange:b,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:["Delete ",c?g:m]}),d.jsx(zl,{children:c?d.jsxs(d.Fragment,{children:["Are you sure you want to delete ",l," ",f,"? This action cannot be undone."]}):d.jsxs(d.Fragment,{children:["Are you sure you want to delete this ",u,"? This action cannot be undone."]})})]}),l>1&&l<=5&&a==="element"&&d.jsxs("div",{className:"py-4",children:[d.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[g," to delete:"]}),d.jsx("ul",{className:"text-sm space-y-1",children:o.map((x,S)=>d.jsxs("li",{className:"truncate",children:[" ",x]},S))})]}),l>5&&d.jsx("div",{className:"py-4",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:[l," ",f," will be deleted."]})}),d.jsxs(ys,{children:[d.jsx(dt,{variant:"outline",onClick:b,children:"Cancel"}),d.jsxs(dt,{variant:"destructive",onClick:y,autoFocus:!0,children:["Delete ",c?"All":""]})]})]})})},XAe=()=>{const{permissions:n,requestPermissions:e,pendingRecordingType:t,setPendingRecordingType:r,closeSettingsPopover:s,isPermissionModalVisible:i,hasRequestedPermission:a,showPermissionModal:o,hidePermissionModal:l,setHasRequestedPermission:c,showPermissionConfirmation:u,setShowPermissionConfirmation:f}=vs(),m=cn(R=>R.user);E.useEffect(()=>{(async()=>{if(t){if(!m){r(null),l();return}await vs.getState().checkPermissions();const I=vs.getState().permissions,C=t==="thoughts",L=I.microphone!=="granted",k=C&&I.camera!=="granted";if(L||k)i||o();else{const M=new CustomEvent("startPendingRecording",{detail:{type:t}});window.dispatchEvent(M),r(null),l()}}})()},[t,n,i,o,r,m,l]);const g=()=>{l(),r(null),s(),c(!1)},y=()=>{f(!0)},b=()=>{f(!1),g()},x=()=>{f(!1)},S=()=>t==="thoughts"?"Flask needs to access camera and microphone to record your thoughts. Flask uses camera and mic only while recording.":"Flask needs to access your microphone to record your screen. Flask uses the mic only while recording.",T=()=>t==="thoughts"?d.jsx(QV,{className:"w-16 h-16"}):d.jsx(aue,{className:"w-16 h-16"});if(u)return d.jsx(Zn,{open:u,onOpenChange:()=>f(!1),children:d.jsxs(Kn,{className:"sm:max-w-[450px] border-border/50 z-[51]",overlayClassName:"fixed inset-0 z-50 bg-black/95 backdrop-blur-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",children:[d.jsx(ar,{children:d.jsx(or,{className:"text-xl",children:"You still haven't granted permissions"})}),d.jsx("div",{className:"py-4",children:d.jsx("p",{className:"text-md text-white/70 leading-relaxed",children:"Are you sure you want to leave?"})}),d.jsxs("div",{className:"flex gap-3 justify-end",children:[d.jsx(dt,{variant:"ghost",className:"rounded-full text-text-secondary hover:text-white",onClick:b,children:"Cancel"}),d.jsx(dt,{variant:"secondary",className:"button-primary rounded-full",onClick:x,children:"Grant Permissions"})]})]})});const _=m&&t&&i;return d.jsxs(d.Fragment,{children:[d.jsx(Zn,{open:_,onOpenChange:y,children:d.jsxs(Kn,{className:"sm:max-w-[500px] border-border/50 relative !z-[100]",overlayClassName:"fixed inset-0 !z-[99] bg-black/95 backdrop-blur-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",children:[d.jsx("div",{className:"absolute -left-32 -top-32 w-48 h-48 pointer-events-none",children:d.jsx("img",{src:"/svgs/arrow.svg",alt:"",className:"w-full h-full transform -rotate-90"})}),d.jsx("div",{className:"absolute -right-32 -top-32 w-48 h-48 pointer-events-none",children:d.jsx("img",{src:"/svgs/arrow.svg",alt:"",className:"w-full h-full transform rotate-180 scale-x-[-1]"})}),d.jsx("div",{className:"flex justify-center mb-6",children:d.jsx("div",{className:"bg-gradient-to-b from-text-primary to-text-primary/50 bg-clip-text text-transparent",style:{WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:T()})}),d.jsx(ar,{children:d.jsx(or,{className:"text-xl text-center",children:"Allow permissions to continue"})}),d.jsx("div",{className:"py-4",children:d.jsx("p",{className:"text-md text-white/70 leading-relaxed text-center",children:S()})})]})}),i&&d.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 !z-[101]",children:d.jsx(dt,{variant:"ghost",className:"rounded-full text-white/60 hover:text-white/80 underline",onClick:y,children:"Close"})})]})},Et={MEDIA_PLAY_REQUEST:"mediaplayrequest",MEDIA_PAUSE_REQUEST:"mediapauserequest",MEDIA_MUTE_REQUEST:"mediamuterequest",MEDIA_UNMUTE_REQUEST:"mediaunmuterequest",MEDIA_VOLUME_REQUEST:"mediavolumerequest",MEDIA_SEEK_REQUEST:"mediaseekrequest",MEDIA_AIRPLAY_REQUEST:"mediaairplayrequest",MEDIA_ENTER_FULLSCREEN_REQUEST:"mediaenterfullscreenrequest",MEDIA_EXIT_FULLSCREEN_REQUEST:"mediaexitfullscreenrequest",MEDIA_PREVIEW_REQUEST:"mediapreviewrequest",MEDIA_ENTER_PIP_REQUEST:"mediaenterpiprequest",MEDIA_EXIT_PIP_REQUEST:"mediaexitpiprequest",MEDIA_ENTER_CAST_REQUEST:"mediaentercastrequest",MEDIA_EXIT_CAST_REQUEST:"mediaexitcastrequest",MEDIA_SHOW_TEXT_TRACKS_REQUEST:"mediashowtexttracksrequest",MEDIA_HIDE_TEXT_TRACKS_REQUEST:"mediahidetexttracksrequest",MEDIA_SHOW_SUBTITLES_REQUEST:"mediashowsubtitlesrequest",MEDIA_DISABLE_SUBTITLES_REQUEST:"mediadisablesubtitlesrequest",MEDIA_TOGGLE_SUBTITLES_REQUEST:"mediatogglesubtitlesrequest",MEDIA_PLAYBACK_RATE_REQUEST:"mediaplaybackraterequest",MEDIA_RENDITION_REQUEST:"mediarenditionrequest",MEDIA_AUDIO_TRACK_REQUEST:"mediaaudiotrackrequest",MEDIA_SEEK_TO_LIVE_REQUEST:"mediaseektoliverequest",REGISTER_MEDIA_STATE_RECEIVER:"registermediastatereceiver",UNREGISTER_MEDIA_STATE_RECEIVER:"unregistermediastatereceiver"},En={MEDIA_CHROME_ATTRIBUTES:"mediachromeattributes",MEDIA_CONTROLLER:"mediacontroller"},jY={MEDIA_AIRPLAY_UNAVAILABLE:"mediaAirplayUnavailable",MEDIA_AUDIO_TRACK_ENABLED:"mediaAudioTrackEnabled",MEDIA_AUDIO_TRACK_LIST:"mediaAudioTrackList",MEDIA_AUDIO_TRACK_UNAVAILABLE:"mediaAudioTrackUnavailable",MEDIA_BUFFERED:"mediaBuffered",MEDIA_CAST_UNAVAILABLE:"mediaCastUnavailable",MEDIA_CHAPTERS_CUES:"mediaChaptersCues",MEDIA_CURRENT_TIME:"mediaCurrentTime",MEDIA_DURATION:"mediaDuration",MEDIA_ENDED:"mediaEnded",MEDIA_ERROR:"mediaError",MEDIA_ERROR_CODE:"mediaErrorCode",MEDIA_ERROR_MESSAGE:"mediaErrorMessage",MEDIA_FULLSCREEN_UNAVAILABLE:"mediaFullscreenUnavailable",MEDIA_HAS_PLAYED:"mediaHasPlayed",MEDIA_HEIGHT:"mediaHeight",MEDIA_IS_AIRPLAYING:"mediaIsAirplaying",MEDIA_IS_CASTING:"mediaIsCasting",MEDIA_IS_FULLSCREEN:"mediaIsFullscreen",MEDIA_IS_PIP:"mediaIsPip",MEDIA_LOADING:"mediaLoading",MEDIA_MUTED:"mediaMuted",MEDIA_PAUSED:"mediaPaused",MEDIA_PIP_UNAVAILABLE:"mediaPipUnavailable",MEDIA_PLAYBACK_RATE:"mediaPlaybackRate",MEDIA_PREVIEW_CHAPTER:"mediaPreviewChapter",MEDIA_PREVIEW_COORDS:"mediaPreviewCoords",MEDIA_PREVIEW_IMAGE:"mediaPreviewImage",MEDIA_PREVIEW_TIME:"mediaPreviewTime",MEDIA_RENDITION_LIST:"mediaRenditionList",MEDIA_RENDITION_SELECTED:"mediaRenditionSelected",MEDIA_RENDITION_UNAVAILABLE:"mediaRenditionUnavailable",MEDIA_SEEKABLE:"mediaSeekable",MEDIA_STREAM_TYPE:"mediaStreamType",MEDIA_SUBTITLES_LIST:"mediaSubtitlesList",MEDIA_SUBTITLES_SHOWING:"mediaSubtitlesShowing",MEDIA_TARGET_LIVE_WINDOW:"mediaTargetLiveWindow",MEDIA_TIME_IS_LIVE:"mediaTimeIsLive",MEDIA_VOLUME:"mediaVolume",MEDIA_VOLUME_LEVEL:"mediaVolumeLevel",MEDIA_VOLUME_UNAVAILABLE:"mediaVolumeUnavailable",MEDIA_LANG:"mediaLang",MEDIA_WIDTH:"mediaWidth"},FY=Object.entries(jY),ue=FY.reduce((n,[e,t])=>(n[e]=t.toLowerCase(),n),{}),QAe={USER_INACTIVE_CHANGE:"userinactivechange",BREAKPOINTS_CHANGE:"breakpointchange",BREAKPOINTS_COMPUTED:"breakpointscomputed"},Xf=FY.reduce((n,[e,t])=>(n[e]=t.toLowerCase(),n),{...QAe});Object.entries(Xf).reduce((n,[e,t])=>{const r=ue[e];return r&&(n[t]=r),n},{userinactivechange:"userinactive"});const ZAe=Object.entries(ue).reduce((n,[e,t])=>{const r=Xf[e];return r&&(n[t]=r),n},{userinactive:"userinactivechange"}),Go={SUBTITLES:"subtitles",CAPTIONS:"captions",CHAPTERS:"chapters",METADATA:"metadata"},Lf={DISABLED:"disabled",SHOWING:"showing"},rB={MOUSE:"mouse",TOUCH:"touch"},Zi={UNAVAILABLE:"unavailable",UNSUPPORTED:"unsupported"},kl={LIVE:"live",ON_DEMAND:"on-demand",UNKNOWN:"unknown"},JAe={FULLSCREEN:"fullscreen"};function eRe(n){return n?.map(tRe).join(" ")}function tRe(n){if(n){const{id:e,width:t,height:r}=n;return[e,t,r].filter(s=>s!=null).join(":")}}function nRe(n){return n?.map(rRe).join(" ")}function rRe(n){if(n){const{id:e,kind:t,language:r,label:s}=n;return[e,t,r,s].filter(i=>i!=null).join(":")}}function aP(n){return typeof n=="number"&&!Number.isNaN(n)&&Number.isFinite(n)}const UY=n=>new Promise(e=>setTimeout(e,n)),sB=[{singular:"hour",plural:"hours"},{singular:"minute",plural:"minutes"},{singular:"second",plural:"seconds"}],sRe=(n,e)=>{const t=n===1?sB[e].singular:sB[e].plural;return`${n} ${t}`},Pg=n=>{if(!aP(n))return"";const e=Math.abs(n),t=e!==n,r=new Date(0,0,0,0,0,e,0);return`${[r.getHours(),r.getMinutes(),r.getSeconds()].map((o,l)=>o&&sRe(o,l)).filter(o=>o).join(", ")}${t?" remaining":""}`};function Xc(n,e){let t=!1;n<0&&(t=!0,n=0-n),n=n<0?0:n;let r=Math.floor(n%60),s=Math.floor(n/60%60),i=Math.floor(n/3600);const a=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(n)||n===1/0)&&(i=s=r="0"),i=i>0||o>0?i+":":"",s=((i||a>=10)&&s<10?"0"+s:s)+":",r=r<10?"0"+r:r,(t?"-":"")+i+s+r}const iRe={"Start airplay":"Start airplay","Stop airplay":"Stop airplay",Audio:"Audio",Captions:"Captions","Enable captions":"Enable captions","Disable captions":"Disable captions","Start casting":"Start casting","Stop casting":"Stop casting","Enter fullscreen mode":"Enter fullscreen mode","Exit fullscreen mode":"Exit fullscreen mode",Mute:"Mute",Unmute:"Unmute","Enter picture in picture mode":"Enter picture in picture mode","Exit picture in picture mode":"Exit picture in picture mode",Play:"Play",Pause:"Pause","Playback rate":"Playback rate","Playback rate {playbackRate}":"Playback rate {playbackRate}",Quality:"Quality","Seek backward":"Seek backward","Seek forward":"Seek forward",Settings:"Settings",Auto:"Auto","audio player":"audio player","video player":"video player",volume:"volume",seek:"seek","closed captions":"closed captions","current playback rate":"current playback rate","playback time":"playback time","media loading":"media loading",settings:"settings","audio tracks":"audio tracks",quality:"quality",play:"play",pause:"pause",mute:"mute",unmute:"unmute","chapter: {chapterName}":"chapter: {chapterName}",live:"live",Off:"Off","start airplay":"start airplay","stop airplay":"stop airplay","start casting":"start casting","stop casting":"stop casting","enter fullscreen mode":"enter fullscreen mode","exit fullscreen mode":"exit fullscreen mode","enter picture in picture mode":"enter picture in picture mode","exit picture in picture mode":"exit picture in picture mode","seek to live":"seek to live","playing live":"playing live","seek back {seekOffset} seconds":"seek back {seekOffset} seconds","seek forward {seekOffset} seconds":"seek forward {seekOffset} seconds","Network Error":"Network Error","Decode Error":"Decode Error","Source Not Supported":"Source Not Supported","Encryption Error":"Encryption Error","A network error caused the media download to fail.":"A network error caused the media download to fail.","A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.":"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.","An unsupported error occurred. The server or network failed, or your browser does not support this format.":"An unsupported error occurred. The server or network failed, or your browser does not support this format.","The media is encrypted and there are no keys to decrypt it.":"The media is encrypted and there are no keys to decrypt it."};var iB;const WA={en:iRe};let cI=((iB=globalThis.navigator)==null?void 0:iB.language)||"en";const aRe=n=>{cI=n},oRe=n=>{var e,t,r;const[s]=cI.split("-");return((e=WA[cI])==null?void 0:e[n])||((t=WA[s])==null?void 0:t[n])||((r=WA.en)==null?void 0:r[n])||n},Rt=(n,e={})=>oRe(n).replace(/\{(\w+)\}/g,(t,r)=>r in e?String(e[r]):`{${r}}`);let $Y=class{addEventListener(){}removeEventListener(){}dispatchEvent(){return!0}},BY=class extends $Y{},aB=class extends BY{constructor(){super(...arguments),this.role=null}},lRe=class{observe(){}unobserve(){}disconnect(){}};const HY={createElement:function(){return new Tv.HTMLElement},createElementNS:function(){return new Tv.HTMLElement},addEventListener(){},removeEventListener(){},dispatchEvent(n){return!1}},Tv={ResizeObserver:lRe,document:HY,Node:BY,Element:aB,HTMLElement:class extends aB{constructor(){super(...arguments),this.innerHTML=""}get content(){return new Tv.DocumentFragment}},DocumentFragment:class extends $Y{},customElements:{get:function(){},define:function(){},whenDefined:function(){}},localStorage:{getItem(n){return null},setItem(n,e){},removeItem(n){}},CustomEvent:function(){},getComputedStyle:function(){},navigator:{languages:[],get userAgent(){return""}},matchMedia(n){return{matches:!1,media:n}},DOMParser:class{parseFromString(e,t){return{body:{textContent:e}}}}},VY=typeof window>"u"||typeof window.customElements>"u",zY=Object.keys(Tv).every(n=>n in globalThis),Ne=VY&&!zY?Tv:globalThis,gi=VY&&!zY?HY:globalThis.document,oB=new WeakMap,oP=n=>{let e=oB.get(n);return e||oB.set(n,e=new Set),e},GY=new Ne.ResizeObserver(n=>{for(const e of n)for(const t of oP(e.target))t(e)});function qY(n,e){oP(n).add(e),GY.observe(n)}function WY(n,e){const t=oP(n);t.delete(e),t.size||GY.unobserve(n)}function Ja(n){const e={};for(const t of n)e[t.name]=t.value;return e}function cRe(n){var e;return(e=uRe(n))!=null?e:p0(n,"media-controller")}function uRe(n){var e;const{MEDIA_CONTROLLER:t}=En,r=n.getAttribute(t);if(r)return(e=hRe(n))==null?void 0:e.getElementById(r)}const KY=(n,e,t=".value")=>{const r=n.querySelector(t);r&&(r.textContent=e)},dRe=(n,e)=>{const t=`slot[name="${e}"]`,r=n.shadowRoot.querySelector(t);return r?r.children:[]},YY=(n,e)=>dRe(n,e)[0],vm=(n,e)=>!n||!e?!1:n?.contains(e)?!0:vm(n,e.getRootNode().host),p0=(n,e)=>{if(!n)return null;const t=n.closest(e);return t||p0(n.getRootNode().host,e)};function XY(n=document){var e;const t=n?.activeElement;return t?(e=XY(t.shadowRoot))!=null?e:t:null}function hRe(n){var e;const t=(e=n?.getRootNode)==null?void 0:e.call(n);return t instanceof ShadowRoot||t instanceof Document?t:null}function QY(n,{depth:e=3,checkOpacity:t=!0,checkVisibilityCSS:r=!0}={}){if(n.checkVisibility)return n.checkVisibility({checkOpacity:t,checkVisibilityCSS:r});let s=n;for(;s&&e>0;){const i=getComputedStyle(s);if(t&&i.opacity==="0"||r&&i.visibility==="hidden"||i.display==="none")return!1;s=s.parentElement,e--}return!0}function fRe(n,e,t,r){const s=r.x-t.x,i=r.y-t.y,a=s*s+i*i;if(a===0)return 0;const o=((n-t.x)*s+(e-t.y)*i)/a;return Math.max(0,Math.min(1,o))}function Or(n,e){const t=mRe(n,r=>r===e);return t||pRe(n,e)}function mRe(n,e){var t,r;let s;for(s of(t=n.querySelectorAll("style:not([media])"))!=null?t:[]){let i;try{i=(r=s.sheet)==null?void 0:r.cssRules}catch{continue}for(const a of i??[])if(e(a.selectorText))return a}}function pRe(n,e){var t,r;const s=(t=n.querySelectorAll("style:not([media])"))!=null?t:[],i=s?.[s.length-1];return i?.sheet?(i?.sheet.insertRule(`${e}{}`,i.sheet.cssRules.length),(r=i.sheet.cssRules)==null?void 0:r[i.sheet.cssRules.length-1]):(console.warn("Media Chrome: No style sheet found on style tag of",n),{style:{setProperty:()=>{},removeProperty:()=>"",getPropertyValue:()=>""}})}function mr(n,e,t=Number.NaN){const r=n.getAttribute(e);return r!=null?+r:t}function as(n,e,t){const r=+t;if(t==null||Number.isNaN(r)){n.hasAttribute(e)&&n.removeAttribute(e);return}mr(n,e,void 0)!==r&&n.setAttribute(e,`${r}`)}function hn(n,e){return n.hasAttribute(e)}function fn(n,e,t){if(t==null){n.hasAttribute(e)&&n.removeAttribute(e);return}hn(n,e)!=t&&n.toggleAttribute(e,t)}function pr(n,e,t=null){var r;return(r=n.getAttribute(e))!=null?r:t}function gr(n,e,t){if(t==null){n.hasAttribute(e)&&n.removeAttribute(e);return}const r=`${t}`;pr(n,e,void 0)!==r&&n.setAttribute(e,r)}var ZY=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},wc=(n,e,t)=>(ZY(n,e,"read from private field"),t?t.call(n):e.get(n)),gRe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},pb=(n,e,t,r)=>(ZY(n,e,"write to private field"),e.set(n,t),t),ni;function vRe(n){return`
    <style>
      :host {
        display: var(--media-control-display, var(--media-gesture-receiver-display, inline-block));
        box-sizing: border-box;
      }
    </style>
  `}class HS extends Ne.HTMLElement{constructor(){if(super(),gRe(this,ni,void 0),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}}static get observedAttributes(){return[En.MEDIA_CONTROLLER,ue.MEDIA_PAUSED]}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===En.MEDIA_CONTROLLER&&(t&&((i=(s=wc(this,ni))==null?void 0:s.unassociateElement)==null||i.call(s,this),pb(this,ni,null)),r&&this.isConnected&&(pb(this,ni,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=wc(this,ni))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,r,s;this.tabIndex=-1,this.setAttribute("aria-hidden","true"),pb(this,ni,yRe(this)),this.getAttribute(En.MEDIA_CONTROLLER)&&((t=(e=wc(this,ni))==null?void 0:e.associateElement)==null||t.call(e,this)),(r=wc(this,ni))==null||r.addEventListener("pointerdown",this),(s=wc(this,ni))==null||s.addEventListener("click",this)}disconnectedCallback(){var e,t,r,s;this.getAttribute(En.MEDIA_CONTROLLER)&&((t=(e=wc(this,ni))==null?void 0:e.unassociateElement)==null||t.call(e,this)),(r=wc(this,ni))==null||r.removeEventListener("pointerdown",this),(s=wc(this,ni))==null||s.removeEventListener("click",this),pb(this,ni,null)}handleEvent(e){var t;const r=(t=e.composedPath())==null?void 0:t[0];if(["video","media-controller"].includes(r?.localName)){if(e.type==="pointerdown")this._pointerType=e.pointerType;else if(e.type==="click"){const{clientX:i,clientY:a}=e,{left:o,top:l,width:c,height:u}=this.getBoundingClientRect(),f=i-o,m=a-l;if(f<0||m<0||f>c||m>u||c===0&&u===0)return;const{pointerType:g=this._pointerType}=e;if(this._pointerType=void 0,g===rB.TOUCH){this.handleTap(e);return}else if(g===rB.MOUSE){this.handleMouseClick(e);return}}}}get mediaPaused(){return hn(this,ue.MEDIA_PAUSED)}set mediaPaused(e){fn(this,ue.MEDIA_PAUSED,e)}handleTap(e){}handleMouseClick(e){const t=this.mediaPaused?Et.MEDIA_PLAY_REQUEST:Et.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Ne.CustomEvent(t,{composed:!0,bubbles:!0}))}}ni=new WeakMap;HS.shadowRootOptions={mode:"open"};HS.getTemplateHTML=vRe;function yRe(n){var e;const t=n.getAttribute(En.MEDIA_CONTROLLER);return t?(e=n.getRootNode())==null?void 0:e.getElementById(t):p0(n,"media-controller")}Ne.customElements.get("media-gesture-receiver")||Ne.customElements.define("media-gesture-receiver",HS);var lB=HS,lP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},ki=(n,e,t)=>(lP(n,e,"read from private field"),t?t.call(n):e.get(n)),Ri=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Wu=(n,e,t,r)=>(lP(n,e,"write to private field"),e.set(n,t),t),da=(n,e,t)=>(lP(n,e,"access private method"),t),gE,qh,_v,vf,cx,uI,JY,Zp,ux,dI,eX,hI,tX,Av,VS,zS,cP,Qf,Rv;const kt={AUDIO:"audio",AUTOHIDE:"autohide",BREAKPOINTS:"breakpoints",GESTURES_DISABLED:"gesturesdisabled",KEYBOARD_CONTROL:"keyboardcontrol",NO_AUTOHIDE:"noautohide",USER_INACTIVE:"userinactive",AUTOHIDE_OVER_CONTROLS:"autohideovercontrols"};function bRe(n){return`
    <style>
      
      :host([${ue.MEDIA_IS_FULLSCREEN}]) ::slotted([slot=media]) {
        outline: none;
      }

      :host {
        box-sizing: border-box;
        position: relative;
        display: inline-block;
        line-height: 0;
        background-color: var(--media-background-color, #000);
      }

      :host(:not([${kt.AUDIO}])) [part~=layer]:not([part~=media-layer]) {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        display: flex;
        flex-flow: column nowrap;
        align-items: start;
        pointer-events: none;
        background: none;
      }

      slot[name=media] {
        display: var(--media-slot-display, contents);
      }

      
      :host([${kt.AUDIO}]) slot[name=media] {
        display: var(--media-slot-display, none);
      }

      
      :host([${kt.AUDIO}]) [part~=layer][part~=gesture-layer] {
        height: 0;
        display: block;
      }

      
      :host(:not([${kt.AUDIO}])[${kt.GESTURES_DISABLED}]) ::slotted([slot=gestures-chrome]),
          :host(:not([${kt.AUDIO}])[${kt.GESTURES_DISABLED}]) media-gesture-receiver[slot=gestures-chrome] {
        display: none;
      }

      
      ::slotted(:not([slot=media]):not([slot=poster]):not(media-loading-indicator):not([role=dialog]):not([hidden])) {
        pointer-events: auto;
      }

      :host(:not([${kt.AUDIO}])) *[part~=layer][part~=centered-layer] {
        align-items: center;
        justify-content: center;
      }

      :host(:not([${kt.AUDIO}])) ::slotted(media-gesture-receiver[slot=gestures-chrome]),
      :host(:not([${kt.AUDIO}])) media-gesture-receiver[slot=gestures-chrome] {
        align-self: stretch;
        flex-grow: 1;
      }

      slot[name=middle-chrome] {
        display: inline;
        flex-grow: 1;
        pointer-events: none;
        background: none;
      }

      
      ::slotted([slot=media]),
      ::slotted([slot=poster]) {
        width: 100%;
        height: 100%;
      }

      
      :host(:not([${kt.AUDIO}])) .spacer {
        flex-grow: 1;
      }

      
      :host(:-webkit-full-screen) {
        
        width: 100% !important;
        height: 100% !important;
      }

      
      ::slotted(:not([slot=media]):not([slot=poster]):not([${kt.NO_AUTOHIDE}]):not([hidden]):not([role=dialog])) {
        opacity: 1;
        transition: var(--media-control-transition-in, opacity 0.25s);
      }

      
      :host([${kt.USER_INACTIVE}]:not([${ue.MEDIA_PAUSED}]):not([${ue.MEDIA_IS_AIRPLAYING}]):not([${ue.MEDIA_IS_CASTING}]):not([${kt.AUDIO}])) ::slotted(:not([slot=media]):not([slot=poster]):not([${kt.NO_AUTOHIDE}]):not([role=dialog])) {
        opacity: 0;
        transition: var(--media-control-transition-out, opacity 1s);
      }

      :host([${kt.USER_INACTIVE}]:not([${kt.NO_AUTOHIDE}]):not([${ue.MEDIA_PAUSED}]):not([${ue.MEDIA_IS_CASTING}]):not([${kt.AUDIO}])) ::slotted([slot=media]) {
        cursor: none;
      }

      :host([${kt.USER_INACTIVE}][${kt.AUTOHIDE_OVER_CONTROLS}]:not([${kt.NO_AUTOHIDE}]):not([${ue.MEDIA_PAUSED}]):not([${ue.MEDIA_IS_CASTING}]):not([${kt.AUDIO}])) * {
        --media-cursor: none;
        cursor: none;
      }


      ::slotted(media-control-bar)  {
        align-self: stretch;
      }

      
      :host(:not([${kt.AUDIO}])[${ue.MEDIA_HAS_PLAYED}]) slot[name=poster] {
        display: none;
      }

      ::slotted([role=dialog]) {
        width: 100%;
        height: 100%;
        align-self: center;
      }

      ::slotted([role=menu]) {
        align-self: end;
      }
    </style>

    <slot name="media" part="layer media-layer"></slot>
    <slot name="poster" part="layer poster-layer"></slot>
    <slot name="gestures-chrome" part="layer gesture-layer">
      <media-gesture-receiver slot="gestures-chrome">
        <template shadowrootmode="${lB.shadowRootOptions.mode}">
          ${lB.getTemplateHTML({})}
        </template>
      </media-gesture-receiver>
    </slot>
    <span part="layer vertical-layer">
      <slot name="top-chrome" part="top chrome"></slot>
      <slot name="middle-chrome" part="middle chrome"></slot>
      <slot name="centered-chrome" part="layer centered-layer center centered chrome"></slot>
      
      <slot part="bottom chrome"></slot>
    </span>
    <slot name="dialog" part="layer dialog-layer"></slot>
  `}const xRe=Object.values(ue),wRe="sm:384 md:576 lg:768 xl:960";function ERe(n){nX(n.target,n.contentRect.width)}function nX(n,e){var t;if(!n.isConnected)return;const r=(t=n.getAttribute(kt.BREAKPOINTS))!=null?t:wRe,s=SRe(r),i=TRe(s,e);let a=!1;if(Object.keys(s).forEach(o=>{if(i.includes(o)){n.hasAttribute(`breakpoint${o}`)||(n.setAttribute(`breakpoint${o}`,""),a=!0);return}n.hasAttribute(`breakpoint${o}`)&&(n.removeAttribute(`breakpoint${o}`),a=!0)}),a){const o=new CustomEvent(Xf.BREAKPOINTS_CHANGE,{detail:i});n.dispatchEvent(o)}n.breakpointsComputed||(n.breakpointsComputed=!0,n.dispatchEvent(new CustomEvent(Xf.BREAKPOINTS_COMPUTED,{bubbles:!0,composed:!0})))}function SRe(n){const e=n.split(/\s+/);return Object.fromEntries(e.map(t=>t.split(":")))}function TRe(n,e){return Object.keys(n).filter(t=>e>=parseInt(n[t]))}class GS extends Ne.HTMLElement{constructor(){if(super(),Ri(this,uI),Ri(this,dI),Ri(this,hI),Ri(this,Av),Ri(this,zS),Ri(this,Qf),Ri(this,gE,0),Ri(this,qh,null),Ri(this,_v,null),Ri(this,vf,void 0),this.breakpointsComputed=!1,Ri(this,cx,new MutationObserver(da(this,uI,JY).bind(this))),Ri(this,Zp,!1),Ri(this,ux,t=>{ki(this,Zp)||(setTimeout(()=>{ERe(t),Wu(this,Zp,!1)},0),Wu(this,Zp,!0))}),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const t=Ja(this.attributes),r=this.constructor.getTemplateHTML(t);this.shadowRoot.setHTMLUnsafe?this.shadowRoot.setHTMLUnsafe(r):this.shadowRoot.innerHTML=r}const e=this.querySelector(":scope > slot[slot=media]");e&&e.addEventListener("slotchange",()=>{if(!e.assignedElements({flatten:!0}).length){ki(this,qh)&&this.mediaUnsetCallback(ki(this,qh));return}this.handleMediaUpdated(this.media)})}static get observedAttributes(){return[kt.AUTOHIDE,kt.GESTURES_DISABLED].concat(xRe).filter(e=>![ue.MEDIA_RENDITION_LIST,ue.MEDIA_AUDIO_TRACK_LIST,ue.MEDIA_CHAPTERS_CUES,ue.MEDIA_WIDTH,ue.MEDIA_HEIGHT,ue.MEDIA_ERROR,ue.MEDIA_ERROR_MESSAGE].includes(e))}attributeChangedCallback(e,t,r){e.toLowerCase()==kt.AUTOHIDE&&(this.autohide=r)}get media(){let e=this.querySelector(":scope > [slot=media]");return e?.nodeName=="SLOT"&&(e=e.assignedElements({flatten:!0})[0]),e}async handleMediaUpdated(e){e&&(Wu(this,qh,e),e.localName.includes("-")&&await Ne.customElements.whenDefined(e.localName),this.mediaSetCallback(e))}connectedCallback(){var e;ki(this,cx).observe(this,{childList:!0,subtree:!0}),qY(this,ki(this,ux));const t=this.getAttribute(kt.AUDIO)!=null,r=Rt(t?"audio player":"video player");this.setAttribute("role","region"),this.setAttribute("aria-label",r),this.handleMediaUpdated(this.media),this.setAttribute(kt.USER_INACTIVE,""),nX(this,this.getBoundingClientRect().width),this.addEventListener("pointerdown",this),this.addEventListener("pointermove",this),this.addEventListener("pointerup",this),this.addEventListener("mouseleave",this),this.addEventListener("keyup",this),(e=Ne.window)==null||e.addEventListener("mouseup",this)}disconnectedCallback(){var e;ki(this,cx).disconnect(),WY(this,ki(this,ux)),this.media&&this.mediaUnsetCallback(this.media),(e=Ne.window)==null||e.removeEventListener("mouseup",this)}mediaSetCallback(e){}mediaUnsetCallback(e){Wu(this,qh,null)}handleEvent(e){switch(e.type){case"pointerdown":Wu(this,gE,e.timeStamp);break;case"pointermove":da(this,dI,eX).call(this,e);break;case"pointerup":da(this,hI,tX).call(this,e);break;case"mouseleave":da(this,Av,VS).call(this);break;case"mouseup":this.removeAttribute(kt.KEYBOARD_CONTROL);break;case"keyup":da(this,Qf,Rv).call(this),this.setAttribute(kt.KEYBOARD_CONTROL,"");break}}set autohide(e){const t=Number(e);Wu(this,vf,isNaN(t)?0:t)}get autohide(){return(ki(this,vf)===void 0?2:ki(this,vf)).toString()}get breakpoints(){return pr(this,kt.BREAKPOINTS)}set breakpoints(e){gr(this,kt.BREAKPOINTS,e)}get audio(){return hn(this,kt.AUDIO)}set audio(e){fn(this,kt.AUDIO,e)}get gesturesDisabled(){return hn(this,kt.GESTURES_DISABLED)}set gesturesDisabled(e){fn(this,kt.GESTURES_DISABLED,e)}get keyboardControl(){return hn(this,kt.KEYBOARD_CONTROL)}set keyboardControl(e){fn(this,kt.KEYBOARD_CONTROL,e)}get noAutohide(){return hn(this,kt.NO_AUTOHIDE)}set noAutohide(e){fn(this,kt.NO_AUTOHIDE,e)}get autohideOverControls(){return hn(this,kt.AUTOHIDE_OVER_CONTROLS)}set autohideOverControls(e){fn(this,kt.AUTOHIDE_OVER_CONTROLS,e)}get userInteractive(){return hn(this,kt.USER_INACTIVE)}set userInteractive(e){fn(this,kt.USER_INACTIVE,e)}}gE=new WeakMap;qh=new WeakMap;_v=new WeakMap;vf=new WeakMap;cx=new WeakMap;uI=new WeakSet;JY=function(n){const e=this.media;for(const t of n){if(t.type!=="childList")continue;const r=t.removedNodes;for(const s of r){if(s.slot!="media"||t.target!=this)continue;let i=t.previousSibling&&t.previousSibling.previousElementSibling;if(!i||!e)this.mediaUnsetCallback(s);else{let a=i.slot!=="media";for(;(i=i.previousSibling)!==null;)i.slot=="media"&&(a=!1);a&&this.mediaUnsetCallback(s)}}if(e)for(const s of t.addedNodes)s===e&&this.handleMediaUpdated(e)}};Zp=new WeakMap;ux=new WeakMap;dI=new WeakSet;eX=function(n){if(n.pointerType!=="mouse"&&n.timeStamp-ki(this,gE)<250)return;da(this,zS,cP).call(this),clearTimeout(ki(this,_v));const e=this.hasAttribute(kt.AUTOHIDE_OVER_CONTROLS);([this,this.media].includes(n.target)||e)&&da(this,Qf,Rv).call(this)};hI=new WeakSet;tX=function(n){if(n.pointerType==="touch"){const e=!this.hasAttribute(kt.USER_INACTIVE);[this,this.media].includes(n.target)&&e?da(this,Av,VS).call(this):da(this,Qf,Rv).call(this)}else n.composedPath().some(e=>["media-play-button","media-fullscreen-button"].includes(e?.localName))&&da(this,Qf,Rv).call(this)};Av=new WeakSet;VS=function(){if(ki(this,vf)<0||this.hasAttribute(kt.USER_INACTIVE))return;this.setAttribute(kt.USER_INACTIVE,"");const n=new Ne.CustomEvent(Xf.USER_INACTIVE_CHANGE,{composed:!0,bubbles:!0,detail:!0});this.dispatchEvent(n)};zS=new WeakSet;cP=function(){if(!this.hasAttribute(kt.USER_INACTIVE))return;this.removeAttribute(kt.USER_INACTIVE);const n=new Ne.CustomEvent(Xf.USER_INACTIVE_CHANGE,{composed:!0,bubbles:!0,detail:!1});this.dispatchEvent(n)};Qf=new WeakSet;Rv=function(){da(this,zS,cP).call(this),clearTimeout(ki(this,_v));const n=parseInt(this.autohide);n<0||Wu(this,_v,setTimeout(()=>{da(this,Av,VS).call(this)},n*1e3))};GS.shadowRootOptions={mode:"open"};GS.getTemplateHTML=bRe;Ne.customElements.get("media-container")||Ne.customElements.define("media-container",GS);var rX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Zr=(n,e,t)=>(rX(n,e,"read from private field"),t?t.call(n):e.get(n)),Dp=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},gb=(n,e,t,r)=>(rX(n,e,"write to private field"),e.set(n,t),t),Wh,Kh,vE,ad,Tl,Lc;class sX{constructor(e,t,{defaultValue:r}={defaultValue:void 0}){Dp(this,Tl),Dp(this,Wh,void 0),Dp(this,Kh,void 0),Dp(this,vE,void 0),Dp(this,ad,new Set),gb(this,Wh,e),gb(this,Kh,t),gb(this,vE,new Set(r))}[Symbol.iterator](){return Zr(this,Tl,Lc).values()}get length(){return Zr(this,Tl,Lc).size}get value(){var e;return(e=[...Zr(this,Tl,Lc)].join(" "))!=null?e:""}set value(e){var t;e!==this.value&&(gb(this,ad,new Set),this.add(...(t=e?.split(" "))!=null?t:[]))}toString(){return this.value}item(e){return[...Zr(this,Tl,Lc)][e]}values(){return Zr(this,Tl,Lc).values()}forEach(e,t){Zr(this,Tl,Lc).forEach(e,t)}add(...e){var t,r;e.forEach(s=>Zr(this,ad).add(s)),!(this.value===""&&!((t=Zr(this,Wh))!=null&&t.hasAttribute(`${Zr(this,Kh)}`)))&&((r=Zr(this,Wh))==null||r.setAttribute(`${Zr(this,Kh)}`,`${this.value}`))}remove(...e){var t;e.forEach(r=>Zr(this,ad).delete(r)),(t=Zr(this,Wh))==null||t.setAttribute(`${Zr(this,Kh)}`,`${this.value}`)}contains(e){return Zr(this,Tl,Lc).has(e)}toggle(e,t){return typeof t<"u"?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}replace(e,t){return this.remove(e),this.add(t),e===t}}Wh=new WeakMap;Kh=new WeakMap;vE=new WeakMap;ad=new WeakMap;Tl=new WeakSet;Lc=function(){return Zr(this,ad).size?Zr(this,ad):Zr(this,vE)};const _Re=(n="")=>n.split(/\s+/),iX=(n="")=>{const[e,t,r]=n.split(":"),s=r?decodeURIComponent(r):void 0;return{kind:e==="cc"?Go.CAPTIONS:Go.SUBTITLES,language:t,label:s}},aX=(n="",e={})=>_Re(n).map(t=>{const r=iX(t);return{...e,...r}}),oX=n=>n?Array.isArray(n)?n.map(e=>typeof e=="string"?iX(e):e):typeof n=="string"?aX(n):[n]:[],ARe=({kind:n,label:e,language:t}={kind:"subtitles"})=>e?`${n==="captions"?"cc":"sb"}:${t}:${encodeURIComponent(e)}`:t,fI=(n=[])=>Array.prototype.map.call(n,ARe).join(" "),RRe=(n,e)=>t=>t[n]===e,lX=n=>{const e=Object.entries(n).map(([t,r])=>RRe(t,r));return t=>e.every(r=>r(t))},Mg=(n,e=[],t=[])=>{const r=oX(t).map(lX),s=i=>r.some(a=>a(i));Array.from(e).filter(s).forEach(i=>{i.mode=n})},qS=(n,e=()=>!0)=>{if(!n?.textTracks)return[];const t=typeof e=="function"?e:lX(e);return Array.from(n.textTracks).filter(t)},CRe=n=>{var e;return!!((e=n.mediaSubtitlesShowing)!=null&&e.length)||n.hasAttribute(ue.MEDIA_SUBTITLES_SHOWING)},kRe=n=>{var e;const{media:t,fullscreenElement:r}=n;try{const s=r&&"requestFullscreen"in r?"requestFullscreen":r&&"webkitRequestFullScreen"in r?"webkitRequestFullScreen":void 0;if(s){const i=(e=r[s])==null?void 0:e.call(r);if(i instanceof Promise)return i.catch(()=>{})}else t?.webkitEnterFullscreen?t.webkitEnterFullscreen():t?.requestFullscreen&&t.requestFullscreen()}catch(s){console.error(s)}},cB="exitFullscreen"in gi?"exitFullscreen":"webkitExitFullscreen"in gi?"webkitExitFullscreen":"webkitCancelFullScreen"in gi?"webkitCancelFullScreen":void 0,IRe=n=>{var e;const{documentElement:t}=n;if(cB){const r=(e=t?.[cB])==null?void 0:e.call(t);if(r instanceof Promise)return r.catch(()=>{})}},Jp="fullscreenElement"in gi?"fullscreenElement":"webkitFullscreenElement"in gi?"webkitFullscreenElement":void 0,LRe=n=>{const{documentElement:e,media:t}=n,r=e?.[Jp];return!r&&"webkitDisplayingFullscreen"in t&&"webkitPresentationMode"in t&&t.webkitDisplayingFullscreen&&t.webkitPresentationMode===JAe.FULLSCREEN?t:r},DRe=n=>{var e;const{media:t,documentElement:r,fullscreenElement:s=t}=n;if(!t||!r)return!1;const i=LRe(n);if(!i)return!1;if(i===s||i===t)return!0;if(i.localName.includes("-")){let a=i.shadowRoot;if(!(Jp in a))return vm(i,s);for(;a?.[Jp];){if(a[Jp]===s)return!0;a=(e=a[Jp])==null?void 0:e.shadowRoot}}return!1},PRe="fullscreenEnabled"in gi?"fullscreenEnabled":"webkitFullscreenEnabled"in gi?"webkitFullscreenEnabled":void 0,MRe=n=>{const{documentElement:e,media:t}=n;return!!e?.[PRe]||t&&"webkitSupportsFullscreen"in t};let vb;const uP=()=>{var n,e;return vb||(vb=(e=(n=gi)==null?void 0:n.createElement)==null?void 0:e.call(n,"video"),vb)},ORe=async(n=uP())=>{if(!n)return!1;const e=n.volume;n.volume=e/2+.1;const t=new AbortController,r=await Promise.race([NRe(n,t.signal),jRe(n,e)]);return t.abort(),r},NRe=(n,e)=>new Promise(t=>{n.addEventListener("volumechange",()=>t(!0),{signal:e})}),jRe=async(n,e)=>{for(let t=0;t<10;t++){if(n.volume===e)return!1;await UY(10)}return n.volume!==e},FRe=/.*Version\/.*Safari\/.*/.test(Ne.navigator.userAgent),cX=(n=uP())=>Ne.matchMedia("(display-mode: standalone)").matches&&FRe?!1:typeof n?.requestPictureInPicture=="function",uX=(n=uP())=>MRe({documentElement:gi,media:n}),URe=uX(),$Re=cX(),BRe=!!Ne.WebKitPlaybackTargetAvailabilityEvent,HRe=!!Ne.chrome,yE=n=>qS(n.media,e=>[Go.SUBTITLES,Go.CAPTIONS].includes(e.kind)).sort((e,t)=>e.kind>=t.kind?1:-1),dX=n=>qS(n.media,e=>e.mode===Lf.SHOWING&&[Go.SUBTITLES,Go.CAPTIONS].includes(e.kind)),hX=(n,e)=>{const t=yE(n),r=dX(n),s=!!r.length;if(t.length){if(e===!1||s&&e!==!0)Mg(Lf.DISABLED,t,r);else if(e===!0||!s&&e!==!1){let i=t[0];const{options:a}=n;if(!a?.noSubtitlesLangPref){const u=globalThis.localStorage.getItem("media-chrome-pref-subtitles-lang"),f=u?[u,...globalThis.navigator.languages]:globalThis.navigator.languages,m=t.filter(g=>f.some(y=>g.language.toLowerCase().startsWith(y.split("-")[0]))).sort((g,y)=>{const b=f.findIndex(S=>g.language.toLowerCase().startsWith(S.split("-")[0])),x=f.findIndex(S=>y.language.toLowerCase().startsWith(S.split("-")[0]));return b-x});m[0]&&(i=m[0])}const{language:o,label:l,kind:c}=i;Mg(Lf.DISABLED,t,r),Mg(Lf.SHOWING,t,[{language:o,label:l,kind:c}])}}},dP=(n,e)=>n===e?!0:n==null||e==null||typeof n!=typeof e?!1:typeof n=="number"&&Number.isNaN(n)&&Number.isNaN(e)?!0:typeof n!="object"?!1:Array.isArray(n)?VRe(n,e):Object.entries(n).every(([t,r])=>t in e&&dP(r,e[t])),VRe=(n,e)=>{const t=Array.isArray(n),r=Array.isArray(e);return t!==r?!1:t||r?n.length!==e.length?!1:n.every((s,i)=>dP(s,e[i])):!0},zRe=Object.values(kl);let bE;const GRe=ORe().then(n=>(bE=n,bE)),qRe=async(...n)=>{await Promise.all(n.filter(e=>e).map(async e=>{if(!("localName"in e&&e instanceof Ne.HTMLElement))return;const t=e.localName;if(!t.includes("-"))return;const r=Ne.customElements.get(t);r&&e instanceof r||(await Ne.customElements.whenDefined(t),Ne.customElements.upgrade(e))}))},WRe=new Ne.DOMParser,KRe=n=>n&&(WRe.parseFromString(n,"text/html").body.textContent||n),eg={mediaError:{get(n,e){const{media:t}=n;if(e?.type!=="playing")return t?.error},mediaEvents:["emptied","error","playing"]},mediaErrorCode:{get(n,e){var t;const{media:r}=n;if(e?.type!=="playing")return(t=r?.error)==null?void 0:t.code},mediaEvents:["emptied","error","playing"]},mediaErrorMessage:{get(n,e){var t,r;const{media:s}=n;if(e?.type!=="playing")return(r=(t=s?.error)==null?void 0:t.message)!=null?r:""},mediaEvents:["emptied","error","playing"]},mediaWidth:{get(n){var e;const{media:t}=n;return(e=t?.videoWidth)!=null?e:0},mediaEvents:["resize"]},mediaHeight:{get(n){var e;const{media:t}=n;return(e=t?.videoHeight)!=null?e:0},mediaEvents:["resize"]},mediaPaused:{get(n){var e;const{media:t}=n;return(e=t?.paused)!=null?e:!0},set(n,e){var t;const{media:r}=e;r&&(n?r.pause():(t=r.play())==null||t.catch(()=>{}))},mediaEvents:["play","playing","pause","emptied"]},mediaHasPlayed:{get(n,e){const{media:t}=n;return t?e?e.type==="playing":!t.paused:!1},mediaEvents:["playing","emptied"]},mediaEnded:{get(n){var e;const{media:t}=n;return(e=t?.ended)!=null?e:!1},mediaEvents:["seeked","ended","emptied"]},mediaPlaybackRate:{get(n){var e;const{media:t}=n;return(e=t?.playbackRate)!=null?e:1},set(n,e){const{media:t}=e;t&&Number.isFinite(+n)&&(t.playbackRate=+n)},mediaEvents:["ratechange","loadstart"]},mediaMuted:{get(n){var e;const{media:t}=n;return(e=t?.muted)!=null?e:!1},set(n,e){const{media:t}=e;if(t){try{Ne.localStorage.setItem("media-chrome-pref-muted",n?"true":"false")}catch(r){}t.muted=n}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[(n,e)=>{const{options:{noMutedPref:t}}=e,{media:r}=e;if(!(!r||r.muted||t))try{const s=Ne.localStorage.getItem("media-chrome-pref-muted")==="true";eg.mediaMuted.set(s,e),n(s)}catch(s){}}]},mediaVolume:{get(n){var e;const{media:t}=n;return(e=t?.volume)!=null?e:1},set(n,e){const{media:t}=e;if(t){try{n==null?Ne.localStorage.removeItem("media-chrome-pref-volume"):Ne.localStorage.setItem("media-chrome-pref-volume",n.toString())}catch(r){}Number.isFinite(+n)&&(t.volume=+n)}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[(n,e)=>{const{options:{noVolumePref:t}}=e;if(!t)try{const{media:r}=e;if(!r)return;const s=Ne.localStorage.getItem("media-chrome-pref-volume");if(s==null)return;eg.mediaVolume.set(+s,e),n(+s)}catch(r){}}]},mediaVolumeLevel:{get(n){const{media:e}=n;return typeof e?.volume>"u"?"high":e.muted||e.volume===0?"off":e.volume<.5?"low":e.volume<.75?"medium":"high"},mediaEvents:["volumechange"]},mediaCurrentTime:{get(n){var e;const{media:t}=n;return(e=t?.currentTime)!=null?e:0},set(n,e){const{media:t}=e;!t||!aP(n)||(t.currentTime=n)},mediaEvents:["timeupdate","loadedmetadata"]},mediaDuration:{get(n){const{media:e,options:{defaultDuration:t}={}}=n;return t&&(!e||!e.duration||Number.isNaN(e.duration)||!Number.isFinite(e.duration))?t:Number.isFinite(e?.duration)?e.duration:Number.NaN},mediaEvents:["durationchange","loadedmetadata","emptied"]},mediaLoading:{get(n){const{media:e}=n;return e?.readyState<3},mediaEvents:["waiting","playing","emptied"]},mediaSeekable:{get(n){var e;const{media:t}=n;if(!((e=t?.seekable)!=null&&e.length))return;const r=t.seekable.start(0),s=t.seekable.end(t.seekable.length-1);if(!(!r&&!s))return[Number(r.toFixed(3)),Number(s.toFixed(3))]},mediaEvents:["loadedmetadata","emptied","progress","seekablechange"]},mediaBuffered:{get(n){var e;const{media:t}=n,r=(e=t?.buffered)!=null?e:[];return Array.from(r).map((s,i)=>[Number(r.start(i).toFixed(3)),Number(r.end(i).toFixed(3))])},mediaEvents:["progress","emptied"]},mediaStreamType:{get(n){const{media:e,options:{defaultStreamType:t}={}}=n,r=[kl.LIVE,kl.ON_DEMAND].includes(t)?t:void 0;if(!e)return r;const{streamType:s}=e;if(zRe.includes(s))return s===kl.UNKNOWN?r:s;const i=e.duration;return i===1/0?kl.LIVE:Number.isFinite(i)?kl.ON_DEMAND:r},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange"]},mediaTargetLiveWindow:{get(n){const{media:e}=n;if(!e)return Number.NaN;const{targetLiveWindow:t}=e,r=eg.mediaStreamType.get(n);return(t==null||Number.isNaN(t))&&r===kl.LIVE?0:t},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange","targetlivewindowchange"]},mediaTimeIsLive:{get(n){const{media:e,options:{liveEdgeOffset:t=10}={}}=n;if(!e)return!1;if(typeof e.liveEdgeStart=="number")return Number.isNaN(e.liveEdgeStart)?!1:e.currentTime>=e.liveEdgeStart;if(!(eg.mediaStreamType.get(n)===kl.LIVE))return!1;const s=e.seekable;if(!s)return!0;if(!s.length)return!1;const i=s.end(s.length-1)-t;return e.currentTime>=i},mediaEvents:["playing","timeupdate","progress","waiting","emptied"]},mediaSubtitlesList:{get(n){return yE(n).map(({kind:e,label:t,language:r})=>({kind:e,label:t,language:r}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack"]},mediaSubtitlesShowing:{get(n){return dX(n).map(({kind:e,label:t,language:r})=>({kind:e,label:t,language:r}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[(n,e)=>{var t,r;const{media:s,options:i}=e;if(!s)return;const a=o=>{var l;!i.defaultSubtitles||o&&![Go.CAPTIONS,Go.SUBTITLES].includes((l=o?.track)==null?void 0:l.kind)||hX(e,!0)};return s.addEventListener("loadstart",a),(t=s.textTracks)==null||t.addEventListener("addtrack",a),(r=s.textTracks)==null||r.addEventListener("removetrack",a),()=>{var o,l;s.removeEventListener("loadstart",a),(o=s.textTracks)==null||o.removeEventListener("addtrack",a),(l=s.textTracks)==null||l.removeEventListener("removetrack",a)}}]},mediaChaptersCues:{get(n){var e;const{media:t}=n;if(!t)return[];const[r]=qS(t,{kind:Go.CHAPTERS});return Array.from((e=r?.cues)!=null?e:[]).map(({text:s,startTime:i,endTime:a})=>({text:KRe(s),startTime:i,endTime:a}))},mediaEvents:["loadstart","loadedmetadata"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[(n,e)=>{var t;const{media:r}=e;if(!r)return;const s=r.querySelector('track[kind="chapters"][default][src]'),i=(t=r.shadowRoot)==null?void 0:t.querySelector(':is(video,audio) > track[kind="chapters"][default][src]');return s?.addEventListener("load",n),i?.addEventListener("load",n),()=>{s?.removeEventListener("load",n),i?.removeEventListener("load",n)}}]},mediaIsPip:{get(n){var e,t;const{media:r,documentElement:s}=n;if(!r||!s||!s.pictureInPictureElement)return!1;if(s.pictureInPictureElement===r)return!0;if(s.pictureInPictureElement instanceof HTMLMediaElement)return(e=r.localName)!=null&&e.includes("-")?vm(r,s.pictureInPictureElement):!1;if(s.pictureInPictureElement.localName.includes("-")){let i=s.pictureInPictureElement.shadowRoot;for(;i?.pictureInPictureElement;){if(i.pictureInPictureElement===r)return!0;i=(t=i.pictureInPictureElement)==null?void 0:t.shadowRoot}}return!1},set(n,e){const{media:t}=e;if(t)if(n){if(!gi.pictureInPictureEnabled){console.warn("MediaChrome: Picture-in-picture is not enabled");return}if(!t.requestPictureInPicture){console.warn("MediaChrome: The current media does not support picture-in-picture");return}const r=()=>{console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a readyState > 0.")};t.requestPictureInPicture().catch(s=>{if(s.code===11){if(!t.src){console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a src set.");return}if(t.readyState===0&&t.preload==="none"){const i=()=>{t.removeEventListener("loadedmetadata",a),t.preload="none"},a=()=>{t.requestPictureInPicture().catch(r),i()};t.addEventListener("loadedmetadata",a),t.preload="metadata",setTimeout(()=>{t.readyState===0&&r(),i()},1e3)}else throw s}else throw s})}else gi.pictureInPictureElement&&gi.exitPictureInPicture()},mediaEvents:["enterpictureinpicture","leavepictureinpicture"]},mediaRenditionList:{get(n){var e;const{media:t}=n;return[...(e=t?.videoRenditions)!=null?e:[]].map(r=>({...r}))},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaRenditionSelected:{get(n){var e,t,r;const{media:s}=n;return(r=(t=s?.videoRenditions)==null?void 0:t[(e=s.videoRenditions)==null?void 0:e.selectedIndex])==null?void 0:r.id},set(n,e){const{media:t}=e;if(!t?.videoRenditions){console.warn("MediaController: Rendition selection not supported by this media.");return}const r=n,s=Array.prototype.findIndex.call(t.videoRenditions,i=>i.id==r);t.videoRenditions.selectedIndex!=s&&(t.videoRenditions.selectedIndex=s)},mediaEvents:["emptied"],videoRenditionsEvents:["addrendition","removerendition","change"]},mediaAudioTrackList:{get(n){var e;const{media:t}=n;return[...(e=t?.audioTracks)!=null?e:[]]},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},mediaAudioTrackEnabled:{get(n){var e,t;const{media:r}=n;return(t=[...(e=r?.audioTracks)!=null?e:[]].find(s=>s.enabled))==null?void 0:t.id},set(n,e){const{media:t}=e;if(!t?.audioTracks){console.warn("MediaChrome: Audio track selection not supported by this media.");return}const r=n;for(const s of t.audioTracks)s.enabled=r==s.id},mediaEvents:["emptied"],audioTracksEvents:["addtrack","removetrack","change"]},mediaIsFullscreen:{get(n){return DRe(n)},set(n,e){n?kRe(e):IRe(e)},rootEvents:["fullscreenchange","webkitfullscreenchange"],mediaEvents:["webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"]},mediaIsCasting:{get(n){var e;const{media:t}=n;return!t?.remote||((e=t.remote)==null?void 0:e.state)==="disconnected"?!1:!!t.remote.state},set(n,e){var t,r;const{media:s}=e;if(s&&!(n&&((t=s.remote)==null?void 0:t.state)!=="disconnected")&&!(!n&&((r=s.remote)==null?void 0:r.state)!=="connected")){if(typeof s.remote.prompt!="function"){console.warn("MediaChrome: Casting is not supported in this environment");return}s.remote.prompt().catch(()=>{})}},remoteEvents:["connect","connecting","disconnect"]},mediaIsAirplaying:{get(){return!1},set(n,e){const{media:t}=e;if(t){if(!(t.webkitShowPlaybackTargetPicker&&Ne.WebKitPlaybackTargetAvailabilityEvent)){console.error("MediaChrome: received a request to select AirPlay but AirPlay is not supported in this environment");return}t.webkitShowPlaybackTargetPicker()}},mediaEvents:["webkitcurrentplaybacktargetiswirelesschanged"]},mediaFullscreenUnavailable:{get(n){const{media:e}=n;if(!URe||!uX(e))return Zi.UNSUPPORTED}},mediaPipUnavailable:{get(n){const{media:e}=n;if(!$Re||!cX(e))return Zi.UNSUPPORTED}},mediaVolumeUnavailable:{get(n){const{media:e}=n;if(bE===!1||e?.volume==null)return Zi.UNSUPPORTED},stateOwnersUpdateHandlers:[n=>{bE==null&&GRe.then(e=>n(e?void 0:Zi.UNSUPPORTED))}]},mediaCastUnavailable:{get(n,{availability:e="not-available"}={}){var t;const{media:r}=n;if(!HRe||!((t=r?.remote)!=null&&t.state))return Zi.UNSUPPORTED;if(!(e==null||e==="available"))return Zi.UNAVAILABLE},stateOwnersUpdateHandlers:[(n,e)=>{var t;const{media:r}=e;return r?(r.disableRemotePlayback||r.hasAttribute("disableremoteplayback")||(t=r?.remote)==null||t.watchAvailability(i=>{n({availability:i?"available":"not-available"})}).catch(i=>{i.name==="NotSupportedError"?n({availability:null}):n({availability:"not-available"})}),()=>{var i;(i=r?.remote)==null||i.cancelWatchAvailability().catch(()=>{})}):void 0}]},mediaAirplayUnavailable:{get(n,e){if(!BRe)return Zi.UNSUPPORTED;if(e?.availability==="not-available")return Zi.UNAVAILABLE},mediaEvents:["webkitplaybacktargetavailabilitychanged"],stateOwnersUpdateHandlers:[(n,e)=>{var t;const{media:r}=e;return r?(r.disableRemotePlayback||r.hasAttribute("disableremoteplayback")||(t=r?.remote)==null||t.watchAvailability(i=>{n({availability:i?"available":"not-available"})}).catch(i=>{i.name==="NotSupportedError"?n({availability:null}):n({availability:"not-available"})}),()=>{var i;(i=r?.remote)==null||i.cancelWatchAvailability().catch(()=>{})}):void 0}]},mediaRenditionUnavailable:{get(n){var e;const{media:t}=n;if(!t?.videoRenditions)return Zi.UNSUPPORTED;if(!((e=t.videoRenditions)!=null&&e.length))return Zi.UNAVAILABLE},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaAudioTrackUnavailable:{get(n){var e,t;const{media:r}=n;if(!r?.audioTracks)return Zi.UNSUPPORTED;if(((t=(e=r.audioTracks)==null?void 0:e.length)!=null?t:0)<=1)return Zi.UNAVAILABLE},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},mediaLang:{get(n){const{options:{mediaLang:e}={}}=n;return e??"en"}}},YRe={[Et.MEDIA_PREVIEW_REQUEST](n,e,{detail:t}){var r,s,i;const{media:a}=e,o=t??void 0;let l,c;if(a&&o!=null){const[g]=qS(a,{kind:Go.METADATA,label:"thumbnails"}),y=Array.prototype.find.call((r=g?.cues)!=null?r:[],(b,x,S)=>x===0?b.endTime>o:x===S.length-1?b.startTime<=o:b.startTime<=o&&b.endTime>o);if(y){const b=/'^(?:[a-z]+:)?\/\//i.test(y.text)||(s=a?.querySelector('track[label="thumbnails"]'))==null?void 0:s.src,x=new URL(y.text,b);c=new URLSearchParams(x.hash).get("#xywh").split(",").map(T=>+T),l=x.href}}const u=n.mediaDuration.get(e);let m=(i=n.mediaChaptersCues.get(e).find((g,y,b)=>y===b.length-1&&u===g.endTime?g.startTime<=o&&g.endTime>=o:g.startTime<=o&&g.endTime>o))==null?void 0:i.text;return t!=null&&m==null&&(m=""),{mediaPreviewTime:o,mediaPreviewImage:l,mediaPreviewCoords:c,mediaPreviewChapter:m}},[Et.MEDIA_PAUSE_REQUEST](n,e){n["mediaPaused"].set(!0,e)},[Et.MEDIA_PLAY_REQUEST](n,e){var t,r,s,i;const a="mediaPaused",l=n.mediaStreamType.get(e)===kl.LIVE,c=!((t=e.options)!=null&&t.noAutoSeekToLive),u=n.mediaTargetLiveWindow.get(e)>0;if(l&&c&&!u){const f=(r=n.mediaSeekable.get(e))==null?void 0:r[1];if(f){const m=(i=(s=e.options)==null?void 0:s.seekToLiveOffset)!=null?i:0,g=f-m;n.mediaCurrentTime.set(g,e)}}n[a].set(!1,e)},[Et.MEDIA_PLAYBACK_RATE_REQUEST](n,e,{detail:t}){const r="mediaPlaybackRate",s=t;n[r].set(s,e)},[Et.MEDIA_MUTE_REQUEST](n,e){n["mediaMuted"].set(!0,e)},[Et.MEDIA_UNMUTE_REQUEST](n,e){const t="mediaMuted";n.mediaVolume.get(e)||n.mediaVolume.set(.25,e),n[t].set(!1,e)},[Et.MEDIA_VOLUME_REQUEST](n,e,{detail:t}){const r="mediaVolume",s=t;s&&n.mediaMuted.get(e)&&n.mediaMuted.set(!1,e),n[r].set(s,e)},[Et.MEDIA_SEEK_REQUEST](n,e,{detail:t}){const r="mediaCurrentTime",s=t;n[r].set(s,e)},[Et.MEDIA_SEEK_TO_LIVE_REQUEST](n,e){var t,r,s;const i="mediaCurrentTime",a=(t=n.mediaSeekable.get(e))==null?void 0:t[1];if(Number.isNaN(Number(a)))return;const o=(s=(r=e.options)==null?void 0:r.seekToLiveOffset)!=null?s:0,l=a-o;n[i].set(l,e)},[Et.MEDIA_SHOW_SUBTITLES_REQUEST](n,e,{detail:t}){var r;const{options:s}=e,i=yE(e),a=oX(t),o=(r=a[0])==null?void 0:r.language;o&&!s.noSubtitlesLangPref&&Ne.localStorage.setItem("media-chrome-pref-subtitles-lang",o),Mg(Lf.SHOWING,i,a)},[Et.MEDIA_DISABLE_SUBTITLES_REQUEST](n,e,{detail:t}){const r=yE(e),s=t??[];Mg(Lf.DISABLED,r,s)},[Et.MEDIA_TOGGLE_SUBTITLES_REQUEST](n,e,{detail:t}){hX(e,t)},[Et.MEDIA_RENDITION_REQUEST](n,e,{detail:t}){const r="mediaRenditionSelected",s=t;n[r].set(s,e)},[Et.MEDIA_AUDIO_TRACK_REQUEST](n,e,{detail:t}){const r="mediaAudioTrackEnabled",s=t;n[r].set(s,e)},[Et.MEDIA_ENTER_PIP_REQUEST](n,e){const t="mediaIsPip";n.mediaIsFullscreen.get(e)&&n.mediaIsFullscreen.set(!1,e),n[t].set(!0,e)},[Et.MEDIA_EXIT_PIP_REQUEST](n,e){n["mediaIsPip"].set(!1,e)},[Et.MEDIA_ENTER_FULLSCREEN_REQUEST](n,e){const t="mediaIsFullscreen";n.mediaIsPip.get(e)&&n.mediaIsPip.set(!1,e),n[t].set(!0,e)},[Et.MEDIA_EXIT_FULLSCREEN_REQUEST](n,e){n["mediaIsFullscreen"].set(!1,e)},[Et.MEDIA_ENTER_CAST_REQUEST](n,e){const t="mediaIsCasting";n.mediaIsFullscreen.get(e)&&n.mediaIsFullscreen.set(!1,e),n[t].set(!0,e)},[Et.MEDIA_EXIT_CAST_REQUEST](n,e){n["mediaIsCasting"].set(!1,e)},[Et.MEDIA_AIRPLAY_REQUEST](n,e){n["mediaIsAirplaying"].set(!0,e)}},XRe=({media:n,fullscreenElement:e,documentElement:t,stateMediator:r=eg,requestMap:s=YRe,options:i={},monitorStateOwnersOnlyWithSubscriptions:a=!0})=>{const o=[],l={options:{...i}};let c=Object.freeze({mediaPreviewTime:void 0,mediaPreviewImage:void 0,mediaPreviewCoords:void 0,mediaPreviewChapter:void 0});const u=b=>{b!=null&&(dP(b,c)||(c=Object.freeze({...c,...b}),o.forEach(x=>x(c))))},f=()=>{const b=Object.entries(r).reduce((x,[S,{get:T}])=>(x[S]=T(l),x),{});u(b)},m={};let g;const y=async(b,x)=>{var S,T,_,R,I,C,L,k,M,D,U,$,V,B,W,F;const j=!!g;if(g={...l,...g??{},...b},j)return;await qRe(...Object.values(b));const q=o.length>0&&x===0&&a,H=l.media!==g.media,N=((S=l.media)==null?void 0:S.textTracks)!==((T=g.media)==null?void 0:T.textTracks),O=((_=l.media)==null?void 0:_.videoRenditions)!==((R=g.media)==null?void 0:R.videoRenditions),z=((I=l.media)==null?void 0:I.audioTracks)!==((C=g.media)==null?void 0:C.audioTracks),G=((L=l.media)==null?void 0:L.remote)!==((k=g.media)==null?void 0:k.remote),Y=l.documentElement!==g.documentElement,Q=!!l.media&&(H||q),J=!!((M=l.media)!=null&&M.textTracks)&&(N||q),ee=!!((D=l.media)!=null&&D.videoRenditions)&&(O||q),oe=!!((U=l.media)!=null&&U.audioTracks)&&(z||q),te=!!(($=l.media)!=null&&$.remote)&&(G||q),se=!!l.documentElement&&(Y||q),he=Q||J||ee||oe||te||se,Z=o.length===0&&x===1&&a,pe=!!g.media&&(H||Z),ye=!!((V=g.media)!=null&&V.textTracks)&&(N||Z),ae=!!((B=g.media)!=null&&B.videoRenditions)&&(O||Z),le=!!((W=g.media)!=null&&W.audioTracks)&&(z||Z),ie=!!((F=g.media)!=null&&F.remote)&&(G||Z),fe=!!g.documentElement&&(Y||Z),Ie=pe||ye||ae||le||ie||fe;if(!(he||Ie)){Object.entries(g).forEach(([ce,Ce])=>{l[ce]=Ce}),f(),g=void 0;return}Object.entries(r).forEach(([ce,{get:Ce,mediaEvents:Oe=[],textTracksEvents:ze=[],videoRenditionsEvents:We=[],audioTracksEvents:tt=[],remoteEvents:lt=[],rootEvents:Ee=[],stateOwnersUpdateHandlers:be=[]}])=>{m[ce]||(m[ce]={});const Ae=Ge=>{const Ke=Ce(l,Ge);u({[ce]:Ke})};let Me;Me=m[ce].mediaEvents,Oe.forEach(Ge=>{Me&&Q&&(l.media.removeEventListener(Ge,Me),m[ce].mediaEvents=void 0),pe&&(g.media.addEventListener(Ge,Ae),m[ce].mediaEvents=Ae)}),Me=m[ce].textTracksEvents,ze.forEach(Ge=>{var Ke,Qe;Me&&J&&((Ke=l.media.textTracks)==null||Ke.removeEventListener(Ge,Me),m[ce].textTracksEvents=void 0),ye&&((Qe=g.media.textTracks)==null||Qe.addEventListener(Ge,Ae),m[ce].textTracksEvents=Ae)}),Me=m[ce].videoRenditionsEvents,We.forEach(Ge=>{var Ke,Qe;Me&&ee&&((Ke=l.media.videoRenditions)==null||Ke.removeEventListener(Ge,Me),m[ce].videoRenditionsEvents=void 0),ae&&((Qe=g.media.videoRenditions)==null||Qe.addEventListener(Ge,Ae),m[ce].videoRenditionsEvents=Ae)}),Me=m[ce].audioTracksEvents,tt.forEach(Ge=>{var Ke,Qe;Me&&oe&&((Ke=l.media.audioTracks)==null||Ke.removeEventListener(Ge,Me),m[ce].audioTracksEvents=void 0),le&&((Qe=g.media.audioTracks)==null||Qe.addEventListener(Ge,Ae),m[ce].audioTracksEvents=Ae)}),Me=m[ce].remoteEvents,lt.forEach(Ge=>{var Ke,Qe;Me&&te&&((Ke=l.media.remote)==null||Ke.removeEventListener(Ge,Me),m[ce].remoteEvents=void 0),ie&&((Qe=g.media.remote)==null||Qe.addEventListener(Ge,Ae),m[ce].remoteEvents=Ae)}),Me=m[ce].rootEvents,Ee.forEach(Ge=>{Me&&se&&(l.documentElement.removeEventListener(Ge,Me),m[ce].rootEvents=void 0),fe&&(g.documentElement.addEventListener(Ge,Ae),m[ce].rootEvents=Ae)});const Ue=m[ce].stateOwnersUpdateHandlers;be.forEach(Ge=>{Ue&&he&&Ue(),Ie&&(m[ce].stateOwnersUpdateHandlers=Ge(Ae,g))})}),Object.entries(g).forEach(([ce,Ce])=>{l[ce]=Ce}),f(),g=void 0};return y({media:n,fullscreenElement:e,documentElement:t,options:i}),{dispatch(b){const{type:x,detail:S}=b;if(s[x]&&c.mediaErrorCode==null){u(s[x](r,l,b));return}x==="mediaelementchangerequest"?y({media:S}):x==="fullscreenelementchangerequest"?y({fullscreenElement:S}):x==="documentelementchangerequest"?y({documentElement:S}):x==="optionschangerequest"&&(Object.entries(S??{}).forEach(([T,_])=>{l.options[T]=_}),f())},getState(){return c},subscribe(b){return y({},o.length+1),o.push(b),b(c),()=>{const x=o.indexOf(b);x>=0&&(y({},o.length-1),o.splice(x,1))}}}};var hP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Jt=(n,e,t)=>(hP(n,e,"read from private field"),t?t.call(n):e.get(n)),yl=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Ec=(n,e,t,r)=>(hP(n,e,"write to private field"),e.set(n,t),t),Hc=(n,e,t)=>(hP(n,e,"access private method"),t),od,tg,In,ng,fo,dx,hx,mI,Zf,Cv,fx,pI;const fX=["ArrowLeft","ArrowRight","Enter"," ","f","m","k","c"],uB=10,ct={DEFAULT_SUBTITLES:"defaultsubtitles",DEFAULT_STREAM_TYPE:"defaultstreamtype",DEFAULT_DURATION:"defaultduration",FULLSCREEN_ELEMENT:"fullscreenelement",HOTKEYS:"hotkeys",KEYS_USED:"keysused",LIVE_EDGE_OFFSET:"liveedgeoffset",SEEK_TO_LIVE_OFFSET:"seektoliveoffset",NO_AUTO_SEEK_TO_LIVE:"noautoseektolive",NO_HOTKEYS:"nohotkeys",NO_VOLUME_PREF:"novolumepref",NO_SUBTITLES_LANG_PREF:"nosubtitleslangpref",NO_DEFAULT_STORE:"nodefaultstore",KEYBOARD_FORWARD_SEEK_OFFSET:"keyboardforwardseekoffset",KEYBOARD_BACKWARD_SEEK_OFFSET:"keyboardbackwardseekoffset",LANG:"lang"};class QRe extends GS{constructor(){super(),yl(this,hx),yl(this,Zf),yl(this,fx),this.mediaStateReceivers=[],this.associatedElementSubscriptions=new Map,yl(this,od,new sX(this,ct.HOTKEYS)),yl(this,tg,void 0),yl(this,In,void 0),yl(this,ng,void 0),yl(this,fo,void 0),yl(this,dx,t=>{var r;(r=Jt(this,In))==null||r.dispatch(t)}),this.associateElement(this);let e={};Ec(this,ng,t=>{Object.entries(t).forEach(([r,s])=>{if(r in e&&e[r]===s)return;this.propagateMediaState(r,s);const i=r.toLowerCase(),a=new Ne.CustomEvent(ZAe[i],{composed:!0,detail:s});this.dispatchEvent(a)}),e=t}),this.enableHotkeys()}static get observedAttributes(){return super.observedAttributes.concat(ct.NO_HOTKEYS,ct.HOTKEYS,ct.DEFAULT_STREAM_TYPE,ct.DEFAULT_SUBTITLES,ct.DEFAULT_DURATION,ct.LANG)}get mediaStore(){return Jt(this,In)}set mediaStore(e){var t,r;if(Jt(this,In)&&((t=Jt(this,fo))==null||t.call(this),Ec(this,fo,void 0)),Ec(this,In,e),!Jt(this,In)&&!this.hasAttribute(ct.NO_DEFAULT_STORE)){Hc(this,hx,mI).call(this);return}Ec(this,fo,(r=Jt(this,In))==null?void 0:r.subscribe(Jt(this,ng)))}get fullscreenElement(){var e;return(e=Jt(this,tg))!=null?e:this}set fullscreenElement(e){var t;this.hasAttribute(ct.FULLSCREEN_ELEMENT)&&this.removeAttribute(ct.FULLSCREEN_ELEMENT),Ec(this,tg,e),(t=Jt(this,In))==null||t.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}get defaultSubtitles(){return hn(this,ct.DEFAULT_SUBTITLES)}set defaultSubtitles(e){fn(this,ct.DEFAULT_SUBTITLES,e)}get defaultStreamType(){return pr(this,ct.DEFAULT_STREAM_TYPE)}set defaultStreamType(e){gr(this,ct.DEFAULT_STREAM_TYPE,e)}get defaultDuration(){return mr(this,ct.DEFAULT_DURATION)}set defaultDuration(e){as(this,ct.DEFAULT_DURATION,e)}get noHotkeys(){return hn(this,ct.NO_HOTKEYS)}set noHotkeys(e){fn(this,ct.NO_HOTKEYS,e)}get keysUsed(){return pr(this,ct.KEYS_USED)}set keysUsed(e){gr(this,ct.KEYS_USED,e)}get liveEdgeOffset(){return mr(this,ct.LIVE_EDGE_OFFSET)}set liveEdgeOffset(e){as(this,ct.LIVE_EDGE_OFFSET,e)}get noAutoSeekToLive(){return hn(this,ct.NO_AUTO_SEEK_TO_LIVE)}set noAutoSeekToLive(e){fn(this,ct.NO_AUTO_SEEK_TO_LIVE,e)}get noVolumePref(){return hn(this,ct.NO_VOLUME_PREF)}set noVolumePref(e){fn(this,ct.NO_VOLUME_PREF,e)}get noSubtitlesLangPref(){return hn(this,ct.NO_SUBTITLES_LANG_PREF)}set noSubtitlesLangPref(e){fn(this,ct.NO_SUBTITLES_LANG_PREF,e)}get noDefaultStore(){return hn(this,ct.NO_DEFAULT_STORE)}set noDefaultStore(e){fn(this,ct.NO_DEFAULT_STORE,e)}attributeChangedCallback(e,t,r){var s,i,a,o,l,c,u,f,m;if(super.attributeChangedCallback(e,t,r),e===ct.NO_HOTKEYS)r!==t&&r===""?(this.hasAttribute(ct.HOTKEYS)&&console.warn("Media Chrome: Both `hotkeys` and `nohotkeys` have been set. All hotkeys will be disabled."),this.disableHotkeys()):r!==t&&r===null&&this.enableHotkeys();else if(e===ct.HOTKEYS)Jt(this,od).value=r;else if(e===ct.DEFAULT_SUBTITLES&&r!==t)(s=Jt(this,In))==null||s.dispatch({type:"optionschangerequest",detail:{defaultSubtitles:this.hasAttribute(ct.DEFAULT_SUBTITLES)}});else if(e===ct.DEFAULT_STREAM_TYPE)(a=Jt(this,In))==null||a.dispatch({type:"optionschangerequest",detail:{defaultStreamType:(i=this.getAttribute(ct.DEFAULT_STREAM_TYPE))!=null?i:void 0}});else if(e===ct.LIVE_EDGE_OFFSET)(o=Jt(this,In))==null||o.dispatch({type:"optionschangerequest",detail:{liveEdgeOffset:this.hasAttribute(ct.LIVE_EDGE_OFFSET)?+this.getAttribute(ct.LIVE_EDGE_OFFSET):void 0,seekToLiveOffset:this.hasAttribute(ct.SEEK_TO_LIVE_OFFSET)?void 0:+this.getAttribute(ct.LIVE_EDGE_OFFSET)}});else if(e===ct.SEEK_TO_LIVE_OFFSET)(l=Jt(this,In))==null||l.dispatch({type:"optionschangerequest",detail:{seekToLiveOffset:this.hasAttribute(ct.SEEK_TO_LIVE_OFFSET)?+this.getAttribute(ct.SEEK_TO_LIVE_OFFSET):void 0}});else if(e===ct.NO_AUTO_SEEK_TO_LIVE)(c=Jt(this,In))==null||c.dispatch({type:"optionschangerequest",detail:{noAutoSeekToLive:this.hasAttribute(ct.NO_AUTO_SEEK_TO_LIVE)}});else if(e===ct.FULLSCREEN_ELEMENT){const g=r?(u=this.getRootNode())==null?void 0:u.getElementById(r):void 0;Ec(this,tg,g),(f=Jt(this,In))==null||f.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}else e===ct.LANG&&r!==t&&(aRe(r),(m=Jt(this,In))==null||m.dispatch({type:"optionschangerequest",detail:{mediaLang:r}}))}connectedCallback(){var e,t;!Jt(this,In)&&!this.hasAttribute(ct.NO_DEFAULT_STORE)&&Hc(this,hx,mI).call(this),(e=Jt(this,In))==null||e.dispatch({type:"documentelementchangerequest",detail:gi}),super.connectedCallback(),Jt(this,In)&&!Jt(this,fo)&&Ec(this,fo,(t=Jt(this,In))==null?void 0:t.subscribe(Jt(this,ng))),this.enableHotkeys()}disconnectedCallback(){var e,t,r,s;(e=super.disconnectedCallback)==null||e.call(this),Jt(this,In)&&((t=Jt(this,In))==null||t.dispatch({type:"documentelementchangerequest",detail:void 0}),(r=Jt(this,In))==null||r.dispatch({type:Et.MEDIA_TOGGLE_SUBTITLES_REQUEST,detail:!1})),Jt(this,fo)&&((s=Jt(this,fo))==null||s.call(this),Ec(this,fo,void 0))}mediaSetCallback(e){var t;super.mediaSetCallback(e),(t=Jt(this,In))==null||t.dispatch({type:"mediaelementchangerequest",detail:e}),e.hasAttribute("tabindex")||(e.tabIndex=-1)}mediaUnsetCallback(e){var t;super.mediaUnsetCallback(e),(t=Jt(this,In))==null||t.dispatch({type:"mediaelementchangerequest",detail:void 0})}propagateMediaState(e,t){fB(this.mediaStateReceivers,e,t)}associateElement(e){if(!e)return;const{associatedElementSubscriptions:t}=this;if(t.has(e))return;const r=this.registerMediaStateReceiver.bind(this),s=this.unregisterMediaStateReceiver.bind(this),i=rCe(e,r,s);Object.values(Et).forEach(a=>{e.addEventListener(a,Jt(this,dx))}),t.set(e,i)}unassociateElement(e){if(!e)return;const{associatedElementSubscriptions:t}=this;if(!t.has(e))return;t.get(e)(),t.delete(e),Object.values(Et).forEach(s=>{e.removeEventListener(s,Jt(this,dx))})}registerMediaStateReceiver(e){if(!e)return;const t=this.mediaStateReceivers;t.indexOf(e)>-1||(t.push(e),Jt(this,In)&&Object.entries(Jt(this,In).getState()).forEach(([s,i])=>{fB([e],s,i)}))}unregisterMediaStateReceiver(e){const t=this.mediaStateReceivers,r=t.indexOf(e);r<0||t.splice(r,1)}enableHotkeys(){this.addEventListener("keydown",Hc(this,fx,pI))}disableHotkeys(){this.removeEventListener("keydown",Hc(this,fx,pI)),this.removeEventListener("keyup",Hc(this,Zf,Cv))}get hotkeys(){return pr(this,ct.HOTKEYS)}set hotkeys(e){gr(this,ct.HOTKEYS,e)}keyboardShortcutHandler(e){var t,r,s,i,a;const o=e.target;if(((s=(r=(t=o.getAttribute(ct.KEYS_USED))==null?void 0:t.split(" "))!=null?r:o?.keysUsed)!=null?s:[]).map(m=>m==="Space"?" ":m).filter(Boolean).includes(e.key))return;let c,u,f;if(!Jt(this,od).contains(`no${e.key.toLowerCase()}`)&&!(e.key===" "&&Jt(this,od).contains("nospace")))switch(e.key){case" ":case"k":c=Jt(this,In).getState().mediaPaused?Et.MEDIA_PLAY_REQUEST:Et.MEDIA_PAUSE_REQUEST,this.dispatchEvent(new Ne.CustomEvent(c,{composed:!0,bubbles:!0}));break;case"m":c=this.mediaStore.getState().mediaVolumeLevel==="off"?Et.MEDIA_UNMUTE_REQUEST:Et.MEDIA_MUTE_REQUEST,this.dispatchEvent(new Ne.CustomEvent(c,{composed:!0,bubbles:!0}));break;case"f":c=this.mediaStore.getState().mediaIsFullscreen?Et.MEDIA_EXIT_FULLSCREEN_REQUEST:Et.MEDIA_ENTER_FULLSCREEN_REQUEST,this.dispatchEvent(new Ne.CustomEvent(c,{composed:!0,bubbles:!0}));break;case"c":this.dispatchEvent(new Ne.CustomEvent(Et.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}));break;case"ArrowLeft":{const m=this.hasAttribute(ct.KEYBOARD_BACKWARD_SEEK_OFFSET)?+this.getAttribute(ct.KEYBOARD_BACKWARD_SEEK_OFFSET):uB;u=Math.max(((i=this.mediaStore.getState().mediaCurrentTime)!=null?i:0)-m,0),f=new Ne.CustomEvent(Et.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:u}),this.dispatchEvent(f);break}case"ArrowRight":{const m=this.hasAttribute(ct.KEYBOARD_FORWARD_SEEK_OFFSET)?+this.getAttribute(ct.KEYBOARD_FORWARD_SEEK_OFFSET):uB;u=Math.max(((a=this.mediaStore.getState().mediaCurrentTime)!=null?a:0)+m,0),f=new Ne.CustomEvent(Et.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:u}),this.dispatchEvent(f);break}}}}od=new WeakMap;tg=new WeakMap;In=new WeakMap;ng=new WeakMap;fo=new WeakMap;dx=new WeakMap;hx=new WeakSet;mI=function(){var n;this.mediaStore=XRe({media:this.media,fullscreenElement:this.fullscreenElement,options:{defaultSubtitles:this.hasAttribute(ct.DEFAULT_SUBTITLES),defaultDuration:this.hasAttribute(ct.DEFAULT_DURATION)?+this.getAttribute(ct.DEFAULT_DURATION):void 0,defaultStreamType:(n=this.getAttribute(ct.DEFAULT_STREAM_TYPE))!=null?n:void 0,liveEdgeOffset:this.hasAttribute(ct.LIVE_EDGE_OFFSET)?+this.getAttribute(ct.LIVE_EDGE_OFFSET):void 0,seekToLiveOffset:this.hasAttribute(ct.SEEK_TO_LIVE_OFFSET)?+this.getAttribute(ct.SEEK_TO_LIVE_OFFSET):this.hasAttribute(ct.LIVE_EDGE_OFFSET)?+this.getAttribute(ct.LIVE_EDGE_OFFSET):void 0,noAutoSeekToLive:this.hasAttribute(ct.NO_AUTO_SEEK_TO_LIVE),noVolumePref:this.hasAttribute(ct.NO_VOLUME_PREF),noSubtitlesLangPref:this.hasAttribute(ct.NO_SUBTITLES_LANG_PREF)}})};Zf=new WeakSet;Cv=function(n){const{key:e}=n;if(!fX.includes(e)){this.removeEventListener("keyup",Hc(this,Zf,Cv));return}this.keyboardShortcutHandler(n)};fx=new WeakSet;pI=function(n){const{metaKey:e,altKey:t,key:r}=n;if(e||t||!fX.includes(r)){this.removeEventListener("keyup",Hc(this,Zf,Cv));return}[" ","ArrowLeft","ArrowRight"].includes(r)&&!(Jt(this,od).contains(`no${r.toLowerCase()}`)||r===" "&&Jt(this,od).contains("nospace"))&&n.preventDefault(),this.addEventListener("keyup",Hc(this,Zf,Cv),{once:!0})};const ZRe=Object.values(ue),JRe=Object.values(jY),mX=n=>{var e,t,r,s;let{observedAttributes:i}=n.constructor;!i&&((e=n.nodeName)!=null&&e.includes("-"))&&(Ne.customElements.upgrade(n),{observedAttributes:i}=n.constructor);const a=(s=(r=(t=n?.getAttribute)==null?void 0:t.call(n,En.MEDIA_CHROME_ATTRIBUTES))==null?void 0:r.split)==null?void 0:s.call(r,/\s+/);return Array.isArray(i||a)?(i||a).filter(o=>ZRe.includes(o)):[]},eCe=n=>{var e,t;return(e=n.nodeName)!=null&&e.includes("-")&&Ne.customElements.get((t=n.nodeName)==null?void 0:t.toLowerCase())&&!(n instanceof Ne.customElements.get(n.nodeName.toLowerCase()))&&Ne.customElements.upgrade(n),JRe.some(r=>r in n)},gI=n=>eCe(n)||!!mX(n).length,dB=n=>{var e;return(e=n?.join)==null?void 0:e.call(n,":")},hB={[ue.MEDIA_SUBTITLES_LIST]:fI,[ue.MEDIA_SUBTITLES_SHOWING]:fI,[ue.MEDIA_SEEKABLE]:dB,[ue.MEDIA_BUFFERED]:n=>n?.map(dB).join(" "),[ue.MEDIA_PREVIEW_COORDS]:n=>n?.join(" "),[ue.MEDIA_RENDITION_LIST]:eRe,[ue.MEDIA_AUDIO_TRACK_LIST]:nRe},tCe=async(n,e,t)=>{var r,s;if(n.isConnected||await UY(0),typeof t=="boolean"||t==null)return fn(n,e,t);if(typeof t=="number")return as(n,e,t);if(typeof t=="string")return gr(n,e,t);if(Array.isArray(t)&&!t.length)return n.removeAttribute(e);const i=(s=(r=hB[e])==null?void 0:r.call(hB,t))!=null?s:t;return n.setAttribute(e,i)},nCe=n=>{var e;return!!((e=n.closest)!=null&&e.call(n,'*[slot="media"]'))},Ku=(n,e)=>{if(nCe(n))return;const t=(s,i)=>{var a,o;gI(s)&&i(s);const{children:l=[]}=s??{},c=(o=(a=s?.shadowRoot)==null?void 0:a.children)!=null?o:[];[...l,...c].forEach(f=>Ku(f,i))},r=n?.nodeName.toLowerCase();if(r.includes("-")&&!gI(n)){Ne.customElements.whenDefined(r).then(()=>{t(n,e)});return}t(n,e)},fB=(n,e,t)=>{n.forEach(r=>{if(e in r){r[e]=t;return}const s=mX(r),i=e.toLowerCase();s.includes(i)&&tCe(r,i,t)})},rCe=(n,e,t)=>{Ku(n,e);const r=u=>{var f;const m=(f=u?.composedPath()[0])!=null?f:u.target;e(m)},s=u=>{var f;const m=(f=u?.composedPath()[0])!=null?f:u.target;t(m)};n.addEventListener(Et.REGISTER_MEDIA_STATE_RECEIVER,r),n.addEventListener(Et.UNREGISTER_MEDIA_STATE_RECEIVER,s);const i=u=>{u.forEach(f=>{const{addedNodes:m=[],removedNodes:g=[],type:y,target:b,attributeName:x}=f;y==="childList"?(Array.prototype.forEach.call(m,S=>Ku(S,e)),Array.prototype.forEach.call(g,S=>Ku(S,t))):y==="attributes"&&x===En.MEDIA_CHROME_ATTRIBUTES&&(gI(b)?e(b):t(b))})};let a=[];const o=u=>{const f=u.target;f.name!=="media"&&(a.forEach(m=>Ku(m,t)),a=[...f.assignedElements({flatten:!0})],a.forEach(m=>Ku(m,e)))};n.addEventListener("slotchange",o);const l=new MutationObserver(i);return l.observe(n,{childList:!0,attributes:!0,subtree:!0}),()=>{Ku(n,t),n.removeEventListener("slotchange",o),l.disconnect(),n.removeEventListener(Et.REGISTER_MEDIA_STATE_RECEIVER,r),n.removeEventListener(Et.UNREGISTER_MEDIA_STATE_RECEIVER,s)}};Ne.customElements.get("media-controller")||Ne.customElements.define("media-controller",QRe);const Ph={PLACEMENT:"placement",BOUNDS:"bounds"};function sCe(n){return`
    <style>
      :host {
        --_tooltip-background-color: var(--media-tooltip-background-color, var(--media-secondary-color, rgba(20, 20, 30, .7)));
        --_tooltip-background: var(--media-tooltip-background, var(--_tooltip-background-color));
        --_tooltip-arrow-half-width: calc(var(--media-tooltip-arrow-width, 12px) / 2);
        --_tooltip-arrow-height: var(--media-tooltip-arrow-height, 5px);
        --_tooltip-arrow-background: var(--media-tooltip-arrow-color, var(--_tooltip-background-color));
        position: relative;
        pointer-events: none;
        display: var(--media-tooltip-display, inline-flex);
        justify-content: center;
        align-items: center;
        box-sizing: border-box;
        z-index: var(--media-tooltip-z-index, 1);
        background: var(--_tooltip-background);
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        font: var(--media-font,
          var(--media-font-weight, 400)
          var(--media-font-size, 13px) /
          var(--media-text-content-height, var(--media-control-height, 18px))
          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
        padding: var(--media-tooltip-padding, .35em .7em);
        border: var(--media-tooltip-border, none);
        border-radius: var(--media-tooltip-border-radius, 5px);
        filter: var(--media-tooltip-filter, drop-shadow(0 0 4px rgba(0, 0, 0, .2)));
        white-space: var(--media-tooltip-white-space, nowrap);
      }

      :host([hidden]) {
        display: none;
      }

      img, svg {
        display: inline-block;
      }

      #arrow {
        position: absolute;
        width: 0px;
        height: 0px;
        border-style: solid;
        display: var(--media-tooltip-arrow-display, block);
      }

      :host(:not([placement])),
      :host([placement="top"]) {
        position: absolute;
        bottom: calc(100% + var(--media-tooltip-distance, 12px));
        left: 50%;
        transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);
      }
      :host(:not([placement])) #arrow,
      :host([placement="top"]) #arrow {
        top: 100%;
        left: 50%;
        border-width: var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width);
        border-color: var(--_tooltip-arrow-background) transparent transparent transparent;
        transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);
      }

      :host([placement="right"]) {
        position: absolute;
        left: calc(100% + var(--media-tooltip-distance, 12px));
        top: 50%;
        transform: translate(0, -50%);
      }
      :host([placement="right"]) #arrow {
        top: 50%;
        right: 100%;
        border-width: var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0;
        border-color: transparent var(--_tooltip-arrow-background) transparent transparent;
        transform: translate(0, -50%);
      }

      :host([placement="bottom"]) {
        position: absolute;
        top: calc(100% + var(--media-tooltip-distance, 12px));
        left: 50%;
        transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);
      }
      :host([placement="bottom"]) #arrow {
        bottom: 100%;
        left: 50%;
        border-width: 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width);
        border-color: transparent transparent var(--_tooltip-arrow-background) transparent;
        transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);
      }

      :host([placement="left"]) {
        position: absolute;
        right: calc(100% + var(--media-tooltip-distance, 12px));
        top: 50%;
        transform: translate(0, -50%);
      }
      :host([placement="left"]) #arrow {
        top: 50%;
        left: 100%;
        border-width: var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height);
        border-color: transparent transparent transparent var(--_tooltip-arrow-background);
        transform: translate(0, -50%);
      }
      
      :host([placement="none"]) #arrow {
        display: none;
      }
    </style>
    <slot></slot>
    <div id="arrow"></div>
  `}class WS extends Ne.HTMLElement{constructor(){if(super(),this.updateXOffset=()=>{var e;if(!QY(this,{checkOpacity:!1,checkVisibilityCSS:!1}))return;const t=this.placement;if(t==="left"||t==="right"){this.style.removeProperty("--media-tooltip-offset-x");return}const r=getComputedStyle(this),s=(e=p0(this,"#"+this.bounds))!=null?e:cRe(this);if(!s)return;const{x:i,width:a}=s.getBoundingClientRect(),{x:o,width:l}=this.getBoundingClientRect(),c=o+l,u=i+a,f=r.getPropertyValue("--media-tooltip-offset-x"),m=f?parseFloat(f.replace("px","")):0,g=r.getPropertyValue("--media-tooltip-container-margin"),y=g?parseFloat(g.replace("px","")):0,b=o-i+m-y,x=c-u+m+y;if(b<0){this.style.setProperty("--media-tooltip-offset-x",`${b}px`);return}if(x>0){this.style.setProperty("--media-tooltip-offset-x",`${x}px`);return}this.style.removeProperty("--media-tooltip-offset-x")},!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}if(this.arrowEl=this.shadowRoot.querySelector("#arrow"),Object.prototype.hasOwnProperty.call(this,"placement")){const e=this.placement;delete this.placement,this.placement=e}}static get observedAttributes(){return[Ph.PLACEMENT,Ph.BOUNDS]}get placement(){return pr(this,Ph.PLACEMENT)}set placement(e){gr(this,Ph.PLACEMENT,e)}get bounds(){return pr(this,Ph.BOUNDS)}set bounds(e){gr(this,Ph.BOUNDS,e)}}WS.shadowRootOptions={mode:"open"};WS.getTemplateHTML=sCe;Ne.customElements.get("media-tooltip")||Ne.customElements.define("media-tooltip",WS);var mB=WS,fP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Ir=(n,e,t)=>(fP(n,e,"read from private field"),t?t.call(n):e.get(n)),Mh=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},yb=(n,e,t,r)=>(fP(n,e,"write to private field"),e.set(n,t),t),iCe=(n,e,t)=>(fP(n,e,"access private method"),t),mo,yf,Vc,Yh,mx,vI,pX;const Sc={TOOLTIP_PLACEMENT:"tooltipplacement",DISABLED:"disabled",NO_TOOLTIP:"notooltip"};function aCe(n,e={}){return`
    <style>
      :host {
        position: relative;
        font: var(--media-font,
          var(--media-font-weight, bold)
          var(--media-font-size, 14px) /
          var(--media-text-content-height, var(--media-control-height, 24px))
          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
        padding: var(--media-button-padding, var(--media-control-padding, 10px));
        justify-content: var(--media-button-justify-content, center);
        display: inline-flex;
        align-items: center;
        vertical-align: middle;
        box-sizing: border-box;
        transition: background .15s linear;
        pointer-events: auto;
        cursor: var(--media-cursor, pointer);
        -webkit-tap-highlight-color: transparent;
      }

      
      :host(:focus-visible) {
        box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
        outline: 0;
      }
      
      :host(:where(:focus)) {
        box-shadow: none;
        outline: 0;
      }

      :host(:hover) {
        background: var(--media-control-hover-background, rgba(50 50 70 / .7));
      }

      svg, img, ::slotted(svg), ::slotted(img) {
        width: var(--media-button-icon-width);
        height: var(--media-button-icon-height, var(--media-control-height, 24px));
        transform: var(--media-button-icon-transform);
        transition: var(--media-button-icon-transition);
        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
        vertical-align: middle;
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
      }

      media-tooltip {
        
        max-width: 0;
        overflow-x: clip;
        opacity: 0;
        transition: opacity .3s, max-width 0s 9s;
      }

      :host(:hover) media-tooltip,
      :host(:focus-visible) media-tooltip {
        max-width: 100vw;
        opacity: 1;
        transition: opacity .3s;
      }

      :host([notooltip]) slot[name="tooltip"] {
        display: none;
      }
    </style>

    ${this.getSlotTemplateHTML(n,e)}

    <slot name="tooltip">
      <media-tooltip part="tooltip" aria-hidden="true">
        <template shadowrootmode="${mB.shadowRootOptions.mode}">
          ${mB.getTemplateHTML({})}
        </template>
        <slot name="tooltip-content">
          ${this.getTooltipContentHTML(n)}
        </slot>
      </media-tooltip>
    </slot>
  `}function oCe(n,e){return`
    <slot></slot>
  `}function lCe(){return""}class Fs extends Ne.HTMLElement{constructor(){if(super(),Mh(this,vI),Mh(this,mo,void 0),this.preventClick=!1,this.tooltipEl=null,Mh(this,yf,e=>{this.preventClick||this.handleClick(e),setTimeout(Ir(this,Vc),0)}),Mh(this,Vc,()=>{var e,t;(t=(e=this.tooltipEl)==null?void 0:e.updateXOffset)==null||t.call(e)}),Mh(this,Yh,e=>{const{key:t}=e;if(!this.keysUsed.includes(t)){this.removeEventListener("keyup",Ir(this,Yh));return}this.preventClick||this.handleClick(e)}),Mh(this,mx,e=>{const{metaKey:t,altKey:r,key:s}=e;if(t||r||!this.keysUsed.includes(s)){this.removeEventListener("keyup",Ir(this,Yh));return}this.addEventListener("keyup",Ir(this,Yh),{once:!0})}),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes),t=this.constructor.getTemplateHTML(e);this.shadowRoot.setHTMLUnsafe?this.shadowRoot.setHTMLUnsafe(t):this.shadowRoot.innerHTML=t}this.tooltipEl=this.shadowRoot.querySelector("media-tooltip")}static get observedAttributes(){return["disabled",Sc.TOOLTIP_PLACEMENT,En.MEDIA_CONTROLLER,ue.MEDIA_LANG]}enable(){this.addEventListener("click",Ir(this,yf)),this.addEventListener("keydown",Ir(this,mx)),this.tabIndex=0}disable(){this.removeEventListener("click",Ir(this,yf)),this.removeEventListener("keydown",Ir(this,mx)),this.removeEventListener("keyup",Ir(this,Yh)),this.tabIndex=-1}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===En.MEDIA_CONTROLLER?(t&&((i=(s=Ir(this,mo))==null?void 0:s.unassociateElement)==null||i.call(s,this),yb(this,mo,null)),r&&this.isConnected&&(yb(this,mo,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=Ir(this,mo))==null?void 0:o.associateElement)==null||l.call(o,this))):e==="disabled"&&r!==t?r==null?this.enable():this.disable():e===Sc.TOOLTIP_PLACEMENT&&this.tooltipEl&&r!==t?this.tooltipEl.placement=r:e===ue.MEDIA_LANG&&(this.shadowRoot.querySelector('slot[name="tooltip-content"]').innerHTML=this.constructor.getTooltipContentHTML()),Ir(this,Vc).call(this)}connectedCallback(){var e,t,r;const{style:s}=Or(this.shadowRoot,":host");s.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`),this.hasAttribute("disabled")?this.disable():this.enable(),this.setAttribute("role","button");const i=this.getAttribute(En.MEDIA_CONTROLLER);i&&(yb(this,mo,(e=this.getRootNode())==null?void 0:e.getElementById(i)),(r=(t=Ir(this,mo))==null?void 0:t.associateElement)==null||r.call(t,this)),Ne.customElements.whenDefined("media-tooltip").then(()=>iCe(this,vI,pX).call(this))}disconnectedCallback(){var e,t;this.disable(),(t=(e=Ir(this,mo))==null?void 0:e.unassociateElement)==null||t.call(e,this),yb(this,mo,null),this.removeEventListener("mouseenter",Ir(this,Vc)),this.removeEventListener("focus",Ir(this,Vc)),this.removeEventListener("click",Ir(this,yf))}get keysUsed(){return["Enter"," "]}get tooltipPlacement(){return pr(this,Sc.TOOLTIP_PLACEMENT)}set tooltipPlacement(e){gr(this,Sc.TOOLTIP_PLACEMENT,e)}get mediaController(){return pr(this,En.MEDIA_CONTROLLER)}set mediaController(e){gr(this,En.MEDIA_CONTROLLER,e)}get disabled(){return hn(this,Sc.DISABLED)}set disabled(e){fn(this,Sc.DISABLED,e)}get noTooltip(){return hn(this,Sc.NO_TOOLTIP)}set noTooltip(e){fn(this,Sc.NO_TOOLTIP,e)}handleClick(e){}}mo=new WeakMap;yf=new WeakMap;Vc=new WeakMap;Yh=new WeakMap;mx=new WeakMap;vI=new WeakSet;pX=function(){this.addEventListener("mouseenter",Ir(this,Vc)),this.addEventListener("focus",Ir(this,Vc)),this.addEventListener("click",Ir(this,yf));const n=this.tooltipPlacement;n&&this.tooltipEl&&(this.tooltipEl.placement=n)};Fs.shadowRootOptions={mode:"open"};Fs.getTemplateHTML=aCe;Fs.getSlotTemplateHTML=oCe;Fs.getTooltipContentHTML=lCe;Ne.customElements.get("media-chrome-button")||Ne.customElements.define("media-chrome-button",Fs);const pB=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.13 3H3.87a.87.87 0 0 0-.87.87v13.26a.87.87 0 0 0 .87.87h3.4L9 16H5V5h16v11h-4l1.72 2h3.4a.87.87 0 0 0 .87-.87V3.87a.87.87 0 0 0-.86-.87Zm-8.75 11.44a.5.5 0 0 0-.76 0l-4.91 5.73a.5.5 0 0 0 .38.83h9.82a.501.501 0 0 0 .38-.83l-4.91-5.73Z"/>
</svg>
`;function cCe(n){return`
    <style>
      :host([${ue.MEDIA_IS_AIRPLAYING}]) slot[name=icon] slot:not([name=exit]) {
        display: none !important;
      }

      
      :host(:not([${ue.MEDIA_IS_AIRPLAYING}])) slot[name=icon] slot:not([name=enter]) {
        display: none !important;
      }

      :host([${ue.MEDIA_IS_AIRPLAYING}]) slot[name=tooltip-enter],
      :host(:not([${ue.MEDIA_IS_AIRPLAYING}])) slot[name=tooltip-exit] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="enter">${pB}</slot>
      <slot name="exit">${pB}</slot>
    </slot>
  `}function uCe(){return`
    <slot name="tooltip-enter">${Rt("start airplay")}</slot>
    <slot name="tooltip-exit">${Rt("stop airplay")}</slot>
  `}const gB=n=>{const e=n.mediaIsAirplaying?Rt("stop airplay"):Rt("start airplay");n.setAttribute("aria-label",e)};class mP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_IS_AIRPLAYING,ue.MEDIA_AIRPLAY_UNAVAILABLE]}connectedCallback(){super.connectedCallback(),gB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_IS_AIRPLAYING&&gB(this)}get mediaIsAirplaying(){return hn(this,ue.MEDIA_IS_AIRPLAYING)}set mediaIsAirplaying(e){fn(this,ue.MEDIA_IS_AIRPLAYING,e)}get mediaAirplayUnavailable(){return pr(this,ue.MEDIA_AIRPLAY_UNAVAILABLE)}set mediaAirplayUnavailable(e){gr(this,ue.MEDIA_AIRPLAY_UNAVAILABLE,e)}handleClick(){const e=new Ne.CustomEvent(Et.MEDIA_AIRPLAY_REQUEST,{composed:!0,bubbles:!0});this.dispatchEvent(e)}}mP.getSlotTemplateHTML=cCe;mP.getTooltipContentHTML=uCe;Ne.customElements.get("media-airplay-button")||Ne.customElements.define("media-airplay-button",mP);const dCe=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>
</svg>`,hCe=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>
</svg>`;function fCe(n){return`
    <style>
      :host([aria-checked="true"]) slot[name=off] {
        display: none !important;
      }

      
      :host(:not([aria-checked="true"])) slot[name=on] {
        display: none !important;
      }

      :host([aria-checked="true"]) slot[name=tooltip-enable],
      :host(:not([aria-checked="true"])) slot[name=tooltip-disable] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="on">${dCe}</slot>
      <slot name="off">${hCe}</slot>
    </slot>
  `}function mCe(){return`
    <slot name="tooltip-enable">${Rt("Enable captions")}</slot>
    <slot name="tooltip-disable">${Rt("Disable captions")}</slot>
  `}const vB=n=>{n.setAttribute("aria-checked",CRe(n).toString())};class pP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_SUBTITLES_LIST,ue.MEDIA_SUBTITLES_SHOWING]}connectedCallback(){super.connectedCallback(),this.setAttribute("role","switch"),this.setAttribute("aria-label",Rt("closed captions")),vB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_SUBTITLES_SHOWING&&vB(this)}get mediaSubtitlesList(){return yB(this,ue.MEDIA_SUBTITLES_LIST)}set mediaSubtitlesList(e){bB(this,ue.MEDIA_SUBTITLES_LIST,e)}get mediaSubtitlesShowing(){return yB(this,ue.MEDIA_SUBTITLES_SHOWING)}set mediaSubtitlesShowing(e){bB(this,ue.MEDIA_SUBTITLES_SHOWING,e)}handleClick(){this.dispatchEvent(new Ne.CustomEvent(Et.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}))}}pP.getSlotTemplateHTML=fCe;pP.getTooltipContentHTML=mCe;const yB=(n,e)=>{const t=n.getAttribute(e);return t?aX(t):[]},bB=(n,e,t)=>{if(!t?.length){n.removeAttribute(e);return}const r=fI(t);n.getAttribute(e)!==r&&n.setAttribute(e,r)};Ne.customElements.get("media-captions-button")||Ne.customElements.define("media-captions-button",pP);const pCe='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/></g></svg>',gCe='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/><path class="cast_caf_icon_boxfill" d="M5,7 L5,8.63 C8,8.6 13.37,14 13.37,17 L19,17 L19,7 Z"/></g></svg>';function vCe(n){return`
    <style>
      :host([${ue.MEDIA_IS_CASTING}]) slot[name=icon] slot:not([name=exit]) {
        display: none !important;
      }

      
      :host(:not([${ue.MEDIA_IS_CASTING}])) slot[name=icon] slot:not([name=enter]) {
        display: none !important;
      }

      :host([${ue.MEDIA_IS_CASTING}]) slot[name=tooltip-enter],
      :host(:not([${ue.MEDIA_IS_CASTING}])) slot[name=tooltip-exit] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="enter">${pCe}</slot>
      <slot name="exit">${gCe}</slot>
    </slot>
  `}function yCe(){return`
    <slot name="tooltip-enter">${Rt("Start casting")}</slot>
    <slot name="tooltip-exit">${Rt("Stop casting")}</slot>
  `}const xB=n=>{const e=n.mediaIsCasting?Rt("stop casting"):Rt("start casting");n.setAttribute("aria-label",e)};class gP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_IS_CASTING,ue.MEDIA_CAST_UNAVAILABLE]}connectedCallback(){super.connectedCallback(),xB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_IS_CASTING&&xB(this)}get mediaIsCasting(){return hn(this,ue.MEDIA_IS_CASTING)}set mediaIsCasting(e){fn(this,ue.MEDIA_IS_CASTING,e)}get mediaCastUnavailable(){return pr(this,ue.MEDIA_CAST_UNAVAILABLE)}set mediaCastUnavailable(e){gr(this,ue.MEDIA_CAST_UNAVAILABLE,e)}handleClick(){const e=this.mediaIsCasting?Et.MEDIA_EXIT_CAST_REQUEST:Et.MEDIA_ENTER_CAST_REQUEST;this.dispatchEvent(new Ne.CustomEvent(e,{composed:!0,bubbles:!0}))}}gP.getSlotTemplateHTML=vCe;gP.getTooltipContentHTML=yCe;Ne.customElements.get("media-cast-button")||Ne.customElements.define("media-cast-button",gP);var vP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},dd=(n,e,t)=>(vP(n,e,"read from private field"),e.get(n)),bl=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},yP=(n,e,t,r)=>(vP(n,e,"write to private field"),e.set(n,t),t),Hu=(n,e,t)=>(vP(n,e,"access private method"),t),xE,kv,_d,px,yI,bI,gX,xI,vX,wI,yX,EI,bX,SI,xX;function bCe(n){return`
    <style>
      :host {
        font: var(--media-font,
          var(--media-font-weight, normal)
          var(--media-font-size, 14px) /
          var(--media-text-content-height, var(--media-control-height, 24px))
          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        display: var(--media-dialog-display, inline-flex);
        justify-content: center;
        align-items: center;
        
        transition-behavior: allow-discrete;
        visibility: hidden;
        opacity: 0;
        transform: translateY(2px) scale(.99);
        pointer-events: none;
      }

      :host([open]) {
        transition: display .2s, visibility 0s, opacity .2s ease-out, transform .15s ease-out;
        visibility: visible;
        opacity: 1;
        transform: translateY(0) scale(1);
        pointer-events: auto;
      }

      #content {
        display: flex;
        position: relative;
        box-sizing: border-box;
        width: min(320px, 100%);
        word-wrap: break-word;
        max-height: 100%;
        overflow: auto;
        text-align: center;
        line-height: 1.4;
      }
    </style>
    ${this.getSlotTemplateHTML(n)}
  `}function xCe(n){return`
    <slot id="content"></slot>
  `}const Pp={OPEN:"open",ANCHOR:"anchor"};class g0 extends Ne.HTMLElement{constructor(){super(),bl(this,px),bl(this,bI),bl(this,xI),bl(this,wI),bl(this,EI),bl(this,SI),bl(this,xE,!1),bl(this,kv,null),bl(this,_d,null),this.addEventListener("invoke",this),this.addEventListener("focusout",this),this.addEventListener("keydown",this)}static get observedAttributes(){return[Pp.OPEN,Pp.ANCHOR]}get open(){return hn(this,Pp.OPEN)}set open(e){fn(this,Pp.OPEN,e)}handleEvent(e){switch(e.type){case"invoke":Hu(this,wI,yX).call(this,e);break;case"focusout":Hu(this,EI,bX).call(this,e);break;case"keydown":Hu(this,SI,xX).call(this,e);break}}connectedCallback(){Hu(this,px,yI).call(this),this.role||(this.role="dialog")}attributeChangedCallback(e,t,r){Hu(this,px,yI).call(this),e===Pp.OPEN&&r!==t&&(this.open?Hu(this,bI,gX).call(this):Hu(this,xI,vX).call(this))}focus(){yP(this,kv,XY());const e=!this.dispatchEvent(new Event("focus",{composed:!0,cancelable:!0})),t=!this.dispatchEvent(new Event("focusin",{composed:!0,bubbles:!0,cancelable:!0}));if(e||t)return;const r=this.querySelector('[autofocus], [tabindex]:not([tabindex="-1"]), [role="menu"]');r?.focus()}get keysUsed(){return["Escape","Tab"]}}xE=new WeakMap;kv=new WeakMap;_d=new WeakMap;px=new WeakSet;yI=function(){if(!dd(this,xE)&&(yP(this,xE,!0),!this.shadowRoot)){this.attachShadow(this.constructor.shadowRootOptions);const n=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(n),queueMicrotask(()=>{const{style:e}=Or(this.shadowRoot,":host");e.setProperty("transition","display .15s, visibility .15s, opacity .15s ease-in, transform .15s ease-in")})}};bI=new WeakSet;gX=function(){var n;(n=dd(this,_d))==null||n.setAttribute("aria-expanded","true"),this.dispatchEvent(new Event("open",{composed:!0,bubbles:!0})),this.addEventListener("transitionend",()=>this.focus(),{once:!0})};xI=new WeakSet;vX=function(){var n;(n=dd(this,_d))==null||n.setAttribute("aria-expanded","false"),this.dispatchEvent(new Event("close",{composed:!0,bubbles:!0}))};wI=new WeakSet;yX=function(n){yP(this,_d,n.relatedTarget),vm(this,n.relatedTarget)||(this.open=!this.open)};EI=new WeakSet;bX=function(n){var e;vm(this,n.relatedTarget)||((e=dd(this,kv))==null||e.focus(),dd(this,_d)&&dd(this,_d)!==n.relatedTarget&&this.open&&(this.open=!1))};SI=new WeakSet;xX=function(n){var e,t,r,s,i;const{key:a,ctrlKey:o,altKey:l,metaKey:c}=n;o||l||c||this.keysUsed.includes(a)&&(n.preventDefault(),n.stopPropagation(),a==="Tab"?(n.shiftKey?(t=(e=this.previousElementSibling)==null?void 0:e.focus)==null||t.call(e):(s=(r=this.nextElementSibling)==null?void 0:r.focus)==null||s.call(r),this.blur()):a==="Escape"&&((i=dd(this,kv))==null||i.focus(),this.open=!1))};g0.shadowRootOptions={mode:"open"};g0.getTemplateHTML=bCe;g0.getSlotTemplateHTML=xCe;Ne.customElements.get("media-chrome-dialog")||Ne.customElements.define("media-chrome-dialog",g0);var bP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},tr=(n,e,t)=>(bP(n,e,"read from private field"),t?t.call(n):e.get(n)),ds=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Dc=(n,e,t,r)=>(bP(n,e,"write to private field"),e.set(n,t),t),Ma=(n,e,t)=>(bP(n,e,"access private method"),t),po,KS,gx,vx,ja,wE,yx,bx,xx,xP,wX,wx,TI,Ex,_I,EE,wP,AI,EX,RI,SX,CI,TX,kI,_X;function wCe(n){return`
    <style>
      :host {
        --_focus-box-shadow: var(--media-focus-box-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));
        --_media-range-padding: var(--media-range-padding, var(--media-control-padding, 10px));

        box-shadow: var(--_focus-visible-box-shadow, none);
        background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
        height: calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding));
        display: inline-flex;
        align-items: center;
        
        vertical-align: middle;
        box-sizing: border-box;
        position: relative;
        width: 100px;
        transition: background .15s linear;
        cursor: var(--media-cursor, pointer);
        pointer-events: auto;
        touch-action: none; 
      }

      
      input[type=range]:focus {
        outline: 0;
      }
      input[type=range]:focus::-webkit-slider-runnable-track {
        outline: 0;
      }

      :host(:hover) {
        background: var(--media-control-hover-background, rgb(50 50 70 / .7));
      }

      #leftgap {
        padding-left: var(--media-range-padding-left, var(--_media-range-padding));
      }

      #rightgap {
        padding-right: var(--media-range-padding-right, var(--_media-range-padding));
      }

      #startpoint,
      #endpoint {
        position: absolute;
      }

      #endpoint {
        right: 0;
      }

      #container {
        
        width: var(--media-range-track-width, 100%);
        transform: translate(var(--media-range-track-translate-x, 0px), var(--media-range-track-translate-y, 0px));
        position: relative;
        height: 100%;
        display: flex;
        align-items: center;
        min-width: 40px;
      }

      #range {
        
        display: var(--media-time-range-hover-display, block);
        bottom: var(--media-time-range-hover-bottom, -7px);
        height: var(--media-time-range-hover-height, max(100% + 7px, 25px));
        width: 100%;
        position: absolute;
        cursor: var(--media-cursor, pointer);

        -webkit-appearance: none; 
        -webkit-tap-highlight-color: transparent;
        background: transparent; 
        margin: 0;
        z-index: 1;
      }

      @media (hover: hover) {
        #range {
          bottom: var(--media-time-range-hover-bottom, -5px);
          height: var(--media-time-range-hover-height, max(100% + 5px, 20px));
        }
      }

      
      
      #range::-webkit-slider-thumb {
        -webkit-appearance: none;
        background: transparent;
        width: .1px;
        height: .1px;
      }

      
      #range::-moz-range-thumb {
        background: transparent;
        border: transparent;
        width: .1px;
        height: .1px;
      }

      #appearance {
        height: var(--media-range-track-height, 4px);
        display: flex;
        flex-direction: column;
        justify-content: center;
        width: 100%;
        position: absolute;
        
        will-change: transform;
      }

      #track {
        background: var(--media-range-track-background, rgb(255 255 255 / .2));
        border-radius: var(--media-range-track-border-radius, 1px);
        border: var(--media-range-track-border, none);
        outline: var(--media-range-track-outline);
        outline-offset: var(--media-range-track-outline-offset);
        backdrop-filter: var(--media-range-track-backdrop-filter);
        -webkit-backdrop-filter: var(--media-range-track-backdrop-filter);
        box-shadow: var(--media-range-track-box-shadow, none);
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      #progress,
      #pointer {
        position: absolute;
        height: 100%;
        will-change: width;
      }

      #progress {
        background: var(--media-range-bar-color, var(--media-primary-color, rgb(238 238 238)));
        transition: var(--media-range-track-transition);
      }

      #pointer {
        background: var(--media-range-track-pointer-background);
        border-right: var(--media-range-track-pointer-border-right);
        transition: visibility .25s, opacity .25s;
        visibility: hidden;
        opacity: 0;
      }

      @media (hover: hover) {
        :host(:hover) #pointer {
          transition: visibility .5s, opacity .5s;
          visibility: visible;
          opacity: 1;
        }
      }

      #thumb,
      ::slotted([slot=thumb]) {
        width: var(--media-range-thumb-width, 10px);
        height: var(--media-range-thumb-height, 10px);
        transition: var(--media-range-thumb-transition);
        transform: var(--media-range-thumb-transform, none);
        opacity: var(--media-range-thumb-opacity, 1);
        translate: -50%;
        position: absolute;
        left: 0;
        cursor: var(--media-cursor, pointer);
      }

      #thumb {
        border-radius: var(--media-range-thumb-border-radius, 10px);
        background: var(--media-range-thumb-background, var(--media-primary-color, rgb(238 238 238)));
        box-shadow: var(--media-range-thumb-box-shadow, 1px 1px 1px transparent);
        border: var(--media-range-thumb-border, none);
      }

      :host([disabled]) #thumb {
        background-color: #777;
      }

      .segments #appearance {
        height: var(--media-range-segment-hover-height, 7px);
      }

      #track {
        clip-path: url(#segments-clipping);
      }

      #segments {
        --segments-gap: var(--media-range-segments-gap, 2px);
        position: absolute;
        width: 100%;
        height: 100%;
      }

      #segments-clipping {
        transform: translateX(calc(var(--segments-gap) / 2));
      }

      #segments-clipping:empty {
        display: none;
      }

      #segments-clipping rect {
        height: var(--media-range-track-height, 4px);
        y: calc((var(--media-range-segment-hover-height, 7px) - var(--media-range-track-height, 4px)) / 2);
        transition: var(--media-range-segment-transition, transform .1s ease-in-out);
        transform: var(--media-range-segment-transform, scaleY(1));
        transform-origin: center;
      }
    </style>
    <div id="leftgap"></div>
    <div id="container">
      <div id="startpoint"></div>
      <div id="endpoint"></div>
      <div id="appearance">
        <div id="track" part="track">
          <div id="pointer"></div>
          <div id="progress" part="progress"></div>
        </div>
        <slot name="thumb">
          <div id="thumb" part="thumb"></div>
        </slot>
        <svg id="segments"><clipPath id="segments-clipping"></clipPath></svg>
      </div>
      <input id="range" type="range" min="0" max="1" step="any" value="0">
    </div>
    <div id="rightgap"></div>
  `}class ym extends Ne.HTMLElement{constructor(){if(super(),ds(this,xP),ds(this,wx),ds(this,Ex),ds(this,EE),ds(this,AI),ds(this,RI),ds(this,CI),ds(this,kI),ds(this,po,void 0),ds(this,KS,void 0),ds(this,gx,void 0),ds(this,vx,void 0),ds(this,ja,{}),ds(this,wE,[]),ds(this,yx,()=>{if(this.range.matches(":focus-visible")){const{style:e}=Or(this.shadowRoot,":host");e.setProperty("--_focus-visible-box-shadow","var(--_focus-box-shadow)")}}),ds(this,bx,()=>{const{style:e}=Or(this.shadowRoot,":host");e.removeProperty("--_focus-visible-box-shadow")}),ds(this,xx,()=>{const e=this.shadowRoot.querySelector("#segments-clipping");e&&e.parentNode.append(e)}),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes),t=this.constructor.getTemplateHTML(e);this.shadowRoot.setHTMLUnsafe?this.shadowRoot.setHTMLUnsafe(t):this.shadowRoot.innerHTML=t}this.container=this.shadowRoot.querySelector("#container"),Dc(this,gx,this.shadowRoot.querySelector("#startpoint")),Dc(this,vx,this.shadowRoot.querySelector("#endpoint")),this.range=this.shadowRoot.querySelector("#range"),this.appearance=this.shadowRoot.querySelector("#appearance")}static get observedAttributes(){return["disabled","aria-disabled",En.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===En.MEDIA_CONTROLLER?(t&&((i=(s=tr(this,po))==null?void 0:s.unassociateElement)==null||i.call(s,this),Dc(this,po,null)),r&&this.isConnected&&(Dc(this,po,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=tr(this,po))==null?void 0:o.associateElement)==null||l.call(o,this))):(e==="disabled"||e==="aria-disabled"&&t!==r)&&(r==null?(this.range.removeAttribute(e),Ma(this,wx,TI).call(this)):(this.range.setAttribute(e,r),Ma(this,Ex,_I).call(this)))}connectedCallback(){var e,t,r;const{style:s}=Or(this.shadowRoot,":host");s.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`),tr(this,ja).pointer=Or(this.shadowRoot,"#pointer"),tr(this,ja).progress=Or(this.shadowRoot,"#progress"),tr(this,ja).thumb=Or(this.shadowRoot,'#thumb, ::slotted([slot="thumb"])'),tr(this,ja).activeSegment=Or(this.shadowRoot,"#segments-clipping rect:nth-child(0)");const i=this.getAttribute(En.MEDIA_CONTROLLER);i&&(Dc(this,po,(e=this.getRootNode())==null?void 0:e.getElementById(i)),(r=(t=tr(this,po))==null?void 0:t.associateElement)==null||r.call(t,this)),this.updateBar(),this.shadowRoot.addEventListener("focusin",tr(this,yx)),this.shadowRoot.addEventListener("focusout",tr(this,bx)),Ma(this,wx,TI).call(this),qY(this.container,tr(this,xx))}disconnectedCallback(){var e,t;Ma(this,Ex,_I).call(this),(t=(e=tr(this,po))==null?void 0:e.unassociateElement)==null||t.call(e,this),Dc(this,po,null),this.shadowRoot.removeEventListener("focusin",tr(this,yx)),this.shadowRoot.removeEventListener("focusout",tr(this,bx)),WY(this.container,tr(this,xx))}updatePointerBar(e){var t;(t=tr(this,ja).pointer)==null||t.style.setProperty("width",`${this.getPointerRatio(e)*100}%`)}updateBar(){var e,t;const r=this.range.valueAsNumber*100;(e=tr(this,ja).progress)==null||e.style.setProperty("width",`${r}%`),(t=tr(this,ja).thumb)==null||t.style.setProperty("left",`${r}%`)}updateSegments(e){const t=this.shadowRoot.querySelector("#segments-clipping");if(t.textContent="",this.container.classList.toggle("segments",!!e?.length),!e?.length)return;const r=[...new Set([+this.range.min,...e.flatMap(i=>[i.start,i.end]),+this.range.max])];Dc(this,wE,[...r]);const s=r.pop();for(const[i,a]of r.entries()){const[o,l]=[i===0,i===r.length-1],c=o?"calc(var(--segments-gap) / -1)":`${a*100}%`,f=`calc(${((l?s:r[i+1])-a)*100}%${o||l?"":" - var(--segments-gap)"})`,m=gi.createElementNS("http://www.w3.org/2000/svg","rect"),g=Or(this.shadowRoot,`#segments-clipping rect:nth-child(${i+1})`);g.style.setProperty("x",c),g.style.setProperty("width",f),t.append(m)}}getPointerRatio(e){return fRe(e.clientX,e.clientY,tr(this,gx).getBoundingClientRect(),tr(this,vx).getBoundingClientRect())}get dragging(){return this.hasAttribute("dragging")}handleEvent(e){switch(e.type){case"pointermove":Ma(this,kI,_X).call(this,e);break;case"input":this.updateBar();break;case"pointerenter":Ma(this,AI,EX).call(this,e);break;case"pointerdown":Ma(this,EE,wP).call(this,e);break;case"pointerup":Ma(this,RI,SX).call(this);break;case"pointerleave":Ma(this,CI,TX).call(this);break}}get keysUsed(){return["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]}}po=new WeakMap;KS=new WeakMap;gx=new WeakMap;vx=new WeakMap;ja=new WeakMap;wE=new WeakMap;yx=new WeakMap;bx=new WeakMap;xx=new WeakMap;xP=new WeakSet;wX=function(n){const e=tr(this,ja).activeSegment;if(!e)return;const t=this.getPointerRatio(n),s=`#segments-clipping rect:nth-child(${tr(this,wE).findIndex((i,a,o)=>{const l=o[a+1];return l!=null&&t>=i&&t<=l})+1})`;(e.selectorText!=s||!e.style.transform)&&(e.selectorText=s,e.style.setProperty("transform","var(--media-range-segment-hover-transform, scaleY(2))"))};wx=new WeakSet;TI=function(){this.hasAttribute("disabled")||(this.addEventListener("input",this),this.addEventListener("pointerdown",this),this.addEventListener("pointerenter",this))};Ex=new WeakSet;_I=function(){var n,e;this.removeEventListener("input",this),this.removeEventListener("pointerdown",this),this.removeEventListener("pointerenter",this),(n=Ne.window)==null||n.removeEventListener("pointerup",this),(e=Ne.window)==null||e.removeEventListener("pointermove",this)};EE=new WeakSet;wP=function(n){var e;Dc(this,KS,n.composedPath().includes(this.range)),(e=Ne.window)==null||e.addEventListener("pointerup",this)};AI=new WeakSet;EX=function(n){var e;n.pointerType!=="mouse"&&Ma(this,EE,wP).call(this,n),this.addEventListener("pointerleave",this),(e=Ne.window)==null||e.addEventListener("pointermove",this)};RI=new WeakSet;SX=function(){var n;(n=Ne.window)==null||n.removeEventListener("pointerup",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled")};CI=new WeakSet;TX=function(){var n,e;this.removeEventListener("pointerleave",this),(n=Ne.window)==null||n.removeEventListener("pointermove",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled"),(e=tr(this,ja).activeSegment)==null||e.style.removeProperty("transform")};kI=new WeakSet;_X=function(n){this.toggleAttribute("dragging",n.buttons===1||n.pointerType!=="mouse"),this.updatePointerBar(n),Ma(this,xP,wX).call(this,n),this.dragging&&(n.pointerType!=="mouse"||!tr(this,KS))&&(this.range.disabled=!0,this.range.valueAsNumber=this.getPointerRatio(n),this.range.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})))};ym.shadowRootOptions={mode:"open"};ym.getTemplateHTML=wCe;Ne.customElements.get("media-chrome-range")||Ne.customElements.define("media-chrome-range",ym);var AX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},bb=(n,e,t)=>(AX(n,e,"read from private field"),t?t.call(n):e.get(n)),ECe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},xb=(n,e,t,r)=>(AX(n,e,"write to private field"),e.set(n,t),t),go;function SCe(n){return`
    <style>
      :host {
        
        box-sizing: border-box;
        display: var(--media-control-display, var(--media-control-bar-display, inline-flex));
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        --media-loading-indicator-icon-height: 44px;
      }

      ::slotted(media-time-range),
      ::slotted(media-volume-range) {
        min-height: 100%;
      }

      ::slotted(media-time-range),
      ::slotted(media-clip-selector) {
        flex-grow: 1;
      }

      ::slotted([role="menu"]) {
        position: absolute;
      }
    </style>

    <slot></slot>
  `}class EP extends Ne.HTMLElement{constructor(){if(super(),ECe(this,go,void 0),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}}static get observedAttributes(){return[En.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===En.MEDIA_CONTROLLER&&(t&&((i=(s=bb(this,go))==null?void 0:s.unassociateElement)==null||i.call(s,this),xb(this,go,null)),r&&this.isConnected&&(xb(this,go,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=bb(this,go))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,r;const s=this.getAttribute(En.MEDIA_CONTROLLER);s&&(xb(this,go,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(r=(t=bb(this,go))==null?void 0:t.associateElement)==null||r.call(t,this))}disconnectedCallback(){var e,t;(t=(e=bb(this,go))==null?void 0:e.unassociateElement)==null||t.call(e,this),xb(this,go,null)}}go=new WeakMap;EP.shadowRootOptions={mode:"open"};EP.getTemplateHTML=SCe;Ne.customElements.get("media-control-bar")||Ne.customElements.define("media-control-bar",EP);var RX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},wb=(n,e,t)=>(RX(n,e,"read from private field"),t?t.call(n):e.get(n)),TCe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Eb=(n,e,t,r)=>(RX(n,e,"write to private field"),e.set(n,t),t),vo;function _Ce(n,e={}){return`
    <style>
      :host {
        font: var(--media-font,
          var(--media-font-weight, normal)
          var(--media-font-size, 14px) /
          var(--media-text-content-height, var(--media-control-height, 24px))
          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        background: var(--media-text-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7))));
        padding: var(--media-control-padding, 10px);
        display: inline-flex;
        justify-content: center;
        align-items: center;
        vertical-align: middle;
        box-sizing: border-box;
        text-align: center;
        pointer-events: auto;
      }

      
      :host(:focus-visible) {
        box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
        outline: 0;
      }

      
      :host(:where(:focus)) {
        box-shadow: none;
        outline: 0;
      }
    </style>

    ${this.getSlotTemplateHTML(n,e)}
  `}function ACe(n,e){return`
    <slot></slot>
  `}class vu extends Ne.HTMLElement{constructor(){if(super(),TCe(this,vo,void 0),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}}static get observedAttributes(){return[En.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===En.MEDIA_CONTROLLER&&(t&&((i=(s=wb(this,vo))==null?void 0:s.unassociateElement)==null||i.call(s,this),Eb(this,vo,null)),r&&this.isConnected&&(Eb(this,vo,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=wb(this,vo))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,r;const{style:s}=Or(this.shadowRoot,":host");s.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`);const i=this.getAttribute(En.MEDIA_CONTROLLER);i&&(Eb(this,vo,(e=this.getRootNode())==null?void 0:e.getElementById(i)),(r=(t=wb(this,vo))==null?void 0:t.associateElement)==null||r.call(t,this))}disconnectedCallback(){var e,t;(t=(e=wb(this,vo))==null?void 0:e.unassociateElement)==null||t.call(e,this),Eb(this,vo,null)}}vo=new WeakMap;vu.shadowRootOptions={mode:"open"};vu.getTemplateHTML=_Ce;vu.getSlotTemplateHTML=ACe;Ne.customElements.get("media-text-display")||Ne.customElements.define("media-text-display",vu);var CX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},wB=(n,e,t)=>(CX(n,e,"read from private field"),t?t.call(n):e.get(n)),RCe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},CCe=(n,e,t,r)=>(CX(n,e,"write to private field"),e.set(n,t),t),rg;function kCe(n,e){return`
    <slot>${Xc(e.mediaDuration)}</slot>
  `}class kX extends vu{constructor(){var e;super(),RCe(this,rg,void 0),CCe(this,rg,this.shadowRoot.querySelector("slot")),wB(this,rg).textContent=Xc((e=this.mediaDuration)!=null?e:0)}static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_DURATION]}attributeChangedCallback(e,t,r){e===ue.MEDIA_DURATION&&(wB(this,rg).textContent=Xc(+r)),super.attributeChangedCallback(e,t,r)}get mediaDuration(){return mr(this,ue.MEDIA_DURATION)}set mediaDuration(e){as(this,ue.MEDIA_DURATION,e)}}rg=new WeakMap;kX.getSlotTemplateHTML=kCe;Ne.customElements.get("media-duration-display")||Ne.customElements.define("media-duration-display",kX);const ICe={2:Rt("Network Error"),3:Rt("Decode Error"),4:Rt("Source Not Supported"),5:Rt("Encryption Error")},LCe={2:Rt("A network error caused the media download to fail."),3:Rt("A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format."),4:Rt("An unsupported error occurred. The server or network failed, or your browser does not support this format."),5:Rt("The media is encrypted and there are no keys to decrypt it.")},IX=n=>{var e,t;return n.code===1?null:{title:(e=ICe[n.code])!=null?e:`Error ${n.code}`,message:(t=LCe[n.code])!=null?t:n.message}};var LX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},DCe=(n,e,t)=>(LX(n,e,"read from private field"),t?t.call(n):e.get(n)),PCe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},MCe=(n,e,t,r)=>(LX(n,e,"write to private field"),e.set(n,t),t),Sx;function OCe(n){return`
    <style>
      :host {
        background: rgb(20 20 30 / .8);
      }

      #content {
        display: block;
        padding: 1.2em 1.5em;
      }

      h3,
      p {
        margin-block: 0 .3em;
      }
    </style>
    <slot name="error-${n.mediaerrorcode}" id="content">
      ${DX({code:+n.mediaerrorcode,message:n.mediaerrormessage})}
    </slot>
  `}function NCe(n){return n.code&&IX(n)!==null}function DX(n){var e;const{title:t,message:r}=(e=IX(n))!=null?e:{};let s="";return t&&(s+=`<slot name="error-${n.code}-title"><h3>${t}</h3></slot>`),r&&(s+=`<slot name="error-${n.code}-message"><p>${r}</p></slot>`),s}const EB=[ue.MEDIA_ERROR_CODE,ue.MEDIA_ERROR_MESSAGE];class SP extends g0{constructor(){super(...arguments),PCe(this,Sx,null)}static get observedAttributes(){return[...super.observedAttributes,...EB]}formatErrorMessage(e){return this.constructor.formatErrorMessage(e)}attributeChangedCallback(e,t,r){var s;if(super.attributeChangedCallback(e,t,r),!EB.includes(e))return;const i=(s=this.mediaError)!=null?s:{code:this.mediaErrorCode,message:this.mediaErrorMessage};this.open=NCe(i),this.open&&(this.shadowRoot.querySelector("slot").name=`error-${this.mediaErrorCode}`,this.shadowRoot.querySelector("#content").innerHTML=this.formatErrorMessage(i))}get mediaError(){return DCe(this,Sx)}set mediaError(e){MCe(this,Sx,e)}get mediaErrorCode(){return mr(this,"mediaerrorcode")}set mediaErrorCode(e){as(this,"mediaerrorcode",e)}get mediaErrorMessage(){return pr(this,"mediaerrormessage")}set mediaErrorMessage(e){gr(this,"mediaerrormessage",e)}}Sx=new WeakMap;SP.getSlotTemplateHTML=OCe;SP.formatErrorMessage=DX;Ne.customElements.get("media-error-dialog")||Ne.customElements.define("media-error-dialog",SP);const jCe=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M16 3v2.5h3.5V9H22V3h-6ZM4 9h2.5V5.5H10V3H4v6Zm15.5 9.5H16V21h6v-6h-2.5v3.5ZM6.5 15H4v6h6v-2.5H6.5V15Z"/>
</svg>`,FCe=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M18.5 6.5V3H16v6h6V6.5h-3.5ZM16 21h2.5v-3.5H22V15h-6v6ZM4 17.5h3.5V21H10v-6H4v2.5Zm3.5-11H4V9h6V3H7.5v3.5Z"/>
</svg>`;function UCe(n){return`
    <style>
      :host([${ue.MEDIA_IS_FULLSCREEN}]) slot[name=icon] slot:not([name=exit]) {
        display: none !important;
      }

      
      :host(:not([${ue.MEDIA_IS_FULLSCREEN}])) slot[name=icon] slot:not([name=enter]) {
        display: none !important;
      }

      :host([${ue.MEDIA_IS_FULLSCREEN}]) slot[name=tooltip-enter],
      :host(:not([${ue.MEDIA_IS_FULLSCREEN}])) slot[name=tooltip-exit] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="enter">${jCe}</slot>
      <slot name="exit">${FCe}</slot>
    </slot>
  `}function $Ce(){return`
    <slot name="tooltip-enter">${Rt("Enter fullscreen mode")}</slot>
    <slot name="tooltip-exit">${Rt("Exit fullscreen mode")}</slot>
  `}const SB=n=>{const e=n.mediaIsFullscreen?Rt("exit fullscreen mode"):Rt("enter fullscreen mode");n.setAttribute("aria-label",e)};class TP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_IS_FULLSCREEN,ue.MEDIA_FULLSCREEN_UNAVAILABLE]}connectedCallback(){super.connectedCallback(),SB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_IS_FULLSCREEN&&SB(this)}get mediaFullscreenUnavailable(){return pr(this,ue.MEDIA_FULLSCREEN_UNAVAILABLE)}set mediaFullscreenUnavailable(e){gr(this,ue.MEDIA_FULLSCREEN_UNAVAILABLE,e)}get mediaIsFullscreen(){return hn(this,ue.MEDIA_IS_FULLSCREEN)}set mediaIsFullscreen(e){fn(this,ue.MEDIA_IS_FULLSCREEN,e)}handleClick(){const e=this.mediaIsFullscreen?Et.MEDIA_EXIT_FULLSCREEN_REQUEST:Et.MEDIA_ENTER_FULLSCREEN_REQUEST;this.dispatchEvent(new Ne.CustomEvent(e,{composed:!0,bubbles:!0}))}}TP.getSlotTemplateHTML=UCe;TP.getTooltipContentHTML=$Ce;Ne.customElements.get("media-fullscreen-button")||Ne.customElements.define("media-fullscreen-button",TP);const{MEDIA_TIME_IS_LIVE:Tx,MEDIA_PAUSED:Og}=ue,{MEDIA_SEEK_TO_LIVE_REQUEST:BCe,MEDIA_PLAY_REQUEST:HCe}=Et,VCe='<svg viewBox="0 0 6 12"><circle cx="3" cy="6" r="2"></circle></svg>';function zCe(n){return`
    <style>
      :host { --media-tooltip-display: none; }
      
      slot[name=indicator] > *,
      :host ::slotted([slot=indicator]) {
        
        min-width: auto;
        fill: var(--media-live-button-icon-color, rgb(140, 140, 140));
        color: var(--media-live-button-icon-color, rgb(140, 140, 140));
      }

      :host([${Tx}]:not([${Og}])) slot[name=indicator] > *,
      :host([${Tx}]:not([${Og}])) ::slotted([slot=indicator]) {
        fill: var(--media-live-button-indicator-color, rgb(255, 0, 0));
        color: var(--media-live-button-indicator-color, rgb(255, 0, 0));
      }

      :host([${Tx}]:not([${Og}])) {
        cursor: var(--media-cursor, not-allowed);
      }

      slot[name=text]{
        text-transform: uppercase;
      }

    </style>

    <slot name="indicator">${VCe}</slot>
    
    <slot name="spacer">&nbsp;</slot><slot name="text">${Rt("live")}</slot>
  `}const TB=n=>{var e;const t=n.mediaPaused||!n.mediaTimeIsLive,r=Rt(t?"seek to live":"playing live");n.setAttribute("aria-label",r);const s=(e=n.shadowRoot)==null?void 0:e.querySelector('slot[name="text"]');s&&(s.textContent=Rt("live")),t?n.removeAttribute("aria-disabled"):n.setAttribute("aria-disabled","true")};class PX extends Fs{static get observedAttributes(){return[...super.observedAttributes,Tx,Og]}connectedCallback(){super.connectedCallback(),TB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),TB(this)}get mediaPaused(){return hn(this,ue.MEDIA_PAUSED)}set mediaPaused(e){fn(this,ue.MEDIA_PAUSED,e)}get mediaTimeIsLive(){return hn(this,ue.MEDIA_TIME_IS_LIVE)}set mediaTimeIsLive(e){fn(this,ue.MEDIA_TIME_IS_LIVE,e)}handleClick(){!this.mediaPaused&&this.mediaTimeIsLive||(this.dispatchEvent(new Ne.CustomEvent(BCe,{composed:!0,bubbles:!0})),this.hasAttribute(Og)&&this.dispatchEvent(new Ne.CustomEvent(HCe,{composed:!0,bubbles:!0})))}}PX.getSlotTemplateHTML=zCe;Ne.customElements.get("media-live-button")||Ne.customElements.define("media-live-button",PX);var MX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Mp=(n,e,t)=>(MX(n,e,"read from private field"),t?t.call(n):e.get(n)),_B=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Op=(n,e,t,r)=>(MX(n,e,"write to private field"),e.set(n,t),t),yo,_x;const Sb={LOADING_DELAY:"loadingdelay",NO_AUTOHIDE:"noautohide"},OX=500,GCe=`
<svg aria-hidden="true" viewBox="0 0 100 100">
  <path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">
    <animateTransform
       attributeName="transform"
       attributeType="XML"
       type="rotate"
       dur="1s"
       from="0 50 50"
       to="360 50 50"
       repeatCount="indefinite" />
  </path>
</svg>
`;function qCe(n){return`
    <style>
      :host {
        display: var(--media-control-display, var(--media-loading-indicator-display, inline-block));
        vertical-align: middle;
        box-sizing: border-box;
        --_loading-indicator-delay: var(--media-loading-indicator-transition-delay, ${OX}ms);
      }

      #status {
        color: rgba(0,0,0,0);
        width: 0px;
        height: 0px;
      }

      :host slot[name=icon] > *,
      :host ::slotted([slot=icon]) {
        opacity: var(--media-loading-indicator-opacity, 0);
        transition: opacity 0.15s;
      }

      :host([${ue.MEDIA_LOADING}]:not([${ue.MEDIA_PAUSED}])) slot[name=icon] > *,
      :host([${ue.MEDIA_LOADING}]:not([${ue.MEDIA_PAUSED}])) ::slotted([slot=icon]) {
        opacity: var(--media-loading-indicator-opacity, 1);
        transition: opacity 0.15s var(--_loading-indicator-delay);
      }

      :host #status {
        visibility: var(--media-loading-indicator-opacity, hidden);
        transition: visibility 0.15s;
      }

      :host([${ue.MEDIA_LOADING}]:not([${ue.MEDIA_PAUSED}])) #status {
        visibility: var(--media-loading-indicator-opacity, visible);
        transition: visibility 0.15s var(--_loading-indicator-delay);
      }

      svg, img, ::slotted(svg), ::slotted(img) {
        width: var(--media-loading-indicator-icon-width);
        height: var(--media-loading-indicator-icon-height, 100px);
        fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
        vertical-align: middle;
      }
    </style>

    <slot name="icon">${GCe}</slot>
    <div id="status" role="status" aria-live="polite">${Rt("media loading")}</div>
  `}class _P extends Ne.HTMLElement{constructor(){if(super(),_B(this,yo,void 0),_B(this,_x,OX),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}}static get observedAttributes(){return[En.MEDIA_CONTROLLER,ue.MEDIA_PAUSED,ue.MEDIA_LOADING,Sb.LOADING_DELAY]}attributeChangedCallback(e,t,r){var s,i,a,o,l;e===Sb.LOADING_DELAY&&t!==r?this.loadingDelay=Number(r):e===En.MEDIA_CONTROLLER&&(t&&((i=(s=Mp(this,yo))==null?void 0:s.unassociateElement)==null||i.call(s,this),Op(this,yo,null)),r&&this.isConnected&&(Op(this,yo,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=Mp(this,yo))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,r;const s=this.getAttribute(En.MEDIA_CONTROLLER);s&&(Op(this,yo,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(r=(t=Mp(this,yo))==null?void 0:t.associateElement)==null||r.call(t,this))}disconnectedCallback(){var e,t;(t=(e=Mp(this,yo))==null?void 0:e.unassociateElement)==null||t.call(e,this),Op(this,yo,null)}get loadingDelay(){return Mp(this,_x)}set loadingDelay(e){Op(this,_x,e);const{style:t}=Or(this.shadowRoot,":host");t.setProperty("--_loading-indicator-delay",`var(--media-loading-indicator-transition-delay, ${e}ms)`)}get mediaPaused(){return hn(this,ue.MEDIA_PAUSED)}set mediaPaused(e){fn(this,ue.MEDIA_PAUSED,e)}get mediaLoading(){return hn(this,ue.MEDIA_LOADING)}set mediaLoading(e){fn(this,ue.MEDIA_LOADING,e)}get mediaController(){return pr(this,En.MEDIA_CONTROLLER)}set mediaController(e){gr(this,En.MEDIA_CONTROLLER,e)}get noAutohide(){return hn(this,Sb.NO_AUTOHIDE)}set noAutohide(e){fn(this,Sb.NO_AUTOHIDE,e)}}yo=new WeakMap;_x=new WeakMap;_P.shadowRootOptions={mode:"open"};_P.getTemplateHTML=qCe;Ne.customElements.get("media-loading-indicator")||Ne.customElements.define("media-loading-indicator",_P);const WCe=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M16.5 12A4.5 4.5 0 0 0 14 8v2.18l2.45 2.45a4.22 4.22 0 0 0 .05-.63Zm2.5 0a6.84 6.84 0 0 1-.54 2.64L20 16.15A8.8 8.8 0 0 0 21 12a9 9 0 0 0-7-8.77v2.06A7 7 0 0 1 19 12ZM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25A6.92 6.92 0 0 1 14 18.7v2.06A9 9 0 0 0 17.69 19l2 2.05L21 19.73l-9-9L4.27 3ZM12 4 9.91 6.09 12 8.18V4Z"/>
</svg>`,AB=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4Z"/>
</svg>`,KCe=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4ZM14 3.23v2.06a7 7 0 0 1 0 13.42v2.06a9 9 0 0 0 0-17.54Z"/>
</svg>`;function YCe(n){return`
    <style>
      :host(:not([${ue.MEDIA_VOLUME_LEVEL}])) slot[name=icon] slot:not([name=high]),
      :host([${ue.MEDIA_VOLUME_LEVEL}=high]) slot[name=icon] slot:not([name=high]) {
        display: none !important;
      }

      :host([${ue.MEDIA_VOLUME_LEVEL}=off]) slot[name=icon] slot:not([name=off]) {
        display: none !important;
      }

      :host([${ue.MEDIA_VOLUME_LEVEL}=low]) slot[name=icon] slot:not([name=low]) {
        display: none !important;
      }

      :host([${ue.MEDIA_VOLUME_LEVEL}=medium]) slot[name=icon] slot:not([name=medium]) {
        display: none !important;
      }

      :host(:not([${ue.MEDIA_VOLUME_LEVEL}=off])) slot[name=tooltip-unmute],
      :host([${ue.MEDIA_VOLUME_LEVEL}=off]) slot[name=tooltip-mute] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="off">${WCe}</slot>
      <slot name="low">${AB}</slot>
      <slot name="medium">${AB}</slot>
      <slot name="high">${KCe}</slot>
    </slot>
  `}function XCe(){return`
    <slot name="tooltip-mute">${Rt("Mute")}</slot>
    <slot name="tooltip-unmute">${Rt("Unmute")}</slot>
  `}const RB=n=>{const e=n.mediaVolumeLevel==="off",t=Rt(e?"unmute":"mute");n.setAttribute("aria-label",t)};class AP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_VOLUME_LEVEL]}connectedCallback(){super.connectedCallback(),RB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_VOLUME_LEVEL&&RB(this)}get mediaVolumeLevel(){return pr(this,ue.MEDIA_VOLUME_LEVEL)}set mediaVolumeLevel(e){gr(this,ue.MEDIA_VOLUME_LEVEL,e)}handleClick(){const e=this.mediaVolumeLevel==="off"?Et.MEDIA_UNMUTE_REQUEST:Et.MEDIA_MUTE_REQUEST;this.dispatchEvent(new Ne.CustomEvent(e,{composed:!0,bubbles:!0}))}}AP.getSlotTemplateHTML=YCe;AP.getTooltipContentHTML=XCe;Ne.customElements.get("media-mute-button")||Ne.customElements.define("media-mute-button",AP);const CB=`<svg aria-hidden="true" viewBox="0 0 28 24">
  <path d="M24 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Zm-1 16H5V5h18v14Zm-3-8h-7v5h7v-5Z"/>
</svg>`;function QCe(n){return`
    <style>
      :host([${ue.MEDIA_IS_PIP}]) slot[name=icon] slot:not([name=exit]) {
        display: none !important;
      }

      :host(:not([${ue.MEDIA_IS_PIP}])) slot[name=icon] slot:not([name=enter]) {
        display: none !important;
      }

      :host([${ue.MEDIA_IS_PIP}]) slot[name=tooltip-enter],
      :host(:not([${ue.MEDIA_IS_PIP}])) slot[name=tooltip-exit] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="enter">${CB}</slot>
      <slot name="exit">${CB}</slot>
    </slot>
  `}function ZCe(){return`
    <slot name="tooltip-enter">${Rt("Enter picture in picture mode")}</slot>
    <slot name="tooltip-exit">${Rt("Exit picture in picture mode")}</slot>
  `}const kB=n=>{const e=n.mediaIsPip?Rt("exit picture in picture mode"):Rt("enter picture in picture mode");n.setAttribute("aria-label",e)};class RP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_IS_PIP,ue.MEDIA_PIP_UNAVAILABLE]}connectedCallback(){super.connectedCallback(),kB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_IS_PIP&&kB(this)}get mediaPipUnavailable(){return pr(this,ue.MEDIA_PIP_UNAVAILABLE)}set mediaPipUnavailable(e){gr(this,ue.MEDIA_PIP_UNAVAILABLE,e)}get mediaIsPip(){return hn(this,ue.MEDIA_IS_PIP)}set mediaIsPip(e){fn(this,ue.MEDIA_IS_PIP,e)}handleClick(){const e=this.mediaIsPip?Et.MEDIA_EXIT_PIP_REQUEST:Et.MEDIA_ENTER_PIP_REQUEST;this.dispatchEvent(new Ne.CustomEvent(e,{composed:!0,bubbles:!0}))}}RP.getSlotTemplateHTML=QCe;RP.getTooltipContentHTML=ZCe;Ne.customElements.get("media-pip-button")||Ne.customElements.define("media-pip-button",RP);var JCe=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Oh=(n,e,t)=>(JCe(n,e,"read from private field"),t?t.call(n):e.get(n)),eke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Pc;const KA={RATES:"rates"},tke=[1,1.2,1.5,1.7,2],sg=1;function nke(n){return`
    <style>
      :host {
        min-width: 5ch;
        padding: var(--media-button-padding, var(--media-control-padding, 10px 5px));
      }
    </style>
    <slot name="icon">${n.mediaplaybackrate||sg}x</slot>
  `}function rke(){return Rt("Playback rate")}class CP extends Fs{constructor(){var e;super(),eke(this,Pc,new sX(this,KA.RATES,{defaultValue:tke})),this.container=this.shadowRoot.querySelector('slot[name="icon"]'),this.container.innerHTML=`${(e=this.mediaPlaybackRate)!=null?e:sg}x`}static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_PLAYBACK_RATE,KA.RATES]}attributeChangedCallback(e,t,r){if(super.attributeChangedCallback(e,t,r),e===KA.RATES&&(Oh(this,Pc).value=r),e===ue.MEDIA_PLAYBACK_RATE){const s=r?+r:Number.NaN,i=Number.isNaN(s)?sg:s;this.container.innerHTML=`${i}x`,this.setAttribute("aria-label",Rt("Playback rate {playbackRate}",{playbackRate:i}))}}get rates(){return Oh(this,Pc)}set rates(e){e?Array.isArray(e)?Oh(this,Pc).value=e.join(" "):typeof e=="string"&&(Oh(this,Pc).value=e):Oh(this,Pc).value=""}get mediaPlaybackRate(){return mr(this,ue.MEDIA_PLAYBACK_RATE,sg)}set mediaPlaybackRate(e){as(this,ue.MEDIA_PLAYBACK_RATE,e)}handleClick(){var e,t;const r=Array.from(Oh(this,Pc).values(),a=>+a).sort((a,o)=>a-o),s=(t=(e=r.find(a=>a>this.mediaPlaybackRate))!=null?e:r[0])!=null?t:sg,i=new Ne.CustomEvent(Et.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:s});this.dispatchEvent(i)}}Pc=new WeakMap;CP.getSlotTemplateHTML=nke;CP.getTooltipContentHTML=rke;Ne.customElements.get("media-playback-rate-button")||Ne.customElements.define("media-playback-rate-button",CP);const ske=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="m6 21 15-9L6 3v18Z"/>
</svg>`,ike=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M6 20h4V4H6v16Zm8-16v16h4V4h-4Z"/>
</svg>`;function ake(n){return`
    <style>
      :host([${ue.MEDIA_PAUSED}]) slot[name=pause],
      :host(:not([${ue.MEDIA_PAUSED}])) slot[name=play] {
        display: none !important;
      }

      :host([${ue.MEDIA_PAUSED}]) slot[name=tooltip-pause],
      :host(:not([${ue.MEDIA_PAUSED}])) slot[name=tooltip-play] {
        display: none;
      }
    </style>

    <slot name="icon">
      <slot name="play">${ske}</slot>
      <slot name="pause">${ike}</slot>
    </slot>
  `}function oke(){return`
    <slot name="tooltip-play">${Rt("Play")}</slot>
    <slot name="tooltip-pause">${Rt("Pause")}</slot>
  `}const IB=n=>{const e=n.mediaPaused?Rt("play"):Rt("pause");n.setAttribute("aria-label",e)};class kP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_PAUSED,ue.MEDIA_ENDED]}connectedCallback(){super.connectedCallback(),IB(this)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),(e===ue.MEDIA_PAUSED||e===ue.MEDIA_LANG)&&IB(this)}get mediaPaused(){return hn(this,ue.MEDIA_PAUSED)}set mediaPaused(e){fn(this,ue.MEDIA_PAUSED,e)}handleClick(){const e=this.mediaPaused?Et.MEDIA_PLAY_REQUEST:Et.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Ne.CustomEvent(e,{composed:!0,bubbles:!0}))}}kP.getSlotTemplateHTML=ake;kP.getTooltipContentHTML=oke;Ne.customElements.get("media-play-button")||Ne.customElements.define("media-play-button",kP);const oo={PLACEHOLDER_SRC:"placeholdersrc",SRC:"src"};function lke(n){return`
    <style>
      :host {
        pointer-events: none;
        display: var(--media-poster-image-display, inline-block);
        box-sizing: border-box;
      }

      img {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        background-repeat: no-repeat;
        background-position: var(--media-poster-image-background-position, var(--media-object-position, center));
        background-size: var(--media-poster-image-background-size, var(--media-object-fit, contain));
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, center);
      }
    </style>

    <img part="poster img" aria-hidden="true" id="image"/>
  `}const cke=n=>{n.style.removeProperty("background-image")},uke=(n,e)=>{n.style["background-image"]=`url('${e}')`};class IP extends Ne.HTMLElement{static get observedAttributes(){return[oo.PLACEHOLDER_SRC,oo.SRC]}constructor(){if(super(),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}this.image=this.shadowRoot.querySelector("#image")}attributeChangedCallback(e,t,r){e===oo.SRC&&(r==null?this.image.removeAttribute(oo.SRC):this.image.setAttribute(oo.SRC,r)),e===oo.PLACEHOLDER_SRC&&(r==null?cke(this.image):uke(this.image,r))}get placeholderSrc(){return pr(this,oo.PLACEHOLDER_SRC)}set placeholderSrc(e){gr(this,oo.SRC,e)}get src(){return pr(this,oo.SRC)}set src(e){gr(this,oo.SRC,e)}}IP.shadowRootOptions={mode:"open"};IP.getTemplateHTML=lke;Ne.customElements.get("media-poster-image")||Ne.customElements.define("media-poster-image",IP);var NX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},dke=(n,e,t)=>(NX(n,e,"read from private field"),t?t.call(n):e.get(n)),hke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},fke=(n,e,t,r)=>(NX(n,e,"write to private field"),e.set(n,t),t),Ax;class mke extends vu{constructor(){super(),hke(this,Ax,void 0),fke(this,Ax,this.shadowRoot.querySelector("slot"))}static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_PREVIEW_CHAPTER,ue.MEDIA_LANG]}attributeChangedCallback(e,t,r){if(super.attributeChangedCallback(e,t,r),(e===ue.MEDIA_PREVIEW_CHAPTER||e===ue.MEDIA_LANG)&&r!==t&&r!=null)if(dke(this,Ax).textContent=r,r!==""){const s=Rt("chapter: {chapterName}",{chapterName:r});this.setAttribute("aria-valuetext",s)}else this.removeAttribute("aria-valuetext")}get mediaPreviewChapter(){return pr(this,ue.MEDIA_PREVIEW_CHAPTER)}set mediaPreviewChapter(e){gr(this,ue.MEDIA_PREVIEW_CHAPTER,e)}}Ax=new WeakMap;Ne.customElements.get("media-preview-chapter-display")||Ne.customElements.define("media-preview-chapter-display",mke);var jX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Tb=(n,e,t)=>(jX(n,e,"read from private field"),t?t.call(n):e.get(n)),pke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},_b=(n,e,t,r)=>(jX(n,e,"write to private field"),e.set(n,t),t),bo;function gke(n){return`
    <style>
      :host {
        box-sizing: border-box;
        display: var(--media-control-display, var(--media-preview-thumbnail-display, inline-block));
        overflow: hidden;
      }

      img {
        display: none;
        position: relative;
      }
    </style>
    <img crossorigin loading="eager" decoding="async">
  `}class YS extends Ne.HTMLElement{constructor(){if(super(),pke(this,bo,void 0),!this.shadowRoot){this.attachShadow(this.constructor.shadowRootOptions);const e=Ja(this.attributes);this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(e)}}static get observedAttributes(){return[En.MEDIA_CONTROLLER,ue.MEDIA_PREVIEW_IMAGE,ue.MEDIA_PREVIEW_COORDS]}connectedCallback(){var e,t,r;const s=this.getAttribute(En.MEDIA_CONTROLLER);s&&(_b(this,bo,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(r=(t=Tb(this,bo))==null?void 0:t.associateElement)==null||r.call(t,this))}disconnectedCallback(){var e,t;(t=(e=Tb(this,bo))==null?void 0:e.unassociateElement)==null||t.call(e,this),_b(this,bo,null)}attributeChangedCallback(e,t,r){var s,i,a,o,l;[ue.MEDIA_PREVIEW_IMAGE,ue.MEDIA_PREVIEW_COORDS].includes(e)&&this.update(),e===En.MEDIA_CONTROLLER&&(t&&((i=(s=Tb(this,bo))==null?void 0:s.unassociateElement)==null||i.call(s,this),_b(this,bo,null)),r&&this.isConnected&&(_b(this,bo,(a=this.getRootNode())==null?void 0:a.getElementById(r)),(l=(o=Tb(this,bo))==null?void 0:o.associateElement)==null||l.call(o,this)))}get mediaPreviewImage(){return pr(this,ue.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){gr(this,ue.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewCoords(){const e=this.getAttribute(ue.MEDIA_PREVIEW_COORDS);if(e)return e.split(/\s+/).map(t=>+t)}set mediaPreviewCoords(e){if(!e){this.removeAttribute(ue.MEDIA_PREVIEW_COORDS);return}this.setAttribute(ue.MEDIA_PREVIEW_COORDS,e.join(" "))}update(){const e=this.mediaPreviewCoords,t=this.mediaPreviewImage;if(!(e&&t))return;const[r,s,i,a]=e,o=t.split("#")[0],l=getComputedStyle(this),{maxWidth:c,maxHeight:u,minWidth:f,minHeight:m}=l,g=Math.min(parseInt(c)/i,parseInt(u)/a),y=Math.max(parseInt(f)/i,parseInt(m)/a),b=g<1,x=b?g:y>1?y:1,{style:S}=Or(this.shadowRoot,":host"),T=Or(this.shadowRoot,"img").style,_=this.shadowRoot.querySelector("img"),R=b?"min":"max";S.setProperty(`${R}-width`,"initial","important"),S.setProperty(`${R}-height`,"initial","important"),S.width=`${i*x}px`,S.height=`${a*x}px`;const I=()=>{T.width=`${this.imgWidth*x}px`,T.height=`${this.imgHeight*x}px`,T.display="block"};_.src!==o&&(_.onload=()=>{this.imgWidth=_.naturalWidth,this.imgHeight=_.naturalHeight,I()},_.src=o,I()),I(),T.transform=`translate(-${r*x}px, -${s*x}px)`}}bo=new WeakMap;YS.shadowRootOptions={mode:"open"};YS.getTemplateHTML=gke;Ne.customElements.get("media-preview-thumbnail")||Ne.customElements.define("media-preview-thumbnail",YS);var LB=YS,FX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},DB=(n,e,t)=>(FX(n,e,"read from private field"),t?t.call(n):e.get(n)),vke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},yke=(n,e,t,r)=>(FX(n,e,"write to private field"),e.set(n,t),t),ig;class bke extends vu{constructor(){super(),vke(this,ig,void 0),yke(this,ig,this.shadowRoot.querySelector("slot")),DB(this,ig).textContent=Xc(0)}static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_PREVIEW_TIME]}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===ue.MEDIA_PREVIEW_TIME&&r!=null&&(DB(this,ig).textContent=Xc(parseFloat(r)))}get mediaPreviewTime(){return mr(this,ue.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){as(this,ue.MEDIA_PREVIEW_TIME,e)}}ig=new WeakMap;Ne.customElements.get("media-preview-time-display")||Ne.customElements.define("media-preview-time-display",bke);const Nh={SEEK_OFFSET:"seekoffset"},YA=30,xke=n=>`
  <svg aria-hidden="true" viewBox="0 0 20 24">
    <defs>
      <style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style>
    </defs>
    <text class="text value" transform="translate(2.18 19.87)">${n}</text>
    <path d="M10 6V3L4.37 7 10 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 10 6Z"/>
  </svg>`;function wke(n,e){return`
    <slot name="icon">${xke(e.seekOffset)}</slot>
  `}function Eke(){return Rt("Seek backward")}const Ske=0;class LP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_CURRENT_TIME,Nh.SEEK_OFFSET]}connectedCallback(){super.connectedCallback(),this.seekOffset=mr(this,Nh.SEEK_OFFSET,YA)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===Nh.SEEK_OFFSET&&(this.seekOffset=mr(this,Nh.SEEK_OFFSET,YA))}get seekOffset(){return mr(this,Nh.SEEK_OFFSET,YA)}set seekOffset(e){as(this,Nh.SEEK_OFFSET,e),this.setAttribute("aria-label",Rt("seek back {seekOffset} seconds",{seekOffset:this.seekOffset})),KY(YY(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return mr(this,ue.MEDIA_CURRENT_TIME,Ske)}set mediaCurrentTime(e){as(this,ue.MEDIA_CURRENT_TIME,e)}handleClick(){const e=Math.max(this.mediaCurrentTime-this.seekOffset,0),t=new Ne.CustomEvent(Et.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}LP.getSlotTemplateHTML=wke;LP.getTooltipContentHTML=Eke;Ne.customElements.get("media-seek-backward-button")||Ne.customElements.define("media-seek-backward-button",LP);const jh={SEEK_OFFSET:"seekoffset"},XA=30,Tke=n=>`
  <svg aria-hidden="true" viewBox="0 0 20 24">
    <defs>
      <style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style>
    </defs>
    <text class="text value" transform="translate(8.9 19.87)">${n}</text>
    <path d="M10 6V3l5.61 4L10 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 10 6Z"/>
  </svg>`;function _ke(n,e){return`
    <slot name="icon">${Tke(e.seekOffset)}</slot>
  `}function Ake(){return Rt("Seek forward")}const Rke=0;class DP extends Fs{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_CURRENT_TIME,jh.SEEK_OFFSET]}connectedCallback(){super.connectedCallback(),this.seekOffset=mr(this,jh.SEEK_OFFSET,XA)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),e===jh.SEEK_OFFSET&&(this.seekOffset=mr(this,jh.SEEK_OFFSET,XA))}get seekOffset(){return mr(this,jh.SEEK_OFFSET,XA)}set seekOffset(e){as(this,jh.SEEK_OFFSET,e),this.setAttribute("aria-label",Rt("seek forward {seekOffset} seconds",{seekOffset:this.seekOffset})),KY(YY(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return mr(this,ue.MEDIA_CURRENT_TIME,Rke)}set mediaCurrentTime(e){as(this,ue.MEDIA_CURRENT_TIME,e)}handleClick(){const e=this.mediaCurrentTime+this.seekOffset,t=new Ne.CustomEvent(Et.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}DP.getSlotTemplateHTML=_ke;DP.getTooltipContentHTML=Ake;Ne.customElements.get("media-seek-forward-button")||Ne.customElements.define("media-seek-forward-button",DP);var UX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},QA=(n,e,t)=>(UX(n,e,"read from private field"),t?t.call(n):e.get(n)),Cke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},kke=(n,e,t,r)=>(UX(n,e,"write to private field"),e.set(n,t),t),Xh;const Yu={REMAINING:"remaining",SHOW_DURATION:"showduration",NO_TOGGLE:"notoggle"},PB=[...Object.values(Yu),ue.MEDIA_CURRENT_TIME,ue.MEDIA_DURATION,ue.MEDIA_SEEKABLE],MB=["Enter"," "],Ike="&nbsp;/&nbsp;",II=(n,{timesSep:e=Ike}={})=>{var t,r;const s=(t=n.mediaCurrentTime)!=null?t:0,[,i]=(r=n.mediaSeekable)!=null?r:[];let a=0;Number.isFinite(n.mediaDuration)?a=n.mediaDuration:Number.isFinite(i)&&(a=i);const o=n.remaining?Xc(0-(a-s)):Xc(s);return n.showDuration?`${o}${e}${Xc(a)}`:o},Lke="video not loaded, unknown time.",Dke=n=>{var e;const t=n.mediaCurrentTime,[,r]=(e=n.mediaSeekable)!=null?e:[];let s=null;if(Number.isFinite(n.mediaDuration)?s=n.mediaDuration:Number.isFinite(r)&&(s=r),t==null||s===null){n.setAttribute("aria-valuetext",Lke);return}const i=n.remaining?Pg(0-(s-t)):Pg(t);if(!n.showDuration){n.setAttribute("aria-valuetext",i);return}const a=Pg(s),o=`${i} of ${a}`;n.setAttribute("aria-valuetext",o)};function Pke(n,e){return`
    <slot>${II(e)}</slot>
  `}class $X extends vu{constructor(){super(),Cke(this,Xh,void 0),kke(this,Xh,this.shadowRoot.querySelector("slot")),QA(this,Xh).innerHTML=`${II(this)}`}static get observedAttributes(){return[...super.observedAttributes,...PB,"disabled"]}connectedCallback(){const{style:e}=Or(this.shadowRoot,":host(:hover:not([notoggle]))");e.setProperty("cursor","var(--media-cursor, pointer)"),e.setProperty("background","var(--media-control-hover-background, rgba(50 50 70 / .7))"),this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","progressbar"),this.setAttribute("aria-label",Rt("playback time"));const t=r=>{const{key:s}=r;if(!MB.includes(s)){this.removeEventListener("keyup",t);return}this.toggleTimeDisplay()};this.addEventListener("keydown",r=>{const{metaKey:s,altKey:i,key:a}=r;if(s||i||!MB.includes(a)){this.removeEventListener("keyup",t);return}this.addEventListener("keyup",t)}),this.addEventListener("click",this.toggleTimeDisplay),super.connectedCallback()}toggleTimeDisplay(){this.noToggle||(this.hasAttribute("remaining")?this.removeAttribute("remaining"):this.setAttribute("remaining",""))}disconnectedCallback(){this.disable(),super.disconnectedCallback()}attributeChangedCallback(e,t,r){PB.includes(e)?this.update():e==="disabled"&&r!==t&&(r==null?this.enable():this.disable()),super.attributeChangedCallback(e,t,r)}enable(){this.tabIndex=0}disable(){this.tabIndex=-1}get remaining(){return hn(this,Yu.REMAINING)}set remaining(e){fn(this,Yu.REMAINING,e)}get showDuration(){return hn(this,Yu.SHOW_DURATION)}set showDuration(e){fn(this,Yu.SHOW_DURATION,e)}get noToggle(){return hn(this,Yu.NO_TOGGLE)}set noToggle(e){fn(this,Yu.NO_TOGGLE,e)}get mediaDuration(){return mr(this,ue.MEDIA_DURATION)}set mediaDuration(e){as(this,ue.MEDIA_DURATION,e)}get mediaCurrentTime(){return mr(this,ue.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){as(this,ue.MEDIA_CURRENT_TIME,e)}get mediaSeekable(){const e=this.getAttribute(ue.MEDIA_SEEKABLE);if(e)return e.split(":").map(t=>+t)}set mediaSeekable(e){if(e==null){this.removeAttribute(ue.MEDIA_SEEKABLE);return}this.setAttribute(ue.MEDIA_SEEKABLE,e.join(":"))}update(){const e=II(this);Dke(this),e!==QA(this,Xh).innerHTML&&(QA(this,Xh).innerHTML=e)}}Xh=new WeakMap;$X.getSlotTemplateHTML=Pke;Ne.customElements.get("media-time-display")||Ne.customElements.define("media-time-display",$X);var BX=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Qr=(n,e,t)=>(BX(n,e,"read from private field"),e.get(n)),lo=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Ci=(n,e,t,r)=>(BX(n,e,"write to private field"),e.set(n,t),t),Mke=(n,e,t,r)=>({set _(s){Ci(n,e,s)},get _(){return Qr(n,e)}}),Qh,Rx,Zh,ag,Cx,kx,Ix,Jh,Xu,Lx;class Oke{constructor(e,t,r){lo(this,Qh,void 0),lo(this,Rx,void 0),lo(this,Zh,void 0),lo(this,ag,void 0),lo(this,Cx,void 0),lo(this,kx,void 0),lo(this,Ix,void 0),lo(this,Jh,void 0),lo(this,Xu,0),lo(this,Lx,(s=performance.now())=>{Ci(this,Xu,requestAnimationFrame(Qr(this,Lx))),Ci(this,ag,performance.now()-Qr(this,Zh));const i=1e3/this.fps;if(Qr(this,ag)>i){Ci(this,Zh,s-Qr(this,ag)%i);const a=1e3/((s-Qr(this,Rx))/++Mke(this,Cx)._),o=(s-Qr(this,kx))/1e3/this.duration;let l=Qr(this,Ix)+o*this.playbackRate;l-Qr(this,Qh).valueAsNumber>0?Ci(this,Jh,this.playbackRate/this.duration/a):(Ci(this,Jh,.995*Qr(this,Jh)),l=Qr(this,Qh).valueAsNumber+Qr(this,Jh)),this.callback(l)}}),Ci(this,Qh,e),this.callback=t,this.fps=r}start(){Qr(this,Xu)===0&&(Ci(this,Zh,performance.now()),Ci(this,Rx,Qr(this,Zh)),Ci(this,Cx,0),Qr(this,Lx).call(this))}stop(){Qr(this,Xu)!==0&&(cancelAnimationFrame(Qr(this,Xu)),Ci(this,Xu,0))}update({start:e,duration:t,playbackRate:r}){const s=e-Qr(this,Qh).valueAsNumber,i=Math.abs(t-this.duration);(s>0||s<-.03||i>=.5)&&this.callback(e),Ci(this,Ix,e),Ci(this,kx,performance.now()),this.duration=t,this.playbackRate=r}}Qh=new WeakMap;Rx=new WeakMap;Zh=new WeakMap;ag=new WeakMap;Cx=new WeakMap;kx=new WeakMap;Ix=new WeakMap;Jh=new WeakMap;Xu=new WeakMap;Lx=new WeakMap;var PP=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Br=(n,e,t)=>(PP(n,e,"read from private field"),t?t.call(n):e.get(n)),Yr=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},xo=(n,e,t,r)=>(PP(n,e,"write to private field"),e.set(n,t),t),Rs=(n,e,t)=>(PP(n,e,"access private method"),t),ef,hd,SE,Ng,TE,Dx,Iv,Lv,tf,nf,og,MP,HX,LI,_E,OP,AE,NP,RE,jP,DI,VX,Dv,CE,PI,zX;const Nke="video not loaded, unknown time.",jke=n=>{const e=n.range,t=Pg(+GX(n)),r=Pg(+n.mediaSeekableEnd),s=t&&r?`${t} of ${r}`:Nke;e.setAttribute("aria-valuetext",s)};function Fke(n){return`
    ${ym.getTemplateHTML(n)}
    <style>
      :host {
        --media-box-border-radius: 4px;
        --media-box-padding-left: 10px;
        --media-box-padding-right: 10px;
        --media-preview-border-radius: var(--media-box-border-radius);
        --media-box-arrow-offset: var(--media-box-border-radius);
        --_control-background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
        --_preview-background: var(--media-preview-background, var(--_control-background));

        
        contain: layout;
      }

      #buffered {
        background: var(--media-time-range-buffered-color, rgb(255 255 255 / .4));
        position: absolute;
        height: 100%;
        will-change: width;
      }

      #preview-rail,
      #current-rail {
        width: 100%;
        position: absolute;
        left: 0;
        bottom: 100%;
        pointer-events: none;
        will-change: transform;
      }

      [part~="box"] {
        width: min-content;
        
        position: absolute;
        bottom: 100%;
        flex-direction: column;
        align-items: center;
        transform: translateX(-50%);
      }

      [part~="current-box"] {
        display: var(--media-current-box-display, var(--media-box-display, flex));
        margin: var(--media-current-box-margin, var(--media-box-margin, 0 0 5px));
        visibility: hidden;
      }

      [part~="preview-box"] {
        display: var(--media-preview-box-display, var(--media-box-display, flex));
        margin: var(--media-preview-box-margin, var(--media-box-margin, 0 0 5px));
        transition-property: var(--media-preview-transition-property, visibility, opacity);
        transition-duration: var(--media-preview-transition-duration-out, .25s);
        transition-delay: var(--media-preview-transition-delay-out, 0s);
        visibility: hidden;
        opacity: 0;
      }

      :host(:is([${ue.MEDIA_PREVIEW_IMAGE}], [${ue.MEDIA_PREVIEW_TIME}])[dragging]) [part~="preview-box"] {
        transition-duration: var(--media-preview-transition-duration-in, .5s);
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        visibility: visible;
        opacity: 1;
      }

      @media (hover: hover) {
        :host(:is([${ue.MEDIA_PREVIEW_IMAGE}], [${ue.MEDIA_PREVIEW_TIME}]):hover) [part~="preview-box"] {
          transition-duration: var(--media-preview-transition-duration-in, .5s);
          transition-delay: var(--media-preview-transition-delay-in, .25s);
          visibility: visible;
          opacity: 1;
        }
      }

      media-preview-thumbnail,
      ::slotted(media-preview-thumbnail) {
        visibility: hidden;
        
        transition: visibility 0s .25s;
        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
        background: var(--media-preview-thumbnail-background, var(--_preview-background));
        box-shadow: var(--media-preview-thumbnail-box-shadow, 0 0 4px rgb(0 0 0 / .2));
        max-width: var(--media-preview-thumbnail-max-width, 180px);
        max-height: var(--media-preview-thumbnail-max-height, 160px);
        min-width: var(--media-preview-thumbnail-min-width, 120px);
        min-height: var(--media-preview-thumbnail-min-height, 80px);
        border: var(--media-preview-thumbnail-border);
        border-radius: var(--media-preview-thumbnail-border-radius,
          var(--media-preview-border-radius) var(--media-preview-border-radius) 0 0);
      }

      :host([${ue.MEDIA_PREVIEW_IMAGE}][dragging]) media-preview-thumbnail,
      :host([${ue.MEDIA_PREVIEW_IMAGE}][dragging]) ::slotted(media-preview-thumbnail) {
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        visibility: visible;
      }

      @media (hover: hover) {
        :host([${ue.MEDIA_PREVIEW_IMAGE}]:hover) media-preview-thumbnail,
        :host([${ue.MEDIA_PREVIEW_IMAGE}]:hover) ::slotted(media-preview-thumbnail) {
          transition-delay: var(--media-preview-transition-delay-in, .25s);
          visibility: visible;
        }

        :host([${ue.MEDIA_PREVIEW_TIME}]:hover) {
          --media-time-range-hover-display: block;
        }
      }

      media-preview-chapter-display,
      ::slotted(media-preview-chapter-display) {
        font-size: var(--media-font-size, 13px);
        line-height: 17px;
        min-width: 0;
        visibility: hidden;
        
        transition: min-width 0s, border-radius 0s, margin 0s, padding 0s, visibility 0s;
        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
        background: var(--media-preview-chapter-background, var(--_preview-background));
        border-radius: var(--media-preview-chapter-border-radius,
          var(--media-preview-border-radius) var(--media-preview-border-radius)
          var(--media-preview-border-radius) var(--media-preview-border-radius));
        padding: var(--media-preview-chapter-padding, 3.5px 9px);
        margin: var(--media-preview-chapter-margin, 0 0 5px);
        text-shadow: var(--media-preview-chapter-text-shadow, 0 0 4px rgb(0 0 0 / .75));
      }

      :host([${ue.MEDIA_PREVIEW_IMAGE}]) media-preview-chapter-display,
      :host([${ue.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-chapter-display) {
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        border-radius: var(--media-preview-chapter-border-radius, 0);
        padding: var(--media-preview-chapter-padding, 3.5px 9px 0);
        margin: var(--media-preview-chapter-margin, 0);
        min-width: 100%;
      }

      media-preview-chapter-display[${ue.MEDIA_PREVIEW_CHAPTER}],
      ::slotted(media-preview-chapter-display[${ue.MEDIA_PREVIEW_CHAPTER}]) {
        visibility: visible;
      }

      media-preview-chapter-display:not([aria-valuetext]),
      ::slotted(media-preview-chapter-display:not([aria-valuetext])) {
        display: none;
      }

      media-preview-time-display,
      ::slotted(media-preview-time-display),
      media-time-display,
      ::slotted(media-time-display) {
        font-size: var(--media-font-size, 13px);
        line-height: 17px;
        min-width: 0;
        
        transition: min-width 0s, border-radius 0s;
        transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
        background: var(--media-preview-time-background, var(--_preview-background));
        border-radius: var(--media-preview-time-border-radius,
          var(--media-preview-border-radius) var(--media-preview-border-radius)
          var(--media-preview-border-radius) var(--media-preview-border-radius));
        padding: var(--media-preview-time-padding, 3.5px 9px);
        margin: var(--media-preview-time-margin, 0);
        text-shadow: var(--media-preview-time-text-shadow, 0 0 4px rgb(0 0 0 / .75));
        transform: translateX(min(
          max(calc(50% - var(--_box-width) / 2),
          calc(var(--_box-shift, 0))),
          calc(var(--_box-width) / 2 - 50%)
        ));
      }

      :host([${ue.MEDIA_PREVIEW_IMAGE}]) media-preview-time-display,
      :host([${ue.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-time-display) {
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        border-radius: var(--media-preview-time-border-radius,
          0 0 var(--media-preview-border-radius) var(--media-preview-border-radius));
        min-width: 100%;
      }

      :host([${ue.MEDIA_PREVIEW_TIME}]:hover) {
        --media-time-range-hover-display: block;
      }

      [part~="arrow"],
      ::slotted([part~="arrow"]) {
        display: var(--media-box-arrow-display, inline-block);
        transform: translateX(min(
          max(calc(50% - var(--_box-width) / 2 + var(--media-box-arrow-offset)),
          calc(var(--_box-shift, 0))),
          calc(var(--_box-width) / 2 - 50% - var(--media-box-arrow-offset))
        ));
        
        border-color: transparent;
        border-top-color: var(--media-box-arrow-background, var(--_control-background));
        border-width: var(--media-box-arrow-border-width,
          var(--media-box-arrow-height, 5px) var(--media-box-arrow-width, 6px) 0);
        border-style: solid;
        justify-content: center;
        height: 0;
      }
    </style>
    <div id="preview-rail">
      <slot name="preview" part="box preview-box">
        <media-preview-thumbnail>
          <template shadowrootmode="${LB.shadowRootOptions.mode}">
            ${LB.getTemplateHTML({})}
          </template>
        </media-preview-thumbnail>
        <media-preview-chapter-display></media-preview-chapter-display>
        <media-preview-time-display></media-preview-time-display>
        <slot name="preview-arrow"><div part="arrow"></div></slot>
      </slot>
    </div>
    <div id="current-rail">
      <slot name="current" part="box current-box">
        
      </slot>
    </div>
  `}const Ab=(n,e=n.mediaCurrentTime)=>{const t=Number.isFinite(n.mediaSeekableStart)?n.mediaSeekableStart:0,r=Number.isFinite(n.mediaDuration)?n.mediaDuration:n.mediaSeekableEnd;if(Number.isNaN(r))return 0;const s=(e-t)/(r-t);return Math.max(0,Math.min(s,1))},GX=(n,e=n.range.valueAsNumber)=>{const t=Number.isFinite(n.mediaSeekableStart)?n.mediaSeekableStart:0,r=Number.isFinite(n.mediaDuration)?n.mediaDuration:n.mediaSeekableEnd;return Number.isNaN(r)?0:e*(r-t)+t};class FP extends ym{constructor(){super(),Yr(this,nf),Yr(this,MP),Yr(this,_E),Yr(this,AE),Yr(this,RE),Yr(this,DI),Yr(this,Dv),Yr(this,PI),Yr(this,ef,void 0),Yr(this,hd,void 0),Yr(this,SE,void 0),Yr(this,Ng,void 0),Yr(this,TE,void 0),Yr(this,Dx,void 0),Yr(this,Iv,void 0),Yr(this,Lv,void 0),Yr(this,tf,void 0),Yr(this,LI,r=>{this.dragging||(aP(r)&&(this.range.valueAsNumber=r),this.updateBar())}),this.shadowRoot.querySelector("#track").insertAdjacentHTML("afterbegin",'<div id="buffered" part="buffered"></div>'),xo(this,SE,this.shadowRoot.querySelectorAll('[part~="box"]')),xo(this,TE,this.shadowRoot.querySelector('[part~="preview-box"]')),xo(this,Dx,this.shadowRoot.querySelector('[part~="current-box"]'));const t=getComputedStyle(this);xo(this,Iv,parseInt(t.getPropertyValue("--media-box-padding-left"))),xo(this,Lv,parseInt(t.getPropertyValue("--media-box-padding-right"))),xo(this,hd,new Oke(this.range,Br(this,LI),60))}static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_PAUSED,ue.MEDIA_DURATION,ue.MEDIA_SEEKABLE,ue.MEDIA_CURRENT_TIME,ue.MEDIA_PREVIEW_IMAGE,ue.MEDIA_PREVIEW_TIME,ue.MEDIA_PREVIEW_CHAPTER,ue.MEDIA_BUFFERED,ue.MEDIA_PLAYBACK_RATE,ue.MEDIA_LOADING,ue.MEDIA_ENDED]}connectedCallback(){var e;super.connectedCallback(),this.range.setAttribute("aria-label",Rt("seek")),Rs(this,nf,og).call(this),xo(this,ef,this.getRootNode()),(e=Br(this,ef))==null||e.addEventListener("transitionstart",this)}disconnectedCallback(){var e;super.disconnectedCallback(),Rs(this,nf,og).call(this),(e=Br(this,ef))==null||e.removeEventListener("transitionstart",this),xo(this,ef,null)}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),t!=r&&(e===ue.MEDIA_CURRENT_TIME||e===ue.MEDIA_PAUSED||e===ue.MEDIA_ENDED||e===ue.MEDIA_LOADING||e===ue.MEDIA_DURATION||e===ue.MEDIA_SEEKABLE?(Br(this,hd).update({start:Ab(this),duration:this.mediaSeekableEnd-this.mediaSeekableStart,playbackRate:this.mediaPlaybackRate}),Rs(this,nf,og).call(this),jke(this)):e===ue.MEDIA_BUFFERED&&this.updateBufferedBar(),(e===ue.MEDIA_DURATION||e===ue.MEDIA_SEEKABLE)&&(this.mediaChaptersCues=Br(this,tf),this.updateBar()))}get mediaChaptersCues(){return Br(this,tf)}set mediaChaptersCues(e){var t;xo(this,tf,e),this.updateSegments((t=Br(this,tf))==null?void 0:t.map(r=>({start:Ab(this,r.startTime),end:Ab(this,r.endTime)})))}get mediaPaused(){return hn(this,ue.MEDIA_PAUSED)}set mediaPaused(e){fn(this,ue.MEDIA_PAUSED,e)}get mediaLoading(){return hn(this,ue.MEDIA_LOADING)}set mediaLoading(e){fn(this,ue.MEDIA_LOADING,e)}get mediaDuration(){return mr(this,ue.MEDIA_DURATION)}set mediaDuration(e){as(this,ue.MEDIA_DURATION,e)}get mediaCurrentTime(){return mr(this,ue.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){as(this,ue.MEDIA_CURRENT_TIME,e)}get mediaPlaybackRate(){return mr(this,ue.MEDIA_PLAYBACK_RATE,1)}set mediaPlaybackRate(e){as(this,ue.MEDIA_PLAYBACK_RATE,e)}get mediaBuffered(){const e=this.getAttribute(ue.MEDIA_BUFFERED);return e?e.split(" ").map(t=>t.split(":").map(r=>+r)):[]}set mediaBuffered(e){if(!e){this.removeAttribute(ue.MEDIA_BUFFERED);return}const t=e.map(r=>r.join(":")).join(" ");this.setAttribute(ue.MEDIA_BUFFERED,t)}get mediaSeekable(){const e=this.getAttribute(ue.MEDIA_SEEKABLE);if(e)return e.split(":").map(t=>+t)}set mediaSeekable(e){if(e==null){this.removeAttribute(ue.MEDIA_SEEKABLE);return}this.setAttribute(ue.MEDIA_SEEKABLE,e.join(":"))}get mediaSeekableEnd(){var e;const[,t=this.mediaDuration]=(e=this.mediaSeekable)!=null?e:[];return t}get mediaSeekableStart(){var e;const[t=0]=(e=this.mediaSeekable)!=null?e:[];return t}get mediaPreviewImage(){return pr(this,ue.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){gr(this,ue.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewTime(){return mr(this,ue.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){as(this,ue.MEDIA_PREVIEW_TIME,e)}get mediaEnded(){return hn(this,ue.MEDIA_ENDED)}set mediaEnded(e){fn(this,ue.MEDIA_ENDED,e)}updateBar(){super.updateBar(),this.updateBufferedBar(),this.updateCurrentBox()}updateBufferedBar(){var e;const t=this.mediaBuffered;if(!t.length)return;let r;if(this.mediaEnded)r=1;else{const i=this.mediaCurrentTime,[,a=this.mediaSeekableStart]=(e=t.find(([o,l])=>o<=i&&i<=l))!=null?e:[];r=Ab(this,a)}const{style:s}=Or(this.shadowRoot,"#buffered");s.setProperty("width",`${r*100}%`)}updateCurrentBox(){if(!this.shadowRoot.querySelector('slot[name="current"]').assignedElements().length)return;const t=Or(this.shadowRoot,"#current-rail"),r=Or(this.shadowRoot,'[part~="current-box"]'),s=Rs(this,_E,OP).call(this,Br(this,Dx)),i=Rs(this,AE,NP).call(this,s,this.range.valueAsNumber),a=Rs(this,RE,jP).call(this,s,this.range.valueAsNumber);t.style.transform=`translateX(${i})`,t.style.setProperty("--_range-width",`${s.range.width}`),r.style.setProperty("--_box-shift",`${a}`),r.style.setProperty("--_box-width",`${s.box.width}px`),r.style.setProperty("visibility","initial")}handleEvent(e){switch(super.handleEvent(e),e.type){case"input":Rs(this,PI,zX).call(this);break;case"pointermove":Rs(this,DI,VX).call(this,e);break;case"pointerup":case"pointerleave":Rs(this,Dv,CE).call(this,null);break;case"transitionstart":vm(e.target,this)&&setTimeout(()=>Rs(this,nf,og).call(this),0);break}}}ef=new WeakMap;hd=new WeakMap;SE=new WeakMap;Ng=new WeakMap;TE=new WeakMap;Dx=new WeakMap;Iv=new WeakMap;Lv=new WeakMap;tf=new WeakMap;nf=new WeakSet;og=function(){Rs(this,MP,HX).call(this)?Br(this,hd).start():Br(this,hd).stop()};MP=new WeakSet;HX=function(){return this.isConnected&&!this.mediaPaused&&!this.mediaLoading&&!this.mediaEnded&&this.mediaSeekableEnd>0&&QY(this)};LI=new WeakMap;_E=new WeakSet;OP=function(n){var e;const r=((e=this.getAttribute("bounds")?p0(this,`#${this.getAttribute("bounds")}`):this.parentElement)!=null?e:this).getBoundingClientRect(),s=this.range.getBoundingClientRect(),i=n.offsetWidth,a=-(s.left-r.left-i/2),o=r.right-s.left-i/2;return{box:{width:i,min:a,max:o},bounds:r,range:s}};AE=new WeakSet;NP=function(n,e){let t=`${e*100}%`;const{width:r,min:s,max:i}=n.box;if(!r)return t;if(Number.isNaN(s)||(t=`max(${`calc(1 / var(--_range-width) * 100 * ${s}% + var(--media-box-padding-left))`}, ${t})`),!Number.isNaN(i)){const o=`calc(1 / var(--_range-width) * 100 * ${i}% - var(--media-box-padding-right))`;t=`min(${t}, ${o})`}return t};RE=new WeakSet;jP=function(n,e){const{width:t,min:r,max:s}=n.box,i=e*n.range.width;if(i<r+Br(this,Iv)){const a=n.range.left-n.bounds.left-Br(this,Iv);return`${i-t/2+a}px`}if(i>s-Br(this,Lv)){const a=n.bounds.right-n.range.right-Br(this,Lv);return`${i+t/2-a-n.range.width}px`}return 0};DI=new WeakSet;VX=function(n){const e=[...Br(this,SE)].some(u=>n.composedPath().includes(u));if(!this.dragging&&(e||!n.composedPath().includes(this))){Rs(this,Dv,CE).call(this,null);return}const t=this.mediaSeekableEnd;if(!t)return;const r=Or(this.shadowRoot,"#preview-rail"),s=Or(this.shadowRoot,'[part~="preview-box"]'),i=Rs(this,_E,OP).call(this,Br(this,TE));let a=(n.clientX-i.range.left)/i.range.width;a=Math.max(0,Math.min(1,a));const o=Rs(this,AE,NP).call(this,i,a),l=Rs(this,RE,jP).call(this,i,a);r.style.transform=`translateX(${o})`,r.style.setProperty("--_range-width",`${i.range.width}`),s.style.setProperty("--_box-shift",`${l}`),s.style.setProperty("--_box-width",`${i.box.width}px`);const c=Math.round(Br(this,Ng))-Math.round(a*t);Math.abs(c)<1&&a>.01&&a<.99||(xo(this,Ng,a*t),Rs(this,Dv,CE).call(this,Br(this,Ng)))};Dv=new WeakSet;CE=function(n){this.dispatchEvent(new Ne.CustomEvent(Et.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:n}))};PI=new WeakSet;zX=function(){Br(this,hd).stop();const n=GX(this);this.dispatchEvent(new Ne.CustomEvent(Et.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:n}))};FP.shadowRootOptions={mode:"open"};FP.getTemplateHTML=Fke;Ne.customElements.get("media-time-range")||Ne.customElements.define("media-time-range",FP);const Uke=1,$ke=n=>n.mediaMuted?0:n.mediaVolume,Bke=n=>`${Math.round(n*100)}%`;class Hke extends ym{static get observedAttributes(){return[...super.observedAttributes,ue.MEDIA_VOLUME,ue.MEDIA_MUTED,ue.MEDIA_VOLUME_UNAVAILABLE]}constructor(){super(),this.range.addEventListener("input",()=>{const e=this.range.value,t=new Ne.CustomEvent(Et.MEDIA_VOLUME_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)})}connectedCallback(){super.connectedCallback(),this.range.setAttribute("aria-label",Rt("volume"))}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),(e===ue.MEDIA_VOLUME||e===ue.MEDIA_MUTED)&&(this.range.valueAsNumber=$ke(this),this.range.setAttribute("aria-valuetext",Bke(this.range.valueAsNumber)),this.updateBar())}get mediaVolume(){return mr(this,ue.MEDIA_VOLUME,Uke)}set mediaVolume(e){as(this,ue.MEDIA_VOLUME,e)}get mediaMuted(){return hn(this,ue.MEDIA_MUTED)}set mediaMuted(e){fn(this,ue.MEDIA_MUTED,e)}get mediaVolumeUnavailable(){return pr(this,ue.MEDIA_VOLUME_UNAVAILABLE)}set mediaVolumeUnavailable(e){gr(this,ue.MEDIA_VOLUME_UNAVAILABLE,e)}}Ne.customElements.get("media-volume-range")||Ne.customElements.define("media-volume-range",Hke);const Vke="https://www.youtube.com/embed",zke="https://www.youtube-nocookie.com/embed",Gke="https://www.youtube.com/iframe_api",qke="YT",Wke="onYouTubeIframeAPIReady",OB=/(?:youtu\.be\/|youtube(?:-nocookie)?\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})/,Kke=/(?:youtu\.be\/|youtube(?:-nocookie)?\.com\/.*?[?&]list=)([\w_-]+)/;function NB(n,e={}){const t={src:qX(n,e),frameborder:0,width:"100%",height:"100%",allow:"accelerometer; fullscreen; autoplay; encrypted-media; gyroscope; picture-in-picture"};return e.config&&(t["data-config"]=JSON.stringify(e.config)),`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
        position: relative;
        min-width: 300px;
        min-height: 150px;
      }
      iframe {
        position: absolute;
        top: 0;
        left: 0;
      }
    </style>
    <iframe${Xke(t)}></iframe>
  `}function qX(n,e){if(!n.src)return;const t=n.src.includes("-nocookie")?zke:Vke,r={controls:n.controls===""?null:0,autoplay:n.autoplay,loop:n.loop,mute:n.muted,playsinline:n.playsinline,preload:n.preload??"metadata",enablejsapi:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1,...e.config};if(OB.test(n.src)){const o=n.src.match(OB),l=o&&o[1];return`${t}/${l}?${jB(r)}`}const s=n.src.match(Kke),a={listType:"playlist",list:s&&s[1],...r};return`${t}?${jB(a)}`}class Yke extends(globalThis.HTMLElement??class{}){static getTemplateHTML=NB;static shadowRootOptions={mode:"open"};static observedAttributes=["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src"];loadComplete=new eR;#e;#t;#n=0;#r=!1;#s;isLoaded=!1;#o=null;#i=null;constructor(){super(),this.#a("config")}get config(){return this.#i}set config(e){this.#i=e}async load(){if(this.#e)return;this.shadowRoot||this.attachShadow({mode:"open"});const e=!this.#t;this.#t&&(this.loadComplete=new eR,this.isLoaded=!1),this.#t=!0,await(this.#e=Promise.resolve()),this.#e=null,this.#n=0,this.dispatchEvent(new Event("emptied"));let t=this.api;if(this.api=null,!this.src){t?.destroy();return}this.dispatchEvent(new Event("loadstart"));let r=this.shadowRoot.querySelector("iframe"),s=Zke(this.attributes);e&&r&&(this.#i=JSON.parse(r.getAttribute("data-config")||"{}")),(!r?.src||r.src!==qX(s,this))&&(this.shadowRoot.innerHTML=NB(s,this),r=this.shadowRoot.querySelector("iframe"));const i=await Jke(Gke,qke,Wke);this.api=new i.Player(r,{events:{onReady:()=>{this.#n=1,this.dispatchEvent(new Event("loadedmetadata")),this.dispatchEvent(new Event("durationchange")),this.dispatchEvent(new Event("volumechange")),this.dispatchEvent(new Event("loadcomplete")),this.isLoaded=!0,this.loadComplete.resolve()},onError:u=>{console.error(u),this.#o={code:u.data,message:`YouTube iframe player error #${u.data}; visit https://developers.google.com/youtube/iframe_api_reference#onError for the full error message.`},this.dispatchEvent(new Event("error"))}}});let a=!1;this.api.addEventListener("onStateChange",u=>{var f;const m=u.data;if((m===i.PlayerState.PLAYING||m===i.PlayerState.BUFFERING)&&(a||(a=!0,this.dispatchEvent(new Event("play")))),m===i.PlayerState.PLAYING)this.seeking&&(this.#r=!1,(f=this.#s)==null||f.resolve(),this.dispatchEvent(new Event("seeked"))),this.#n=3,this.dispatchEvent(new Event("playing"));else if(m===i.PlayerState.PAUSED){const g=Math.abs(this.currentTime-o);!this.seeking&&g>.1&&(this.#r=!0,this.dispatchEvent(new Event("seeking"))),a=!1,this.dispatchEvent(new Event("pause"))}m===i.PlayerState.ENDED&&(a=!1,this.dispatchEvent(new Event("pause")),this.dispatchEvent(new Event("ended")),this.loop&&this.play())}),this.api.addEventListener("onPlaybackRateChange",()=>{this.dispatchEvent(new Event("ratechange"))}),this.api.addEventListener("onVolumeChange",()=>{this.dispatchEvent(new Event("volumechange"))}),this.api.addEventListener("onVideoProgress",()=>{this.dispatchEvent(new Event("timeupdate"))}),await this.loadComplete;let o=0;setInterval(()=>{var u;const f=Math.abs(this.currentTime-o),m=this.buffered.end(this.buffered.length-1);this.seeking&&m>.1?(this.#r=!1,(u=this.#s)==null||u.resolve(),this.dispatchEvent(new Event("seeked"))):!this.seeking&&f>.1&&(this.#r=!0,this.dispatchEvent(new Event("seeking"))),o=this.currentTime},50);let l;const c=setInterval(()=>{const u=this.buffered.end(this.buffered.length-1);u>=this.duration&&(clearInterval(c),this.#n=4),l!=u&&(l=u,this.dispatchEvent(new Event("progress")))},100)}async attributeChangedCallback(e,t,r){if(t!==r)switch(e){case"src":case"autoplay":case"controls":case"loop":case"playsinline":this.load()}}async play(){var e;return this.#s=null,await this.loadComplete,(e=this.api)==null||e.playVideo(),nIe(this)}async pause(){var e;return await this.loadComplete,(e=this.api)==null?void 0:e.pauseVideo()}get seeking(){return this.#r}get readyState(){return this.#n}get src(){return this.getAttribute("src")}set src(e){this.src!=e&&this.setAttribute("src",e)}get error(){return this.#o}get paused(){var e,t;return this.isLoaded?[-1,0,2,5].includes((t=(e=this.api)==null?void 0:e.getPlayerState)==null?void 0:t.call(e)):!this.autoplay}get duration(){var e,t;return((t=(e=this.api)==null?void 0:e.getDuration)==null?void 0:t.call(e))??NaN}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(e){this.autoplay!=e&&this.toggleAttribute("autoplay",!!e)}get buffered(){var e,t;if(!this.isLoaded)return tR();const r=((e=this.api)==null?void 0:e.getVideoLoadedFraction())*((t=this.api)==null?void 0:t.getDuration());return r>0?tR(0,r):tR()}get controls(){return this.hasAttribute("controls")}set controls(e){this.controls!=e&&this.toggleAttribute("controls",!!e)}get currentTime(){var e,t;return((t=(e=this.api)==null?void 0:e.getCurrentTime)==null?void 0:t.call(e))??0}set currentTime(e){this.currentTime!=e&&(this.#s=new eR,this.loadComplete.then(()=>{var t,r;(t=this.api)==null||t.seekTo(e,!0),this.paused&&((r=this.#s)==null||r.then(()=>{var s;this.#s&&((s=this.api)==null||s.pauseVideo())}))}))}set defaultMuted(e){this.defaultMuted!=e&&this.toggleAttribute("muted",!!e)}get defaultMuted(){return this.hasAttribute("muted")}get loop(){return this.hasAttribute("loop")}set loop(e){this.loop!=e&&this.toggleAttribute("loop",!!e)}set muted(e){this.muted!=e&&this.loadComplete.then(()=>{var t,r;e?(t=this.api)==null||t.mute():(r=this.api)==null||r.unMute()})}get muted(){var e,t;return this.isLoaded?(t=(e=this.api)==null?void 0:e.isMuted)==null?void 0:t.call(e):this.defaultMuted}get playbackRate(){var e,t;return((t=(e=this.api)==null?void 0:e.getPlaybackRate)==null?void 0:t.call(e))??1}set playbackRate(e){this.playbackRate!=e&&this.loadComplete.then(()=>{var t;(t=this.api)==null||t.setPlaybackRate(e)})}get playsInline(){return this.hasAttribute("playsinline")}set playsInline(e){this.playsInline!=e&&this.toggleAttribute("playsinline",!!e)}get poster(){return this.getAttribute("poster")}set poster(e){this.poster!=e&&this.setAttribute("poster",`${e}`)}set volume(e){this.volume!=e&&this.loadComplete.then(()=>{var t;(t=this.api)==null||t.setVolume(e*100)})}get volume(){var e;return this.isLoaded?((e=this.api)==null?void 0:e.getVolume())/100:1}#a(e){if(Object.prototype.hasOwnProperty.call(this,e)){const t=this[e];delete this[e],this[e]=t}}}function Xke(n){let e="";for(const t in n){const r=n[t];r===""?e+=` ${ZA(t)}`:e+=` ${ZA(t)}="${ZA(`${r}`)}"`}return e}function ZA(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/`/g,"&#x60;")}function jB(n){return String(new URLSearchParams(Qke(n)))}function Qke(n){let e={};for(let t in n){let r=n[t];r===!0||r===""?e[t]=1:r===!1?e[t]=0:r!=null&&(e[t]=r)}return e}function Zke(n){let e={};for(let t of n)e[t.name]=t.value;return e}const JA={};async function Jke(n,e,t){return JA[n]?JA[n]:self[e]?(await eIe(0),self[e]):JA[n]=new Promise(function(r,s){const i=document.createElement("script");i.src=n;const a=()=>r(self[e]);self[t]=a,i.onload=()=>!t,i.onerror=s,document.head.append(i)})}const eIe=n=>new Promise(e=>setTimeout(e,n));function tIe(n){return(...e)=>new Promise(t=>{n(...e,(...r)=>{r.length>1?t(r):t(r[0])})})}function nIe(n){return tIe((e,t)=>{let r;n.addEventListener(e,r=()=>{n.removeEventListener(e,r),t()})})("playing")}class eR extends Promise{constructor(e=()=>{}){let t,r;super((s,i)=>{e(s,i),t=s,r=i}),this.resolve=t,this.reject=r}}function tR(n,e){return Array.isArray(n)?nR(n):n==null||e==null||n===0&&e===0?nR([[0,0]]):nR([[n,e]])}function nR(n){return Object.defineProperties(n,{start:{value:e=>n[e][0]},end:{value:e=>n[e][1]}}),n}globalThis.customElements&&!globalThis.customElements.get("youtube-video")&&globalThis.customElements.define("youtube-video",Yke);const rIe=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],WX=["autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"];function sIe(n){return`
    <style>
      :host {
        display: inline-flex;
        line-height: 0;
        flex-direction: column;
        justify-content: end;
      }

      audio {
        width: 100%;
      }
    </style>
    <slot name="media">
      <audio${YX(n)}></audio>
    </slot>
    <slot></slot>
  `}function iIe(n){return`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot name="media">
      <video${YX(n)}></video>
    </slot>
    <slot></slot>
  `}function KX(n,{tag:e,is:t}){const r=globalThis.document?.createElement?.(e,{is:t}),s=r?aIe(r):[];return class MI extends n{static getTemplateHTML=e.endsWith("audio")?sIe:iIe;static shadowRootOptions={mode:"open"};static Events=rIe;static#e=!1;static get observedAttributes(){return MI.#t(),[...r?.constructor?.observedAttributes??[],...WX]}static#t(){if(this.#e)return;this.#e=!0;const a=new Set(this.observedAttributes);a.delete("muted");for(const o of s)if(!(o in this.prototype))if(typeof r[o]=="function")this.prototype[o]=function(...l){return this.#i(),this.call?this.call(o,...l):this.nativeEl?.[o]?.apply(this.nativeEl,l)};else{const l={get(){this.#i();const c=o.toLowerCase();if(a.has(c)){const u=this.getAttribute(c);return u===null?!1:u===""?!0:u}return this.get?.(o)??this.nativeEl?.[o]}};o!==o.toUpperCase()&&(l.set=function(c){this.#i();const u=o.toLowerCase();if(a.has(u)){c===!0||c===!1||c==null?this.toggleAttribute(u,!!c):this.setAttribute(u,c);return}if(this.set){this.set(o,c);return}this.nativeEl&&(this.nativeEl[o]=c)}),Object.defineProperty(this.prototype,o,l)}}#n=!1;#r=null;#s=new Map;#o;get;set;call;get nativeEl(){return this.#i(),this.#r??this.querySelector(":scope > [slot=media]")??this.querySelector(e)??this.shadowRoot?.querySelector(e)??null}set nativeEl(a){this.#r=a}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(a){this.toggleAttribute("muted",a)}get src(){return this.getAttribute("src")}set src(a){this.setAttribute("src",`${a}`)}get preload(){return this.getAttribute("preload")??this.nativeEl?.preload}set preload(a){this.setAttribute("preload",`${a}`)}#i(){this.#n||(this.#n=!0,this.init())}init(){if(!this.shadowRoot){this.attachShadow({mode:"open"});const a=oIe(this.attributes);t&&(a.is=t),e&&(a.part=e),this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(a)}this.nativeEl.muted=this.hasAttribute("muted");for(const a of s)this.#u(a);this.#o=new MutationObserver(this.#h.bind(this)),this.shadowRoot.addEventListener("slotchange",()=>this.#a()),this.#a();for(const a of this.constructor.Events)this.shadowRoot.addEventListener(a,this,!0)}handleEvent(a){a.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(a.type,{detail:a.detail}))}#a(){const a=new Map(this.#s);(this.shadowRoot?.querySelector("slot:not([name])")?.assignedElements({flatten:!0}).filter(c=>["track","source"].includes(c.localName))).forEach(c=>{a.delete(c);let u=this.#s.get(c);u||(u=c.cloneNode(),this.#s.set(c,u),this.#o?.observe(c,{attributes:!0})),this.nativeEl?.append(u),this.#l(u)}),a.forEach((c,u)=>{c.remove(),this.#s.delete(u)})}#h(a){for(const o of a)if(o.type==="attributes"){const{target:l,attributeName:c}=o,u=this.#s.get(l);u&&c&&(u.setAttribute(c,l.getAttribute(c)??""),this.#l(u))}}#l(a){a&&a.localName==="track"&&a.default&&(a.kind==="chapters"||a.kind==="metadata")&&a.track.mode==="disabled"&&(a.track.mode="hidden")}#u(a){if(Object.prototype.hasOwnProperty.call(this,a)){const o=this[a];delete this[a],this[a]=o}}attributeChangedCallback(a,o,l){this.#i(),this.#c(a,o,l)}#c(a,o,l){["id","class"].includes(a)||!MI.observedAttributes.includes(a)&&this.constructor.observedAttributes.includes(a)||(l===null?this.nativeEl?.removeAttribute(a):this.nativeEl?.getAttribute(a)!==l&&this.nativeEl?.setAttribute(a,l))}connectedCallback(){this.#i()}}}function aIe(n){const e=[];for(let t=Object.getPrototypeOf(n);t&&t!==HTMLElement.prototype;t=Object.getPrototypeOf(t)){const r=Object.getOwnPropertyNames(t);e.push(...r)}return e}function YX(n){let e="";for(const t in n){if(!WX.includes(t))continue;const r=n[t];r===""?e+=` ${t}`:e+=` ${t}="${r}"`}return e}function oIe(n){const e={};for(const t of n)e[t.name]=t.value;return e}const lIe=KX(globalThis.HTMLElement??class{},{tag:"video"});KX(globalThis.HTMLElement??class{},{tag:"audio"});class XS extends Event{track;constructor(e,t){super(e),this.track=t.track}}const OI=new WeakMap;function mt(n){return OI.get(n)??cIe(n,{})}function cIe(n,e){let t=OI.get(n);return t||OI.set(n,t={}),Object.assign(t,e)}function NI(n,e){const t=n.videoTracks;mt(e).media=n,mt(e).renditionSet||(mt(e).renditionSet=new Set);const r=mt(t).trackSet;r.add(e);const s=r.size-1;s in FI.prototype||Object.defineProperty(FI.prototype,s,{get(){return[...mt(this).trackSet][s]}}),queueMicrotask(()=>{t.dispatchEvent(new XS("addtrack",{track:e}))})}function jI(n){const e=mt(n).media?.videoTracks;if(!e)return;mt(e).trackSet.delete(n),queueMicrotask(()=>{e.dispatchEvent(new XS("removetrack",{track:n}))})}function uIe(n){const e=mt(n).media.videoTracks??[];let t=!1;for(const r of e)r!==n&&(r.selected=!1,t=!0);if(t){if(mt(e).changeRequested)return;mt(e).changeRequested=!0,queueMicrotask(()=>{delete mt(e).changeRequested,e.dispatchEvent(new Event("change"))})}}class FI extends EventTarget{#e;#t;#n;constructor(){super(),mt(this).trackSet=new Set}get#r(){return mt(this).trackSet}[Symbol.iterator](){return this.#r.values()}get length(){return this.#r.size}getTrackById(e){return[...this.#r].find(t=>t.id===e)??null}get selectedIndex(){return[...this.#r].findIndex(e=>e.selected)}get onaddtrack(){return this.#e}set onaddtrack(e){this.#e&&(this.removeEventListener("addtrack",this.#e),this.#e=void 0),typeof e=="function"&&(this.#e=e,this.addEventListener("addtrack",e))}get onremovetrack(){return this.#t}set onremovetrack(e){this.#t&&(this.removeEventListener("removetrack",this.#t),this.#t=void 0),typeof e=="function"&&(this.#t=e,this.addEventListener("removetrack",e))}get onchange(){return this.#n}set onchange(e){this.#n&&(this.removeEventListener("change",this.#n),this.#n=void 0),typeof e=="function"&&(this.#n=e,this.addEventListener("change",e))}}class QS extends Event{rendition;constructor(e,t){super(e),this.rendition=t.rendition}}function dIe(n,e){const t=mt(n).media.videoRenditions;mt(e).media=mt(n).media,mt(e).track=n;const r=mt(n).renditionSet;r.add(e);const s=r.size-1;s in UI.prototype||Object.defineProperty(UI.prototype,s,{get(){return rf(this)[s]}}),queueMicrotask(()=>{n.selected&&t.dispatchEvent(new QS("addrendition",{rendition:e}))})}function hIe(n){const e=mt(n).media.videoRenditions,t=mt(n).track;mt(t).renditionSet.delete(n),queueMicrotask(()=>{mt(n).track.selected&&e.dispatchEvent(new QS("removerendition",{rendition:n}))})}function fIe(n){const e=mt(n).media.videoRenditions;!e||mt(e).changeRequested||(mt(e).changeRequested=!0,queueMicrotask(()=>{delete mt(e).changeRequested,mt(n).track.selected&&e.dispatchEvent(new Event("change"))}))}function rf(n){return[...mt(n).media.videoTracks].filter(t=>t.selected).flatMap(t=>[...mt(t).renditionSet])}class UI extends EventTarget{#e;#t;#n;[Symbol.iterator](){return rf(this).values()}get length(){return rf(this).length}getRenditionById(e){return rf(this).find(t=>`${t.id}`==`${e}`)??null}get selectedIndex(){return rf(this).findIndex(e=>e.selected)}set selectedIndex(e){for(const[t,r]of rf(this).entries())r.selected=t===e}get onaddrendition(){return this.#e}set onaddrendition(e){this.#e&&(this.removeEventListener("addrendition",this.#e),this.#e=void 0),typeof e=="function"&&(this.#e=e,this.addEventListener("addrendition",e))}get onremoverendition(){return this.#t}set onremoverendition(e){this.#t&&(this.removeEventListener("removerendition",this.#t),this.#t=void 0),typeof e=="function"&&(this.#t=e,this.addEventListener("removerendition",e))}get onchange(){return this.#n}set onchange(e){this.#n&&(this.removeEventListener("change",this.#n),this.#n=void 0),typeof e=="function"&&(this.#n=e,this.addEventListener("change",e))}}class mIe{src;id;width;height;bitrate;frameRate;codec;#e=!1;get selected(){return this.#e}set selected(e){this.#e!==e&&(this.#e=e,fIe(this))}}class XX{id;kind;label="";language="";sourceBuffer;#e=!1;addRendition(e,t,r,s,i,a){const o=new mIe;return o.src=e,o.width=t,o.height=r,o.frameRate=a,o.bitrate=i,o.codec=s,dIe(this,o),o}removeRendition(e){hIe(e)}get selected(){return this.#e}set selected(e){this.#e!==e&&(this.#e=e,e===!0&&uIe(this))}}function pIe(n,e){const t=mt(n).media.audioRenditions;mt(e).media=mt(n).media,mt(e).track=n;const r=mt(n).renditionSet;r.add(e);const s=r.size-1;s in $I.prototype||Object.defineProperty($I.prototype,s,{get(){return sf(this)[s]}}),queueMicrotask(()=>{n.enabled&&t.dispatchEvent(new QS("addrendition",{rendition:e}))})}function gIe(n){const e=mt(n).media.audioRenditions,t=mt(n).track;mt(t).renditionSet.delete(n),queueMicrotask(()=>{mt(n).track.enabled&&e.dispatchEvent(new QS("removerendition",{rendition:n}))})}function vIe(n){const e=mt(n).media.audioRenditions;!e||mt(e).changeRequested||(mt(e).changeRequested=!0,queueMicrotask(()=>{delete mt(e).changeRequested,mt(n).track.enabled&&e.dispatchEvent(new Event("change"))}))}function sf(n){return[...mt(n).media.audioTracks].filter(t=>t.enabled).flatMap(t=>[...mt(t).renditionSet])}class $I extends EventTarget{#e;#t;#n;[Symbol.iterator](){return sf(this).values()}get length(){return sf(this).length}getRenditionById(e){return sf(this).find(t=>`${t.id}`==`${e}`)??null}get selectedIndex(){return sf(this).findIndex(e=>e.selected)}set selectedIndex(e){for(const[t,r]of sf(this).entries())r.selected=t===e}get onaddrendition(){return this.#e}set onaddrendition(e){this.#e&&(this.removeEventListener("addrendition",this.#e),this.#e=void 0),typeof e=="function"&&(this.#e=e,this.addEventListener("addrendition",e))}get onremoverendition(){return this.#t}set onremoverendition(e){this.#t&&(this.removeEventListener("removerendition",this.#t),this.#t=void 0),typeof e=="function"&&(this.#t=e,this.addEventListener("removerendition",e))}get onchange(){return this.#n}set onchange(e){this.#n&&(this.removeEventListener("change",this.#n),this.#n=void 0),typeof e=="function"&&(this.#n=e,this.addEventListener("change",e))}}class yIe{src;id;bitrate;codec;#e=!1;get selected(){return this.#e}set selected(e){this.#e!==e&&(this.#e=e,vIe(this))}}function BI(n,e){const t=n.audioTracks;mt(e).media=n,mt(e).renditionSet||(mt(e).renditionSet=new Set);const r=mt(t).trackSet;r.add(e);const s=r.size-1;s in VI.prototype||Object.defineProperty(VI.prototype,s,{get(){return[...mt(this).trackSet][s]}}),queueMicrotask(()=>{t.dispatchEvent(new XS("addtrack",{track:e}))})}function HI(n){const e=mt(n).media?.audioTracks;if(!e)return;mt(e).trackSet.delete(n),queueMicrotask(()=>{e.dispatchEvent(new XS("removetrack",{track:n}))})}function bIe(n){const e=mt(n).media.audioTracks;!e||mt(e).changeRequested||(mt(e).changeRequested=!0,queueMicrotask(()=>{delete mt(e).changeRequested,e.dispatchEvent(new Event("change"))}))}class VI extends EventTarget{#e;#t;#n;constructor(){super(),mt(this).trackSet=new Set}get#r(){return mt(this).trackSet}[Symbol.iterator](){return this.#r.values()}get length(){return this.#r.size}getTrackById(e){return[...this.#r].find(t=>t.id===e)??null}get onaddtrack(){return this.#e}set onaddtrack(e){this.#e&&(this.removeEventListener("addtrack",this.#e),this.#e=void 0),typeof e=="function"&&(this.#e=e,this.addEventListener("addtrack",e))}get onremovetrack(){return this.#t}set onremovetrack(e){this.#t&&(this.removeEventListener("removetrack",this.#t),this.#t=void 0),typeof e=="function"&&(this.#t=e,this.addEventListener("removetrack",e))}get onchange(){return this.#n}set onchange(e){this.#n&&(this.removeEventListener("change",this.#n),this.#n=void 0),typeof e=="function"&&(this.#n=e,this.addEventListener("change",e))}}class QX{id;kind;label="";language="";sourceBuffer;#e=!1;addRendition(e,t,r){const s=new yIe;return s.src=e,s.codec=t,s.bitrate=r,pIe(this,s),s}removeRendition(e){gIe(e)}get enabled(){return this.#e}set enabled(e){this.#e!==e&&(this.#e=e,bIe(this))}}const FB=kE(globalThis.HTMLMediaElement,"video"),UB=kE(globalThis.HTMLMediaElement,"audio");function xIe(n){if(!n?.prototype)return n;const e=kE(n,"video");(!e||`${e}`.includes("[native code]"))&&Object.defineProperty(n.prototype,"videoTracks",{get(){return wIe(this)}});const t=kE(n,"audio");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(n.prototype,"audioTracks",{get(){return EIe(this)}}),"addVideoTrack"in n.prototype||(n.prototype.addVideoTrack=function(i,a="",o=""){const l=new XX;return l.kind=i,l.label=a,l.language=o,NI(this,l),l}),"removeVideoTrack"in n.prototype||(n.prototype.removeVideoTrack=jI),"addAudioTrack"in n.prototype||(n.prototype.addAudioTrack=function(i,a="",o=""){const l=new QX;return l.kind=i,l.label=a,l.language=o,BI(this,l),l}),"removeAudioTrack"in n.prototype||(n.prototype.removeAudioTrack=HI),"videoRenditions"in n.prototype||Object.defineProperty(n.prototype,"videoRenditions",{get(){return r(this)}});const r=i=>{let a=mt(i).videoRenditions;return a||(a=new UI,mt(a).media=i,mt(i).videoRenditions=a),a};"audioRenditions"in n.prototype||Object.defineProperty(n.prototype,"audioRenditions",{get(){return s(this)}});const s=i=>{let a=mt(i).audioRenditions;return a||(a=new $I,mt(a).media=i,mt(i).audioRenditions=a),a};return n}function kE(n,e){if(n?.prototype)return Object.getOwnPropertyDescriptor(n.prototype,`${e}Tracks`)?.get}function wIe(n){let e=mt(n).videoTracks;if(!e&&(e=new FI,mt(n).videoTracks=e,FB)){const t=FB.call(n.nativeEl??n);for(const r of t)NI(n,r);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",r=>{if([...e].some(s=>s instanceof XX)){for(const s of t)jI(s);return}NI(n,r.track)}),t.addEventListener("removetrack",r=>{jI(r.track)})}return e}function EIe(n){let e=mt(n).audioTracks;if(!e&&(e=new VI,mt(n).audioTracks=e,UB)){const t=UB.call(n.nativeEl??n);for(const r of t)BI(n,r);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",r=>{if([...e].some(s=>s instanceof QX)){for(const s of t)HI(s);return}BI(n,r.track)}),t.addEventListener("removetrack",r=>{HI(r.track)})}return e}const at=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},SIe=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=TIe},TIe=Number.MAX_SAFE_INTEGER||9007199254740991;let xt=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),_e=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n}({}),K=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n}({});var nn={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},gt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Fh{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class _Ie{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Fh(e),this.fast_=new Fh(t),this.defaultTTFB_=s,this.ttfb_=new Fh(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new Fh(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new Fh(t,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new Fh(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,i=r/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function AIe(n,e,t){return(e=CIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _n(){return _n=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_n.apply(null,arguments)}function $B(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Ln(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$B(Object(t),!0).forEach(function(r){AIe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):$B(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function RIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CIe(n){var e=RIe(n,"string");return typeof e=="symbol"?e:e+""}class eo{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=jc,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const jc=function(){},kIe={trace:jc,debug:jc,log:jc,warn:jc,info:jc,error:jc};function zI(){return _n({},kIe)}function IIe(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):jc}function BB(n,e,t){return e[n]?e[n].bind(e):IIe(n,t)}const GI=zI();function LIe(n,e,t){const r=zI();if(typeof console=="object"&&n===!0||typeof n=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{r[i]=BB(i,n,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.7`)}catch{return zI()}s.forEach(i=>{GI[i]=BB(i,n)})}else _n(GI,r);return r}const vn=GI;function ou(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function DIe(n){return typeof self<"u"&&n===self.ManagedMediaSource}function ZX(n,e){const t=Object.keys(n),r=Object.keys(e),s=t.length,i=r.length;return!s||!i||s===i&&!t.some(a=>r.indexOf(a)===-1)}function ji(n,e=!1){if(typeof TextDecoder<"u"){const c=new TextDecoder("utf-8").decode(n);if(e){const u=c.indexOf("\0");return u!==-1?c.substring(0,u):c}return c.replace(/\0/g,"")}const t=n.length;let r,s,i,a="",o=0;for(;o<t;){if(r=n[o++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=n[o++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[o++],i=n[o++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(i&63)<<0);break}}return a}const ed={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}};function JX(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function PIe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var rR={exports:{}},HB;function MIe(){return HB||(HB=1,function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");return f.path=o.normalizePath(f.path),o.buildURLFromParts(f)}var m=o.parseURL(c);if(!m)throw new Error("Error trying to parse relative URL.");if(m.scheme)return u.alwaysNormalize?(m.path=o.normalizePath(m.path),o.buildURLFromParts(m)):c;var g=o.parseURL(l);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var y=s.exec(g.path);g.netLoc=y[1],g.path=y[2]}g.netLoc&&!g.path&&(g.path="/");var b={scheme:g.scheme,netLoc:m.netLoc,path:null,params:m.params,query:m.query,fragment:m.fragment};if(!m.netLoc&&(b.netLoc=g.netLoc,m.path[0]!=="/"))if(!m.path)b.path=g.path,m.params||(b.params=g.params,m.query||(b.query=g.query));else{var x=g.path,S=x.substring(0,x.lastIndexOf("/")+1)+m.path;b.path=o.normalizePath(S)}return b.path===null&&(b.path=u.alwaysNormalize?o.normalizePath(m.path):m.path),o.buildURLFromParts(b)},parseURL:function(l){var c=r.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(i,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=o})()}(rR)),rR.exports}var UP=MIe();class $P{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var jn={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class eQ{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,NIe(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let s;r.length===1?s=t?.byteRangeEndOffset||0:s=parseInt(r[1]),this._byteRange=[s,parseInt(r[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[jn.AUDIO]:null,[jn.VIDEO]:null,[jn.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new $P),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=UP.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[jn.AUDIO]=null,e[jn.VIDEO]=null,e[jn.AUDIOVIDEO]=null}}function Nr(n){return n.sn!=="initSegment"}class sR extends eQ{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(at(e)&&at(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=at(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!at(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Nr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,i,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:i,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,r),l.startDTS=Math.min(l.startDTS,s),l.endDTS=Math.max(l.endDTS,i)}}class OIe extends eQ{constructor(e,t,r,s,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function tQ(n,e){const t=Object.getPrototypeOf(n);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||tQ(t,e)}}function NIe(n,e){const t=tQ(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const VB=Math.pow(2,32)-1,jIe=[].push,nQ={video:1,audio:2,id3:3,text:4};function es(n){return String.fromCharCode.apply(null,n)}function rQ(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Nt(n,e){const t=sQ(n,e);return t<0?4294967296+t:t}function zB(n,e){let t=Nt(n,e);return t*=Math.pow(2,32),t+=Nt(n,e+4),t}function sQ(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function FIe(n){const e=n.byteLength;for(let t=0;t<e;){const r=Nt(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function en(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const i=Nt(n,s),a=es(n.subarray(s+4,s+8)),o=i>1?s+i:r;if(a===e[0])if(e.length===1)t.push(n.subarray(s+8,o));else{const l=en(n.subarray(s+8,o),e.slice(1));l.length&&jIe.apply(t,l)}s=o}return t}function UIe(n){const e=[],t=n[0];let r=8;const s=Nt(n,r);r+=4;let i=0,a=0;t===0?(i=Nt(n,r),a=Nt(n,r+4),r+=8):(i=zB(n,r),a=zB(n,r+8),r+=16),r+=2;let o=n.length+a;const l=rQ(n,r);r+=2;for(let c=0;c<l;c++){let u=r;const f=Nt(n,u);u+=4;const m=f&2147483647;if((f&2147483648)>>>31===1)return vn.warn("SIDX has hierarchical references (not supported)"),null;const y=Nt(n,u);u+=4,e.push({referenceSize:m,subsegmentDuration:y,info:{duration:y/s,start:o,end:o+m-1}}),o+=m,u+=4,r=u}return{earliestPresentationTime:i,timescale:s,version:t,referencesCount:l,references:e}}function iQ(n){const e=[],t=en(n,["moov","trak"]);for(let s=0;s<t.length;s++){const i=t[s],a=en(i,["tkhd"])[0];if(a){let o=a[0];const l=Nt(a,o===0?12:20),c=en(i,["mdia","mdhd"])[0];if(c){o=c[0];const u=Nt(c,o===0?12:20),f=en(i,["mdia","hdlr"])[0];if(f){const m=es(f.subarray(8,12)),g={soun:jn.AUDIO,vide:jn.VIDEO}[m],y=en(i,["mdia","minf","stbl","stsd"])[0],b=$Ie(y);g?(e[l]={timescale:u,type:g,stsd:b},e[g]=Ln({timescale:u,id:l},b)):e[l]={timescale:u,type:m,stsd:b}}}}}return en(n,["moov","mvex","trex"]).forEach(s=>{const i=Nt(s,4),a=e[i];a&&(a.default={duration:Nt(s,12),flags:Nt(s,20)})}),e}function $Ie(n){const e=n.subarray(8),t=e.subarray(86),r=es(e.subarray(4,8));let s=r,i;const a=r==="enca"||r==="encv";if(a){const c=en(e,[r])[0].subarray(r==="enca"?28:78);en(c,["sinf"]).forEach(f=>{const m=en(f,["schm"])[0];if(m){const g=es(m.subarray(4,8));if(g==="cbcs"||g==="cenc"){const y=en(f,["frma"])[0];y&&(s=es(y))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const l=en(t,["avcC"])[0];l&&l.length>3&&(s+="."+Cb(l[1])+Cb(l[2])+Cb(l[3]),i=Rb(o==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const l=en(e,[r])[0],c=en(l.subarray(28),["esds"])[0];if(c&&c.length>7){let u=4;if(c[u++]!==3)break;u=iR(c,u),u+=2;const f=c[u++];if(f&128&&(u+=2),f&64&&(u+=c[u++]),c[u++]!==4)break;u=iR(c,u);const m=c[u++];if(m===64)s+="."+Cb(m);else break;if(u+=12,c[u++]!==5)break;u=iR(c,u);const g=c[u++];let y=(g&248)>>3;y===31&&(y+=1+((g&7)<<3)+((c[u]&224)>>5)),s+="."+y}break}case"hvc1":case"hev1":{const l=en(t,["hvcC"])[0];if(l&&l.length>12){const c=l[1],u=["","A","B","C"][c>>6],f=c&31,m=Nt(l,2),g=(c&32)>>5?"H":"L",y=l[12],b=l.subarray(6,12);s+="."+u+f,s+="."+BIe(m).toString(16).toUpperCase(),s+="."+g+y;let x="";for(let S=b.length;S--;){const T=b[S];(T||x)&&(x="."+T.toString(16).toUpperCase()+x)}s+=x}i=Rb(o=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=Rb(s,t)||s;break}case"vp09":{const l=en(t,["vpcC"])[0];if(l&&l.length>6){const c=l[4],u=l[5],f=l[6]>>4&15;s+="."+So(c)+"."+So(u)+"."+So(f)}break}case"av01":{const l=en(t,["av1C"])[0];if(l&&l.length>2){const c=l[1]>>>5,u=l[1]&31,f=l[2]>>>7?"H":"M",m=(l[2]&64)>>6,g=(l[2]&32)>>5,y=c===2&&m?g?12:10:m?10:8,b=(l[2]&16)>>4,x=(l[2]&8)>>3,S=(l[2]&4)>>2,T=l[2]&3;s+="."+c+"."+So(u)+f+"."+So(y)+"."+b+"."+x+S+T+"."+So(1)+"."+So(1)+"."+So(1)+"."+0,i=Rb("dav1",t)}break}}return{codec:s,encrypted:a,supplemental:i}}function Rb(n,e){const t=en(e,["dvvC"]),r=t.length?t[0]:en(e,["dvcC"])[0];if(r){const s=r[2]>>1&127,i=r[2]<<5&32|r[3]>>3&31;return n+"."+So(s)+"."+So(i)}}function BIe(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function iR(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Cb(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function So(n){return(n<10?"0":"")+n}function HIe(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&en(n,["moov","trak"]).forEach(s=>{const a=en(s,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=en(a,["enca"]);const l=o.length>0;l||(o=en(a,["encv"])),o.forEach(c=>{const u=l?c.subarray(28):c.subarray(78);en(u,["sinf"]).forEach(m=>{const g=VIe(m);if(g){const y=g.subarray(8,24);y.some(b=>b!==0)||(vn.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${ed.hexDump(y)} -> ${ed.hexDump(t)}`),g.set(t,8))}})})}),n}function VIe(n){const e=en(n,["schm"])[0];if(e){const t=es(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return en(n,["schi","tenc"])[0]}return null}function zIe(n,e,t){const r={},s=en(n,["moof","traf"]);for(let i=0;i<s.length;i++){const a=s[i],o=en(a,["tfhd"])[0],l=Nt(o,4),c=e[l];if(!c)continue;const u=r[l]||(r[l]={start:NaN,duration:0,sampleCount:0,timescale:c.timescale,type:c.type}),f=en(a,["tfdt"])[0];if(f){const _=f[0];let R=Nt(f,4);_===1&&(R===VB?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(R*=VB+1,R+=Nt(f,8))),at(R)&&(!at(u.start)||R<u.start)&&(u.start=R)}const m=c.default,g=Nt(o,0)|m?.flags;let y=m?.duration||0;g&8&&(g&2?y=Nt(o,12):y=Nt(o,8));const b=en(a,["trun"]);let x=u.start||0,S=0,T=y;for(let _=0;_<b.length;_++){const R=b[_],I=Nt(R,4),C=u.sampleCount;u.sampleCount+=I;const L=R[3]&1,k=R[3]&4,M=R[2]&1,D=R[2]&2,U=R[2]&4,$=R[2]&8;let V=8,B=I;for(L&&(V+=4),k&&I&&(!(R[V+1]&1)&&u.keyFrameIndex===void 0&&(u.keyFrameIndex=C),V+=4,M?(T=Nt(R,V),V+=4):T=y,D&&(V+=4),$&&(V+=4),x+=T,S+=T,B--);B--;)M?(T=Nt(R,V),V+=4):T=y,D&&(V+=4),U&&(R[V+1]&1||u.keyFrameIndex===void 0&&(u.keyFrameIndex=u.sampleCount-(B+1),u.keyFrameStart=x),V+=4),$&&(V+=4),x+=T,S+=T;!S&&y&&(S+=y*I)}u.duration+=S}if(!Object.keys(r).some(i=>r[i].duration)){let i=1/0,a=0;const o=en(n,["sidx"]);for(let l=0;l<o.length;l++){const c=UIe(o[l]);if(c!=null&&c.references){i=Math.min(i,c.earliestPresentationTime/c.timescale);const u=c.references.reduce((f,m)=>f+m.info.duration||0,0);a=Math.max(a,u+c.earliestPresentationTime/c.timescale)}}a&&at(a)&&Object.keys(r).forEach(l=>{r[l].duration||(r[l].duration=a*r[l].timescale-r[l].start)})}return r}function GIe(n){const e={valid:null,remainder:null},t=en(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=n.slice(0,r.byteOffset-8),e.remainder=n.slice(r.byteOffset-8),e}function wa(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function GB(n,e){const t=[],r=e.samples,s=e.timescale,i=e.id;let a=!1;return en(r,["moof"]).map(l=>{const c=l.byteOffset-8;en(l,["traf"]).map(f=>{const m=en(f,["tfdt"]).map(g=>{const y=g[0];let b=Nt(g,4);return y===1&&(b*=Math.pow(2,32),b+=Nt(g,8)),b/s})[0];return m!==void 0&&(n=m),en(f,["tfhd"]).map(g=>{const y=Nt(g,4),b=Nt(g,0)&16777215,x=(b&1)!==0,S=(b&2)!==0,T=(b&8)!==0;let _=0;const R=(b&16)!==0;let I=0;const C=(b&32)!==0;let L=8;y===i&&(x&&(L+=8),S&&(L+=4),T&&(_=Nt(g,L),L+=4),R&&(I=Nt(g,L),L+=4),C&&(L+=4),e.type==="video"&&(a=ZS(e.codec)),en(f,["trun"]).map(k=>{const M=k[0],D=Nt(k,0)&16777215,U=(D&1)!==0;let $=0;const V=(D&4)!==0,B=(D&256)!==0;let W=0;const F=(D&512)!==0;let j=0;const q=(D&1024)!==0,H=(D&2048)!==0;let N=0;const O=Nt(k,4);let z=8;U&&($=Nt(k,z),z+=4),V&&(z+=4);let G=$+c;for(let Y=0;Y<O;Y++){if(B?(W=Nt(k,z),z+=4):W=_,F?(j=Nt(k,z),z+=4):j=I,q&&(z+=4),H&&(M===0?N=Nt(k,z):N=sQ(k,z),z+=4),e.type===jn.VIDEO){let Q=0;for(;Q<j;){const J=Nt(r,G);if(G+=4,qIe(a,r[G])){const ee=r.subarray(G,G+J);BP(ee,a?2:1,n+N/s,t)}G+=J,Q+=J+4}}n+=W/s}}))})})}),t}function ZS(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function qIe(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function BP(n,e,t,r){const s=aQ(n);let i=0;i+=e;let a=0,o=0,l=0;for(;i<s.length;){a=0;do{if(i>=s.length)break;l=s[i++],a+=l}while(l===255);o=0;do{if(i>=s.length)break;l=s[i++],o+=l}while(l===255);const c=s.length-i;let u=i;if(o<c)i+=o;else if(o>c){vn.error(`Malformed SEI payload. ${o} is too small, only ${c} bytes left to parse.`);break}if(a===4){if(s[u++]===181){const m=rQ(s,u);if(u+=2,m===49){const g=Nt(s,u);if(u+=4,g===1195456820){const y=s[u++];if(y===3){const b=s[u++],x=31&b,S=64&b,T=S?2+x*3:0,_=new Uint8Array(T);if(S){_[0]=b;for(let R=1;R<T;R++)_[R]=s[u++]}r.push({type:y,payloadType:a,pts:t,bytes:_})}}}}}else if(a===5&&o>16){const f=[];for(let y=0;y<16;y++){const b=s[u++].toString(16);f.push(b.length==1?"0"+b:b),(y===3||y===5||y===7||y===9)&&f.push("-")}const m=o-16,g=new Uint8Array(m);for(let y=0;y<m;y++)g[y]=s[u++];r.push({payloadType:a,pts:t,uuid:f.join(""),userData:ji(g),userDataBytes:g})}}}function aQ(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,i=new Uint8Array(s);let a=0;for(r=0;r<s;a++,r++)a===t[0]&&(a++,t.shift()),i[r]=n[a];return i}function WIe(n){const e=n[0];let t="",r="",s=0,i=0,a=0,o=0,l=0,c=0;if(e===0){for(;es(n.subarray(c,c+1))!=="\0";)t+=es(n.subarray(c,c+1)),c+=1;for(t+=es(n.subarray(c,c+1)),c+=1;es(n.subarray(c,c+1))!=="\0";)r+=es(n.subarray(c,c+1)),c+=1;r+=es(n.subarray(c,c+1)),c+=1,s=Nt(n,12),i=Nt(n,16),o=Nt(n,20),l=Nt(n,24),c=28}else if(e===1){c+=4,s=Nt(n,c),c+=4;const f=Nt(n,c);c+=4;const m=Nt(n,c);for(c+=4,a=2**32*f+m,SIe(a)||(a=Number.MAX_SAFE_INTEGER,vn.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Nt(n,c),c+=4,l=Nt(n,c),c+=4;es(n.subarray(c,c+1))!=="\0";)t+=es(n.subarray(c,c+1)),c+=1;for(t+=es(n.subarray(c,c+1)),c+=1;es(n.subarray(c,c+1))!=="\0";)r+=es(n.subarray(c,c+1)),c+=1;r+=es(n.subarray(c,c+1)),c+=1}const u=n.subarray(c,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:a,presentationTimeDelta:i,eventDuration:o,id:l,payload:u}}function KIe(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),s=0,r=8;s<t;s++)i.set(e[s],r),r+=e[s].byteLength;return i}function YIe(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;r=0,s=new Uint8Array;let i;r>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),KIe([112,115,115,104],new Uint8Array([r,0,0,0]),n,i,s,a,t||new Uint8Array)}const oQ=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Jf={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function HP(n,e){const t=Jf[e];return!!t&&!!t[n.slice(0,4)]}function qI(n,e,t=!0){return!n.split(",").some(r=>!VP(r,e,t))}function VP(n,e,t=!0){var r;const s=ou(t);return(r=s?.isTypeSupported(Pv(n,e)))!=null?r:!1}function Pv(n,e){return`${e}/mp4;codecs=${n}`}function qB(n){if(n){const e=n.substring(0,4);return Jf.video[e]}return 2}function IE(n){const e=oQ();return n.split(",").reduce((t,r)=>{const i=e&&ZS(r)?9:Jf.video[r];return i?(i*2+t)/(t?3:2):(Jf.audio[r]+t)/(t?2:1)},0)}const aR={};function XIe(n,e=!0){if(aR[n])return aR[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<t.length;s++){var r;if(VP(t[s],"audio",e))return aR[n]=t[s],t[s];if(t[s]==="mp3"&&(r=ou(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return n}const QIe=/flac|opus|mp4a\.40\.34/i;function LE(n,e=!0){return n.replace(QIe,t=>XIe(t.toLowerCase(),e))}function ZIe(n,e){const t=[];if(n){const r=n.split(",");for(let s=0;s<r.length;s++)HP(r[s],"video")||t.push(r[s])}return e&&t.push(e),t.join(",")}function Px(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1)&&(WB(n,"audio")||WB(n,"video")))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let r=t.length;r--;)if(t[r].substring(0,4)===n.substring(0,4))return t[r]}return t[0]}}return e||n}function WB(n,e){return HP(n,e)&&VP(n,e)}function JIe(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function eLe(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return n}function KB(n){const e=ou(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function WI(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const lQ={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function cQ(n,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:n}}function tLe(n,e,t,r,s,i){const a=n.videoCodec,o=n.audioCodec?n.audioGroups:null,l=i?.audioCodec,c=i?.channels,u=c?parseInt(c):l?1/0:2;let f=null;if(o!=null&&o.length)try{o.length===1&&o[0]?f=e.groups[o[0]].channels:f=o.reduce((m,g)=>{if(g){const y=e.groups[g];if(!y)throw new Error(`Audio track group ${g} not found`);Object.keys(y.channels).forEach(b=>{m[b]=(m[b]||0)+y.channels[b]})}return m},{2:0})}catch{return!0}return a!==void 0&&(a.split(",").some(m=>ZS(m))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(s,8e6))||!!f&&at(u)&&Object.keys(f).some(m=>parseInt(m)>u)}function uQ(n,e,t,r={}){const s=n.videoCodec;if(!s&&!n.audioCodec||!t)return Promise.resolve(lQ);const i=[],a=nLe(n),o=a.length,l=rLe(n,e,o>0),c=l.length;for(let u=o||1*c||1;u--;){const f={type:"media-source"};if(o&&(f.video=a[u%o]),c){f.audio=l[u%c];const m=f.audio.bitrate;f.video&&m&&(f.video.bitrate-=m)}i.push(f)}if(s){const u=navigator.userAgent;if(s.split(",").some(f=>ZS(f))&&oQ())return Promise.resolve(cQ(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${u})`),i))}return Promise.all(i.map(u=>{const f=iLe(u);return r[f]||(r[f]=t.decodingInfo(u))})).then(u=>({supported:!u.some(f=>!f.supported),configurations:i,decodingInfoResults:u})).catch(u=>({supported:!1,configurations:i,decodingInfoResults:[],error:u}))}function nLe(n){var e;const t=(e=n.videoCodec)==null?void 0:e.split(","),r=dQ(n),s=n.width||640,i=n.height||480,a=n.frameRate||30,o=n.videoRange.toLowerCase();return t?t.map(l=>{const c={contentType:Pv(eLe(l),"video"),width:s,height:i,bitrate:r,framerate:a};return o!=="sdr"&&(c.transferFunction=o),c}):[]}function rLe(n,e,t){var r;const s=(r=n.audioCodec)==null?void 0:r.split(","),i=dQ(n);return s&&n.audioGroups?n.audioGroups.reduce((a,o)=>{var l;const c=o?(l=e.groups[o])==null?void 0:l.tracks:null;return c?c.reduce((u,f)=>{if(f.groupId===o){const m=parseFloat(f.channels||"");s.forEach(g=>{const y={contentType:Pv(g,"audio"),bitrate:t?sLe(g,i):i};m&&(y.channels=""+m),u.push(y)})}return u},a):a},[]):[]}function sLe(n,e){if(e<=1)return 1;let t=128e3;return n==="ec-3"?t=768e3:n==="ac-3"&&(t=64e4),Math.min(e/2,t)}function dQ(n){return Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)/1e3)*1e3||1}function iLe(n){let e="";const{audio:t,video:r}=n;if(r){const s=WI(r.contentType);e+=`${s}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const s=WI(t.contentType);e+=`${r?"_":""}${s}_c${t.channels}`}return e}const KI=["NONE","TYPE-0","TYPE-1",null];function aLe(n){return KI.indexOf(n)>-1}const DE=["SDR","PQ","HLG"];function oLe(n){return!!n&&DE.indexOf(n)>-1}var Mx={No:"",Yes:"YES",v2:"v2"};function YB(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,s=r<e/2;return e&&s?t?Mx.v2:Mx.Yes:Mx.No}class XB{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Mv{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return QB(this._audioGroups,e)}hasSubtitleGroup(e){return QB(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function QB(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function lLe(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function cLe(n,e){let t=!1,r=[];if(n&&(t=n!=="SDR",r=[n]),e){r=e.allowedVideoRanges||DE.slice(0);const s=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&lLe(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const uLe=n=>{const e=new WeakSet;return(t,r)=>{if(n&&(r=n(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},Wn=(n,e)=>JSON.stringify(n,uLe(e));function dLe(n,e,t,r,s){const i=Object.keys(n),a=r?.channels,o=r?.audioCodec,l=s?.videoCodec,c=a&&parseInt(a)===2;let u=!1,f=!1,m=1/0,g=1/0,y=1/0,b=1/0,x=0,S=[];const{preferHDR:T,allowedVideoRanges:_}=cLe(e,s);for(let k=i.length;k--;){const M=n[i[k]];u||(u=M.channels[2]>0),m=Math.min(m,M.minHeight),g=Math.min(g,M.minFramerate),y=Math.min(y,M.minBitrate),_.filter(U=>M.videoRanges[U]>0).length>0&&(f=!0)}m=at(m)?m:0,g=at(g)?g:0;const R=Math.max(1080,m),I=Math.max(30,g);y=at(y)?y:t,t=Math.max(y,t),f||(e=void 0);const C=i.length>1;return{codecSet:i.reduce((k,M)=>{const D=n[M];if(M===k)return k;if(S=f?_.filter(U=>D.videoRanges[U]>0):[],C){if(D.minBitrate>t)return co(M,`min bitrate of ${D.minBitrate} > current estimate of ${t}`),k;if(!D.hasDefaultAudio)return co(M,"no renditions with default or auto-select sound found"),k;if(o&&M.indexOf(o.substring(0,4))%5!==0)return co(M,`audio codec preference "${o}" not found`),k;if(a&&!c){if(!D.channels[a])return co(M,`no renditions with ${a} channel sound found (channels options: ${Object.keys(D.channels)})`),k}else if((!o||c)&&u&&D.channels[2]===0)return co(M,"no renditions with stereo sound found"),k;if(D.minHeight>R)return co(M,`min resolution of ${D.minHeight} > maximum of ${R}`),k;if(D.minFramerate>I)return co(M,`min framerate of ${D.minFramerate} > maximum of ${I}`),k;if(!S.some(U=>D.videoRanges[U]>0))return co(M,`no variants with VIDEO-RANGE of ${Wn(S)} found`),k;if(l&&M.indexOf(l.substring(0,4))%5!==0)return co(M,`video codec preference "${l}" not found`),k;if(D.maxScore<x)return co(M,`max score of ${D.maxScore} < selected max of ${x}`),k}return k&&(IE(M)>=IE(k)||D.fragmentError>n[k].fragmentError)?k:(b=D.minIndex,x=D.maxScore,M)},void 0),videoRanges:S,preferHDR:T,minFramerate:g,minBitrate:y,minIndex:b}}function co(n,e){vn.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function hQ(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const s=t.channels||"2";return r.channels[s]=(r.channels[s]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function hLe(n,e,t,r){return n.slice(t,r+1).reduce((s,i,a)=>{if(!i.codecSet)return s;const o=i.audioGroups;let l=s[i.codecSet];l||(s[i.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,i.bitrate);const c=Math.min(i.height,i.width);return l.minHeight=Math.min(l.minHeight,c),l.minFramerate=Math.min(l.minFramerate,i.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,i.score),l.fragmentError+=i.fragmentError,l.videoRanges[i.videoRange]=(l.videoRanges[i.videoRange]||0)+1,o&&o.forEach(u=>{if(!u)return;const f=e.groups[u];f&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?f.hasDefault:f.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(f.channels).forEach(m=>{l.channels[m]=(l.channels[m]||0)+f.channels[m]}))}),s},{})}function ZB(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}=n;return{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}}function No(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const s=e[r];if(fd(n,s,t))return r}return-1}function fd(n,e,t){const{groupId:r,name:s,lang:i,assocLang:a,default:o}=n,l=n.forced;return(r===void 0||e.groupId===r)&&(s===void 0||e.name===s)&&(i===void 0||fLe(i,e.lang))&&(i===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in n)||mLe(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function fLe(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function mLe(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(s=>r.indexOf(s)===-1)}function Qu(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function pLe(n,e,t,r,s){const i=e[r],o=e.reduce((m,g,y)=>{const b=g.uri;return(m[b]||(m[b]=[])).push(y),m},{})[i.uri];o.length>1&&(r=Math.max.apply(Math,o));const l=i.videoRange,c=i.frameRate,u=i.codecSet.substring(0,4),f=JB(e,r,m=>{if(m.videoRange!==l||m.frameRate!==c||m.codecSet.substring(0,4)!==u)return!1;const g=m.audioGroups,y=t.filter(b=>!g||g.indexOf(b.groupId)!==-1);return No(n,y,s)>-1});return f>-1?f:JB(e,r,m=>{const g=m.audioGroups,y=t.filter(b=>!g||g.indexOf(b.groupId)!==-1);return No(n,y,s)>-1})}function JB(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}function PE(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class gLe extends eo{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:s,partCurrent:i,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!s||!l)return;const c=performance.now(),u=i?i.stats:s.stats,f=i?i.duration:s.duration,m=c-u.loading.start,g=a.minAutoLevel,y=s.level,b=this._nextAutoLevel;if(u.aborted||u.loaded&&u.loaded===u.total||y<=g){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const x=b>-1&&b!==y,S=!!t||x;if(!S&&(l.paused||!l.playbackRate||!l.readyState))return;const T=a.mainForwardBufferInfo;if(!S&&T===null)return;const _=this.bwEstimator.getEstimateTTFB(),R=Math.abs(l.playbackRate);if(m<=Math.max(_,1e3*(f/(R*2))))return;const I=T?T.len/R:0,C=u.loading.first?u.loading.first-u.loading.start:-1,L=u.loaded&&C>-1,k=this.getBwEstimate(),M=a.levels,D=M[y],U=Math.max(u.loaded,Math.round(f*(s.bitrate||D.averageBitrate)/8));let $=L?m-C:m;$<1&&L&&($=Math.min(m,u.loaded*8/k));const V=L?u.loaded*1e3/$:0,B=_/1e3,W=V?(U-u.loaded)/V:U*8/k+B;if(W<=I)return;const F=V?V*8:k,j=((r=t?.details||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,q=this.hls.config.abrBandWidthUpFactor;let H=Number.POSITIVE_INFINITY,N;for(N=y-1;N>g;N--){const Y=M[N].maxBitrate,Q=!M[N].details||j;if(H=this.getTimeToLoadFrag(B,F,f*Y,Q),H<Math.min(I,f+B))break}if(H>=W||H>f*10)return;L?this.bwEstimator.sample(m-Math.min(_,C),u.loaded):this.bwEstimator.sampleTTFB(m);const O=M[N].maxBitrate;this.getBwEstimate()*q>O&&this.resetEstimator(O);const z=this.findBestLevel(O,g,N,0,I,1,1);z>-1&&(N=z),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${I.toFixed(3)} s
      Estimated load time for current fragment: ${W.toFixed(3)} s
      Estimated load time for down switch fragment: ${H.toFixed(3)} s
      TTFB estimate: ${C|0} ms
      Current BW estimate: ${at(k)?k|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${N} @ ${O|0} bps`),a.nextLoadLevel=a.nextAutoLevel=N,this.clearTimer();const G=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===N&&N>0){const Y=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${N>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${Y.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,N>g){let Q=this.findBestLevel(this.hls.levels[g].bitrate,g,N,0,Y,1,1);Q===-1&&(Q=g),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Q,this.resetEstimator(this.hls.levels[Q].bitrate)}}};x||W>H*2?G():this.timer=self.setInterval(G,H*1e3),a.trigger(K.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:u})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new _Ie(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.FRAG_LOADING,this.onFragLoading,this),e.on(K.FRAG_LOADED,this.onFragLoaded,this),e.on(K.FRAG_BUFFERED,this.onFragBuffered,this),e.on(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(K.LEVEL_LOADED,this.onLevelLoaded,this),e.on(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(K.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.FRAG_LOADING,this.onFragLoading,this),e.off(K.FRAG_LOADED,this.onFragLoaded,this),e.off(K.FRAG_BUFFERED,this.onFragBuffered,this),e.off(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(K.LEVEL_LOADED,this.onLevelLoaded,this),e.off(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(K.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(K.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var s;this.fragCurrent=r,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case _e.BUFFER_ADD_CODEC_ERROR:case _e.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case _e.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:s,partCurrent:i}=this;if(r&&s&&r.sn===s.sn&&r.level===s.level){const a=performance.now(),o=i?i.stats:r.stats,l=a-o.loading.start,c=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&c>-1){const f=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(f,c),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,r,s){const i=e+r/t,a=s?e+this.lastLevelLoadSec:0;return i+a}onLevelLoaded(e,t){const r=this.hls.config,{loading:s}=t.stats,i=s.end-s.first;at(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===gt.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=r?r.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+s.loaded,l=(a.loaded?a.loaded.duration:0)+i;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const i={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(K.FRAG_BUFFERED,i),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:s}=t,i=s!=null&&s.stats.loaded?s.stats:r.stats;if(i.aborted||this.ignoreFragment(r))return;const a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==gt.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,t,e,0,s,1,1);if(i>-1)return i;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=r&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:a}=r,o=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let u=i.abrBandWidthFactor,f=i.abrBandWidthUpFactor;if(c){const x=this.findBestLevel(l,a,s,c,0,u,f);if(x>=0)return this.rebufferNotice=-1,x}let m=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay;if(!c){const x=this.bitrateTestDelay;x&&(m=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-x,this.info(`bitrate test took ${Math.round(1e3*x)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),u=f=1)}const g=this.findBestLevel(l,a,s,c,m,u,f);if(this.rebufferNotice!==g&&(this.rebufferNotice=g,this.info(`${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${g}`)),g>-1)return g;const y=r.levels[a],b=r.loadLevelObj;return b&&y?.bitrate<b.bitrate?a:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,s,i,a,o){var l;const c=s+i,u=this.lastLoadedFragLevel,f=u===-1?this.hls.firstLevel:u,{fragCurrent:m,partCurrent:g}=this,{levels:y,allAudioTracks:b,loadLevel:x,config:S}=this.hls;if(y.length===1)return 0;const T=y[f],_=!!((l=this.hls.latestLevelDetails)!=null&&l.live),R=x===-1||u===-1;let I,C="SDR",L=T?.frameRate||0;const{audioPreference:k,videoPreference:M}=S,D=this.audioTracksByGroup||(this.audioTracksByGroup=hQ(b));let U=-1;if(R){if(this.firstSelection!==-1)return this.firstSelection;const j=this.codecTiers||(this.codecTiers=hLe(y,D,t,r)),q=dLe(j,C,e,k,M),{codecSet:H,videoRanges:N,minFramerate:O,minBitrate:z,minIndex:G,preferHDR:Y}=q;U=G,I=H,C=Y?N[N.length-1]:N[0],L=O,e=Math.max(e,z),this.log(`picked start tier ${Wn(q)}`)}else I=T?.codecSet,C=T?.videoRange;const $=g?g.duration:m?m.duration:0,V=this.bwEstimator.getEstimateTTFB()/1e3,B=[];for(let j=r;j>=t;j--){var W,F;const q=y[j],H=j>f;if(!q)continue;if(S.useMediaCapabilities&&!q.supportedResult&&!q.supportedPromise){const J=navigator.mediaCapabilities;typeof J?.decodingInfo=="function"&&tLe(q,D,C,L,e,k)?(q.supportedPromise=uQ(q,D,J,this.supportedCache),q.supportedPromise.then(ee=>{if(!this.hls)return;q.supportedResult=ee;const oe=this.hls.levels,te=oe.indexOf(q);ee.error?this.warn(`MediaCapabilities decodingInfo error: "${ee.error}" for level ${te} ${Wn(ee)}`):ee.supported?ee.decodingInfoResults.some(se=>se.smooth===!1||se.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${te} not smooth or powerEfficient: ${Wn(ee)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${te} ${Wn(ee)}`),te>-1&&oe.length>1&&(this.log(`Removing unsupported level ${te}`),this.hls.removeLevel(te),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):q.supportedResult=lQ}if((I&&q.codecSet!==I||C&&q.videoRange!==C||H&&L>q.frameRate||!H&&L>0&&L<q.frameRate||(W=q.supportedResult)!=null&&(F=W.decodingInfoResults)!=null&&F.some(J=>J.smooth===!1))&&(!R||j!==U)){B.push(j);continue}const N=q.details,O=(g?N?.partTarget:N?.averagetargetduration)||$;let z;H?z=o*e:z=a*e;const G=$&&s>=$*2&&i===0?q.averageBitrate:q.maxBitrate,Y=this.getTimeToLoadFrag(V,z,G*O,N===void 0);if(z>=G&&(j===u||q.loadError===0&&q.fragmentError===0)&&(Y<=V||!at(Y)||_&&!this.bitrateTestDelay||Y<c)){const J=this.forcedAutoLevel;return j!==x&&(J===-1||J!==x)&&(B.length&&this.trace(`Skipped level(s) ${B.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${y[B[0]].codecs}" ${y[B[0]].videoRange}; not compatible with "${I}" ${C}`),this.info(`switch candidate:${f}->${j} adjustedbw(${Math.round(z)})-bitrate=${Math.round(z-G)} ttfb:${V.toFixed(1)} avgDuration:${O.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${Y.toFixed(1)} firstSelection:${R} codecSet:${q.codecSet} videoRange:${q.videoRange} hls.loadLevel:${x}`)),R&&(this.firstSelection=j),j}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const fQ={search:function(n,e){let t=0,r=n.length-1,s=null,i=null;for(;t<=r;){s=(t+r)/2|0,i=n[s];const a=e(i);if(a>0)t=s+1;else if(a<0)r=s-1;else return i}return null}};function vLe(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!at(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<n.length;++i){const a=n[i];if(bLe(e,t,a))return a}return null}function Ad(n,e,t=0,r=0,s=.005){let i=null;if(n){i=e[1+n.sn-e[0].sn]||null;const o=n.endDTS-t;o>0&&o<15e-7&&(t+=15e-7),i&&n.level!==i.level&&i.end<=n.end&&(i=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&((!n||n.level===i.level)&&e6(t,r,i)===0||yLe(i,n,Math.min(s,r))))return i;const a=fQ.search(e,e6.bind(null,t,r));return a&&(a!==n||!i)?a:i}function yLe(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),t);return n.start<=r}return!1}function e6(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function bLe(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function mQ(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let r=n.fragments;const{fragmentHint:s}=n;s&&(r=r.concat(s));let i;return fQ.search(r,a=>a.cc<e?1:a.cc>e?-1:(i=a,a.end<=t?1:a.start>t?-1:0)),i||null}return null}function ME(n){switch(n.details){case _e.FRAG_LOAD_TIMEOUT:case _e.KEY_LOAD_TIMEOUT:case _e.LEVEL_LOAD_TIMEOUT:case _e.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function t6(n,e){const t=ME(e);return n.default[`${t?"timeout":"error"}Retry`]}function zP(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function n6(n){return Ln(Ln({},n),{errorRetry:null,timeoutRetry:null})}function OE(n,e,t,r){if(!n)return!1;const s=r?.code,i=e<n.maxNumRetry&&(xLe(s)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,i):i}function xLe(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}var Cs={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Fa={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class wLe extends eo{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(K.ERROR,this.onError,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(K.ERROR,this.onError,this),e.off(K.ERROR,this.onErrorOut,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===gt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const s=this.hls,i=t.context;switch(t.details){case _e.FRAG_LOAD_ERROR:case _e.FRAG_LOAD_TIMEOUT:case _e.KEY_LOAD_ERROR:case _e.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case _e.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Ov();return}case _e.FRAG_GAP:case _e.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Cs.SendAlternateToPenaltyBox;return}case _e.LEVEL_EMPTY_ERROR:case _e.LEVEL_PARSING_ERROR:{var a,o;const c=t.parent===gt.MAIN?t.level:s.loadLevel;t.details===_e.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case _e.LEVEL_LOAD_ERROR:case _e.LEVEL_LOAD_TIMEOUT:typeof i?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level));return;case _e.AUDIO_TRACK_LOAD_ERROR:case _e.AUDIO_TRACK_LOAD_TIMEOUT:case _e.SUBTITLE_LOAD_ERROR:case _e.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const c=s.loadLevelObj;if(c&&(i.type===nn.AUDIO_TRACK&&c.hasAudioGroup(i.groupId)||i.type===nn.SUBTITLE_TRACK&&c.hasSubtitleGroup(i.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Cs.SendAlternateToPenaltyBox,t.errorAction.flags=Fa.MoveAllAlternatesMatchingHost;return}}return;case _e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const c=s.loadLevelObj,u=c?.attrs["HDCP-LEVEL"];u?t.errorAction={action:Cs.SendAlternateToPenaltyBox,flags:Fa.MoveAllAlternatesMatchingHDCP,hdcpLevel:u}:this.keySystemError(t)}return;case _e.BUFFER_ADD_CODEC_ERROR:case _e.REMUX_ALLOC_ERROR:case _e.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:s.loadLevel)}return;case _e.INTERNAL_EXCEPTION:case _e.BUFFER_APPENDING_ERROR:case _e.BUFFER_FULL_ERROR:case _e.LEVEL_SWITCH_ERROR:case _e.BUFFER_STALLED_ERROR:case _e.BUFFER_SEEK_OVER_HOLE:case _e.BUFFER_NUDGE_ON_STALL:t.errorAction=Ov();return}t.type===xt.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,s=t6(r.config.playlistLoadPolicy,e),i=this.playlistError++;if(OE(s,i,ME(e),e.response))return{action:Cs.RetryRequest,flags:Fa.None,retryConfig:s,retryCount:i};const o=this.getLevelSwitchAction(e,t);return s&&(o.retryConfig=s,o.retryCount=i),o}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:a}=t.config,o=t6(e.details.startsWith("key")?a:i,e),l=t.levels.reduce((u,f)=>u+f.fragmentError,0);if(s&&(e.details!==_e.FRAG_GAP&&s.fragmentError++,OE(o,l,ME(e),e.response)))return{action:Cs.RetryRequest,flags:Fa.None,retryConfig:o,retryCount:l};const c=this.getLevelSwitchAction(e,r);return o&&(c.retryConfig=o,c.retryCount=l),c}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s){var i,a;const c=e.details;s.loadError++,c===_e.BUFFER_APPEND_ERROR&&s.fragmentError++;let u=-1;const{levels:f,loadLevel:m,minAutoLevel:g,maxAutoLevel:y}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const b=(i=e.frag)==null?void 0:i.type,S=(b===gt.AUDIO&&c===_e.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===_e.BUFFER_ADD_CODEC_ERROR||c===_e.BUFFER_APPEND_ERROR))&&f.some(({audioCodec:C})=>s.audioCodec!==C),_=e.sourceBufferName==="video"&&(c===_e.BUFFER_ADD_CODEC_ERROR||c===_e.BUFFER_APPEND_ERROR)&&f.some(({codecSet:C,audioCodec:L})=>s.codecSet!==C&&s.audioCodec===L),{type:R,groupId:I}=(a=e.context)!=null?a:{};for(let C=f.length;C--;){const L=(C+m)%f.length;if(L!==m&&L>=g&&L<=y&&f[L].loadError===0){var o,l;const k=f[L];if(c===_e.FRAG_GAP&&b===gt.MAIN&&e.frag){const M=f[L].details;if(M){const D=Ad(e.frag,M.fragments,e.frag.start);if(D!=null&&D.gap)continue}}else{if(R===nn.AUDIO_TRACK&&k.hasAudioGroup(I)||R===nn.SUBTITLE_TRACK&&k.hasSubtitleGroup(I))continue;if(b===gt.AUDIO&&(o=s.audioGroups)!=null&&o.some(M=>k.hasAudioGroup(M))||b===gt.SUBTITLE&&(l=s.subtitleGroups)!=null&&l.some(M=>k.hasSubtitleGroup(M))||S&&s.audioCodec===k.audioCodec||!S&&s.audioCodec!==k.audioCodec||_&&s.codecSet===k.codecSet)continue}u=L;break}}if(u>-1&&r.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:Cs.SendAlternateToPenaltyBox,flags:Fa.None,nextAutoLevel:u}}return{action:Cs.SendAlternateToPenaltyBox,flags:Fa.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Cs.DoNothing:break;case Cs.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==_e.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s,hdcpLevel:i,nextAutoLevel:a}=r;switch(s){case Fa.None:this.switchLevel(e,a);break;case Fa.MoveAllAlternatesMatchingHDCP:i&&(t.maxHdcpLevel=KI[KI.indexOf(i)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===_e.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=WI(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===r&&this.hls.removeLevel(i)}}}function Ov(n){const e={action:Cs.DoNothing,flags:Fa.None};return n&&(e.resolved=!0),e}var zr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class ELe{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.BUFFER_APPENDED,this.onBufferAppended,this),e.on(K.FRAG_BUFFERED,this.onFragBuffered,this),e.on(K.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.BUFFER_APPENDED,this.onBufferAppended,this),e.off(K.FRAG_BUFFERED,this.onFragBuffered,this),e.off(K.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const i=r[s];if(!i)break;const a=i.end;if(i.start<=e&&a!==null&&e<=a)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:s}=this,i=Object.keys(s);for(let a=i.length;a--;){const o=s[i[a]];if(o?.body.type===t&&(!r||o.buffered)){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,r,s,i){this.timeRanges&&(this.timeRanges[e]=t);const a=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||i)){l.body.type===r&&this.removeFragment(l.body);return}const c=l.range[e];if(c){if(c.time.length===0){this.removeFragment(l.body);return}c.time.some(u=>{const f=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return f&&this.removeFragment(l.body),f})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,s=Uh(r),i=this.fragments[s];if(!i||i.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(o=>{const l=r.elementaryStreams[o];if(!l)return;const c=t[o],u=a||l.partial===!0;i.range[o]=this.getBufferedTimes(r,e.part,u,c)}),i.loaded=null,Object.keys(i.range).length?(i.buffered=!0,(i.body.endList=r.endList||i.body.endList)&&(this.endListFragments[i.body.type]=i),kb(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=r6(r,s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=Uh(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,r,s){const i={time:[],partial:r},a=e.start,o=e.end,l=e.minEndPTS||o,c=e.maxStartPTS||a;for(let u=0;u<s.length;u++){const f=s.start(u)-this.bufferPadding,m=s.end(u)+this.bufferPadding;if(c>=f&&l<=m){i.time.push({startPTS:Math.max(a,s.start(u)),endPTS:Math.min(o,s.end(u))});break}else if(a<m&&o>f){const g=Math.max(a,s.start(u)),y=Math.min(o,s.end(u));y>g&&(i.partial=!0,i.time.push({startPTS:g,endPTS:y}))}else if(o<=f)break}return i}getPartialFragment(e){let t=null,r,s,i,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(c=>{const u=l[c];u&&kb(u)&&(s=u.body.start-o,i=u.body.end+o,e>=s&&e<=i&&(r=Math.min(e-s,i-e),a<=r&&(t=u.body,a=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||kb(t))}getState(e){const t=Uh(e),r=this.fragments[t];return r?r.buffered?kb(r)?zr.PARTIAL:zr.OK:zr.APPENDING:zr.NOT_LOADED}isTimeBuffered(e,t,r){let s,i;for(let a=0;a<r.length;a++){if(s=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=s&&t<=i)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,s=t.part?null:t,i=Uh(r);this.fragments[i]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:i,type:a}=t;if(r.sn==="initSegment")return;const o=r.type;if(s){let c=this.activePartLists[o];c||(this.activePartLists[o]=c=[]),c.push(s)}this.timeRanges=i;const l=i[a];this.detectEvictedFragments(a,l,o,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Uh(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let s=r.length;s--;){const i=t[r[s]];if(i?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==r||s&&!l.gap||l.start<t&&l.end>e&&(o.buffered||i)&&this.removeFragment(l)})}removeFragment(e){const t=Uh(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=r6(r,i=>i.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const r=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;r&&r.forEach(s=>s.clearElementaryStreamInfo())}}function kb(n){var e,t,r;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((r=n.range.audiovideo)==null?void 0:r.partial))}function Uh(n){return`${n.type}_${n.level}_${n.sn}`}function r6(n,e){return n.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var lu={cbc:0,ctr:1};class SLe{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case lu.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case lu.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function TLe(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class _Le{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],i=r[1],a=r[2],o=r[3],l=this.invSubMix,c=l[0],u=l[1],f=l[2],m=l[3],g=new Uint32Array(256);let y=0,b=0,x=0;for(x=0;x<256;x++)x<128?g[x]=x<<1:g[x]=x<<1^283;for(x=0;x<256;x++){let S=b^b<<1^b<<2^b<<3^b<<4;S=S>>>8^S&255^99,e[y]=S,t[S]=y;const T=g[y],_=g[T],R=g[_];let I=g[S]*257^S*16843008;s[y]=I<<24|I>>>8,i[y]=I<<16|I>>>16,a[y]=I<<8|I>>>24,o[y]=I,I=R*16843009^_*65537^T*257^y*16843008,c[S]=I<<24|I>>>8,u[S]=I<<16|I>>>16,f[S]=I<<8|I>>>24,m[S]=I,y?(y=T^g[g[g[R^T]]],b^=g[g[b]]):y=b=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const a=this.ksRows=(i+6+1)*4;let o,l;const c=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),f=this.sBox,m=this.rcon,g=this.invSubMix,y=g[0],b=g[1],x=g[2],S=g[3];let T,_;for(o=0;o<a;o++){if(o<i){T=c[o]=t[o];continue}_=T,o%i===0?(_=_<<8|_>>>24,_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255],_^=m[o/i|0]<<24):i>6&&o%i===4&&(_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255]),c[o]=T=(c[o-i]^_)>>>0}for(l=0;l<a;l++)o=a-l,l&3?_=c[o]:_=c[o-4],l<4||o<=4?u[l]=_:u[l]=y[f[_>>>24]]^b[f[_>>>16&255]]^x[f[_>>>8&255]]^S[f[_&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],c=o[1],u=o[2],f=o[3],m=this.uint8ArrayToUint32Array_(r);let g=m[0],y=m[1],b=m[2],x=m[3];const S=new Int32Array(e),T=new Int32Array(S.length);let _,R,I,C,L,k,M,D,U,$,V,B,W,F;const j=this.networkToHostOrderSwap;for(;t<S.length;){for(U=j(S[t]),$=j(S[t+1]),V=j(S[t+2]),B=j(S[t+3]),L=U^i[0],k=B^i[1],M=V^i[2],D=$^i[3],W=4,F=1;F<s;F++)_=l[L>>>24]^c[k>>16&255]^u[M>>8&255]^f[D&255]^i[W],R=l[k>>>24]^c[M>>16&255]^u[D>>8&255]^f[L&255]^i[W+1],I=l[M>>>24]^c[D>>16&255]^u[L>>8&255]^f[k&255]^i[W+2],C=l[D>>>24]^c[L>>16&255]^u[k>>8&255]^f[M&255]^i[W+3],L=_,k=R,M=I,D=C,W=W+4;_=a[L>>>24]<<24^a[k>>16&255]<<16^a[M>>8&255]<<8^a[D&255]^i[W],R=a[k>>>24]<<24^a[M>>16&255]<<16^a[D>>8&255]<<8^a[L&255]^i[W+1],I=a[M>>>24]<<24^a[D>>16&255]<<16^a[L>>8&255]<<8^a[k&255]^i[W+2],C=a[D>>>24]<<24^a[L>>16&255]<<16^a[k>>8&255]<<8^a[M&255]^i[W+3],T[t]=j(_^g),T[t+1]=j(C^y),T[t+2]=j(I^b),T[t+3]=j(R^x),g=U,y=$,b=V,x=B,t=t+4}return T.buffer}}class ALe{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=RLe(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function RLe(n){switch(n){case lu.cbc:return"AES-CBC";case lu.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const CLe=16;class GP{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?TLe(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,s){return this.useSoftware?new Promise((i,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,t,r,s);const l=this.flush();l?i(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,s)}softwareDecrypt(e,t,r,s){const{currentIV:i,currentResult:a,remainderData:o}=this;if(s!==lu.cbc||t.byteLength!==16)return vn.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=wa(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;i&&(r=i);let c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new _Le),c.expandKey(t);const u=a;return this.currentResult=c.decrypt(l.buffer,0,r),this.currentIV=l.slice(-16).buffer,u||null}webCryptoDecrypt(e,t,r,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,s));this.key=t,this.fastAesKey=new ALe(this.subtle,t,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new SLe(this.subtle,new Uint8Array(r),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(vn.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r,s)))}onWebCryptoError(e,t,r,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%CLe;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(vn.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const s6=Math.pow(2,17);class kLe{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new Il({type:xt.NETWORK_ERROR,details:_e.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){l(a6(e));return}else e.gap=!1;const c=this.loader=i?new i(s):new a(s),u=i6(e);e.loader=c;const f=n6(s.fragLoadPolicy.default),m={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:s6};e.stats=c.stats;const g={onSuccess:(y,b,x,S)=>{this.resetLoader(e,c);let T=y.data;x.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),o({frag:e,part:null,payload:T,networkDetails:S})},onError:(y,b,x,S)=>{this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ln({url:r,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:x,stats:S}))},onAbort:(y,b,x)=>{this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:x,stats:y}))},onTimeout:(y,b,x)=>{this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:x,stats:y}))}};t&&(g.onProgress=(y,b,x,S)=>t({frag:e,part:null,payload:x,networkDetails:S})),c.load(u,m,g)})}loadPart(e,t,r){this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(a6(e,t));return}const c=this.loader=i?new i(s):new a(s),u=i6(e,t);e.loader=c;const f=n6(s.fragLoadPolicy.default),m={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:s6};t.stats=c.stats,c.load(u,m,{onSuccess:(g,y,b,x)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:g.data,networkDetails:x};r(S),o(S)},onError:(g,y,b,x)=>{this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ln({url:u.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:b,stats:x}))},onAbort:(g,y,b)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:b,stats:g}))},onTimeout:(g,y,b)=>{this.resetLoader(e,c),l(new Il({type:xt.NETWORK_ERROR,details:_e.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:b,stats:g}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,i=s.total;if(r.loaded+=s.loaded,i){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(r.loaded/i),l),f=(l-c)*Math.round(r.loaded/c);r.total=r.loaded+f}else r.total=Math.max(r.loaded,r.total);const a=r.loading,o=s.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function i6(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,i=t.byteRangeEndOffset;if(at(s)&&at(i)){var a;let o=s,l=i;if(n.sn==="initSegment"&&ILe((a=n.decryptdata)==null?void 0:a.method)){const c=i-s;c%16&&(l=i+(16-c%16)),s!==0&&(r.resetIV=!0,o=s-16)}r.rangeStart=o,r.rangeEnd=l}return r}function a6(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:xt.MEDIA_ERROR,details:_e.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new Il(r)}function ILe(n){return n==="AES-128"||n==="AES-256"}class Il extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class pQ extends eo{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class qP{constructor(e,t,r,s=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ib(),this.buffering={audio:Ib(),video:Ib(),audiovideo:Ib()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=i,this.partial=a}}function Ib(){return{start:0,executeStart:0,executeEnd:0,end:0}}const o6={length:0,start:()=>0,end:()=>0};class Bt{static isBuffered(e,t){if(e){const r=Bt.getBuffered(e);for(let s=r.length;s--;)if(t>=r.start(s)&&t<=r.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=Bt.getBuffered(e);return Bt.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const s=Bt.bufferedRanges(e);if(s.length)return Bt.bufferedInfo(s,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((u,f)=>u.start-f.start||f.end-u.end);let s=-1,i=[];if(r)for(let u=0;u<e.length;u++){t>=e[u].start&&t<=e[u].end&&(s=u);const f=i.length;if(f){const m=i[f-1].end;e[u].start-m<r?e[u].end>m&&(i[f-1].end=e[u].end):i.push(e[u])}else i.push(e[u])}else i=e;let a=0,o,l=t,c=t;for(let u=0;u<i.length;u++){const f=i[u].start,m=i[u].end;if(s===-1&&t>=f&&t<=m&&(s=u),t+r>=f&&t<m)l=f,c=m,a=c-t;else if(t+r<f){o=f;break}}return{len:a,start:l||0,end:c||0,nextStart:o,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||o6}catch(t){return vn.log("failed to get media.buffered",t),o6}}}const gQ=/\{\$([a-zA-Z0-9-_]+)\}/g;function l6(n){return gQ.test(n)}function YI(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(gQ,r=>{const s=r.substring(2,r.length-1),i=t?.[s];return i===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):i})}return e}function c6(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(s))i=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=e.NAME,i=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=i||""}function LLe(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const DLe=/^(\d+)x(\d+)$/,u6=/(.+?)=(".*?"|.*?)(?:,|$)/g;class nr{constructor(e,t){typeof e=="string"&&(e=nr.parseAttrList(e,t)),_n(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=DLe.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const s={};for(u6.lastIndex=0;(r=u6.exec(e))!==null;){const a=r[1].trim();let o=r[2];const l=o.indexOf('"')===0&&o.lastIndexOf('"')===o.length-1;let c=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":c=!0}if(t&&(l||c))o=YI(t,o);else if(!c&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":vn.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=o}return s}}const PLe="com.apple.hls.interstitial";function MLe(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function OLe(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class vQ{constructor(e,t,r=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(s=t?.tagOrder)!=null?s:r,t){const i=t.attr;for(const a in i)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==i[a]){vn.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=_n(new nr({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=t?.endDate||new Date(this.attr["END-DATE"]);at(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(vn.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(at(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===PLe}get isValid(){return!!this.id&&!this._badValueForSameId&&at(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const NLe=10;class jLe{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?at(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||NLe}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Df(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function WP(n){switch(n){case"AES-128":case"AES-256":return lu.cbc;case"AES-256-CTR":return lu.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function yQ(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function XI(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function FLe(n){const e=XI(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function ULe(n){const e=function(r,s,i){const a=r[s];r[s]=r[i],r[i]=a};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function $Le(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const i=s[0]==="base64",a=s[1];i?(r.splice(-1,1),t=yQ(a)):t=FLe(a)}}return t}const NE=typeof self<"u"?self:void 0;var Sr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ui={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function QI(n){switch(n){case ui.FAIRPLAY:return Sr.FAIRPLAY;case ui.PLAYREADY:return Sr.PLAYREADY;case ui.WIDEVINE:return Sr.WIDEVINE;case ui.CLEARKEY:return Sr.CLEARKEY}}function d6(n){switch(n){case Sr.FAIRPLAY:return ui.FAIRPLAY;case Sr.PLAYREADY:return ui.PLAYREADY;case Sr.WIDEVINE:return ui.WIDEVINE;case Sr.CLEARKEY:return ui.CLEARKEY}}function Ox(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[Sr.FAIRPLAY,Sr.WIDEVINE,Sr.PLAYREADY,Sr.CLEARKEY].filter(s=>!!e[s]):[];return!r[Sr.WIDEVINE]&&t&&r.push(Sr.WIDEVINE),r}const bQ=function(n){return NE!=null&&(n=NE.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function BLe(n,e,t,r){let s;switch(n){case Sr.FAIRPLAY:s=["cenc","sinf"];break;case Sr.WIDEVINE:case Sr.PLAYREADY:s=["cenc"];break;case Sr.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return HLe(s,e,t,r)}function HLe(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function VLe(n){var e;return n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function zLe(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=yQ(o).subarray(0,16);return ULe(l),l}}return null}let Lb={};class JS{static clearKeyUriToKeyIdMap(){Lb={}}constructor(e,t,r,s=[1],i=null,a){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Df(e),a!=null&&a.startsWith("0x")&&(this.keyId=new Uint8Array(JX(a)))}matches(e){var t,r;return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&e.keyFormatVersions.join(",")===this.keyFormatVersions.join(",")&&((t=e.iv)==null?void 0:t.join(","))===((r=this.iv)==null?void 0:r.join(","))}isSupported(){if(this.method){if(Df(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ui.FAIRPLAY:case ui.WIDEVINE:case ui.PLAYREADY:case ui.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Df(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(vn.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=GLe(e);return new JS(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.pssh&&this.keyId)return this;const t=$Le(this.uri);if(t)switch(this.keyFormat){case ui.WIDEVINE:if(this.pssh=t,!this.keyId&&t.length>=22){const r=t.length-22;this.keyId=t.subarray(r,r+16)}break;case ui.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=YIe(r,null,t),this.keyId=zLe(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){const s=new Uint8Array(16);s.set(r,16-r.length),r=s}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=Lb[this.uri];if(!r){const s=Object.keys(Lb).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,s),Lb[this.uri]=r}this.keyId=r}return this}}function GLe(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const h6=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,f6=/#EXT-X-MEDIA:(.*)/g,qLe=/^#EXT(?:INF|-X-TARGETDURATION):/m,oR=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),WLe=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class jo{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static resolve(e,t){return UP.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return qLe.test(e)}static parseMasterPlaylist(e,t){const r=l6(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},i=[];h6.lastIndex=0;let a;for(;(a=h6.exec(e))!=null;)if(a[1]){var o;const c=new nr(a[1],s),u=YI(s,a[2]),f={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:jo.resolve(u,t)},m=c.decimalResolution("RESOLUTION");m&&(f.width=m.width,f.height=m.height),g6(c.CODECS,f);const g=c["SUPPLEMENTAL-CODECS"];g&&(f.supplemental={},g6(g,f.supplemental)),(o=f.unknownCodecs)!=null&&o.length||i.push(f),s.levels.push(f)}else if(a[3]){const c=a[3],u=a[4];switch(c){case"SESSION-DATA":{const f=new nr(u,s),m=f["DATA-ID"];m&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[m]=f);break}case"SESSION-KEY":{const f=m6(u,t,s);f.encrypted&&f.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(f)):vn.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":{{const f=new nr(u,s);c6(s,f,t)}break}case"CONTENT-STEERING":{const f=new nr(u,s);s.contentSteering={uri:jo.resolve(f["SERVER-URI"],t),pathwayId:f["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=p6(u);break}}}const l=i.length>0&&i.length<s.levels.length;return s.levels=l?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const i={},a=r.levels,o={AUDIO:a.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:a.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(f6.lastIndex=0;(s=f6.exec(e))!==null;){const c=new nr(s[1],r),u=c.TYPE;if(u){const f=o[u],m=i[u]||[];i[u]=m;const g=c.LANGUAGE,y=c["ASSOC-LANGUAGE"],b=c.CHANNELS,x=c.CHARACTERISTICS,S=c["INSTREAM-ID"],T={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||g||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:g,url:c.URI?jo.resolve(c.URI,t):""};if(y&&(T.assocLang=y),b&&(T.channels=b),x&&(T.characteristics=x),S&&(T.instreamId=S),f!=null&&f.length){const _=jo.findGroup(f,T.groupId)||f[0];v6(T,_,"audioCodec"),v6(T,_,"textCodec")}m.push(T)}}return i}static parseLevelPlaylist(e,t,r,s,i,a){var o;const l={url:t},c=new jLe(t),u=c.fragments,f=[];let m=null,g=0,y=0,b=0,x=0,S=0,T=null,_=new sR(s,l),R,I,C,L=-1,k=!1,M=null,D;if(oR.lastIndex=0,c.m3u8=e,c.hasVariableRefs=l6(e),((o=oR.exec(e))==null?void 0:o[0])!=="#EXTM3U")return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;(R=oR.exec(e))!==null;){k&&(k=!1,_=new sR(s,l),_.playlistOffset=b,_.start=b,_.sn=g,_.cc=x,S&&(_.bitrate=S),_.level=r,m&&(_.initSegment=m,m.rawProgramDateTime&&(_.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),M&&(_.setByteRange(M),M=null)));const B=R[1];if(B){_.duration=parseFloat(B);const W=(" "+R[2]).slice(1);_.title=W||null,_.tagList.push(W?["INF",B,W]:["INF",B])}else if(R[3]){if(at(_.duration)){_.playlistOffset=b,_.start=b,C&&b6(_,C,c),_.sn=g,_.level=r,_.cc=x,u.push(_);const W=(" "+R[3]).slice(1);_.relurl=YI(c,W),ZI(_,T,f),T=_,b+=_.duration,g++,y=0,k=!0}}else{if(R=R[0].match(WLe),!R){vn.warn("No matches on slow regex match for level playlist!");continue}for(I=1;I<R.length&&R[I]===void 0;I++);const W=(" "+R[I]).slice(1),F=(" "+R[I+1]).slice(1),j=R[I+2]?(" "+R[I+2]).slice(1):null;switch(W){case"BYTERANGE":T?_.setByteRange(F,T):_.setByteRange(F);break;case"PROGRAM-DATE-TIME":_.rawProgramDateTime=F,_.tagList.push(["PROGRAM-DATE-TIME",F]),L===-1&&(L=u.length);break;case"PLAYLIST-TYPE":c.type&&xl(c,W,R),c.type=F.toUpperCase();break;case"MEDIA-SEQUENCE":c.startSN!==0?xl(c,W,R):u.length>0&&x6(c,W,R),g=c.startSN=parseInt(F);break;case"SKIP":{c.skippedSegments&&xl(c,W,R);const q=new nr(F,c),H=q.decimalInteger("SKIPPED-SEGMENTS");if(at(H)){c.skippedSegments+=H;for(let O=H;O--;)u.push(null);g+=H}const N=q.enumeratedString("RECENTLY-REMOVED-DATERANGES");N&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(N.split("	")));break}case"TARGETDURATION":c.targetduration!==0&&xl(c,W,R),c.targetduration=Math.max(parseInt(F),1);break;case"VERSION":c.version!==null&&xl(c,W,R),c.version=parseInt(F);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||xl(c,W,R),c.live=!1;break;case"#":(F||j)&&_.tagList.push(j?[F,j]:[F]);break;case"DISCONTINUITY":x++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([W]);break;case"BITRATE":_.tagList.push([W,F]),S=parseInt(F)*1e3,at(S)?_.bitrate=S:S=0;break;case"DATERANGE":{const q=new nr(F,c),H=new vQ(q,c.dateRanges[q.ID],c.dateRangeTagCount);c.dateRangeTagCount++,H.isValid||c.skippedSegments?c.dateRanges[H.id]=H:vn.warn(`Ignoring invalid DATERANGE tag: "${F}"`),_.tagList.push(["EXT-X-DATERANGE",F]);break}case"DEFINE":{{const q=new nr(F,c);"IMPORT"in q?LLe(c,q,a):c6(c,q,t)}break}case"DISCONTINUITY-SEQUENCE":c.startCC!==0?xl(c,W,R):u.length>0&&x6(c,W,R),c.startCC=x=parseInt(F);break;case"KEY":{const q=m6(F,t,c);if(q.isSupported()){if(q.method==="NONE"){C=void 0;break}C||(C={});const H=C[q.keyFormat];H!=null&&H.matches(q)||(H&&(C=_n({},C)),C[q.keyFormat]=q)}else vn.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${F}"`);break}case"START":c.startTimeOffset=p6(F);break;case"MAP":{const q=new nr(F,c);if(_.duration){const H=new sR(s,l);y6(H,q,r,C),m=H,_.initSegment=m,m.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=m.rawProgramDateTime)}else{const H=_.byteRangeEndOffset;if(H){const N=_.byteRangeStartOffset;M=`${H-N}@${N}`}else M=null;y6(_,q,r,C),m=_,k=!0}m.cc=x;break}case"SERVER-CONTROL":{D&&xl(c,W,R),D=new nr(F),c.canBlockReload=D.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=D.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&D.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=D.optionalFloat("PART-HOLD-BACK",0),c.holdBack=D.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{c.partTarget&&xl(c,W,R);const q=new nr(F);c.partTarget=q.decimalFloatingPoint("PART-TARGET");break}case"PART":{let q=c.partList;q||(q=c.partList=[]);const H=y>0?q[q.length-1]:void 0,N=y++,O=new nr(F,c),z=new OIe(O,_,l,N,H);q.push(z),_.duration+=z.duration;break}case"PRELOAD-HINT":{const q=new nr(F,c);c.preloadHint=q;break}case"RENDITION-REPORT":{const q=new nr(F,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(q);break}default:vn.warn(`line parsed but not handled: ${R}`);break}}}T&&!T.relurl?(u.pop(),b-=T.duration,c.partList&&(c.fragmentHint=T)):c.partList&&(ZI(_,T,f),_.cc=x,c.fragmentHint=_,C&&b6(_,C,c)),c.targetduration||(c.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const U=u.length,$=u[0],V=u[U-1];if(b+=c.skippedSegments*c.targetduration,b>0&&U&&V){c.averagetargetduration=b/U;const B=V.sn;c.endSN=B!=="initSegment"?B:0,c.live||(V.endList=!0),$&&c.startCC===void 0&&(c.startCC=$.cc),L>0&&(YLe(u,L),$&&f.unshift($))}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(b+=c.fragmentHint.duration),c.totalduration=b,f.length&&c.dateRangeTagCount&&$&&xQ(f,c),c.endCC=x,c}}function xQ(n,e){const t=n.length;if(!t)return;const r=n[t-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let a=i.length;a--;){const o=e.dateRanges[i[a]],l=o.startDate.getTime();o.tagAnchor=r.ref;for(let c=t;c--;){const u=KLe(e,l,n,c,s);if(u!==-1){o.tagAnchor=e.fragments[u].ref;break}}}}function KLe(n,e,t,r,s){const i=t[r];if(i){const o=i.programDateTime;if(e>=o||r===0){var a;const l=(((a=t[r+1])==null?void 0:a.start)||s)-i.start;if(e<=o+l*1e3){const c=t[r].sn-n.startSN,u=n.fragments;if(u.length>t.length){const m=(t[r+1]||u[u.length-1]).sn-n.startSN;for(let g=m;g>c;g--){const y=u[g].programDateTime;if(e>=y&&e<y+u[g].duration*1e3)return g}}return c}}}return-1}function m6(n,e,t){var r,s;const i=new nr(n,t),a=(r=i.METHOD)!=null?r:"",o=i.URI,l=i.hexadecimalInteger("IV"),c=i.KEYFORMATVERSIONS,u=(s=i.KEYFORMAT)!=null?s:"identity";o&&i.IV&&!l&&vn.error(`Invalid IV: ${i.IV}`);const f=o?jo.resolve(o,e):"",m=(c||"1").split("/").map(Number).filter(Number.isFinite);return new JS(a,f,u,m,l,i.KEYID)}function p6(n){const t=new nr(n).decimalFloatingPoint("TIME-OFFSET");return at(t)?t:null}function g6(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const s=t.filter(i=>HP(i,r));s.length&&(e[`${r}Codec`]=s.map(i=>i.split("/")[0]).join(","),t=t.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=t}function v6(n,e,t){const r=e[t];r&&(n[t]=r)}function YLe(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function ZI(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function y6(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function b6(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}function xl(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function x6(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function lR(n,e){const t=e.startPTS;if(at(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&s.setDuration(r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function wQ(n,e,t,r,s,i){r-t<=0&&(vn.warn("Fragment should have a positive duration",e),r=t+e.duration,i=s+e.duration);let o=t,l=r;const c=e.startPTS,u=e.endPTS;if(at(c)){const x=Math.abs(c-t);at(e.deltaPTS)?e.deltaPTS=Math.max(x,e.deltaPTS):e.deltaPTS=x,o=Math.max(t,c),t=Math.min(t,c),s=Math.min(s,e.startDTS),l=Math.min(r,u),r=Math.max(r,u),i=Math.max(i,e.endDTS)}const f=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=o,e.startDTS=s,e.endPTS=r,e.minEndPTS=l,e.endDTS=i;const m=e.sn;if(!n||m<n.startSN||m>n.endSN)return 0;let g;const y=m-n.startSN,b=n.fragments;for(b[y]=e,g=y;g>0;g--)lR(b[g],b[g-1]);for(g=y;g<b.length-1;g++)lR(b[g],b[g+1]);return n.fragmentHint&&lR(b[b.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,f}function XLe(n,e){if(n===e)return;let t=null;const r=n.fragments;for(let c=r.length-1;c>=0;c--){const u=r[c].initSegment;if(u){t=u;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let s;JLe(n,e,(c,u,f,m)=>{if((!e.startCC||e.skippedSegments)&&u.cc!==c.cc){const g=c.cc-u.cc;for(let y=f;y<m.length;y++)m[y].cc+=g;e.endCC=m[m.length-1].cc}at(c.startPTS)&&at(c.endPTS)&&(u.setStart(u.startPTS=c.startPTS),u.startDTS=c.startDTS,u.maxStartPTS=c.maxStartPTS,u.endPTS=c.endPTS,u.endDTS=c.endDTS,u.minEndPTS=c.minEndPTS,u.setDuration(c.endPTS-c.startPTS),u.duration&&(s=u),e.PTSKnown=e.alignedSliding=!0),c.hasStreams&&(u.elementaryStreams=c.elementaryStreams),u.loader=c.loader,c.hasStats&&(u.stats=c.stats),c.initSegment&&(u.initSegment=c.initSegment,t=c.initSegment)});const i=e.fragments,a=e.fragmentHint?i.concat(e.fragmentHint):i;if(t&&a.forEach(c=>{var u;c&&(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=i.some(c=>!c),e.deltaUpdateFailed){vn.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let c=e.skippedSegments;c--;)i.shift();e.startSN=i[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=QLe(n.dateRanges,e));const c=n.fragments.filter(u=>u.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let u=1;u<a.length;u++)a[u].programDateTime===null&&ZI(a[u],a[u-1],c);xQ(c,e)}e.endCC=i[i.length-1].cc}if(!e.startCC){var o;const c=TQ(n,e.startSN-1);e.startCC=(o=c?.cc)!=null?o:i[0].cc}ZLe(n.partList,e.partList,(c,u)=>{u.elementaryStreams=c.elementaryStreams,u.stats=c.stats}),s?wQ(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):EQ(n,e),i.length&&(e.totalduration=e.edge-i[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const l=e.advancedDateTime;if(e.advanced&&l){const c=e.edge;e.driftStart||(e.driftStartTime=l,e.driftStart=c),e.driftEndTime=l,e.driftEnd=c}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function QLe(n,e){const{dateRanges:t,recentlyRemovedDateranges:r}=e,s=_n({},n);r&&r.forEach(o=>{delete s[o]});const a=Object.keys(s).length;return a&&Object.keys(t).forEach(o=>{const l=s[o],c=new vQ(t[o].attr,l);c.isValid?(s[o]=c,l||(c.tagOrder+=a)):vn.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Wn(t[o].attr)}"`)}),s}function ZLe(n,e,t){if(n&&e){let r=0;for(let s=0,i=n.length;s<=i;s++){const a=n[s],o=e[s+r];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):r--}}}function JLe(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,i=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,a=e.startSN-n.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let c=s;c<=i;c++){const u=l[a+c];let f=o[c];if(r&&!f&&u&&(f=e.fragments[c]=u),u&&f){if(t(u,f,c,o),u.url&&u.url!==f.url){e.playlistParsingError=w6(`media sequence mismatch ${f.sn}:`,n,e,u,f);return}else if(u.cc!==f.cc){e.playlistParsingError=w6(`discontinuity sequence mismatch (${u.cc}!=${f.cc})`,n,e,u,f);return}}}}function w6(n,e,t,r,s){return new Error(`${n} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function EQ(n,e,t=!0){const r=e.startSN+e.skippedSegments-n.startSN,s=n.fragments,i=r>=0;let a=0;if(i&&r<s.length)a=s[r].start;else if(i&&e.startSN===n.endSN+1)a=n.fragmentEnd;else if(i&&t)a=n.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=n.fragmentStart;else return;JI(e,a)}function JI(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function SQ(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const i=r[r.length-1].duration*1e3;i<t&&(t=i)}}else t/=2;return Math.round(t)}function TQ(n,e,t){if(!n)return null;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function E6(n,e,t){return n?_Q(n.partList,e,t):null}function _Q(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function AQ(n){n.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function jg(n,e){for(let r=0,s=n.length;r<s;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function eDe(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function S6(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function RQ(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)S6(t[r],n);e.fragmentHint&&S6(e.fragmentHint,n),e.alignedSliding=!0}function tDe(n,e){n&&(CQ(e,n),!e.alignedSliding&&n&&jE(e,n),!e.alignedSliding&&n&&!e.skippedSegments&&EQ(n,e,!1))}function CQ(n,e){if(!eDe(e,n))return;const t=Math.min(e.endCC,n.endCC),r=jg(e.fragments,t),s=jg(n.fragments,t);if(!r||!s)return;vn.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const i=r.start-s.start;RQ(i,n)}function jE(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let s,i;const a=Math.min(e.endCC,n.endCC);e.startCC<a&&n.startCC<a&&(s=jg(r,a),i=jg(t,a)),(!s||!i)&&(s=r[Math.floor(r.length/2)],i=jg(t,s.cc)||t[Math.floor(t.length/2)]);const o=s.programDateTime,l=i.programDateTime;if(!o||!l)return;const c=(l-o)/1e3-(i.start-s.start);RQ(c,n)}const nDe={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},$e={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class KP extends pQ{constructor(e,t,r,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=$e.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:l,mediaBuffer:c,state:u}=this,f=l?l.currentTime:0,m=Bt.bufferInfo(c||l,f,a.maxBufferHole),g=!m.len;if(this.log(`Media seeking to ${at(f)?f.toFixed(3):f}, state: ${u}, ${g?"out of":"in"} buffer`),this.state===$e.ENDED)this.resetLoadingState();else if(o){const y=a.maxFragLookUpTolerance,b=o.start-y,x=o.start+o.duration+y;if(g||x<m.start||b>m.end){const S=f>x;(f<b||S)&&(S&&o.loader&&(this.log(`Cancelling fragment load for seek (sn: ${o.sn})`),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(f,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(f>y&&(this.lastCurrentTime=f),!this.loadingParts){const b=Math.max(m.end,f),x=this.shouldLoadParts(this.getLevelDetails(),b);x&&(this.log(`LL-Part loading ON after seeking to ${f.toFixed(2)} with buffer @${b.toFixed(2)}`),this.loadingParts=x)}}this.hls.hasEnoughToStart||(this.log(`Setting ${g?"startPosition":"nextLoadPosition"} to ${f} for seek without enough to start`),this.nextLoadPosition=f,g&&(this.startPosition=f)),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new kLe(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new GP(e.config)}registerListeners(){const{hls:e}=this;e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(K.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===$e.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=$e.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,s=this.config.timelineOffset||0;if(r<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=Bt.bufferedInfo(i,e.start,0));const a=e.nextStart;if(a&&a>s&&a<t.edge||this.media.currentTime<e.start)return!1;const l=t.partList;if(l!=null&&l.length){const u=l[l.length-1];return Bt.isBuffered(this.media,u.start+u.duration/2)}const c=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(c)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),r.addEventListener("seeking",this.onMediaSeeking),r.addEventListener("ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===$e.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=$e.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=i=>{const a=i.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(a,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,t,r,s).then(i=>{if(!i)return;const a=this.state,o=i.frag;if(this.fragContextChanged(o)){(a===$e.FRAG_LOADING||!this.fragCurrent&&a===$e.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=$e.IDLE);return}"payload"in i&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(K.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===$e.STOPPED||this.state===$e.ERROR||(this.warn(`Frag error: ${i?.message||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===zr.APPENDING){const i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===zr.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(K.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const s=r?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{frag:i,payload:a}=r,o=i.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&Df(o.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,WP(o.method)).catch(c=>{throw s.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:i}),c}).then(c=>{const u=self.performance.now();return s.trigger(K.FRAG_DECRYPTED,{frag:i,payload:c,stats:{tstart:l,tdecrypt:u}}),r.payload=c,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===$e.STOPPED||this.state===$e.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==$e.STOPPED&&(this.state=$e.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?nDe.toString(Bt.getBuffered(r)):"(detached)"})`),Nr(e)){var s;if(e.type!==gt.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=$e.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=$e.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:i}=e,a=!i||i.length===0||i.some(l=>!l),o=new qP(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var i;this.fragCurrent=e;const a=t?.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;e.encrypted&&!((i=e.decryptdata)!=null&&i.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=$e.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(f=>{if(!this.fragContextChanged(f.frag))return this.hls.trigger(K.KEY_LOADED,f),this.state===$e.KEY_LOADING&&(this.state=$e.IDLE),f}),this.hls.trigger(K.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments,this.startFragRequested),o&&this.log("[eme] blocking frag load until media-keys acquired"));const l=this.fragPrevious;if(Nr(e)&&(!l||e.sn!==l.sn)){const f=this.shouldLoadParts(t.details,e.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} loading sn ${l?.sn}->${e.sn}`),this.loadingParts=f)}if(r=Math.max(e.start,r||0),this.loadingParts&&Nr(e)){const f=a.partList;if(f&&s){r>e.end&&a.fragmentHint&&(e=a.fragmentHint);const m=this.getNextPart(f,e,r);if(m>-1){const g=f[m];e=this.fragCurrent=g.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${g.index} (${m}/${f.length-1}) of ${this.fragInfo(e,!1,g)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=g.start+g.duration,this.state=$e.FRAG_LOADING;let y;return o?y=o.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,g,t,s)).catch(b=>this.handleFragLoadError(b)):y=this.doFragPartsLoad(e,g,t,s).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(K.FRAG_LOADING,{frag:e,part:g,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):y}else if(!e.url||this.loadedEndOfParts(f,r))return Promise.resolve(null)}}if(Nr(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(r.toFixed(3))}`),at(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=$e.FRAG_LOADING;const c=this.config.progressive;let u;return c&&o?u=o.then(f=>!f||this.fragContextChanged(f?.frag)?null:this.fragmentLoader.load(e,s)).catch(f=>this.handleFragLoadError(f)):u=Promise.all([this.fragmentLoader.load(e,c?s:void 0),o]).then(([f])=>(!c&&f&&s&&s(f),f)).catch(f=>this.handleFragLoadError(f)),this.hls.trigger(K.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,r,s){return new Promise((i,a)=>{var o;const l=[],c=(o=r.details)==null?void 0:o.partList,u=f=>{this.fragmentLoader.loadPart(e,f,s).then(m=>{l[f.index]=m;const g=m.part;this.hls.trigger(K.FRAG_LOADED,m);const y=E6(r.details,e.sn,f.index+1)||_Q(c,e.sn,f.index+1);if(y)u(y);else return i({frag:e,part:g,partsLoaded:l})}).catch(a)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===_e.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(K.ERROR,t)}else this.hls.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==$e.PARSING){!this.fragCurrent&&this.state!==$e.STOPPED&&this.state!==$e.ERROR&&(this.state=$e.IDLE);return}const{frag:r,part:s,level:i}=t,a=self.performance.now();r.stats.parsing.end=a,s&&(s.stats.parsing.end=a);const o=this.getLevelDetails(),c=o&&r.sn>o.endSN||this.shouldLoadParts(o,r.end);c!==this.loadingParts&&(this.log(`LL-Part loading ${c?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=c),this.updateLevelTiming(r,s,i,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var r;const i=e.partList[0],a=i.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:i,part:a}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const o=t[s],l=o.details,c=a>-1?E6(l,i,a):null,u=c?c.fragment:TQ(l,i,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:c,level:o}):null}bufferFragmentData(e,t,r,s,i){var a;if(!e||this.state!==$e.PARSING)return;const{data1:o,data2:l}=e;let c=o;if(o&&l&&(c=wa(o,l)),!((a=c)!=null&&a.length))return;const u=this.initPTS[t.cc],f=u?-u.baseTime/u.timescale:void 0,m={type:e.type,frag:t,part:r,chunkMeta:s,offset:f,parent:t.type,data:c};if(this.hls.trigger(K.BUFFER_APPENDING,m),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Bt.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=Bt.bufferInfo(t,r,0),i=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),o=Math.max(Math.min(e.start-a,s.end-a),r+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){var r;const s=this.getLoadPosition();if(!at(s))return null;const a=this.lastCurrentTime>s||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,a)}getFwdBufferInfoAtPos(e,t,r,s){const i=Bt.bufferInfo(e,t,s);if(i.len===0&&i.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(i.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(i.nextStart,a.end)-t,s);return Bt.bufferInfo(e,t,o)}}return i}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,s=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-t*3,r.maxMaxBufferLength/2,s);return i>=s?(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,t=gt.MAIN){var r;const s=(r=this.fragmentTracker)==null?void 0:r.getAppendedFrag(e,t);return s&&"fragment"in s?s.fragment:s}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:i}=this,a=r[0].start,o=i.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const f=i.initialLiveManifestSize;if(s<f)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${f})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var c;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t);const m=this.hls.startPosition,g=this.hls.liveSyncPosition,y=l?(m!==-1&&m>=a?m:g)||l.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${m} liveSyncPosition: ${g} frag.start: ${(c=l)==null?void 0:c.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=a&&(l=r[0]);if(!l){const f=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,f,t)}let u=this.filterReplacedPrimary(l,t);if(!u&&l){const f=l.sn-t.startSN;u=this.filterReplacedPrimary(r[f+1]||null,t)}return this.mapToInitFragWhenRequired(u)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===zr.OK||r===zr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,i){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&r.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s,0);if(o!==null&&r.len+o.len>=i){const l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(T6(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(T6(this.hls.config)&&e.type!==gt.SUBTITLE){const r=this.hls.interstitialsManager,s=r?.bufferingItem;if(s){const a=s.event;if(a){if(a.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&t?.live===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=r?.playerQueue;if(i)for(let a=i.length;a--;){const o=i[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,i=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const c=e[o];if(a=a&&!c.independent,s>-1&&r<c.start)break;const u=c.loaded;u?s=-1:(i||c.independent||a)&&c.fragment===t&&(s=o),i=u}return s}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=vLe(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const a=t[i-e.startSN];r.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=mQ(e,r.cc,r.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:i}=this,{fragments:a,endSN:o}=r;const{fragmentHint:l}=r,{maxFragLookUpTolerance:c}=s,u=r.partList,f=!!(this.loadingParts&&u!=null&&u.length&&l);f&&l&&!this.bitrateTest&&u[u.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let m;if(e<t){var g;const b=e<this.lastCurrentTime||e>t-c||(g=this.media)!=null&&g.paused||!this.startFragRequested?0:c;m=Ad(i,a,e,b)}else m=a[a.length-1];if(m){const y=m.sn-r.startSN,b=this.fragmentTracker.getState(m);if((b===zr.OK||b===zr.PARTIAL&&m.gap)&&(i=m),i&&m.sn===i.sn&&(!f||u[0].fragment.sn>m.sn||!r.live&&!f)&&i&&m.level===i.level){const S=a[y+1];m.sn<o&&this.fragmentTracker.getState(S)!==zr.OK?m=S:m=null}}return m}alignPlaylists(e,t,r){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,a=!t,o=e.alignedSliding&&at(i);if(a||!o&&!i){tDe(r,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),l}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const s=this.timelineOffset;if(r===-1){const i=this.startTimeOffset!==null,a=i?this.startTimeOffset:e.startTimeOffset;a!==null&&at(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${a} found in ${i?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+s}this.nextLoadPosition=r+s}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Nr(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==$e.FRAG_LOADING_WAITING_RETRY)&&(this.state=$e.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const y=this.getCurrentContext(t.chunkMeta);y&&(t.frag=y.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var s;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const i=t.details===_e.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(r,!0);const a=t.errorAction,{action:o,flags:l,retryCount:c=0,retryConfig:u}=a||{},f=!!a&&!!u,m=f&&o===Cs.RetryRequest,g=f&&!a.resolved&&l===Fa.MoveAllAlternatesMatchingHost;if(!m&&g&&Nr(r)&&!r.endList)this.resetFragmentErrors(e),this.treatAsGap(r),a.resolved=!0;else if((m||g)&&c<u.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const y=zP(u,c);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${c+1}/${u.maxNumRetry} in ${y}ms`),a.resolved=!0,this.retryDate=self.performance.now()+y,this.state=$e.FRAG_LOADING_WAITING_RETRY}else if(u&&a)if(this.resetFragmentErrors(e),c<u.maxNumRetry)!i&&o!==Cs.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${c})`);return}else o===Cs.SendAlternateToPenaltyBox?this.state=$e.WAITING_LEVEL:this.state=$e.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===$e.PARSING||this.state===$e.PARSED){const t=e.frag,r=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,r),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,t?.duration||10);const a=!i;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===gt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==$e.STOPPED&&(this.state=$e.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=Bt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===$e.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==$e.STOPPED&&(this.state=$e.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){const i=r.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const u=e.elementaryStreams[c];if(u){const f=u.endPTS-u.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${f})`),l||!1;const m=s?0:wQ(i,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(K.LEVEL_PTS_UPDATED,{details:i,level:r,drift:m,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)){var o;if(r.fragmentError===0&&this.treatAsGap(e,r),((o=this.transmuxer)==null?void 0:o.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=$e.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(K.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===gt.MAIN?"level":"track"}fragInfo(e,t=!0,r){var s,i;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((s=t&&!r?e.startPTS:(r||e).start)!=null?s:NaN).toFixed(3)}-${((i=t&&!r?e.endPTS:(r||e).end)!=null?i:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function T6(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class kQ{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=rDe(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function rDe(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const i=n[s];t.set(i,r),r+=i.length}return t}var cR={exports:{}},_6;function sDe(){return _6||(_6=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var g=new s(u,f||l,m),y=t?t+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],g]:l._events[y].push(g):(l._events[y]=g,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,f;if(this._eventsCount===0)return c;for(f in u=this._events)e.call(u,f)&&c.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=t?t+c:c,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,g=f.length,y=new Array(g);m<g;m++)y[m]=f[m].fn;return y},o.prototype.listenerCount=function(c){var u=t?t+c:c,f=this._events[u];return f?f.fn?1:f.length:0},o.prototype.emit=function(c,u,f,m,g,y){var b=t?t+c:c;if(!this._events[b])return!1;var x=this._events[b],S=arguments.length,T,_;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),S){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,f),!0;case 4:return x.fn.call(x.context,u,f,m),!0;case 5:return x.fn.call(x.context,u,f,m,g),!0;case 6:return x.fn.call(x.context,u,f,m,g,y),!0}for(_=1,T=new Array(S-1);_<S;_++)T[_-1]=arguments[_];x.fn.apply(x.context,T)}else{var R=x.length,I;for(_=0;_<R;_++)switch(x[_].once&&this.removeListener(c,x[_].fn,void 0,!0),S){case 1:x[_].fn.call(x[_].context);break;case 2:x[_].fn.call(x[_].context,u);break;case 3:x[_].fn.call(x[_].context,u,f);break;case 4:x[_].fn.call(x[_].context,u,f,m);break;default:if(!T)for(I=1,T=new Array(S-1);I<S;I++)T[I-1]=arguments[I];x[_].fn.apply(x[_].context,T)}}return!0},o.prototype.on=function(c,u,f){return i(this,c,u,f,!1)},o.prototype.once=function(c,u,f){return i(this,c,u,f,!0)},o.prototype.removeListener=function(c,u,f,m){var g=t?t+c:c;if(!this._events[g])return this;if(!u)return a(this,g),this;var y=this._events[g];if(y.fn)y.fn===u&&(!m||y.once)&&(!f||y.context===f)&&a(this,g);else{for(var b=0,x=[],S=y.length;b<S;b++)(y[b].fn!==u||m&&!y[b].once||f&&y[b].context!==f)&&x.push(y[b]);x.length?this._events[g]=x.length===1?x[0]:x:a(this,g)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o}(cR)),cR.exports}var iDe=sDe(),YP=PIe(iDe);const Nv="1.6.7",em={};function aDe(){return typeof __HLS_WORKER_BUNDLE__=="function"}function oDe(){const n=em[Nv];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return em[Nv]=s,s}function lDe(n){const e=em[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return em[n]=s,s}function cDe(n){const e=em[n||Nv];if(e&&e.clientCount--===1){const{worker:r,objectURL:s}=e;delete em[n||Nv],s&&self.URL.revokeObjectURL(s),r.terminate()}}function IQ(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function XP(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function eT(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function jv(n,e){const t=e;let r=0;for(;XP(n,e);){r+=10;const s=eT(n,e+6);r+=s,IQ(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)}function uDe(n,e,t,r){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[t+2],a=i>>2&15;if(a>12){const g=new Error(`invalid ADTS sampling index:${a}`);n.emit(K.ERROR,K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_PARSING_ERROR,fatal:!0,error:g,reason:g.message});return}const o=(i>>6&3)+1,l=e[t+3]>>6&3|(i&1)<<2,c="mp4a.40."+o,u=s[a];let f=a;(o===5||o===29)&&(f-=3);const m=[o<<3|(f&14)>>1,(f&1)<<7|l<<3];return vn.log(`manifest codec:${r}, parsed codec:${c}, channels:${l}, rate:${u} (ADTS object type:${o} sampling index:${a})`),{config:m,samplerate:u,channelCount:l,codec:c,parsedCodec:c,manifestCodec:r}}function LQ(n,e){return n[e]===255&&(n[e+1]&246)===240}function DQ(n,e){return n[e+1]&1?7:9}function QP(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function dDe(n,e){return e+5<n.length}function FE(n,e){return e+1<n.length&&LQ(n,e)}function hDe(n,e){return dDe(n,e)&&LQ(n,e)&&QP(n,e)<=n.length-e}function fDe(n,e){if(FE(n,e)){const t=DQ(n,e);if(e+t>=n.length)return!1;const r=QP(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||FE(n,s)}return!1}function PQ(n,e,t,r,s){if(!n.samplerate){const i=uDe(e,t,r,s);if(!i)return;_n(n,i)}}function MQ(n){return 1024*9e4/n}function mDe(n,e){const t=DQ(n,e);if(e+t<=n.length){const r=QP(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function OQ(n,e,t,r,s){const i=MQ(n.samplerate),a=r+s*i,o=mDe(e,t);let l;if(o){const{frameLength:f,headerLength:m}=o,g=m+f,y=Math.max(0,t+g-e.length);y?(l=new Uint8Array(g-m),l.set(e.subarray(t+m,e.length),0)):l=e.subarray(t+m,t+g);const b={unit:l,pts:a};return y||n.samples.push(b),{sample:b,length:g,missing:y}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:c,missing:-1}}function pDe(n,e){return XP(n,e)&&eT(n,e+6)+10<=n.length-e}function gDe(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function uR(n,e=0,t=1/0){return vDe(n,e,t,Uint8Array)}function vDe(n,e,t,r){const s=yDe(n);let i=1;"BYTES_PER_ELEMENT"in r&&(i=r.BYTES_PER_ELEMENT);const a=bDe(n)?n.byteOffset:0,o=(a+n.byteLength)/i,l=(a+e)/i,c=Math.floor(Math.max(0,Math.min(l,o))),u=Math.floor(Math.min(c+Math.max(t,0),o));return new r(s,c,u-c)}function yDe(n){return n instanceof ArrayBuffer?n:n.buffer}function bDe(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function xDe(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2||n.data[0]!==t)return;const r=n.data.subarray(1).indexOf(0);if(r===-1)return;const s=ji(uR(n.data,1,r)),i=n.data[2+r],a=n.data.subarray(3+r).indexOf(0);if(a===-1)return;const o=ji(uR(n.data,3+r,a));let l;return s==="-->"?l=ji(uR(n.data,4+r+a)):l=gDe(n.data.subarray(4+r+a)),e.mimeType=s,e.pictureType=i,e.description=o,e.data=l,e}function wDe(n){if(n.size<2)return;const e=ji(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function EDe(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=ji(n.data.subarray(t),!0);t+=r.length+1;const s=ji(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=ji(n.data.subarray(1));return{key:n.type,info:"",data:e}}function SDe(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=ji(n.data.subarray(t),!0);t+=r.length+1;const s=ji(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=ji(n.data);return{key:n.type,info:"",data:e}}function TDe(n){return n.type==="PRIV"?wDe(n):n.type[0]==="W"?SDe(n):n.type==="APIC"?xDe(n):EDe(n)}function _De(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=eT(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}}const Db=10,ADe=10;function NQ(n){let e=0;const t=[];for(;XP(n,e);){const r=eT(n,e+6);n[e+5]>>6&1&&(e+=Db),e+=Db;const s=e+r;for(;e+ADe<s;){const i=_De(n.subarray(e)),a=TDe(i);a&&t.push(a),e+=i.size+Db}IQ(n,e)&&(e+=Db)}return t}function jQ(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function RDe(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function ZP(n){const e=NQ(n);for(let t=0;t<e.length;t++){const r=e[t];if(jQ(r))return RDe(r)}}let Di=function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n}({});function Ro(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class JP{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=wa(this.cachedData,e),this.cachedData=null);let r=jv(e,0),s=r?r.length:0,i;const a=this._audioTrack,o=this._id3Track,l=r?ZP(r):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&at(l))&&(this.basePTS=CDe(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Di.audioId3,duration:Number.POSITIVE_INFINITY});s<c;){if(this.canParse(e,s)){const u=this.appendFrame(a,e,s);u?(this.frameIndex++,this.lastPTS=u.sample.pts,s+=u.length,i=s):s=c}else pDe(e,s)?(r=jv(e,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Di.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,i=s):s++;if(s===c&&i!==c){const u=e.slice(i);this.cachedData?this.cachedData=wa(this.cachedData,u):this.cachedData=u}}return{audioTrack:a,videoTrack:Ro(),id3Track:o,textTrack:Ro()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ro(),id3Track:this._id3Track,textTrack:Ro()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const CDe=(n,e,t)=>{if(at(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let Pb=null;const kDe=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],IDe=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],LDe=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],DDe=[0,1,1,4];function FQ(n,e,t,r,s){if(t+24>e.length)return;const i=UQ(e,t);if(i&&t+i.frameLength<=e.length){const a=i.samplesPerFrame*9e4/i.sampleRate,o=r+s*a,l={unit:e.subarray(t,t+i.frameLength),pts:o,dts:o};return n.config=[],n.channelCount=i.channelCount,n.samplerate=i.sampleRate,n.samples.push(l),{sample:l,length:i.frameLength,missing:0}}}function UQ(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,i=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&i!==3){const a=n[e+2]>>1&1,o=n[e+3]>>6,l=t===3?3-r:r===3?3:4,c=kDe[l*14+s-1]*1e3,f=IDe[(t===3?0:t===2?1:2)*3+i],m=o===3?1:2,g=LDe[t][r],y=DDe[r],b=g*8*y,x=Math.floor(g*c/f+a)*y;if(Pb===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Pb=_?parseInt(_[1]):0}return!!Pb&&Pb<=87&&r===2&&c>=224e3&&o===0&&(n[e+3]=n[e+3]|128),{sampleRate:f,channelCount:m,frameLength:x,samplesPerFrame:b}}}function eM(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function $Q(n,e){return e+1<n.length&&eM(n,e)}function PDe(n,e){return eM(n,e)&&4<=n.length-e}function BQ(n,e){if(e+1<n.length&&eM(n,e)){const r=UQ(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const i=e+s;return i===n.length||$Q(n,i)}return!1}class MDe extends JP{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=jv(e,0);let s=r?.length||0;if(BQ(e,s))return!1;for(let i=e.length;s<i;s++)if(fDe(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return hDe(e,t)}appendFrame(e,t,r){PQ(e,this.observer,t,r,e.manifestCodec);const s=OQ(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const HQ=(n,e)=>{let t=0,r=5;e+=r;const s=new Uint32Array(1),i=new Uint32Array(1),a=new Uint8Array(1);for(;r>0;){a[0]=n[e];const o=Math.min(r,8),l=8-o;i[0]=4278190080>>>24+l<<l,s[0]=(a[0]&i[0])>>l,t=t?t<<o|s[0]:s[0],e+=1,r-=o}return t};class ODe extends JP{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const s=VQ(e,t,r,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=jv(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&ZP(t)!==void 0&&HQ(e,r)<16}}function VQ(n,e,t,r,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const i=e[t+4]>>6;if(i>=3)return-1;const o=[48e3,44100,32e3][i],l=e[t+4]&63,u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+i]*2;if(t+u>e.length)return-1;const f=e[t+6]>>5;let m=0;f===2?m+=2:(f&1&&f!==1&&(m+=2),f&4&&(m+=2));const g=(e[t+6]<<8|e[t+7])>>12-m&1,b=[2,1,2,3,3,4,4,5][f]+g,x=e[t+5]>>3,S=e[t+5]&7,T=new Uint8Array([i<<6|x<<1|S>>2,(S&3)<<6|f<<3|g<<2|l>>4,l<<4&224]),_=1536/o*9e4,R=r+s*_,I=e.subarray(t,t+u);return n.config=T,n.channelCount=b,n.samplerate=o,n.samples.push({unit:I,pts:R}),u}class NDe extends JP{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=jv(e,0);let r=t?.length||0;if(t&&e[r]===11&&e[r+1]===119&&ZP(t)!==void 0&&HQ(e,r)<=16)return!1;for(let s=e.length;r<s;r++)if(BQ(e,r))return vn.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return PDe(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return FQ(e,t,r,this.basePTS,this.frameIndex)}}const jDe=/\/emsg[-/]ID3/i;class FDe{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const i=this.videoTrack=Ro("video",1),a=this.audioTrack=Ro("audio",1),o=this.txtTrack=Ro("text",1);if(this.id3Track=Ro("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=iQ(e);if(l.video){const{id:c,timescale:u,codec:f,supplemental:m}=l.video;i.id=c,i.timescale=o.timescale=u,i.codec=f,i.supplemental=m}if(l.audio){const{id:c,timescale:u,codec:f}=l.audio;a.id=c,a.timescale=u,a.codec=f}o.id=nQ.text,i.sampleDuration=0,i.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return FIe(e)}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=wa(this.remainderData,e));const o=GIe(r);this.remainderData=o.remainder,s.samples=o.valid||new Uint8Array}else s.samples=r;const a=this.extractID3Track(s,t);return i.samples=GB(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=GB(e,t),{videoTrack:t,audioTrack:Ro(),id3Track:s,textTrack:Ro()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=en(e.samples,["emsg"]);s&&s.forEach(i=>{const a=WIe(i);if(jDe.test(a.schemeIdUri)){const o=A6(a,t);let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=a.payload;r.samples.push({data:c,len:c.byteLength,dts:o,pts:o,type:Di.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=A6(a,t);r.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:Di.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function A6(n,e){return at(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class UDe{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new GP(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,lu.cbc)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),a=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);s.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)r.set(e.subarray(i,i+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(r.subarray(s,s+16),i);return e}decryptAvcSample(e,t,r,s,i){const a=aQ(i.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{i.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)})}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const i=e[t].units;for(;!(r>=i.length);r++){const a=i[r];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,r,s,a),!this.decrypter.isSync()))return}}}}class zQ{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const i=r.units;s=i[i.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,s=r.length;if(s){const i=r[s-1];e.pts=i.pts,e.dts=i.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const s=t.byteLength;let i=e.naluState||0;const a=i,o=[];let l=0,c,u,f,m=-1,g=0;for(i===-1&&(m=0,g=this.getNALuType(t,0),i=0,l=1);l<s;){if(c=t[l++],!i){i=c?0:1;continue}if(i===1){i=c?0:2;continue}if(!c)i=3;else if(c===1){if(u=l-i-1,m>=0){const y={data:t.subarray(m,u),type:g};o.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(a&&l<=4-a&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-a)),u>0&&(y.data=wa(y.data,t.subarray(0,u)),y.state=0))}l<s?(f=this.getNALuType(t,l),m=l,g=f,i=0):i=-1}else i=0}if(m>=0&&i>=0){const y={data:t.subarray(m,s),type:g,state:i};o.push(y)}if(o.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=wa(y.data,t))}return e.naluState=i,o}}class Fg{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw new Error("no bytes available");s.set(e.subarray(r,r+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&vn.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class R6 extends zQ{parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,o,l=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(c=>{var u,f;switch(c.type){case 1:{let b=!1;o=!0;const x=c.data;if(l&&x.length>4){const S=this.readSliceType(x);(S===2||S===4||S===7||S===9)&&(b=!0)}if(b){var m;(m=a)!=null&&m.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.frame=!0,a.key=b;break}case 5:o=!0,(u=a)!=null&&u.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,BP(c.data,1,r.pts,t.samples);break}case 7:{var g,y;o=!0,l=!0;const b=c.data,x=this.readSPS(b);if(!e.sps||e.width!==x.width||e.height!==x.height||((g=e.pixelRatio)==null?void 0:g[0])!==x.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==x.pixelRatio[1]){e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.sps=[b];const S=b.subarray(1,4);let T="avc1.";for(let _=0;_<3;_++){let R=S[_].toString(16);R.length<2&&(R="0"+R),T+=R}e.codec=T}break}case 8:o=!0,e.pps=[c.data];break;case 9:o=!0,e.audFound=!0,(f=a)!=null&&f.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(c)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Fg(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,s=8,i;for(let a=0;a<e;a++)s!==0&&(i=t.readEG(),s=(r+i+256)%256),r=s===0?r:s}readSPS(e){const t=new Fg(e);let r=0,s=0,i=0,a=0,o,l,c;const u=t.readUByte.bind(t),f=t.readBits.bind(t),m=t.readUEG.bind(t),g=t.readBoolean.bind(t),y=t.skipBits.bind(t),b=t.skipEG.bind(t),x=t.skipUEG.bind(t),S=this.skipScalingList.bind(this);u();const T=u();if(f(5),y(3),u(),x(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const k=m();if(k===3&&y(1),x(),x(),y(1),g())for(l=k!==3?8:12,c=0;c<l;c++)g()&&(c<6?S(16,t):S(64,t))}x();const _=m();if(_===0)m();else if(_===1)for(y(1),b(),b(),o=m(),c=0;c<o;c++)b();x(),y(1);const R=m(),I=m(),C=f(1);C===0&&y(1),y(1),g()&&(r=m(),s=m(),i=m(),a=m());let L=[1,1];if(g()&&g())switch(u()){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[u()<<8|u(),u()<<8|u()];break}}return{width:Math.ceil((R+1)*16-r*2-s*2),height:(2-C)*(I+1)*16-(C?2:4)*(i+a),pixelRatio:L}}}class C6 extends zQ{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,o,l=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(c=>{var u,f;switch(c.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var m;(m=a)!=null&&m.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(u=a)!=null&&u.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,BP(c.data,2,r.pts,t.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=_n(e.params,this.readVPS(c.data)),this.initVPS=c.data),e.vps=[c.data];break;case 33:if(o=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],c.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const g=this.readSPS(c.data);e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.codec=g.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in g.params)e.params[y]=g.params[y]}this.pushParameterSet(e.sps,c.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const g=this.readPPS(c.data);for(const y in g)e.params[y]=g[y]}this.pushParameterSet(e.pps,c.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(f=a)!=null&&f.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:o=!1;break}a&&o&&a.units.push(c)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[r]=e[s],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Fg(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:s}}readSPS(e){const t=new Fg(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const s=t.readBits(2),i=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),l=t.readUByte(),c=t.readUByte(),u=t.readUByte(),f=t.readUByte(),m=t.readUByte(),g=t.readUByte(),y=t.readUByte(),b=t.readUByte(),x=t.readUByte(),S=t.readUByte(),T=[],_=[];for(let le=0;le<r;le++)T.push(t.readBoolean()),_.push(t.readBoolean());if(r>0)for(let le=r;le<8;le++)t.readBits(2);for(let le=0;le<r;le++)T[le]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),_[le]&&t.readUByte();t.readUEG();const R=t.readUEG();R==3&&t.skipBits(1);const I=t.readUEG(),C=t.readUEG(),L=t.readBoolean();let k=0,M=0,D=0,U=0;L&&(k+=t.readUEG(),M+=t.readUEG(),D+=t.readUEG(),U+=t.readUEG());const $=t.readUEG(),V=t.readUEG(),B=t.readUEG(),W=t.readBoolean();for(let le=W?0:r;le<=r;le++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let ie=0;ie<4;ie++)for(let fe=0;fe<(ie===3?2:6);fe++)if(!t.readBoolean())t.readUEG();else{const ne=Math.min(64,1<<4+(ie<<1));ie>1&&t.readEG();for(let ce=0;ce<ne;ce++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const q=t.readUEG();let H=0;for(let le=0;le<q;le++){let ie=!1;if(le!==0&&(ie=t.readBoolean()),ie){le===q&&t.readUEG(),t.readBoolean(),t.readUEG();let fe=0;for(let Ie=0;Ie<=H;Ie++){const ne=t.readBoolean();let ce=!1;ne||(ce=t.readBoolean()),(ne||ce)&&fe++}H=fe}else{const fe=t.readUEG(),Ie=t.readUEG();H=fe+Ie;for(let ne=0;ne<fe;ne++)t.readUEG(),t.readBoolean();for(let ne=0;ne<Ie;ne++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const le=t.readUEG();for(let ie=0;ie<le;ie++){for(let fe=0;fe<B+4;fe++)t.readBits(1);t.readBits(1)}}let O=0,z=1,G=1,Y=!0,Q=1,J=0;t.readBoolean(),t.readBoolean();let ee=!1;if(t.readBoolean()){if(t.readBoolean()){const Ce=t.readUByte(),Oe=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ze=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Ce>0&&Ce<16?(z=Oe[Ce-1],G=ze[Ce-1]):Ce===255&&(z=t.readBits(16),G=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ee=t.readBoolean(),ee&&(k+=t.readUEG(),M+=t.readUEG(),D+=t.readUEG(),U+=t.readUEG()),t.readBoolean()&&(Q=t.readBits(32),J=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const ze=t.readBoolean(),We=t.readBoolean();let tt=!1;(ze||We)&&(tt=t.readBoolean(),tt&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),tt&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let lt=0;lt<=r;lt++){Y=t.readBoolean();const Ee=Y||t.readBoolean();let be=!1;Ee?t.readEG():be=t.readBoolean();const Ae=be?1:t.readUEG()+1;if(ze)for(let Me=0;Me<Ae;Me++)t.readUEG(),t.readUEG(),tt&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(We)for(let Me=0;Me<Ae;Me++)t.readUEG(),t.readUEG(),tt&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),O=t.readUEG())}let te=I,se=C;if(L||ee){let le=1,ie=1;R===1?le=ie=2:R==2&&(le=2),te=I-le*M-le*k,se=C-ie*U-ie*D}const he=s?["A","B","C"][s]:"",Z=o<<24|l<<16|c<<8|u;let pe=0;for(let le=0;le<32;le++)pe=(pe|(Z>>le&1)<<31-le)>>>0;let ye=pe.toString(16);return a===1&&ye==="2"&&(ye="6"),{codecString:`hvc1.${he}${a}.${ye}.${i?"H":"L"}${S}.B0`,params:{general_tier_flag:i,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[o,l,c,u],general_constraint_indicator_flags:[f,m,g,y,b,x],general_level_idc:S,bit_depth:$+8,bit_depth_luma_minus8:$,bit_depth_chroma_minus8:V,min_spatial_segmentation_idc:O,chroma_format_idc:R,frame_rate:{fixed:Y,fps:J/Q}},width:te,height:se,pixelRatio:[z,G]}}readPPS(e){const t=new Fg(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),i=t.readBoolean();let a=1;return i&&s?a=0:i?a=3:s&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Xr=188;class Fc{constructor(e,t,r,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=s,this.videoParser=null}static probe(e,t){const r=Fc.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Xr*5,t-Xr)+1,s=0;for(;s<r;){let i=!1,a=-1,o=0;for(let l=s;l<t;l+=Xr)if(e[l]===71&&(t-l===Xr||e[l+Xr]===71)){if(o++,a===-1&&(a=l,a!==0&&(r=Math.min(a+Xr*99,e.length-Xr)+1)),i||(i=eL(e,l)===0),i&&o>1&&(a===0&&o>2||l+Xr>r))return a}else{if(o)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:nQ[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Fc.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=Fc.createTrack("audio",s),this._id3Track=Fc.createTrack("id3"),this._txtTrack=Fc.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let i;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,c=this._txtTrack;let u=a.pid,f=a.pesData,m=o.pid,g=l.pid,y=o.pesData,b=l.pesData,x=null,S=this.pmtParsed,T=this._pmtId,_=e.length;if(this.remainderData&&(e=wa(this.remainderData,e),_=e.length,this.remainderData=null),_<Xr&&!s)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};const R=Math.max(0,Fc.syncOffset(e));_-=(_-R)%Xr,_<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let I=0;for(let L=R;L<_;L+=Xr)if(e[L]===71){const k=!!(e[L+1]&64),M=eL(e,L),D=(e[L+3]&48)>>4;let U;if(D>1){if(U=L+5+e[L+4],U===L+Xr)continue}else U=L+4;switch(M){case u:if(k){if(f&&(i=$h(f,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new R6;break;case"hevc":this.videoParser=new C6;break}this.videoParser!==null&&this.videoParser.parsePES(a,c,i,!1)}f={data:[],size:0}}f&&(f.data.push(e.subarray(U,L+Xr)),f.size+=L+Xr-U);break;case m:if(k){if(y&&(i=$h(y,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,i);break;case"mp3":this.parseMPEGPES(o,i);break;case"ac3":this.parseAC3PES(o,i);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(U,L+Xr)),y.size+=L+Xr-U);break;case g:k&&(b&&(i=$h(b,this.logger))&&this.parseID3PES(l,i),b={data:[],size:0}),b&&(b.data.push(e.subarray(U,L+Xr)),b.size+=L+Xr-U);break;case 0:k&&(U+=e[U]+1),T=this._pmtId=$De(e,U);break;case T:{k&&(U+=e[U]+1);const $=BDe(e,U,this.typeSupported,r,this.observer,this.logger);u=$.videoPid,u>0&&(a.pid=u,a.segmentCodec=$.segmentVideoCodec),m=$.audioPid,m>0&&(o.pid=m,o.segmentCodec=$.segmentAudioCodec),g=$.id3Pid,g>0&&(l.pid=g),x!==null&&!S&&(this.logger.warn(`MPEG-TS PMT found at ${L} after unknown PID '${x}'. Backtracking to sync byte @${R} to parse all TS packets.`),x=null,L=R-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:x=M;break}}else I++;I>0&&tL(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=f,o.pesData=y,l.pesData=b;const C={audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};return s&&this.extractRemainingSamples(C),C}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:i}=e,a=r.pesData,o=t.pesData,l=s.pesData;let c;if(a&&(c=$h(a,this.logger))){if(this.videoParser===null)switch(r.segmentCodec){case"avc":this.videoParser=new R6;break;case"hevc":this.videoParser=new C6;break}this.videoParser!==null&&(this.videoParser.parsePES(r,i,c,!0),r.pesData=null)}else r.pesData=a;if(o&&(c=$h(o,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(c=$h(l,this.logger))?(this.parseID3PES(s,c),s.pesData=null):s.pesData=l}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new UDe(this.observer,this.config,t);return this.decrypt(s,i)}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{r(e)}):r(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let i=t.data;if(s){this.aacOverFlow=null;const f=s.missing,m=s.sample.unit.byteLength;if(f===-1)i=wa(s.sample.unit,i);else{const g=m-f;s.sample.unit.set(i.subarray(0,f),g),e.samples.push(s.sample),r=s.missing}}let a,o;for(a=r,o=i.length;a<o-1&&!FE(i,a);a++);if(a!==r){let f;const m=a<o-1;if(m?f=`AAC PES did not start with ADTS header,offset:${a}`:f="No ADTS header found in AAC PES",tL(this.observer,new Error(f),m,this.logger),!m)return}PQ(e,this.observer,i,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(s){const f=MQ(e.samplerate);l=s.sample.pts+f}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;a<o;)if(u=OQ(e,i,a,l,c),a+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;a<o-1&&!FE(i,a);a++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let i=0,a=0;const o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if($Q(r,a)){const l=FQ(e,r,a,o,i);if(l)a+=l.length,i++;else break}else a++}parseAC3PES(e,t){{const r=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=r.length;let a=0,o=0,l;for(;o<i&&(l=VQ(e,r,o,s,a++))>0;)o+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=_n({},t,{type:this._videoTrack?Di.emsg:Di.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function eL(n,e){return((n[e+1]&31)<<8)+n[e+2]}function $De(n,e){return(n[e+10]&31)<<8|n[e+11]}function BDe(n,e,t,r,s,i){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(n[e+1]&15)<<8|n[e+2],l=e+3+o-4,c=(n[e+10]&15)<<8|n[e+11];for(e+=12+c;e<l;){const u=eL(n,e),f=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){dR("ADTS AAC",i);break}case 15:a.audioPid===-1&&(a.audioPid=u);break;case 21:a.id3Pid===-1&&(a.id3Pid=u);break;case 219:if(!r){dR("H.264",i);break}case 27:a.videoPid===-1&&(a.videoPid=u);break;case 3:case 4:!t.mpeg&&!t.mp3?i.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=u,a.segmentAudioCodec="mp3");break;case 193:if(!r){dR("AC-3",i);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=u,a.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&f>0){let m=e+5,g=f;for(;g>2;){switch(n[m]){case 106:t.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=u,a.segmentAudioCodec="ac3");break}const b=n[m+1]+2;m+=b,g-=b}}break;case 194:case 135:return tL(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),a;case 36:a.videoPid===-1&&(a.videoPid=u,a.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=f+5}return a}function tL(n,e,t,r){r.warn(`parsing error: ${e.message}`),n.emit(K.ERROR,K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function dR(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function $h(n,e){let t=0,r,s,i,a,o;const l=n.data;if(!n||n.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=wa(l[0],l[1]),l.splice(1,1);if(r=l[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(s=(r[4]<<8)+r[5],s&&s>n.size-6)return null;const u=r[7];u&192&&(a=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,u&64?(o=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,a-o>60*9e4&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),i=r[8];let f=i+9;if(n.size<=f)return null;n.size-=f;const m=new Uint8Array(n.size);for(let g=0,y=l.length;g<y;g++){r=l[g];let b=r.byteLength;if(f)if(f>b){f-=b;continue}else r=r.subarray(f),b-=f,f=0;m.set(r,t),t+=b}return s&&(s-=i+3),{data:m,pts:a,dts:o,len:s}}return null}class HDe{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Tc=Math.pow(2,32)-1;class Se{static init(){Se.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Se.types)Se.types.hasOwnProperty(e)&&(Se.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Se.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);Se.STTS=Se.STSC=Se.STCO=i,Se.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Se.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Se.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Se.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Se.FTYP=Se.box(Se.types.ftyp,a,l,a,o),Se.DINF=Se.box(Se.types.dinf,Se.box(Se.types.dref,s))}static box(e,...t){let r=8,s=t.length;const i=s;for(;s--;)r+=t[s].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),s=0,r=8;s<i;s++)a.set(t[s],r),r+=t[s].byteLength;return a}static hdlr(e){return Se.box(Se.types.hdlr,Se.HDLR_TYPES[e])}static mdat(e){return Se.box(Se.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(Tc+1)),s=Math.floor(t%(Tc+1));return Se.box(Se.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return Se.box(Se.types.mdia,Se.mdhd(e.timescale||0,e.duration||0),Se.hdlr(e.type),Se.minf(e))}static mfhd(e){return Se.box(Se.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Se.box(Se.types.minf,Se.box(Se.types.smhd,Se.SMHD),Se.DINF,Se.stbl(e)):Se.box(Se.types.minf,Se.box(Se.types.vmhd,Se.VMHD),Se.DINF,Se.stbl(e))}static moof(e,t,r){return Se.box(Se.types.moof,Se.mfhd(e),Se.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=Se.trak(e[t]);return Se.box.apply(null,[Se.types.moov,Se.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(Se.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=Se.trex(e[t]);return Se.box.apply(null,[Se.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(Tc+1)),s=Math.floor(t%(Tc+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Se.box(Se.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,i;for(s=0;s<t.length;s++)i=t[s].flags,r[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return Se.box(Se.types.sdtp,r)}static stbl(e){return Se.box(Se.types.stbl,Se.stsd(e),Se.box(Se.types.stts,Se.STTS),Se.box(Se.types.stsc,Se.STSC),Se.box(Se.types.stsz,Se.STSZ),Se.box(Se.types.stco,Se.STCO))}static avc1(e){let t=[],r=[],s,i,a;for(s=0;s<e.sps.length;s++)i=e.sps[s],a=i.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],a=i.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(i));const o=Se.box(Se.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),l=e.width,c=e.height,u=e.pixelRatio[0],f=e.pixelRatio[1];return Se.box(Se.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Se.box(Se.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Se.box(Se.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,f>>24,f>>16&255,f>>8&255,f&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Se.box(Se.types.mp4a,Se.audioStsd(e),Se.box(Se.types.esds,Se.esds(e)))}static mp3(e){return Se.box(Se.types[".mp3"],Se.audioStsd(e))}static ac3(e){return Se.box(Se.types["ac-3"],Se.audioStsd(e),Se.box(Se.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Se.box(Se.types.stsd,Se.STSD,Se.mp4a(e));if(t==="ac3"&&e.config)return Se.box(Se.types.stsd,Se.STSD,Se.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Se.box(Se.types.stsd,Se.STSD,Se.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Se.box(Se.types.stsd,Se.STSD,Se.avc1(e));if(t==="hevc"&&e.vps)return Se.box(Se.types.stsd,Se.STSD,Se.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,a=Math.floor(r/(Tc+1)),o=Math.floor(r%(Tc+1));return Se.box(Se.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,t){const r=Se.sdtp(e),s=e.id,i=Math.floor(t/(Tc+1)),a=Math.floor(t%(Tc+1));return Se.box(Se.types.traf,Se.box(Se.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),Se.box(Se.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255])),Se.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,Se.box(Se.types.trak,Se.tkhd(e),Se.mdia(e))}static trex(e){const t=e.id;return Se.box(Se.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,i=12+16*s,a=new Uint8Array(i);let o,l,c,u,f,m;for(t+=8+i,a.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<s;o++)l=r[o],c=l.duration,u=l.size,f=l.flags,m=l.cts,a.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&61440,f.degradPrio&15,m>>>24&255,m>>>16&255,m>>>8&255,m&255],12+16*o);return Se.box(Se.types.trun,a)}static initSegment(e){Se.types||Se.init();const t=Se.moov(e);return wa(Se.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let a=i.length;for(let y=0;y<r.length;y+=1){a+=3;for(let b=0;b<r[y].length;b+=1)a+=2+r[y][b].length}const o=new Uint8Array(a);o.set(i,0),a=i.length;const l=r.length-1;for(let y=0;y<r.length;y+=1){o.set(new Uint8Array([32+y|(y===l?128:0),0,r[y].length]),a),a+=3;for(let b=0;b<r[y].length;b+=1)o.set(new Uint8Array([r[y][b].length>>8,r[y][b].length&255]),a),a+=2,o.set(r[y][b],a),a+=r[y][b].length}const c=Se.box(Se.types.hvcC,o),u=e.width,f=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return Se.box(Se.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Se.box(Se.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Se.box(Se.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}}Se.types=void 0;Se.HDLR_TYPES=void 0;Se.STTS=void 0;Se.STSC=void 0;Se.STCO=void 0;Se.STSZ=void 0;Se.VMHD=void 0;Se.SMHD=void 0;Se.STSD=void 0;Se.FTYP=void 0;Se.DINF=void 0;const GQ=9e4;function tM(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function VDe(n,e,t=1,r=!1){return tM(n,e,1/t,r)}function Np(n,e=!1){return tM(n,1e3,1/GQ,e)}function zDe(n,e=1){return tM(n,GQ,1/e)}const GDe=10*1e3,qDe=1024,WDe=1152,KDe=1536;let Bh=null,hR=null;function k6(n,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class Nx extends eo{constructor(e,t,r,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,Bh===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Bh=a?parseInt(a[1]):0}if(hR===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);hR=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,s=e.reduce((i,a)=>{let o=a.pts,l=o-i;return l<-4294967296&&(t=!0,o=sa(o,r),l=o-i),l>0?i:o},r);return t&&this.debug("PTS rollover detected"),s}remux(e,t,r,s,i,a,o,l){let c,u,f,m,g,y,b=i,x=i;const S=e.pid>-1,T=t.pid>-1,_=t.samples.length,R=e.samples.length>0,I=o&&_>0||_>1;if((!S||R)&&(!T||I)||this.ISGenerated||o){if(this.ISGenerated){var L,k,M,D;const B=this.videoTrackConfig;(B&&(t.width!==B.width||t.height!==B.height||((L=t.pixelRatio)==null?void 0:L[0])!==((k=B.pixelRatio)==null?void 0:k[0])||((M=t.pixelRatio)==null?void 0:M[1])!==((D=B.pixelRatio)==null?void 0:D[1]))||!B&&I||this.nextAudioTs===null&&R)&&this.resetInitSegment()}this.ISGenerated||(f=this.generateIS(e,t,i,a));const U=this.isVideoContiguous;let $=-1,V;if(I&&($=YDe(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,$>0){this.warn(`Dropped ${$} out of ${_} video samples due to a missing keyframe`);const B=this.getVideoStartPts(t.samples);t.samples=t.samples.slice($),t.dropped+=$,x+=(t.samples[0].pts-B)/t.inputTimeScale,V=x}else $===-1&&(this.warn(`No keyframe found out of ${_} video samples`),y=!1);if(this.ISGenerated){if(R&&I){const B=this.getVideoStartPts(t.samples),F=(sa(e.samples[0].pts,B)-B)/t.inputTimeScale;b+=Math.max(0,F),x+=Math.max(0,-F)}if(R){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),f=this.generateIS(e,t,i,a)),u=this.remuxAudio(e,b,this.isAudioContiguous,a,T||I||l===gt.AUDIO?x:void 0),I){const B=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),f=this.generateIS(e,t,i,a)),c=this.remuxVideo(t,x,U,B)}}else I&&(c=this.remuxVideo(t,x,U,0));c&&(c.firstKeyFrame=$,c.independent=$!==-1,c.firstKeyFramePTS=V)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(g=qQ(r,i,this._initPTS,this._initDTS)),s.samples.length&&(m=WQ(s,i,this._initPTS))),{audio:u,video:c,initSegment:f,independent:y,text:m,id3:g}}generateIS(e,t,r,s){const i=e.samples,a=t.samples,o=this.typeSupported,l={},c=this._initPTS;let u=!c||s,f="audio/mp4",m,g,y,b;if(u&&(m=g=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(f="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:f,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):Se.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(b=e.id,y=e.inputTimeScale,!c||y!==c.timescale?m=g=i[0].pts-Math.round(y*r):u=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Se.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(b=t.id,y=t.inputTimeScale,!c||y!==c.timescale){const x=this.getVideoStartPts(a),S=Math.round(y*r);g=Math.min(g,sa(a[0].dts,x)-S),m=Math.min(m,x-S)}else u=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:m,timescale:y},this._initDTS={baseTime:g,timescale:y}):m=y=void 0,{tracks:l,initPTS:m,timescale:y,trackId:b}}remuxVideo(e,t,r,s){const i=e.inputTimeScale,a=e.samples,o=[],l=a.length,c=this._initPTS,u=c.baseTime*i/c.timescale;let f=this.nextVideoTs,m=8,g=this.videoSampleDuration,y,b,x=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,T=!1;if(!r||f===null){const O=u+t*i,z=a[0].pts-sa(a[0].dts,a[0].pts);Bh&&f!==null&&Math.abs(O-z-(f+u))<15e3?r=!0:f=O-z-u}const _=f+u;for(let O=0;O<l;O++){const z=a[O];z.pts=sa(z.pts,_),z.dts=sa(z.dts,_),z.dts<a[O>0?O-1:O].dts&&(T=!0)}T&&a.sort(function(O,z){const G=O.dts-z.dts,Y=O.pts-z.pts;return G||Y}),y=a[0].dts,b=a[a.length-1].dts;const R=b-y,I=R?Math.round(R/(l-1)):g||e.inputTimeScale/30;if(r){const O=y-_,z=O>I,G=O<-1;if((z||G)&&(z?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Np(O,!0)} ms (${O}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Np(-O,!0)} ms (${O}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!G||_>=a[0].pts||Bh)){y=_;const Y=a[0].pts-O;if(z)a[0].dts=y,a[0].pts=Y;else{let Q=!0;for(let J=0;J<a.length&&!(a[J].dts>Y&&Q);J++){const ee=a[J].pts;if(a[J].dts-=O,a[J].pts-=O,J<a.length-1){const oe=a[J+1].pts,te=a[J].pts,se=oe<=te,he=oe<=ee;Q=se==he}}}this.log(`Video: Initial PTS/DTS adjusted: ${Np(Y,!0)}/${Np(y,!0)}, delta: ${Np(O,!0)} ms`)}}y=Math.max(0,y);let C=0,L=0,k=y;for(let O=0;O<l;O++){const z=a[O],G=z.units,Y=G.length;let Q=0;for(let J=0;J<Y;J++)Q+=G[J].data.length;L+=Q,C+=Y,z.length=Q,z.dts<k?(z.dts=k,k+=I/4|0||1):k=z.dts,x=Math.min(z.pts,x),S=Math.max(z.pts,S)}b=a[l-1].dts;const M=L+4*C+8;let D;try{D=new Uint8Array(M)}catch(O){this.observer.emit(K.ERROR,K.ERROR,{type:xt.MUX_ERROR,details:_e.REMUX_ALLOC_ERROR,fatal:!1,error:O,bytes:M,reason:`fail allocating video mdat ${M}`});return}const U=new DataView(D.buffer);U.setUint32(0,M),D.set(Se.types.mdat,4);let $=!1,V=Number.POSITIVE_INFINITY,B=Number.POSITIVE_INFINITY,W=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY;for(let O=0;O<l;O++){const z=a[O],G=z.units;let Y=0;for(let ee=0,oe=G.length;ee<oe;ee++){const te=G[ee],se=te.data,he=te.data.byteLength;U.setUint32(m,he),m+=4,D.set(se,m),m+=he,Y+=4+he}let Q;if(O<l-1)g=a[O+1].dts-z.dts,Q=a[O+1].pts-z.pts;else{const ee=this.config,oe=O>0?z.dts-a[O-1].dts:I;if(Q=O>0?z.pts-a[O-1].pts:I,ee.stretchShortVideoTrack&&this.nextAudioTs!==null){const te=Math.floor(ee.maxBufferHole*i),se=(s?x+s*i:this.nextAudioTs+u)-z.pts;se>te?(g=se-oe,g<0?g=oe:$=!0,this.log(`It is approximately ${se/90} ms to the next segment; using duration ${g/90} ms for the last video frame.`)):g=oe}else g=oe}const J=Math.round(z.pts-z.dts);V=Math.min(V,g),W=Math.max(W,g),B=Math.min(B,Q),F=Math.max(F,Q),o.push(k6(z.key,g,Y,J))}if(o.length){if(Bh){if(Bh<70){const O=o[0].flags;O.dependsOn=2,O.isNonSync=0}}else if(hR&&F-B<W-V&&I/W<.025&&o[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let O=y;for(let z=0,G=o.length;z<G;z++){const Y=O+o[z].duration,Q=O+o[z].cts;if(z<G-1){const J=Y+o[z+1].cts;o[z].duration=J-Q}else o[z].duration=z?o[z-1].duration:I;o[z].cts=0,O=Y}}}g=$||!g?I:g;const j=b+g;this.nextVideoTs=f=j-u,this.videoSampleDuration=g,this.isVideoContiguous=!0;const N={data1:Se.moof(e.sequenceNumber++,y,_n(e,{samples:o})),data2:D,startPTS:(x-u)/i,endPTS:(S+g-u)/i,startDTS:(y-u)/i,endDTS:f/i,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,N}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return WDe;case"ac3":return KDe;default:return qDe}}remuxAudio(e,t,r,s,i){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,c=this.getSamplesPerFrame(e),u=c*l,f=this._initPTS,m=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],y=i!==void 0;let b=e.samples,x=m?0:8,S=this.nextAudioTs||-1;const T=f.baseTime*a/f.timescale,_=T+t*a;if(this.isAudioContiguous=r=r||b.length&&S>0&&(s&&Math.abs(_-(S+T))<9e3||Math.abs(sa(b[0].pts,_)-(S+T))<20*u),b.forEach(function(F){F.pts=sa(F.pts,_)}),!r||S<0){if(b=b.filter(F=>F.pts>=0),!b.length)return;i===0?S=0:s&&!y?S=Math.max(0,_-T):S=b[0].pts-T}if(e.segmentCodec==="aac"){const F=this.config.maxAudioFramesDrift;for(let j=0,q=S+T;j<b.length;j++){const H=b[j],N=H.pts,O=N-q,z=Math.abs(1e3*O/a);if(O<=-F*u&&y)j===0&&(this.warn(`Audio frame @ ${(N/a).toFixed(3)}s overlaps marker by ${Math.round(1e3*O/a)} ms.`),this.nextAudioTs=S=N-T,q=N);else if(O>=F*u&&z<GDe&&y){let G=Math.round(O/u);for(q=N-G*u;q<0&&G&&u;)G--,q+=u;j===0&&(this.nextAudioTs=S=q-T),this.warn(`Injecting ${G} audio frames @ ${((q-T)/a).toFixed(3)}s due to ${Math.round(1e3*O/a)} ms gap.`);for(let Y=0;Y<G;Y++){let Q=HDe.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Q||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Q=H.unit.subarray()),b.splice(j,0,{unit:Q,pts:q}),q+=u,j++}}H.pts=q,q+=u}}let R=null,I=null,C,L=0,k=b.length;for(;k--;)L+=b[k].unit.byteLength;for(let F=0,j=b.length;F<j;F++){const q=b[F],H=q.unit;let N=q.pts;if(I!==null){const z=g[F-1];z.duration=Math.round((N-I)/l)}else if(r&&e.segmentCodec==="aac"&&(N=S+T),R=N,L>0){L+=x;try{C=new Uint8Array(L)}catch(z){this.observer.emit(K.ERROR,K.ERROR,{type:xt.MUX_ERROR,details:_e.REMUX_ALLOC_ERROR,fatal:!1,error:z,bytes:L,reason:`fail allocating audio mdat ${L}`});return}m||(new DataView(C.buffer).setUint32(0,L),C.set(Se.types.mdat,4))}else return;C.set(H,x);const O=H.byteLength;x+=O,g.push(k6(!0,c,O,0)),I=N}const M=g.length;if(!M)return;const D=g[g.length-1];S=I-T,this.nextAudioTs=S+l*D.duration;const U=m?new Uint8Array(0):Se.moof(e.sequenceNumber++,R/l,_n({},e,{samples:g}));e.samples=[];const $=(R-T)/a,V=S/a,W={data1:U,data2:C,startPTS:$,endPTS:V,startDTS:$,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,W}}function sa(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function YDe(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function qQ(n,e,t,r){const s=n.samples.length;if(!s)return;const i=n.inputTimeScale;for(let o=0;o<s;o++){const l=n.samples[o];l.pts=sa(l.pts-t.baseTime*i/t.timescale,e*i)/i,l.dts=sa(l.dts-r.baseTime*i/r.timescale,e*i)/i}const a=n.samples;return n.samples=[],{samples:a}}function WQ(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let a=0;a<r;a++){const o=n.samples[a];o.pts=sa(o.pts-t.baseTime*s/t.timescale,e*s)/s}n.samples.sort((a,o)=>a.pts-o.pts);const i=n.samples;return n.samples=[],{samples:i}}class XDe extends eo{constructor(e,t,r,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(HIe(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const s=this.initData=iQ(e);s.audio&&(t=I6(s.audio,jn.AUDIO,this)),s.video&&(r=I6(s.video,jn.VIDEO,this));const i={};s.audio&&s.video?i.audiovideo={container:"video/mp4",codec:t+","+r,supplemental:s.video.supplemental,initSegment:e,id:"main"}:s.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?i.video={container:"video/mp4",codec:r,supplemental:s.video.supplemental,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=i}remux(e,t,r,s,i,a){var o,l;let{initPTS:c,lastEndTime:u}=this;const f={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};at(u)||(u=this.lastEndTime=i||0);const m=t.samples;if(!(m!=null&&m.length))return f;const g={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((o=y)!=null&&o.length||(this.generateInitSegment(m),y=this.initData),!((l=y)!=null&&l.length))return this.warn("Failed to generate initSegment."),f;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const b=zIe(m,y,this),x=y.audio?b[y.audio.id]:null,S=y.video?b[y.video.id]:null,T=Mb(S,1/0),_=Mb(x,1/0),R=Mb(S,0,!0),I=Mb(x,0,!0);let C,L=i,k=0;if(x&&(!S||!c&&_<T||c&&c.trackId===y.audio.id)?(g.trackId=y.audio.id,C=x,k=I-_):S&&(g.trackId=y.video.id,C=S,k=R-T),C){const F=C.timescale;L=C.start/F,g.initPTS=C.start-i*F,g.timescale=F,c||(this.initPTS=c={baseTime:g.initPTS,timescale:F,trackId:g.trackId})}(a||!c)&&(QDe(c,L,i,k)||g.timescale!==c.timescale)&&(g.initPTS=L-i,g.timescale=1,c&&c.timescale===1&&this.warn(`Adjusting initPTS @${i} from ${c.baseTime/c.timescale} to ${g.initPTS}`),this.initPTS=c={baseTime:g.initPTS,timescale:1});const M=e?L-c.baseTime/c.timescale:u,D=M+k;k>0?this.lastEndTime=D:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const U=!!y.audio,$=!!y.video;let V="";U&&(V+="audio"),$&&(V+="video");const B={data1:m,startPTS:M,startDTS:M,endPTS:D,endDTS:D,type:V,hasAudio:U,hasVideo:$,nb:1,dropped:0};f.audio=U&&!$?B:void 0,f.video=$?B:void 0;const W=S?.sampleCount;if(W){const F=S.keyFrameIndex,j=F!==-1;B.nb=W,B.dropped=F===0||this.isVideoContiguous?0:j?F:W,B.independent=j,B.firstKeyFrame=F,j&&S.keyFrameStart&&(B.firstKeyFramePTS=(S.keyFrameStart-c.baseTime)/c.timescale),this.isVideoContiguous||(f.independent=j),this.isVideoContiguous||(this.isVideoContiguous=j),B.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${F}/${W} dropped: ${B.dropped} start: ${B.firstKeyFramePTS||"NA"}`)}return f.initSegment=g,f.id3=qQ(r,i,c,c),s.samples.length&&(f.text=WQ(s,i,c)),f}}function Mb(n,e,t=!1){return n?.start!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function QDe(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),i=e-n.baseTime/n.timescale;return Math.abs(i-t)>s}function I6(n,e,t){const r=n?.codec;return r&&r.length>4?r:e===jn.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?LE(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Ll;try{Ll=self.performance.now.bind(self.performance)}catch{Ll=Date.now}const jx=[{demux:FDe,remux:XDe},{demux:Fc,remux:Nx},{demux:MDe,remux:Nx},{demux:NDe,remux:Nx}];jx.splice(2,0,{demux:ODe,remux:Nx});class L6{constructor(e,t,r,s,i,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=i,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const i=r.transmuxing;i.executeStart=Ll();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;s&&(this.currentTransmuxState=s);const{contiguous:c,discontinuity:u,trackSwitch:f,accurateTimeOffset:m,timeOffset:g,initSegmentChange:y}=s||o,{audioCodec:b,videoCodec:x,defaultInitPts:S,duration:T,initSegmentData:_}=l,R=ZDe(a,t);if(R&&Df(R.method)){const k=this.getDecrypter(),M=WP(R.method);if(k.isSync()){let D=k.softwareDecrypt(a,R.key.buffer,R.iv.buffer,M);if(r.part>-1){const $=k.flush();D=$&&$.buffer}if(!D)return i.executeEnd=Ll(),fR(r);a=new Uint8Array(D)}else return this.asyncResult=!0,this.decryptionPromise=k.webCryptoDecrypt(a,R.key.buffer,R.iv.buffer,M).then(D=>{const U=this.push(D,null,r);return this.decryptionPromise=null,U}),this.decryptionPromise}const I=this.needsProbing(u,f);if(I){const k=this.configureTransmuxer(a);if(k)return this.logger.warn(`[transmuxer] ${k.message}`),this.observer.emit(K.ERROR,K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_PARSING_ERROR,fatal:!1,error:k,reason:k.message}),i.executeEnd=Ll(),fR(r)}(u||f||y||I)&&this.resetInitSegment(_,b,x,T,t),(u||y||I)&&this.resetInitialTimestamp(S),c||this.resetContiguity();const C=this.transmux(a,R,g,m,r);this.asyncResult=Fv(C);const L=this.currentTransmuxState;return L.contiguous=!0,L.discontinuity=!1,L.trackSwitch=!1,i.executeEnd=Ll(),C}flush(e){const t=e.transmuxing;t.executeStart=Ll();const{decrypter:r,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const a=[],{timeOffset:o}=s;if(r){const f=r.flush();f&&a.push(this.push(f.buffer,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c){t.executeEnd=Ll();const f=[fR(e)];return this.asyncResult?Promise.resolve(f):f}const u=l.flush(o);return Fv(u)?(this.asyncResult=!0,u.then(f=>(this.flushRemux(a,f,e),a))):(this.flushRemux(a,u,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:i,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===gt.MAIN?"level":"track"} ${r.level}`);const u=this.remuxer.remux(s,i,a,o,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:r}),r.transmuxing.executeEnd=Ll()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,i){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,r,s),o.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,i){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,r,s,i):a=this.transmuxUnencrypted(e,r,s,i),a}transmuxUnencrypted(e,t,r,s){const{audioTrack:i,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,a,o,l,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,i){return this.demuxer.demuxSampleAes(e,t,r).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,r,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s}=this;let i;for(let f=0,m=jx.length;f<m;f++){var a;if((a=jx[f].demux)!=null&&a.probe(e,this.logger)){i=jx[f];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,c=i.remux,u=i.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(r,t,s,this.logger)),(!o||!(o instanceof u))&&(this.demuxer=new u(r,t,s,this.logger),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new GP(this.config)),e}}function ZDe(n,e){let t=null;return n.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const fR=n=>({remuxResult:{},chunkMeta:n});function Fv(n){return"then"in n&&n.then instanceof Function}class JDe{constructor(e,t,r,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=i||null}}class e2e{constructor(e,t,r,s,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=a}}let D6=0;class KQ{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=D6++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const c=l.data,u=this.hls;if(!(!u||!(c!=null&&c.event)||c.instanceNo!==this.instanceNo))switch(c.event){case"init":{var f;const m=(f=this.workerContext)==null?void 0:f.objectURL;m&&self.URL.revokeObjectURL(m);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}case"workerLog":{u.logger[c.data.logType]&&u.logger[c.data.logType](c.data.message);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.part=this.part,c.data.id=this.id,u.trigger(c.event,c.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const c=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:c})};const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const a=(l,c)=>{c=c||{},c.frag=this.frag||void 0,l===K.ERROR&&(c=c,c.parent=this.id,c.part=this.part,this.error=c.error),this.hls.trigger(l,c)};this.observer=new YP,this.observer.on(K.FRAG_DECRYPTED,a),this.observer.on(K.ERROR,a);const o=KB(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(i.workerPath||aDe()){try{i.workerPath?(l.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=lDe(i.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=oDe());const{worker:u}=this.workerContext;u.addEventListener("message",this.onWorkerMessage),u.addEventListener("error",this.onWorkerError),u.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:t,config:Wn(i)})}catch(u){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.terminateWorker(),this.error=null,this.transmuxer=new L6(this.observer,o,i,"",t,e.logger)}return}}this.transmuxer=new L6(this.observer,o,i,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=D6++;const t=this.hls.config,r=KB(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Wn(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),cDe(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,s,i,a,o,l,c,u){var f,m;c.transmuxing.start=self.performance.now();const{instanceNo:g,transmuxer:y}=this,b=a?a.start:i.start,x=i.decryptdata,S=this.frag,T=!(S&&i.cc===S.cc),_=!(S&&c.level===S.level),R=S?c.sn-S.sn:-1,I=this.part?c.part-this.part.index:-1,C=R===0&&c.id>1&&c.id===S?.stats.chunkCount,L=!_&&(R===1||R===0&&(I===1||C&&I<=0)),k=self.performance.now();(_||R||i.stats.parsing.start===0)&&(i.stats.parsing.start=k),a&&(I||!L)&&(a.stats.parsing.start=k);const M=!(S&&((f=i.initSegment)==null?void 0:f.url)===((m=S.initSegment)==null?void 0:m.url)),D=new e2e(T,L,l,_,b,M);if(!L||T||M){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${c.sn}${c.part>-1?" part: "+c.part:""} ${this.id===gt.MAIN?"level":"track"}: ${c.level} id: ${c.id}
        discontinuity: ${T}
        trackSwitch: ${_}
        contiguous: ${L}
        accurateTimeOffset: ${l}
        timeOffset: ${b}
        initSegmentChange: ${M}`);const U=new JDe(r,s,t,o,u);this.configureTransmuxer(U)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:g,cmd:"demux",data:e,decryptdata:x,chunkMeta:c,state:D},e instanceof ArrayBuffer?[e]:[]);else if(y){const U=y.push(e,x,c,D);Fv(U)?U.then($=>{this.handleTransmuxComplete($)}).catch($=>{this.transmuxerError($,c,"transmuxer-interface push error")}):this.handleTransmuxComplete(U)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const s=r.flush(e);Fv(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const P6=100;class t2e extends KP{constructor(e,t,r){super(e,t,r,"audio-stream-controller",gt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(K.LEVEL_LOADED,this.onLevelLoaded,this),e.on(K.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(K.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(K.BUFFER_RESET,this.onBufferReset,this),e.on(K.BUFFER_CREATED,this.onBufferCreated,this),e.on(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(K.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(K.FRAG_LOADING,this.onFragLoading,this),e.on(K.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(K.LEVEL_LOADED,this.onLevelLoaded,this),e.off(K.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(K.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(K.BUFFER_RESET,this.onBufferReset,this),e.off(K.BUFFER_CREATED,this.onBufferCreated,this),e.off(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(K.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(K.FRAG_LOADING,this.onFragLoading,this),e.off(K.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i}){if(r===gt.MAIN){const a=t.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:s,timescale:i},this.log(`InitPTS for cc: ${a} found from main: ${s}/${i}`),this.mainAnchor=t,this.state===$e.WAITING_INIT_PTS){const l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==a)&&this.syncWithAnchor(t,l?.frag)}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(o.abortRequests(),this.syncWithAnchor(t,o)):this.state===$e.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const s=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&s?.cc===t.cc)return;const i=(s||e).cc,a=this.getLevelDetails(),o=this.getLoadPosition(),l=mQ(a,i,o);l&&(this.log(`Syncing with main frag at ${l.start} cc ${l.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),this.state===$e.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=$e.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(P6),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=$e.IDLE):this.state=$e.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case $e.IDLE:this.doTickIdle();break;case $e.WAITING_TRACK:{const{levels:t,trackId:r}=this,s=t?.[r],i=s?.details;if(i&&!this.waitForLive(s)){if(this.waitForCdnTuneIn(i))break;this.state=$e.WAITING_INIT_PTS}break}case $e.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:s,trackId:i}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(s?.[i]||null),this.state=$e.IDLE}break}case $e.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:r,part:s,cache:i,complete:a}=t,o=this.mainAnchor;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.state=$e.FRAG_LOADING;const l=i.flush().buffer,c={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state=$e.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:s,trackId:i}=this,a=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(r!=null&&r[i]))return;const o=r[i],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=$e.WAITING_TRACK,this.startFragRequested=!1;return}const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,jn.AUDIO,gt.AUDIO));const u=this.getFwdBufferInfo(c,gt.AUDIO);if(u===null)return;if(!this.switchingTrack&&this._streamEnded(u,l)){t.trigger(K.BUFFER_EOS,{type:"audio"}),this.state=$e.ENDED;return}const f=u.len,m=t.maxBufferLength,g=l.fragments,y=g[0].start,b=this.getLoadPosition(),x=this.flushing?b:u.end;if(this.switchingTrack&&s){const _=b;l.PTSKnown&&_<y&&(u.end>y||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=y+.05)}if(f>=m&&!this.switchingTrack&&x<g[g.length-1].start)return;let S=this.getNextFragment(x,l);if(S&&this.isLoopLoading(S,x)&&(S=this.getNextFragmentLoopLoading(S,l,u,gt.MAIN,m)),!S){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&Nr(S)&&!S.endList&&(!l.live||!this.loadingParts&&x<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===zr.OK&&(this.mainFragLoading=T=null),T&&Nr(T))){if(S.start>T.end){const R=this.fragmentTracker.getFragAtPos(x,gt.MAIN);R&&R.end>T.end&&(T=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(S.start>T.end)return}this.loadFragment(S,o,x)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Mv(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==$e.STOPPED&&(this.setInterval(P6),this.state=$e.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(K.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:s}=this,{details:i,id:a,groupId:o,track:l}=t;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}const c=this.mainDetails;if(!c||i.endCC>c.endCC||c.expired){this.cachedTrackLoadedData=t,this.state!==$e.STOPPED&&(this.state=$e.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const u=s[a];let f=0;if(i.live||(r=u.details)!=null&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(u.details){var m;f=this.alignPlaylists(i,u.details,(m=this.levelLastLoaded)==null?void 0:m.details)}i.alignedSliding||(CQ(i,c),i.alignedSliding||jE(i,c),f=i.fragmentStart)}u.details=i,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(c,f),this.hls.trigger(K.AUDIO_TRACK_UPDATED,{details:i,id:a,groupId:t.groupId}),this.state===$e.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=$e.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const c=l[o];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const f=a.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let m=this.transmuxer;m||(m=this.transmuxer=new KQ(this.hls,gt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[r.cc],y=(t=r.initSegment)==null?void 0:t.data;if(g!==void 0){const x=s?s.index:-1,S=x!==-1,T=new qP(r.level,r.sn,r.stats.chunkCount,i.byteLength,x,S);m.push(i,y,f,"",r,s,u.totalduration,!1,T,g)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${u.startSN} ,${u.endSN}],track ${o}`);const{cache:b}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new kQ,complete:!1};b.push(new Uint8Array(i)),this.state!==$e.STOPPED&&(this.state=$e.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===gt.MAIN&&Nr(t.frag)&&(this.mainFragLoading=t,this.state===$e.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==gt.AUDIO){!this.audioOnly&&r.type===gt.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Nr(r)){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(K.AUDIO_TRACK_SWITCHED,Ln({},i)))}this.fragBufferedComplete(r,s),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=$e.ERROR;return}switch(t.details){case _e.FRAG_GAP:case _e.FRAG_PARSING_ERROR:case _e.FRAG_DECRYPT_ERROR:case _e.FRAG_LOAD_ERROR:case _e.FRAG_LOAD_TIMEOUT:case _e.KEY_LOAD_ERROR:case _e.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(gt.AUDIO,t);break;case _e.AUDIO_TRACK_LOAD_ERROR:case _e.AUDIO_TRACK_LOAD_TIMEOUT:case _e.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===$e.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===nn.AUDIO_TRACK&&(this.state=$e.IDLE);break;case _e.BUFFER_ADD_CODEC_ERROR:case _e.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case _e.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case _e.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==jn.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==jn.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===$e.ENDED&&(this.state=$e.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,gt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:i,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:c,level:u}=o,{details:f}=u,{audio:m,text:g,id3:y,initSegment:b}=i;if(this.fragContextChanged(l)||!f){this.fragmentTracker.removeFragment(l);return}if(this.state=$e.PARSING,this.switchingTrack&&m&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const x=l.initSegment||l;this._bufferInitSegment(u,b.tracks,x,a),s.trigger(K.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:r,tracks:b.tracks})}if(m){const{startPTS:x,endPTS:S,startDTS:T,endDTS:_}=m;c&&(c.elementaryStreams[jn.AUDIO]={startPTS:x,endPTS:S,startDTS:T,endDTS:_}),l.setElementaryStreamInfo(jn.AUDIO,x,S,T,_),this.bufferFragmentData(m,l,c,a)}if(y!=null&&(t=y.samples)!=null&&t.length){const x=_n({id:r,frag:l,details:f},y);s.trigger(K.FRAG_PARSING_METADATA,x)}if(g){const x=_n({id:r,frag:l,details:f},g);s.trigger(K.FRAG_PARSING_USERDATA,x)}}_bufferInitSegment(e,t,r,s){if(this.state!==$e.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const i=t.audio;i.id=gt.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${a}/${i.codec}]`),a&&a.split(",").length===1&&(i.levelCodec=a),this.hls.trigger(K.BUFFER_CODECS,t);const o=i.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:r,part:null,chunkMeta:s,parent:r.type,data:o};this.hls.trigger(K.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===zr.NOT_LOADED||s===zr.PARTIAL){var i;if(!Nr(e))this._loadInitSegment(e,t);else if((i=t.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=$e.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&jE(t.details,a)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:o}=this.bufferedTrack;fd({name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:o},e,Qu)||(PE(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(K.AUDIO_TRACK_SWITCHED,Ln({},e))}}class nM extends eo{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const s=t?.renditionReports;if(s){let i=-1;for(let a=0;a<s.length;a++){const o=s[a];let l;try{l=new self.URL(o.URI,t.url).href}catch(c){this.warn(`Could not construct new URL for Rendition Report: ${c}`),l=o.URI||""}if(l===e){i=a;break}else l===e.substring(0,l.length)&&(i=a)}if(i!==-1){const a=s[i],o=parseInt(a["LAST-MSN"])||t?.lastPartSn;let l=parseInt(a["LAST-PART"])||t?.lastPartIndex;if(this.hls.config.lowLatencyMode){const u=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&u>t.partTarget&&(l+=1)}const c=r&&YB(r);return new XB(o,l>=0?l:void 0,c)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:s,stats:i}=t,a=self.performance.now(),o=i.loading.first?Math.max(0,a-i.loading.first):0;s.advancedDateTime=Date.now()-o;const l=this.hls.config.timelineOffset;if(l!==s.appliedTimelineOffset){const u=Math.max(l||0,0);s.appliedTimelineOffset=u,s.fragments.forEach(f=>{f.start=f.playlistOffset+u})}if(s.live||r!=null&&r.live){const u="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(r),r&&s.fragments.length>0){XLe(r,s);const T=s.playlistParsingError;if(T){this.warn(T);const _=this.hls;if(!_.config.ignorePlaylistParsingErrors){var c;const{networkDetails:R}=t;_.trigger(K.ERROR,{type:xt.NETWORK_ERROR,details:_e.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:T,reason:T.message,level:t.level||void 0,parent:(c=s.fragments[0])==null?void 0:c.type,networkDetails:R,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const f=this.hls.mainForwardBufferInfo,m=f?f.end-f.len:0,g=(s.edge-m)*1e3,y=SQ(s,g);if(s.requestScheduled+y<a?s.requestScheduled=a:s.requestScheduled+=y,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let b,x,S;if(s.canBlockReload&&s.endSN&&s.advanced){const T=this.hls.config.lowLatencyMode,_=s.lastPartSn,R=s.endSN,I=s.lastPartIndex,C=I!==-1,L=_===R;C?L?(x=R+1,S=T?0:I):(x=_,S=T?I+1:s.maxPartIndex):x=R+1;const k=s.age,M=k+s.ageHeader;let D=Math.min(M-s.partTarget,s.targetduration*1.5);if(D>0){if(M>s.targetduration*3)this.log(`Playlist last advanced ${k.toFixed(2)}s ago. Omitting segment and part directives.`),x=void 0,S=void 0;else if(r!=null&&r.tuneInGoal&&M-s.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${D} with playlist age: ${s.age}`),D=0;else{const U=Math.floor(D/s.targetduration);if(x+=U,S!==void 0){const $=Math.round(D%s.targetduration/s.partTarget);S+=$}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${k.toFixed(2)}s goal: ${D} skip sn ${U} to part ${S}`)}s.tuneInGoal=D}if(b=this.getDeliveryDirectives(s,t.deliveryDirectives,x,S),T||!L){s.requestScheduled=a,this.loadingPlaylist(u,b);return}}else(s.canBlockReload||s.canSkipUntil)&&(b=this.getDeliveryDirectives(s,t.deliveryDirectives,x,S));b&&x!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(y-o*2,y/2)),this.scheduleLoading(u,b,s)}else this.clearTimer()}scheduleLoading(e,t,r){const s=r||e.details;if(!s){this.loadingPlaylist(e,t);return}const i=self.performance.now(),a=s.requestScheduled;if(i>=a){this.loadingPlaylist(e,t);return}const o=a-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),o)}getDeliveryDirectives(e,t,r,s){let i=YB(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,i=Mx.No),new XB(r,s,i)}checkRetry(e){const t=e.details,r=ME(e),s=e.errorAction,{action:i,retryCount:a=0,retryConfig:o}=s||{},l=!!s&&!!o&&(i===Cs.RetryRequest||!s.resolved&&i===Cs.SendAlternateToPenaltyBox);if(l){var c;if(a>=o.maxNumRetry)return!1;if(r&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const u=zP(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,s.resolved=!0}return l}}function YQ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Uv(n[t].attrs,e[t].attrs))return!1;return!0}function Uv(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==e[s])}function nL(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class n2e extends nM{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.LEVEL_LOADING,this.onLevelLoading,this),e.on(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(K.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.LEVEL_LOADING,this.onLevelLoading,this),e.off(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(K.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(K.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Audio track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(o=>s?.indexOf(o)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(m=>!r||r.indexOf(m.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(m=>m.default)&&(this.selectDefaultTrack=!1),o.forEach((m,g)=>{m.id=g});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!i&&l){const m=No(l,o,Qu);if(m>-1)i=o[m];else{const g=No(l,this.tracks);i=this.tracks[g]}}let c=this.findTrackId(i);c===-1&&i&&(c=this.findTrackId(null));const u={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${r?.join(",")}`),this.hls.trigger(K.AUDIO_TRACKS_UPDATED,u);const f=this.trackId;if(c!==-1&&f===-1)this.setAudioTrack(c);else if(o.length&&f===-1){var a;const m=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(m.message),this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:m})}}}onError(e,t){t.fatal||!t.context||t.context.type===nn.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const s=this.currentTrack;if(s&&fd(e,s,Qu))return s;const i=No(e,this.tracksInGroup,Qu);if(i>-1){const a=this.tracksInGroup[i];return this.setAudioTrack(i),a}else if(s){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=pLe(e,t.levels,r,a,Qu);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=No(e,r);if(a>-1)return r[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===r&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(K.AUDIO_TRACK_SWITCHING,Ln({},s)),i))return;const a=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(!(this.selectDefaultTrack&&!s.default)&&(!e||fd(e,s,Qu)))return r}if(e){const{name:r,lang:s,assocLang:i,characteristics:a,audioCodec:o,channels:l}=e;for(let c=0;c<t.length;c++){const u=t[c];if(fd({name:r,lang:s,assocLang:i,characteristics:a,audioCodec:o,channels:l},u,Qu))return c}for(let c=0;c<t.length;c++){const u=t[c];if(Uv(e.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const u=t[c];if(Uv(e.attrs,u.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&PE(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,o=a?.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(K.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}}class r2e{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(i){var r;if(s.onError(i),this.queues===null||this.tracks===null)return;const a=(r=this.tracks[e])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],s=r?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const M6=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,XQ="HlsJsTrackRemovedError";class s2e extends Error{constructor(e){super(e),this.name=XQ}}class i2e extends eo{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:s,mediaSource:i}=this;r&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(K.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:s}=this;r!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=DIe(ou(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.BUFFER_RESET,this.onBufferReset,this),e.on(K.BUFFER_APPENDING,this.onBufferAppending,this),e.on(K.BUFFER_CODECS,this.onBufferCodecs,this),e.on(K.BUFFER_EOS,this.onBufferEos,this),e.on(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(K.FRAG_PARSED,this.onFragParsed,this),e.on(K.FRAG_CHANGED,this.onFragChanged,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.BUFFER_RESET,this.onBufferReset,this),e.off(K.BUFFER_APPENDING,this.onBufferAppending,this),e.off(K.BUFFER_CODECS,this.onBufferCodecs,this),e.off(K.BUFFER_EOS,this.onBufferEos,this),e.off(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(K.FRAG_PARSED,this.onFragParsed,this),e.off(K.FRAG_CHANGED,this.onFragChanged,this),e.off(K.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const a=this.isQueued();(i||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?_n(r,s.tracks):this.sourceBuffers.forEach(i=>{const[a]=i;a&&(r[a]=_n({},this.tracks[a]),this.removeBuffer(a)),i[0]=i[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media,s=ou(this.appendSource);if(this.transferData=this.overrides=void 0,r&&s){const i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(a),i)this._objectUrl=r.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");const l=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||l&&a instanceof l,O6(r),a2e(r,o),r.load()}catch{r.src=o}else r.src=o}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,s=t.tracks,i=s?Object.keys(s):null,a=i?i.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(s&&i&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Wn(r,(l,c)=>l==="initSegment"?void 0:c)};
transfer tracks: ${Wn(s,(l,c)=>l==="initSegment"?void 0:c)}}`),!ZX(s,r)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,c=this.details,u=Math.max(l,c?.fragments[0].start||0);if(u-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${u}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(r)}") start time: ${u} currentTime: ${l}`),this.onMediaDetaching(K.MEDIA_DETACHING,{}),this.onMediaAttaching(K.MEDIA_ATTACHING,t),e.currentTime=u;return}this.transferData=void 0,i.forEach(l=>{const c=l,u=s[c];if(u){const f=u.buffer;if(f){const m=this.fragmentTracker,g=u.id;if(m.hasFragments(g)||m.hasParts(g)){const x=Bt.getBuffered(f);m.detectEvictedFragments(c,x,g,null,!0)}const y=mR(c),b=[c,f];this.sourceBuffers[y]=b,f.updating&&this.operationQueue&&this.operationQueue.prependBlocker(c),this.trackSourceBuffer(c,u)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:a}=this;if(i){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=i.readyState==="open";try{const l=i.sourceBuffers;for(let c=l.length;c--;)o&&l[c].abort(),i.removeSourceBuffer(l[c]);o&&i.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),r||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&O6(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(K.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[mR(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new r2e(this.tracks)}onBufferCodecs(e,t){const r=this.tracks,s=Object.keys(t);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const i="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),a=!i&&this.sourceBufferCount&&this.media&&s.some(o=>!r[o]);if(i||a){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${s}" SourceBuffers`);return}s.forEach(o=>{var l,c,u;const f=t[o],{id:m,codec:g,levelCodec:y,container:b,metadata:x,supplemental:S}=f;let T=r[o];const _=(l=this.transferData)==null||(c=l.tracks)==null?void 0:c[o],R=_!=null&&_.buffer?_:T,I=R?.pendingCodec||R?.codec,C=R?.levelCodec;T||(T=r[o]={buffer:void 0,listeners:[],codec:g,supplemental:S,container:b,levelCodec:y,metadata:x,id:m});const L=Px(I,C),k=L?.replace(M6,"$1");let M=Px(g,y);const D=(u=M)==null?void 0:u.replace(M6,"$1");M&&L&&k!==D&&(o.slice(0,5)==="audio"&&(M=LE(M,this.appendSource)),this.log(`switching codec ${I} to ${M}`),M!==(T.pendingCodec||T.codec)&&(T.pendingCodec=M),T.container=b,this.appendChangeType(o,b,M))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const s=`${t};codecs=${r}`,i={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),o.changeType(s),a.codec=r,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,s=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,gt.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const l=this.tracks.video;(this.lastVideoAppendEnd>s||l!=null&&l.buffer&&Bt.isBuffered(l.buffer,s)||((o=this.fragmentTracker.getAppendedFrag(s,gt.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:s,type:i,parent:a,frag:o,part:l,chunkMeta:c,offset:u}=t,f=c.buffering[i],{sn:m,cc:g}=o,y=self.performance.now();f.start=y;const b=o.stats.buffering,x=l?l.stats.buffering:null;b.start===0&&(b.start=y),x&&x.start===0&&(x.start=y);const S=r.audio;let T=!1;i==="audio"&&S?.container==="audio/mpeg"&&(T=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const _=r.video,R=_?.buffer;if(R&&m!=="initSegment"){const L=l||o,k=this.blockedAudioAppend;if(i==="audio"&&a!=="main"&&!this.blockedAudioAppend){const D=L.start+L.duration*.05,U=R.buffered,$=this.currentOp("video");!U.length&&!$?this.blockAudio(L):!$&&!Bt.isBuffered(R,D)&&this.lastVideoAppendEnd<D&&this.blockAudio(L)}else if(i==="video"){const M=L.end;if(k){const D=k.frag.start;(M>D||M<this.lastVideoAppendEnd||Bt.isBuffered(R,D))&&this.unblockAudio()}this.lastVideoAppendEnd=M}}const I=(l||o).start,C={label:`append-${i}`,execute:()=>{var L;f.executeStart=self.performance.now();const k=(L=this.tracks[i])==null?void 0:L.buffer;k&&(T?this.updateTimestampOffset(k,I,.1,i,m,g):u!==void 0&&at(u)&&this.updateTimestampOffset(k,u,1e-6,i,m,g)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const L=self.performance.now();f.executeEnd=f.end=L,b.first===0&&(b.first=L),x&&x.first===0&&(x.first=L);const k={};this.sourceBuffers.forEach(([M,D])=>{M&&(k[M]=Bt.getBuffered(D))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(K.BUFFER_APPENDED,{type:i,frag:o,part:l,chunkMeta:c,parent:o.type,timeRanges:k})},onError:L=>{var k;const M={type:xt.MEDIA_ERROR,parent:o.type,details:_e.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:o,part:l,chunkMeta:c,error:L,err:L,fatal:!1},D=(k=this.media)==null?void 0:k.error;if(L.code===DOMException.QUOTA_EXCEEDED_ERR||L.name=="QuotaExceededError"||"quota"in L)M.details=_e.BUFFER_FULL_ERROR;else if(L.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!D)M.errorAction=Ov(!0);else if(L.name===XQ&&this.sourceBufferCount===0)M.errorAction=Ov(!0);else{const U=++this.appendErrors[i];this.warn(`Failed ${U}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${D||"no media error"})`),(U>=this.hls.config.appendErrorMaxRetry||D)&&(M.fatal=!0)}this.hls.trigger(K.ERROR,M)}};this.append(C,i,this.isPending(this.tracks[i]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(K.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:r,startOffset:s,endOffset:i}=t;r?this.append(this.getFlushOp(r,s,i),r):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,i),a)})}onFragParsed(e,t){const{frag:r,part:s}=t,i=[],a=s?s.elementaryStreams:r.elementaryStreams;a[jn.AUDIOVIDEO]?i.push("audiovideo"):(a[jn.AUDIO]&&i.push("audio"),a[jn.VIDEO]&&i.push("video"));const o=()=>{const l=self.performance.now();r.stats.buffering.end=l,s&&(s.stats.buffering.end=l);const c=s?s.stats:r.stats;this.hls.trigger(K.FRAG_BUFFERED,{frag:r,part:s,stats:c,id:r.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(o,i).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,r;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((r=this.tracks[e])==null?void 0:r.ending))})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!t.type||t.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const s=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(K.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(K.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===_e.BUFFER_APPEND_ERROR&&t.frag){var r;const s=(r=t.errorAction)==null?void 0:r.nextAutoLevel;at(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const s=e.config,i=r.currentTime,a=t.levelTargetDuration,o=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(at(o)&&o>=0){const l=Math.max(o,a),c=Math.floor(i/a)*a-l;this.flushBackBuffer(i,a,c)}if(at(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const l=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(l,a),u=Math.floor(i/a)*a+c;this.flushFrontBuffer(i,a,u)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const o=Bt.getBuffered(i);if(o.length>0&&r>o.start(0)){var a;this.hls.trigger(K.BACK_BUFFER_REACHED,{bufferEnd:r});const l=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(K.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(l!=null&&l.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(K.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:s})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const a=Bt.getBuffered(i),o=a.length;if(o<2)return;const l=a.start(o-1),c=a.end(o-1);if(r>l||e>=l&&e<=c)return;this.hls.trigger(K.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||r?.readyState!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&r.setLiveSeekableRange){const c=Math.max(0,t.fragmentStart),u=Math.max(c,s);return{duration:1/0,start:c,end:u}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return at(i)?{duration:i}:null;const a=this.media.duration,o=at(r.duration)?r.duration:0;return s>o&&s>a||!at(a)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:r}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(at(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${r}.`),s.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Wn(r)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const s=this.tracks[t];e[t]={buffer:r,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(K.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const a=i,o=e[a];if(this.isPending(o)){const l=this.getTrackCodec(o,a),c=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${c})${this.currentOp(a)?" Queued":""} ${Wn(o)}`);try{const u=r.addSourceBuffer(c),f=mR(a),m=[a,u];t[f]=m,o.buffer=u}catch(u){var s;this.error(`error while trying to add sourceBuffer: ${u.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:a,mimeType:c,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let s=e.codec;r&&(t==="video"||t==="audiovideo")&&qI(r,"video")&&(s=ZIe(s,r));const i=Px(s,e.levelCodec);return i?t.slice(0,5)==="audio"?LE(i,this.appendSource):i:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(K.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${s}`,t),this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,t,r,s,i,a){const o=t-e.timestampOffset;Math.abs(o)>=r&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${i} cc: ${a})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:s,mediaSource:i}=this,a=this.tracks[e],o=a?.buffer;if(!s||!i||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=at(s.duration)?s.duration:1/0,c=at(i.duration)?i.duration:1/0,u=Math.max(0,t),f=Math.min(r,l,c);f>u&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${u},${f}] from the ${e} SourceBuffer`),o.remove(u,f)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],s=r?.buffer;if(!s)throw new s2e(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,s=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const s=(r=this.tracks[t])==null?void 0:r.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const a=r.bind(this,e);s.listeners.push({event:t,listener:a}),i.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(s=>{r.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function O6(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function a2e(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function mR(n){return n==="audio"?1:0}class rM{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(K.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(K.BUFFER_CODECS,this.onBufferCodecs,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(K.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(K.BUFFER_CODECS,this.onBufferCodecs,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&at(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,rM.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let i=e.length-1;const a=Math.max(t,r);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&s(l,e[o+1])){i=o;break}}return i}}const o2e={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ei=o2e,l2e={HLS:"h"},c2e=l2e,u2e="CMCD-Object",d2e="CMCD-Request",h2e="CMCD-Session",f2e="CMCD-Status",lg={OBJECT:u2e,REQUEST:d2e,SESSION:h2e,STATUS:f2e},m2e={[lg.OBJECT]:["br","ab","d","ot","tb","tpb","lb","tab","lab","url"],[lg.REQUEST]:["pb","bl","tbl","dl","ltc","mtp","nor","nrr","rc","sn","sta","su","ttfb","ttfbb","ttlb","cmsdd","cmsds","smrt","df","cs"],[lg.SESSION]:["cid","pr","sf","sid","st","v","msd"],[lg.STATUS]:["bs","bsd","cdn","rtp","bg","pt","ec","e"]};class tm{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof tm?r:new tm(r))),this.value=e,this.params=t}}const p2e="Dict";function g2e(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function v2e(n,e,t,r){return new Error(`failed to ${n} "${g2e(e)}" as ${t}`,{cause:r})}function Ko(n,e,t){return v2e("serialize",n,e,t)}class QQ{constructor(e){this.description=e}}const N6="Bare Item",y2e="Boolean";function b2e(n){if(typeof n!="boolean")throw Ko(n,y2e);return n?"?1":"?0"}function x2e(n){return btoa(String.fromCharCode(...n))}const w2e="Byte Sequence";function E2e(n){if(ArrayBuffer.isView(n)===!1)throw Ko(n,w2e);return`:${x2e(n)}:`}const S2e="Integer";function T2e(n){return n<-999999999999999||999999999999999<n}function ZQ(n){if(T2e(n))throw Ko(n,S2e);return n.toString()}function _2e(n){return`@${ZQ(n.getTime()/1e3)}`}function JQ(n,e){if(n<0)return-JQ(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const s=Math.floor(n*t);return(s%2===0?s:s+1)/t}else return Math.round(n*t)/t}const A2e="Decimal";function R2e(n){const e=JQ(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ko(n,A2e);const t=e.toString();return t.includes(".")?t:`${t}.0`}const C2e="String",k2e=/[\x00-\x1f\x7f]+/;function I2e(n){if(k2e.test(n))throw Ko(n,C2e);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function L2e(n){return n.description||n.toString().slice(7,-1)}const D2e="Token";function j6(n){const e=L2e(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ko(e,D2e);return e}function rL(n){switch(typeof n){case"number":if(!at(n))throw Ko(n,N6);return Number.isInteger(n)?ZQ(n):R2e(n);case"string":return I2e(n);case"symbol":return j6(n);case"boolean":return b2e(n);case"object":if(n instanceof Date)return _2e(n);if(n instanceof Uint8Array)return E2e(n);if(n instanceof QQ)return j6(n);default:throw Ko(n,N6)}}const P2e="Key";function sL(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw Ko(n,P2e);return n}function sM(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${sL(e)}`:`;${sL(e)}=${rL(t)}`).join("")}function eZ(n){return n instanceof tm?`${rL(n.value)}${sM(n.params)}`:rL(n)}function M2e(n){return`(${n.value.map(eZ).join(" ")})${sM(n.params)}`}function O2e(n,e={whitespace:!0}){if(typeof n!="object")throw Ko(n,p2e);const t=n instanceof Map?n.entries():Object.entries(n),r=e?.whitespace?" ":"";return Array.from(t).map(([s,i])=>{i instanceof tm||(i=new tm(i));let a=sL(s);return i.value===!0?a+=sM(i.params):(a+="=",Array.isArray(i.value)?a+=M2e(i):a+=eZ(i)),a}).join(`,${r}`)}function N2e(n,e){return O2e(n,e)}function j2e(n){return["ot","sf","st","e","sta"].includes(n)}function F2e(n){return typeof n=="number"?at(n):n!=null&&n!==""&&n!==!1}function U2e(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const s=t.pathname.split("/").slice(1),i=r.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")}const Fx=n=>Math.round(n),$2e=(n,e)=>(e?.baseUrl&&(n=U2e(n,e.baseUrl)),encodeURIComponent(n)),Ob=n=>Fx(n/100)*100,B2e={br:Fx,d:Fx,bl:Ob,dl:Ob,mtp:Ob,nor:$2e,rtp:Ob,tb:Fx};function H2e(n,e){const t={};if(n==null||typeof n!="object")return t;const r=Object.keys(n).sort(),s=_n({},B2e,e?.formatters),i=e?.filter;return r.forEach(a=>{if(i?.(a)===!1)return;let o=n[a];const l=s[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||F2e(o)&&(j2e(a)&&typeof o=="string"&&(o=new QQ(o)),t[a]=o))}),t}function tZ(n,e={}){return n?N2e(H2e(n,e),_n({whitespace:!1},e)):""}function V2e(n,e={}){const t={};if(!n)return t;const r=Object.entries(n),s=Object.entries(m2e).concat(Object.entries(e?.customHeaderMap||{})),i=r.reduce((a,o)=>{var l,c;const[u,f]=o,m=((l=s.find(g=>g[1].includes(u)))===null||l===void 0?void 0:l[0])||lg.REQUEST;return(c=a[m])!==null&&c!==void 0||(a[m]={}),a[m][u]=f,a},{});return Object.entries(i).reduce((a,[o,l])=>(a[o]=tZ(l,e),a),t)}function z2e(n,e,t){return _n(n,V2e(e,t))}const G2e="CMCD";function q2e(n,e={}){if(!n)return"";const t=tZ(n,e);return`${G2e}=${encodeURIComponent(t)}`}const F6=/CMCD=[^&#]+/;function W2e(n,e,t){const r=q2e(e,t);if(!r)return n;if(F6.test(n))return n.replace(F6,r);const s=n.includes("?")?"&":"?";return`${n}${s}${r}`}class K2e{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:ei.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:a}=s,o=this.hls.levels[i.level],l=this.getObjectType(i),c={d:(a||i).duration*1e3,ot:l};(l===ei.VIDEO||l===ei.AUDIO||l==ei.MUXED)&&(c.br=o.bitrate/1e3,c.tb=this.getTopBandwidth(l)/1e3,c.bl=this.getBufferLength(l));const u=a?this.getNextPart(a):this.getNextFrag(i);u!=null&&u.url&&u.url!==i.url&&(c.nor=u.url),this.apply(s,c)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHED,this.onMediaDetached,this),e.on(K.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHED,this.onMediaDetached,this),e.off(K.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:c2e.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){_n(t,this.createData());const r=t.ot===ei.INIT||t.ot===ei.VIDEO||t.ot===ei.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((a,o)=>(s.includes(o)&&(a[o]=t[o]),a),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),z2e(e.headers,t,i)):e.url=W2e(e.url,t,i)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const s=e.sn-r.startSN;return r.fragments[s+1]}}getNextPart(e){var t,r;const{index:s,fragment:i}=e,a=(t=this.hls.levels[i.level])==null||(r=t.details)==null?void 0:r.partList;if(a){const{sn:o}=i;for(let l=a.length-1;l>=0;l--){const c=a[l];if(c.index===s&&c.fragment.sn===o)return a[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return ei.TIMED_TEXT;if(e.sn==="initSegment")return ei.INIT;if(t==="audio")return ei.AUDIO;if(t==="main")return this.hls.audioTracks.length?ei.VIDEO:ei.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===ei.AUDIO)r=s.audioTracks;else{const i=s.maxAutoLevel,a=i>-1?i+1:s.levels.length;r=s.levels.slice(0,a)}return r.forEach(i=>{i.bitrate>t&&(t=i.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===ei.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Bt.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,o){t(i),this.loader.load(i,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,o){t(i),this.loader.load(i,a,o)}}}}const Y2e=3e5;class X2e extends eo{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if(r?.action===Cs.SendAlternateToPenaltyBox&&r.flags===Fa.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:l,type:c}=t.context;o&&s?a=this.getPathwayForGroupId(o,c,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==a),t.details===_e.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${Wn(i)} penalized: ${Wn(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(i=>{s-r[i]>Y2e&&delete r[i]});for(let i=0;i<e.length;i++){const a=e[i];if(a in r)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,AQ(t),this.hls.trigger(K.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[o];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,r){const s=this.getLevelsForPathway(r).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===nn.AUDIO_TRACK&&s[i].hasAudioGroup(e)||t===nn.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(i=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=i;if(t.some(u=>u.pathwayId===a))return;const c=this.getLevelsForPathway(o).map(u=>{const f=new nr(u.attrs);f["PATHWAY-ID"]=a;const m=f.AUDIO&&`${f.AUDIO}_clone_${a}`,g=f.SUBTITLES&&`${f.SUBTITLES}_clone_${a}`;m&&(r[f.AUDIO]=m,f.AUDIO=m),g&&(s[f.SUBTITLES]=g,f.SUBTITLES=g);const y=nZ(u.uri,f["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),b=new Mv({attrs:f,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:y,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let x=1;x<u.audioGroups.length;x++)b.addGroupId("audio",`${u.audioGroups[x]}_clone_${a}`);if(u.subtitleGroups)for(let x=1;x<u.subtitleGroups.length;x++)b.addGroupId("text",`${u.subtitleGroups[x]}_clone_${a}`);return b});t.push(...c),U6(this.audioTracks,r,l,a),U6(this.subtitleTracks,s,l,a)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+u)}const i={responseType:"json",url:s.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(u,f,m,g)=>{this.log(`Loaded steering manifest: "${s}"`);const y=u.data;if(y?.VERSION!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":x,"PATHWAY-PRIORITY":S}=y;if(b)try{this.uri=new self.URL(b,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||m.url),x&&this.clonePathways(x);const T={steeringManifest:y,url:s.toString()};this.hls.trigger(K.STEERING_MANIFEST_LOADED,T),S&&this.updatePathwayPriority(S)},onError:(u,f,m,g)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${f.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`);return}let y=this.timeToLoad*1e3;if(u.code===429){const b=this.loader;if(typeof b?.getResponseHeader=="function"){const x=b.getResponseHeader("Retry-After");x&&(y=parseFloat(x)*1e3)}this.log(`Steering manifest ${f.url} rate limited`);return}this.scheduleRefresh(this.uri||f.url,y)},onTimeout:(u,f,m)=>{this.log(`Timeout loading steering manifest (${f.url})`),this.scheduleRefresh(this.uri||f.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const s=(r=this.hls)==null?void 0:r.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function U6(n,e,t,r){n&&Object.keys(e).forEach(s=>{const i=n.filter(a=>a.groupId===s).map(a=>{const o=_n({},a);return o.details=void 0,o.attrs=new nr(o.attrs),o.url=o.attrs.URI=nZ(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[s],o.attrs["PATHWAY-ID"]=r,o});n.push(...i)})}function nZ(n,e,t,r){const{HOST:s,PARAMS:i,[t]:a}=r;let o;e&&(o=a?.[e],o&&(n=o));const l=new self.URL(n);return s&&!o&&(l.host=s),i&&Object.keys(i).sort().forEach(c=>{c&&l.searchParams.set(c,i[c])}),l.href}function fa(n,e,t){Ha(n,e,t),n.addEventListener(e,t)}function Ha(n,e,t){n.removeEventListener(e,t)}class Pf extends eo{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Pf.CDMCleanupPromise?[Pf.CDMCleanupPromise]:[],this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onWaitingForKey=null}registerListeners(){this.hls.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(K.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(K.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(K.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(K.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(K.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(K.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(K.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(K.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t[e];if(s)return s.licenseUrl;if(e===Sr.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(a,o,l)=>!!a&&l.indexOf(a)===o,s=t.map(a=>a.audioCodec).filter(r),i=t.map(a=>a.videoCodec).filter(r);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((a,o)=>{const l=c=>{const u=c.shift();this.getMediaKeysPromise(u,s,i).then(f=>a({keySystem:u,mediaKeys:f})).catch(f=>{c.length?l(c):f instanceof Ji?o(f):o(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return bQ===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){const s=BLe(e,t,r,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e];let a=i?.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Wn(s)}`),a=this.requestMediaKeySystemAccess(e,s);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(u=>(this.log(`Media-keys created for "${e}"`),o.hasMediaKeys=!0,c.then(f=>f?this.setMediaKeysServerCertificate(u,e,f):u))),o.mediaKeys.catch(u=>{this.error(`Failed to create media-keys for "${e}"}: ${u}`)}),o.mediaKeys})}return a.then(()=>i.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${ed.hexDump(e.keyId||[])}`);const s=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,i,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return ed.hexDump(e.keyId)}updateKeySession(e,t){var r;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${ed.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),s.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>d6(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=d6(s);i?t(i):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Ox(this.config),r=e.map(QI).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(r)}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),s=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let i=this.keyIdToKeySessionPromise[r];return i||(i=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(o,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[r]=i.then(o=>{const l="cenc",c=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,l,c,"playlist-key")})).catch(o=>this.handleError(o))),i}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Ji?this.hls.trigger(K.ERROR,e.data):this.hls.trigger(K.ERROR,{type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=QI(e.keyFormat),i=s?[s]:Ox(this.config);return this.attemptKeySystemAccess(i)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=Ox(this.config)),e.length===0)throw new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Wn({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>r.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var i,a;const o=(i=this.config.drmSystems)==null||(a=i[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const y=o.call(this.hls,t,r,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,r=y.initData?y.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(y){var l;if(this.warn(y.message),(l=this.hls)!=null&&l.config.debug)throw y}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${c} (init data type: ${t} length: ${r?r.byteLength:null})`);const u=new YP,f=e._onmessage=y=>{const b=e.mediaKeysSession;if(!b){u.emit("error",new Error("invalid state"));return}const{messageType:x,message:S}=y;this.log(`"${x}" message event for session "${b.sessionId}" message size: ${S.byteLength}`),x==="license-request"||x==="license-renewal"?this.renewLicense(e,S).catch(T=>{u.eventNames().length?u.emit("error",T):this.handleError(T)}):x==="license-release"?e.keySystem===Sr.FAIRPLAY&&(this.updateKeySession(e,XI("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${x}"`)},m=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const x=e.keyStatus;u.emit("keyStatus",x),x==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};fa(e.mediaKeysSession,"message",f),fa(e.mediaKeysSession,"keystatuseschange",m);const g=new Promise((y,b)=>{u.on("error",b),u.on("keyStatus",x=>{x.startsWith("usable")?y():x==="output-restricted"?b(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):x==="internal-error"?b(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${x}"`)):x==="expired"?b(new Error("key expired while generating request")):this.warn(`unhandled key status change "${x}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var y;this.log(`Request generated for key-session "${(y=e.mediaKeysSession)==null?void 0:y.sessionId}" keyId: ${c}`)}).catch(y=>{throw new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_NO_SESSION,error:y,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>g).catch(y=>{throw u.removeAllListeners(),this.removeSession(e),y}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{if(typeof r=="string"&&typeof t=="object"){const s=r;r=t,t=s}this.log(`key status change "${t}" for keyStatuses keyId: ${ed.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${ed.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:i},c=t.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(m,g,y,b)=>{a(m.data)},onError:(m,g,y,b)=>{o(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Ln({url:l.url,data:void 0},m)},`"${e}" certificate request failed (${i}). Status: ${m.code} (${m.text})`))},onTimeout:(m,g,y)=>{o(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(m,g,y)=>{o(new Error("aborted"))}};s.load(l,u,f)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,i)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r?.byteLength}) on "${t}"`),s(e)}).catch(a=>{i(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(r,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let u;for(let f=0,m=i.length;f<m;f++){var a,o;u=i[f];const g=(a=u.querySelector("name"))==null?void 0:a.textContent,y=(o=u.querySelector("value"))==null?void 0:o.textContent;g&&y&&e.setRequestHeader(g,y)}}const l=s.querySelector("Challenge"),c=l?.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return XI(atob(c))}setupLicenseXHR(e,t,r,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,s)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",t,!0),i.call(this.hls,e,t,r,s)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,o,a,e)}catch(u){this.error(u)}s(l)}else{const l=r.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||o.status>=400&&o.status<500)i(new Ji({type:xt.KEY_SYSTEM_ERROR,details:_e.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const u=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${u} attempts left`),this.requestLicense(e,t).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==Sr.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,fa(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(Ha(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,JS.clearKeyUriToKeyIdMap();const s=r.length;Pf.CDMCleanupPromise=Promise.all(r.map(i=>this.removeSession(i)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(i=>{var a;this.log(`Could not clear media keys: ${i}`),(a=this.hls)==null||a.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${i}`)})}))).catch(i=>{var a;this.log(`Could not close sessions and clear media keys: ${i}`),(a=this.hls)==null||a.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${i}`)})}).then(()=>{s&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{drmSystemOptions:i}=this.config;return(VLe(i)?new Promise((o,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(o)}):Promise.resolve()).catch(o=>{var l;this.log(`Could not remove session: ${o}`),(l=this.hls)==null||l.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>t.close()).catch(o=>{var l;this.log(`Could not close session: ${o}`),(l=this.hls)==null||l.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}}Pf.CDMCleanupPromise=void 0;class Ji extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class Q2e{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(K.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(K.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const i=s-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/i,c=this.hls;if(c.trigger(K.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),l>0&&a>c.config.fpsDroppedMonitoringThreshold*o){let u=c.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(K.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function rZ(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function sZ(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){vn.debug(`[texttrack-utils]: ${r}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}catch(s){vn.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(n.mode=t)}function bf(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let r=n.cues.length;r--;)e&&n.cues[r].removeEventListener("enter",e),n.removeCue(n.cues[r]);t==="disabled"&&(n.mode=t)}function iL(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const i=J2e(n.cues,e,t);for(let a=0;a<i.length;a++)(!r||r(i[a]))&&n.removeCue(i[a])}s==="disabled"&&(n.mode=s)}function Z2e(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t,i;for(;r<=s;)if(i=Math.floor((s+r)/2),e<n[i].startTime)s=i-1;else if(e>n[i].startTime&&r<t)r=i+1;else return i;return n[r].startTime-e<e-n[s].startTime?r:s}function J2e(n,e,t){const r=[],s=Z2e(n,e);if(s>-1)for(let i=s,a=n.length;i<a;i++){const o=n[i];if(o.startTime>=e&&o.endTime<=t)r.push(o);else if(o.startTime>t)return r}return r}function Ux(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class ePe extends nM{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=Ux(this.media.textTracks);for(let i=0;i<r.length;i++)if(r[i].mode==="hidden")t=r[i];else if(r[i].mode==="showing"){t=r[i];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.LEVEL_LOADING,this.onLevelLoading,this),e.on(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(K.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(K.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.LEVEL_LOADING,this.onLevelLoading,this),e.off(K.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(K.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(K.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;Ux(r.textTracks).forEach(a=>{bf(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(a=>s?.indexOf(a)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(u=>!r||r.indexOf(u.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(u=>u.default)&&(this.selectDefaultTrack=!1),a.forEach((u,f)=>{u.id=f});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!i&&o){this.selectDefaultTrack=!1;const u=No(o,a);if(u>-1)i=a[u];else{const f=No(o,this.tracks);i=this.tracks[f]}}let l=this.findTrackId(i);l===-1&&i&&(l=this.findTrackId(null));const c={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r?.join(",")}" group-id`),this.hls.trigger(K.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const i=t[s];if(!(r&&!i.default||!r&&!e)&&(!e||fd(i,e)))return s}if(e){for(let s=0;s<t.length;s++){const i=t[s];if(Uv(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const i=t[s];if(Uv(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(nL(s,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===nn.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&fd(e,r))return r;const s=No(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(r)return null;{const i=No(e,t);if(i>-1)return t[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,o=a?.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(K.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Ux(e.textTracks),r=this.currentTrack;let s;if(r&&(s=t.filter(i=>nL(r,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!at(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(K.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===r&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:a,groupId:o="",name:l,type:c,url:u}=s;this.hls.trigger(K.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:c,url:u});const f=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(f)}}function tPe(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?i:i&3|8).toString(16)})}}}function Ug(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const Mf=.025;let UE=function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n}({});function nPe(n,e,t){return`${n.identifier}-${t+1}-${Ug(e)}`}class rPe{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return pR(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=pR(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=at(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return pR(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Mf))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?UE.Range:UE.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return sPe(this)}}function pR(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<Mf)?e.start:e.start+e.duration}function iZ(n,e,t){const r=new self.URL(n,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function gR(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function sPe(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function af(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class iPe{constructor(e,t,r,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(K.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(t);this.interstitial=r,this.assetItem=s;let a=s.uri;try{a=iZ(a,t.primarySessionId).href}catch{}i.loadSource(a);const o=()=>{this.hasDetails=!0};i.once(K.LEVEL_LOADED,o),i.once(K.AUDIO_TRACK_LOADED,o),i.once(K.SUBTITLE_TRACK_LOADED,o),i.on(K.MEDIA_ATTACHING,(l,{media:c})=>{this.removeMediaListeners(),this.mediaAttached=c,this.interstitial.playoutLimit&&(c.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(K.BUFFER_APPENDED,()=>{const f=this.bufferedEnd;this.reachedPlayout(f)&&(this._bufferedEosTime=f,i.trigger(K.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const r=this.timelineOffset,s=Bt.bufferInfo(e,r,0);return this.getAssetTime(s.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Bt.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){this.hls.on(e,t)}once(e,t,r){this.hls.once(e,t)}off(e,t,r){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${af(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const $6=.033;class aPe extends eo{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(i=s[r])!=null&&i.event;){var i;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let s=0;s<r.length;s++){let i=r[s];if(t&&t!=="primary"&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let s=e;s<=t&&r[s];s++){const i=r[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var r;if(((r=t[s].event)==null?void 0:r.identifier)===e)return s}return-1}findAssetIndex(e,t){const r=e.assetList,s=r.length;if(s>1)for(let i=0;i<s;i++){const a=r[i];if(!a.error){const o=a.timelineStart;if(t===o||t>o&&t<o+(a.duration||0))return i}}return 0}get assetIdAtEnd(){var e,t;const r=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(r){const s=r.assetList,i=s[s.length-1];if(i)return i.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:s}=r,i=this.events,a=this.parseDateRanges(s,{url:r.url},t),o=Object.keys(s),l=i?i.filter(c=>!o.includes(c.identifier)):[];a.length&&a.sort((c,u)=>{const f=c.cue.pre,m=c.cue.post,g=u.cue.pre,y=u.cue.post;if(f&&!g)return-1;if(g&&!f||m&&!y)return 1;if(y&&!m)return-1;if(!f&&!g&&!m&&!y){const b=c.startTime,x=u.startTime;if(b!==x)return b-x}return c.dateRange.tagOrder-u.dateRange.tagOrder}),this.events=a,l.forEach(c=>{this.removeEvent(c)}),this.updateSchedule(e,l)}updateSchedule(e,t=[]){const r=this.events||[];if(r.length||t.length||this.length<2){const s=this.items,i=this.parseSchedule(r,e);(t.length||s?.length!==i.length||i.some((o,l)=>Math.abs(o.playout.start-s[l].playout.start)>.005||Math.abs(o.playout.end-s[l].playout.end)>.005))&&(this.items=i,this.onScheduleUpdate(t,s))}}parseDateRanges(e,t,r){const s=[],i=Object.keys(e);for(let a=0;a<i.length;a++){const o=i[a],l=e[o];if(l.isInterstitial){let c=this.eventMap[o];c?c.setDateRange(l):(c=new rPe(l,t),this.eventMap[o]=c,r===!1&&(c.appendInPlace=r)),s.push(c)}}return s}parseSchedule(e,t){const r=[],s=t.main.details,i=s.live?1/0:s.edge;let a=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,c=0;if(e.forEach((u,f)=>{const m=u.cue.pre,g=u.cue.post,y=e[f-1]||null,b=u.appendInPlace,x=g?i:u.startOffset,S=u.duration,T=u.timelineOccupancy===UE.Range?S:0,_=u.resumptionOffset,R=y?.startTime===x,I=x+u.cumulativeDuration;let C=b?I+S:x+_;if(m||!g&&x<=0){const k=c;c+=T,u.timelineStart=I;const M=a;a+=S,r.push({event:u,start:I,end:C,playout:{start:M,end:a},integrated:{start:k,end:c}})}else if(x<=i){if(!R){const D=x-l;if(D>$6){const U=l,$=c;c+=D;const V=a;a+=D;const B={previousEvent:e[f-1]||null,nextEvent:u,start:U,end:U+D,playout:{start:V,end:a},integrated:{start:$,end:c}};r.push(B)}else D>0&&y&&(y.cumulativeDuration+=D,r[r.length-1].end=x)}g&&(C=I),u.timelineStart=I;const k=c;c+=T;const M=a;a+=S,r.push({event:u,start:I,end:C,playout:{start:M,end:a},integrated:{start:k,end:c}})}else return;const L=u.resumeTime;g||L>i?l=i:l=L}),l<i){var o;const u=l,f=c,m=i-l;c+=m;const g=a;a+=m,r.push({previousEvent:((o=r[r.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:u+m,playout:{start:g,end:a},integrated:{start:f,end:c}})}this.setDurations(i,a,c)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,s=r.live?1/0:r.edge;let i=0,a=-1;e.forEach((o,l)=>{const c=o.cue.pre,u=o.cue.post,f=c?0:u?s:o.startTime;this.updateAssetDurations(o),a===f?o.cumulativeDuration=i:(i=0,a=f),!u&&o.snapOptions.in&&(o.resumeAnchor=Ad(null,r.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<$6&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const g=at(o.resumeOffset)?o.resumeOffset:o.duration;i+=g})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(r-s)>Mf?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${s}`),!1):t?!Object.keys(t).some(a=>{const o=t[a].details,l=o.edge;if(r>=l)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${l}`),!1;const c=Ad(null,o.fragments,r);if(!c)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const u=a==="audio"?.175:0;return Math.abs(c.start-r)<Mf+u||Math.abs(c.end-r)<Mf+u?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${c.start}-${c.end} sn: ${c.sn} cc: ${c.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${r} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,s=!1,i=!1;e.assetList.forEach((a,o)=>{const l=t+r;a.startOffset=r,a.timelineStart=l,s||(s=a.duration===null),i||(i=!!a.error);const c=a.error?0:a.duration||0;r+=c}),s&&!i?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function _c(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class oPe{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let s;try{s=iZ(r,this.hls.sessionId,e.baseUrl)}catch(m){const g=this.assignAssetListError(e,_e.ASSET_LIST_LOAD_ERROR,m,r);this.hls.trigger(K.ERROR,g);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const i=this.hls.config,a=i.loader,o=new a(i),l={responseType:"json",url:s.href},c=i.interstitialAssetListLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(m,g,y,b)=>{const x=m.data,S=x?.ASSETS;if(!Array.isArray(S)){const T=this.assignAssetListError(e,_e.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,g,b);this.hls.trigger(K.ERROR,T);return}e.assetListResponse=x,this.hls.trigger(K.ASSET_LIST_LOADED,{event:e,assetListResponse:x,networkDetails:b})},onError:(m,g,y,b)=>{const x=this.assignAssetListError(e,_e.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${m.code} ${m.text} (${g.url})`),g.url,b,y);this.hls.trigger(K.ERROR,x)},onTimeout:(m,g,y)=>{const b=this.assignAssetListError(e,_e.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${g.url})`),g.url,m,y);this.hls.trigger(K.ERROR,b)}};return o.load(l,u,f),this.hls.trigger(K.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,t,r,s,i,a){return e.error=r,{type:xt.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:r,networkDetails:a,stats:i}}}function B6(n){n?.play().catch(()=>{})}class lPe extends eo{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;const s=r-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const a=s<=-.01;this.timelinePos=r,this.bufferedPos=r;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-s)&&this.updateSchedule(),this.checkBuffer(),a&&r<o.start||r>=o.end){var l;const m=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){const g=this.findItemIndex(o);if(m>g){const y=this.schedule.findJumpRestrictedIndex(g+1,m);if(y>g){this.setSchedulePosition(y);return}}}this.setSchedulePosition(m);return}const c=this.playingAsset;if(!c){if(this.playingLastItem&&this.isInterstitial(o)){const m=o.event.assetList[0];m&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,m))}return}const u=c.timelineStart,f=c.duration||0;(a&&r<u||r>=u+f)&&this.setScheduleToAssetAtTime(r,c)},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(r>=s.end){this.timelinePos=s.end;const o=this.findItemIndex(s);this.setSchedulePosition(o+1)}const i=this.playingAsset;if(!i)return;const a=i.timelineStart+(i.duration||0);r>=a&&this.setScheduleToAssetAtTime(r,i)},this.onScheduleUpdate=(r,s)=>{const i=this.schedule,a=this.playingItem,o=i.events||[],l=i.items||[],c=i.durations,u=r.map(y=>y.identifier),f=!!(o.length||u.length);(f||s)&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(y=>_c(y))} pos: ${this.timelinePos}`),u.length&&this.log(`Removed events ${u}`),this.playerQueue.forEach(y=>{if(y.interstitial.appendInPlace){const b=y.assetItem.timelineStart,x=y.timelineOffset-b;if(x)try{y.timelineOffset=b}catch(S){Math.abs(x)>Mf&&this.warn(`${S} ("${y.assetId}" ${y.timelineOffset}->${b})`)}}});let m=null;if(a){const y=this.updateItem(a,this.timelinePos);this.itemsMatch(a,y)&&(this.playingItem=y,this.waitingItem=this.endedItem=null,m=()=>this.trimInPlace(y,a))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const g=this.bufferingItem;if(g){const y=this.updateItem(g,this.bufferedPos);this.itemsMatch(g,y)?(this.bufferingItem=y,m||(m=()=>this.trimInPlace(y,g))):g.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(g.event,null))}if(r.forEach(y=>{y.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),f||s){if(this.hls.trigger(K.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:c,removedIds:u}),this.isInterstitial(a)&&u.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}m&&m(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new oPe(e),this.schedule=new aPe(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(K.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(K.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(K.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(K.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(K.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(K.BUFFER_APPENDED,this.onBufferAppended,this),e.on(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(K.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(K.MEDIA_ENDED,this.onMediaEnded,this),e.on(K.ERROR,this.onError,this),e.on(K.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(K.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(K.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(K.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(K.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(K.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(K.BUFFER_CODECS,this.onBufferCodecs,this),e.off(K.BUFFER_APPENDED,this.onBufferAppended,this),e.off(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(K.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(K.MEDIA_ENDED,this.onMediaEnded,this),e.off(K.ERROR,this.onError,this),e.off(K.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Ha(e,"play",this.onPlay),Ha(e,"pause",this.onPause),Ha(e,"seeking",this.onSeeking),Ha(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;fa(r,"seeking",this.onSeeking),fa(r,"timeupdate",this.onTimeupdate),fa(r,"play",this.onPlay),fa(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(r);this.setSchedulePosition(i)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(this.media=null,!r&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=f=>f&&e.getAssetPlayer(f.identifier),s=(f,m,g,y,b)=>{if(f){let x=f[m].start;const S=f.event;if(S){if(m==="playout"||S.timelineOccupancy!==UE.Point){const T=r(g);T?.interstitial===S&&(x+=T.assetItem.startOffset+T[b])}}else{const T=y==="bufferedPos"?a():e[y];x+=T-f.start}return x}return 0},i=(f,m)=>{if(f!==0&&m!=="primary"&&e.schedule.length){var g;const y=e.schedule.findItemIndexAtTime(f),b=(g=e.schedule.items)==null?void 0:g[y];if(b){const x=b[m].start-b.start;return f+x}}return f},a=()=>{const f=e.bufferedPos;return f===Number.MAX_VALUE?o("primary"):Math.max(f,0)},o=f=>{var m;return(m=e.primaryDetails)!=null&&m.live?e.primaryDetails.edge:e.schedule.durations[f]},l=(f,m)=>{var g,y;const b=e.effectivePlayingItem;if(b!=null&&(g=b.event)!=null&&g.restrictions.skip)return;e.log(`seek to ${f} "${m}"`);const x=e.effectivePlayingItem,S=e.schedule.findItemIndexAtTime(f,m),T=(y=e.schedule.items)==null?void 0:y[S],_=e.getBufferingPlayer(),R=_?.interstitial,I=R?.appendInPlace,C=x&&e.itemsMatch(x,T);if(x&&(I||C)){const k=r(e.playingAsset),M=k?.media||e.primaryMedia;if(M){const D=m==="primary"?M.currentTime:s(x,m,e.playingAsset,"timelinePos","currentTime"),U=f-D,$=(I?D:M.currentTime)+U;if($>=0&&(!k||I||$<=k.duration)){M.currentTime=$;return}}}if(T){let k=f;if(m!=="primary"){const D=T[m].start,U=f-D;k=T.start+U}const M=!e.isInterstitial(T);if((!e.isInterstitial(x)||x.event.appendInPlace)&&(M||T.event.appendInPlace)){const D=e.media||(I?_?.media:null);D&&(D.currentTime=k)}else if(x){const D=e.findItemIndex(x);if(S>D){const $=e.schedule.findJumpRestrictedIndex(D+1,S);if($>D){e.setSchedulePosition($);return}}let U=0;if(M)e.timelinePos=k,e.checkBuffer();else{var L;const $=T==null||(L=T.event)==null?void 0:L.assetList;if($){const V=f-(T[m]||T).start;for(let B=$.length;B--;){const W=$[B];if(W.duration&&V>=W.startOffset&&V<W.startOffset+W.duration){U=B;break}}}}e.setSchedulePosition(S,U)}}},c=()=>{const f=e.effectivePlayingItem;if(e.isInterstitial(f))return f;const m=t();return e.isInterstitial(m)?m:null},u={get currentTime(){const f=c(),m=e.effectivePlayingItem;return m&&m===f?s(m,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-m.playout.start:0},set currentTime(f){const m=c(),g=e.effectivePlayingItem;g&&g===m&&l(f+g.playout.start,"playout")},get duration(){const f=c();return f?f.playout.end-f.playout.start:0},get assetPlayers(){var f;const m=(f=c())==null?void 0:f.event.assetList;return m?m.map(g=>e.getAssetPlayer(g.identifier)):[]},get playingIndex(){var f;const m=(f=c())==null?void 0:f.event;return m&&e.effectivePlayingAsset?m.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return c()}};this.manager={get events(){var f,m;return((f=e.schedule)==null||(m=f.events)==null?void 0:m.slice(0))||[]},get schedule(){var f,m;return((f=e.schedule)==null||(m=f.items)==null?void 0:m.slice(0))||[]},get interstitialPlayer(){return c()?u:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const f=t();return e.findItemIndex(f)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const f=e.effectivePlayingItem;return e.findItemIndex(f)},primary:{get bufferedEnd(){return a()},get currentTime(){const f=e.timelinePos;return f>0?f:0},set currentTime(f){l(f,"primary")},get duration(){return o("primary")},get seekableStart(){var f;return((f=e.primaryDetails)==null?void 0:f.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(f){l(f,"integrated")},get duration(){return o("integrated")},get seekableStart(){var f;return i(((f=e.primaryDetails)==null?void 0:f.fragmentStart)||0,"integrated")}},skip:()=>{const f=e.effectivePlayingItem,m=f?.event;if(m&&!m.restrictions.skip){const g=e.findItemIndex(f);if(m.appendInPlace){const y=f.playout.start+f.event.duration;l(y+.001,"playout")}else e.advanceAfterAssetEnded(m,g,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,r;if(this.mediaSelection===null)return;const s=this.waitingItem||this.playingItem;if(this.isInterstitial(s)&&!s.event.appendInPlace)return;let i=this.media;!i&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(i=this.primaryMedia);const a=(r=i)==null?void 0:r.currentTime;if(!(a===void 0||!at(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,s=e.media;if(r&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Wn(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var r,s;if(e.media===t)return;let i=null;const a=this.hls,o=e!==a,l=o&&e.interstitial.appendInPlace,c=(r=this.detachedData)==null?void 0:r.mediaSource;let u;if(a.media)l&&(i=a.transferMedia(),this.detachedData=i),u="Primary";else if(c){const g=this.getBufferingPlayer();g?(i=g.transferMedia(),u=`${g}`):u="detached MediaSource"}else u="detached media";if(!i){if(c)i=this.detachedData,this.log(`using detachedData: MediaSource ${Wn(i)}`);else if(!this.detachedData||a.media===t){const g=this.playerQueue;g.length>1&&g.forEach(y=>{if(o&&y.interstitial.appendInPlace!==l){const b=y.interstitial;this.clearInterstitial(y.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const f=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",m=f&&i?i:t;if(this.log(`${f?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${u}`),m===i){const g=o&&e.assetId===this.schedule.assetIdAtEnd;m.overrides={duration:this.schedule.duration,endOfStream:!o||g,cueRemoval:!o}}e.attachMedia(m)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,s=this.effectivePlayingItem;if(r===-1){const i=this.hls.startPosition;if(this.timelinePos=i,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(i>=0||!this.primaryLive){const a=this.timelinePos=i>0?i:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAfterAssetEnded(e,t,r){const s=gR(e,r);if(!e.isAssetPastPlayoutLimit(s))this.setSchedulePosition(t,s);else{const i=this.schedule.items;if(i){const a=t+1,o=i.length;if(a>=o){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(e,t){const r=this.schedule,s=t.parentIdentifier,i=r.getEvent(s);if(i){const a=r.findEventIndex(s),o=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,a,o-1)}}setSchedulePosition(e,t){const r=this.schedule.items;if(!r||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const s=e>=0?r[e]:null,i=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(i)){var o;const c=i.event,u=this.playingAsset,f=u?.identifier,m=f?this.getAssetPlayer(f):null;if(m&&f&&(!this.eventItemsMatch(i,s)||t!==void 0&&f!==((o=c.assetList)==null?void 0:o[t].identifier))){var l;const g=c.findAssetIndex(u);if(this.log(`INTERSTITIAL_ASSET_ENDED ${g+1}/${c.assetList.length} ${af(u)}`),this.endedAsset=u,this.playingAsset=null,this.hls.trigger(K.INTERSTITIAL_ASSET_ENDED,{asset:u,assetListIndex:g,event:c,schedule:r.slice(0),scheduleIndex:e,player:m}),i!==this.playingItem){this.itemsMatch(i,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(c,this.findItemIndex(this.playingItem),g);return}this.retreiveMediaSource(f,s),m.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&m.detachMedia()}if(!this.eventItemsMatch(i,s)&&(this.endedItem=i,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${c} ${_c(i)}`),c.hasPlayed=!0,this.hls.trigger(K.INTERSTITIAL_ENDED,{event:c,schedule:r.slice(0),scheduleIndex:e}),c.cue.once)){this.updateSchedule();const g=this.schedule.items;if(s&&g){const y=this.findItemIndex(s);this.advanceSchedule(y,g,t,i,a)}return}}this.advanceSchedule(e,r,t,i,a)}advanceSchedule(e,t,r,s,i){const a=e>=0?t[e]:null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(c=>{const u=c.interstitial,f=this.schedule.findEventIndex(u.identifier);(f<e||f>e+1)&&this.clearInterstitial(u,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const c=a.event;if(r===void 0){r=this.schedule.findAssetIndex(c,this.timelinePos);const g=gR(c,r-1);if(c.isAssetPastPlayoutLimit(g)){this.advanceAfterAssetEnded(c,e,r);return}r=g}const u=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let f=this.preloadAssets(c,r);if(this.eventItemsMatch(a,u||s)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${_c(a)} ${c.appendInPlace?"append in place":""}`),this.hls.trigger(K.INTERSTITIAL_STARTED,{event:c,schedule:t.slice(0),scheduleIndex:e})),!c.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${c}`);return}if(c.assetListLoader&&(c.assetListLoader.destroy(),c.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${c}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const m=c.assetList[r];if(!m){const g=t[e+1],y=this.media;g&&y&&!this.isInterstitial(g)&&y.currentTime<g.start&&(y.currentTime=this.timelinePos=g.start),this.advanceAfterAssetEnded(c,e,r||0);return}if(f||(f=this.getAssetPlayer(m.identifier)),f===null||f.destroyed){const g=c.assetList.length;this.warn(`asset ${r+1}/${g} player destroyed ${c}`),f=this.createAssetPlayer(c,m,r)}if(!this.eventItemsMatch(a,this.bufferingItem)&&c.appendInPlace&&this.isAssetBuffered(m))return;this.startAssetPlayer(f,r,t,e,o),this.shouldPlay&&B6(f.media)}else a!==null?(this.resumePrimary(a,e,s),this.shouldPlay&&B6(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${_c(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.timelinePos=a),this.attachPrimary(a,e)}if(!r)return;const i=this.schedule.items;i&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${_c(e)}`),this.hls.trigger(K.INTERSTITIALS_PRIMARY_RESUMED,{schedule:i.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(r<s.fragmentStart||r>s.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Bt.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),r&&this.startLoadingPrimaryAt(e,r)),r||(this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((r=s.mainForwardBufferInfo)==null?void 0:r.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(K.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(K.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const r=this.hls.levels[t.level],s=Ln(Ln({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ln(Ln({},this.altSelection),{},{audio:r});return}const i=Ln(Ln({},s),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ln(Ln({},this.altSelection),{},{subtitles:r});return}const i=Ln(Ln({},s),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(e,t){const r=ZB(t);this.playerQueue.forEach(s=>s.hls.setAudioOption(t)||s.hls.setAudioOption(r))}onSubtitleTrackSwitch(e,t){const r=ZB(t);this.playerQueue.forEach(s=>s.hls.setSubtitleOption(t)||t.id!==-1&&s.hls.setSubtitleOption(r))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const i=t[s];if(i.cue.post){var r;const a=this.schedule.findEventIndex(i.identifier),o=(r=this.schedule.items)==null?void 0:r[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){const r=this.schedule.items;if(e&&r){const s=this.findItemIndex(e,t);return r[s]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((i,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(i.identifier,null)});const r=e.end+.25,s=Bt.bufferInfo(this.primaryMedia,r,0);(s.end>r||(s.nextStart||0)>r)&&(this.attachPrimary(r,null),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const r=Bt.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,t,e)}updateBufferedPos(e,t,r){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],i)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let l=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var c,u;const f=this.findItemIndex(i),m=Math.min(f+1,t.length-1),g=t[m];if((l===-1&&i&&e>=i.end||(c=g.event)!=null&&c.appendInPlace&&e+.01>=g.start)&&(l=m),m-o>1&&(i==null||(u=i.event)==null?void 0:u.appendInPlace)===!1)return;if(this.bufferedPos=e,l>f&&l>o)this.bufferedToItem(g);else{const y=this.primaryDetails;this.primaryLive&&y&&e>y.edge-y.targetduration&&g.start<y.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else r&&a&&!this.itemsMatch(a,i)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:s,events:i}=r;if(!s||!i)return t;const a=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const l=o?o.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${_c(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),this.playbackDisabled||(a?e.event.assetList.forEach(c=>{const u=this.getAssetPlayer(c.identifier);u&&u.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(c=>c.pauseBuffering()))),this.hls.trigger(K.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,s=r.assetList.length===0&&!r.assetListLoader,i=r.cue.once;if(s||!i){const a=this.preloadAssets(r,t);if(a!=null&&a.interstitial.appendInPlace){const o=r.assetList[t],l=this.primaryMedia;o&&l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const r=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,a=e.cue.once;if(i){const l=e.timelineStart;if(e.appendInPlace){var o;const m=this.playingItem;!this.isInterstitial(m)&&(m==null||(o=m.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let c,u=0;if(!this.playingItem&&this.primaryLive&&(u=this.hls.startPosition,u===-1&&(u=this.hls.liveSyncPosition||0)),u&&!(e.cue.pre||e.cue.post)){const m=u-l;m>0&&(c=Math.round(m*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:s} ${e}${c?` live-start: ${u} start-offset: ${c}`:""}`),r)return this.createAsset(e,0,0,l,e.duration,r);const f=this.assetListLoader.loadAssetList(e,c);f&&(e.assetListLoader=f)}else if(!a&&s){for(let l=t;l<s;l++){const c=e.assetList[l],u=this.getAssetPlayerQueueIndex(c.identifier);(u===-1||this.playerQueue[u].destroyed)&&!c.error&&this.createAssetPlayer(e,c,l)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(K.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,s,i,a){const o={parentIdentifier:e.identifier,identifier:nPe(e,a,t),duration:i,startOffset:r,timelineStart:s,uri:a};return this.createAssetPlayer(e,o,t)}createAssetPlayer(e,t,r){const s=this.hls,i=s.userConfig;let a=i.videoPreference;const o=s.loadLevelObj||s.levels[s.currentLevel];(a||o)&&(a=_n({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const l=s.audioTracks[s.audioTrack],c=s.subtitleTracks[s.subtitleTrack];let u=0;if(this.primaryLive||e.appendInPlace){const _=this.timelinePos-t.timelineStart;if(_>1){const R=t.duration;R&&_<R&&(u=_)}}const f=t.identifier,m=Ln(Ln({},i),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:f,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:u,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||i.audioPreference,subtitlePreference:c||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(m.timelineOffset=t.timelineStart));const g=m.cmcd;g!=null&&g.sessionId&&g.contentId&&(m.cmcd=_n({},g,{contentId:Ug(t.uri)})),this.getAssetPlayer(f)&&this.warn(`Duplicate date range identifier ${e} and asset ${f}`);const y=new iPe(this.HlsPlayerClass,m,e,t);this.playerQueue.push(y),e.assetList[r]=t;const b=_=>{if(_.live){const C=new Error(`Interstitials MUST be VOD assets ${e}`),L={fatal:!0,type:xt.OTHER_ERROR,details:_e.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(L,e,this.schedule.findEventIndex(e.identifier),r,C.message);return}const R=_.edge-_.fragmentStart,I=t.duration;(I===null||R>I)&&(this.log(`Interstitial asset "${f}" duration change ${I} > ${R}`),t.duration=R,this.updateSchedule())};y.on(K.LEVEL_UPDATED,(_,{details:R})=>b(R)),y.on(K.LEVEL_PTS_UPDATED,(_,{details:R})=>b(R));const x=(_,R)=>{const I=this.getAssetPlayer(f);if(I&&R.tracks){I.off(K.BUFFER_CODECS,x),I.tracks=R.tracks;const C=this.primaryMedia;this.bufferingAsset===I.assetItem&&C&&!I.media&&this.bufferAssetPlayer(I,C)}};y.on(K.BUFFER_CODECS,x);const S=()=>{var _;const R=this.getAssetPlayer(f);if(this.log(`buffered to end of asset ${R}`),!R)return;const I=this.schedule.findEventIndex(e.identifier),C=(_=this.schedule.items)==null?void 0:_[I];if(this.isInterstitial(C)){const k=e.findAssetIndex(t),M=gR(e,k);if(!e.isAssetPastPlayoutLimit(M))this.bufferedToItem(C,M);else{var L;const D=(L=this.schedule.items)==null?void 0:L[I+1];D&&this.bufferedToItem(D)}}};y.on(K.BUFFERED_TO_END,S);const T=_=>()=>{if(!this.getAssetPlayer(f))return;this.shouldPlay=!0;const I=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,I,_)};return y.once(K.MEDIA_ENDED,T(r)),y.once(K.PLAYOUT_LIMIT_REACHED,T(1/0)),y.on(K.ERROR,(_,R)=>{const I=this.getAssetPlayer(f);if(R.details===_e.BUFFER_STALLED_ERROR){if(I!=null&&I.media){const C=I.currentTime,L=I.duration-C;C&&e.appendInPlace&&L/I.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${f} ${e} at ${I.media.currentTime}`),S()):(this.warn(`Stalled at ${C} of ${C+L} in asset ${f} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(R,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${R.error} ${e}`)}),y.on(K.DESTROYING,()=>{if(!this.getAssetPlayer(f))return;const R=new Error(`Asset player destroyed unexpectedly ${f}`),I={fatal:!0,type:xt.OTHER_ERROR,details:_e.INTERSTITIAL_ASSET_ITEM_ERROR,error:R};this.handleAssetItemError(I,e,this.schedule.findEventIndex(e.identifier),r,R.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${af(t)}`),this.hls.trigger(K.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:y}),y}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&_c(t)}`);const s=this.playerQueue[r];this.transferMediaFromPlayer(s,t),this.playerQueue.splice(r,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,s,i){const{interstitial:a,assetItem:o,assetId:l}=e,c=a.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!u||u.identifier!==l)&&(u&&(this.clearAssetPlayer(u.identifier,r[s]),delete u.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${c} ${af(o)}`),this.hls.trigger(K.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,t){var r,s;const{interstitial:i,assetItem:a}=e,o=this.schedule.findEventIndex(i.identifier),l=(r=this.schedule.items)==null?void 0:r[o];if(!l)return;this.setBufferingItem(l),this.bufferingAsset=a;const c=this.getBufferingPlayer();if(c===e)return;const u=i.appendInPlace;if(u&&c?.interstitial.appendInPlace===!1)return;const f=c?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(u&&a!==this.playingAsset){if(!e.tracks)return;if(f&&!ZX(f,e.tracks)){const m=new Error(`Asset ${af(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(f)}')`),g={fatal:!0,type:xt.OTHER_ERROR,details:_e.INTERSTITIAL_ASSET_ITEM_ERROR,error:m},y=i.findAssetIndex(a);this.handleAssetItemError(g,i,o,y,m.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,r,s,i){if(e.details===_e.BUFFER_STALLED_ERROR)return;const a=t.assetList[s];this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&af(a)} ${e.error}`);const o=a?.identifier,l=this.getAssetPlayerQueueIndex(o),c=this.playerQueue[l]||null,u=this.schedule.items,f=_n({},e,{fatal:!1,errorAction:Ov(!0),asset:a,assetListIndex:s,event:t,schedule:u,scheduleIndex:r,player:c});if(this.hls.trigger(K.INTERSTITIAL_ASSET_ERROR,f),!e.fatal)return;const m=this.playingAsset,g=new Error(i);if(a&&(this.clearAssetPlayer(o,null),a.error=g),!t.assetList.some(y=>!y.error))t.error=g;else{for(let y=s;y<t.assetList.length;y++)this.resetAssetPlayer(t.assetList[y].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):m&&m.identifier===o&&this.advanceAfterAssetEnded(t,r,s)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;if(this.updateSchedule(),r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${r?_c(r):"<none>"} error: ${e.error}`);let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const i=this.updateItem(r,s);this.itemsMatch(r,i)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const a=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(a)}else this.checkStart()}onAssetListLoaded(e,t){var r;const s=t.event,i=s.identifier,a=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(i))return;const o=s.timelineStart,l=s.duration;let c=0;a.forEach((y,b)=>{const x=parseFloat(y.DURATION);this.createAsset(s,b,c,o+c,x,y.URI),c+=x}),s.duration=c,this.log(`Loaded asset-list with duration: ${c} (was: ${l}) ${s}`);const u=this.waitingItem,f=u?.event.identifier===i;this.updateSchedule();const m=(r=this.bufferingItem)==null?void 0:r.event;if(f){var g;const y=this.schedule.findEventIndex(i),b=(g=this.schedule.items)==null?void 0:g[y];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==y){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.primaryFallback(s);return}this.setBufferingItem(b)}this.setSchedulePosition(y)}else if(m?.identifier===i&&m.appendInPlace){const y=s.assetList[0],b=this.getAssetPlayer(y.identifier),x=this.primaryMedia;y&&b&&x&&this.bufferAssetPlayer(b,x)}}onError(e,t){switch(t.details){case _e.ASSET_LIST_PARSING_ERROR:case _e.ASSET_LIST_LOAD_ERROR:case _e.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&this.primaryFallback(r);break}case _e.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const H6=500;class cPe extends KP{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",gt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(K.LEVEL_LOADED,this.onLevelLoaded,this),e.on(K.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(K.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(K.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(K.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(K.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(K.LEVEL_LOADED,this.onLevelLoaded,this),e.off(K.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(K.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(K.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(K.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(K.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=$e.IDLE,this.setInterval(H6),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragContextChanged(r)||(Nr(r)&&(this.fragPrevious=r),this.state=$e.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let a;const o=r.start;for(let c=0;c<i.length;c++)if(o>=i[c].start&&o<=i[c].end){a=i[c];break}const l=r.start+r.duration;a?a.end=l:(a={start:o,end:l},i.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=i){a.shift();continue}else if(a[o].start<i)a[o].start=i;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(r,i,gt.SUBTITLE)}}onError(e,t){const r=t.frag;r?.type===gt.SUBTITLE&&(t.details===_e.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==$e.STOPPED&&(this.state=$e.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&YQ(this.levels,t)){this.levels=t.map(r=>new Mv(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new Mv(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,gt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==$e.STOPPED&&this.setInterval(H6)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:s,levels:i}=this,{details:a,id:o}=t;if(!i){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=i[o];if(o>=i.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(a.live||(r=l.details)!=null&&r.live){if(a.deltaUpdateFailed)return;const f=this.mainDetails;if(!f){this.startFragRequested=!1;return}const m=f.fragments[0];if(!l.details)a.hasProgramDateTime&&f.hasProgramDateTime?(jE(a,f),c=a.fragmentStart):m&&(c=m.start,JI(a,c));else{var u;c=this.alignPlaylists(a,l.details,(u=this.levelLastLoaded)==null?void 0:u.details),c===0&&m&&(c=m.start,JI(a,c))}f&&!this.startFragRequested&&this.setStartPosition(f,c)}l.details=a,this.levelLastLoaded=l,o===s&&(this.hls.trigger(K.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===$e.IDLE&&(Ad(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s!=null&&s.key&&s.iv&&Df(s.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer,WP(s.method)).catch(o=>{throw i.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();i.trigger(K.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=$e.IDLE})}}doTick(){if(!this.media){this.state=$e.IDLE;return}if(this.state===$e.IDLE){const{currentTrackId:e,levels:t}=this,r=t?.[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:s}=this,i=this.getLoadPosition(),a=Bt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:o,len:l}=a,c=r.details,u=this.hls.maxBufferLength+c.levelTargetDuration;if(l>u)return;const f=c.fragments,m=f.length,g=c.edge;let y=null;const b=this.fragPrevious;if(o<g){const T=s.maxFragLookUpTolerance,_=o>g-T?0:T;y=Ad(b,f,Math.max(f[0].start,o),_),!y&&b&&b.start<f[0].start&&(y=f[0])}else y=f[m-1];if(y=this.filterReplacedPrimary(y,r.details),!y)return;const x=y.sn-c.startSN,S=f[x-1];if(S&&S.cc===y.cc&&this.fragmentTracker.getState(S)===zr.NOT_LOADED&&(y=S),this.fragmentTracker.getState(y)===zr.NOT_LOADED){const T=this.mapToInitFragWhenRequired(y);T&&this.loadFragment(T,r,o)}}}loadFragment(e,t,r){Nr(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new uPe(this.tracksBuffered[this.currentTrackId]||[])}}class uPe{constructor(e){this.buffered=void 0;const t=(r,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const dPe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},aZ=n=>String.fromCharCode(dPe[n]||n),Oa=15,wl=100,hPe={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},fPe={17:2,18:4,21:6,22:8,23:10,19:13,20:15},mPe={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},pPe={25:2,26:4,29:6,30:8,31:10,27:13,28:15},gPe=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class vPe{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;vn.log(`${this.time} [${e}] ${r}`)}}}const Vu=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class oZ{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class yPe{constructor(){this.uchar=" ",this.penState=new oZ}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class bPe{constructor(e){this.chars=[],this.pos=0,this.currPenState=new oZ,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<wl;t++)this.chars.push(new yPe);this.logger=e}equals(e){for(let t=0;t<wl;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<wl;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<wl;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>wl&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=wl)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=aZ(e);if(this.pos>=wl){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<wl;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<wl;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class vR{constructor(e){this.rows=[],this.currRow=Oa-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Oa;t++)this.rows.push(new bPe(e));this.logger=e}reset(){for(let e=0;e<Oa;e++)this.rows[e].clear();this.currRow=Oa-1}equals(e){let t=!0;for(let r=0;r<Oa;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<Oa;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Oa;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Wn(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<Oa;o++)this.rows[o].clear();const i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[i].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(a.rows[i+c])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,a=Math.max(i-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Wn(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let i=0;i<Oa;i++){const a=this.rows[i].getTextString();a&&(s=i+1,e?t.push("Row "+s+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class V6{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new vR(r),this.nonDisplayedMemory=new vR(r),this.lastOutputScreen=new vR(r),this.currRollUpRow=this.displayedMemory.rows[Oa-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Oa-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+Wn(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class z6{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=wPe(),this.logger=void 0;const s=this.logger=new vPe;this.channels=[null,new V6(e,t,s),new V6(e+1,r,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const s=t[r]&127,i=t[r+1]&127;let a=!1,o=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+Vu([t[r],t[r+1]])+"] -> ("+Vu([s,i])+")");const l=this.cmdHistory;if(s>=16&&s<=31){if(xPe(s,i,l)){Nb(null,null,l),this.logger.log(3,()=>"Repeated command ("+Vu([s,i])+") is dropped");continue}Nb(s,i,this.cmdHistory),a=this.parseCmd(s,i),a||(a=this.parseMidrow(s,i)),a||(a=this.parsePAC(s,i)),a||(a=this.parseBackgroundAttributes(s,i))}else Nb(null,null,l);if(!a&&(o=this.parseChars(s,i),o)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Vu([s,i])+" orig: "+Vu([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;const i=e===20||e===21||e===23?1:2,a=this.channels[i];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Vu([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(s||i))return!1;const a=e<=23?1:2;t>=64&&t<=95?r=a===1?hPe[e]:mPe[e]:r=a===1?fPe[e]:pPe[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(r,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let a;i===17?a=t+80:i===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+aZ(a)+"' in channel "+r),s=[a]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Vu(s).join(",")),s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let i;const a={};e===16||e===24?(i=Math.floor((t-32)/2),a.background=gPe[i],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Nb(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Nb(n,e,t){t.a=n,t.b=e}function xPe(n,e,t){return t.a===n&&t.b===e}function wPe(){return{a:null,b:null}}var iM=function(){if(NE!=null&&NE.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const c=l.toLowerCase();return~o.indexOf(c)?c:!1}function r(o){return t(n,o)}function s(o){return t(e,o)}function i(o,...l){let c=1;for(;c<arguments.length;c++){const u=arguments[c];for(const f in u)o[f]=u[f]}return o}function a(o,l,c){const u=this,f={enumerable:!0};u.hasBeenReset=!1;let m="",g=!1,y=o,b=l,x=c,S=null,T="",_=!0,R="auto",I="start",C=50,L="middle",k=50,M="middle";Object.defineProperty(u,"id",i({},f,{get:function(){return m},set:function(D){m=""+D}})),Object.defineProperty(u,"pauseOnExit",i({},f,{get:function(){return g},set:function(D){g=!!D}})),Object.defineProperty(u,"startTime",i({},f,{get:function(){return y},set:function(D){if(typeof D!="number")throw new TypeError("Start time must be set to a number.");y=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",i({},f,{get:function(){return b},set:function(D){if(typeof D!="number")throw new TypeError("End time must be set to a number.");b=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",i({},f,{get:function(){return x},set:function(D){x=""+D,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",i({},f,{get:function(){return S},set:function(D){S=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",i({},f,{get:function(){return T},set:function(D){const U=r(D);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=U,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",i({},f,{get:function(){return _},set:function(D){_=!!D,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",i({},f,{get:function(){return R},set:function(D){if(typeof D!="number"&&D!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");R=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",i({},f,{get:function(){return I},set:function(D){const U=s(D);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");I=U,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",i({},f,{get:function(){return C},set:function(D){if(D<0||D>100)throw new Error("Position must be between 0 and 100.");C=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",i({},f,{get:function(){return L},set:function(D){const U=s(D);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");L=U,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",i({},f,{get:function(){return k},set:function(D){if(D<0||D>100)throw new Error("Size must be between 0 and 100.");k=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",i({},f,{get:function(){return M},set:function(D){const U=s(D);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");M=U,this.hasBeenReset=!0}})),u.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class EPe{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function lZ(n){function e(r,s,i,a){return(r|0)*3600+(s|0)*60+(i|0)+parseFloat(a||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class SPe{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function cZ(n,e,t,r){const s=r?n.split(r):[n];for(const i in s){if(typeof s[i]!="string")continue;const a=s[i].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const aL=new iM(0,0,""),jb=aL.align==="middle"?"middle":"center";function TPe(n,e,t){const r=n;function s(){const o=lZ(n);if(o===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),o}function i(o,l){const c=new SPe;cZ(o,function(m,g){let y;switch(m){case"region":for(let b=t.length-1;b>=0;b--)if(t[b].id===g){c.set(m,t[b].region);break}break;case"vertical":c.alt(m,g,["rl","lr"]);break;case"line":y=g.split(","),c.integer(m,y[0]),c.percent(m,y[0])&&c.set("snapToLines",!1),c.alt(m,y[0],["auto"]),y.length===2&&c.alt("lineAlign",y[1],["start",jb,"end"]);break;case"position":y=g.split(","),c.percent(m,y[0]),y.length===2&&c.alt("positionAlign",y[1],["start",jb,"end","line-left","line-right","auto"]);break;case"size":c.percent(m,g);break;case"align":c.alt(m,g,["start",jb,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&aL.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",jb);let f=c.get("position","auto");f==="auto"&&aL.position===50&&(f=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=f}function a(){n=n.replace(/^\s+/,"")}if(a(),e.startTime=s(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),a(),e.endTime=s(),a(),i(n,e)}function uZ(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class _Pe{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new EPe,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let i=t.buffer,a=0;for(i=uZ(i);a<i.length&&i[a]!=="\r"&&i[a]!==`
`;)++a;const o=i.slice(0,a);return i[a]==="\r"&&++a,i[a]===`
`&&++a,t.buffer=i.slice(a),o}function s(i){cZ(i,function(a,o){},/:/)}try{let i="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;i=r();const o=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:i=r(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new iM(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{TPe(i,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=i.indexOf("-->")!==-1;if(!i||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=i}continue;case"BADCUE":i||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const APe=/\r\n|\n\r|\n|\r/g,yR=function(e,t,r=0){return e.slice(r,r+t.length)===t},RPe=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!at(t)||!at(r)||!at(s)||!at(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=3600*1e3*i,t};function aM(n,e,t){return Ug(n.toString())+Ug(e.toString())+Ug(t)}const CPe=function(e,t,r){let s=e[t],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(a=i)!=null&&a.new;){var a;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=r};function kPe(n,e,t,r,s,i,a){const o=new _Pe,l=ji(new Uint8Array(n)).trim().replace(APe,`
`).split(`
`),c=[],u=e?zDe(e.baseTime,e.timescale):0;let f="00:00.000",m=0,g=0,y,b=!0;o.oncue=function(x){const S=t[r];let T=t.ccOffset;const _=(m-u)/9e4;if(S!=null&&S.new&&(g!==void 0?T=t.ccOffset=S.start:CPe(t,r,_)),_){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}T=_-t.presentationOffset}const R=x.endTime-x.startTime,I=sa((x.startTime+T-g)*9e4,s*9e4)/9e4;x.startTime=Math.max(I,0),x.endTime=Math.max(I+R,0);const C=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(C)),x.id||(x.id=aM(x.startTime,x.endTime,C)),x.endTime>0&&c.push(x)},o.onparsingerror=function(x){y=x},o.onflush=function(){if(y){a(y);return}i(c)},l.forEach(x=>{if(b)if(yR(x,"X-TIMESTAMP-MAP=")){b=!1,x.slice(16).split(",").forEach(S=>{yR(S,"LOCAL:")?f=S.slice(6):yR(S,"MPEGTS:")&&(m=parseInt(S.slice(7)))});try{g=RPe(f)/1e3}catch(S){y=S}return}else x===""&&(b=!1);o.parse(x+`
`)}),o.flush()}const bR="stpp.ttml.im1t",dZ=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,hZ=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,IPe={left:"start",center:"center",right:"end",start:"start",end:"end"};function G6(n,e,t,r){const s=en(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(o=>ji(o)),a=VDe(e.baseTime,1,e.timescale);try{i.forEach(o=>t(LPe(o,a)))}catch(o){r(o)}}function LPe(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(i).reduce((f,m)=>(f[m]=s.getAttribute(`ttp:${m}`)||i[m],f),{}),o=s.getAttribute("xml:space")!=="preserve",l=q6(xR(s,"styling","style")),c=q6(xR(s,"layout","region")),u=xR(s,"body","[begin]");return[].map.call(u,f=>{const m=fZ(f,o);if(!m||!f.hasAttribute("begin"))return null;const g=ER(f.getAttribute("begin"),a),y=ER(f.getAttribute("dur"),a);let b=ER(f.getAttribute("end"),a);if(g===null)throw W6(f);if(b===null){if(y===null)throw W6(f);b=g+y}const x=new iM(g-e,b-e,m);x.id=aM(x.startTime,x.endTime,x.text);const S=c[f.getAttribute("region")],T=l[f.getAttribute("style")],_=DPe(S,T,l),{textAlign:R}=_;if(R){const I=IPe[R];I&&(x.lineAlign=I),x.align=R}return _n(x,_),x}).filter(f=>f!==null)}function xR(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function q6(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function fZ(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var i;return r.nodeName==="br"&&s?t+`
`:(i=r.childNodes)!=null&&i.length?fZ(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function DPe(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(s=t[a]),i.reduce((o,l)=>{const c=wR(e,r,l)||wR(n,r,l)||wR(s,r,l);return c&&(o[l]=c),o},{})}function wR(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function W6(n){return new Error(`Could not parse ttml timestamp ${n}`)}function ER(n,e){if(!n)return null;let t=lZ(n);return t===null&&(dZ.test(n)?t=PPe(n,e):hZ.test(n)&&(t=MPe(n,e))),t}function PPe(n,e){const t=dZ.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function MPe(n,e){const t=hZ.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Fb{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class OPe{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Y6(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(K.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(K.FRAG_LOADING,this.onFragLoading,this),e.on(K.FRAG_LOADED,this.onFragLoaded,this),e.on(K.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(K.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(K.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(K.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(K.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(K.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(K.FRAG_LOADING,this.onFragLoading,this),e.off(K.FRAG_LOADED,this.onFragLoaded,this),e.off(K.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(K.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(K.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(K.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(K.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Fb(this,"textTrack1"),t=new Fb(this,"textTrack2"),r=new Fb(this,"textTrack3"),s=new Fb(this,"textTrack4");this.cea608Parser1=new z6(1,e,t),this.cea608Parser2=new z6(3,r,s)}addCues(e,t,r,s,i){let a=!1;for(let o=i.length;o--;){const l=i[o],c=NPe(l[0],l[1],t,r);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],r),a=!0,c/(r-t)>.5))return}if(a||i.push([t,r]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,r,s)}else{const o=this.Cues.newCue(null,t,r,s);this.hls.trigger(K.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i}){const{unparsedVttFrags:a}=this;r===gt.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:i}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.initPTS[o.frag.cc]?this.onFragLoaded(K.FRAG_LOADED,o):this.hls.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let s=0;s<r.textTracks.length;s++){const i=r.textTracks[s];if(K6(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:i,languageCode:a}=t[e],o=this.getExistingTrack(i,a);if(o)r[e]=o,bf(r[e]),rZ(r[e],s);else{const l=this.createTextTrack("captions",i,a);l&&(l[e]=!0,r[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(K.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{bf(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Y6(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)bf(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(i=>i.textCodec===bR);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(YQ(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,o=a?Ux(a.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(o){let f=null;for(let m=0;m<o.length;m++)if(o[m]&&K6(o[m],l)){f=o[m],o[m]=null;break}f&&(u=f)}if(u)bf(u);else{const f=mZ(l);u=this.createTextTrack(f,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),o!=null&&o.length){const l=o.filter(c=>c!==null).map(c=>c.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(K.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const i=`textTrack${s[1]}`,a=this.captionsProperties[i];a&&(a.label=r.name,r.lang&&(a.languageCode=r.lang),a.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===gt.MAIN){var r,s;const{cea608Parser1:i,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:c}=t.frag,u=(r=(s=t.part)==null?void 0:s.index)!=null?r:-1;i&&a&&(c!==o+1||c===o&&u!==this.lastPartIndex+1||l!==this.lastCc)&&(i.reset(),a.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(e,t){const{frag:r,payload:s}=t;if(r.type===gt.SUBTITLE)if(s.byteLength){const i=r.decryptdata,a="stats"in t;if(i==null||!i.encrypted||a){const o=this.tracks[r.level],l=this.vttCCs;l[r.cc]||(l[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===bR?this._parseIMSC1(r,s):this._parseVTTs(t)}}else this.hls.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;G6(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{r.logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:r,payload:s}=e,{initPTS:i,unparsedVttFrags:a}=this,o=i.length-1;if(!i[r.cc]&&o===-1){a.push(e);return}const l=this.hls,c=(t=r.initSegment)!=null&&t.data?wa(r.initSegment.data,new Uint8Array(s)).buffer:s;kPe(c,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,u=>{this._appendCues(u,r.level),l.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},u=>{const f=u.message==="Missing initPTS for VTT MPEGTS";f?a.push(e):this._fallbackToIMSC1(r,s),l.logger.log(`Failed to parse VTT cue: ${u}`),!(f&&o>r.cc)&&l.trigger(K.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:u})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||G6(t,this.initPTS[e.cc],()=>{r.textCodec=bR,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(i=>sZ(s,i))}else{const s=this.tracks[t];if(!s)return;const i=s.default?"default":"subtitles"+t;r.trigger(K.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===gt.SUBTITLE&&this.onFragLoaded(K.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:s}=t;if(!(r.type===gt.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let i=0;i<s.length;i++){const a=s[i].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(s[i].pts,o[0]),this.cea608Parser2.addData(s[i].pts,o[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:i}){const{media:a}=this;if(!(!a||a.currentTime<r)){if(!i||i==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>iL(o[l],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>iL(o[l],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let i=0;i<r;i++){const a=e[s++],o=127&e[s++],l=127&e[s++];if(o===0&&l===0)continue;if((4&a)!==0){const u=3&a;(u===0||u===1)&&(t[u].push(o),t[u].push(l))}}return t}}function mZ(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function K6(n,e){return!!n&&n.kind===mZ(e)&&nL(e,n)}function NPe(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function Y6(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const jPe=/\s/,FPe={newCue(n,e,t,r){const s=[];let i,a,o,l,c;const u=self.VTTCue||self.TextTrackCue;for(let m=0;m<r.rows.length;m++)if(i=r.rows[m],o=!0,l=0,c="",!i.isEmpty()){var f;for(let b=0;b<i.chars.length;b++)jPe.test(i.chars[b].uchar)&&o?l++:(c+=i.chars[b].uchar,o=!1);i.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const g=uZ(c.trim()),y=aM(e,t,g);n!=null&&(f=n.cues)!=null&&f.getCueById(y)||(a=new u(e,t,g),a.id=y,a.line=m+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),s.push(a))}return n&&s.length&&(s.sort((m,g)=>m.line==="auto"||g.line==="auto"?0:m.line>8&&g.line>8?g.line-m.line:m.line-g.line),s.forEach(m=>sZ(n,m))),s}};function UPe(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const $Pe=/(\d+)-(\d+)\/(\d+)/;class X6{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||zPe,this.controller=new self.AbortController,this.stats=new $P}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=BPe(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=l&&at(l)?l:c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(Fv(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(f=>{var m;this.response=this.loader=f;const g=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},c-(g-s.loading.start)),!f.ok){const{status:b,statusText:x}=f;throw new GPe(x||"fetch, bad network response",b,f)}s.loading.first=g,s.total=VPe(f.headers)||s.total;const y=(m=this.callbacks)==null?void 0:m.onProgress;return y&&at(t.highWaterMark)?this.loadProgressively(f,s,e,t.highWaterMark,y):a?f.arrayBuffer():e.responseType==="json"?f.json():f.text()}).then(f=>{var m,g;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const b=f[o];b&&(s.loaded=s.total=b);const x={url:y.url,data:f,code:y.status},S=(m=this.callbacks)==null?void 0:m.onProgress;S&&!at(t.highWaterMark)&&S(s,e,f,y),(g=this.callbacks)==null||g.onSuccess(x,s,e,y)}).catch(f=>{var m;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const g=f&&f.code||0,y=f?f.message:null;(m=this.callbacks)==null||m.onError({code:g,text:y},e,f?f.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,i){const a=new kQ,o=e.body.getReader(),l=()=>o.read().then(c=>{if(c.done)return a.dataLength&&i(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const u=c.value,f=u.length;return t.loaded+=f,f<s||a.dataLength?(a.push(u),a.dataLength>=s&&i(t,r,a.flush().buffer,e)):i(t,r,u.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function BPe(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(_n({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function HPe(n){const e=$Pe.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function VPe(n){const e=n.get("Content-Range");if(e){const r=HPe(e);if(at(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function zPe(n,e){return new self.Request(n.url,e)}class GPe extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const qPe=/^age:\s*[\d.]+\s*$/im;class pZ{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new $P,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return i(r,t.url)}).catch(a=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),i(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:r.status,text:a.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=r.loadPolicy;if(s)for(const o in s)e.setRequestHeader(o,s[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&at(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,i=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const c=t.status,u=t.responseType==="text"?t.responseText:null;if(c>=200&&c<300){const y=u??t.response;if(y!=null){var a,o;r.loading.end=Math.max(self.performance.now(),r.loading.first);const b=t.responseType==="arraybuffer"?y.byteLength:y.length;r.loaded=r.total=b,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const x=(a=this.callbacks)==null?void 0:a.onProgress;x&&x(r,e,y,t);const S={url:t.responseURL,data:y,code:c};(o=this.callbacks)==null||o.onSuccess(S,r,e,t);return}}const f=i.loadPolicy.errorRetry,m=r.retry,g={url:e.url,data:void 0,code:c};if(OE(f,m,!1,g))this.retry(f);else{var l;vn.error(`${c} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:c,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(OE(e,t,!0))this.retry(e);else{var r;vn.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=zP(e,r.retry),r.retry++,vn.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&qPe.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const WPe={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},KPe=Ln(Ln({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:pZ,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:gLe,bufferController:i2e,capLevelController:rM,errorController:wLe,fpsController:Q2e,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:bQ,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:WPe},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},YPe()),{},{subtitleStreamController:cPe,subtitleTrackController:ePe,timelineController:OPe,audioStreamController:t2e,audioTrackController:n2e,emeController:Pf,cmcdController:K2e,contentSteeringController:X2e,interstitialsController:lPe});function YPe(){return{cueHandler:FPe,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function XPe(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=oL(n),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,l=e[o]===void 0,c=[];i.forEach(u=>{const f=`${a}Loading${u}`,m=e[f];if(m!==void 0&&l){c.push(f);const g=r[o].default;switch(e[o]={default:g},u){case"TimeOut":g.maxLoadTimeMs=m,g.maxTimeToFirstByteMs=m;break;case"MaxRetry":g.errorRetry.maxNumRetry=m,g.timeoutRetry.maxNumRetry=m;break;case"RetryDelay":g.errorRetry.retryDelayMs=m,g.timeoutRetry.retryDelayMs=m;break;case"MaxRetryTimeout":g.errorRetry.maxRetryDelayMs=m,g.timeoutRetry.maxRetryDelayMs=m;break}}}),c.length&&t.warn(`hls.js config: "${c.join('", "')}" setting(s) are deprecated, use "${o}": ${Wn(e[o])}`)}),Ln(Ln({},r),e)}function oL(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(oL):Object.keys(n).reduce((e,t)=>(e[t]=oL(n[t]),e),{}):n}function QPe(n,e){const t=n.loader;t!==X6&&t!==pZ?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):UPe()&&(n.loader=X6,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const $x=2,ZPe=.1,JPe=.05,eMe=100;class tMe extends pQ{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(K.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(eMe),this.mediaSource=t.mediaSource;const r=this.media=t.media;fa(r,"playing",this.onMediaPlaying),fa(r,"waiting",this.onMediaWaiting),fa(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(Ha(r,"playing",this.onMediaPlaying),Ha(r,"waiting",this.onMediaWaiting),Ha(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,s;const i=(r=this.hls)==null?void 0:r.config;if(!i)return;const a=this.media;if(!a)return;const{seeking:o}=a,l=this.seeking&&!o,c=!this.seeking&&o,u=a.paused&&!o||a.ended||a.playbackRate===0;if(this.seeking=o,e!==t){t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!u&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(c||l){l&&this.stallResolved(e);return}if(u){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(K.MEDIA_ENDED,{stalled:!1}));return}if(!Bt.getBuffered(a).length){this.nudgeRetry=0;return}const f=Bt.bufferInfo(a,e,0),m=f.nextStart||0,g=this.fragmentTracker;if(o&&g&&this.hls){const C=Q6(this.hls.inFlightFragments,e),L=f.len>$x,k=!m||C||m-e>$x&&!g.getPartialFragment(e);if(L||k)return;this.moved=!1}const y=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&g){if(!(f.len>0)&&!m)return;const L=Math.max(m,f.start||0)-e,M=!!(y!=null&&y.live)?y.targetduration*2:$x,D=g.getPartialFragment(e);if(L>0&&(L<=M||D)){a.paused||this._trySkipBufferHole(D);return}}const b=i.detectStallWithCurrentTimeMs,x=self.performance.now(),S=this.waiting;let T=this.stalled;if(T===null)if(S>0&&x-S<b)T=this.stalled=S;else{this.stalled=x;return}const _=x-T;if(!o&&(_>=b||S)&&this.hls){var R;if(((R=this.mediaSource)==null?void 0:R.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-(y?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(K.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(f),!this.media||!this.hls)return}const I=Bt.bufferInfo(a,e,i.maxBufferHole);this._tryFixBufferStall(I,_,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(K.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&s&&s.length>1&&e>s.end(0)){const i=Bt.bufferedInfo(Bt.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const a=Bt.timeRangesToArray(s),o=Bt.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){const l=Bt.bufferedInfo(a,e,0).bufferedIndex,c=a[o].end,u=a[o+1].start;if((l===-1||l>o)&&u-c<1&&e-c<2){const f=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${c} -> ${u} buffered index: ${l}`);this.warn(f.message),this.media.currentTime+=1e-6;const m=this.fragmentTracker.getPartialFragment(e)||void 0,g=Bt.bufferInfo(this.media,e,0);this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:m,buffer:g.len,bufferInfo:g})}}}}}_tryFixBufferStall(e,t,r){var s,i;const{fragmentTracker:a,media:o}=this,l=(s=this.hls)==null?void 0:s.config;if(!o||!a||!l)return;const c=(i=this.hls)==null?void 0:i.latestLevelDetails,u=a.getPartialFragment(r);if((u||c!=null&&c.live&&r<c.fragmentStart)&&(this._trySkipBufferHole(u)||!this.media))return;const f=e.buffered,m=this.adjacentTraversal(e,r);(f&&f.length>1&&e.len>l.maxBufferHole||e.nextStart&&(e.nextStart-r<l.maxBufferHole||m))&&(t>l.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,s=e.nextStart;if(r&&s){const i=r.getFragAtPos(t,gt.MAIN),a=r.getFragAtPos(s,gt.MAIN);if(i&&a)return a.sn-i.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:s,stalled:i}=this;if(!s&&i!==null&&r&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${Wn(e)})`);this.warn(a.message),t.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:s}=this,i=(t=this.hls)==null?void 0:t.config;if(!s||!r||!i)return 0;const a=s.currentTime,o=Bt.bufferInfo(s,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){const u=o.len<=i.maxBufferHole,f=o.len>0&&o.len<1&&s.readyState<3,m=l-a;if(m>0&&(u||f)){if(m>i.maxBufferHole){let y=!1;if(a===0){const b=r.getAppendedFrag(0,gt.MAIN);b&&l<b.end&&(y=!0)}if(!y){const b=e||r.getAppendedFrag(a,gt.MAIN);if(b){var c;if(!((c=this.hls.loadLevelObj)!=null&&c.details)||Q6(this.hls.inFlightFragments,l))return 0;let S=!1,T=b.end;for(;T<l;){const _=r.getAppendedFrag(T,gt.MAIN)||r.getPartialFragment(T);if(_)T+=_.duration;else{S=!0;break}}if(S)return 0}}}const g=Math.max(l+JPe,a+ZPe);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${g}`),this.moved=!0,s.currentTime=g,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${g}`);this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,frag:e||void 0,buffer:o.len,bufferInfo:o})}return g}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:s}=this,i=t?.config;if(!r||!i)return 0;const a=r.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const o=a+(s+1)*i.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),r.currentTime=o,t.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${i.nudgeMaxRetry} nudges`);this.error(o.message),t.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Q6(n,e){const t=Z6(n.main);if(t&&t.start<=e)return t;const r=Z6(n.audio);return r&&r.start<=e?r:null}function Z6(n){if(!n)return null;switch(n.state){case $e.IDLE:case $e.STOPPED:case $e.ENDED:case $e.ERROR:return null}return n.frag}const nMe=.25;function lL(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function J6(n,e,t,r,s){let i=new n(e,t,"");try{i.value=r,s&&(i.type=s)}catch{i=new n(e,t,Wn(s?Ln({type:s},r):r))}return i}const Ub=(()=>{const n=lL();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class rMe{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(K.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(K.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(K.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(K.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(K.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&bf(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return rZ(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:s}}}=this;if(!r&&!s)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=lL();if(a)for(let o=0;o<i.length;o++){const l=i[o].type;if(l===Di.emsg&&!r||!s)continue;const c=NQ(i[o].data);if(c){const u=i[o].pts;let f=u+i[o].duration;f>Ub&&(f=Ub),f-u<=0&&(f=u+nMe);for(let g=0;g<c.length;g++){const y=c[g];if(!jQ(y)){this.updateId3CueEnds(u,l);const b=J6(a,u,f,y,l);b&&this.id3Track.addCue(b)}}}}}updateId3CueEnds(e,t){var r;const s=(r=this.id3Track)==null?void 0:r.cues;if(s)for(let i=s.length;i--;){const a=s[i];a.type===t&&a.startTime<e&&a.endTime===Ub&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:i,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(i&&(o||l)){let c;s==="audio"?c=u=>u.type===Di.audioId3&&l:s==="video"?c=u=>u.type===Di.emsg&&o:c=u=>u.type===Di.audioId3&&l||u.type===Di.emsg&&o,iL(i,t,r,c)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:r}=this,{dateRanges:s}=e,i=Object.keys(s);let a=this.dateRangeCuesAppended;if(r&&t){var o;if((o=r.cues)!=null&&o.length){const u=Object.keys(a).filter(f=>!i.includes(f));for(let f=u.length;f--;){const m=u[f],g=a[m].cues;delete a[m],Object.keys(g).forEach(y=>{try{const b=g[y];b.removeEventListener("enter",this.onEventCueEnter),r.removeCue(b)}catch{}})}}else a=this.dateRangeCuesAppended={}}const l=e.fragments[e.fragments.length-1];if(i.length===0||!at(l?.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=lL();for(let u=0;u<i.length;u++){const f=i[u],m=s[f],g=m.startTime,y=a[f],b=y?.cues||{};let x=y?.durationKnown||!1,S=Ub;const{duration:T,endDate:_}=m;if(_&&T!==null)S=g+T,x=!0;else if(m.endOnNext&&!x){const I=i.reduce((C,L)=>{if(L!==m.id){const k=s[L];if(k.class===m.class&&k.startDate>m.startDate&&(!C||m.startDate<C.startDate))return k}return C},null);I&&(S=I.startTime,x=!0)}const R=Object.keys(m.attr);for(let I=0;I<R.length;I++){const C=R[I];if(!MLe(C))continue;const L=b[C];if(L)x&&!y.durationKnown?L.endTime=S:Math.abs(L.startTime-g)>.01&&(L.startTime=g,L.endTime=S);else if(c){let k=m.attr[C];OLe(C)&&(k=JX(k));const D=J6(c,g,S,{key:C,data:k},Di.dateRange);D&&(D.id=f,this.id3Track.addCue(D),b[C]=D,this.hls.config.interstitialsController&&(C==="X-ASSET-LIST"||C==="X-ASSET-URL")&&D.addEventListener("enter",this.onEventCueEnter))}}a[f]={cues:b,dateRange:m,durationKnown:x}}}}class sMe{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:a}=this.config;if(!i||a===1||!r.live)return;const o=this.targetLatency;if(o===null)return;const l=s-o,c=Math.min(this.maxLatency,o+r.targetduration);if(l<c&&l>.05&&this.forwardBufferLength>1){const f=Math.min(2,Math.max(1,a)),m=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,g=Math.min(f,Math.max(1,m));this.changeMediaPlaybackRate(t,g)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let c=o&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=i!==void 0?i:a*s);const u=s;return c+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,u)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const s=r.edge,i=e-t-this.edgeStalled,a=s-r.totalduration,o=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(K.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(K.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(K.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(K.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===_e.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,s;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class iMe extends nM{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(K.LEVEL_LOADED,this.onLevelLoaded,this),e.on(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(K.FRAG_BUFFERED,this.onFragBuffered,this),e.on(K.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(K.LEVEL_LOADED,this.onLevelLoaded,this),e.off(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(K.FRAG_BUFFERED,this.onFragBuffered,this),e.off(K.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,s=[],i={},a={};let o=!1,l=!1,c=!1;t.levels.forEach(u=>{const f=u.attrs;let{audioCodec:m,videoCodec:g}=u;m&&(u.audioCodec=m=LE(m,r)||void 0),g&&(g=u.videoCodec=JIe(g));const{width:y,height:b,unknownCodecs:x}=u;let S=x?x.length:0;if(x)for(let D=S;D--;){const U=x[D];this.isAudioSupported(U)?(u.audioCodec=m=m?`${m},${U}`:U,S--,Jf.audio[m.substring(0,4)]=2):this.isVideoSupported(U)&&(u.videoCodec=g=g?`${g},${U}`:U,S--,Jf.video[g.substring(0,4)]=2)}if(o||(o=!!(y&&b)),l||(l=!!g),c||(c=!!m),S||m&&!this.isAudioSupported(m)||g&&!this.isVideoSupported(g)){this.log(`Some or all CODECS not supported "${f.CODECS}"`);return}const{CODECS:T,"FRAME-RATE":_,"HDCP-LEVEL":R,"PATHWAY-ID":I,RESOLUTION:C,"VIDEO-RANGE":L}=f,M=`${`${I||"."}-`}${u.bitrate}-${C}-${_}-${T}-${L}-${R}`;if(i[M])if(i[M].uri!==u.url&&!u.attrs["PATHWAY-ID"]){const D=a[M]+=1;u.attrs["PATHWAY-ID"]=new Array(D+1).join(".");const U=this.createLevel(u);i[M]=U,s.push(U)}else i[M].addGroupId("audio",f.AUDIO),i[M].addGroupId("text",f.SUBTITLES);else{const D=this.createLevel(u);i[M]=D,a[M]=1,s.push(D)}}),this.filterAndSortMediaOptions(s,t,o,l,c)}createLevel(e){const t=new Mv(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(s.message),t.supportedResult=cQ(s,[])}return t}isAudioSupported(e){return qI(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return qI(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,s,i){let a=[],o=[],l=e;if((r||s)&&i&&(l=l.filter(({videoCodec:x,videoRange:S,width:T,height:_})=>(!!x||!!(T&&_))&&oLe(S))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let x="no level with compatible codecs found in manifest",S=x;t.levels.length&&(S=`one or more CODECS in variant not supported: ${Wn(t.levels.map(_=>_.attrs.CODECS).filter((_,R,I)=>I.indexOf(_)===R))}`,this.warn(S),x+=` (${S})`);const T=new Error(x);this.hls.trigger(K.ERROR,{type:xt.MEDIA_ERROR,details:_e.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:T,reason:S})}});return}t.audioTracks&&(a=t.audioTracks.filter(x=>!x.audioCodec||this.isAudioSupported(x.audioCodec)),e8(a)),t.subtitles&&(o=t.subtitles,e8(o));const c=l.slice(0);l.sort((x,S)=>{if(x.attrs["HDCP-LEVEL"]!==S.attrs["HDCP-LEVEL"])return(x.attrs["HDCP-LEVEL"]||"")>(S.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&x.height!==S.height)return x.height-S.height;if(x.frameRate!==S.frameRate)return x.frameRate-S.frameRate;if(x.videoRange!==S.videoRange)return DE.indexOf(x.videoRange)-DE.indexOf(S.videoRange);if(x.videoCodec!==S.videoCodec){const T=qB(x.videoCodec),_=qB(S.videoCodec);if(T!==_)return _-T}if(x.uri===S.uri&&x.codecSet!==S.codecSet){const T=IE(x.codecSet),_=IE(S.codecSet);if(T!==_)return _-T}return x.averageBitrate!==S.averageBitrate?x.averageBitrate-S.averageBitrate:0});let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let x=0;x<c.length;x++)if(c[x].pathwayId===l[0].pathwayId){u=c[x];break}}this._levels=l;for(let x=0;x<l.length;x++)if(l[x]===u){var f;this._firstLevel=x;const S=u.bitrate,T=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${S}`),((f=this.hls.userConfig)==null?void 0:f.abrEwmaDefaultEstimate)===void 0){const _=Math.min(S,this.hls.config.abrEwmaDefaultEstimateMax);_>T&&T===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=_)}break}const m=i&&!s,g=this.hls.config,y=!!(g.audioStreamController&&g.audioTrackController),b={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:s,altAudio:y&&!m&&a.some(x=>!!x.url)};this.hls.trigger(K.MANIFEST_PARSED,b)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const u=new Error("invalid level idx"),f=e<0;if(this.hls.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.LEVEL_SWITCH_ERROR,level:e,fatal:f,error:u,reason:u.message}),f)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,r===e&&s&&i===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${r}${i?" with Pathway "+i:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(K.LEVEL_SWITCHING,l);const c=a.details;if(!c||c.live){const u=this.switchParams(a.uri,s?.details,c);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===nn.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===gt.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(i=>!!r[i]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:i}=t,a=t.levelInfo;if(!a){var o;this.warn(`Invalid level index ${s}`),(o=t.deliveryDirectives)!=null&&o.skip&&(i.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(s,t,l)}else(r=t.deliveryDirectives)!=null&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],a=e.details,o=a?.age;this.log(`Loading level index ${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${i?" Pathway "+i:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(K.LEVEL_LOADING,{url:r,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((i,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(o=>o.level=-1)),!1));AQ(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=r.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(K.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(K.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function e8(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function gZ(){return self.SourceBuffer||self.WebKitSourceBuffer}function vZ(){if(!ou())return!1;const e=gZ();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function aMe(){if(!vZ())return!1;const n=ou();return typeof n?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(Pv(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(Pv(e,"audio"))))}function oMe(){var n;const e=gZ();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const lMe=100;class cMe extends KP{constructor(e,t,r){super(e,t,r,"stream-controller",gt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!at(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const a=this.getFwdBufferInfoAtPos(s,i,gt.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(K.MANIFEST_PARSED,this.onManifestParsed,this),e.on(K.LEVEL_LOADING,this.onLevelLoading,this),e.on(K.LEVEL_LOADED,this.onLevelLoaded,this),e.on(K.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(K.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(K.BUFFER_CREATED,this.onBufferCreated,this),e.on(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(K.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(K.MANIFEST_PARSED,this.onManifestParsed,this),e.off(K.LEVEL_LOADED,this.onLevelLoaded,this),e.off(K.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(K.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(K.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(K.BUFFER_CREATED,this.onBufferCreated,this),e.off(K.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(K.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(K.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:s}=this;if(this.stopLoad(),this.setInterval(lMe),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=$e.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=$e.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case $e.WAITING_LEVEL:{const{levels:t,level:r}=this,s=t?.[r],i=s?.details;if(i&&(!i.live||this.levelLastLoaded===s&&!this.waitForLive(s))){if(this.waitForCdnTuneIn(i))break;this.state=$e.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=$e.IDLE;break}break}case $e.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:s,level:i}=this,a=s?.[i];this.resetStartWhenNotLoaded(a||null),this.state=$e.IDLE}}break}this.state===$e.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[i]))return;const a=r[i],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const b={};this.altAudio===2&&(b.type="video"),this.hls.trigger(K.BUFFER_EOS,b),this.state=$e.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const c=a.details;if(!c||this.state===$e.WAITING_LEVEL||this.waitForLive(a)){this.level=i,this.state=$e.WAITING_LEVEL,this.startFragRequested=!1;return}const u=o.len,f=this.getMaxBufferLength(a.maxBitrate);if(u>=f)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const m=this.backtrackFragment?this.backtrackFragment.start:o.end;let g=this.getNextFragment(m,c);if(this.couldBacktrack&&!this.fragPrevious&&g&&Nr(g)&&this.fragmentTracker.getState(g)!==zr.OK){var y;const x=((y=this.backtrackFragment)!=null?y:g).sn-c.startSN,S=c.fragments[x-1];S&&g.cc===S.cc&&(g=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,m)){if(!g.gap){const x=this.audioOnly&&!this.altAudio?jn.AUDIO:jn.VIDEO,S=(x===jn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,x,gt.MAIN)}g=this.getNextFragmentLoopLoading(g,c,o,gt.MAIN,f)}g&&(g.initSegment&&!g.initSegment.data&&!this.bitrateTest&&(g=g.initSegment),this.loadFragment(g,a,m))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);s===zr.NOT_LOADED||s===zr.PARTIAL?Nr(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,gt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<i.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],c=this.fragLastKbps;c&&this.fragCurrent?r=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:r=0}else r=0;const a=this.getBufferedFrag(t.currentTime+r);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,c=o.duration,u=Math.max(a.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case $e.KEY_LOADING:case $e.FRAG_LOADING:case $e.FRAG_LOADING_WAITING_RETRY:case $e.PARSING:case $e.PARSED:this.state=$e.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;fa(r,"playing",this.onMediaPlaying),fa(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(Ha(r,"playing",this.onMediaPlaying),Ha(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(K.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1;t.levels.forEach(i=>{const a=i.audioCodec;a&&(r=r||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=r&&s&&!oMe(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==$e.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=$e.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s,startFragRequested:i}=this,a=t.level,o=t.details,l=o.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const c=t.levelInfo,u=this.fragCurrent;u&&(this.state===$e.FRAG_LOADING||this.state===$e.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let f=0;if(o.live||(r=c.details)!=null&&r.live){var m;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;f=this.alignPlaylists(o,c.details,(m=this.levelLastLoaded)==null?void 0:m.details)}if(c.details=o,this.levelLastLoaded=c,i||this.setStartPosition(o,f),this.hls.trigger(K.LEVEL_UPDATED,{details:o,level:a}),this.state===$e.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=$e.IDLE}i&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,l=i>=a-t.maxFragLookUpTolerance&&i<=o;if(s!==null&&r.duration>s&&(i<s||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!l&&r.readyState<4||i<o-u)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var c;const f=Bt.bufferInfo(r,s,0);if(!(f!=null&&(c=f.buffered)!=null&&c.length)){r.currentTime=s;return}if(f.start<=i){r.currentTime=s;return}const{nextStart:g}=Bt.bufferedInfo(f.buffered,i,0);g&&(r.currentTime=g)}else r.currentTime=s}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const o=a[r.level];if(!o){this.warn(`Level ${r.level} not found on progress`);return}const l=o.details;if(!l){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const c=o.videoCodec,u=l.PTSKnown||!l.live,f=(t=r.initSegment)==null?void 0:t.data,m=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new KQ(this.hls,gt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=s?s.index:-1,b=y!==-1,x=new qP(r.level,r.sn,r.stats.chunkCount,i.byteLength,y,b),S=this.initPTS[r.cc];g.push(i,f,m,c,r,s,l.totalduration,u,x,S)}onAudioTrackSwitching(e,t){const r=this.hls,s=this.altAudio===2;if(PE(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),r.once(K.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(K.AUDIO_TRACK_SWITCHED,t)}),r.trigger(K.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(K.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=PE(t.url,this.hls);if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,i,a=!1;for(const o in r){const l=r[o];if(l.id==="main"){if(i=o,s=l,o==="video"){const c=r[o];c&&(this.videoBuffer=c.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t,i=r.type===gt.MAIN;if(i){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===$e.PARSED&&(this.state=$e.IDLE);return}const o=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),Nr(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}const a=this.media;a&&(!this._hasEnoughToStart&&Bt.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=$e.ERROR;return}switch(t.details){case _e.FRAG_GAP:case _e.FRAG_PARSING_ERROR:case _e.FRAG_DECRYPT_ERROR:case _e.FRAG_LOAD_ERROR:case _e.FRAG_LOAD_TIMEOUT:case _e.KEY_LOAD_ERROR:case _e.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(gt.MAIN,t);break;case _e.LEVEL_LOAD_ERROR:case _e.LEVEL_LOAD_TIMEOUT:case _e.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===$e.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===nn.LEVEL&&(this.state=$e.IDLE);break;case _e.BUFFER_ADD_CODEC_ERROR:case _e.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case _e.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case _e.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=$e.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==jn.AUDIO||!this.altAudio){const r=(t===jn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,gt.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&r&&(r+=s);const i=this.getLevelDetails(),a=Bt.getBuffered(e),o=a.length?a.start(0):0,l=o-r,c=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<c||this.loadingParts&&l<2*(i?.partTarget||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),r+=l,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${o}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this,i=r?.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=$e.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=i.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(K.FRAG_LOADED,r),i.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r=this.playlistType,{hls:s}=this,{remuxResult:i,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:c,level:u}=o,{video:f,text:m,id3:g,initSegment:y}=i,{details:b}=u,x=this.altAudio?void 0:i.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=$e.PARSING,y){if(y!=null&&y.tracks){const R=l.initSegment||l;this._bufferInitSegment(u,y.tracks,R,a),s.trigger(K.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:r,tracks:y.tracks})}const S=y.initPTS,T=y.timescale,_=this.initPTS[l.cc];at(S)&&(!_||_.baseTime!==S||_.timescale!==T)&&(this.initPTS[l.cc]={baseTime:S,timescale:T},s.trigger(K.INIT_PTS_FOUND,{frag:l,id:r,initPTS:S,timescale:T}))}if(f&&b){x&&f.type==="audiovideo"&&this.logMuxedErr(l);const S=b.fragments[l.sn-1-b.startSN],T=l.sn===b.startSN,_=!S||l.cc>S.cc;if(i.independent!==!1){const{startPTS:R,endPTS:I,startDTS:C,endDTS:L}=f;if(c)c.elementaryStreams[f.type]={startPTS:R,endPTS:I,startDTS:C,endDTS:L};else if(f.firstKeyFrame&&f.independent&&a.id===1&&!_&&(this.couldBacktrack=!0),f.dropped&&f.independent){const k=this.getMainFwdBufferInfo(),M=(k?k.end:this.getLoadPosition())+this.config.maxBufferHole,D=f.firstKeyFramePTS?f.firstKeyFramePTS:R;if(!T&&M<D-this.config.maxBufferHole&&!_){this.backtrack(l);return}else _&&(l.gap=!0);l.setElementaryStreamInfo(f.type,l.start,I,l.start,L,!0)}else T&&R-(b.appliedTimelineOffset||0)>$x&&(l.gap=!0);l.setElementaryStreamInfo(f.type,R,I,C,L),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,c,a,T||_)}else if(T||_)l.gap=!0;else{this.backtrack(l);return}}if(x){const{startPTS:S,endPTS:T,startDTS:_,endDTS:R}=x;c&&(c.elementaryStreams[jn.AUDIO]={startPTS:S,endPTS:T,startDTS:_,endDTS:R}),l.setElementaryStreamInfo(jn.AUDIO,S,T,_,R),this.bufferFragmentData(x,l,c,a)}if(b&&g!=null&&(t=g.samples)!=null&&t.length){const S={id:r,frag:l,details:b,samples:g.samples};s.trigger(K.FRAG_PARSING_METADATA,S)}if(b&&m){const S={id:r,frag:l,details:b,samples:m.samples};s.trigger(K.FRAG_PARSING_USERDATA,S)}}logMuxedErr(e){this.warn(`${Nr(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,s){if(this.state!==$e.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:i,video:a,audiovideo:o}=t;if(i){const c=e.audioCodec;let u=Px(i.codec,c);u==="mp4a"&&(u="mp4a.40.5");const f=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const m=i.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&f.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&f.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),c&&c!==u&&this.log(`Swapping manifest audio codec "${c}" for "${u}"`),i.levelCodec=u,i.id=gt.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${u||""}/${c||""}/${i.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=gt.MAIN;const c=a.codec;if(c?.length===4)switch(c){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${c}]${a.codec!==c?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(K.BUFFER_CODECS,t),!this.hls)return;l.forEach(c=>{const f=t[c].initSegment;f!=null&&f.byteLength&&this.hls.trigger(K.BUFFER_APPENDING,{type:c,data:f,frag:r,part:null,chunkMeta:s,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,gt.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e?.[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=$e.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Bt.isBuffered(e,r)?t=this.getAppendedFrag(r):Bt.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,i=t.level;(!s||t.sn!==s.sn||s.level!==i)&&(this.fragPlaying=t,this.hls.trigger(K.FRAG_CHANGED,{frag:t}),(!s||s.level!==i)&&this.hls.trigger(K.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return at(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(at(t)){const r=this.getLevelDetails(),s=this.currentFrag||(r?Ad(null,r.fragments,t):null);if(s){const i=s.programDateTime;if(i!==null){const a=i+(t-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class uMe{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyUriToKeyInfo){const s=this.keyUriToKeyInfo[r].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=_e.KEY_LOAD_ERROR,r,s,i){return new Il({type:xt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:s})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,i=t.length;s<i;s++){const a=t[s];if(e.cc<=a.cc&&(!Nr(e)||!Nr(a)||e.sn<a.sn)||!r&&s==i-1)return this.emeController.selectKeySystemFormat(a).then(o=>{if(!this.emeController)return;a.setKeyFormat(o);const l=QI(o);if(l)return this.emeController.getKeySystemAccess([l])})}if(this.config.requireKeySystemAccessOnStart){const s=Ox(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,_e.KEY_LOAD_ERROR,c))}const a=i.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,_e.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((r=o)!=null&&r.decryptdata.key)return i.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((s=o)!=null&&s.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(c=>(i.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,_e.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const s=this.emeController.loadKey(r);if(s)return(e.keyLoadPromise=s.then(i=>(e.mediaKeySessionContext=i,r))).catch(i=>{throw e.keyLoadPromise=null,i})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,i=new s(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=r.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(m,g,y,b)=>{const{frag:x,keyInfo:S,url:T}=y;if(!x.decryptdata||S!==this.keyUriToKeyInfo[T])return o(this.createKeyLoadError(x,_e.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));S.decryptdata.key=x.decryptdata.key=new Uint8Array(m.data),x.keyLoader=null,S.loader=null,a({frag:x,keyInfo:S})},onError:(m,g,y,b)=>{this.resetLoader(g),o(this.createKeyLoadError(t,_e.KEY_LOAD_ERROR,new Error(`HTTP Error ${m.code} loading key ${m.text}`),y,Ln({url:l.url,data:void 0},m)))},onTimeout:(m,g,y)=>{this.resetLoader(g),o(this.createKeyLoadError(t,_e.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(m,g,y)=>{this.resetLoader(g),o(this.createKeyLoadError(t,_e.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};i.load(l,u,f)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[s],i&&i.destroy()}}function t8(n){const{type:e}=n;switch(e){case nn.AUDIO_TRACK:return gt.AUDIO;case nn.SUBTITLE_TRACK:return gt.SUBTITLE;default:return gt.MAIN}}function SR(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class dMe{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(K.MANIFEST_LOADING,this.onManifestLoading,this),e.on(K.LEVEL_LOADING,this.onLevelLoading,this),e.on(K.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(K.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(K.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(K.MANIFEST_LOADING,this.onManifestLoading,this),e.off(K.LEVEL_LOADING,this.onLevelLoading,this),e.off(K.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(K.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(K.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,i=r||s,a=new i(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:nn.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:s,pathwayId:i,url:a,deliveryDirectives:o,levelInfo:l}=t;this.load({id:r,level:s,pathwayId:i,responseType:"text",type:nn.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:nn.AUDIO_TRACK,url:i,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:nn.SUBTITLE_TRACK,url:i,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,t){const r=this.loaders[nn.LEVEL];if(r){const s=r.context;s&&!t.levels.some(i=>i===s.levelOrTrack)&&(r.abort(),delete this.loaders[nn.LEVEL])}}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const c=this.hls.logger,u=s.context;if(u&&u.levelOrTrack===e.levelOrTrack&&(u.url===e.url||u.deliveryDirectives&&!e.deliveryDirectives)){u.url===e.url?c.log(`[playlist-loader]: ignore ${e.url} ongoing request`):c.log(`[playlist-loader]: ignore ${e.url} in favor of ${u.url}`);return}c.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===nn.MANIFEST?i=r.manifestLoadPolicy.default:i=_n({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),at((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===nn.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===nn.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===nn.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const u=c.partTarget,f=c.targetduration;if(u&&f){const m=Math.max(u*3,f*.8)*1e3;i=_n({},i,{maxTimeToFirstByteMs:Math.min(m,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(m,i.maxTimeToFirstByteMs)})}}}const a=i.errorRetry||i.timeoutRetry||{},o={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(c,u,f,m)=>{const g=this.getInternalLoader(f);this.resetInternalLoader(f.type);const y=c.data;if(y.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,f,new Error("no EXTM3U delimiter"),m||null,u);return}u.parsing.start=performance.now(),jo.isMediaPlaylist(y)||f.type!==nn.MANIFEST?this.handleTrackOrLevelPlaylist(c,u,f,m||null,g):this.handleMasterPlaylist(c,u,f,m)},onError:(c,u,f,m)=>{this.handleNetworkError(u,f,!1,c,m)},onTimeout:(c,u,f)=>{this.handleNetworkError(u,f,!0,void 0,c)}};s.load(e,o,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,s){const i=this.hls,a=e.data,o=SR(e,r),l=jo.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,r,l.playlistParsingError,s,t);return}const{contentSteering:c,levels:u,sessionData:f,sessionKeys:m,startTimeOffset:g,variableList:y}=l;this.variableList=y;const{AUDIO:b=[],SUBTITLES:x,"CLOSED-CAPTIONS":S}=jo.parseMasterPlaylistMedia(a,o,l);b.length&&!b.some(_=>!_.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new nr({}),bitrate:0,url:""})),i.trigger(K.MANIFEST_LOADED,{levels:u,audioTracks:b,subtitles:x,captions:S,contentSteering:c,url:o,stats:t,networkDetails:s,sessionData:f,sessionKeys:m,startTimeOffset:g,variableList:y})}handleTrackOrLevelPlaylist(e,t,r,s,i){const a=this.hls,{id:o,level:l,type:c}=r,u=SR(e,r),f=at(l)?l:at(o)?o:0,m=t8(r),g=jo.parseLevelPlaylist(e.data,u,f,m,0,this.variableList);if(c===nn.MANIFEST){const y={attrs:new nr({}),bitrate:0,details:g,name:"",url:u};g.requestScheduled=t.loading.start+SQ(g,0),a.trigger(K.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:u,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=g,this.handlePlaylistLoaded(g,e,t,r,s,i)}handleManifestParsingError(e,t,r,s,i){this.hls.trigger(K.ERROR,{type:xt.NETWORK_ERROR,details:_e.MANIFEST_PARSING_ERROR,fatal:t.type===nn.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:i})}handleNetworkError(e,t,r=!1,s,i){let a=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===nn.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===nn.AUDIO_TRACK||e.type===nn.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=_e.UNKNOWN,c=!1;const u=this.getInternalLoader(e);switch(e.type){case nn.MANIFEST:l=r?_e.MANIFEST_LOAD_TIMEOUT:_e.MANIFEST_LOAD_ERROR,c=!0;break;case nn.LEVEL:l=r?_e.LEVEL_LOAD_TIMEOUT:_e.LEVEL_LOAD_ERROR,c=!1;break;case nn.AUDIO_TRACK:l=r?_e.AUDIO_TRACK_LOAD_TIMEOUT:_e.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case nn.SUBTITLE_TRACK:l=r?_e.SUBTITLE_TRACK_LOAD_TIMEOUT:_e.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);const f={type:xt.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:o,networkDetails:t,stats:i};if(s){const m=t?.url||e.url;f.response=Ln({url:m,data:void 0},s)}this.hls.trigger(K.ERROR,f)}handlePlaylistLoaded(e,t,r,s,i,a){const o=this.hls,{type:l,level:c,id:u,groupId:f,deliveryDirectives:m}=s,g=SR(t,s),y=t8(s),b=typeof s.level=="number"&&y===gt.MAIN?c:void 0;if(!e.fragments.length){const S=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(K.ERROR,{type:xt.NETWORK_ERROR,details:_e.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:S,reason:S.message,response:t,context:s,level:b,parent:y,networkDetails:i,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const x=e.playlistParsingError;if(x){if(this.hls.logger.warn(x),!o.config.ignorePlaylistParsingErrors){o.trigger(K.ERROR,{type:xt.NETWORK_ERROR,details:_e.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:x,reason:x.message,response:t,context:s,level:b,parent:y,networkDetails:i,stats:r});return}e.playlistParsingError=null}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case nn.MANIFEST:case nn.LEVEL:o.trigger(K.LEVEL_LOADED,{details:e,levelInfo:s.levelOrTrack||o.levels[0],level:b||0,id:u||0,stats:r,networkDetails:i,deliveryDirectives:m,withoutMultiVariant:l===nn.MANIFEST});break;case nn.AUDIO_TRACK:o.trigger(K.AUDIO_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:u||0,groupId:f||"",stats:r,networkDetails:i,deliveryDirectives:m});break;case nn.SUBTITLE_TRACK:o.trigger(K.SUBTITLE_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:u||0,groupId:f||"",stats:r,networkDetails:i,deliveryDirectives:m});break}}}class oi{static get version(){return Nv}static isMSESupported(){return vZ()}static isSupported(){return aMe()}static getMediaSource(){return ou()}static get Events(){return K}static get MetadataSchema(){return Di}static get ErrorTypes(){return xt}static get ErrorDetails(){return _e}static get DefaultConfig(){return oi.defaultConfig?oi.defaultConfig:KPe}static set DefaultConfig(e){oi.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new YP,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=LIe(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=XPe(oi.DefaultConfig,e,t);this.userConfig=e,r.progressive&&QPe(r,t);const{abrController:s,bufferController:i,capLevelController:a,errorController:o,fpsController:l}=r,c=new o(this),u=this.abrController=new s(this),f=new ELe(this),m=r.interstitialsController,g=m?this.interstitialsController=new m(this,oi):null,y=this.bufferController=new i(this,f),b=this.capLevelController=new a(this),x=new l(this),S=new dMe(this),T=r.contentSteeringController,_=T?new T(this):null,R=this.levelController=new iMe(this,_),I=new rMe(this),C=new uMe(this.config),L=this.streamController=new cMe(this,f,C),k=this.gapController=new tMe(this,f);b.setStreamController(L),x.setStreamController(L);const M=[S,R,L];g&&M.splice(1,0,g),_&&M.splice(1,0,_),this.networkControllers=M;const D=[u,y,k,b,x,I,f];this.audioTrackController=this.createController(r.audioTrackController,M);const U=r.audioStreamController;U&&M.push(this.audioStreamController=new U(this,f,C)),this.subtitleTrackController=this.createController(r.subtitleTrackController,M);const $=r.subtitleStreamController;$&&M.push(this.subtititleStreamController=new $(this,f,C)),this.createController(r.timelineController,D),C.emeController=this.emeController=this.createController(r.emeController,D),this.cmcdController=this.createController(r.cmcdController,D),this.latencyController=this.createController(sMe,D),this.coreComponents=D,M.push(c);const V=c.onErrorOut;typeof V=="function"&&this.on(K.ERROR,V,c),this.on(K.MANIFEST_LOADED,S.onManifestLoaded,S)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const s=e===K.ERROR;this.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.INTERNAL_EXCEPTION,fatal:s,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(K.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(K.ERROR,{type:xt.OTHER_ERROR,details:_e.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,s=t?e:{media:r};this._media=r,this.trigger(K.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(K.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(K.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,s=this._url=UP.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(K.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[gt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[gt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[gt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=tPe()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){aLe(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,r)for(let i=s;i--;){const a=e[i].attrs["HDCP-LEVEL"];if(a&&a<=r)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=hQ(t);return uQ(e,r,navigator.mediaCapabilities)}}oi.defaultConfig=void 0;const hMe=n=>class extends n{static shadowRootOptions={...n.shadowRootOptions};static getTemplateHTML=(t,r={})=>{const{src:s,...i}=t;return`
        <script type="application/json" id="config">
          ${JSON.stringify(r.config||{})}
        <\/script>
        ${n.getTemplateHTML(i)}
      `};#e=null;#t=null;constructor(){super(),this.#s("config")}get config(){return this.#t}set config(t){this.#t=t}attributeChangedCallback(t,r,s){t!=="src"&&super.attributeChangedCallback(t,r,s),t==="src"&&r!=s&&this.load()}#n(){var t,r;(t=this.#e)==null||t.remove(),(r=this.nativeEl)==null||r.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#r),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)}async load(){var t,r;const s=!this.api;if(this.#n(),!!this.src){if(s&&!this.#t&&(this.#t=JSON.parse(((t=this.shadowRoot.getElementById("config"))==null?void 0:t.textContent)||"{}")),oi.isSupported()){switch(this.api=new oi({liveDurationInfinity:!0,autoStartLoad:!1,...this.config}),await Promise.resolve(),this.api.loadSource(this.src),this.api.attachMedia(this.nativeEl),this.nativeEl.preload){case"none":{const l=()=>this.api.startLoad();this.nativeEl.addEventListener("play",l,{once:!0}),this.api.on(oi.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",l)});break}case"metadata":{const l=this.api.config.maxBufferLength,c=this.api.config.maxBufferSize;this.api.config.maxBufferLength=1,this.api.config.maxBufferSize=1;const u=()=>{this.api.config.maxBufferLength=l,this.api.config.maxBufferSize=c};this.nativeEl.addEventListener("play",u,{once:!0}),this.api.on(oi.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",u)}),this.api.startLoad();break}default:this.api.startLoad()}this.nativeEl.webkitCurrentPlaybackTargetIsWireless&&this.api.stopLoad(),this.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#r),this.#e=document.createElement("source"),this.#e.setAttribute("type","application/x-mpegURL"),this.#e.setAttribute("src",this.src),this.nativeEl.disableRemotePlayback=!1,this.nativeEl.append(this.#e);const i=new WeakMap;this.api.on(oi.Events.MANIFEST_PARSED,(l,c)=>{this.nativeEl.autoplay&&this.nativeEl.paused&&this.nativeEl.play().catch(f=>{console.warn("Autoplay failed:",f)}),o();let u=this.videoTracks.getTrackById("main");u||(u=this.addVideoTrack("main"),u.id="main",u.selected=!0);for(const[f,m]of c.levels.entries()){const g=u.addRendition(m.url[0],m.width,m.height,m.videoCodec,m.bitrate);i.set(m,`${f}`),g.id=`${f}`}for(let[f,m]of c.audioTracks.entries()){const g=m.default?"main":"alternative",y=this.addAudioTrack(g,m.name,m.lang);y.id=`${f}`,m.default&&(y.enabled=!0)}}),this.audioTracks.addEventListener("change",()=>{var l;const c=+((l=[...this.audioTracks].find(f=>f.enabled))==null?void 0:l.id),u=this.api.audioTracks.map(f=>f.id);c!=this.api.audioTrack&&u.includes(c)&&(this.api.audioTrack=c)}),this.api.on(oi.Events.LEVELS_UPDATED,(l,c)=>{const u=this.videoTracks[this.videoTracks.selectedIndex??0];if(!u)return;const f=c.levels.map(m=>i.get(m));for(const m of this.videoRenditions)m.id&&!f.includes(m.id)&&u.removeRendition(m)});const a=l=>{const c=l.target.selectedIndex;c!=this.api.nextLevel&&(this.api.nextLevel=c)};(r=this.videoRenditions)==null||r.addEventListener("change",a);const o=()=>{for(const l of this.videoTracks)this.removeVideoTrack(l);for(const l of this.audioTracks)this.removeAudioTrack(l)};this.api.once(oi.Events.DESTROYING,o);return}await Promise.resolve(),this.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(this.nativeEl.src=this.src)}}#r=()=>{var t,r,s;(t=this.nativeEl)!=null&&t.webkitCurrentPlaybackTargetIsWireless?(r=this.api)==null||r.stopLoad():(s=this.api)==null||s.startLoad()};#s(t){if(Object.prototype.hasOwnProperty.call(this,t)){const r=this[t];delete this[t],this[t]=r}}},fMe=hMe(xIe(lIe));globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",fMe);const n8=({youtubeUrl:n,nativeAsset:e,onReady:t,onPlay:r,onPause:s,onTimeUpdate:i,onDurationChange:a,playbackRate:o=1,isMuted:l=!1,volume:c=1,initialTime:u=0})=>{const f=E.useRef(null),m=E.useRef(null),g=Vf(n||""),y=He(D=>D.isPreviewMode),b=He(D=>D.previewTimestamp),x=He(D=>D.togglePlayPause),S=He(D=>D.isReady),T=He(D=>D.isPlaying),[_,R]=E.useState(!1),I=E.useRef(null),C=E.useCallback(D=>({play:()=>D.play(),pause:()=>D.pause(),currentTime:U=>U!==void 0?(D.currentTime=U,D):D.currentTime,duration:()=>D.duration||0,playbackRate:U=>U!==void 0?(D.playbackRate=U,D):D.playbackRate,muted:U=>U!==void 0?(D.muted=U,D):D.muted,volume:U=>U!==void 0?(D.volume=U,D):D.volume,paused:()=>D.paused,dispose:()=>{},on:(U,$)=>{D.addEventListener(U,$)},off:(U,$)=>{D.removeEventListener(U,$)}}),[]);E.useEffect(()=>{if(f.current,e?.hls_url,e?.mux_playback_id,!f.current)return;m.current&&(m.current.remove(),m.current=null),f.current.innerHTML="";let D;if(e?.hls_url){if(D=document.createElement("hls-video"),D.setAttribute("src",e.hls_url),D.setAttribute("crossorigin","anonymous"),D.setAttribute("preload","auto"),e.mux_playback_id){const Y=e.mux_playback_id.replace(/\.m3u8$/,"");He.getState().setMuxPlaybackId(Y),He.getState().fetchStoryboard(Y)}}else if(g)D=document.createElement("youtube-video"),D.setAttribute("src",`https://www.youtube.com/watch?v=${g}`),He.getState().setMuxPlaybackId(null);else return;D.slot="media",D.style.width="100%",D.style.height="100%",D.style.objectFit="cover";const U=document.createElement("media-controller");U.style.width="100%",U.style.height="100%",U.setAttribute("noautohide",""),U.appendChild(D),f.current.appendChild(U),m.current=D;let $=!1;const V=()=>{if($)return;$=!0;const Y=C(D);t&&t(Y),u>0&&D.duration>0&&(D.currentTime=u),D.muted=l,D.volume=c,D.playbackRate=o},B=()=>{r&&r()},W=()=>{s&&s()},F=()=>{i&&D&&i(D.currentTime)},j=()=>{a&&D&&a(D.duration)},q=Y=>{const Q=Y.target.error;console.error("[MainAssetPlayer] Media element error:",{event:Y,error:Q,code:Q?.code,message:Q?.message}),$||V()},H=()=>{He.getState().handleWaiting()},N=()=>{He.getState().handleSeeking()},O=()=>{He.getState().handleSeeked()},z=()=>{He.getState().handleCanPlay()};D.addEventListener("loadedmetadata",V),D.addEventListener("loadeddata",V),D.addEventListener("canplay",V),D.addEventListener("loadstart",V),D.addEventListener("play",B),D.addEventListener("pause",W),D.addEventListener("timeupdate",F),D.addEventListener("durationchange",j),D.addEventListener("error",q),D.addEventListener("waiting",H),D.addEventListener("seeking",N),D.addEventListener("seeked",O),D.addEventListener("canplay",z),D.readyState>=3&&V();const G=setTimeout(()=>{$||V()},5e3);return()=>{clearTimeout(G),D.removeEventListener("loadedmetadata",V),D.removeEventListener("loadeddata",V),D.removeEventListener("canplay",V),D.removeEventListener("loadstart",V),D.removeEventListener("play",B),D.removeEventListener("pause",W),D.removeEventListener("timeupdate",F),D.removeEventListener("durationchange",j),D.removeEventListener("error",q),D.removeEventListener("waiting",H),D.removeEventListener("seeking",N),D.removeEventListener("seeked",O),D.removeEventListener("canplay",z),m.current&&(m.current.remove(),m.current=null)}},[n,g,e,t,r,s,i,a,u,C]),E.useEffect(()=>{const D=m.current;D&&D.playbackRate!==o&&(D.playbackRate=o)},[o]),E.useEffect(()=>{const D=m.current;D&&D.muted!==l&&(D.muted=l)},[l]),E.useEffect(()=>{const D=m.current;D&&D.volume!==c&&(D.volume=c)},[c]);const L=E.useCallback(D=>{D.target.closest("[data-video-control]")||!y&&S&&x()},[y,S,x]),k=E.useCallback(()=>{document.querySelector('[data-state="open"]')||(I.current&&(clearTimeout(I.current),I.current=null),R(!0))},[]),M=E.useCallback(()=>{document.querySelector('[data-state="open"]')||(I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{R(!1),I.current=null},100))},[]);return E.useEffect(()=>()=>{I.current&&clearTimeout(I.current)},[]),!g&&!e?.hls_url?d.jsx("div",{className:"main-asset-placeholder bg-gray-800 w-full h-full rounded-md flex items-center justify-center text-white",children:"No Video"}):d.jsx("div",{className:"main-asset-player md:rounded-md overflow-hidden bg-black w-full h-full",onMouseEnter:k,onMouseLeave:M,onClick:L,children:d.jsxs("div",{className:"relative w-full h-full",children:[d.jsx("div",{ref:f,className:"video-container w-full h-full [&>*]:w-full [&>*]:h-full [&>*]:object-contain"}),d.jsx("div",{className:`absolute inset-0 flex items-center justify-center z-20 ${_?"opacity-100":"opacity-0 pointer-events-none"}`,children:d.jsx("button",{"data-video-control":"true",className:"flex items-center justify-center h-20 w-20 bg-text-primary/50 text-black rounded-full hover:bg-text-primary/60 backdrop-blur-sm shadow-md ",onClick:x,"aria-label":T?"Pause":"Play",children:T?d.jsx(tD,{size:20}):d.jsx(nv,{size:20})})}),d.jsxs("div",{className:`absolute inset-0 pointer-events-none ${y&&b!==null?"opacity-100":"opacity-0 pointer-events-none"}`,style:{zIndex:10},children:[d.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 60%, transparent 100%)"}}),y&&b!==null&&d.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 mb-[10%]",children:d.jsxs("div",{className:"text-text-primary shadow-xl text-shadow-md text-lg opacity-90 font-mono flex items-center gap-1",children:[d.jsx("span",{children:"Previewing"}),Math.floor(b/3600)>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(b/3600),format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"h"}),d.jsx("span",{children:":"})]}),(Math.floor(b%3600/60)>0||Math.floor(b/3600)>0)&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(b%3600/60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"m"}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:Math.floor(b%60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"s"})]})})]})]})})};var yZ=["PageUp","PageDown"],bZ=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],xZ={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},bm="Slider",[cL,mMe,pMe]=Gv(bm),[wZ,Pje]=Ns(bm,[pMe]),[gMe,tT]=wZ(bm),EZ=E.forwardRef((n,e)=>{const{name:t,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:f=()=>{},onValueCommit:m=()=>{},inverted:g=!1,form:y,...b}=n,x=E.useRef(new Set),S=E.useRef(0),_=a==="horizontal"?vMe:yMe,[R=[],I]=vi({prop:u,defaultProp:c,onChange:U=>{[...x.current][S.current]?.focus(),f(U)}}),C=E.useRef(R);function L(U){const $=SMe(R,U);D(U,$)}function k(U){D(U,S.current)}function M(){const U=C.current[S.current];R[S.current]!==U&&m(R)}function D(U,$,{commit:V}={commit:!1}){const B=RMe(i),W=CMe(Math.round((U-r)/i)*i+r,B),F=mE(W,[r,s]);I((j=[])=>{const q=wMe(j,F,$);if(AMe(q,l*i)){S.current=q.indexOf(F);const H=String(q)!==String(j);return H&&V&&m(q),H?q:j}else return j})}return d.jsx(gMe,{scope:n.__scopeSlider,name:t,disabled:o,min:r,max:s,valueIndexToChangeRef:S,thumbs:x.current,values:R,orientation:a,form:y,children:d.jsx(cL.Provider,{scope:n.__scopeSlider,children:d.jsx(cL.Slot,{scope:n.__scopeSlider,children:d.jsx(_,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:e,onPointerDown:rt(b.onPointerDown,()=>{o||(C.current=R)}),min:r,max:s,inverted:g,onSlideStart:o?void 0:L,onSlideMove:o?void 0:k,onSlideEnd:o?void 0:M,onHomeKeyDown:()=>!o&&D(r,0,{commit:!0}),onEndKeyDown:()=>!o&&D(s,R.length-1,{commit:!0}),onStepKeyDown:({event:U,direction:$})=>{if(!o){const W=yZ.includes(U.key)||U.shiftKey&&bZ.includes(U.key)?10:1,F=S.current,j=R[F],q=i*W*$;D(j+q,F,{commit:!0})}}})})})})});EZ.displayName=bm;var[SZ,TZ]=wZ(bm,{startEdge:"left",endEdge:"right",size:"width",direction:1}),vMe=E.forwardRef((n,e)=>{const{min:t,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=n,[f,m]=E.useState(null),g=$t(e,_=>m(_)),y=E.useRef(void 0),b=qv(s),x=b==="ltr",S=x&&!i||!x&&i;function T(_){const R=y.current||f.getBoundingClientRect(),I=[0,R.width],L=oM(I,S?[t,r]:[r,t]);return y.current=R,L(_-R.left)}return d.jsx(SZ,{scope:n.__scopeSlider,startEdge:S?"left":"right",endEdge:S?"right":"left",direction:S?1:-1,size:"width",children:d.jsx(_Z,{dir:b,"data-orientation":"horizontal",...u,ref:g,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const R=T(_.clientX);a?.(R)},onSlideMove:_=>{const R=T(_.clientX);o?.(R)},onSlideEnd:()=>{y.current=void 0,l?.()},onStepKeyDown:_=>{const I=xZ[S?"from-left":"from-right"].includes(_.key);c?.({event:_,direction:I?-1:1})}})})}),yMe=E.forwardRef((n,e)=>{const{min:t,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=n,u=E.useRef(null),f=$t(e,u),m=E.useRef(void 0),g=!s;function y(b){const x=m.current||u.current.getBoundingClientRect(),S=[0,x.height],_=oM(S,g?[r,t]:[t,r]);return m.current=x,_(b-x.top)}return d.jsx(SZ,{scope:n.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:d.jsx(_Z,{"data-orientation":"vertical",...c,ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const x=y(b.clientY);i?.(x)},onSlideMove:b=>{const x=y(b.clientY);a?.(x)},onSlideEnd:()=>{m.current=void 0,o?.()},onStepKeyDown:b=>{const S=xZ[g?"from-bottom":"from-top"].includes(b.key);l?.({event:b,direction:S?-1:1})}})})}),_Z=E.forwardRef((n,e)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=n,u=tT(bm,t);return d.jsx(_t.span,{...c,ref:e,onKeyDown:rt(n.onKeyDown,f=>{f.key==="Home"?(a(f),f.preventDefault()):f.key==="End"?(o(f),f.preventDefault()):yZ.concat(bZ).includes(f.key)&&(l(f),f.preventDefault())}),onPointerDown:rt(n.onPointerDown,f=>{const m=f.target;m.setPointerCapture(f.pointerId),f.preventDefault(),u.thumbs.has(m)?m.focus():r(f)}),onPointerMove:rt(n.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&s(f)}),onPointerUp:rt(n.onPointerUp,f=>{const m=f.target;m.hasPointerCapture(f.pointerId)&&(m.releasePointerCapture(f.pointerId),i(f))})})}),AZ="SliderTrack",RZ=E.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,s=tT(AZ,t);return d.jsx(_t.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:e})});RZ.displayName=AZ;var uL="SliderRange",CZ=E.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,s=tT(uL,t),i=TZ(uL,t),a=E.useRef(null),o=$t(e,a),l=s.values.length,c=s.values.map(m=>LZ(m,s.min,s.max)),u=l>1?Math.min(...c):0,f=100-Math.max(...c);return d.jsx(_t.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...n.style,[i.startEdge]:u+"%",[i.endEdge]:f+"%"}})});CZ.displayName=uL;var dL="SliderThumb",kZ=E.forwardRef((n,e)=>{const t=mMe(n.__scopeSlider),[r,s]=E.useState(null),i=$t(e,o=>s(o)),a=E.useMemo(()=>r?t().findIndex(o=>o.ref.current===r):-1,[t,r]);return d.jsx(bMe,{...n,ref:i,index:a})}),bMe=E.forwardRef((n,e)=>{const{__scopeSlider:t,index:r,name:s,...i}=n,a=tT(dL,t),o=TZ(dL,t),[l,c]=E.useState(null),u=$t(e,T=>c(T)),f=l?a.form||!!l.closest("form"):!0,m=pS(l),g=a.values[r],y=g===void 0?0:LZ(g,a.min,a.max),b=EMe(r,a.values.length),x=m?.[o.size],S=x?TMe(x,y,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),d.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${S}px)`},children:[d.jsx(cL.ItemSlot,{scope:n.__scopeSlider,children:d.jsx(_t.span,{role:"slider","aria-label":n["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":g,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:g===void 0?{display:"none"}:n.style,onFocus:rt(n.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),f&&d.jsx(IZ,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:g},r)]})});kZ.displayName=dL;var xMe="RadioBubbleInput",IZ=E.forwardRef(({__scopeSlider:n,value:e,...t},r)=>{const s=E.useRef(null),i=$t(s,r),a=FS(e);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&u){const f=new Event("input",{bubbles:!0});u.call(o,e),o.dispatchEvent(f)}},[a,e]),d.jsx(_t.input,{style:{display:"none"},...t,ref:i,defaultValue:e})});IZ.displayName=xMe;function wMe(n=[],e,t){const r=[...n];return r[t]=e,r.sort((s,i)=>s-i)}function LZ(n,e,t){const i=100/(t-e)*(n-e);return mE(i,[0,100])}function EMe(n,e){return e>2?`Value ${n+1} of ${e}`:e===2?["Minimum","Maximum"][n]:void 0}function SMe(n,e){if(n.length===1)return 0;const t=n.map(s=>Math.abs(s-e)),r=Math.min(...t);return t.indexOf(r)}function TMe(n,e,t){const r=n/2,i=oM([0,50],[0,r]);return(r-i(e)*t)*t}function _Me(n){return n.slice(0,-1).map((e,t)=>n[t+1]-e)}function AMe(n,e){if(e>0){const t=_Me(n);return Math.min(...t)>=e}return!0}function oM(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function RMe(n){return(String(n).split(".")[1]||"").length}function CMe(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}var DZ=EZ,kMe=RZ,IMe=CZ,LMe=kZ;const lM=E.forwardRef(({className:n,...e},t)=>d.jsxs(DZ,{ref:t,className:je("relative flex w-full touch-none select-none items-center",n),...e,children:[d.jsx(kMe,{className:"relative h-1 w-full grow overflow-hidden rounded-full bg-secondary",children:d.jsx(IMe,{className:"absolute h-full bg-text-primary"})}),d.jsx(LMe,{className:"block h-3 w-3 rounded-full bg-text-primary shadow transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 cursor-grab active:cursor-grabbing"})]}));lM.displayName=DZ.displayName;const hL=()=>{const{currentTime:n,duration:e,volume:t,isMuted:r,playbackRate:s,toggleMainAssetFullscreen:i,videoId:a}=He(),o=Q9(),l=Jn(),c=Ag(D=>D.currentTeam?.team_type),[u,f]=E.useState(!1),[m,g]=E.useState(!1),[y,b]=E.useState(!1),x=E.useRef(null),S=E.useRef(null),T=E.useRef(null),_=()=>{window.open("https://flask.do/#pricing","_blank","noopener,noreferrer"),b(!1)},R=E.useCallback(D=>{const U=D[0];o.setVolume(U),U>0&&r&&o.toggleMute()},[o,r]),I=E.useCallback(()=>{S.current&&(clearTimeout(S.current),S.current=null),x.current=setTimeout(()=>{f(!0)},400)},[]),C=E.useCallback(()=>{x.current&&(clearTimeout(x.current),x.current=null),S.current=setTimeout(()=>{f(!1)},400)},[]),L=a?[.25,.5,.75,1,1.25,1.5,1.75,2]:[.25,.5,.75,1,1.25,1.5,1.75,2,4],k=E.useCallback(D=>{const{setPlaybackRate:U,playerRef:$}=He.getState();if(U(D),$&&typeof $.playbackRate=="function")try{$.playbackRate(D)}catch(V){console.error("Error setting playback rate:",V)}g(!1)},[]),M=E.useCallback(()=>{g(D=>!D)},[]);return ve.useEffect(()=>{const D=U=>{T.current&&!T.current.contains(U.target)&&g(!1)};if(m)return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[m]),d.jsx(yi,{delayDuration:0,children:d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative z-50 flex items-center justify-center mt-2 gap-1",children:[d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("div",{className:"h-8 w-8 flex items-center justify-center bg-inbetween-background backdrop-blur-md rounded-full -mt-1.5 p-0 z-40 cursor-pointer",onClick:o.togglePlayPause,children:o.isPlaying?d.jsx(tD,{size:14,className:"text-text-primary",fill:"currentColor"}):d.jsx(nv,{size:14,className:"text-text-primary",fill:"currentColor"})})}),d.jsx($n,{className:"mb-3",children:o.isPlaying?"Pause":"Play"})]}),d.jsx("div",{className:"h-8 flex items-center bg-inbetween-background backdrop-blur-md rounded-full px-4 -mt-1.5 z-0",children:d.jsx("div",{className:"px-1 py-1",children:d.jsxs("span",{className:"font-mono text-sm select-none whitespace-nowrap flex items-center",children:[d.jsxs("span",{className:"text-text-primary flex items-center",children:[Math.floor(e/3600)>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(n/3600),format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:Math.floor(n%3600/60),format:{minimumIntegerDigits:Math.floor(e/3600)>0?2:1,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"}),d.jsx(Er,{value:Math.floor(n%60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0})]}),d.jsx("span",{className:"text-text-secondary mx-2",children:"/"}),d.jsxs("span",{className:"text-text-secondary flex items-center",children:[Math.floor(e/3600)>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(e/3600),format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:Math.floor(e%3600/60),format:{minimumIntegerDigits:Math.floor(e/3600)>0?2:1,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"}),d.jsx(Er,{value:Math.floor(e%60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0})]})]})})}),d.jsx("div",{className:"h-8 flex items-center bg-inbetween-background backdrop-blur-md rounded-full px-3 -mt-1.5 z-0 gap-3",children:d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative",ref:T,children:[d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsxs("button",{className:"font-mono text-sm text-text-secondary hover:text-text-primary transition-colors px-1 flex items-center gap-1",onClick:M,type:"button",style:{minWidth:"2rem"},children:[d.jsx("span",{children:s%1===0?`${s}x`:`${s.toFixed(2)}x`}),m?d.jsx(JL,{className:"h-3 w-3"}):d.jsx(Id,{className:"h-3 w-3"})]})}),d.jsx($n,{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{children:"Playback Speed"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(gn,{children:"J"}),d.jsx(gn,{children:"L"})]})]})})]}),m&&d.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-inbetween-background backdrop-blur-md rounded-lg border element-border shadow-lg overflow-hidden z-50",children:d.jsx("div",{className:"py-1",children:L.map(D=>d.jsx("button",{onClick:()=>k(D),className:je("w-full px-3 py-2 text-left text-sm transition-colors font-mono",s===D?"bg-element-hover text-text-primary":"text-text-secondary hover:bg-element-hover hover:text-text-primary"),type:"button",children:D%1===0?`${D}x`:`${D.toFixed(2)}x`},D))})})]}),d.jsxs("div",{className:"flex items-center group",onMouseEnter:I,onMouseLeave:C,children:[d.jsx("button",{className:"flex items-center justify-center p-1 text-text-secondary hover:text-text-primary transition-colors",onClick:o.toggleMute,type:"button",children:r?d.jsx(az,{className:"h-4 w-4"}):d.jsx(iz,{className:"h-4 w-4"})}),d.jsx("div",{className:je("transition-all duration-300 ease-out flex items-center",u?"w-20 ml-2 opacity-100":"w-0 ml-0 opacity-0 overflow-hidden"),children:d.jsx(lM,{value:[r?0:t],onValueChange:R,max:1,min:0,step:.01,className:"w-20 cursor-pointer"})})]}),d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("button",{className:"flex items-center justify-center p-1 text-text-secondary hover:text-text-primary transition-colors",onClick:i,type:"button",children:d.jsx(eue,{className:"h-4 w-4"})})}),d.jsx($n,{className:"mb-3",children:"Fullscreen"})]})]})}),c!=="pro_team"&&d.jsx("div",{className:"h-8 flex items-center bg-inbetween-background backdrop-blur-md rounded-full pl-3 pr-1.5 -mt-1.5 z-0 gap-2 relative overflow-hidden group cursor-pointer",children:d.jsxs("div",{className:"relative flex items-center gap-2 pr-0",onClick:()=>l("/"),children:[d.jsxs("p",{className:"text-xs text-text-secondary group-hover:text-text-primary transition-all whitespace-nowrap",children:["You're using ",d.jsx("span",{className:"underline",children:"Flask"}),". Pretty cool, huh?"]}),d.jsx("button",{onClick:D=>{D.stopPropagation(),b(!0)},className:"p-1 rounded-full bg-element-background/50 hover:bg-element-background transition-colors","aria-label":"About Flask branding",children:d.jsx($o,{className:"h-3 w-3 text-text-secondary/50 hover:text-text-secondary"})})]})})]}),d.jsx(Zn,{open:y,onOpenChange:b,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsx(ar,{children:d.jsx(or,{children:"Flask Branding"})}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"Flasks created on a free plan include this Flask branding."}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"This helps us share the product with more people and keep it free."}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"To create Flasks without this branding, discover Flask Pro."}),d.jsxs(ys,{className:"gap-2",children:[d.jsx(dt,{variant:"ghost",onClick:()=>b(!1),children:"Cancel"}),d.jsx(dt,{variant:"default",onClick:_,autoFocus:!0,children:"Get Flask Pro"})]})]})})]})})},DMe=({youtubeUrl:n,nativeAsset:e,hasEditingPermissions:t,playerHeightVh:r,onPlayerReady:s,onPlay:i,onTimeUpdate:a,onDurationChange:o,onHeightResize:l})=>{const c=He(I=>I.isPreviewMode),{playbackRate:u,isMuted:f,volume:m,handlePause:g}=He();cq({transformWrapperRef:null});const[y,b]=E.useState(()=>window.innerWidth<768);E.useEffect(()=>{const I=()=>b(window.innerWidth<768);return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]);const[x,S]=E.useState(()=>{if(typeof window<"u"){const k=window.innerHeight*(r/100)-50-10;return{width:k*(16/9),height:k}}return{width:640,height:360}}),T=E.useRef(0),_=E.useRef(0),R=E.useCallback(I=>{if(!l||!r)return;T.current=I.clientY,_.current=r;const C=k=>{const M=k.clientY-T.current,D=window.innerHeight,U=M/D*100,$=Math.max(foe,Math.min(zb,_.current+U));l($)},L=()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",L),document.body.style.cursor="",document.body.style.userSelect=""};document.addEventListener("mousemove",C),document.addEventListener("mouseup",L),document.body.style.cursor="ns-resize",document.body.style.userSelect="none"},[l,r]);return E.useEffect(()=>{if(typeof window>"u")return;const I=()=>{const M=window.innerHeight*(r/100)-50-10,D=M*(16/9);S({width:D,height:M})};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[r]),y?d.jsx(d.Fragment,{children:d.jsxs("div",{className:"relative w-screen","data-testid":"fixed-main-asset",children:[d.jsx("div",{"data-main-asset-player-container":!0,className:"relative w-screen aspect-video bg-black overflow-hidden",children:n||e?d.jsx(n8,{youtubeUrl:n,nativeAsset:e,onReady:s,onPlay:i,onPause:g,onTimeUpdate:a,onDurationChange:o,playbackRate:u,isMuted:f,volume:m}):d.jsx("div",{className:"w-full h-full bg-black"})}),d.jsx("div",{className:"mt-2 mb-1 flex justify-center items-center gap-3",children:d.jsx(hL,{})})]})}):d.jsx(d.Fragment,{children:d.jsxs("div",{className:"relative flex flex-col items-center pt-4","data-testid":"fixed-main-asset",style:{height:`${r}vh`},children:[d.jsx("div",{className:"relative flex-shrink-0",style:{height:`${x.height}px`,width:`${x.width}px`},children:d.jsx("div",{className:"overflow-hidden w-full h-full rounded-lg shadow-xl shadow-black",children:n||e?d.jsx("div",{"data-main-asset-player-container":!0,className:`w-full h-full overflow-hidden rounded-lg shadow-2xl ${c?"border-text-primary":"element-border"} border`,children:d.jsx(n8,{youtubeUrl:n,nativeAsset:e,onReady:s,onPlay:i,onPause:g,onTimeUpdate:a,onDurationChange:o,playbackRate:u,isMuted:f,volume:m})}):d.jsx("div",{className:"flex flex-col items-center justify-center w-full h-full p-8 relative bg-black rounded-lg shadow-2xl border-border border"})})}),d.jsxs("div",{className:"mt-2 mb-1 flex justify-center items-center gap-3 relative",children:[l&&r&&d.jsx("div",{className:"fixed left-1/2 -translate-x-1/2 cursor-ns-resize z-40 border-t border-white opacity-0 hover:opacity-100 transition-opacity hidden md:block bg-text-primary/50 backdrop-blur-sm rounded-full",style:{top:`${x.height+56}px`,width:"99vw",height:"4px"},onMouseDown:R,onDragStart:I=>I.preventDefault(),draggable:!1,title:"Drag to resize player"}),d.jsx(hL,{})]})]})})},PMe=({youtubeUrl:n,nativeAsset:e,hasEditingPermissions:t,onCreateLinkedFrame:r,onCreateElementInFrame:s})=>{const i=E.useRef(null),[a,o]=E.useState(!0),[l,c]=E.useState(!1),u=E.useRef(null),f=E.useRef(null),[m,g]=E.useState(null),{currentTime:y,duration:b,isPlaying:x,setMainAssetFullscreen:S,isPreviewMode:T,previewTimestamp:_}=He(),R=typeof window<"u"?window.innerWidth*.9-32:800;E.useEffect(()=>((async()=>{let L=null,k=0;const M=50;for(;!L&&k<M;)if(L=document.querySelector("media-controller"),!L){if(k===0){const D=document.querySelectorAll("*");Array.from(D).filter($=>$.tagName.toLowerCase().includes("media")||$.tagName.toLowerCase().includes("video")||$.tagName.toLowerCase().includes("hls")||$.tagName.toLowerCase().includes("youtube")).map($=>$.tagName.toLowerCase())}await new Promise(D=>setTimeout(D,100)),k++}if(!L){console.warn(`[MainAssetFullscreen] Could not find media-controller for fullscreen after ${M} retries (${M*100}ms)`),S(!1);return}f.current=L,g(L);try{L.requestFullscreen?await L.requestFullscreen():L.webkitRequestFullscreen?await L.webkitRequestFullscreen():L.mozRequestFullScreen?await L.mozRequestFullScreen():L.msRequestFullscreen&&await L.msRequestFullscreen(),c(!0)}catch(D){console.error("Error entering fullscreen:",D),S(!1)}})(),()=>{document.fullscreenElement?document.exitFullscreen().catch(L=>{console.error("Error exiting fullscreen:",L)}):document.webkitFullscreenElement?document.webkitExitFullscreen():document.mozFullScreenElement?document.mozCancelFullScreen():document.msFullscreenElement&&document.msExitFullscreen()}),[S]),E.useEffect(()=>{if(!m||!l)return;const C=()=>{o(!0),u.current&&(clearTimeout(u.current),u.current=null),u.current=setTimeout(()=>{o(!1)},2e3)};return m.addEventListener("mousemove",C),()=>{m.removeEventListener("mousemove",C),u.current&&clearTimeout(u.current)}},[m,l]);const I=E.useCallback(()=>{S(!1)},[S]);return E.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]),E.useEffect(()=>{const C=()=>{document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?c(!0):(c(!1),I())};return document.addEventListener("fullscreenchange",C),document.addEventListener("webkitfullscreenchange",C),document.addEventListener("mozfullscreenchange",C),document.addEventListener("MSFullscreenChange",C),()=>{document.removeEventListener("fullscreenchange",C),document.removeEventListener("webkitfullscreenchange",C),document.removeEventListener("mozfullscreenchange",C),document.removeEventListener("MSFullscreenChange",C)}},[I]),!l||!m?null:Hs.createPortal(d.jsxs("div",{ref:i,className:"fixed inset-0 z-[9999] pointer-events-none",children:[d.jsxs("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-200 ${T&&_!==null?"opacity-100":"opacity-0"}`,style:{zIndex:10},children:[d.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 60%, transparent 100%)"}}),T&&_!==null&&d.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 mb-[10%]",children:d.jsxs("div",{className:"text-text-primary shadow-xl text-shadow-md text-lg opacity-90 font-mono",children:["Previewing ",h0e(_)]})})]}),d.jsx(Ed,{children:a&&d.jsxs(Ka.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},transition:{type:"spring",stiffness:400,damping:25},className:"absolute bottom-0 left-0 right-0 pointer-events-none z-50",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative flex flex-col items-center pb-6 pt-12",style:{pointerEvents:"auto"},children:[d.jsx("div",{className:"mb-12",children:d.jsx(hL,{})}),d.jsx("div",{className:"w-full max-w-[90vw] px-4",style:{pointerEvents:"auto"},children:d.jsx(dq,{currentTime:y,duration:b,isPlaying:x,playbarWidth:R,hasEditingPermissions:t,youtubeUrl:n,nativeAsset:e,onCreateLinkedFrame:r,onCreateElementInFrame:s,preventSeekOnLinkClick:!1,timelineScale:1,isFullscreen:!0})})]})]})})]}),m)},MMe=({isOpen:n,onClose:e,onConfirm:t,assetName:r,isDownloading:s=!1})=>d.jsx(Zn,{open:n,onOpenChange:e,children:d.jsxs(Kn,{className:"sm:max-w-[425px]",children:[d.jsxs(ar,{children:[d.jsxs(or,{className:"flex items-center gap-2",children:[d.jsx(UC,{className:"h-5 w-5"}),"Download Original File"]}),d.jsxs(zl,{className:"pt-4",children:["You are about to download the original file for"," ",d.jsxs("strong",{children:['"',r,'"']}),"."]})]}),d.jsxs(ys,{className:"pt-6",children:[d.jsx(dt,{variant:"outline",onClick:e,disabled:s,children:"Cancel"}),d.jsx(dt,{onClick:t,disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"h-4 w-4 mr-2 animate-spin"}),"Preparing Download..."]}):d.jsxs(d.Fragment,{children:[d.jsx(UC,{className:"h-4 w-4 mr-2"}),"Download"]})})]})]})});function OMe({onOpenChange:n}){const e=De(S=>S.availableAssets),{currentAssetIndex:t,isCreator:r}=Dd(),[s,i]=Cd(),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,f]=E.useState(null),[m,g]=E.useState(!1),y=S=>{S===0?s.delete("asset"):s.set("asset",String(S+1)),i(s,{replace:!0})},b=(S,T)=>{T.stopPropagation(),f(S),c(!0),n(!1)},x=async()=>{if(u){g(!0);try{const S=await Ht(`/api/assets/${u.id}/download`,{method:"POST"});if(!S.ok){const I=await S.json();throw new Error(I.error||"Failed to generate download URL")}const{downloadUrl:T,filename:_}=await S.json();c(!1),g(!1),f(null);const R=document.createElement("a");R.href=T,R.download=_,document.body.appendChild(R),R.click(),document.body.removeChild(R),setTimeout(()=>{Mr({title:"Download started",description:`Downloading ${u.title}`})},100)}catch(S){console.error("Download error:",S),g(!1),f(null),Mr({title:"Download failed",description:S instanceof Error?S.message:"Failed to download asset",variant:"destructive"})}}};return!e||e.length===0?null:d.jsxs(d.Fragment,{children:[d.jsxs(Ms,{align:"end",className:"min-w-[350px] p-2 mt-3 rounded-xl",children:[d.jsxs("div",{className:"px-3 pr-0 py-2 text-sm font-semibold text-muted-foreground border-b border-border mb-2 flex items-center justify-between",children:[d.jsx("span",{children:"Assets"}),r&&d.jsxs("button",{onClick:()=>o(!0),className:"button-secondary items-center flex gap-2 text-xs py-1 px-3",children:[d.jsx(Jc,{width:"12"}),"Add Asset"]})]}),e.map((S,T)=>{const _=S.asset_type==="native"&&S.mux_asset_id;return d.jsxs("div",{className:"flex items-center gap-3 py-1",children:[d.jsx("div",{className:"text-white text-xs uppercase font-semibold flex items-center justify-start",children:d.jsx("div",{className:"flex items-center gap-2",children:d.jsxs("div",{children:["#",T+1]})})}),d.jsxs(Pn,{onClick:()=>y(T),className:`cursor-pointer rounded-md p-3 flex-1 flex items-center gap-3 ${T===t?"bg-element-background":"hover:bg-accent/50 focus:bg-accent/50"}`,children:[d.jsxs("div",{className:"relative w-16 h-10 rounded overflow-hidden flex-shrink-0",children:[d.jsx("img",{src:S.thumbnail_url||"/images/video-placeholder.png",alt:S.title,className:`w-full h-full object-cover transition-opacity ${T===t?"opacity-20 ":"opacity-100 "}`}),T===t&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:d.jsx(is,{className:"h-4 w-4 text-white drop-shadow-sm"})})]}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"font-medium truncate text-xs",children:S.title}),T===0&&d.jsx("div",{className:"text-[10px] uppercase text-muted-foreground mt-0.5",children:"Latest"})]}),_&&d.jsx("button",{onClick:R=>b({id:S.id,title:S.title},R),className:"p-2 rounded hover:bg-accent/70 transition-colors",title:"Download original file",children:d.jsx(UC,{className:"h-4 w-4"})})]})]},S.id)})]}),d.jsx(w9,{isOpen:a,onClose:()=>o(!1)}),u&&d.jsx(MMe,{isOpen:l,onClose:()=>{c(!1),f(null)},onConfirm:x,assetName:u.title,isDownloading:m})]})}function r8(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}function NMe(n,e){return E.useReducer((t,r)=>e[t][r]??t,n)}var PZ=n=>{const{present:e,children:t}=n,r=jMe(e),s=typeof t=="function"?t({present:r.isPresent}):E.Children.only(t),i=$t(r.ref,FMe(s));return typeof t=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};PZ.displayName="Presence";function jMe(n){const[e,t]=E.useState(),r=E.useRef(null),s=E.useRef(n),i=E.useRef("none"),a=n?"mounted":"unmounted",[o,l]=NMe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=$b(r.current);i.current=o==="mounted"?c:"none"},[o]),vr(()=>{const c=r.current,u=s.current;if(u!==n){const m=i.current,g=$b(c);n?l("MOUNT"):g==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&m!==g?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),vr(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,f=g=>{const b=$b(r.current).includes(CSS.escape(g.animationName));if(g.target===e&&b&&(l("ANIMATION_END"),!s.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},m=g=>{g.target===e&&(i.current=$b(r.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,t(c)},[])}}function $b(n){return n?.animationName||"none"}function FMe(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var nT="Checkbox",[UMe,Mje]=Ns(nT),[$Me,cM]=UMe(nT);function BMe(n){const{__scopeCheckbox:e,checked:t,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:f}=n,[m,g]=vi({prop:t,defaultProp:s??!1,onChange:l,caller:nT}),[y,b]=E.useState(null),[x,S]=E.useState(null),T=E.useRef(!1),_=y?!!a||!!y.closest("form"):!0,R={checked:m,disabled:i,setChecked:g,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:T,required:c,defaultChecked:Qc(s)?!1:s,isFormControl:_,bubbleInput:x,setBubbleInput:S};return d.jsx($Me,{scope:e,...R,children:HMe(f)?f(R):r})}var MZ="CheckboxTrigger",OZ=E.forwardRef(({__scopeCheckbox:n,onKeyDown:e,onClick:t,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:m,isFormControl:g,bubbleInput:y}=cM(MZ,n),b=$t(s,u),x=E.useRef(l);return E.useEffect(()=>{const S=i?.form;if(S){const T=()=>f(x.current);return S.addEventListener("reset",T),()=>S.removeEventListener("reset",T)}},[i,f]),d.jsx(_t.button,{type:"button",role:"checkbox","aria-checked":Qc(l)?"mixed":l,"aria-required":c,"data-state":$Z(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:r8(e,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:r8(t,S=>{f(T=>Qc(T)?!0:!T),y&&g&&(m.current=S.isPropagationStopped(),m.current||S.stopPropagation())})})});OZ.displayName=MZ;var uM=E.forwardRef((n,e)=>{const{__scopeCheckbox:t,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...f}=n;return d.jsx(BMe,{__scopeCheckbox:t,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:m})=>d.jsxs(d.Fragment,{children:[d.jsx(OZ,{...f,ref:e,__scopeCheckbox:t}),m&&d.jsx(UZ,{__scopeCheckbox:t})]})})});uM.displayName=nT;var NZ="CheckboxIndicator",jZ=E.forwardRef((n,e)=>{const{__scopeCheckbox:t,forceMount:r,...s}=n,i=cM(NZ,t);return d.jsx(PZ,{present:r||Qc(i.checked)||i.checked===!0,children:d.jsx(_t.span,{"data-state":$Z(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...n.style}})})});jZ.displayName=NZ;var FZ="CheckboxBubbleInput",UZ=E.forwardRef(({__scopeCheckbox:n,...e},t)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:f,bubbleInput:m,setBubbleInput:g}=cM(FZ,n),y=$t(t,g),b=FS(i),x=pS(r);E.useEffect(()=>{const T=m;if(!T)return;const _=window.HTMLInputElement.prototype,I=Object.getOwnPropertyDescriptor(_,"checked").set,C=!s.current;if(b!==i&&I){const L=new Event("click",{bubbles:C});T.indeterminate=Qc(i),I.call(T,Qc(i)?!1:i),T.dispatchEvent(L)}},[m,b,i,s]);const S=E.useRef(Qc(i)?!1:i);return d.jsx(_t.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??S.current,required:o,disabled:l,name:c,value:u,form:f,...e,tabIndex:-1,ref:y,style:{...e.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});UZ.displayName=FZ;function HMe(n){return typeof n=="function"}function Qc(n){return n==="indeterminate"}function $Z(n){return Qc(n)?"indeterminate":n?"checked":"unchecked"}const fL=E.forwardRef(({className:n,...e},t)=>d.jsx(uM,{ref:t,className:je("peer h-4 w-4 shrink-0 rounded-sm border border-white/30 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n),...e,children:d.jsx(jZ,{className:je("flex items-center justify-center text-current"),children:d.jsx(is,{className:"h-4 w-4"})})}));fL.displayName=uM.displayName;const VMe=({flask:n,isOpen:e,onClose:t,currentAssetIndex:r,hasEditingPermissions:s,isCreator:i,onAccessLevelChange:a})=>{const[o,l]=E.useState("Copy Link to Flask"),[c,u]=E.useState(n?.access_level||"private"),[f,m]=E.useState(!0),[g,y]=E.useState(!0),b=dn(),{filterMode:x,activeFilterIds:S}=b,T=b.isFilteringActive();ve.useEffect(()=>{u(n?.access_level||"private")},[n?.access_level]);const _=[{value:"public",Icon:Yce,title:"Anyone with Link can edit",description:"Anyone with Link can collaborate (they don't need to be part of your Flask team)"},{value:"viewonly",Icon:Kce,title:"Anyone with Link can view",description:"Anyone with Link can view, creator can edit"},{value:"private",Icon:Zce,title:"Secret",description:"Only creator view and edit."}],R=()=>{if(!n)return"";const C=new URL(window.location.href),L=new URLSearchParams(C.search);f||L.delete("asset"),g||(L.delete("includeTags"),L.delete("excludeTags"));const k=`https://flask.do/flask/${n.id}`,M=L.toString();return M?`${k}?${M}`:k},I=()=>{const C=R();!C||!n||navigator.clipboard.writeText(C).then(()=>{vbe({flask_id:n.id,share_method:"copy_link",current_visibility:"unknown",user_role:s?"editor":"viewer"})}).catch(L=>{console.error("Failed to copy link: ",L)})};return d.jsx(Zn,{open:e,onOpenChange:t,children:d.jsx(Kn,{className:"sm:max-w-md p-0",children:d.jsxs("div",{className:"p-6",children:[d.jsx(ar,{className:"mb-2",children:d.jsxs(or,{className:"flex items-center justify-between mb-4",children:[d.jsx("span",{className:"text-lg font-semibold",children:"Share this Flask"}),d.jsxs("div",{className:"button-primary flex items-center rounded-xl overflow-hidden",children:[d.jsxs("div",{onClick:()=>{I(),l("Link copied!"),setTimeout(()=>{l("Copy Link to Flask")},2e3)},className:"flex items-center justify-center px-4 py-2 cursor-pointer text-sm font-medium",children:[d.jsx(Qce,{className:"w-4 h-4 mr-2 font-semibolds"}),d.jsx("span",{children:o})]}),d.jsxs(Gs,{children:[d.jsx(qs,{asChild:!0,children:d.jsx("div",{className:"flex items-center justify-center px-2 py-2 cursor-pointer text-sm font-medium h-full border-l border-white/20",children:d.jsx(Id,{className:"w-4 h-4"})})}),d.jsx(Ms,{align:"end",className:"w-64",children:d.jsxs("div",{className:"p-2 space-y-3",children:[d.jsx("p",{className:"text-xs font-medium text-white/60 px-2",children:"Link Options"}),d.jsxs("div",{className:`flex items-center space-x-2 px-2 py-1.5 hover:bg-white/5 rounded ${T?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:[d.jsx(fL,{id:"include-filters-dropdown",checked:g,disabled:!T,onCheckedChange:C=>y(C===!0)}),d.jsxs("label",{htmlFor:"include-filters-dropdown",className:`text-sm text-white/90 ${T?"cursor-pointer":"cursor-not-allowed"}`,children:["Include Current Filters in Link",!T&&d.jsx("span",{className:"text-xs text-white/50 block",children:"(No active filters)"})]})]}),d.jsxs("div",{className:`flex items-center space-x-2 px-2 py-1.5 hover:bg-white/5 rounded ${r>0?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:[d.jsx(fL,{id:"include-asset-dropdown",checked:f,disabled:r===0,onCheckedChange:C=>m(C===!0)}),d.jsxs("label",{htmlFor:"include-asset-dropdown",className:`text-sm text-white/90 ${r>0?"cursor-pointer":"cursor-not-allowed"}`,children:["Link to this Asset",r===0&&d.jsx("span",{className:"text-xs text-white/50 block",children:"(On first asset)"})]})]})]})})]})]})]})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("p",{className:"text-sm font-medium text-white/90",children:"Flask Permissions"}),d.jsx("div",{className:"space-y-1.5",children:_.map(C=>d.jsx("button",{onClick:()=>{i&&a&&(u(C.value),a(C.value),Mr({title:"Permissions updated"}))},disabled:!i||!a,className:`w-full p-3 rounded-md transition-all text-left ${c===C.value?"bg-card-background border-b border-border/50":""} ${i&&a?"hover:bg-white/10 cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:d.jsx("div",{className:"flex items-start gap-3",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-xl text-white text-sm",children:C.title}),d.jsx("p",{className:"text-xs text-white/60",children:C.description})]})})},C.value))}),!i&&d.jsx("p",{className:"text-xs text-center text-white/50 mt-4",children:"Only the flask creator can change permissions"})]})]})})})},zMe=({hasEditingPermissions:n})=>{const{state:e,hasUnsavedChanges:t,onRetry:r}=X9(),i=ln(R=>R.activeUploads)>0,a=ln(R=>R.uploadQueue),o=ve.useMemo(()=>a.filter(R=>R.status==="failed"),[a]);ln(R=>R.retryAllFailedUploads);const l=vs(R=>R.elements),c=De(R=>R.boardState.elements),u=ve.useMemo(()=>{if(Object.keys(l).length===0)return!1;const R=Object.values(l).filter(C=>!(!c[C.id]||!(C.state==="preparing"||C.state==="uploading")||C.uploadProgress===100)),I=R.length>0;return Object.keys(l).length,R.length,I},[l,c]);ve.useEffect(()=>{},[e,t,i,u,l]);const[f,m]=ve.useState(!1),g=ve.useMemo(()=>{const R=a.filter($=>$.status==="preparing"||$.status==="uploading"||$.status==="queued"),I=a.filter($=>$.status==="processing"),C=a.filter($=>$.status!=="completed"&&$.status!=="failed").length,L=a.filter($=>$.status==="completed").length,k=a.length,M=R.reduce(($,V)=>$+V.progress,0),D=L*100,U=k>0?Math.round((M+D)/k):0;return{active:R.length,processing:I.length,total:C,progress:U}},[a]);E.useEffect(()=>{const R=e==="syncing"||e==="uploading"||i||u||o.length>0||a.length>0||e==="error"&&t,I=C=>{if(R){C.preventDefault();const L=e==="uploading"||i||u?"Video upload in progress. Leaving now will cancel the upload.":o.length>0?"You have failed uploads. Leaving now will lose these uploads.":e==="syncing"?"Save in progress. Leaving now may lose your changes.":"Your changes failed to save. Leaving now will lose your changes.";return C.returnValue=L,L}};return R&&window.addEventListener("beforeunload",I),()=>{window.removeEventListener("beforeunload",I)}},[e,t,i,u,o,a]),E.useEffect(()=>{e!=="error"&&e!=="offline"&&m(!1)},[e]);const y=async R=>{R.preventDefault(),R.stopPropagation(),m(!0);try{await r()}finally{m(!1)}};if(!n||!(a.length>0||e==="error"||e==="offline"||e==="syncing"))return null;const S=o.length>0||e==="error"||e==="offline",_=a.some(R=>R.status!=="failed"&&R.status!=="completed");return d.jsx(yi,{children:d.jsx("div",{className:"inline-flex items-center",children:d.jsxs("div",{className:`text-text-secondary text-xs flex items-center transition-all duration-200 gap-2 ${e==="error"||e==="offline"?"py-1 px-2 rounded-md border border-amber-500/50 bg-amber-900/20":_?"py-1 px-2":"w-6 h-6 justify-center rounded-full"} ${e==="syncing"||e==="uploading"||_?"text-blue-500/50":""}`,children:[_&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin h-4 w-4 rounded-full border-2 border-text-secondary border-t-transparent flex-shrink-0"}),d.jsx("div",{className:"text-[11px] text-text-secondary whitespace-nowrap",children:g.active>0?g.total>1?d.jsxs("span",{children:["Uploading ",g.progress,"% (",g.active," of ",g.total,")"]}):d.jsxs("span",{children:["Uploading ",g.progress,"%"]}):g.processing>0?g.total>1?d.jsxs("span",{children:["Processing (",g.processing," of ",g.total,")"]}):d.jsx("span",{children:"Processing"}):d.jsx("span",{children:"Uploading"})})]}),S&&!_&&d.jsxs("div",{className:"flex items-center gap-2 w-full",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(FC,{className:"h-4 w-4 text-amber-400"}),d.jsx("span",{className:"text-amber-200",children:o.length>0?"Upload failed":e==="offline"?"Offline":"Connection error"})]}),d.jsx(dt,{variant:"link",onClick:y,className:"p-0 text-amber-300 hover:text-amber-100 underline h-auto ml-4 text-xs",disabled:f,children:f?"Retrying...":"Try again"})]})]})})})},GMe=({flask:n,hasEditingPermissions:e=!1,isCreator:t=!1,onNameUpdate:r,onAccessLevelChange:s})=>{const i=r2(),[a,o]=E.useState(!1),[l,c]=E.useState(n?.name||""),[u,f]=E.useState(!1),[m,g]=E.useState(!1),[y,b]=E.useState(!1);ve.useEffect(()=>{c(n?.name||"")},[n?.name]),KV();const{user:x}=Ar(),S=De(I=>I.availableAssets),{currentAssetIndex:T}=Dd(),_=x?"/dash":"/",R=async()=>{if(!n)return;const I=l.trim();if(I){f(!0);try{await FL(n.id,{name:I})&&(o(!1),r&&r(I))}finally{f(!1)}}};return d.jsxs("div",{ref:i,className:"shared-nav w-full flex items-center justify-between pl-1 pt-0.5 md:pr-4 pr-2 -mb-4 text-white/80 transition-colors overflow-visible duration-200 z-50",children:[d.jsx("div",{className:"relative overflow-visible",children:d.jsx("div",{className:"flex items-center m-0 flex-shrink min-w-0 overflow-visible -mt-1 relative",children:n?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"outline-none transition-all duration-200 pl-3 pr-3 py-2 mt-1 rounded-full flex items-center gap-2 relative",children:[d.jsx(gs,{to:_,className:"px-1 mb-1",children:d.jsx(Jg,{size:"small"})}),d.jsx("span",{className:"mb-1 text-lg px-1 pr-2 text-text-secondary/50",children:"/"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsxs(Zn,{open:a,onOpenChange:o,children:[t?d.jsxs(Tr,{children:[d.jsx(_r,{asChild:!0,children:d.jsx(Tfe,{asChild:!0,children:d.jsx("button",{className:"h-7 text-sm element-border bg-element-background text-text-primary hover:text-text-secondary outline-none transition-all duration-200 cursor-pointer px-4 truncate max-w-[120px] sm:max-w-[180px] md:max-w-[400px] lg:max-w-[500px] text-left flex items-center",style:{borderTopLeftRadius:"18px",borderBottomLeftRadius:"18px",borderTopRightRadius:"4px",borderBottomRightRadius:"4px"},onClick:I=>{I.stopPropagation()},disabled:!t,tabIndex:t?0:-1,title:n.name||"Untitled Flask",children:n.name||"Untitled Flask"})})}),d.jsx($n,{children:d.jsx("p",{children:"Edit Flask Name"})})]}):d.jsx("span",{className:"h-7 text-sm element-border bg-element-background text-text-secondary hover:text-text-primary outline-none transition-all duration-200 cursor-default pl-3 pr-3 truncate max-w-[120px] sm:max-w-[180px] md:max-w-[400px] lg:max-w-[500px] flex items-center ",title:n.name||"Untitled Flask",children:n.name||"Untitled Flask"}),d.jsxs(Kn,{onOpenAutoFocus:I=>{I.preventDefault()},children:[d.jsx(ar,{children:d.jsx(or,{children:"Edit Flask Name"})}),d.jsx(ha,{value:l,onChange:I=>c(I.target.value),maxLength:64,autoFocus:!0,placeholder:"Flask name",onKeyDown:I=>{I.key==="Enter"&&R()},disabled:u}),d.jsxs(ys,{children:[d.jsx(dt,{variant:"default",onClick:R,disabled:u||!l.trim(),children:u?"Saving...":"Save"}),d.jsx(dt,{variant:"outline",onClick:()=>o(!1),disabled:u,children:"Cancel"})]})]})]}),S&&S.length>0&&d.jsxs(Gs,{open:y,onOpenChange:b,children:[d.jsx(qs,{asChild:!0,children:d.jsxs("button",{"data-asset-switcher-trigger":!0,className:"h-7 text-text-secondary bg-element-background element-border hover:text-text-primary outline-none transition-all duration-200 cursor-pointer flex items-center gap-1 whitespace-nowrap px-3 uppercase text-xs ",style:{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",borderTopRightRadius:"18px",borderBottomRightRadius:"18px"},children:[d.jsx("span",{className:"text-white",children:T+1}),"/",S.length,d.jsx(ZV,{className:"h-3.5 w-3.5 opacity-70 ml-1"})]})}),d.jsx(OMe,{onOpenChange:b})]})]})]}),d.jsx("div",{className:"ml-2 flex items-center",children:d.jsx(zMe,{hasEditingPermissions:e})})]}):d.jsx(gs,{to:_,title:x?"Go to My Flasks":"Flask Home",children:d.jsx(Jg,{size:"small",className:"py-3"})})})}),d.jsxs("div",{className:"flex items-center md:-mr-3 -mr-1 -mt-1 ",children:[n&&d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(yi,{delayDuration:0,children:d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("a",{href:"https://enritarta.notion.site/286abb4f34b78017ade3caa106f9ca9f?pvs=105",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center h-[30px] w-[30px] cursor-pointer transition-all duration-200 ease-out overflow-hidden button-secondary rounded-full ",children:d.jsx(nue,{className:"h-4 w-4 flex-shrink-0"})})}),d.jsx($n,{side:"bottom",children:"Feedback / Support"})]})}),d.jsx("div",{className:"h-[30px] mr-0.5 flex items-center",children:d.jsx(vk,{iconOnly:!0,fullHeightIcon:!0})})]}),n&&d.jsx(yi,{delayDuration:0,children:d.jsxs("div",{className:"flex items-center ",children:[d.jsx("div",{className:"min-h-[2rem] h-[46px] text-text-secondary outline-none transition-all duration-200 px-2 py-1.5 flex items-center gap-2",children:d.jsx("button",{className:"button-primary h-[30px] px-3.5 text-sm font-medium",onClick:()=>g(!0),children:"Share"})}),n&&d.jsx(VMe,{flask:n,isOpen:m,onClose:()=>g(!1),currentAssetIndex:T,hasEditingPermissions:e,isCreator:t,onAccessLevelChange:s})]})}),!n&&d.jsx(vk,{})]})]})};function qMe(n){const e=cn(s=>s.user),t=E.useRef(null),r=E.useRef(null);E.useEffect(()=>{if(!(!n||!e?.id))return t.current=new Date().toISOString(),r.current=setTimeout(async()=>{try{const{error:s}=await Lr.from("asset_last_seen").upsert({user_id:e.id,asset_id:n,last_seen_at:t.current},{onConflict:"user_id,asset_id"});s&&console.error("Failed to update asset last seen:",s)}catch(s){console.error("Error tracking asset access:",s)}},3e4),()=>{r.current&&clearTimeout(r.current)}},[n,e?.id])}const TR={"accent-purple":"#a78bfa","accent-blue":"#60a5fa","accent-teal":"#5eead4","accent-green":"#4ade80","accent-lime":"#bef264","accent-orange":"#fdba74","accent-red":"#f87171","accent-gray":"#a1a1aa"},jp=(n,e)=>{const t=parseInt(n.slice(1,3),16),r=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);return`rgba(${t}, ${r}, ${s}, ${e})`},_R=n=>{const e=Math.floor(n/3600),t=Math.floor(n%3600/60),r=Math.floor(n%60);return e>0?`${e}:${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${t}:${r.toString().padStart(2,"0")}`},WMe=({element:n})=>{const[e,t]=E.useState(null),[r,s]=E.useState(!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),c=E.useRef(null),u=E.useRef(null),f=De(j=>j.getElementTags),m=He(j=>j.storyboard),g=He(j=>j.getTileForTime),y=He(j=>!!j.muxPlaybackId),b=E.useMemo(()=>n.links?.find(j=>j.type==="timeline"),[n.links]);if(!b)return null;const x=b.timeRange?.start??b.timestamp??0,S=b.timeRange?.end??b.timestamp??0,T=Math.abs(S-x)<.01,_=f(n.id),R=_.length>0?_[0].color:void 0,I=jp(R&&TR[R]||"#FAFAFA",.5),L=(()=>{if(_.length===0)return{backgroundColor:jp("#E2E8F0",.4)};if(_.length===1){const H=TR[_[0].color]||"#E2E8F0";return{backgroundColor:jp(H,.7)}}const j=_.map(H=>TR[H.color]||"#E2E8F0");return{background:`linear-gradient(90deg, ${j.map((H,N)=>{const O=N/(j.length-1)*100;return`${jp(H,.7)} ${O}%`}).join(", ")})`}})();E.useEffect(()=>{if(r&&c.current){const j=c.current.getBoundingClientRect();a(j)}},[r]),E.useEffect(()=>(u.current&&clearTimeout(u.current),e===null?l(!1):u.current=setTimeout(()=>l(!0),10),()=>{u.current&&clearTimeout(u.current)}),[e]);const k=j=>{if(T){t(x);return}const q=j.currentTarget.getBoundingClientRect(),H=j.clientX-q.left,N=Math.max(0,Math.min(1,H/q.width)),O=x+N*(S-x);t(O)},M=y&&e!==null?g(e):null,D=y&&m&&M,U=e!==null?Math.floor(e):0,$=Math.floor(U/3600),V=Math.floor(U%3600/60),B=U%60,F=i?(()=>{if(!i)return{left:0,top:0,transform:"translateX(-50%) translateY(-100%)"};const j=D&&m?m.tile_width+16:150,q=D&&m?m.tile_height+60:60;let H=i.left+i.width/2,N=i.top-8,O="translateX(-50%) translateY(-100%)";H-j/2<8&&(H=8+j/2),H+j/2>window.innerWidth-8&&(H=window.innerWidth-8-j/2),N-q<8&&(N=i.bottom+8,O="translateX(-50%) translateY(0)");const z=o?0:8;return O.includes("translateY(-100%)")?O=`translateX(-50%) translateY(-100%) translateY(${z}px)`:O=`translateX(-50%) translateY(${z}px)`,{left:H,top:N,transform:O}})():null;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center justify-start gap-2 mb-2 pl-1",children:[d.jsx("div",{ref:c,className:je("relative backdrop-blur-md rounded-[8px] cursor-pointer transition-all duration-200",T?"w-4":"w-16"),style:{...L,height:"16px",borderTop:`1px solid ${I}`,boxShadow:"inset 0 0 10px rgba(255, 255, 255, 0.4), 0 4px 12px rgba(0, 0, 0, 0.5), 0 2px 6px rgba(0, 0, 0, 0.3)"},onMouseEnter:()=>{s(!0),t(x)},onMouseLeave:()=>{s(!1),t(null)},onMouseMove:k}),d.jsx("span",{className:"text-xs font-mono text-text-secondary/70",children:T?_R(x):`${_R(x)} - ${_R(S)}`})]}),r&&e!==null&&F&&Hs.createPortal(d.jsx("div",{className:"fixed pointer-events-none z-[9999]",style:{left:`${F.left}px`,top:`${F.top}px`,transform:F.transform,opacity:o?1:0,transition:"opacity 100ms ease-out, transform 100ms ease-out"},children:d.jsxs("div",{className:"flex flex-col items-center rounded-2xl overflow-hidden border element-border p-2 bg-inbetween-background text-primary shadow-md shadow-black/30",children:[D&&d.jsx("div",{className:"relative overflow-hidden rounded-xl bg-black mb-2",style:{width:`${m.tile_width}px`,height:`${m.tile_height}px`},children:d.jsx("img",{src:m.url,alt:"",className:"absolute",style:{width:`${m.spriteSheetWidth}px`,height:`${m.spriteSheetHeight}px`,objectFit:"none",objectPosition:`-${M.x}px -${M.y}px`}})}),d.jsx("div",{className:"flex items-center justify-center text-xs px-3 py-1 font-mono",children:d.jsxs("div",{className:"flex items-center",children:[$>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:$,format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"h"}),d.jsx("span",{children:":"})]}),(V>0||$>0)&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:V,format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"m"}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:B,format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{className:"opacity-60",children:"s"})]})})]})}),document.body)]})},KMe=({hasEditingPermissions:n})=>{const e=De(o=>o.boardState.elements),t=De(o=>o.isDataLoaded),r=De(o=>o.selectedFrames),s=E.useRef({}),i=E.useRef(null),a=E.useMemo(()=>Object.values(e).filter(l=>l?l.links?.some(c=>c.type==="timeline"):!1).sort((l,c)=>{const u=l.links?.find(y=>y.type==="timeline"),f=c.links?.find(y=>y.type==="timeline"),m=u?.timestamp??u?.timeRange?.start??0,g=f?.timestamp??f?.timeRange?.start??0;return m-g}),[e]);return E.useEffect(()=>{if(r.length===1&&i.current){const o=r[0],l=s.current[o];l&&l.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},[r]),t?a.length===0?d.jsx("div",{className:"sidebar-list h-full flex items-center justify-center border-r border-border bg-background",children:d.jsx("div",{className:"text-sm text-muted-foreground px-4 text-center",children:"No comments yet"})}):d.jsx("div",{ref:i,className:"sidebar-list h-full overflow-y-auto border-r border-border bg-background",children:d.jsx("div",{className:"p-4 space-y-4",children:a.map(o=>d.jsxs("div",{ref:l=>{s.current[o.id]=l},children:[d.jsx(WMe,{element:o}),d.jsx(iP,{element:o,hasEditingPermissions:n,width:280,disableAnimations:!0})]},o.id))})}):d.jsx("div",{className:"sidebar-list h-full flex items-center justify-center border-r border-border bg-background",children:d.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading..."})})},YMe=({flaskId:n,hasEditingPermissions:e,flask:t,isCreator:r,onAccessLevelChange:s,onReady:i,sharedNavProps:a})=>{const o=De(j=>j.boardState),l=De(j=>j.isDataLoaded);E.useRef(null),E.useRef(!1);const c=He(j=>j.isReady),[u,f]=E.useState(()=>typeof window>"u"?!1:new URLSearchParams(window.location.search).get("sidebargang")==="true"),[m,g]=E.useState(()=>typeof window>"u"?pU:new URLSearchParams(window.location.search).get("sidebargang")==="true"?zb:pU),y=E.useRef(null),[b,x]=E.useState(()=>window.innerWidth<768);E.useEffect(()=>{const j=()=>x(window.innerWidth<768);return window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),E.useEffect(()=>{const q=new URLSearchParams(window.location.search).get("sidebargang")==="true";f(q),q&&m!==zb&&g(zb)},[n]);const[S,T]=E.useState({width:typeof window<"u"?window.innerWidth:1920,height:typeof window<"u"?window.innerHeight*((100-m)/100):702}),_=E.useRef(null);E.useEffect(()=>{if(typeof window<"u"){const j=window.innerHeight*((100-m)/100);T(q=>({...q,height:j}))}},[m]),E.useEffect(()=>{if(_.current=null,y.current){const j=y.current.getBoundingClientRect();_.current={width:j.width,height:j.height},T({width:j.width,height:j.height})}},[n]),E.useEffect(()=>{if(!_.current&&y.current){const j=y.current.getBoundingClientRect();_.current={width:j.width,height:j.height},T({width:j.width,height:j.height})}},[]),E.useEffect(()=>{if(!y.current)return;const j=new ResizeObserver(q=>{for(const H of q){const{width:N,height:O}=H.contentRect;T({width:N,height:O}),_.current||(_.current={width:N,height:O})}});return j.observe(y.current),()=>{j.disconnect()}},[]),E.useEffect(()=>{c&&l&&i&&i()},[c,l,i]);const R=De(j=>j.currentAssetId),I=De(j=>j.availableAssets);qMe(R);const C=E.useMemo(()=>I.find(j=>j.id===R),[I,R]),L=E.useMemo(()=>C?.asset_type==="youtube"&&C.youtube_url||null,[C]),k=E.useMemo(()=>{if(C?.asset_type==="native"&&C.status==="ready")return C},[C]),M=He(j=>j.duration),D=He(j=>j.handlePlayerReady),U=He(j=>j.handleTimeUpdate),$=He(j=>j.handleDurationChange),V=He(j=>j.handlePlay),B=He(j=>j.setMediaUrl),W=He(j=>j.isMainAssetFullscreen);E.useEffect(()=>{L?B(L):k?.hls_url?B("native"):B(null)},[L,k,B]),E.useMemo(()=>{if(!M||M<=0)return gU;const j=MH.find(N=>M>=N.minDuration&&M<N.maxDuration),q=j?j.width:gU;return Object.values(o.elements).filter(N=>!N||!N.links?!1:N.links.some(O=>O&&O.type==="timeline")).length>16?Math.min(q*2,15e3):q},[M,o.elements]);const{currentAssetIndex:F}=Dd();return ve.useLayoutEffect(()=>((async()=>{De.getState().reset(),He.getState().reset(),Oc.getState().reset(),await De.getState().initializeCanvas(n,e,F,t.assets),dn.getState().initializeFromUrl()})(),()=>{De.getState().reset(),He.getState().reset(),Oc.getState().reset()}),[n,e,F,t.assets]),l?d.jsxs(mSe,{children:[d.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[!W&&a&&d.jsx(GMe,{...a}),d.jsxs("div",{className:"flex-1 flex flex-row overflow-hidden",children:[!W&&l&&!b&&u&&d.jsx("div",{className:"w-[320px] flex-shrink-0",children:d.jsx(KMe,{hasEditingPermissions:e})}),d.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[d.jsx("div",{className:"flex-shrink-0 flex items-center justify-center relative z-0",style:{...b?{}:{height:`${m}vh`},...W?{height:0,minHeight:0,overflow:"hidden"}:{}},children:d.jsx(DMe,{youtubeUrl:L,nativeAsset:k,hasEditingPermissions:e,playerHeightVh:m,onPlayerReady:D,onPlay:V,onTimeUpdate:U,onDurationChange:$,onHeightResize:g})}),!W&&l&&d.jsxs("div",{ref:y,className:"flex-1 relative",children:[d.jsx("style",{dangerouslySetInnerHTML:{__html:`
                      html, body {
                        overflow: hidden !important;
                        height: 100vh !important;
                      }
                      .vjs-youtube iframe { pointer-events: auto !important; }
                      .video-js { outline: none !important; }
                      .video-js:focus { outline: none !important; }
                    `}}),d.jsx(KAe,{flask:t,hasEditingPermissions:e,youtubeUrl:L,nativeAsset:k},`timeline-view-${n}`),d.jsx(YAe,{}),d.jsx(XAe,{})]})]})]})]}),W&&d.jsx(PMe,{youtubeUrl:L,nativeAsset:k,hasEditingPermissions:e})]}):null},XMe=({flaskId:n,hasEditingPermissions:e,flask:t,onUpdateFlaskName:r,onUpdateFlaskAccessLevel:s,onUpdateFlaskThumbnail:i,onReady:a,sharedNavProps:o})=>d.jsx(YMe,{flaskId:n,hasEditingPermissions:e,flask:t,isCreator:o?.isCreator,onAccessLevelChange:s,onReady:a,sharedNavProps:o}),QMe=()=>{const n=He(Z=>Z.togglePlayPauseContextAware),e=He(Z=>Z.seekForwardOneFrame),t=He(Z=>Z.seekBackwardOneFrame),r=He(Z=>Z.seekForwardTenFrames),s=He(Z=>Z.seekBackwardTenFrames),i=He(Z=>Z.increasePlaybackRate),a=He(Z=>Z.decreasePlaybackRate),o=He(Z=>Z.seek),l=He(Z=>Z.duration),c=He(Z=>Z.currentTime),u=De(Z=>Z.deleteElements);De(Z=>Z.setSelectedFrames);const f=De(Z=>Z.selectedFrames);De(Z=>Z.setBoardState),De(Z=>Z.deleteElementsWithConfirmation);const m=De(Z=>Z.createElementViaKeyboard),g=De(Z=>Z.clearSelection),y=De(Z=>Z.cycleToNextElement),b=De(Z=>Z.cycleToPreviousElement),x=De(Z=>Z.getClosestElementToViewportCenter);De(Z=>Z.selectElement);const S=De(Z=>Z.enterTextEditMode),T=De(Z=>Z.enterDescriptionEditMode),_=De(Z=>Z.boardState),R=yt(Z=>Z.resetZoom),I=yt(Z=>Z.zoomIn),C=yt(Z=>Z.zoomOut),L=De(Z=>Z.hasEditingPermissions),k=cn(Z=>Z.user),M=Oc(Z=>Z.shortcuts.enabled),D=Oc(Z=>Z.isInInputElement),U=Oc(Z=>Z.setInInputElement),$=Oc(Z=>Z.setSpacePressed),V=Oc(Z=>Z.setModifier),B=Oc(Z=>Z.reset),W=Kc(Z=>Z.currentTextEditElementId),F=De(Z=>Z.exitTextEditMode),j=De(Z=>Z.updateElement),q=vs(Z=>Z.globalState),H=vs(Z=>Z.activeRecordingElementId),N=vs(Z=>Z.stopRecording),O=vs(Z=>Z.cancelRecording),z=Mt(Z=>Z.state),G=Mt(Z=>Z.replyToolbar.state),Y=Mt(Z=>!!Z.replyToolbar.threadId),Q=E.useRef(!1),J=E.useCallback(Z=>{if(!Z)return!1;const pe=Z instanceof HTMLInputElement||Z instanceof HTMLTextAreaElement||Z instanceof HTMLElement&&Z.isContentEditable;return U(pe),pe},[U]),ee=E.useCallback(Z=>{const pe=document.querySelector(`[data-element-id="${Z}"] textarea`),ye=document.querySelector(`[data-element-id="${Z}"] [contenteditable]`);if(pe){const ae=pe.value;pe.blur(),j(Z,{content:ae})}else if(ye){const ae=ye.textContent||ye.innerText||"";ye.blur();const le=window.getSelection();le&&le.removeAllRanges(),j(Z,{content:ae})}F()},[j,F]),oe=E.useCallback(Z=>{const pe=document.querySelector(`[data-element-id="${Z}"] textarea`),ye=document.querySelector(`[data-element-id="${Z}"] [contenteditable]`),ae=_o.getState().originalTextContent;if(ae!==null&&j(Z,{content:ae}),pe)pe.blur();else if(ye){ye.blur();const le=window.getSelection();le&&le.removeAllRanges()}F()},[j,F]),te=E.useCallback(async()=>{if(f.length===0)return;f.find(pe=>pe===H&&q==="recording")?O():u(f)},[f,H,q,O,u]),se=E.useCallback(Z=>{if(!M)return;V("ctrl",Z.ctrlKey),V("alt",Z.altKey),V("shift",Z.shiftKey),V("meta",Z.metaKey);const pe=Z.metaKey||Z.ctrlKey,ye=Z.altKey;if(pe||ye)return;if(Z.code==="Enter"){if(document.querySelector('[role="dialog"]'))return;if(z==="recording"){Z.preventDefault();const ie=document.querySelector("[data-toolbar-stop-btn]");ie&&ie.click();return}if(G==="recording"){Z.preventDefault();const ie=document.querySelector("[data-reply-toolbar-stop-btn]");ie&&ie.click();return}if(q==="recording"&&H){Z.preventDefault(),N();return}if(W){if(Z.shiftKey)return;Z.preventDefault(),ee(W);return}if(f.length>0&&L){if(D||z==="draft"||G==="draft")return;const ie=f[0],fe=_.elements[ie];if(fe&&!fe.links?.some(Ie=>Ie.type==="element")){Z.preventDefault();const Ie=yt.getState();Ie.enableThreadScrollOnHover(ie),Mt.getState().setReplyThreadId(ie),Mt.getState().enterReplyFocusedState(ie),setTimeout(()=>{Ie.scrollThreadToBottom(ie),Ie.notifyThreadHeightChanged(ie)},50);return}}}if(Z.code==="Escape"){if(document.querySelector('[role="dialog"]'))return;if(z==="recording"){Z.preventDefault();const ie=document.querySelector("[data-toolbar-cancel-btn]");ie&&ie.click();return}if(G==="recording"){Z.preventDefault();const ie=document.querySelector("[data-reply-toolbar-cancel-btn]");ie&&ie.click();return}if(q==="recording"&&H){Z.preventDefault(),O();return}if(W){Z.preventDefault(),oe(W);return}if(z==="draft"){Z.preventDefault();const ie=document.querySelector("[data-toolbar-textbox]");ie&&ie.blur(),Ze(async()=>{const{useToolbarStore:fe}=await Promise.resolve().then(()=>di);return{useToolbarStore:fe}},void 0).then(({useToolbarStore:fe})=>{const{exitToIdle:Ie,setTextContent:ne,exitElementLinking:ce}=fe.getState();ne(""),Ie(),ce()});return}if(G==="draft"){Z.preventDefault();const ie=document.querySelector("[data-reply-toolbar-textbox]");ie&&ie.blur(),Ze(async()=>{const{useToolbarStore:fe}=await Promise.resolve().then(()=>di);return{useToolbarStore:fe}},void 0).then(({useToolbarStore:fe})=>{const{exitReplyToIdle:Ie,setReplyTextContent:ne}=fe.getState();ne(""),Ie()});return}if(f.length>0){Z.preventDefault(),g();return}}const ae=J(Z.target);if(!W&&!ae)switch(Z.code){case"Space":case"KeyK":Z.code==="Space"&&$(!0),Z.preventDefault(),n();return;case"KeyJ":Z.preventDefault(),a();return;case"KeyL":Z.preventDefault(),i();return;case"ArrowLeft":if(Z.preventDefault(),Z.shiftKey)t();else{const fe=Math.max(0,c-5);o(fe)}return;case"ArrowRight":if(Z.preventDefault(),Z.shiftKey)e();else{const fe=Math.min(l,c+5);o(fe)}return;case"ArrowUp":if(f.length===1){Z.preventDefault();const fe=f[0],ne=De.getState().findRootElementInThread(fe);ne&&yt.getState().scrollThreadToTop(ne);return}return;case"ArrowDown":if(f.length===1){Z.preventDefault();const fe=f[0],ne=De.getState().findRootElementInThread(fe);ne&&yt.getState().scrollThreadToBottom(ne);return}return;case"Tab":if(Z.preventDefault(),Z.shiftKey)b();else{const Ie=yt.getState().timelineScale>1;if(f.length===0&&Ie){const ce=x();ce&&o0(ce)}else y()}return;case"KeyZ":Z.preventDefault(),R();return;case"Equal":case"NumpadAdd":Z.preventDefault(),I();return;case"Minus":case"NumpadSubtract":Z.preventDefault(),C();return;case"KeyE":if(!k||!L)return;if(Z.preventDefault(),f.length===1){const fe=f[0],Ie=_.elements[fe];if(Ie){if(Ie.createdBy!==k.id)return;Ie.type==="text"?S(fe):Ie.type==="recording"&&T(fe)}}return;case"Backspace":case"Delete":Z.preventDefault(),te();return;case"KeyC":if(!k||!L)return;Z.preventDefault(),Y?Ze(async()=>{const{useToolbarStore:fe}=await Promise.resolve().then(()=>di);return{useToolbarStore:fe}},void 0).then(({useToolbarStore:fe})=>{fe.getState().focusTextbox("reply")}):Ze(async()=>{const{useToolbarStore:fe}=await Promise.resolve().then(()=>di);return{useToolbarStore:fe}},void 0).then(({useToolbarStore:fe})=>{fe.getState().focusTextbox("timeline")});return;case"KeyS":if(!k||!L)return;Z.preventDefault();const le=document.querySelector("[data-toolbar-screen-btn]");le&&le.click();return;case"KeyR":if(!k||!L)return;Z.preventDefault();const ie=document.querySelector("[data-toolbar-thoughts-btn]");ie&&ie.click();return}},[M,V,q,H,N,z,G,Y,W,y,b,R,I,C,ee,oe,J,$,n,i,a,e,t,r,s,o,l,c,te,m,k,L,g,f,O,S,T,_]),he=E.useCallback(Z=>{M&&(V("ctrl",Z.ctrlKey),V("alt",Z.altKey),V("shift",Z.shiftKey),V("meta",Z.metaKey),Z.code==="Space"&&$(!1))},[M,V,$]);return E.useEffect(()=>{if(!(!M||Q.current))return window.addEventListener("keydown",se),window.addEventListener("keyup",he),Q.current=!0,()=>{window.removeEventListener("keydown",se),window.removeEventListener("keyup",he),Q.current=!1,B()}},[M,se,he,B,k,L]),E.useEffect(()=>{!M&&Q.current&&(window.removeEventListener("keydown",se),window.removeEventListener("keyup",he),Q.current=!1,B())},[M,se,he,B]),{shortcuts:[{key:"Enter",description:W?"Save text and exit edit mode":q==="recording"?"Stop recording":"Context-dependent action"},{key:"Shift+Enter",description:W?"New line in text":"Not available"},{key:"Escape",description:W?"Save text and exit edit mode":f.length>0?"Clear selection":"Exit current mode"},{key:"Space",description:"Play/pause media"},{key:"Left Arrow",description:"Go back 5 seconds"},{key:"Right Arrow",description:"Go forward 5 seconds"},{key:"Shift+Left Arrow",description:"Go back 1 frame"},{key:"Shift+Right Arrow",description:"Go forward 1 frame"},{key:"Tab",description:"Cycle to next timeline element"},{key:"Shift+Tab",description:"Cycle to previous timeline element"},{key:"Z",description:"Reset zoom to 1x"},{key:"E",description:"Edit selected element"},{key:"Backspace/Delete",description:"Delete selected elements"},{key:"C",description:"Create new Note element"},{key:"S",description:"Create new Screen recording element"},{key:"R",description:"Create new Thoughts recording element"}]}},ZMe=E.createContext(void 0),JMe=({children:n})=>{const{user:e,profile:t,isLoading:r,signInWithGoogle:s,signOut:i,fetchProfile:a}=cn(),[o,l]=E.useState(!1);E.useEffect(()=>{(async()=>{await cn.getState().initialize(),l(!0)})()},[]);const c={user:e,profile:t,isLoading:r||!o,isAuthenticated:!!e,signInWithGoogle:s,signOut:i,refreshProfile:async()=>{await a(e?.id||"")}};return d.jsx(ZMe.Provider,{value:c,children:n})},eOe=({flaskName:n})=>{const[e,t]=E.useState(!1),[r,s]=E.useState(!1);return E.useEffect(()=>{if(n){const i=setTimeout(()=>s(!0),50);return()=>clearTimeout(i)}},[n]),d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        @keyframes progress-bar {
          0% {
            transform: translateX(-100%);
          }
          100% {
            transform: translateX(100%);
          }
        }
        .progress-bar {
          animation: progress-bar 1.5s ease-in-out infinite;
        }

        @keyframes flask-shake {
          0%, 100% {
            transform: rotate(0deg);
          }
          10% {
            transform: rotate(-8deg);
          }
          20% {
            transform: rotate(8deg);
          }
          30% {
            transform: rotate(-8deg);
          }
          40% {
            transform: rotate(8deg);
          }
          50% {
            transform: rotate(-4deg);
          }
          60% {
            transform: rotate(4deg);
          }
          70% {
            transform: rotate(0deg);
          }
        }

        .flask-shake-animation {
          animation: flask-shake 2s ease-in-out infinite 1s;
        }

        @keyframes fade-in-up {
          from {
            opacity: 0;
            transform: translateY(1rem);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .fade-in-up {
          animation: fade-in-up 0.6s ease-out forwards;
        }

        .fade-in-and-shake {
          animation: fade-in-up 0.6s ease-out forwards, flask-shake 2s ease-in-out infinite 0.1s;
        }

        .fade-in-delayed {
          opacity: 0;
          animation: fade-in-up 0.4s ease-out forwards;
        }
      `}),d.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[d.jsxs("div",{className:"flex flex-col items-center gap-8",children:[d.jsxs("div",{className:"flex h-[128px] items-center mb-1 relative",children:[d.jsx("p",{className:"text-text-primary/85 text-bold tracking-[-0.075em] text-[64px] font-bold fade-in-up relative z-0",children:"Flask"}),d.jsx("img",{src:"/images/flasklogo.png",alt:"Flask Logo",className:`h-[128px] object-contain absolute left-6 mb-0 z-10 ${e?"opacity-90 fade-in-and-shake":"opacity-0"}`,onLoad:()=>t(!0)})]}),d.jsx("div",{className:"w-48 h-1 bg-text-primary/30 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full w-1/3 bg-text-primary/60 rounded-full progress-bar"})})]}),d.jsx("div",{className:"absolute top-8 left-0 right-0 flex justify-center h-8",children:n&&r&&d.jsxs("p",{className:"text-text-secondary text-xs font-medium fade-in-delayed",children:[d.jsx("span",{className:"text-text-primary",children:"Opening Flask "}),"    ",n]})})]})]})},tOe=()=>{const{id:n}=F8();Jn();const[e,t]=Cd(),r=nH(),{user:s,signInWithGoogle:i,isLoading:a}=Ar();jbe(),QMe();const{data:o,isLoading:l,error:c}=gbe(n),[u,f]=E.useState(o?.flask||null),[m,g]=E.useState(0),[y,b]=E.useState(!1),[x,S]=E.useState(()=>window.innerWidth<768),[T,_]=E.useState(!0),[R,I]=E.useState(!1),[C,L]=E.useState(!1);ve.useEffect(()=>{o?.flask&&f(o.flask)},[o?.flask]),E.useEffect(()=>{o?.flask&&n&&(s?Yt.capture("flask_opened",{flask_id:n,flask_name:o.flask.name,access_level:o.flask.access_level,has_edit_access:o.hasEditAccess,is_owner:o.isOwner}):Yt.capture("flask_viewed_anonymous",{flask_id:n,flask_name:o.flask.name,access_level:o.flask.access_level}))},[o?.flask,n,s]),E.useEffect(()=>{const q=e.get("asset");if(q&&o?.flask?.assets){const H=parseInt(q,10),N=o.flask.assets.length;!isNaN(H)&&H>0&&H<=N?g(H-1):(g(0),q&&(e.delete("asset"),t(e,{replace:!0})))}else g(0)},[e,o?.flask?.assets,t]),E.useEffect(()=>{const q=()=>S(window.innerWidth<768);return window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]),E.useEffect(()=>{if(x&&o?.flask){const q=setTimeout(()=>{b(!0)},2e3);return()=>clearTimeout(q)}},[x,!!o?.flask]),ve.useEffect(()=>(u?.name?document.title=`${u.name} | Flask`:document.title="Flask",()=>{document.title="Flask"}),[u?.name]);const k=E.useCallback(async()=>{try{const q=window.location.pathname;await i(q)}catch(q){console.error("Google auth error:",q),et.error("Authentication failed. Please try again.")}},[i]),M=E.useCallback(q=>{f(H=>H?{...H,name:q}:null)},[]),D=E.useCallback(q=>{g(q),q===0?e.delete("asset"):e.set("asset",String(q+1)),t(e,{replace:!0})},[e,t]),U=E.useCallback(async q=>{const H=o?.flask,N=o?.hasEditAccess;if(!(!H||!N))try{await FL(H.id,{access_level:q}),f(O=>O?{...O,access_level:q}:null),r.invalidateQueries({queryKey:["flask-access",n]}),et.success(`Flask is now ${q}`)}catch{et.error("Failed to update access level")}},[o,n,r]),$=a||l||!o,V=o?.flask,B=o?.hasEditAccess||!1,W=o?.isOwner||!1,F=E.useCallback(()=>{I(!0),setTimeout(()=>{L(!0),setTimeout(()=>_(!1),1e3)},500)},[]),j=ve.useMemo(()=>({flask:u,hasEditingPermissions:B,isCreator:W,onNameUpdate:M,onAccessLevelChange:U}),[u,B,W,M,U]);return!$&&o?.error?d.jsx(J$,{error:o.error,accessLevel:o.accessLevel,onSignIn:k}):!$&&!V?d.jsx(J$,{error:"not-found",onSignIn:k}):d.jsxs(JMe,{children:[V&&d.jsx(Rz,{...Ade(V.name,n)}),T&&d.jsx("div",{className:`fixed inset-0 z-[100] bg-card-background transition-transform duration-1000 ease-in-out ${C?"transform -translate-y-full":"transform translate-y-0"}`,children:d.jsx(eOe,{flaskName:V?.name})}),(V||$)&&d.jsxs(awe,{flask:u||V,flaskId:n,hasEditingPermissions:B,isCreator:W,accessLevel:V?.access_level||null,onUpdateFlaskName:M,onUpdateFlaskAccessLevel:U,onUpdateFlaskThumbnail:()=>{},currentAssetIndex:m,onAssetChange:D,children:[d.jsx("div",{className:"h-screen overflow-hidden text-white",children:V&&d.jsx(DD,{delayDuration:0,children:d.jsx(XMe,{flaskId:n,hasEditingPermissions:B,flask:V,onUpdateFlaskName:M,onUpdateFlaskAccessLevel:U,onUpdateFlaskThumbnail:()=>{},onReady:F,sharedNavProps:j},n)})}),d.jsx(W9,{isOpen:y,onClose:()=>b(!1)})]})]})};function nOe(){return d.jsx(tOe,{})}const rs=E.forwardRef(({className:n,...e},t)=>d.jsx("div",{ref:t,className:je("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));rs.displayName="Card";const hi=E.forwardRef(({className:n,...e},t)=>d.jsx("div",{ref:t,className:je("flex flex-col space-y-1.5 p-6",n),...e}));hi.displayName="CardHeader";const Pi=E.forwardRef(({className:n,...e},t)=>d.jsx("h3",{ref:t,className:je("text-2xl font-semibold leading-none tracking-tight",n),...e}));Pi.displayName="CardTitle";const $a=E.forwardRef(({className:n,...e},t)=>d.jsx("p",{ref:t,className:je("text-sm text-muted-foreground",n),...e}));$a.displayName="CardDescription";const ss=E.forwardRef(({className:n,...e},t)=>d.jsx("div",{ref:t,className:je("p-6 pt-0",n),...e}));ss.displayName="CardContent";const mL=E.forwardRef(({className:n,...e},t)=>d.jsx("div",{ref:t,className:je("flex items-center p-6 pt-0",n),...e}));mL.displayName="CardFooter";function $g(n){let e=n[0],t=n[1],r=n[2];return Math.sqrt(e*e+t*t+r*r)}function pL(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function rOe(n,e,t,r){return n[0]=e,n[1]=t,n[2]=r,n}function s8(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function i8(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function sOe(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function iOe(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function AR(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function aOe(n,e){let t=e[0]-n[0],r=e[1]-n[1],s=e[2]-n[2];return Math.sqrt(t*t+r*r+s*s)}function oOe(n,e){let t=e[0]-n[0],r=e[1]-n[1],s=e[2]-n[2];return t*t+r*r+s*s}function a8(n){let e=n[0],t=n[1],r=n[2];return e*e+t*t+r*r}function lOe(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function cOe(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function gL(n,e){let t=e[0],r=e[1],s=e[2],i=t*t+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function BZ(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function o8(n,e,t){let r=e[0],s=e[1],i=e[2],a=t[0],o=t[1],l=t[2];return n[0]=s*l-i*o,n[1]=i*a-r*l,n[2]=r*o-s*a,n}function uOe(n,e,t,r){let s=e[0],i=e[1],a=e[2];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n[2]=a+r*(t[2]-a),n}function dOe(n,e,t,r,s){const i=Math.exp(-r*s);let a=e[0],o=e[1],l=e[2];return n[0]=t[0]+(a-t[0])*i,n[1]=t[1]+(o-t[1])*i,n[2]=t[2]+(l-t[2])*i,n}function hOe(n,e,t){let r=e[0],s=e[1],i=e[2],a=t[3]*r+t[7]*s+t[11]*i+t[15];return a=a||1,n[0]=(t[0]*r+t[4]*s+t[8]*i+t[12])/a,n[1]=(t[1]*r+t[5]*s+t[9]*i+t[13])/a,n[2]=(t[2]*r+t[6]*s+t[10]*i+t[14])/a,n}function fOe(n,e,t){let r=e[0],s=e[1],i=e[2],a=t[3]*r+t[7]*s+t[11]*i+t[15];return a=a||1,n[0]=(t[0]*r+t[4]*s+t[8]*i)/a,n[1]=(t[1]*r+t[5]*s+t[9]*i)/a,n[2]=(t[2]*r+t[6]*s+t[10]*i)/a,n}function mOe(n,e,t){let r=e[0],s=e[1],i=e[2];return n[0]=r*t[0]+s*t[3]+i*t[6],n[1]=r*t[1]+s*t[4]+i*t[7],n[2]=r*t[2]+s*t[5]+i*t[8],n}function pOe(n,e,t){let r=e[0],s=e[1],i=e[2],a=t[0],o=t[1],l=t[2],c=t[3],u=o*i-l*s,f=l*r-a*i,m=a*s-o*r,g=o*m-l*f,y=l*u-a*m,b=a*f-o*u,x=c*2;return u*=x,f*=x,m*=x,g*=2,y*=2,b*=2,n[0]=r+u+g,n[1]=s+f+y,n[2]=i+m+b,n}const gOe=function(){const n=[0,0,0],e=[0,0,0];return function(t,r){pL(n,t),pL(e,r),gL(n,n),gL(e,e);let s=BZ(n,e);return s>1?0:s<-1?Math.PI:Math.acos(s)}}();function vOe(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}class Va extends Array{constructor(e=0,t=e,r=e){return super(e,t,r),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,t=e,r=e){return e.length?this.copy(e):(rOe(this,e,t,r),this)}copy(e){return pL(this,e),this}add(e,t){return t?s8(this,e,t):s8(this,this,e),this}sub(e,t){return t?i8(this,e,t):i8(this,this,e),this}multiply(e){return e.length?sOe(this,this,e):AR(this,this,e),this}divide(e){return e.length?iOe(this,this,e):AR(this,this,1/e),this}inverse(e=this){return cOe(this,e),this}len(){return $g(this)}distance(e){return e?aOe(this,e):$g(this)}squaredLen(){return a8(this)}squaredDistance(e){return e?oOe(this,e):a8(this)}negate(e=this){return lOe(this,e),this}cross(e,t){return t?o8(this,e,t):o8(this,this,e),this}scale(e){return AR(this,this,e),this}normalize(){return gL(this,this),this}dot(e){return BZ(this,e)}equals(e){return vOe(this,e)}applyMatrix3(e){return mOe(this,this,e),this}applyMatrix4(e){return hOe(this,this,e),this}scaleRotateMatrix4(e){return fOe(this,this,e),this}applyQuaternion(e){return pOe(this,this,e),this}angle(e){return gOe(this,e)}lerp(e,t){return uOe(this,this,e,t),this}smoothLerp(e,t,r){return dOe(this,this,e,t,r),this}clone(){return new Va(this[0],this[1],this[2])}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}transformDirection(e){const t=this[0],r=this[1],s=this[2];return this[0]=e[0]*t+e[4]*r+e[8]*s,this[1]=e[1]*t+e[5]*r+e[9]*s,this[2]=e[2]*t+e[6]*r+e[10]*s,this.normalize()}}const l8=new Va;let yOe=1,bOe=1,c8=!1;class xOe{constructor(e,t={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=t,this.id=yOe++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let r in t)this.addAttribute(r,t[r])}addAttribute(e,t){if(this.attributes[e]=t,t.id=bOe++,t.size=t.size||1,t.type=t.type||(t.data.constructor===Float32Array?this.gl.FLOAT:t.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),t.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,t.normalized=t.normalized||!1,t.stride=t.stride||0,t.offset=t.offset||0,t.count=t.count||(t.stride?t.data.byteLength/t.stride:t.data.length/t.size),t.divisor=t.instanced||0,t.needsUpdate=!1,t.usage=t.usage||this.gl.STATIC_DRAW,t.buffer||this.updateAttribute(t),t.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==t.count*t.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,t.count*t.divisor);this.instancedCount=t.count*t.divisor}else e==="index"?this.drawRange.count=t.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,t.count))}updateAttribute(e){const t=!e.buffer;t&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),t?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((t,{name:r,type:s})=>{if(!this.attributes[r]){console.warn(`active attribute ${r} not being supplied`);return}const i=this.attributes[r];this.gl.bindBuffer(i.target,i.buffer),this.glState.boundBuffer=i.buffer;let a=1;s===35674&&(a=2),s===35675&&(a=3),s===35676&&(a=4);const o=i.size/a,l=a===1?0:a*a*4,c=a===1?0:a*4;for(let u=0;u<a;u++)this.gl.vertexAttribPointer(t+u,o,i.type,i.normalized,i.stride+l,i.offset+u*c),this.gl.enableVertexAttribArray(t+u),this.gl.renderer.vertexAttribDivisor(t+u,i.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:t=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((s,{name:i})=>{const a=this.attributes[i];a.needsUpdate&&this.updateAttribute(a)});let r=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(r=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*r,this.instancedCount):this.gl.renderer.drawArraysInstanced(t,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*r):this.gl.drawArrays(t,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!c8)return console.warn("No position buffer data found to compute bounds"),c8=!0}computeBoundingBox(e){e||(e=this.getPosition());const t=e.data,r=e.size;this.bounds||(this.bounds={min:new Va,max:new Va,center:new Va,scale:new Va,radius:1/0});const s=this.bounds.min,i=this.bounds.max,a=this.bounds.center,o=this.bounds.scale;s.set(1/0),i.set(-1/0);for(let l=0,c=t.length;l<c;l+=r){const u=t[l],f=t[l+1],m=t[l+2];s.x=Math.min(u,s.x),s.y=Math.min(f,s.y),s.z=Math.min(m,s.z),i.x=Math.max(u,i.x),i.y=Math.max(f,i.y),i.z=Math.max(m,i.z)}o.sub(i,s),a.add(s,i).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const t=e.data,r=e.size;this.bounds||this.computeBoundingBox(e);let s=0;for(let i=0,a=t.length;i<a;i+=r)l8.fromArray(t,i),s=Math.max(s,this.bounds.center.squaredDistance(l8));this.bounds.radius=Math.sqrt(s)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let wOe=1;const u8={};class EOe{constructor(e,{vertex:t,fragment:r,uniforms:s={},transparent:i=!1,cullFace:a=e.BACK,frontFace:o=e.CCW,depthTest:l=!0,depthWrite:c=!0,depthFunc:u=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=s,this.id=wOe++,t||console.warn("vertex shader not supplied"),r||console.warn("fragment shader not supplied"),this.transparent=i,this.cullFace=a,this.frontFace=o,this.depthTest=l,this.depthWrite=c,this.depthFunc=u,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:t,fragment:r})}setShaders({vertex:e,fragment:t}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${d8(e)}`)),t&&(this.gl.shaderSource(this.fragmentShader,t),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${d8(t)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let r=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let a=0;a<r;a++){let o=this.gl.getActiveUniform(this.program,a);this.uniformLocations.set(o,this.gl.getUniformLocation(this.program,o.name));const l=o.name.match(/(\w+)/g);o.uniformName=l[0],o.nameComponents=l.slice(1)}this.attributeLocations=new Map;const s=[],i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let a=0;a<i;a++){const o=this.gl.getActiveAttrib(this.program,a),l=this.gl.getAttribLocation(this.program,o.name);l!==-1&&(s[l]=o.name,this.attributeLocations.set(o,l))}this.attributeOrder=s.join("")}setBlendFunc(e,t,r,s){this.blendFunc.src=e,this.blendFunc.dst=t,this.blendFunc.srcAlpha=r,this.blendFunc.dstAlpha=s,e&&(this.transparent=!0)}setBlendEquation(e,t){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=t}setStencilFunc(e,t,r){this.stencilRef=t,this.stencilFunc.func=e,this.stencilFunc.ref=t,this.stencilFunc.mask=r}setStencilOp(e,t,r){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=t,this.stencilOp.depthPass=r}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let t=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((s,i)=>{let a=this.uniforms[i.uniformName];for(const o of i.nameComponents){if(!a)break;if(o in a)a=a[o];else{if(Array.isArray(a.value))break;a=void 0;break}}if(!a)return h8(`Active uniform ${i.name} has not been supplied`);if(a&&a.value===void 0)return h8(`${i.name} uniform is missing a value parameter`);if(a.value.texture)return t=t+1,a.value.update(t),RR(this.gl,i.type,s,t);if(a.value.length&&a.value[0].texture){const o=[];return a.value.forEach(l=>{t=t+1,l.update(t),o.push(t)}),RR(this.gl,i.type,s,o)}RR(this.gl,i.type,s,a.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function RR(n,e,t,r){r=r.length?SOe(r):r;const s=n.renderer.state.uniformLocations.get(t);if(r.length)if(s===void 0||s.length!==r.length)n.renderer.state.uniformLocations.set(t,r.slice(0));else{if(TOe(s,r))return;s.set?s.set(r):_Oe(s,r),n.renderer.state.uniformLocations.set(t,s)}else{if(s===r)return;n.renderer.state.uniformLocations.set(t,r)}switch(e){case 5126:return r.length?n.uniform1fv(t,r):n.uniform1f(t,r);case 35664:return n.uniform2fv(t,r);case 35665:return n.uniform3fv(t,r);case 35666:return n.uniform4fv(t,r);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return r.length?n.uniform1iv(t,r):n.uniform1i(t,r);case 35671:case 35667:return n.uniform2iv(t,r);case 35672:case 35668:return n.uniform3iv(t,r);case 35673:case 35669:return n.uniform4iv(t,r);case 35674:return n.uniformMatrix2fv(t,!1,r);case 35675:return n.uniformMatrix3fv(t,!1,r);case 35676:return n.uniformMatrix4fv(t,!1,r)}}function d8(n){let e=n.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function SOe(n){const e=n.length,t=n[0].length;if(t===void 0)return n;const r=e*t;let s=u8[r];s||(u8[r]=s=new Float32Array(r));for(let i=0;i<e;i++)s.set(n[i],i*t);return s}function TOe(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function _Oe(n,e){for(let t=0,r=n.length;t<r;t++)n[t]=e[t]}let CR=0;function h8(n){CR>100||(console.warn(n),CR++,CR>100&&console.warn("More than 100 program warnings - stopping logs."))}const kR=new Va;let AOe=1;class ROe{constructor({canvas:e=document.createElement("canvas"),width:t=300,height:r=150,dpr:s=1,alpha:i=!1,depth:a=!0,stencil:o=!1,antialias:l=!1,premultipliedAlpha:c=!1,preserveDrawingBuffer:u=!1,powerPreference:f="default",autoClear:m=!0,webgl:g=2}={}){const y={alpha:i,depth:a,stencil:o,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:f};this.dpr=s,this.alpha=i,this.color=!0,this.depth=a,this.stencil=o,this.premultipliedAlpha=c,this.autoClear=m,this.id=AOe++,g===2&&(this.gl=e.getContext("webgl2",y)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",y)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(t,r),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,t){this.width=e,this.height=t,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=t*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:t+"px"})}setViewport(e,t,r=0,s=0){this.state.viewport.width===e&&this.state.viewport.height===t||(this.state.viewport.width=e,this.state.viewport.height=t,this.state.viewport.x=r,this.state.viewport.y=s,this.gl.viewport(r,s,e,t))}setScissor(e,t,r=0,s=0){this.gl.scissor(r,s,e,t)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,t,r,s){this.state.blendFunc.src===e&&this.state.blendFunc.dst===t&&this.state.blendFunc.srcAlpha===r&&this.state.blendFunc.dstAlpha===s||(this.state.blendFunc.src=e,this.state.blendFunc.dst=t,this.state.blendFunc.srcAlpha=r,this.state.blendFunc.dstAlpha=s,r!==void 0?this.gl.blendFuncSeparate(e,t,r,s):this.gl.blendFunc(e,t))}setBlendEquation(e,t){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===t)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=t,t!==void 0?this.gl.blendEquationSeparate(e,t):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,t,r){this.state.stencilFunc===e&&this.state.stencilRef===t&&this.state.stencilFuncMask===r||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=t||0,this.state.stencilFuncMask=r||0,this.gl.stencilFunc(e||this.gl.ALWAYS,t||0,r||0))}setStencilOp(e,t,r){this.state.stencilFail===e&&this.state.stencilDepthFail===t&&this.state.stencilDepthPass===r||(this.state.stencilFail=e,this.state.stencilDepthFail=t,this.state.stencilDepthPass=r,this.gl.stencilOp(e,t,r))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:t=null}={}){this.state.framebuffer!==t&&(this.state.framebuffer=t,this.gl.bindFramebuffer(e,t))}getExtension(e,t,r){return t&&this.gl[t]?this.gl[t].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),t?this.extensions[e]?this.extensions[e][r].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:e.zDepth!==t.zDepth?e.zDepth-t.zDepth:t.id-e.id}sortTransparent(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.zDepth!==t.zDepth?t.zDepth-e.zDepth:t.id-e.id}sortUI(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:t.id-e.id}getRenderList({scene:e,camera:t,frustumCull:r,sort:s}){let i=[];if(t&&r&&t.updateFrustum(),e.traverse(a=>{if(!a.visible)return!0;a.draw&&(r&&a.frustumCulled&&t&&!t.frustumIntersectsMesh(a)||i.push(a))}),s){const a=[],o=[],l=[];i.forEach(c=>{c.program.transparent?c.program.depthTest?o.push(c):l.push(c):a.push(c),c.zDepth=0,!(c.renderOrder!==0||!c.program.depthTest||!t)&&(c.worldMatrix.getTranslation(kR),kR.applyMatrix4(t.projectionViewMatrix),c.zDepth=kR.z)}),a.sort(this.sortOpaque),o.sort(this.sortTransparent),l.sort(this.sortUI),i=a.concat(o,l)}return i}render({scene:e,camera:t,target:r=null,update:s=!0,sort:i=!0,frustumCull:a=!0,clear:o}){r===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(r),this.setViewport(r.width,r.height)),(o||this.autoClear&&o!==!1)&&(this.depth&&(!r||r.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!r||r.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),s&&e.updateMatrixWorld(),t&&t.updateMatrixWorld(),this.getRenderList({scene:e,camera:t,frustumCull:a,sort:i}).forEach(c=>{c.draw({camera:t})})}}function COe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function kOe(n,e,t,r,s){return n[0]=e,n[1]=t,n[2]=r,n[3]=s,n}function IOe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=t*t+r*r+s*s+i*i;return a>0&&(a=1/Math.sqrt(a)),n[0]=t*a,n[1]=r*a,n[2]=s*a,n[3]=i*a,n}function LOe(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function DOe(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function POe(n,e,t){t=t*.5;let r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function f8(n,e,t){let r=e[0],s=e[1],i=e[2],a=e[3],o=t[0],l=t[1],c=t[2],u=t[3];return n[0]=r*u+a*o+s*c-i*l,n[1]=s*u+a*l+i*o-r*c,n[2]=i*u+a*c+r*l-s*o,n[3]=a*u-r*o-s*l-i*c,n}function MOe(n,e,t){t*=.5;let r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return n[0]=r*l+a*o,n[1]=s*l+i*o,n[2]=i*l-s*o,n[3]=a*l-r*o,n}function OOe(n,e,t){t*=.5;let r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return n[0]=r*l-i*o,n[1]=s*l+a*o,n[2]=i*l+r*o,n[3]=a*l-s*o,n}function NOe(n,e,t){t*=.5;let r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return n[0]=r*l+s*o,n[1]=s*l-r*o,n[2]=i*l+a*o,n[3]=a*l-i*o,n}function jOe(n,e,t,r){let s=e[0],i=e[1],a=e[2],o=e[3],l=t[0],c=t[1],u=t[2],f=t[3],m,g,y,b,x;return g=s*l+i*c+a*u+o*f,g<0&&(g=-g,l=-l,c=-c,u=-u,f=-f),1-g>1e-6?(m=Math.acos(g),y=Math.sin(m),b=Math.sin((1-r)*m)/y,x=Math.sin(r*m)/y):(b=1-r,x=r),n[0]=b*s+x*l,n[1]=b*i+x*c,n[2]=b*a+x*u,n[3]=b*o+x*f,n}function FOe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=t*t+r*r+s*s+i*i,o=a?1/a:0;return n[0]=-t*o,n[1]=-r*o,n[2]=-s*o,n[3]=i*o,n}function UOe(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function $Oe(n,e){let t=e[0]+e[4]+e[8],r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);let i=(s+1)%3,a=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[i*3+i]-e[a*3+a]+1),n[s]=.5*r,r=.5/r,n[3]=(e[i*3+a]-e[a*3+i])*r,n[i]=(e[i*3+s]+e[s*3+i])*r,n[a]=(e[a*3+s]+e[s*3+a])*r}return n}function BOe(n,e,t="YXZ"){let r=Math.sin(e[0]*.5),s=Math.cos(e[0]*.5),i=Math.sin(e[1]*.5),a=Math.cos(e[1]*.5),o=Math.sin(e[2]*.5),l=Math.cos(e[2]*.5);return t==="XYZ"?(n[0]=r*a*l+s*i*o,n[1]=s*i*l-r*a*o,n[2]=s*a*o+r*i*l,n[3]=s*a*l-r*i*o):t==="YXZ"?(n[0]=r*a*l+s*i*o,n[1]=s*i*l-r*a*o,n[2]=s*a*o-r*i*l,n[3]=s*a*l+r*i*o):t==="ZXY"?(n[0]=r*a*l-s*i*o,n[1]=s*i*l+r*a*o,n[2]=s*a*o+r*i*l,n[3]=s*a*l-r*i*o):t==="ZYX"?(n[0]=r*a*l-s*i*o,n[1]=s*i*l+r*a*o,n[2]=s*a*o-r*i*l,n[3]=s*a*l+r*i*o):t==="YZX"?(n[0]=r*a*l+s*i*o,n[1]=s*i*l+r*a*o,n[2]=s*a*o-r*i*l,n[3]=s*a*l-r*i*o):t==="XZY"&&(n[0]=r*a*l-s*i*o,n[1]=s*i*l-r*a*o,n[2]=s*a*o+r*i*l,n[3]=s*a*l+r*i*o),n}const HOe=COe,VOe=kOe,zOe=LOe,GOe=IOe;class qOe extends Array{constructor(e=0,t=0,r=0,s=1){super(e,t,r,s),this.onChange=()=>{},this._target=this;const i=["0","1","2","3"];return new Proxy(this,{set(a,o){const l=Reflect.set(...arguments);return l&&i.includes(o)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return DOe(this._target),this.onChange(),this}set(e,t,r,s){return e.length?this.copy(e):(VOe(this._target,e,t,r,s),this.onChange(),this)}rotateX(e){return MOe(this._target,this._target,e),this.onChange(),this}rotateY(e){return OOe(this._target,this._target,e),this.onChange(),this}rotateZ(e){return NOe(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return FOe(this._target,e),this.onChange(),this}conjugate(e=this._target){return UOe(this._target,e),this.onChange(),this}copy(e){return HOe(this._target,e),this.onChange(),this}normalize(e=this._target){return GOe(this._target,e),this.onChange(),this}multiply(e,t){return t?f8(this._target,e,t):f8(this._target,this._target,e),this.onChange(),this}dot(e){return zOe(this._target,e)}fromMatrix3(e){return $Oe(this._target,e),this.onChange(),this}fromEuler(e,t){return BOe(this._target,e,e.order),t||this.onChange(),this}fromAxisAngle(e,t){return POe(this._target,e,t),this.onChange(),this}slerp(e,t){return jOe(this._target,this._target,e,t),this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this._target[3]=e[t+3],this.onChange(),this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}}const WOe=1e-6;function KOe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function YOe(n,e,t,r,s,i,a,o,l,c,u,f,m,g,y,b,x){return n[0]=e,n[1]=t,n[2]=r,n[3]=s,n[4]=i,n[5]=a,n[6]=o,n[7]=l,n[8]=c,n[9]=u,n[10]=f,n[11]=m,n[12]=g,n[13]=y,n[14]=b,n[15]=x,n}function XOe(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function QOe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=e[9],m=e[10],g=e[11],y=e[12],b=e[13],x=e[14],S=e[15],T=t*o-r*a,_=t*l-s*a,R=t*c-i*a,I=r*l-s*o,C=r*c-i*o,L=s*c-i*l,k=u*b-f*y,M=u*x-m*y,D=u*S-g*y,U=f*x-m*b,$=f*S-g*b,V=m*S-g*x,B=T*V-_*$+R*U+I*D-C*M+L*k;return B?(B=1/B,n[0]=(o*V-l*$+c*U)*B,n[1]=(s*$-r*V-i*U)*B,n[2]=(b*L-x*C+S*I)*B,n[3]=(m*C-f*L-g*I)*B,n[4]=(l*D-a*V-c*M)*B,n[5]=(t*V-s*D+i*M)*B,n[6]=(x*R-y*L-S*_)*B,n[7]=(u*L-m*R+g*_)*B,n[8]=(a*$-o*D+c*k)*B,n[9]=(r*D-t*$-i*k)*B,n[10]=(y*C-b*R+S*T)*B,n[11]=(f*R-u*C-g*T)*B,n[12]=(o*M-a*U-l*k)*B,n[13]=(t*U-r*M+s*k)*B,n[14]=(b*_-y*I-x*T)*B,n[15]=(u*I-f*_+m*T)*B,n):null}function HZ(n){let e=n[0],t=n[1],r=n[2],s=n[3],i=n[4],a=n[5],o=n[6],l=n[7],c=n[8],u=n[9],f=n[10],m=n[11],g=n[12],y=n[13],b=n[14],x=n[15],S=e*a-t*i,T=e*o-r*i,_=e*l-s*i,R=t*o-r*a,I=t*l-s*a,C=r*l-s*o,L=c*y-u*g,k=c*b-f*g,M=c*x-m*g,D=u*b-f*y,U=u*x-m*y,$=f*x-m*b;return S*$-T*U+_*D+R*M-I*k+C*L}function m8(n,e,t){let r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],m=e[9],g=e[10],y=e[11],b=e[12],x=e[13],S=e[14],T=e[15],_=t[0],R=t[1],I=t[2],C=t[3];return n[0]=_*r+R*o+I*f+C*b,n[1]=_*s+R*l+I*m+C*x,n[2]=_*i+R*c+I*g+C*S,n[3]=_*a+R*u+I*y+C*T,_=t[4],R=t[5],I=t[6],C=t[7],n[4]=_*r+R*o+I*f+C*b,n[5]=_*s+R*l+I*m+C*x,n[6]=_*i+R*c+I*g+C*S,n[7]=_*a+R*u+I*y+C*T,_=t[8],R=t[9],I=t[10],C=t[11],n[8]=_*r+R*o+I*f+C*b,n[9]=_*s+R*l+I*m+C*x,n[10]=_*i+R*c+I*g+C*S,n[11]=_*a+R*u+I*y+C*T,_=t[12],R=t[13],I=t[14],C=t[15],n[12]=_*r+R*o+I*f+C*b,n[13]=_*s+R*l+I*m+C*x,n[14]=_*i+R*c+I*g+C*S,n[15]=_*a+R*u+I*y+C*T,n}function ZOe(n,e,t){let r=t[0],s=t[1],i=t[2],a,o,l,c,u,f,m,g,y,b,x,S;return e===n?(n[12]=e[0]*r+e[4]*s+e[8]*i+e[12],n[13]=e[1]*r+e[5]*s+e[9]*i+e[13],n[14]=e[2]*r+e[6]*s+e[10]*i+e[14],n[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(a=e[0],o=e[1],l=e[2],c=e[3],u=e[4],f=e[5],m=e[6],g=e[7],y=e[8],b=e[9],x=e[10],S=e[11],n[0]=a,n[1]=o,n[2]=l,n[3]=c,n[4]=u,n[5]=f,n[6]=m,n[7]=g,n[8]=y,n[9]=b,n[10]=x,n[11]=S,n[12]=a*r+u*s+y*i+e[12],n[13]=o*r+f*s+b*i+e[13],n[14]=l*r+m*s+x*i+e[14],n[15]=c*r+g*s+S*i+e[15]),n}function JOe(n,e,t){let r=t[0],s=t[1],i=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*s,n[5]=e[5]*s,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*i,n[9]=e[9]*i,n[10]=e[10]*i,n[11]=e[11]*i,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function eNe(n,e,t,r){let s=r[0],i=r[1],a=r[2],o=Math.hypot(s,i,a),l,c,u,f,m,g,y,b,x,S,T,_,R,I,C,L,k,M,D,U,$,V,B,W;return Math.abs(o)<WOe?null:(o=1/o,s*=o,i*=o,a*=o,l=Math.sin(t),c=Math.cos(t),u=1-c,f=e[0],m=e[1],g=e[2],y=e[3],b=e[4],x=e[5],S=e[6],T=e[7],_=e[8],R=e[9],I=e[10],C=e[11],L=s*s*u+c,k=i*s*u+a*l,M=a*s*u-i*l,D=s*i*u-a*l,U=i*i*u+c,$=a*i*u+s*l,V=s*a*u+i*l,B=i*a*u-s*l,W=a*a*u+c,n[0]=f*L+b*k+_*M,n[1]=m*L+x*k+R*M,n[2]=g*L+S*k+I*M,n[3]=y*L+T*k+C*M,n[4]=f*D+b*U+_*$,n[5]=m*D+x*U+R*$,n[6]=g*D+S*U+I*$,n[7]=y*D+T*U+C*$,n[8]=f*V+b*B+_*W,n[9]=m*V+x*B+R*W,n[10]=g*V+S*B+I*W,n[11]=y*V+T*B+C*W,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function tNe(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function VZ(n,e){let t=e[0],r=e[1],s=e[2],i=e[4],a=e[5],o=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(t,r,s),n[1]=Math.hypot(i,a,o),n[2]=Math.hypot(l,c,u),n}function nNe(n){let e=n[0],t=n[1],r=n[2],s=n[4],i=n[5],a=n[6],o=n[8],l=n[9],c=n[10];const u=e*e+t*t+r*r,f=s*s+i*i+a*a,m=o*o+l*l+c*c;return Math.sqrt(Math.max(u,f,m))}const zZ=function(){const n=[1,1,1];return function(e,t){let r=n;VZ(r,t);let s=1/r[0],i=1/r[1],a=1/r[2],o=t[0]*s,l=t[1]*i,c=t[2]*a,u=t[4]*s,f=t[5]*i,m=t[6]*a,g=t[8]*s,y=t[9]*i,b=t[10]*a,x=o+f+b,S=0;return x>0?(S=Math.sqrt(x+1)*2,e[3]=.25*S,e[0]=(m-y)/S,e[1]=(g-c)/S,e[2]=(l-u)/S):o>f&&o>b?(S=Math.sqrt(1+o-f-b)*2,e[3]=(m-y)/S,e[0]=.25*S,e[1]=(l+u)/S,e[2]=(g+c)/S):f>b?(S=Math.sqrt(1+f-o-b)*2,e[3]=(g-c)/S,e[0]=(l+u)/S,e[1]=.25*S,e[2]=(m+y)/S):(S=Math.sqrt(1+b-o-f)*2,e[3]=(l-u)/S,e[0]=(g+c)/S,e[1]=(m+y)/S,e[2]=.25*S),e}}();function rNe(n,e,t,r){let s=$g([n[0],n[1],n[2]]);const i=$g([n[4],n[5],n[6]]),a=$g([n[8],n[9],n[10]]);HZ(n)<0&&(s=-s),t[0]=n[12],t[1]=n[13],t[2]=n[14];const l=n.slice(),c=1/s,u=1/i,f=1/a;l[0]*=c,l[1]*=c,l[2]*=c,l[4]*=u,l[5]*=u,l[6]*=u,l[8]*=f,l[9]*=f,l[10]*=f,zZ(e,l),r[0]=s,r[1]=i,r[2]=a}function sNe(n,e,t,r){const s=n,i=e[0],a=e[1],o=e[2],l=e[3],c=i+i,u=a+a,f=o+o,m=i*c,g=i*u,y=i*f,b=a*u,x=a*f,S=o*f,T=l*c,_=l*u,R=l*f,I=r[0],C=r[1],L=r[2];return s[0]=(1-(b+S))*I,s[1]=(g+R)*I,s[2]=(y-_)*I,s[3]=0,s[4]=(g-R)*C,s[5]=(1-(m+S))*C,s[6]=(x+T)*C,s[7]=0,s[8]=(y+_)*L,s[9]=(x-T)*L,s[10]=(1-(m+b))*L,s[11]=0,s[12]=t[0],s[13]=t[1],s[14]=t[2],s[15]=1,s}function iNe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=t+t,o=r+r,l=s+s,c=t*a,u=r*a,f=r*o,m=s*a,g=s*o,y=s*l,b=i*a,x=i*o,S=i*l;return n[0]=1-f-y,n[1]=u+S,n[2]=m-x,n[3]=0,n[4]=u-S,n[5]=1-c-y,n[6]=g+b,n[7]=0,n[8]=m+x,n[9]=g-b,n[10]=1-c-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function aNe(n,e,t,r,s){let i=1/Math.tan(e/2),a=1/(r-s);return n[0]=i/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(s+r)*a,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*s*r*a,n[15]=0,n}function oNe(n,e,t,r,s,i,a){let o=1/(e-t),l=1/(r-s),c=1/(i-a);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*o,n[13]=(s+r)*l,n[14]=(a+i)*c,n[15]=1,n}function lNe(n,e,t,r){let s=e[0],i=e[1],a=e[2],o=r[0],l=r[1],c=r[2],u=s-t[0],f=i-t[1],m=a-t[2],g=u*u+f*f+m*m;g===0?m=1:(g=1/Math.sqrt(g),u*=g,f*=g,m*=g);let y=l*m-c*f,b=c*u-o*m,x=o*f-l*u;return g=y*y+b*b+x*x,g===0&&(c?o+=1e-6:l?c+=1e-6:l+=1e-6,y=l*m-c*f,b=c*u-o*m,x=o*f-l*u,g=y*y+b*b+x*x),g=1/Math.sqrt(g),y*=g,b*=g,x*=g,n[0]=y,n[1]=b,n[2]=x,n[3]=0,n[4]=f*x-m*b,n[5]=m*y-u*x,n[6]=u*b-f*y,n[7]=0,n[8]=u,n[9]=f,n[10]=m,n[11]=0,n[12]=s,n[13]=i,n[14]=a,n[15]=1,n}function p8(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n}function g8(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n}function cNe(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n}class $E extends Array{constructor(e=1,t=0,r=0,s=0,i=0,a=1,o=0,l=0,c=0,u=0,f=1,m=0,g=0,y=0,b=0,x=1){return super(e,t,r,s,i,a,o,l,c,u,f,m,g,y,b,x),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,t,r,s,i,a,o,l,c,u,f,m,g,y,b,x){return e.length?this.copy(e):(YOe(this,e,t,r,s,i,a,o,l,c,u,f,m,g,y,b,x),this)}translate(e,t=this){return ZOe(this,t,e),this}rotate(e,t,r=this){return eNe(this,r,e,t),this}scale(e,t=this){return JOe(this,t,typeof e=="number"?[e,e,e]:e),this}add(e,t){return t?p8(this,e,t):p8(this,this,e),this}sub(e,t){return t?g8(this,e,t):g8(this,this,e),this}multiply(e,t){return e.length?t?m8(this,e,t):m8(this,this,e):cNe(this,this,e),this}identity(){return XOe(this),this}copy(e){return KOe(this,e),this}fromPerspective({fov:e,aspect:t,near:r,far:s}={}){return aNe(this,e,t,r,s),this}fromOrthogonal({left:e,right:t,bottom:r,top:s,near:i,far:a}){return oNe(this,e,t,r,s,i,a),this}fromQuaternion(e){return iNe(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return QOe(this,e),this}compose(e,t,r){return sNe(this,e,t,r),this}decompose(e,t,r){return rNe(this,e,t,r),this}getRotation(e){return zZ(e,this),this}getTranslation(e){return tNe(e,this),this}getScaling(e){return VZ(e,this),this}getMaxScaleOnAxis(){return nNe(this)}lookAt(e,t,r){return lNe(this,e,t,r),this}determinant(){return HZ(this)}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this[3]=e[t+3],this[4]=e[t+4],this[5]=e[t+5],this[6]=e[t+6],this[7]=e[t+7],this[8]=e[t+8],this[9]=e[t+9],this[10]=e[t+10],this[11]=e[t+11],this[12]=e[t+12],this[13]=e[t+13],this[14]=e[t+14],this[15]=e[t+15],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e[t+4]=this[4],e[t+5]=this[5],e[t+6]=this[6],e[t+7]=this[7],e[t+8]=this[8],e[t+9]=this[9],e[t+10]=this[10],e[t+11]=this[11],e[t+12]=this[12],e[t+13]=this[13],e[t+14]=this[14],e[t+15]=this[15],e}}function uNe(n,e,t="YXZ"){return t==="XYZ"?(n[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(n[0]=Math.atan2(-e[9],e[10]),n[2]=Math.atan2(-e[4],e[0])):(n[0]=Math.atan2(e[6],e[5]),n[2]=0)):t==="YXZ"?(n[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(n[1]=Math.atan2(e[8],e[10]),n[2]=Math.atan2(e[1],e[5])):(n[1]=Math.atan2(-e[2],e[0]),n[2]=0)):t==="ZXY"?(n[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(n[1]=Math.atan2(-e[2],e[10]),n[2]=Math.atan2(-e[4],e[5])):(n[1]=0,n[2]=Math.atan2(e[1],e[0]))):t==="ZYX"?(n[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(n[0]=Math.atan2(e[6],e[10]),n[2]=Math.atan2(e[1],e[0])):(n[0]=0,n[2]=Math.atan2(-e[4],e[5]))):t==="YZX"?(n[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(n[0]=Math.atan2(-e[9],e[5]),n[1]=Math.atan2(-e[2],e[0])):(n[0]=0,n[1]=Math.atan2(e[8],e[10]))):t==="XZY"&&(n[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(n[0]=Math.atan2(e[6],e[5]),n[1]=Math.atan2(e[8],e[0])):(n[0]=Math.atan2(-e[9],e[10]),n[1]=0)),n}const v8=new $E;class dNe extends Array{constructor(e=0,t=e,r=e,s="YXZ"){super(e,t,r),this.order=s,this.onChange=()=>{},this._target=this;const i=["0","1","2"];return new Proxy(this,{set(a,o){const l=Reflect.set(...arguments);return l&&i.includes(o)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,t=e,r=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=t,this._target[2]=r,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,t=this.order){return uNe(this._target,e,t),this.onChange(),this}fromQuaternion(e,t=this.order,r){return v8.fromQuaternion(e),this._target.fromRotationMatrix(v8,t),r||this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}}class hNe{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new $E,this.worldMatrix=new $E,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Va,this.quaternion=new qOe,this.scale=new Va(1),this.rotation=new dNe,this.up=new Va(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,t=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,t&&e&&e.addChild(this,!1)}addChild(e,t=!0){~this.children.indexOf(e)||this.children.push(e),t&&e.setParent(this,!1)}removeChild(e,t=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),t&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let t=0,r=this.children.length;t<r;t++)this.children[t].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,t=!1){t?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function fNe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n}function mNe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=t+t,o=r+r,l=s+s,c=t*a,u=r*a,f=r*o,m=s*a,g=s*o,y=s*l,b=i*a,x=i*o,S=i*l;return n[0]=1-f-y,n[3]=u-S,n[6]=m+x,n[1]=u+S,n[4]=1-c-y,n[7]=g-b,n[2]=m-x,n[5]=g+b,n[8]=1-c-f,n}function pNe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function gNe(n,e,t,r,s,i,a,o,l,c){return n[0]=e,n[1]=t,n[2]=r,n[3]=s,n[4]=i,n[5]=a,n[6]=o,n[7]=l,n[8]=c,n}function vNe(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function yNe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=u*a-o*c,m=-u*i+o*l,g=c*i-a*l,y=t*f+r*m+s*g;return y?(y=1/y,n[0]=f*y,n[1]=(-u*r+s*c)*y,n[2]=(o*r-s*a)*y,n[3]=m*y,n[4]=(u*t-s*l)*y,n[5]=(-o*t+s*i)*y,n[6]=g*y,n[7]=(-c*t+r*l)*y,n[8]=(a*t-r*i)*y,n):null}function y8(n,e,t){let r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],m=t[0],g=t[1],y=t[2],b=t[3],x=t[4],S=t[5],T=t[6],_=t[7],R=t[8];return n[0]=m*r+g*a+y*c,n[1]=m*s+g*o+y*u,n[2]=m*i+g*l+y*f,n[3]=b*r+x*a+S*c,n[4]=b*s+x*o+S*u,n[5]=b*i+x*l+S*f,n[6]=T*r+_*a+R*c,n[7]=T*s+_*o+R*u,n[8]=T*i+_*l+R*f,n}function bNe(n,e,t){let r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],m=t[0],g=t[1];return n[0]=r,n[1]=s,n[2]=i,n[3]=a,n[4]=o,n[5]=l,n[6]=m*r+g*a+c,n[7]=m*s+g*o+u,n[8]=m*i+g*l+f,n}function xNe(n,e,t){let r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],m=Math.sin(t),g=Math.cos(t);return n[0]=g*r+m*a,n[1]=g*s+m*o,n[2]=g*i+m*l,n[3]=g*a-m*r,n[4]=g*o-m*s,n[5]=g*l-m*i,n[6]=c,n[7]=u,n[8]=f,n}function wNe(n,e,t){let r=t[0],s=t[1];return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=s*e[3],n[4]=s*e[4],n[5]=s*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function ENe(n,e){let t=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=e[9],m=e[10],g=e[11],y=e[12],b=e[13],x=e[14],S=e[15],T=t*o-r*a,_=t*l-s*a,R=t*c-i*a,I=r*l-s*o,C=r*c-i*o,L=s*c-i*l,k=u*b-f*y,M=u*x-m*y,D=u*S-g*y,U=f*x-m*b,$=f*S-g*b,V=m*S-g*x,B=T*V-_*$+R*U+I*D-C*M+L*k;return B?(B=1/B,n[0]=(o*V-l*$+c*U)*B,n[1]=(l*D-a*V-c*M)*B,n[2]=(a*$-o*D+c*k)*B,n[3]=(s*$-r*V-i*U)*B,n[4]=(t*V-s*D+i*M)*B,n[5]=(r*D-t*$-i*k)*B,n[6]=(b*L-x*C+S*I)*B,n[7]=(x*R-y*L-S*_)*B,n[8]=(y*C-b*R+S*T)*B,n):null}class SNe extends Array{constructor(e=1,t=0,r=0,s=0,i=1,a=0,o=0,l=0,c=1){return super(e,t,r,s,i,a,o,l,c),this}set(e,t,r,s,i,a,o,l,c){return e.length?this.copy(e):(gNe(this,e,t,r,s,i,a,o,l,c),this)}translate(e,t=this){return bNe(this,t,e),this}rotate(e,t=this){return xNe(this,t,e),this}scale(e,t=this){return wNe(this,t,e),this}multiply(e,t){return t?y8(this,e,t):y8(this,this,e),this}identity(){return vNe(this),this}copy(e){return pNe(this,e),this}fromMatrix4(e){return fNe(this,e),this}fromQuaternion(e){return mNe(this,e),this}fromBasis(e,t,r){return this.set(e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2]),this}inverse(e=this){return yNe(this,e),this}getNormalMatrix(e){return ENe(this,e),this}}let TNe=0;class _Ne extends hNe{constructor(e,{geometry:t,program:r,mode:s=e.TRIANGLES,frustumCulled:i=!0,renderOrder:a=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=TNe++,this.geometry=t,this.program=r,this.mode=s,this.frustumCulled=i,this.renderOrder=a,this.modelViewMatrix=new $E,this.normalMatrix=new SNe,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(r=>r&&r({mesh:this,camera:e}));let t=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:t}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(r=>r&&r({mesh:this,camera:e}))}}class ANe extends xOe{constructor(e,{attributes:t={}}={}){Object.assign(t,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,t)}}const RNe="#ffffff",uo=n=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]:[1,1,1]},b8=(n,e,t)=>{switch(n){case"top-left":return{anchor:[0,-.2*t],dir:[0,1]};case"top-right":return{anchor:[e,-.2*t],dir:[0,1]};case"left":return{anchor:[-.2*e,.5*t],dir:[1,0]};case"right":return{anchor:[(1+.2)*e,.5*t],dir:[-1,0]};case"bottom-left":return{anchor:[0,t],dir:[0,-1]};case"bottom-center":return{anchor:[.5*e,t],dir:[0,-1]};case"bottom-right":return{anchor:[e,t],dir:[0,-1]};default:return{anchor:[.5*e,-.2*t],dir:[0,1]}}},GZ=({raysOrigin:n="top-center",raysColor:e=RNe,raysSpeed:t=1,lightSpread:r=1,rayLength:s=2,pulsating:i=!1,fadeDistance:a=1,saturation:o=1,followMouse:l=!0,mouseInfluence:c=.1,noiseAmount:u=0,distortion:f=0,className:m="",overlayImage:g=null,gradientColors:y=null,gradientStops:b=[0,.33,.66,1],gradientScale:x=.1,gradientOpacity:S=1,distortionPhase:T=.01,opacity:_=1})=>{const R=E.useRef(null),I=E.useRef(null),C=E.useRef(null),L=E.useRef({x:.5,y:.5}),k=E.useRef({x:.5,y:.5}),M=E.useRef(null),D=E.useRef(null),U=E.useRef(null);return E.useEffect(()=>R.current?(U.current&&(U.current(),U.current=null),C.current&&(C.current=null),I.current&&(I.current=null),D.current&&(D.current=null),(async()=>{if(!R.current||(await new Promise(G=>setTimeout(G,10)),!R.current))return;const V=new ROe({dpr:Math.min(window.devicePixelRatio,2),alpha:!0,premultipliedAlpha:!1});C.current=V;const B=V.gl;for(B.canvas.style.width="100%",B.canvas.style.height="100%",B.canvas.style.position="absolute",B.canvas.style.top="0",B.canvas.style.left="0";R.current.firstChild;)R.current.removeChild(R.current.firstChild);R.current.appendChild(B.canvas);const W=`
attribute vec2 position;
varying vec2 vUv;
void main() {
  vUv = position * 0.5 + 0.5;
  gl_Position = vec4(position, 0.0, 1.0);
}`,F=`precision highp float;

uniform float iTime;
uniform vec2  iResolution;

uniform vec2  rayPos;
uniform vec2  rayDir;
uniform vec3  raysColor;
uniform float raysSpeed;
uniform float lightSpread;
uniform float rayLength;
uniform float pulsating;
uniform float fadeDistance;
uniform float saturation;
uniform vec2  mousePos;
uniform float mouseInfluence;
uniform float noiseAmount;
uniform float distortion;
uniform float distortionPhase;

// Gradient uniforms
uniform float useGradient;
uniform vec3  gradientColor1;
uniform vec3  gradientColor2;
uniform vec3  gradientColor3;
uniform vec3  gradientColor4;
uniform vec4  gradientStops;
uniform float gradientScale;
uniform float gradientOpacity;
uniform float opacity;

varying vec2 vUv;

float noise(vec2 st) {
  return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}

struct RayResult {
  float strength;
  float normalizedDistance;
};

RayResult rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord,
                  float seedA, float seedB, float speed) {
  vec2 sourceToCoord = coord - raySource;
  vec2 dirNorm = normalize(sourceToCoord);
  float cosAngle = dot(dirNorm, rayRefDirection);

  float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 - length(sourceToCoord) * distortionPhase) * 0.2;

  // Create a much tighter cone using exponential falloff from center
  float angleDeviation = 1.0 - distortedAngle;
  float spreadFactor = exp(-angleDeviation * angleDeviation / max(lightSpread * lightSpread * 0.01, 0.0001));

  float distance = length(sourceToCoord);
  float maxDistance = iResolution.x * rayLength;
  float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);

  float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);
  float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;

  float baseStrength = clamp(
    (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +
    (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),
    0.0, 1.0
  );

  float strength = baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;

  // Normalized distance for gradient (0 at origin, 1 at max distance)
  // Use gradientScale to control how quickly colors transition
  float normalizedDistance = clamp(distance / (maxDistance * gradientScale), 0.0, 1.0);

  RayResult result;
  result.strength = strength;
  result.normalizedDistance = normalizedDistance;
  return result;
}

vec3 getGradientColor(float normalizedDistance) {
  vec3 color;

  if (normalizedDistance < gradientStops.y) {
    // Between color 1 and 2
    float t = (normalizedDistance - gradientStops.x) / (gradientStops.y - gradientStops.x);
    color = mix(gradientColor1, gradientColor2, smoothstep(0.0, 1.0, t));
  } else if (normalizedDistance < gradientStops.z) {
    // Between color 2 and 3
    float t = (normalizedDistance - gradientStops.y) / (gradientStops.z - gradientStops.y);
    color = mix(gradientColor2, gradientColor3, smoothstep(0.0, 1.0, t));
  } else {
    // Between color 3 and 4
    float t = (normalizedDistance - gradientStops.z) / (gradientStops.w - gradientStops.z);
    color = mix(gradientColor3, gradientColor4, smoothstep(0.0, 1.0, t));
  }

  return color;
}

void mainImage(out vec4 fragColor, in vec2 fragCoord) {
  vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);

  vec2 finalRayDir = rayDir;
  if (mouseInfluence > 0.0) {
    vec2 mouseScreenPos = mousePos * iResolution.xy;
    vec2 mouseDirection = normalize(mouseScreenPos - rayPos);
    finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));
  }

  RayResult ray1 = rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349, 1.5 * raysSpeed);
  RayResult ray2 = rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234, 1.1 * raysSpeed);

  // Combine ray strengths
  fragColor = vec4(1.0) * (ray1.strength * 0.5 + ray2.strength * 0.4);

  // Use the average normalized distance from both rays
  float avgNormalizedDistance = (ray1.normalizedDistance + ray2.normalizedDistance) * 0.5;

  if (noiseAmount > 0.0) {
    float n = noise(coord * 0.01 + iTime * 0.1);
    fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);
  }

  if (saturation != 1.0) {
    float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));
    fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);
  }

  // Apply color (gradient or single color)
  if (useGradient > 0.5) {
    vec3 gradColor = getGradientColor(avgNormalizedDistance);
    // Mix gradient with base color using gradientOpacity
    // Default base color is #CFDEF6 (the outermost gradient color)
    vec3 baseColor = gradientColor4;
    vec3 finalColor = mix(baseColor, gradColor, gradientOpacity);
    fragColor.rgb *= finalColor;
  } else {
    fragColor.rgb *= raysColor;
  }

  // Apply overall opacity
  fragColor.a *= opacity;
}

void main() {
  vec4 color;
  mainImage(color, gl_FragCoord.xy);
  gl_FragColor  = color;
}`,j={iTime:{value:0},iResolution:{value:[1,1]},rayPos:{value:[0,0]},rayDir:{value:[0,1]},raysColor:{value:uo(e)},raysSpeed:{value:t},lightSpread:{value:r},rayLength:{value:s},pulsating:{value:i?1:0},fadeDistance:{value:a},saturation:{value:o},mousePos:{value:[.5,.5]},mouseInfluence:{value:c},noiseAmount:{value:u},distortion:{value:f},distortionPhase:{value:T},useGradient:{value:y?1:0},gradientColor1:{value:y?uo(y[0]):[1,1,1]},gradientColor2:{value:y?uo(y[1]):[1,1,1]},gradientColor3:{value:y?uo(y[2]):[1,1,1]},gradientColor4:{value:y?uo(y[3]):[1,1,1]},gradientStops:{value:b},gradientScale:{value:x},gradientOpacity:{value:S},opacity:{value:_}};I.current=j;const q=new ANe(B),H=new EOe(B,{vertex:W,fragment:F,uniforms:j}),N=new _Ne(B,{geometry:q,program:H});D.current=N;const O=()=>{if(!R.current||!V)return;V.dpr=Math.min(window.devicePixelRatio,2);const{clientWidth:G,clientHeight:Y}=R.current;V.setSize(G,Y);const Q=V.dpr,J=G*Q,ee=Y*Q;j.iResolution.value=[J,ee];const{anchor:oe,dir:te}=b8(n,J,ee);j.rayPos.value=oe,j.rayDir.value=te},z=G=>{if(!(!C.current||!I.current||!D.current)){j.iTime.value=G*.001,l&&c>0&&(k.current.x=k.current.x*.92+L.current.x*(1-.92),k.current.y=k.current.y*.92+L.current.y*(1-.92),j.mousePos.value=[k.current.x,k.current.y]);try{V.render({scene:N}),M.current=requestAnimationFrame(z)}catch(Y){console.warn("WebGL rendering error:",Y);return}}};window.addEventListener("resize",O),O(),M.current=requestAnimationFrame(z),U.current=()=>{if(M.current&&(cancelAnimationFrame(M.current),M.current=null),window.removeEventListener("resize",O),V&&V.gl)try{const G=V.gl,Y=G.canvas;D.current&&D.current.geometry&&D.current.geometry.remove(),D.current&&D.current.program&&D.current.program.program&&G.deleteProgram(D.current.program.program);const Q=G.getExtension("WEBGL_lose_context");Q&&Q.loseContext(),Y&&Y.parentNode&&Y.parentNode.removeChild(Y)}catch(G){console.warn("Error during WebGL cleanup:",G)}C.current=null,I.current=null,D.current=null}})(),()=>{U.current&&(U.current(),U.current=null)}):void 0,[]),E.useEffect(()=>{if(!I.current||!R.current||!C.current)return;const $=I.current,V=C.current;$.raysColor.value=uo(e),$.raysSpeed.value=t,$.lightSpread.value=r,$.rayLength.value=s,$.pulsating.value=i?1:0,$.fadeDistance.value=a,$.saturation.value=o,$.mouseInfluence.value=c,$.noiseAmount.value=u,$.distortion.value=f,$.distortionPhase.value=T,$.opacity.value=_,$.useGradient.value=y?1:0,y&&($.gradientColor1.value=uo(y[0]),$.gradientColor2.value=uo(y[1]),$.gradientColor3.value=uo(y[2]),$.gradientColor4.value=uo(y[3]),$.gradientStops.value=b,$.gradientScale.value=x,$.gradientOpacity.value=S);const{clientWidth:B,clientHeight:W}=R.current,F=V.dpr,{anchor:j,dir:q}=b8(n,B*F,W*F);$.rayPos.value=j,$.rayDir.value=q},[e,t,r,n,s,i,a,o,c,u,f,T,y,b,x,S,_]),E.useEffect(()=>{const $=V=>{if(!R.current||!C.current)return;const B=R.current.getBoundingClientRect(),W=(V.clientX-B.left)/B.width,F=(V.clientY-B.top)/B.height;L.current={x:W,y:F}};if(l)return window.addEventListener("mousemove",$),()=>window.removeEventListener("mousemove",$)},[l]),d.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",isolation:"isolate"},children:[g&&d.jsx("img",{src:g,alt:"",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",pointerEvents:"none",zIndex:0}}),d.jsx("div",{ref:R,className:`light-rays-container ${m}`.trim(),style:{position:"relative",width:"100%",height:"100%",mixBlendMode:g?"screen":"normal",zIndex:1}})]})},CNe=Object.freeze(Object.defineProperty({__proto__:null,default:GZ},Symbol.toStringTag,{value:"Module"})),v0=({gradientOpacity:n=1,positioning:e="fixed"})=>{const[t,r]=E.useState(!1);return E.useEffect(()=>{r(!0)},[]),d.jsxs("div",{className:`${e==="absolute"?"absolute":"fixed"} inset-0 overflow-hidden pointer-events-none`,style:{zIndex:0},children:[d.jsx("div",{className:"absolute inset-0",style:{background:"#09090B"}}),d.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"url(/images/grainy.png)",backgroundSize:"100px 100px",backgroundRepeat:"repeat",backgroundPosition:"left top",mixBlendMode:"overlay",opacity:.3,pointerEvents:"none",zIndex:10}}),d.jsx("div",{style:{position:"absolute",bottom:"-20px",left:"0",width:"100%",height:"100vh",pointerEvents:"none",zIndex:1,isolation:"isolate",opacity:t?1:0,transition:"opacity 1.5s ease-in"},children:d.jsx(GZ,{raysOrigin:"bottom-center",raysSpeed:.25,lightSpread:7,opacity:1,saturation:2,rayLength:2,followMouse:!1,mouseInfluence:0,distortion:.1,distortionPhase:.3,className:"custom-rays",gradientColors:["#D15DFF","#F78264","#EFD7A4","#CFDEF6"],gradientStops:[0,.25,.5,1],gradientScale:.1,gradientOpacity:1})})]})},kNe=({variant:n="compact",className:e="",size:t="default",redirectPath:r})=>{const s=Os(),i=r||s.pathname+s.search,a=`/login?returnUrl=${encodeURIComponent(i)}`,o=n==="expanded"?"Log in to join team":"Sign in";return d.jsx(gs,{to:a,children:d.jsx(dt,{size:t,className:e,children:o})})};function INe(){const{inviteCode:n}=F8(),e=Jn(),{user:t}=Ar(),[r,s]=E.useState(null),[i,a]=E.useState(!0),[o,l]=E.useState(!1),[c,u]=E.useState(null);E.useEffect(()=>{if(!n){e("/");return}f()},[n]);const f=async()=>{try{const y=await DH(`/api/teams/invite/${n}`);if(!y.ok){if(y.status===404)u("Page not found");else{const x=await y.json().catch(()=>({error:"Unknown error"}));u(x.error||"Failed to load invite")}return}const b=await y.json();s(b.team)}catch(y){console.error("Error fetching team info:",y),u("Failed to load invite")}finally{a(!1)}},m=async()=>{if(t){l(!0);try{const y=await Ht(`/api/teams/invite/${n}`,{method:"POST"});if(!y.ok){const x=await y.json().catch(()=>({error:"Unknown error"}));throw new Error(x.error||"Failed to join team")}const b=await y.json();et.success("Successfully joined team!"),window.location.href="/dash"}catch(y){console.error("Error joining team:",y),et.error(y instanceof Error?y.message:"Failed to join team")}finally{l(!1)}}},g=()=>c?d.jsx(hi,{className:"text-center",children:d.jsx(Pi,{children:c})}):i?d.jsxs(d.Fragment,{children:[d.jsxs(hi,{className:"text-center",children:[d.jsx("div",{className:"mx-auto",children:d.jsx(Lo,{width:192,height:32})}),d.jsx("div",{className:"mx-auto",children:d.jsx(Lo,{width:256})})]}),d.jsx(ss,{className:"flex justify-center py-8",children:d.jsx(Lo,{width:128})}),d.jsx(mL,{className:"justify-center",children:d.jsx(Lo,{width:128,height:40})})]}):d.jsxs(d.Fragment,{children:[d.jsxs(hi,{className:"text-center",children:[d.jsx(Pi,{className:"text-2xl",children:"Team Invitation"}),d.jsxs($a,{children:[r?.creator_name||"Someone"," has invited you to join"]})]}),d.jsx(ss,{className:"text-center",children:d.jsx("div",{className:"py-4 bg-card-background border-b border-border/50 rounded-3xl",children:d.jsx("h3",{className:"text-xl font-semibold",children:r?.name})})}),d.jsx(mL,{className:"justify-center",children:t?d.jsx(dt,{onClick:m,size:"lg",disabled:o,className:"button-primary",children:o?"Joining...":"Join Team"}):d.jsx(kNe,{variant:"expanded",size:"lg"})})]});return d.jsxs(d.Fragment,{children:[d.jsx(v0,{}),d.jsx("div",{className:"min-h-screen relative z-10 flex items-center justify-center p-4",children:d.jsxs(rs,{className:"w-full max-w-md rounded-3xl bg-element-background shadow-2xl shadow-black ",children:[d.jsx("div",{className:"text-center pt-6 flex justify-center mb-4 -mt-0.5 border-t border-white/30 rounded-t-3xl",children:d.jsx(oD,{})}),g()]})})]})}function LNe(){return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"opacity-50",children:d.jsx(v0,{})}),d.jsx("div",{className:"min-h-screen text-white relative overflow-x-hidden",children:d.jsxs("div",{className:"container mx-auto max-w-6xl px-4 md:px-8 py-12 relative z-10 font-mono",children:[d.jsx("div",{className:"mb-8",children:d.jsx(gs,{to:"/",children:d.jsx(dt,{variant:"outline",children:" Back"})})}),d.jsx("div",{className:"w-full max-w-40 md:max-w-72 mx-auto mb-8",children:d.jsx("img",{src:"/images/paul.png",alt:"Paul Mccartney",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Both Paul McCartney and your local musician know how to play guitar and write on notepads."}),d.jsx("div",{className:"w-full max-w-40 md:max-w-72 mx-auto mb-8",children:d.jsx("img",{src:"/images/jony.png",alt:"Jony Ive",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Both Jony Ive and a Junior Industrial Designer know how to sketch and use 3D modeling tools."}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"However, one's work is loved 1000x more,"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"has 1000x greater societal impact"}),d.jsx("p",{className:"text-md md:text-md mb-32",children:"and 1000x higher economic value than the other."}),d.jsx("p",{className:"text-md md:text-md text-center",children:"What's the one difference between them then?"}),d.jsx("div",{className:"w-full max-w-54 mx-auto mb-24",children:d.jsx("img",{src:"/images/illustration-taste.png",alt:"Taste illustration",className:"w-full max-w-md"})}),d.jsxs("p",{className:"text-md md:text-md mb-8",children:["Taste is the appreciation of what's possible"," ",d.jsx("span",{className:"italic",children:'(i.e. "What does the best version of this looks like?")'})]}),d.jsx("div",{className:"w-full max-w-2xl mx-auto mb-16",children:d.jsx("img",{src:"/images/illustration-microdecisions.png",alt:"Microdecisions illustration",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Any microdecision you have to make in the creative process passes through the filter of your taste. The sum of all these microdecisions is what defines the quality of your output."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"The quality of any creative output is determined in small measure by the tool, and in way larger measure from one's taste."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"This is what leads to the highly concentrated nature of creative industries, where the small subset of people that have extraordinary taste are able to create (and capture) much of the economic value."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"An innovative, usable and intuitive app design generates billions in incremental revenue from user retention. The designers behind it are therefore highly sought after by companies, that pay them a disproportionally higher salary."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"A great video on social media generates millions of organic views, can make a business successful, enable a career for a creator. An average one is inconsequential."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"The top 1000 songs on Spotify average of 1B+ streams vs. 135 streams, the median # of streams of the 70M+ songs on Spotify."}),d.jsx("h2",{className:"text-center font-bold text-sm md:text-xl mb-8",children:"The only differentiating factor"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Creative tools are built to close the gap between what one can imagine and reality (this is Figma's actual vision statement)."}),d.jsx("div",{className:"w-full max-w-2xl mx-auto mb-16 max-w-md",children:d.jsx("img",{src:"/images/illustration-gap.png",alt:"Gap between imagination and reality",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"A new wave of creative tools is coming to market, built with cloud+collaboration from the getgo (e.g. Figma) and AI native tools (e.g. Midjourney, v0, Heygen)."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Thanks to modern tools + AI the gap between what you can imagine (your taste) and reality will eventually collapse to 0."}),d.jsx("div",{className:"w-full max-w-2xl mx-auto mb-16 max-w-md",children:d.jsx("img",{src:"/images/illustration-reality.png",alt:"Gap between imagination and reality",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Simple technical ability to use tools will become irrelevant, and taste will become the only determining factor behind top 1% creative output (and the disproportionate economic value it generates)."}),d.jsx("h2",{className:"text-sm md:text-xl text-center font-bold mb-8",children:"Building taste"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Taste is not something you're born with, you build and refine it your entire life. There are 3 components to building taste:"}),d.jsx("h3",{className:"text-md md:text-lg mb-4 font-bold",children:"1. Exposure"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Nothing is created in isolation. Being exposed to great work is key to building taste (realizing what's possible)."}),d.jsx("img",{src:"/images/illustration-inspiration.png",alt:"Grid of aesthetic images",className:"w-full mb-16"}),d.jsx("p",{className:"text-md md:text-md mb-4",children:"Today, exposure is achieved with:"}),d.jsxs("ul",{className:"list-disc pl-6 mb-8 space-y-2 text-md md:text-md",children:[d.jsx("li",{children:"General purpose online platforms (YouTube, Instagram, Spotify, TikTok)"}),d.jsx("li",{children:"Specialized inspiration platforms (Pinterest, Dribbble, Behance, SoundCloud, Mobbin, awwwards)"}),d.jsx("li",{children:"Curation tools (mymind, Pinterest, Cosmos)"})]}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"It's easier than ever to discover great creative work."}),d.jsx("h3",{className:"text-md md:text-lg mb-4 font-bold",children:"2. Understanding Why"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Mere exposure to great work, however, leaves us completely clueless about why it's great. Not knowing this makes us unable to refine our taste for our own work."}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Watching Inception doesn't make you as good a director as Christopher Nolan."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"To do that we have to understand the components, techniques used, best practices and references to other work. We have to understand why something works."}),d.jsx("div",{className:"relative left-1/2 -translate-x-1/2 w-screen max-w-[120%] px-4 md:max-w-[160%] mb-16",children:d.jsx("img",{src:"/images/why-great.png",alt:"something is great, why something is great",className:"w-full"})}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"This information is gatekept by the creator and those with the experience and taste to decode why something works."}),d.jsxs("p",{className:"text-md md:text-md mb-4",children:["Today those with taste may try to share it via theoretical courses (e.g."," ",d.jsx("span",{className:"italic",children:'"Basics of UX Design: Heuristics"'}),") or technical tutorials (e.g."," ",d.jsx("span",{className:"italic",children:'"The Complete Figma Course"'}),")."]}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Both are suboptimal ways of sharing and absorbing taste, but they are the only ones used because there is currently no medium to convey creative taste."}),d.jsx("h3",{className:"text-md md:text-lg mb-4 font-bold",children:"3. Feedback"}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Working with people with good taste is the best way to acquire it yourself. In teams, the way this happens is through feedback."}),d.jsx("p",{className:"text-md md:text-md mb-16",children:"Most creative tools make you use text comments for feedback. This is a terrible medium to share creative feedback. Try to write down why exactly your favorite song works so well. It's incredibly hard."}),d.jsx("img",{src:"/images/illustration-quotes.png",alt:"I don't like this why? I don't know I just don't",className:"w-full mb-16"}),d.jsx("p",{className:"text-md md:text-md mb-8",children:"Creatives working in teams have to resort to providing feedback through a convoluted mix of text comments, links to references, recalling best practices and theoretical concepts and video recordings, scattered through different tools."}),d.jsx("p",{className:"text-md md:text-md mt-16",children:"Sharing creative feedback is a nebulous process because there is no medium to effectively do it."}),d.jsx("p",{className:"text-md md:text-md mt-2",children:"Let's fix that."})]})})]})}function DNe(){return d.jsxs(d.Fragment,{children:[d.jsx(v0,{}),d.jsx("div",{className:"min-h-screen text-white relative overflow-x-hidden",children:d.jsxs("div",{className:"container mx-auto max-w-4xl px-6 py-12 relative z-10",children:[d.jsx("div",{className:"mb-8",children:d.jsx(gs,{to:"/",children:d.jsx(dt,{variant:"outline",children:" Back"})})}),d.jsxs("article",{className:"prose prose-invert prose-lg max-w-none",children:[d.jsx("h1",{className:"text-3xl font-bold mb-6",children:"PRIVACY NOTICE"}),d.jsx("p",{className:"mb-8",children:d.jsx("strong",{children:"Last updated: May 29, 2025"})}),d.jsxs("p",{children:["Thank you for choosing to be part of our community at Flask (Company, we, us, our). We are committed to protecting your personal information and your right to privacy. If you have any questions or concerns about this privacy notice or our practices with regard to your personal information, please contact us at"," ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"}),"."]}),d.jsx("p",{children:"This privacy notice describes how we might use your information if you:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Visit our website at flask.do"}),d.jsx("li",{children:"Engage with us in other related ways  including any sales, marketing, or events"})]}),d.jsx("p",{children:"In this privacy notice, if we refer to:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Website, we are referring to any website of ours that references or links to this policy"}),d.jsx("li",{children:"Services, we are referring to our Website, and other related services, including any sales, marketing, or events"})]}),d.jsx("p",{children:"The purpose of this privacy notice is to explain to you in the clearest way possible what information we collect, how we use it, and what rights you have in relation to it. If there are any terms in this privacy notice that you do not agree with, please discontinue use of our Services immediately."}),d.jsx("p",{children:"Please read this privacy notice carefully, as it will help you understand what we do with the information that we collect."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mb-6",children:"TABLE OF CONTENTS"}),d.jsxs("ol",{className:"list-decimal list-inside mb-12 space-y-2",children:[d.jsx("li",{children:"WHAT INFORMATION DO WE COLLECT?"}),d.jsx("li",{children:"HOW DO WE PROCESS YOUR INFORMATION?"}),d.jsx("li",{children:"WHAT LEGAL BASES DO WE RELY ON TO PROCESS YOUR INFORMATION?"}),d.jsx("li",{children:"WHEN AND WITH WHOM DO WE SHARE YOUR PERSONAL INFORMATION?"}),d.jsx("li",{children:"GOOGLE API DATA"}),d.jsx("li",{children:"DO WE OFFER ARTIFICIAL INTELLIGENCE-BASED PRODUCTS?"}),d.jsx("li",{children:"HOW DO WE HANDLE YOUR SOCIAL LOGINS?"}),d.jsx("li",{children:"IS YOUR INFORMATION TRANSFERRED INTERNATIONALLY?"}),d.jsx("li",{children:"HOW LONG DO WE KEEP YOUR INFORMATION?"}),d.jsx("li",{children:"HOW DO WE KEEP YOUR INFORMATION SAFE?"}),d.jsx("li",{children:"DO WE COLLECT INFORMATION FROM MINORS?"}),d.jsx("li",{children:"WHAT ARE YOUR PRIVACY RIGHTS?"}),d.jsx("li",{children:"CONTROLS FOR DO-NOT-TRACK FEATURES"}),d.jsx("li",{children:"DO CALIFORNIA RESIDENTS HAVE SPECIFIC PRIVACY RIGHTS?"}),d.jsx("li",{children:"DO WE MAKE UPDATES TO THIS NOTICE?"}),d.jsx("li",{children:"HOW CAN YOU CONTACT US ABOUT THIS NOTICE?"}),d.jsx("li",{children:"HOW CAN YOU REVIEW, UPDATE, OR DELETE THE DATA WE COLLECT FROM YOU?"})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-1",children:"1. WHAT INFORMATION DO WE COLLECT?"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Personal information you disclose to us"}),d.jsx("p",{children:"We collect personal information that you voluntarily provide to us when you register on the Website, express an interest in obtaining information about us or our products and Services, when you participate in activities on the Website or otherwise when you contact us."}),d.jsxs("p",{children:[d.jsx("strong",{children:"Personal Information Provided by You."})," The personal information that we collect depends on the context of your interactions with us and the Website, the choices you make, and the products and features you use. The personal information we collect may include the following:"]}),d.jsxs("ul",{children:[d.jsx("li",{children:"names"}),d.jsx("li",{children:"phone numbers"}),d.jsx("li",{children:"email addresses"}),d.jsx("li",{children:"mailing addresses"}),d.jsx("li",{children:"job titles"}),d.jsx("li",{children:"usernames"}),d.jsx("li",{children:"passwords"}),d.jsx("li",{children:"contact preferences"}),d.jsx("li",{children:"contact or authentication data"}),d.jsx("li",{children:"billing addresses"}),d.jsx("li",{children:"debit/credit card numbers"})]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Sensitive Information."})," We do not process sensitive information."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Payment Data."})," We may collect data necessary to process your payment if you make purchases, such as your payment instrument number (such as a credit card number), and the security code associated with your payment instrument. All payment data is stored by Stripe. You may find their privacy notice here:"," ",d.jsx("a",{href:"https://stripe.com/privacy",target:"_blank",rel:"noopener noreferrer",children:"https://stripe.com/privacy"}),"."]}),d.jsx("p",{children:"All personal information that you provide to us must be true, complete, and accurate, and you must notify us of any changes to such personal information."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Information automatically collected"}),d.jsx("p",{children:"We automatically collect certain information when you visit, use, or navigate the Website. This information does not reveal your specific identity (like your name or contact information) but may include device and usage information, such as your IP address, browser and device characteristics, operating system, language preferences, referring URLs, device name, country, location, information about how and when you use our Website and other technical information. This information is primarily needed to maintain the security and operation of our Website, and for our internal analytics and reporting purposes."}),d.jsx("p",{children:"The information we collect includes:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Log and Usage Data."}),d.jsx("li",{children:"Device Data."}),d.jsx("li",{children:"Location Data."})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-2",children:"2. HOW DO WE PROCESS YOUR INFORMATION?"}),d.jsx("p",{children:"We process your personal information for a variety of reasons, depending on how you interact with our Website, including:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"To facilitate account creation and authentication and otherwise manage user accounts."}),d.jsx("li",{children:"To deliver and facilitate delivery of services to the user."}),d.jsx("li",{children:"To respond to user inquiries/offer support to users."}),d.jsx("li",{children:"To send administrative information to you."}),d.jsx("li",{children:"To send you marketing communications, product updates, feature announcements, and other promotional materials about Flask."}),d.jsx("li",{children:"To fulfill and manage your orders."}),d.jsx("li",{children:"To enable user-to-user communications."}),d.jsx("li",{children:"To request feedback."}),d.jsx("li",{children:"To protect our Services."}),d.jsx("li",{children:"To enforce our terms, conditions, and policies for business purposes, to comply with legal and regulatory requirements or in connection with our contract."}),d.jsx("li",{children:"To respond to legal requests and prevent harm."}),d.jsx("li",{children:"To manage user accounts."}),d.jsx("li",{children:"To deliver targeted advertising to you."}),d.jsx("li",{children:"To administer prize draws and competitions."}),d.jsx("li",{children:"To comply with our legal obligations."})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-3",children:"3. WHAT LEGAL BASES DO WE RELY ON TO PROCESS YOUR INFORMATION?"}),d.jsx("p",{children:"If you are located in the EU or UK, this section applies to you."}),d.jsx("p",{children:"The General Data Protection Regulation (GDPR) and UK GDPR require us to explain the valid legal bases we rely on in order to process your personal information. As such, we may rely on the following legal bases to process your personal information:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Consent."}),d.jsx("li",{children:"Performance of a Contract."}),d.jsx("li",{children:"Legal Obligations."}),d.jsx("li",{children:"Vital Interests."}),d.jsx("li",{children:"Legitimate Interests."})]}),d.jsx("p",{children:"If you are based in Canada, this section applies to you."}),d.jsx("p",{children:"We may process your information if you have given us specific permission (i.e., express consent) to use your personal information for a specific purpose, or in situations where your permission can be inferred (i.e., implied consent). You can withdraw your consent at any time."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-4",children:"4. WHEN AND WITH WHOM DO WE SHARE YOUR PERSONAL INFORMATION?"}),d.jsx("p",{children:"We may need to share your personal information in the following situations:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Business Transfers."}),d.jsx("li",{children:"Affiliates."}),d.jsx("li",{children:"Business Partners."}),d.jsx("li",{children:"Other Users."}),d.jsx("li",{children:"Offer Wall."}),d.jsx("li",{children:"Vendors, Consultants, and Other Third-Party Service Providers."})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-5",children:"5. GOOGLE API DATA"}),d.jsx("p",{children:"If you choose to connect your Google account with Flask, we may access certain information from your Google account, such as your name, email address, and profile picture, strictly for the purpose of providing and improving our services. We do not sell, rent, or share your Google user data with third parties for their own uses. We retain your Google user data only as long as necessary to provide our services or as required by law."}),d.jsxs("p",{children:["Our use and transfer to any other app of information received from Google APIs will adhere to the"," ",d.jsx("a",{href:"https://developers.google.com/terms/api-services-user-data-policy",target:"_blank",rel:"noopener noreferrer",children:"Google API Services User Data Policy"}),", including the Limited Use requirements."]}),d.jsxs("p",{children:["If you wish to delete your Google account data from Flask, please contact us at ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"})," and we will promptly remove your information as required."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-6",children:"6. DO WE OFFER ARTIFICIAL INTELLIGENCE-BASED PRODUCTS?"}),d.jsxs("p",{children:["We may offer products or features that use artificial intelligence (AI). If you use these features, we may process your information as described in this privacy notice. For more information, please contact us at ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"}),"."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-7",children:"7. HOW DO WE HANDLE YOUR SOCIAL LOGINS?"}),d.jsx("p",{children:"Our Website offers you the ability to register and log in using your third-party social media account details (like your Google, Facebook, or Twitter logins). Where you choose to do this, we will receive certain profile information about you from your social media provider. The profile information we receive may vary depending on the social media provider concerned, but will often include your name, email address, friends list, and profile picture, as well as other information you choose to make public on such a social media platform."}),d.jsx("p",{children:"We will use the information we receive only for the purposes that are described in this privacy notice or that are otherwise made clear to you on the relevant Website. Please note that we do not control, and are not responsible for, other uses of your personal information by your third-party social media provider."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-8",children:"8. IS YOUR INFORMATION TRANSFERRED INTERNATIONALLY?"}),d.jsx("p",{children:"Our servers are located in the US. If you are accessing our Website from outside the US, please be aware that your information may be transferred to, stored, and processed by us in our facilities and by those third parties with whom we may share your personal information (see WHEN AND WITH WHOM DO WE SHARE YOUR PERSONAL INFORMATION? above)."}),d.jsx("p",{children:"If you are a resident in the European Economic Area (EEA), United Kingdom (UK), or Switzerland, then these countries may not necessarily have data protection laws or other similar laws as comprehensive as those in your country. We will however take all necessary measures to protect your personal information in accordance with this privacy notice and applicable law."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-9",children:"9. HOW LONG DO WE KEEP YOUR INFORMATION?"}),d.jsx("p",{children:"We will only keep your personal information for as long as it is necessary for the purposes set out in this privacy notice, unless a longer retention period is required or permitted by law (such as tax, accounting, or other legal requirements)."}),d.jsx("p",{children:"When we have no ongoing legitimate business need to process your personal information, we will either delete or anonymize such information, or, if this is not possible (for example, because your personal information has been stored in backup archives), then we will securely store your personal information and isolate it from any further processing until deletion is possible."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-10",children:"10. HOW DO WE KEEP YOUR INFORMATION SAFE?"}),d.jsx("p",{children:"We have implemented appropriate and reasonable technical and organizational security measures designed to protect the security of any personal information we process. However, despite our safeguards and efforts to secure your information, no electronic transmission over the Internet or information storage technology can be guaranteed to be 100% secure, so we cannot promise or guarantee that hackers, cybercriminals, or other unauthorized third parties will not be able to defeat our security and improperly collect, access, steal, or modify your information."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-11",children:"11. DO WE COLLECT INFORMATION FROM MINORS?"}),d.jsx("p",{children:"We do not knowingly solicit data from or market to children under 18 years of age. By using the Website, you represent that you are at least 18 or that you are the parent or guardian of such a minor and consent to such minor dependent's use of the Website. If we learn that personal information from users less than 18 years of age has been collected, we will deactivate the account and take reasonable measures to promptly delete such data from our records."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-12",children:"12. WHAT ARE YOUR PRIVACY RIGHTS?"}),d.jsx("p",{children:"In some regions (like the EEA, UK, and Canada), you have rights that allow you greater access to and control over your personal information. These may include the right to:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Request access and obtain a copy of your personal information"}),d.jsx("li",{children:"Request rectification or erasure"}),d.jsx("li",{children:"Restrict the processing of your personal information"}),d.jsx("li",{children:"Data portability (if applicable)"}),d.jsx("li",{children:"Object to the processing of your personal information in certain circumstances"})]}),d.jsxs("p",{children:["If you wish to exercise any of these rights, please contact us at"," ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"}),". We will consider and act upon any request in accordance with applicable data protection laws."]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Email Communications and Opt-Out"}),d.jsx("p",{children:"By creating an account with Flask, you agree to receive email communications from us, including:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Transactional emails (receipts, password resets, account notifications)"}),d.jsx("li",{children:"Product updates and feature announcements"}),d.jsx("li",{children:"Marketing communications and promotional materials"}),d.jsx("li",{children:"Newsletters and educational content"})]}),d.jsxs("p",{children:[d.jsx("strong",{children:"You may opt out of marketing emails at any time"}),' by clicking the "unsubscribe" link at the bottom of any marketing email we send you. Please note that even if you opt out of marketing emails, you will still receive transactional emails necessary for operating your Flask account (such as password resets, receipts, and critical service notifications).']}),d.jsxs("p",{children:["To opt out of all non-essential communications, please contact us at"," ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"}),"."]}),d.jsxs("p",{children:["If you are a resident in the EEA or UK and you believe we are unlawfully processing your personal information, you also have the right to complain to your local data protection supervisory authority. You can find their contact details here:"," ",d.jsx("a",{href:"https://ec.europa.eu/justice/data-protection/bodies/authorities/index_en.htm",target:"_blank",rel:"noopener noreferrer",children:"https://ec.europa.eu/justice/data-protection/bodies/authorities/index_en.htm"}),"."]}),d.jsxs("p",{children:["If you are a resident in Switzerland, the contact details for the data protection authorities are available here:"," ",d.jsx("a",{href:"https://www.edoeb.admin.ch/edoeb/en/home.html",target:"_blank",rel:"noopener noreferrer",children:"https://www.edoeb.admin.ch/edoeb/en/home.html"}),"."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-13",children:"13. CONTROLS FOR DO-NOT-TRACK FEATURES"}),d.jsx("p",{children:'Most web browsers and some mobile operating systems and mobile applications include a Do-Not-Track ("DNT") feature or setting you can activate to signal your privacy preference not to have data about your online browsing activities monitored and collected. At this stage no uniform technology standard for recognizing and implementing DNT signals has been finalized. As such, we do not currently respond to DNT browser signals or any other mechanism that automatically communicates your choice not to be tracked online. If a standard for online tracking is adopted that we must follow in the future, we will inform you about that practice in a revised version of this privacy notice.'}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-14",children:"14. DO CALIFORNIA RESIDENTS HAVE SPECIFIC PRIVACY RIGHTS?"}),d.jsx("p",{children:"California Civil Code Section 1798.83, also known as the Shine The Light law, permits our users who are California residents to request and obtain from us, once a year and free of charge, information about categories of personal information (if any) we disclosed to third parties for direct marketing purposes and the names and addresses of all third parties with which we shared personal information in the immediately preceding calendar year. If you are a California resident and would like to make such a request, please submit your request in writing to us using the contact information provided below."}),d.jsx("p",{children:"If you are under 18 years of age, reside in California, and have a registered account with the Website, you have the right to request removal of unwanted data that you publicly post on the Website. To request removal of such data, please contact us using the contact information provided below, and include the email address associated with your account and a statement that you reside in California. We will make sure the data is not publicly displayed on the Website, but please be aware that the data may not be completely or comprehensively removed from all our systems (e.g., backups, etc.)."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-15",children:"15. DO WE MAKE UPDATES TO THIS NOTICE?"}),d.jsx("p",{children:"We may update this privacy notice from time to time. The updated version will be indicated by an updated Revised date and the updated version will be effective as soon as it is accessible. If we make material changes to this privacy notice, we may notify you either by prominently posting a notice of such changes or by directly sending you a notification. We encourage you to review this privacy notice frequently to be informed of how we are protecting your information."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-16",children:"16. HOW CAN YOU CONTACT US ABOUT THIS NOTICE?"}),d.jsxs("p",{children:["If you have questions or comments about this notice, you may email us at ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"})," or by post to:"]}),d.jsxs("address",{className:"not-italic",children:["Flask",d.jsx("br",{}),"124 City Road",d.jsx("br",{}),"London, EC1V 2NX",d.jsx("br",{}),"United Kingdom"]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-17",children:"17. HOW CAN YOU REVIEW, UPDATE, OR DELETE THE DATA WE COLLECT FROM YOU?"}),d.jsxs("p",{children:["Based on the applicable laws of your country, you may have the right to request access to the personal information we collect from you, change that information, or delete it in some circumstances. To request to review, update, or delete your personal information, please email us at:"," ",d.jsx("a",{href:"mailto:hello@flask.to",children:"hello@flask.to"}),"."]})]})]})})]})}function PNe(){return d.jsxs(d.Fragment,{children:[d.jsx(v0,{}),d.jsx("div",{className:"min-h-screen text-white relative overflow-x-hidden",children:d.jsxs("div",{className:"container mx-auto max-w-4xl px-6 py-12 relative z-10",children:[d.jsx("div",{className:"mb-8",children:d.jsx(gs,{to:"/",children:d.jsx(dt,{variant:"outline",children:" Back"})})}),d.jsxs("article",{className:"prose prose-invert prose-lg max-w-none list-disc",children:[d.jsx("h1",{className:"text-3xl font-bold mb-6",children:"TERMS OF SERVICE"}),d.jsx("p",{className:"mb-8",children:d.jsx("strong",{children:"Last updated: Oct 7, 2025"})}),d.jsx("p",{children:`Welcome to Flask. These Terms of Service ("Terms") govern your access to and use of Flask's video collaboration platform, website, and services (collectively, the "Service"). Please read these Terms carefully before using Flask.`}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mb-6",children:"TABLE OF CONTENTS"}),d.jsxs("ol",{className:"list-decimal list-inside mb-12 space-y-2",children:[d.jsx("li",{children:"About Flask"}),d.jsx("li",{children:"Eligibility"}),d.jsx("li",{children:"Account Registration and Security"}),d.jsx("li",{children:"Service Plans: Free and Flask Pro"}),d.jsx("li",{children:"Your Content and Intellectual Property"}),d.jsx("li",{children:"Flask's Intellectual Property Rights"}),d.jsx("li",{children:"AI Processing and Third-Party Services"}),d.jsx("li",{children:"Analytics and Tracking"}),d.jsx("li",{children:"Acceptable Use and Prohibited Activities"}),d.jsx("li",{children:"Termination and Account Deletion"}),d.jsx("li",{children:"Payment Terms and Refunds"}),d.jsx("li",{children:"Disclaimers and Limitation of Liability"}),d.jsx("li",{children:"Indemnification"}),d.jsx("li",{children:"Changes to Terms"}),d.jsx("li",{children:"Governing Law and Dispute Resolution"}),d.jsx("li",{children:"Contact Information"})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-1",children:"1. ABOUT FLASK"}),d.jsxs("p",{children:["Flask is provided by ",d.jsx("strong",{children:"Enritarta Ltd"}),", a company registered in England and Wales (company registration details available upon request), with a registered address at:"]}),d.jsxs("address",{className:"not-italic ml-4",children:["124 City Road",d.jsx("br",{}),"London, EC1V 2NX",d.jsx("br",{}),"United Kingdom"]}),d.jsx("p",{className:"mt-4",children:"Flask is a video collaboration platform designed for creative teams to record, share, organize, and collaborate on video feedback."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-2",children:"2. ELIGIBILITY"}),d.jsxs("p",{children:["You must be at least ",d.jsx("strong",{children:"18 years of age"})," to use Flask. By using the Service, you represent and warrant that you meet this age requirement."]}),d.jsx("p",{children:"If you are using Flask on behalf of an organization, you represent that you have the authority to bind that organization to these Terms."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-3",children:"3. ACCOUNT REGISTRATION AND SECURITY"}),d.jsxs("p",{children:["You may register using third-party authentication services (such as Google). When you do so, you authorize Flask to access certain information from that service as described in our"," ",d.jsx(gs,{to:"/privacy-policy",className:"text-blue-400 hover:underline",children:"Privacy Policy"}),"."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-4",children:"4. SERVICE PLANS: FREE AND FLASK PRO"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Free Plan"}),d.jsx("p",{children:"Flask offers a free plan with unlimited video collaboration. Free plan users upload videos to YouTube, and videos are embedded within Flask's platform. Free plan recordings are subject to YouTube's Terms of Service and content policies."}),d.jsx("p",{children:"Flask reserves the right to monitor and terminate free accounts that demonstrate abusive behavior, including but not limited to: automated bot activity, unreasonable volumes of recordings or comments suggesting commercial or non-personal use, or other patterns inconsistent with individual creative collaboration."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Flask Pro"}),d.jsx("p",{children:"Flask Pro is a paid subscription plan that includes:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Direct uploads to Flask (no YouTube required)"}),d.jsx("li",{children:"Shared team workspaces"}),d.jsx("li",{children:"Up to 5TB of storage per account"}),d.jsx("li",{children:"Additional collaboration features"})]}),d.jsx("p",{children:"Flask Pro subscriptions are billed monthly or annually as selected during purchase. Payment is processed through Stripe. By subscribing to Flask Pro, you authorize Flask to charge your payment method on a recurring basis until you cancel."}),d.jsx("p",{children:"Higher-tier plans with increased storage limits are currently under development and will be available in the future."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-5",children:"5. YOUR CONTENT AND INTELLECTUAL PROPERTY"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Ownership"}),d.jsxs("p",{children:[d.jsx("strong",{children:"You retain full ownership"}),' of all content you upload, create, or share through Flask, including videos, recordings, comments, annotations, and other materials (collectively, "Your Content").']}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"License to Flask"}),d.jsx("p",{children:"To operate the Service, you grant Flask a limited, worldwide, non-exclusive, royalty-free license to host, store, display, and transmit Your Content solely for the purpose of providing the Service to you and your collaborators."}),d.jsxs("p",{children:[d.jsx("strong",{children:"Flask will not use Your Content for marketing purposes, advertising, or any purpose beyond providing the Service to you."})," Your uploaded videos are not used to train AI models or shared with third parties except as explicitly described in these Terms."]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Responsibility"}),d.jsx("p",{children:"You are solely responsible for Your Content and the consequences of sharing it. You represent and warrant that:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"You own or have the necessary rights to Your Content"}),d.jsx("li",{children:"Your Content does not violate any third-party rights, including intellectual property, privacy, or publicity rights"}),d.jsx("li",{children:"Your Content complies with these Terms and applicable laws"})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-6",children:"6. FLASK'S INTELLECTUAL PROPERTY RIGHTS"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Ownership of Flask"}),d.jsx("p",{children:"All rights, title, and interest in and to the Flask Service, including but not limited to the following, are owned exclusively by Enritarta Ltd and are protected by copyright, trademark, patent, trade secret, and other intellectual property laws:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"The Flask software, platform, and application (including source code, object code, and underlying technology)"}),d.jsx("li",{children:"Flask's proprietary algorithms, features, functionality, and user interface"}),d.jsx("li",{children:"The Flask name, logo, branding, trademarks, and service marks"}),d.jsx("li",{children:"All visual designs, graphics, user interface elements, and design systems"}),d.jsx("li",{children:"Flask's proprietary technology, infrastructure, and technical innovations"}),d.jsx("li",{children:"Documentation, tutorials, help content, and other materials provided by Flask"}),d.jsx("li",{children:"Any updates, modifications, or derivative works of the above"})]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Limited License to Use Flask"}),d.jsx("p",{children:"Subject to your compliance with these Terms, Flask grants you a limited, non-exclusive, non-transferable, non-sublicensable, revocable license to access and use the Service for your personal or internal business purposes only."}),d.jsx("p",{children:"This license does not grant you any rights to:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Copy, modify, distribute, sell, or lease any part of the Service"}),d.jsx("li",{children:"Reverse engineer, decompile, or attempt to extract the source code of Flask"}),d.jsx("li",{children:"Remove, alter, or obscure any proprietary notices (copyright, trademark, etc.) on the Service"}),d.jsx("li",{children:"Use Flask's branding, trademarks, or logos without prior written permission"}),d.jsx("li",{children:"Create derivative works or competing products based on Flask"}),d.jsx("li",{children:"Frame or mirror any part of the Service without express written permission"})]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Feedback and Suggestions"}),d.jsx("p",{children:`If you provide Flask with any feedback, suggestions, or ideas about the Service ("Feedback"), you acknowledge and agree that Flask may use such Feedback without any obligation to you, including without limitation to incorporate Feedback into the Service. You hereby grant Flask a perpetual, worldwide, royalty-free, irrevocable license to use, modify, and incorporate Feedback into Flask's products and services.`}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Trademark Notice"}),d.jsx("p",{children:'"Flask" and the Flask logo are trademarks of Enritarta Ltd. You may not use these trademarks without prior written permission from Enritarta Ltd. All other trademarks, service marks, and trade names referenced in the Service are the property of their respective owners.'}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-7",children:"7. AI PROCESSING AND THIRD-PARTY SERVICES"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"AI-Generated Summaries"}),d.jsx("p",{children:"Flask offers AI-powered features, including automatic transcription and summarization of recordings made within Flask canvases. When you use these features:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Only recordings created within Flask are processed by third-party AI services (Google Gemini)"}),d.jsxs("li",{children:["Uploaded videos (whether via YouTube or direct upload) are"," ",d.jsx("strong",{children:"not"})," sent to AI services"]}),d.jsx("li",{children:"AI processing is used solely to generate summaries and insights for your use"}),d.jsx("li",{children:"Your recordings are not used to train AI models"})]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Third-Party Services"}),d.jsx("p",{children:"Flask integrates with the following third-party services:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Supabase:"})," Database and authentication"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Mux:"})," Video processing and streaming (Flask Pro)"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"YouTube:"})," Video hosting (Free plan)"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Stripe:"})," Payment processing"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Vercel:"})," Hosting infrastructure"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Google Gemini:"})," AI transcription and summarization"]})]}),d.jsx("p",{children:"Your use of Flask may be subject to the terms of service and privacy policies of these third-party providers. Flask is not responsible for the practices or performance of third-party services."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-8",children:"8. ANALYTICS AND TRACKING"}),d.jsx("p",{children:"Flask uses analytics and tracking technologies to improve the Service and understand how users interact with our platform. We use:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Google Analytics:"})," To track page views, user behavior, and site performance"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"PostHog:"})," For product analytics, feature usage tracking, and user experience optimization"]})]}),d.jsx("p",{children:"These services collect information such as your IP address, browser type, device information, pages visited, features used, and interaction patterns."}),d.jsxs("p",{children:[d.jsx("strong",{children:"By using Flask, you consent to this tracking and analytics as a necessary part of operating and improving the Service."})," ","Analytics data is used solely to enhance Flask's product and user experience. We do not sell analytics data to third parties."]}),d.jsxs("p",{children:["For more information about data collection, please see our"," ",d.jsx(gs,{to:"/privacy-policy",className:"text-blue-400 hover:underline",children:"Privacy Policy"}),"."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-9",children:"9. ACCEPTABLE USE AND PROHIBITED ACTIVITIES"}),d.jsx("p",{children:"You agree not to use Flask to:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Violate any applicable laws, regulations, or third-party rights"}),d.jsx("li",{children:"Upload, share, or transmit illegal, harmful, threatening, abusive, harassing, defamatory, or otherwise objectionable content"}),d.jsx("li",{children:"Infringe upon intellectual property rights, including copyrights, trademarks, or trade secrets"}),d.jsx("li",{children:"Use automated systems (bots, scrapers, crawlers) to access or interact with the Service without authorization"}),d.jsx("li",{children:"Attempt to gain unauthorized access to Flask's systems, networks, or user accounts"}),d.jsx("li",{children:"Interfere with or disrupt the Service, servers, or networks connected to Flask"}),d.jsx("li",{children:"Use the Service for commercial purposes inconsistent with your account type (e.g., operating a commercial service on a Free plan)"}),d.jsx("li",{children:"Reverse engineer, decompile, or attempt to extract source code from Flask"}),d.jsx("li",{children:"Impersonate any person or entity, or misrepresent your affiliation with any person or entity"})]}),d.jsx("p",{children:"Flask reserves the right to investigate and take appropriate action against anyone who violates these Terms, including removing content, suspending or terminating accounts, and reporting to law enforcement authorities."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-10",children:"10. TERMINATION AND ACCOUNT DELETION"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Termination by You"}),d.jsxs("p",{children:["You may delete your Flask account at any time through your account settings or by contacting us at"," ",d.jsx("a",{href:"mailto:hello@flask.to",className:"text-blue-400 hover:underline",children:"hello@flask.to"}),"."]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Termination by Flask"}),d.jsx("p",{children:"Flask reserves the right to suspend or terminate your account if you violate these Terms or engage in conduct that Flask determines to be harmful to the Service or other users. Where possible, we will provide notice before termination, except in cases of serious violations or legal requirements."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Data Retention After Termination"}),d.jsxs("p",{children:["Upon account deletion or termination, your data will be retained for ",d.jsx("strong",{children:"30 days"})," before permanent deletion. During this period, you may contact us to request account restoration. After 30 days, Your Content and account data will be permanently deleted from Flask's systems, except where retention is required by law or for legitimate business purposes (such as resolving disputes or enforcing these Terms)."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-11",children:"11. PAYMENT TERMS AND REFUNDS"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Pricing"}),d.jsx("p",{children:"Flask Pro subscription pricing is displayed on our website at the time of purchase. All prices are in the currency specified at checkout. Flask reserves the right to change pricing with notice to existing subscribers."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Billing"}),d.jsx("p",{children:"Flask Pro subscriptions automatically renew at the end of each billing cycle (monthly or annually) unless canceled. You will be charged on the renewal date using your payment method on file."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Cancellation"}),d.jsx("p",{children:"You may cancel your Flask Pro subscription at any time through your account settings. Cancellation takes effect at the end of your current billing period. You will retain access to Flask Pro features until that date."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Refund Policy"}),d.jsxs("p",{children:["Flask offers a ",d.jsx("strong",{children:"30-day refund policy"})," for Flask Pro subscriptions. If you are not satisfied with Flask Pro within 30 days of your initial purchase or renewal, contact us at"," ",d.jsx("a",{href:"mailto:hello@flask.to",className:"text-blue-400 hover:underline",children:"hello@flask.to"})," ","to request a full refund. Refunds are issued to the original payment method."]}),d.jsx("p",{children:"After 30 days, no refunds will be provided for subscription fees, and cancellations will take effect at the end of the current billing period."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-12",children:"12. DISCLAIMERS AND LIMITATION OF LIABILITY"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"No Warranties"}),d.jsx("p",{children:'Flask is provided "as is" and "as available" without warranties of any kind, whether express or implied, including but not limited to implied warranties of merchantability, fitness for a particular purpose, or non-infringement.'}),d.jsx("p",{children:"Flask does not warrant that:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"The Service will be uninterrupted, secure, or error-free"}),d.jsx("li",{children:"The Service will meet your requirements or expectations"}),d.jsx("li",{children:"Any errors or defects will be corrected"}),d.jsx("li",{children:"The Service or servers are free of viruses or harmful components"})]}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Best Effort Service"}),d.jsxs("p",{children:["Flask is provided on a ",d.jsx("strong",{children:"best effort basis"}),". We do not guarantee any specific uptime or availability of the Service. Flask may experience downtime, interruptions, or performance issues due to maintenance, technical difficulties, third-party service failures, or other factors beyond our control."]}),d.jsx("p",{children:"We reserve the right to modify, suspend, or discontinue any part of the Service at any time, with or without notice, for any reason, including but not limited to maintenance, updates, or improvements."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Limitation of Liability"}),d.jsx("p",{children:"To the fullest extent permitted by law, Flask, its officers, directors, employees, and affiliates shall not be liable for any indirect, incidental, special, consequential, or punitive damages, including but not limited to loss of profits, data, use, or goodwill, arising out of or related to your use of or inability to use the Service, even if Flask has been advised of the possibility of such damages."}),d.jsx("p",{children:"In no event shall Flask's total liability to you for all claims arising out of or relating to these Terms or the Service exceed the amount you paid to Flask in the 12 months preceding the claim, or 100, whichever is greater."}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Third-Party Services"}),d.jsx("p",{children:"Flask is not responsible for the performance, availability, or content of third-party services (including YouTube, Mux, Stripe, and others). Any issues with third-party services should be directed to those providers."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-13",children:"13. INDEMNIFICATION"}),d.jsx("p",{children:"You agree to indemnify, defend, and hold harmless Flask and its officers, directors, employees, and affiliates from and against any claims, liabilities, damages, losses, costs, or expenses (including reasonable attorneys' fees) arising out of or related to:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Your use of the Service"}),d.jsx("li",{children:"Your Content"}),d.jsx("li",{children:"Your violation of these Terms"}),d.jsx("li",{children:"Your violation of any third-party rights, including intellectual property, privacy, or publicity rights"})]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-14",children:"14. CHANGES TO TERMS"}),d.jsx("p",{children:'Flask reserves the right to modify these Terms at any time. When we make changes, the updated Terms will be posted on this page with a revised "Last updated" date at the top.'}),d.jsxs("p",{children:[d.jsx("strong",{children:"This page is the authoritative source for the current Terms of Service."})," We will not send email notifications for updates to these Terms. It is your responsibility to review this page periodically for any changes."]}),d.jsx("p",{children:"Your continued use of Flask after the effective date of the updated Terms constitutes your acceptance of the changes. If you do not agree to the modified Terms, you must stop using the Service and may delete your account."}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-15",children:"15. GOVERNING LAW AND DISPUTE RESOLUTION"}),d.jsx("h3",{className:"text-xl font-semibold mt-8 mb-2",children:"Governing Law"}),d.jsxs("p",{children:["These Terms are governed by and construed in accordance with the laws of ",d.jsx("strong",{children:"Italy"}),", without regard to conflict of law principles."]}),d.jsx("hr",{className:"border-gray-700 my-8"}),d.jsx("h2",{className:"text-2xl font-bold mt-12 mb-4",id:"section-16",children:"16. CONTACT INFORMATION"}),d.jsx("p",{children:"If you have any questions, concerns, or feedback about these Terms, please contact us at:"}),d.jsxs("address",{className:"not-italic ml-4",children:[d.jsx("strong",{children:"Email:"})," ",d.jsx("a",{href:"mailto:hello@flask.to",className:"text-blue-400 hover:underline",children:"hello@flask.to"}),d.jsx("br",{}),d.jsx("strong",{children:"Address:"}),d.jsx("br",{}),"Enritarta Ltd",d.jsx("br",{}),"124 City Road",d.jsx("br",{}),"London, EC1V 2NX",d.jsx("br",{}),"United Kingdom"]}),d.jsx("hr",{className:"border-gray-700 my-8"})]})]})})]})}function MNe(){const n=Jn(),[e]=Cd(),{user:t}=Ar(),{fetchUserTeams:r,updateTeamName:s}=Ag(),[i,a]=E.useState("loading"),[o,l]=E.useState(""),[c,u]=E.useState(!1),[f,m]=E.useState(null),[g,y]=E.useState(!1),[b,x]=E.useState(null);E.useEffect(()=>{if(!t){const C=encodeURIComponent("/newteam");n(`/login?returnUrl=${C}`);return}e.get("session_id")?S():n("/#pricing")},[t,n,e]);const S=async I=>{try{await new Promise(M=>setTimeout(M,2e3));const C=await Ht("/api/teams");if(!C.ok)throw new Error("Failed to fetch teams");const{teams:L}=await C.json(),k=L.filter(M=>M.team_type==="pro_team").sort((M,D)=>new Date(D.created_at).getTime()-new Date(M.created_at).getTime())[0];if(k)x(k.id),m(k),l(k.name),a("rename");else throw new Error("Team not found after payment")}catch(C){console.error("Error fetching team after checkout:",C),et.error("Failed to load your new team. Please refresh the page."),a("rename")}},T=async()=>{if(!o.trim()||!b){et.error("Please enter a team name");return}u(!0);try{await s(b,o.trim());const I=await Ht(`/api/teams/${b}`);if(I.ok){const C=await I.json();m(C.team)}a("success"),t&&await r(t.id)}catch(I){console.error("Error renaming team:",I),et.error(I instanceof Error?I.message:"Failed to rename team")}finally{u(!1)}},_=async()=>{if(!f)return;const I=`${window.location.origin}/invite/${f.invite_code}`;try{await navigator.clipboard.writeText(I),y(!0),et.success("Invite link copied to clipboard!"),setTimeout(()=>y(!1),2e3)}catch(C){console.error("Failed to copy:",C),et.error("Failed to copy link")}},R=()=>{n("/")};return t?d.jsxs(d.Fragment,{children:[d.jsx(v0,{}),d.jsxs("div",{className:"min-h-screen relative z-10 flex items-center justify-center p-4",children:[i==="loading"&&d.jsx(rs,{className:"w-full max-w-md bg-element-background border-border",children:d.jsx(ss,{className:"p-8",children:d.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[d.jsx(Mo,{className:"h-8 w-8 animate-spin text-primary"}),d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Setting up your team..."}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we configure your new team"})]})]})})}),i==="rename"&&d.jsx(rs,{className:"w-full max-w-md bg-element-background border-border",children:d.jsx(ss,{className:"p-8",children:d.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[d.jsx("img",{src:"/images/LogoTextSmall.png",alt:"Flask Logo",className:"w-20 h-16 object-contain"}),d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h2",{className:"text-2xl font-semibold text-text-primary",children:"Name Your Team"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a name for your new Pro team"})]}),d.jsxs("div",{className:"w-full space-y-4",children:[d.jsx("div",{className:"space-y-2",children:d.jsx(ha,{id:"team-name",type:"text",placeholder:"Team name",value:o,onChange:I=>l(I.target.value),onKeyDown:I=>{I.key==="Enter"&&!c&&T()},disabled:c,autoFocus:!0,className:"h-12 text-base"})}),d.jsx(dt,{onClick:T,size:"lg",disabled:c||!o.trim(),className:"w-full h-12 text-base",children:c?"Updating...":"Continue"})]})]})})}),i==="success"&&f&&d.jsx(rs,{className:"w-full max-w-md bg-element-background border-border",children:d.jsx(ss,{className:"p-8",children:d.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[d.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[d.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx(is,{className:"h-8 w-8 text-primary"})}),d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h2",{className:"text-2xl font-semibold text-text-primary",children:"Team Created!"}),d.jsxs("p",{className:"text-sm text-muted-foreground",children:[f.name," is ready for collaboration"]})]})]}),d.jsxs("div",{className:"w-full space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-sm font-medium text-text-secondary",children:"Share this link to invite team members"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ha,{type:"text",value:`${window.location.origin}/invite/${f.invite_code}`,readOnly:!0,className:"h-12 font-mono text-sm bg-background/50"}),d.jsx(dt,{size:"lg",variant:"outline",onClick:_,className:"h-12 px-4",children:g?d.jsx(is,{className:"h-4 w-4"}):d.jsx(JV,{className:"h-4 w-4"})})]})]}),d.jsx(dt,{onClick:R,size:"lg",className:"w-full h-12 text-base",children:"Go to Team"})]})]})})})]})]}):null}const ONe=()=>{const n=Jn();return d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black text-white",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),d.jsx("p",{className:"text-white/60 mb-6",children:"Page not found"}),d.jsx(dt,{onClick:()=>n("/"),variant:"link",className:"text-white/80",children:"Go home"})]})})};function NNe(){return d.jsx(ONe,{})}function jNe(){const n=Jn(),[e]=Cd(),{user:t,isLoading:r,isInitialized:s}=Ar();return E.useEffect(()=>{(async()=>{Object.fromEntries(e.entries()),t?.id;const a=e.get("redirectTo")||e.get("redirect_to")||e.get("returnUrl")||e.get("next")||"/dash",o=e.get("error"),l=e.get("error_description");if(o){console.error("[AuthCallback] OAuth error:",{error:o,errorDescription:l}),n(`/login?error=${o}`);return}s&&(t&&!r?n(a,{replace:!0}):r||n(`/login?returnUrl=${encodeURIComponent(a)}`))})()},[e,t,r,s,n]),d.jsx("div",{className:"min-h-screen bg-card-background flex items-center justify-center",children:d.jsx("div",{className:"text-text-primary",children:"Completing sign in..."})})}function FNe(){return E.useEffect(()=>{window.location.href="https://enritarta.notion.site/288abb4f34b78048aa86ce13d3534b81?pvs=105"},[]),d.jsx("div",{className:"flex items-center justify-center h-screen bg-background text-foreground",children:d.jsx("div",{className:"text-sm",children:"Redirecting..."})})}var UNe="Label",qZ=E.forwardRef((n,e)=>d.jsx(_t.label,{...n,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(n.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));qZ.displayName=UNe;var WZ=qZ;const $Ne=lD("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Io=E.forwardRef(({className:n,...e},t)=>d.jsx(WZ,{ref:t,className:je($Ne(),n),...e}));Io.displayName=WZ.displayName;function BNe(){const{user:n}=Ar(),e=Ft(q=>q.switchTeam),r=n?.id==="ec650580-972b-4642-ba53-fdc643ff70dc",[s,i]=E.useState(""),[a,o]=E.useState(""),[l,c]=E.useState(!1),[u,f]=E.useState(!1),[m,g]=E.useState(null),[y,b]=E.useState(null),[x,S]=E.useState(""),[T,_]=E.useState(!1),[R,I]=E.useState(""),[C,L]=E.useState(null),[k,M]=E.useState(!1),[D,U]=E.useState(!1),[$,V]=E.useState(null),B=async()=>{if(!s.trim()){et.error("Please enter customer email");return}c(!0),g(null),b(null);try{const q=await Ht("/api/admin/users/check-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.trim()})});if(!q.ok){const N=await q.json();throw new Error(N.error||"Failed to check email")}const H=await q.json();H.exists?(g(!0),et.success(`User found: ${H.email}`)):(g(!1),et.error("User not found - ask them to sign up first"))}catch(q){console.error("Error checking email:",q),et.error(q instanceof Error?q.message:"Failed to check email")}finally{c(!1)}},W=async()=>{if(!s.trim()){et.error("Please enter customer email");return}if(!a.trim()){et.error("Please enter team name");return}if(!m){et.error("Please check if user exists first");return}f(!0),b(null);try{const q=await Ht("/api/admin/teams/activate-trial",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_email:s.trim(),team_name:a.trim()})});if(!q.ok){const N=await q.json();throw new Error(N.error||"Failed to activate trial")}const H=await q.json();if(b(H.team),H.team?.id)try{await e(H.team.id),et.success("Trial activated and team switched successfully!")}catch(N){console.error("Error switching to new team:",N),et.success("Trial activated! Please refresh to see your new team.")}else et.success("Trial activated successfully!")}catch(q){console.error("Error activating trial:",q),et.error(q instanceof Error?q.message:"Failed to activate trial")}finally{f(!1)}},F=async()=>{if(!x.trim()){et.error("Please enter test email address");return}_(!0),L(null);try{const q=await Ht("/api/admin/test-email-notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({testEmail:x.trim()})});if(!q.ok){const N=await q.json();throw new Error(N.error||"Failed to test email notifications")}const H=await q.json();L(H),H.summary.emailsSent>0?et.success(`Successfully sent ${H.summary.emailsSent} test email(s) to ${x}`):et.info("No emails sent - no users with new activity found")}catch(q){console.error("Error testing email notifications:",q),et.error(q instanceof Error?q.message:"Failed to test email notifications")}finally{_(!1)}},j=async()=>{U(!0),V(null),M(!1);try{if(!R.trim())throw new Error("Please enter the cron secret");const q=await Ht("/api/cron/send-notifications",{method:"GET",headers:{Authorization:`Bearer ${R}`}});if(!q.ok){const N=await q.json();throw new Error(N.error||"Failed to send notifications")}const H=await q.json();V({success:H.success,summary:{totalUsersChecked:H.processed||0,emailsSent:H.sent||0,emailsFailed:H.errors?.length||0,usersWithActivity:H.processed||0},details:H.errors?.map(N=>({userId:"",userEmail:N,success:!1,flaskCount:0,error:N}))||[]}),H.sent>0?et.success(`Successfully sent ${H.sent} notification email(s) to real users!`):et.info("No emails sent - no users with new activity found")}catch(q){console.error("Error sending all notifications:",q),et.error(q instanceof Error?q.message:"Failed to send notifications")}finally{U(!1)}};return n?r?d.jsxs("div",{className:"min-h-screen bg-black flex flex-col items-center justify-start p-4 space-y-6 py-8",children:[d.jsxs(rs,{className:"w-full max-w-2xl bg-zinc-900 border-zinc-800",children:[d.jsxs(hi,{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Wce,{className:"h-6 w-6 text-yellow-500"}),d.jsx(Pi,{className:"text-white",children:"King of Flask - One-Click Trial Activation"})]}),d.jsx($a,{className:"text-zinc-400",children:"Instantly activate 7-day trial for sales calls - no link, no checkout, no waiting"})]}),d.jsxs(ss,{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-zinc-800 text-xs text-zinc-400",children:"1"}),d.jsx(Io,{htmlFor:"customer-email",className:"text-white",children:"Customer Email"})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(ha,{id:"customer-email",type:"email",placeholder:"customer@company.com",value:s,onChange:q=>{i(q.target.value),g(null),b(null)},disabled:l||u,className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"}),d.jsx(dt,{onClick:B,disabled:l||!s.trim(),variant:"outline",className:"bg-zinc-800 border-zinc-700 text-white hover:bg-zinc-700",children:l?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"w-4 h-4 mr-2 animate-spin"}),"Checking..."]}):"Check Email"})]}),m!==null&&d.jsx("div",{className:`flex items-center gap-2 p-3 rounded-lg ${m?"bg-green-500/10 border border-green-500/20":"bg-red-500/10 border border-red-500/20"}`,children:m?d.jsxs(d.Fragment,{children:[d.jsx(Tp,{className:"w-4 h-4 text-green-400"}),d.jsx("span",{className:"text-sm text-green-400",children:"User exists in database"})]}):d.jsxs(d.Fragment,{children:[d.jsx(S3,{className:"w-4 h-4 text-red-400"}),d.jsx("span",{className:"text-sm text-red-400",children:"User not found - ask them to sign up at flask.do/login first"})]})})]}),m&&d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-zinc-800 text-xs text-zinc-400",children:"2"}),d.jsx(Io,{htmlFor:"team-name",className:"text-white",children:"Team Name"})]}),d.jsx(ha,{id:"team-name",placeholder:"Acme Corp Trial",value:a,onChange:q=>{o(q.target.value),b(null)},disabled:u,className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"})]}),m&&d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-zinc-800 text-xs text-zinc-400",children:"3"}),d.jsx(Io,{className:"text-white",children:"Activate Trial"})]}),d.jsx(dt,{onClick:W,disabled:u||!a.trim(),className:"w-full bg-yellow-600 hover:bg-yellow-700 text-white",children:u?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"w-4 h-4 mr-2 animate-spin"}),"Activating Trial..."]}):d.jsxs(d.Fragment,{children:[d.jsx(gue,{className:"w-4 h-4 mr-2"}),"Activate Trial Now"]})})]}),y&&d.jsxs("div",{className:"space-y-3 p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Tp,{className:"w-5 h-5 text-green-400"}),d.jsx("p",{className:"font-semibold text-green-400",children:"Trial Activated Successfully!"})]}),d.jsxs("div",{className:"space-y-2 text-sm text-zinc-300",children:[d.jsxs("p",{children:[d.jsx("strong",{className:"text-white",children:"Team:"})," ",y.name]}),d.jsxs("p",{children:[d.jsx("strong",{className:"text-white",children:"Status:"})," 7-day trial active"]}),y.trial_ends&&d.jsxs("p",{children:[d.jsx("strong",{className:"text-white",children:"Trial ends:"})," ",new Date(y.trial_ends).toLocaleDateString()]}),d.jsxs("p",{children:[d.jsx("strong",{className:"text-white",children:"Customer email:"})," ",s]})]}),d.jsxs("div",{className:"text-xs text-zinc-400 space-y-1 pt-2 border-t border-zinc-800",children:[d.jsx("p",{children:" Team created and ready to use"}),d.jsx("p",{children:" Customer can log in immediately at flask.do/login"}),d.jsx("p",{children:" No credit card required during trial"}),d.jsx("p",{children:" 20% discount applied to first payment after trial"})]})]}),d.jsxs("div",{className:"pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[d.jsx("p",{className:"mb-2",children:d.jsx("strong",{className:"text-zinc-400",children:"How it works:"})}),d.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[d.jsx("li",{children:"Enter customer email and check if they have an account"}),d.jsx("li",{children:'If yes, enter team name and click "Activate Trial Now"'}),d.jsx("li",{children:"Trial is instantly activated - no Stripe checkout, no waiting"}),d.jsx("li",{children:"Customer logs in at flask.do/login and sees their team ready to use"}),d.jsx("li",{children:"Perfect for sales calls - activate while you're talking to them!"})]})]})]})]}),d.jsxs(rs,{className:"w-full max-w-2xl bg-zinc-900 border-zinc-800",children:[d.jsxs(hi,{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(nz,{className:"h-6 w-6 text-blue-500"}),d.jsx(Pi,{className:"text-white",children:"Email Notification Testing"})]}),d.jsx($a,{className:"text-zinc-400",children:"Manually trigger email notifications for testing and debugging"})]}),d.jsxs(ss,{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsx(Io,{htmlFor:"test-email",className:"text-white",children:"Test Email Address"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(ha,{id:"test-email",type:"email",placeholder:"your-test-email@gmail.com",value:x,onChange:q=>{S(q.target.value),L(null)},disabled:T,className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"}),d.jsx(dt,{onClick:F,disabled:T||!x.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:T?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"w-4 h-4 mr-2 animate-spin"}),"Testing..."]}):d.jsxs(d.Fragment,{children:[d.jsx(sz,{className:"w-4 h-4 mr-2"}),"Send Test Emails"]})})]}),d.jsx("p",{className:"text-xs text-zinc-500",children:"This runs the same notification logic as the cron job, but sends all emails to your test address instead of the actual users"})]}),C&&d.jsxs("div",{className:"space-y-4 p-4 bg-zinc-800 border border-zinc-700 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Tp,{className:"w-5 h-5 text-blue-400"}),d.jsx("p",{className:"font-semibold text-blue-400",children:"Email Test Complete"})]}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsx("p",{className:"text-white font-medium",children:"Summary:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-zinc-300",children:[d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Total users checked:"})," ",d.jsx("span",{className:"font-semibold",children:C.summary.totalUsersChecked})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Users with activity:"})," ",d.jsx("span",{className:"font-semibold",children:C.summary.usersWithActivity})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Emails sent:"})," ",d.jsx("span",{className:"font-semibold text-green-400",children:C.summary.emailsSent})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Emails failed:"})," ",d.jsx("span",{className:"font-semibold text-red-400",children:C.summary.emailsFailed})]})]}),d.jsxs("p",{className:"text-xs text-zinc-500 pt-2",children:["All emails sent to: ",d.jsx("span",{className:"font-mono text-zinc-400",children:C.testEmail})]})]}),C.details.length>0&&d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-white font-medium text-sm",children:"Details:"}),d.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:C.details.map((q,H)=>d.jsx("div",{className:`p-3 rounded text-xs ${q.success?"bg-green-500/10 border border-green-500/20":"bg-red-500/10 border border-red-500/20"}`,children:d.jsxs("div",{className:"flex items-start justify-between gap-2",children:[d.jsxs("div",{className:"space-y-1 flex-1",children:[d.jsxs("p",{className:"text-zinc-300",children:[d.jsx("span",{className:"text-zinc-400",children:"User:"})," ",d.jsx("span",{className:"font-mono",children:q.userEmail})]}),d.jsxs("p",{className:"text-zinc-300",children:[d.jsx("span",{className:"text-zinc-400",children:"Flasks with activity:"})," ",d.jsx("span",{className:"font-semibold",children:q.flaskCount})]}),q.error&&d.jsxs("p",{className:"text-red-400",children:[d.jsx("span",{className:"text-zinc-400",children:"Error:"})," ",q.error]})]}),d.jsx("div",{children:q.success?d.jsx(Tp,{className:"w-4 h-4 text-green-400"}):d.jsx(S3,{className:"w-4 h-4 text-red-400"})})]})},H))})]})]}),d.jsxs("div",{className:"pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[d.jsx("p",{className:"mb-2",children:d.jsx("strong",{className:"text-zinc-400",children:"How it works:"})}),d.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[d.jsx("li",{children:"Runs the same notification query logic as the cron job"}),d.jsx("li",{children:"Finds all users with new unread activity on their flasks"}),d.jsx("li",{children:"Sends emails to your test address instead of actual users"}),d.jsx("li",{children:"Shows detailed feedback on emails sent and any errors"}),d.jsx("li",{children:"Useful for debugging notification logic and email templates"})]})]})]})]}),d.jsxs(rs,{className:"w-full max-w-2xl bg-zinc-900 border-zinc-800",children:[d.jsxs(hi,{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(jC,{className:"h-6 w-6 text-orange-500"}),d.jsx(Pi,{className:"text-white",children:"Send All Notifications"})]}),d.jsx($a,{className:"text-zinc-400",children:"Manually trigger the notification cron job to send emails to ALL users with new activity"})]}),d.jsxs(ss,{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-start gap-3 p-4 bg-orange-500/10 border border-orange-500/20 rounded-lg",children:[d.jsx(hue,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),d.jsxs("div",{className:"space-y-1 text-sm",children:[d.jsx("p",{className:"text-orange-400 font-semibold",children:"This sends REAL emails to REAL users"}),d.jsx("p",{className:"text-zinc-400",children:"Use this button carefully. It will find all users with new activity and send them actual notification emails to their real email addresses."})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Io,{htmlFor:"cronSecret",className:"text-zinc-300",children:"Cron Secret"}),d.jsx(ha,{id:"cronSecret",type:"password",value:R,onChange:q=>I(q.target.value),placeholder:"Paste the CRON_SECRET here",className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"}),d.jsx("p",{className:"text-xs text-zinc-500",children:"Required to authorize the cron endpoint"})]}),d.jsx("div",{className:"space-y-3",children:d.jsx(dt,{onClick:()=>M(!0),disabled:D||!R.trim(),className:"w-full bg-orange-600 hover:bg-orange-700 text-white disabled:opacity-50",children:D?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending Notifications..."]}):d.jsxs(d.Fragment,{children:[d.jsx(jC,{className:"w-4 h-4 mr-2"}),"Send All Notifications Now"]})})}),$&&d.jsxs("div",{className:"space-y-4 p-4 bg-zinc-800 border border-zinc-700 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Tp,{className:"w-5 h-5 text-green-400"}),d.jsx("p",{className:"font-semibold text-green-400",children:"Notifications Sent"})]}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsx("p",{className:"text-white font-medium",children:"Summary:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-zinc-300",children:[d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Users processed:"})," ",d.jsx("span",{className:"font-semibold",children:$.summary.totalUsersChecked})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Users with activity:"})," ",d.jsx("span",{className:"font-semibold",children:$.summary.usersWithActivity})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Emails sent:"})," ",d.jsx("span",{className:"font-semibold text-green-400",children:$.summary.emailsSent})]}),d.jsxs("div",{className:"p-2 bg-zinc-900 rounded",children:[d.jsx("span",{className:"text-zinc-400",children:"Emails failed:"})," ",d.jsx("span",{className:"font-semibold text-red-400",children:$.summary.emailsFailed})]})]})]}),$.details.length>0&&d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-white font-medium text-sm",children:"Errors:"}),d.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:$.details.map((q,H)=>d.jsx("div",{className:"p-3 rounded text-xs bg-red-500/10 border border-red-500/20",children:d.jsx("p",{className:"text-red-400",children:q.error})},H))})]})]}),d.jsxs("div",{className:"pt-4 border-t border-zinc-800 text-xs text-zinc-500",children:[d.jsx("p",{className:"mb-2",children:d.jsx("strong",{className:"text-zinc-400",children:"How it works:"})}),d.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[d.jsx("li",{children:"Triggers the same cron job endpoint that runs every 4 hours"}),d.jsx("li",{children:"Finds all users with notifications enabled who have new activity"}),d.jsx("li",{children:"Respects the 24-hour rate limit (won't send if emailed in last 24h)"}),d.jsx("li",{children:"Sends emails to actual user email addresses"}),d.jsx("li",{children:"Useful for testing the full notification flow in production"})]})]})]})]}),d.jsx(xK,{open:k,onOpenChange:M,children:d.jsxs(q2,{className:"bg-zinc-900 border-zinc-800",children:[d.jsxs(W2,{children:[d.jsx(Y2,{className:"text-white",children:"Send Notifications to All Users?"}),d.jsxs(X2,{className:"text-zinc-400",children:["This will trigger the notification cron job and send REAL emails to ALL users with new activity.",d.jsx("br",{}),d.jsx("br",{}),"Are you sure you want to proceed?"]})]}),d.jsxs(K2,{children:[d.jsx(Z2,{className:"bg-zinc-800 border-zinc-700 text-white hover:bg-zinc-700",children:"Cancel"}),d.jsx(Q2,{onClick:j,className:"bg-orange-600 hover:bg-orange-700 text-white",children:"Yes, Send Notifications"})]})]})})]}):d.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:d.jsxs(rs,{className:"w-full max-w-md bg-zinc-900 border-zinc-800",children:[d.jsxs(hi,{children:[d.jsx(Pi,{className:"text-white",children:"Access Denied"}),d.jsx($a,{className:"text-zinc-400",children:"Only the King of Flask can access this page"})]}),d.jsx(ss,{className:"text-sm text-zinc-500",children:d.jsxs("p",{children:["You are logged in as: ",d.jsx("span",{className:"font-mono text-zinc-400",children:n.email})]})})]})}):d.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:d.jsx(rs,{className:"w-full max-w-md bg-zinc-900 border-zinc-800",children:d.jsxs(hi,{children:[d.jsx(Pi,{className:"text-white",children:"Please Log In"}),d.jsx($a,{className:"text-zinc-400",children:"You must be logged in to access this page"})]})})})}let IR=null;const HNe=()=>{const n=E.useRef(!1),e=cn(t=>t.user);return K_e(e?.id),E.useEffect(()=>{if(n.current)return;n.current=!0,(async()=>{const r=cn.getState();r.isInitialized||(IR||(IR=r.initialize()),await IR)})()},[]),null},VNe=[.25,.5,.75,1,1.25,1.5,1.75,2],zNe=3e3,GNe=()=>{const n=E.useRef(null),e=E.useRef(null),t=E.useRef(null),r=E.useRef(null),s=E.useRef(null),[i,a]=E.useState(0),[o,l]=E.useState(0),[c,u]=E.useState(!0),[f,m]=E.useState(!1),[g,y]=E.useState(!1),[b,x]=E.useState(!1),[S,T]=E.useState(1),[_,R]=E.useState(!1),I=E.useRef(null),C=E.useRef(null),L=He(ae=>ae.activeRecordingUrl);He(ae=>ae.activeRecordingId);const k=He(ae=>ae.isRecordingPlaying),M=He(ae=>ae.recordingPlaybackRate),D=He(ae=>ae.isRecordingFullscreen),U=He(ae=>ae.recordingCurrentTime),$=He(ae=>ae.recordingOriginRect),V=He(ae=>ae.toggleRecordingPlayback),B=He(ae=>ae.setIsRecordingPlaying),W=He(ae=>ae.setRecordingPlaybackRate),F=He(ae=>ae.setRecordingFullscreen),j=He(ae=>ae.setRecordingCurrentTime),q=E.useCallback(()=>{F(!1)},[F]),H=E.useCallback(ae=>{ae.target===ae.currentTarget&&q()},[q]),N=E.useCallback(()=>{V()},[V]),O=E.useCallback(ae=>{W(ae),x(!1)},[W]),z=E.useCallback(()=>{x(ae=>!ae)},[]),G=E.useCallback(ae=>{const le=ae[0];T(le),le>0&&_&&R(!1),n.current&&(n.current.volume=le,n.current.muted=le===0)},[_]),Y=E.useCallback(()=>{const ae=!_;R(ae),n.current&&(n.current.muted=ae)},[_]),Q=E.useCallback(()=>{C.current&&(clearTimeout(C.current),C.current=null),I.current=setTimeout(()=>{y(!0)},400)},[]),J=E.useCallback(()=>{I.current&&(clearTimeout(I.current),I.current=null),C.current=setTimeout(()=>{y(!1)},400)},[]),ee=E.useCallback(ae=>{if(!n.current||!o||!e.current)return;const le=e.current.getBoundingClientRect(),Ie=(ae.clientX-le.left)/le.width*o;n.current.currentTime=Ie,j(Ie)},[o,j]),oe=E.useCallback(ae=>{m(!0),ee(ae)},[ee]),te=E.useCallback(ae=>{if(!f||!n.current||!o||!e.current)return;const le=e.current.getBoundingClientRect(),Ie=Math.max(0,Math.min(ae.clientX-le.left,le.width))/le.width*o;n.current.currentTime=Ie,j(Ie)},[f,o,j]),se=E.useCallback(()=>{m(!1)},[]),he=E.useCallback(()=>{u(!0),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{u(!1)},zNe)},[]);E.useEffect(()=>{const ae=s.current;if(!(!ae||!D))return ae.addEventListener("mousemove",he),he(),()=>{ae.removeEventListener("mousemove",he),r.current&&clearTimeout(r.current)}},[D,he]),E.useEffect(()=>{const ae=le=>{le.key==="Escape"&&D&&q()};return D&&(document.addEventListener("keydown",ae),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",ae),document.body.style.overflow=""}},[D,q]),E.useEffect(()=>{const ae=le=>{t.current&&!t.current.contains(le.target)&&x(!1)};if(b)return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[b]),E.useEffect(()=>{const ae=n.current;if(!ae||!L||!D)return;a(0),l(0);const le=()=>{ae.play().catch(tt=>{console.error("[FullscreenRecordingPlayer] Auto-play failed:",tt)})},ie=()=>{B(!0)},fe=()=>{B(!1)},Ie=tt=>{console.error("[FullscreenRecordingPlayer] Video error:",tt)},ne=()=>{a(ae.currentTime),j(ae.currentTime)},ce=()=>{l(ae.duration),ae.playbackRate=M,ae.currentTime=0},Ce=()=>{},Oe=()=>{},ze=()=>{},We=()=>{};return ae.addEventListener("canplay",le),ae.addEventListener("play",ie),ae.addEventListener("pause",fe),ae.addEventListener("error",Ie),ae.addEventListener("timeupdate",ne),ae.addEventListener("loadedmetadata",ce),ae.addEventListener("waiting",Ce),ae.addEventListener("playing",Oe),ae.addEventListener("seeking",ze),ae.addEventListener("seeked",We),"src"in ae&&(ae.src=L,ae.load()),()=>{ae.removeEventListener("canplay",le),ae.removeEventListener("play",ie),ae.removeEventListener("pause",fe),ae.removeEventListener("error",Ie),ae.removeEventListener("timeupdate",ne),ae.removeEventListener("loadedmetadata",ce),ae.removeEventListener("waiting",Ce),ae.removeEventListener("playing",Oe),ae.removeEventListener("seeking",ze),ae.removeEventListener("seeked",We)}},[L,B,j,M,D]),E.useEffect(()=>{n.current&&(n.current.playbackRate=M)},[M]),E.useEffect(()=>{n.current&&(k&&n.current.paused?n.current.play().catch(console.error):!k&&!n.current.paused&&n.current.pause())},[k]),E.useEffect(()=>{if(!n.current||!o)return;const ae=n.current.currentTime;Math.abs(ae-U)>.1&&(n.current.currentTime=U)},[U,o]),E.useEffect(()=>{if(f)return document.addEventListener("mousemove",te),document.addEventListener("mouseup",se),()=>{document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",se)}},[f,te,se]);const Z=o>0?i/o*100:0,pe=$?$.left+$.width/2-window.innerWidth/2:0,ye=$?$.top+$.height/2-window.innerHeight/2:0;return L?Hs.createPortal(d.jsx(Ed,{mode:"wait",children:D&&d.jsx(yi,{delayDuration:0,children:d.jsx(Ka.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.05},className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center",onClick:H,children:d.jsx(Ka.div,{ref:s,className:"w-[90%] max-w-screen-2xl",onClick:ae=>ae.stopPropagation(),initial:{scale:0,opacity:0,x:pe,y:ye},animate:{scale:1,opacity:1,x:0,y:0},exit:{scale:0,opacity:0,x:pe,y:ye},transition:{duration:.3,ease:[.34,1.56,.64,1]},children:d.jsx("div",{className:"relative bg-card-background border border-text-primary/30 rounded-3xl shadow-2xl",children:d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"relative aspect-video bg-black rounded-2xl overflow-hidden border border-border",children:[ve.createElement("hls-video",{ref:n,className:"w-full h-full object-contain",controls:!1,playsInline:!0,autoPlay:!1,muted:!1}),d.jsxs("div",{className:`absolute bottom-0 left-0 right-0 transition-opacity duration-200 ${c?"opacity-100":"opacity-0"}`,children:[d.jsxs("div",{className:"relative z-50 flex items-center justify-center pb-2 gap-1 px-4",children:[d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsx("div",{className:"h-8 w-8 flex items-center justify-center bg-inbetween-background/60 backdrop-blur-md rounded-full -mt-1.5 p-0 z-40 cursor-pointer",onClick:N,children:k?d.jsx(tD,{size:14,className:"text-text-primary",fill:"currentColor"}):d.jsx(nv,{size:14,className:"text-text-primary",fill:"currentColor"})})}),d.jsx($n,{className:"mb-3",children:k?"Pause":"Play"})]}),d.jsx("div",{className:"h-8 flex items-center bg-inbetween-background/60 backdrop-blur-md rounded-full px-4 -mt-1.5 z-0",children:d.jsx("div",{className:"px-1 py-1",children:d.jsxs("span",{className:"font-mono text-sm select-none whitespace-nowrap flex items-center",children:[d.jsxs("span",{className:"text-text-primary flex items-center",children:[Math.floor(o/3600)>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(i/3600),format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:Math.floor(i%3600/60),format:{minimumIntegerDigits:Math.floor(o/3600)>0?2:1,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"}),d.jsx(Er,{value:Math.floor(i%60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0})]}),d.jsx("span",{className:"text-text-secondary mx-2",children:"/"}),d.jsxs("span",{className:"text-text-secondary flex items-center",children:[Math.floor(o/3600)>0&&d.jsxs(d.Fragment,{children:[d.jsx(Er,{value:Math.floor(o/3600),format:{useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"})]}),d.jsx(Er,{value:Math.floor(o%3600/60),format:{minimumIntegerDigits:Math.floor(o/3600)>0?2:1,useGrouping:!1},className:"tabular-nums",isolate:!0}),d.jsx("span",{children:":"}),d.jsx(Er,{value:Math.floor(o%60),format:{minimumIntegerDigits:2,useGrouping:!1},className:"tabular-nums",isolate:!0})]})]})})}),d.jsxs("div",{className:"h-8 flex items-center bg-inbetween-background/60 backdrop-blur-md rounded-full px-3 -mt-1.5 z-0 gap-3",children:[d.jsxs("div",{className:"relative",ref:t,children:[d.jsxs(Tr,{delayDuration:300,children:[d.jsx(_r,{asChild:!0,children:d.jsxs("button",{className:"font-mono text-sm text-text-secondary hover:text-text-primary transition-colors px-1 flex items-center gap-1",onClick:z,type:"button",style:{minWidth:"2rem"},children:[d.jsx("span",{children:M%1===0?`${M}x`:`${M.toFixed(2)}x`}),b?d.jsx(JL,{className:"h-3 w-3"}):d.jsx(Id,{className:"h-3 w-3"})]})}),d.jsx($n,{className:"mb-3",children:"Playback Speed"})]}),b&&d.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-inbetween-background/60 backdrop-blur-md rounded-lg border element-border shadow-lg overflow-hidden z-50",children:d.jsx("div",{className:"py-1",children:VNe.map(ae=>d.jsx("button",{onClick:()=>O(ae),className:je("w-full px-3 py-2 text-left text-sm transition-colors font-mono",M===ae?"bg-element-hover text-text-primary":"text-text-secondary hover:bg-element-hover hover:text-text-primary"),type:"button",children:ae%1===0?`${ae}x`:`${ae.toFixed(2)}x`},ae))})})]}),d.jsxs("div",{className:"flex items-center group",onMouseEnter:Q,onMouseLeave:J,children:[d.jsx("button",{className:"flex items-center justify-center p-1 text-text-secondary hover:text-text-primary transition-colors",onClick:Y,type:"button",children:_?d.jsx(az,{className:"h-4 w-4"}):d.jsx(iz,{className:"h-4 w-4"})}),d.jsx("div",{className:je("transition-all duration-300 ease-out flex items-center",g?"w-20 ml-2 opacity-100":"w-0 ml-0 opacity-0 overflow-hidden"),children:d.jsx(lM,{value:[_?0:S],onValueChange:G,max:1,min:0,step:.01,className:"w-20 cursor-pointer"})})]})]}),d.jsxs("div",{className:"h-8 flex items-center bg-inbetween-background/60 backdrop-blur-md rounded-full px-3 -mt-1.5 z-0 gap-4 cursor-pointer",onClick:q,children:[d.jsx(gn,{className:"text-text-secondary h-5",children:"ESC"}),d.jsx("span",{className:"text-text-secondary text-sm",children:"Back"})]})]}),d.jsx("div",{className:"px-4 pb-4",children:d.jsxs("div",{ref:e,className:je("h-4 rounded-full relative element-border overflow-visible bg-gradient-to-b from-grey-400 to-slate-400/20 bg-text-secondary/60 backdrop-blur-md cursor-pointer"),onMouseDown:oe,onClick:ee,children:[d.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-sm pointer-events-none",children:d.jsxs("div",{className:"absolute top-0 left-0 h-4 rounded-l-full rounded-r-2xl pointer-events-none overflow-hidden transition-none border-0",style:{width:`${Z}%`,backgroundColor:"#CFDFF6"},children:[d.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"url('/svgs/playbargradient.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"right center",backgroundSize:"auto 100%"}}),d.jsx("div",{className:"absolute inset-0 shadow-inner shadow-cyan-100/70"})]})}),d.jsx("div",{className:"absolute z-[25] flex items-center justify-center overflow-hidden backdrop-blur-sm drop-shadow-lg cursor-pointer",style:{left:`${Z}%`,top:"8px",transform:"translate(-50%, -50%)",pointerEvents:"auto",width:"16px",height:"24px",borderRadius:"8px",backgroundColor:"rgba(226, 232, 240, 0.4)",borderTop:"1px solid #FAFAFA",boxShadow:"inset 0 0 10px rgba(255, 255, 255, 0.4), 0 0px 18px -1px rgba(0, 0, 0, 0.4)"}})]})})]})]})})})})})})}),document.body):null},qNe=()=>{const n=He(l=>l.activeImageUrl),e=He(l=>l.isImageFullscreen),t=He(l=>l.imageOriginRect),r=He(l=>l.setImageFullscreen),s=E.useCallback(()=>{r(!1)},[r]),i=E.useCallback(l=>{l.target===l.currentTarget&&s()},[s]);E.useEffect(()=>{if(!e)return;const l=c=>{c.key==="Escape"&&(c.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[e,s]);const a=t?t.left+t.width/2-window.innerWidth/2:0,o=t?t.top+t.height/2-window.innerHeight/2:0;return Hs.createPortal(d.jsx(Ed,{children:e&&n&&d.jsx(Ka.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-[9999] bg-black/90 flex items-center justify-center cursor-pointer",onClick:i,children:d.jsx(Ka.div,{initial:{scale:0,opacity:0,x:a,y:o},animate:{scale:1,opacity:1,x:0,y:0},exit:{scale:0,opacity:0,x:a,y:o},transition:{duration:.3,ease:[.34,1.56,.64,1]},className:"max-w-[90vw] max-h-[90vh] flex items-center justify-center",onClick:l=>l.stopPropagation(),children:d.jsx("img",{src:n,alt:"Fullscreen",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"})})})}),document.body)};function WNe({children:n}){return d.jsxs(yi,{children:[d.jsx(HNe,{}),n,d.jsx(GNe,{}),d.jsx(qNe,{})]})}var rT="Switch",[KNe,Oje]=Ns(rT),[YNe,XNe]=KNe(rT),KZ=E.forwardRef((n,e)=>{const{__scopeSwitch:t,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...f}=n,[m,g]=E.useState(null),y=$t(e,_=>g(_)),b=E.useRef(!1),x=m?u||!!m.closest("form"):!0,[S,T]=vi({prop:s,defaultProp:i??!1,onChange:c,caller:rT});return d.jsxs(YNe,{scope:t,checked:S,disabled:o,children:[d.jsx(_t.button,{type:"button",role:"switch","aria-checked":S,"aria-required":a,"data-state":ZZ(S),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:y,onClick:rt(n.onClick,_=>{T(R=>!R),x&&(b.current=_.isPropagationStopped(),b.current||_.stopPropagation())})}),x&&d.jsx(QZ,{control:m,bubbles:!b.current,name:r,value:l,checked:S,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});KZ.displayName=rT;var YZ="SwitchThumb",XZ=E.forwardRef((n,e)=>{const{__scopeSwitch:t,...r}=n,s=XNe(YZ,t);return d.jsx(_t.span,{"data-state":ZZ(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});XZ.displayName=YZ;var QNe="SwitchBubbleInput",QZ=E.forwardRef(({__scopeSwitch:n,control:e,checked:t,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=$t(a,i),l=FS(t),c=pS(e);return E.useEffect(()=>{const u=a.current;if(!u)return;const f=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(f,"checked").set;if(l!==t&&g){const y=new Event("click",{bubbles:r});g.call(u,t),u.dispatchEvent(y)}},[l,t,r]),d.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});QZ.displayName=QNe;function ZZ(n){return n?"checked":"unchecked"}var JZ=KZ,ZNe=XZ;const vL=E.forwardRef(({className:n,...e},t)=>d.jsx(JZ,{className:je("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",n),...e,ref:t,children:d.jsx(ZNe,{className:je("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));vL.displayName=JZ.displayName;const JNe=lD("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function LR({className:n,variant:e,...t}){return d.jsx("div",{className:je(JNe({variant:e}),n),...t})}const eje=({open:n,onOpenChange:e,currentTeam:t,defaultTab:r="team",onTabChange:s,isLoadingTeam:i=!1})=>{const{user:a}=Ar(),o=Ft(J=>J.currentTeam),l=Ft(J=>J.refreshCurrentTeam),c=Ft(J=>J.updateTeamName),u=Ft(J=>J.updateInviteEnabled),f=Ft(J=>J.removeMember),m=Ft(J=>J.isTeamAdmin),[g,y]=E.useState(o),[b,x]=E.useState(r),[S,T]=E.useState(!1),[_,R]=E.useState(!1),[I,C]=E.useState(""),[L,k]=E.useState(!0),[M,D]=E.useState(null),[U,$]=E.useState(!1),[V,B]=E.useState(!1),[W,F]=E.useState(!1),[j,q]=E.useState(!1);E.useEffect(()=>{x(r)},[r]),E.useEffect(()=>{o&&(y(o),C(o.name),k(o.invite_enabled||!1))},[o]),E.useEffect(()=>{n&&a&&l()},[n,a,l]),E.useEffect(()=>{(async()=>{if(!(!n||!a))try{q(!0);const{data:ee,error:oe}=await Lr.from("profiles").select("email_notifications_enabled").eq("user_id",a.id).single();if(oe)throw oe;F(ee?.email_notifications_enabled??!1)}catch(ee){console.error("Error fetching notification settings:",ee)}finally{q(!1)}})()},[n,a]);const H=async()=>{if(!(!g||!a||!m(a.id)))try{R(!0),I!==g.name&&(await c(g.id,I),et.success("Team settings updated"))}catch(J){console.error("Error updating team:",J),et.error("Failed to update team settings")}finally{R(!1)}},N=async()=>{if(!(!M||!g))try{$(!0),await f(g.id,M.id),et.success(`Removed ${M.name} from team`),D(null)}catch(J){console.error("Error removing member:",J)}finally{$(!1)}},O=async J=>{if(a)try{F(J);const{error:ee}=await Lr.from("profiles").update({email_notifications_enabled:J}).eq("user_id",a.id);if(ee)throw ee;et.success(J?"Email notifications enabled":"Email notifications disabled")}catch(ee){console.error("Error updating notification settings:",ee),F(!J),et.error("Failed to update notification settings")}},z=async()=>{if(!(!g||g.team_type!=="pro_team"))try{B(!0);const J=await Ht(`/api/teams/${g.id}/portal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({return_url:window.location.href})});if(!J.ok)throw new Error("Failed to open billing portal");const{url:ee}=await J.json();window.open(ee,"_blank")}catch(J){console.error("Error opening team portal:",J),et.error("Failed to open billing portal")}finally{B(!1)}},G=()=>{if(!g)return;const J=`${window.location.origin}/invite/${g.invite_code}`;navigator.clipboard.writeText(J),et.success("Invite link copied to clipboard")},Y=()=>g?`${window.location.origin}/invite/${g.invite_code}`:"",Q=({value:J,icon:ee,label:oe})=>d.jsxs("button",{onClick:()=>{x(J),s&&s(J)},className:je("w-full flex items-center gap-3 px-3 py-2.5 rounded-md transition-colors","hover:bg-background/50",b===J&&"bg-background shadow-sm"),children:[d.jsx(ee,{className:"h-4 w-4"}),d.jsx("span",{className:"text-sm font-medium",children:oe})]});return d.jsxs(Zn,{open:n,onOpenChange:e,children:[d.jsx(Kn,{className:"max-w-5xl max-h-[90vh] min-h-[600px] p-0 overflow-hidden",children:d.jsxs("div",{className:"flex h-full",children:[d.jsxs("div",{className:"w-64 bg-muted/30 p-6 border-r flex flex-col",children:[i?d.jsxs("div",{className:"mb-6 pb-6 border-b",children:[d.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:d.jsx(Lo,{width:128})}),d.jsx("div",{className:"text-sm text-text-secondary",children:d.jsx(Lo,{width:80})})]}):g?d.jsxs("div",{className:"mb-6 pb-6 border-b min-w-0",children:[d.jsx("h3",{className:"font-semibold text-lg mb-2 truncate",children:g.name}),d.jsx(LR,{variant:g.team_type==="pro_team"?"default":"secondary",children:g.team_type==="pro_team"?"Pro Team":"Free Team"})]}):null,d.jsxs("nav",{className:"space-y-1 mb-6",children:[d.jsx(Q,{value:"team",icon:pue,label:"Team"}),d.jsx(Q,{value:"notifications",icon:jC,label:"Notifications"}),g?.team_type==="pro_team"&&g?.current_user_role==="admin"&&d.jsx(Q,{value:"billing",icon:qce,label:"Billing"})]}),g?.team_type!=="pro_team"&&d.jsxs("div",{className:"bg-card-background/50 border-t shadow-xl border-text-primary/30 p-4 rounded-3xl",children:[d.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Flask Pro"}),d.jsxs("div",{className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-secondary",children:[d.jsx("div",{className:"w-1 h-1 rounded-full bg-text-secondary"}),d.jsx("span",{children:"Upload videos from device"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-secondary",children:[d.jsx("div",{className:"w-1 h-1 rounded-full bg-text-secondary"}),d.jsx("span",{children:"Shared workspaces"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-secondary",children:[d.jsx("div",{className:"w-1 h-1 rounded-full bg-text-secondary"}),d.jsx("span",{children:"Multiple assets/versions per flask"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-secondary",children:[d.jsx("div",{className:"w-1 h-1 rounded-full bg-text-secondary"}),d.jsx("span",{children:"Remove flask branding"})]})]}),d.jsx("button",{onClick:()=>window.open("/#pricing","_blank"),className:"button-primary w-full flex items-center justify-center px-4 py-3 transition-all duration-200 font-semibold cursor-pointer rounded-xl",children:d.jsx("span",{className:"text-sm font-medium",children:"Upgrade"})})]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto",children:d.jsxs("div",{className:"p-6",children:[b==="team"&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-semibold mb-1",children:"Team Settings"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage your team and members"})]}),S?d.jsxs("div",{className:"space-y-4",children:[d.jsx(rs,{children:d.jsx(ss,{className:"p-6",children:d.jsx(Lo,{count:3})})}),d.jsx(rs,{children:d.jsx(ss,{className:"p-6",children:d.jsx(Lo,{count:5})})})]}):g?d.jsxs(d.Fragment,{children:[d.jsxs(rs,{children:[d.jsx(hi,{children:d.jsx(Pi,{children:"General"})}),d.jsx(ss,{className:"space-y-4",children:d.jsxs("div",{className:"space-y-2",children:[d.jsx(Io,{htmlFor:"team-name",children:"Team Name"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(ha,{id:"team-name",value:I,onChange:J=>C(J.target.value),disabled:g.current_user_role!=="admin"}),g.current_user_role==="admin"&&d.jsx(dt,{onClick:H,disabled:_||I===g.name,children:_?"Saving...":"Save"})]})]})})]}),d.jsxs(rs,{children:[d.jsxs(hi,{children:[d.jsx(Pi,{children:"Members"}),d.jsxs($a,{children:[g.member_count," member",g.member_count!==1?"s":""]})]}),d.jsxs(ss,{children:[g.team_type==="pro_team"&&g.current_user_role==="admin"&&d.jsxs("div",{className:"space-y-4 pb-4 mb-4 border-b",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"space-y-0.5",children:[d.jsx(Io,{htmlFor:"invite-toggle",children:"Enable Invite Link"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow new members to join via invite link"})]}),d.jsx(vL,{id:"invite-toggle",checked:L,onCheckedChange:async J=>{k(J);try{await u(g.id,J),et.success(J?"Invite link enabled":"Invite link disabled")}catch(ee){k(!J),et.error("Failed to update invite settings"),console.error("Error updating invite settings:",ee)}}})]}),L&&d.jsxs("div",{className:"space-y-2",children:[d.jsx(Io,{children:"Invite Link"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(ha,{value:Y(),readOnly:!0,className:"font-mono text-sm"}),d.jsx(dt,{size:"icon",variant:"outline",onClick:G,children:d.jsx(JV,{className:"h-4 w-4"})})]})]})]}),d.jsx("div",{className:"space-y-2",children:g.members?.map(J=>d.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(sv,{user:{id:J.user_id,full_name:J.user?.full_name||J.display_name,avatar_url:J.user?.avatar_url||J.avatar_url,email:J.user?.email||J.email},size:"sm"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium",children:J.user?.full_name||J.display_name||J.user?.email||J.email||"Team Member"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:J.user?.email||J.email})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[J.role==="admin"&&d.jsxs(LR,{variant:"secondary",children:[d.jsx(due,{className:"h-3 w-3 mr-1"}),"Admin"]}),g.current_user_role==="admin"&&J.user_id!==a?.id&&J.role!=="admin"&&d.jsx(dt,{variant:"ghost",size:"sm",onClick:()=>D({id:J.id,name:J.user?.full_name||J.user?.email||J.email||"Team Member"}),children:d.jsx(mue,{className:"h-4 w-4"})})]})]},J.id))})]})]})]}):d.jsx("div",{className:"text-center py-8",children:d.jsx("p",{className:"text-muted-foreground",children:"No team selected"})})]}),b==="billing"&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-semibold mb-1",children:"Billing"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage team subscription and billing"})]}),g?d.jsx(d.Fragment,{children:g.team_type==="pro_team"?d.jsxs(d.Fragment,{children:[d.jsxs(rs,{children:[d.jsxs(hi,{children:[d.jsx(Pi,{children:"Team Subscription"}),d.jsx($a,{children:"Manage your team's Pro subscription"})]}),d.jsx(ss,{children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Plan"}),d.jsx("p",{className:"font-medium",children:"Flask Pro"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),d.jsx(LR,{variant:g.subscription_status==="active"?"default":"secondary",children:g.subscription_status||"Inactive"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Seats"}),d.jsxs("p",{className:"font-medium",children:[g.seat_count||0," users"]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Billing Period"}),d.jsx("p",{className:"font-medium capitalize",children:g.billing_period||"N/A"})]})]}),g.current_period_end&&d.jsxs("div",{className:"pt-4 border-t",children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Next billing date"}),d.jsx("p",{className:"font-medium",children:new Date(g.current_period_end).toLocaleDateString()})]}),g.current_user_role==="admin"&&d.jsx("div",{className:"pt-4 border-t",children:d.jsx(dt,{onClick:z,disabled:V,className:"w-full",children:V?d.jsxs(d.Fragment,{children:[d.jsx(Mo,{className:"h-4 w-4 mr-2 animate-spin"}),"Opening Portal..."]}):d.jsxs(d.Fragment,{children:[d.jsx(ez,{className:"h-4 w-4 mr-2"}),"Manage Billing"]})})})]})})]}),g.current_user_role==="admin"&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"border-t pt-6"}),d.jsxs("div",{className:"rounded-lg border border-red-900/20 dark:border-red-900/50 bg-background p-4",children:[d.jsx("h4",{className:"text-red-500 dark:text-red-400 font-medium mb-2",children:"Delete Team"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsx("p",{children:"To delete this team, you need to cancel your subscription through the billing portal."}),d.jsxs("p",{className:"text-sm",children:[d.jsx("strong",{children:"Warning:"})," Canceling your subscription will:"]}),d.jsxs("ul",{className:"text-sm list-disc list-inside ml-2 space-y-1",children:[d.jsx("li",{children:"Remove all team members except you"}),d.jsx("li",{children:"Revert the team to a free plan"}),d.jsx("li",{children:"Keep your flasks and data intact"}),d.jsx("li",{children:"Take effect at the end of your current billing period"})]})]})]})]})]}):d.jsxs(rs,{children:[d.jsxs(hi,{children:[d.jsx(Pi,{children:"Free Team"}),d.jsx($a,{children:"You're on the free plan"})]}),d.jsxs(ss,{children:[d.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upgrade to Pro to unlock unlimited flasks, team collaboration, and more."}),d.jsx(dt,{onClick:()=>window.location.href="/#pricing",className:"w-full",children:"Upgrade to Pro"})]})]})}):d.jsx(rs,{children:d.jsx(ss,{className:"py-8",children:d.jsx("p",{className:"text-center text-muted-foreground",children:"No team selected"})})})]}),b==="notifications"&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-semibold mb-1",children:"Notifications"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage your notification preferences"})]}),d.jsxs(rs,{children:[d.jsxs(hi,{children:[d.jsx(Pi,{children:"Email Notifications"}),d.jsx($a,{children:"Get notified about activity on your flasks"})]}),d.jsx(ss,{children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"space-y-0.5",children:[d.jsx(Io,{htmlFor:"email-notifications",children:"Email Notifications"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive email notifications when others comment on your flasks"})]}),d.jsx(vL,{id:"email-notifications",checked:W,disabled:j,onCheckedChange:O})]})})]})]})]})})]})}),d.jsx(Zn,{open:!!M,onOpenChange:()=>D(null),children:d.jsxs(Kn,{children:[d.jsxs(ar,{children:[d.jsx(or,{children:"Remove Team Member"}),d.jsxs(zl,{children:["Are you sure you want to remove ",M?.name," from the team? They will lose access to all team resources."]})]}),d.jsxs(ys,{children:[d.jsx(dt,{variant:"outline",onClick:()=>D(null),children:"Cancel"}),d.jsx(dt,{variant:"destructive",onClick:N,disabled:U,children:U?"Removing...":"Remove Member"})]})]})})]})},tje=()=>{const[n,e]=Cd();Jn();const{user:t}=Ar();zv(t?.id);const r=Ft(m=>m.currentTeam),s=Ft(m=>m.isLoadingTeams),i=Ft(m=>m.refreshCurrentTeam),[a,o]=E.useState(!1),[l,c]=E.useState("team");E.useEffect(()=>{if(n.get("session_id")){const g=new URLSearchParams(n);g.delete("session_id"),e(g,{replace:!0})}},[]),E.useEffect(()=>{const m=n.get("settings");m?(o(!0),c(["team","account","billing","notifications"].includes(m)?m:"team"),t&&!s&&i()):o(!1)},[n,t,i,s]);const u=E.useCallback(m=>{c(m);const g=new URLSearchParams(n);g.set("settings",m),e(g,{replace:!0})},[n,e]),f=m=>{if(!m){const g=new URLSearchParams(n);g.delete("settings"),e(g,{replace:!0})}o(m)};return E.useEffect(()=>{(async()=>{if(n.get("from_checkout")==="true"&&t&&!r){let y=0;const b=10,x=async()=>{y>=b||(y++,await i(),!r&&y<b&&setTimeout(x,1e3))};await x();const S=new URLSearchParams(n);S.delete("from_checkout"),e(S,{replace:!0})}})()},[n,t,r,i]),a?d.jsx(eje,{open:a,onOpenChange:f,currentTeam:r?{id:r.id,name:r.name}:null,defaultTab:l,onTabChange:u,isLoadingTeam:s}):null},x8=({children:n})=>{const{user:e,isLoading:t,isInitialized:r}=Ar(),s=Os();if(!r||t)return d.jsx("div",{className:"min-h-screen bg-card-background relative"});if(!e){if(s.pathname==="/login")return d.jsx(d.Fragment,{children:n});const i=s.pathname==="/dash"?"/dash":s.pathname+s.search;return d.jsx(Mne,{to:`/login?returnUrl=${encodeURIComponent(i)}`,replace:!0})}return d.jsx(d.Fragment,{children:n})},nje=new Mre({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function rje(){const n=Os();return E.useEffect(()=>{typeof window<"u"&&$c&&$c.capture("$pageview")},[n]),null}function sje(){return typeof window<"u"&&window.location.hostname==="app.flask.do"?(window.location.replace(`https://flask.do${window.location.pathname}${window.location.search}${window.location.hash}`),null):d.jsx(Fre,{client:nje,children:d.jsxs(are,{children:[d.jsx(rje,{}),d.jsx(_se,{baseColor:"rgba(255, 255, 255, 0.1)",highlightColor:"rgba(255, 255, 255, 0.2)",children:d.jsxs(WNe,{children:[d.jsxs(Nne,{children:[d.jsx(ti,{path:"/",element:d.jsx(dhe,{})}),d.jsx(ti,{path:"/dash",element:d.jsx(x8,{children:d.jsx(hbe,{})})}),d.jsx(ti,{path:"/login",element:d.jsx(pbe,{})}),d.jsx(ti,{path:"/auth/callback",element:d.jsx(jNe,{})}),d.jsx(ti,{path:"/flask/:id",element:d.jsx(nOe,{})}),d.jsx(ti,{path:"/invite/:inviteCode",element:d.jsx(INe,{})}),d.jsx(ti,{path:"/manifesto",element:d.jsx(LNe,{})}),d.jsx(ti,{path:"/privacy-policy",element:d.jsx(DNe,{})}),d.jsx(ti,{path:"/terms-of-service",element:d.jsx(PNe,{})}),d.jsx(ti,{path:"/newteam",element:d.jsx(MNe,{})}),d.jsx(ti,{path:"/launch",element:d.jsx(FNe,{})}),d.jsx(ti,{path:"/kingofflask",element:d.jsx(x8,{children:d.jsx(BNe,{})})}),d.jsx(ti,{path:"*",element:d.jsx(NNe,{})})]}),d.jsx(tje,{}),d.jsx(Sse,{position:"bottom-left",theme:"dark",toastOptions:{style:{background:"#09090B",color:"rgb(244, 244, 245)",border:"1px solid hsl(240 3.7% 15.9%)",borderRadius:"9999px",fontSize:"14px",padding:"12px 20px"}}})]})})]})})}yte.createRoot(document.getElementById("root")).render(d.jsx(k8,{children:d.jsx(sje,{})}));export{jK as A,m1e as E,goe as H,tP as T,De as a,je as c,d as j,E as r,dn as u};
